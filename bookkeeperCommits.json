{"COMMIT-LIST":[{"Commit-ID":"commit 9ea37773fa07e8e1c16e654020ae34c3d6564963 1301460181 -----sp","Author":"PersonIdent[Benjamin Reed, breed@apache.org, Wed Mar 30 04:43:01 2011 +0000]","Body":"added top level directories\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1086836 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Mar 30 06:43:01 CEST 2011"},{"Commit-ID":"commit c1c8bef6125cb70ed2da68e92bb49e45f4ea64a9 1301527761 -----sp","Author":"PersonIdent[Benjamin Reed, breed@apache.org, Wed Mar 30 23:29:21 2011 +0000]","Body":"ZOOKEEPER-1038. Move bookkeeper and hedwig code in subversion\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1087134 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Mar 31 01:29:21 CEST 2011"},{"Commit-ID":"commit e988271acee2c217209d5c7f52c07f6211257e97 1301553983 -----sp","Author":"PersonIdent[Benjamin Reed, breed@apache.org, Thu Mar 31 06:46:23 2011 +0000]","Body":"got bookkeper work with maven\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1087198 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Mar 31 08:46:23 CEST 2011"},{"Commit-ID":"commit 30c326643938bb3df6b35515e714622d98772352 1302280523 -----sp","Author":"PersonIdent[Benjamin Reed, breed@apache.org, Fri Apr 8 16:35:23 2011 +0000]","Body":"more fixing of the build (ivankelly via breed)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1090338 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Apr 08 18:35:23 CEST 2011"},{"Commit-ID":"commit 8ee32a8ab80dcd51f7846972d92b7c9e83d99862 1305900664 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Fri May 20 14:11:04 2011 +0000]","Body":"BOOKKEEPER-19: BookKeeper doesn't support more than 2Gig of memory (ivan via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1125406 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri May 20 16:11:04 CEST 2011"},{"Commit-ID":"commit 9ea30d361649e13f28efb05ea2155cf765267a2f 1306315726 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed May 25 09:28:46 2011 +0000]","Body":"BOOKKEEPER-1: Static variable makes tests fail (fpj via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1127451 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed May 25 11:28:46 CEST 2011"},{"Commit-ID":"commit 266b1c2744a35b9379ba5e7023322a2450b91090 1306316493 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed May 25 09:41:33 2011 +0000]","Body":"BOOKKEEPER-1: Static variable makes tests fail (fpj via ivank) [CHANGES.txt]\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1127455 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed May 25 11:41:33 CEST 2011"},{"Commit-ID":"commit 267ed95a2ae2ef1a8f6a3166b217d86a28166391 1307375378 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Mon Jun 6 15:49:38 2011 +0000]","Body":"BOOKKEEPER-22: Exception in LedgerCache causes addEntry request to fail (fpj via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1132682 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Jun 06 17:49:38 CEST 2011"},{"Commit-ID":"commit d20cb28943e80c1d39cca5916f459651e29dd573 1309226581 -----sp","Author":"PersonIdent[Benjamin Reed, breed@apache.org, Tue Jun 28 02:03:01 2011 +0000]","Body":"initial setup for hedwig and bookkeeper doc\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1140397 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Jun 28 04:03:01 CEST 2011"},{"Commit-ID":"commit 00f25f5622e69f063202f7bd46f09ad1d708983d 1310049470 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Thu Jul 7 14:37:50 2011 +0000]","Body":"BOOKKEEPER-5: Issue with Netty in BookKeeper (fpj and ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1143850 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jul 07 16:37:50 CEST 2011"},{"Commit-ID":"commit 45aeb04735d120d3aa9a0110becf3ba2d7ef6afc 1310466965 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Tue Jul 12 10:36:05 2011 +0000]","Body":"BOOKKEEPER-30: Test are too noisy (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1145532 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Jul 12 12:36:05 CEST 2011"},{"Commit-ID":"commit 74397e3e20b2cd3e3c920f00be7f044cf548e076 1311878032 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Jul 28 18:33:52 2011 +0000]","Body":"BOOKKEEPER-11: Read from open ledger (fpj via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1151958 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jul 28 20:33:52 CEST 2011"},{"Commit-ID":"commit 3e9d596480537e45a23e591a1daabddffd2b15bf 1312070308 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Sat Jul 30 23:58:28 2011 +0000]","Body":"BOOKKEEPER-27: mvn site failed with unresolved dependencies (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1152529 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sun Jul 31 01:58:28 CEST 2011"},{"Commit-ID":"commit de1c3b26a1162fb545c91d9cef4eed435c662a66 1312972659 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Aug 10 10:37:39 2011 +0000]","Body":"BOOKKEEPER-29: BookieRecoveryTest fails intermittently (fpj via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1156096 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Aug 10 12:37:39 CEST 2011"},{"Commit-ID":"commit 0910d6cd7ffb1a7b78ab91a327715e936a3eb9e5 1313087812 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Thu Aug 11 18:36:52 2011 +0000]","Body":"BOOKKEEPER-33: Add length and offset parameter to addEntry (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1156723 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Aug 11 20:36:52 CEST 2011"},{"Commit-ID":"commit 40b13a6b7db9d2da337dce0c7084d8c87c4d6b06 1313091441 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Thu Aug 11 19:37:21 2011 +0000]","Body":"BOOKKEEPER-29: BookieRecoveryTest fails intermittently (ivank, fpj via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1156766 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Aug 11 21:37:21 CEST 2011"},{"Commit-ID":"commit a772663c8e7051396bac5bae5b4ba7bc7ec75e78 1314138898 -----sp","Author":"PersonIdent[Benjamin Reed, breed@apache.org, Tue Aug 23 22:34:58 2011 +0000]","Body":"BOOKKEEPER-43: NullPointException when releasing topic\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1160913 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Aug 24 00:34:58 CEST 2011"},{"Commit-ID":"commit a01067bb2003e6836acc638b734581844eb08324 1314139109 -----sp","Author":"PersonIdent[Benjamin Reed, breed@apache.org, Tue Aug 23 22:38:29 2011 +0000]","Body":"BOOKKEEPER-38: Bookie Server doesn't exit when its zookeeper session is expired. So the process is hang there.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1160915 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Aug 24 00:38:29 CEST 2011"},{"Commit-ID":"commit 5095045d969a5fb4b7849cce89e3fa24ee830320 1314139352 -----sp","Author":"PersonIdent[Benjamin Reed, breed@apache.org, Tue Aug 23 22:42:32 2011 +0000]","Body":"BOOKKEEPER-44: Reuse publish channel to default server to avoid too many connect requests to default server when lots of producers came in same time\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1160917 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Aug 24 00:42:32 CEST 2011"},{"Commit-ID":"commit c30c309bf95a6ba145d33326af73253fb835b1b4 1314139426 -----sp","Author":"PersonIdent[Benjamin Reed, breed@apache.org, Tue Aug 23 22:43:46 2011 +0000]","Body":"forgot to add test from BOOKKEEPER-38\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1160918 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Aug 24 00:43:46 CEST 2011"},{"Commit-ID":"commit ad96c00dcd01ee310c63f78211c6b66c8c874e05 1314639181 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Aug 29 17:33:01 2011 +0000]","Body":"BOOKKEEPER-58: Changes introduced in BK-38 cause BookieClientTest to hang indefinitely. (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1162912 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Aug 29 19:33:01 CEST 2011"},{"Commit-ID":"commit da1df6bcf4f3a1cc2ed4d3798764e855555ab8f8 1314639256 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Aug 29 17:34:16 2011 +0000]","Body":"BOOKKEEPER-18: maven build is unstable (morel, ivank via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1162913 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Aug 29 19:34:16 CEST 2011"},{"Commit-ID":"commit afdd3dd1e7e06f97e29ff5bcaa2001f81f6d9210 1314693271 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Aug 30 08:34:31 2011 +0000]","Body":"BOOKKEEPER-28: Create useful startup scripts for bookkeeper and hedwig (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1163137 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Aug 30 10:34:31 CEST 2011"},{"Commit-ID":"commit 675efc92fdb7c88ff9b871ba2ccf56974f769544 1314695673 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Aug 30 09:14:33 2011 +0000]","Body":"BOOKKEEPER-51: NullPointException at FIFODeliveryManager#deliveryPtrs (xulei via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1163149 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Aug 30 11:14:33 CEST 2011"},{"Commit-ID":"commit 360174f12df9b853e4f3b65631c4063e150beb8f 1314699231 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Aug 30 10:13:51 2011 +0000]","Body":"BOOKKEEPER-52: Message sequence confuse due to the subscribeMsgQueue@SubscribeResponseHandler (xulei via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1163161 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Aug 30 12:13:51 CEST 2011"},{"Commit-ID":"commit 28377803242f8514fcdf17f7a808aa756fa158b9 1314802786 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Aug 31 14:59:46 2011 +0000]","Body":"BOOKKEEPER-57: NullPointException at bookie.zk@EntryLogger (xulei via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1163655 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Aug 31 16:59:46 CEST 2011"},{"Commit-ID":"commit 79ea05a3cbcc953bd86f024eb4143e4b85fcd8f1 1315218759 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Sep 5 10:32:39 2011 +0000]","Body":"BOOKKEEPER-63: Hedwig PubSubServer must wait for its Zookeeper client to be connected upon startup (morel via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1165231 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Sep 05 12:32:39 CEST 2011"},{"Commit-ID":"commit ba9ebc213c14aa5d16a26f2e0601a39ac5888e10 1315244337 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Mon Sep 5 17:38:57 2011 +0000]","Body":"BOOKKEEPER-26: Indentation is all messed up in the BookKeeper code (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1165369 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Sep 05 19:38:57 CEST 2011"},{"Commit-ID":"commit 6823a35ceafcaf3d8802a8e502883d3d07e891f7 1316184938 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Fri Sep 16 14:55:38 2011 +0000]","Body":"BOOKKEEPER-59: Race condition in netty code allocates and orphans resources (BK-5 revisited) (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1171607 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Sep 16 16:55:38 CEST 2011"},{"Commit-ID":"commit 06eea6791177f3d9dcb116ceccff2f6c3f619a39 1317920051 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Thu Oct 6 16:54:11 2011 +0000]","Body":"BOOKKEEPER-41: Generation of packages for distribution (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1179705 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Oct 06 18:54:11 CEST 2011"},{"Commit-ID":"commit 9639b64a1296f937a7b2704de671a38deb31007b 1318026261 -----sp","Author":"PersonIdent[Benjamin Reed, breed@apache.org, Fri Oct 7 22:24:21 2011 +0000]","Body":"  BOOKKEEPER-61: BufferedChannel read endless when the remaining bytes of file is less than the capacity of read buffer\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1180266 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Oct 08 00:24:21 CEST 2011"},{"Commit-ID":"commit c980c700d1313911903df3d4c3d48cf8da441827 1318887566 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Oct 17 21:39:26 2011 +0000]","Body":"BOOKKEEPER-65: fix dependencies on incompatible versions of netty (mmorel via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1185388 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Oct 17 23:39:26 CEST 2011"},{"Commit-ID":"commit 2f2f6c66da80e1f2e8a0f7661e91bcd0898d6289 1318927366 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Oct 18 08:42:46 2011 +0000]","Body":"BOOKKEEPER-68: Conditional setData (fpj via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1185532 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Oct 18 10:42:46 CEST 2011"},{"Commit-ID":"commit 2c91d144a7e283c09e90b3065aa6fb352e177083 1318961672 -----sp","Author":"PersonIdent[Benjamin Reed, breed@apache.org, Tue Oct 18 18:14:32 2011 +0000]","Body":"BOOKKEEPER-86: bookkeeper-benchmark fails to compile after BOOKKEEPER-68\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1185775 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Oct 18 20:14:32 CEST 2011"},{"Commit-ID":"commit d05e52ce5a6bf8b0076685ccec03f5ab91b2b32d 1319048401 -----sp","Author":"PersonIdent[Benjamin Reed, breed@apache.org, Wed Oct 19 18:20:01 2011 +0000]","Body":"missing CHANGE.txt entry for BOOKKEEPER-61 (commit 1180266)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1186382 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Oct 19 20:20:01 CEST 2011"},{"Commit-ID":"commit 477eb1053f5c1bff1c0037fb0d6a02b468148682 1319350280 -----sp","Author":"PersonIdent[Benjamin Reed, breed@apache.org, Sun Oct 23 06:11:20 2011 +0000]","Body":"BOOKKEEPER-84: Add versioning for ZK metadata\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1187846 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sun Oct 23 08:11:20 CEST 2011"},{"Commit-ID":"commit 4f09c6b4af38b51d259d8a6068806f7f22cc1847 1319449218 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Oct 24 09:40:18 2011 +0000]","Body":"BOOKKEEPER-88: derby doesn't like - in the topic names (breed via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1188059 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Oct 24 11:40:18 CEST 2011"},{"Commit-ID":"commit 45f2edbb1c3233309f6498e581e4cdcd87dcb70a 1319555790 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Oct 25 15:16:30 2011 +0000]","Body":"BOOKKEEPER-92: using wrong context object in readLastConfirmedComplete callback (Sijie Guo via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1188704 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Oct 25 17:16:30 CEST 2011"},{"Commit-ID":"commit d6465cad801b4ee89b77d1beec6acc371f8ddb6c 1319637998 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Oct 26 14:06:38 2011 +0000]","Body":"BOOKKEEPER-94: Double callbacks in readLastConfirmedOp which fails readLastConfirmed operation even received enough valid responses. (Sijie Guo via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1189225 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Oct 26 16:06:38 CEST 2011"},{"Commit-ID":"commit c898d53ab269fbd64cb00919808c7bb0c52c53a6 1319722879 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Oct 27 13:41:19 2011 +0000]","Body":"BOOKKEEPER-83: Added versioning and flags to the bookie protocol (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1189753 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Oct 27 15:41:19 CEST 2011"},{"Commit-ID":"commit 68bdab655445f80314a0d2531e60e3b2e4d8fa17 1319732778 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Oct 27 16:26:18 2011 +0000]","Body":"BOOKKEEPER-89: Bookkeeper API changes for initial Bookkeeper release (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1189842 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Oct 27 18:26:18 CEST 2011"},{"Commit-ID":"commit d1823db0509fe49b0ce8140c620e4c5100427407 1319734414 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Oct 27 16:53:34 2011 +0000]","Body":"BOOKKEEPER-93: bookkeeper doesn't work correctly on OpenLedgerNoRecovery (Sijie Guo via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1189867 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Oct 27 18:53:34 CEST 2011"},{"Commit-ID":"commit ea616470cfbd129bb03098698a562e1b8dd8ecc4 1319735571 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Oct 27 17:12:51 2011 +0000]","Body":"BOOKKEEPER-100: Some hedwig tests have build errors (dferro via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1189874 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Oct 27 19:12:51 CEST 2011"},{"Commit-ID":"commit dc5f5d223502b8bc9ef6bc3706f3bbea975e757e 1319809003 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Oct 28 13:36:43 2011 +0000]","Body":"BOOKKEEPER-71: hedwig c++ client does not build . (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1190306 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Oct 28 15:36:43 CEST 2011"},{"Commit-ID":"commit 978c0e13dd5896494f306ec2afed026caa9993b0 1320400829 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Nov 4 10:00:29 2011 +0000]","Body":"BOOKKEEPER-103: ledgerId and entryId is parsed wrong when addEntry (Sijie Guo via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1197472 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Nov 04 11:00:29 CET 2011"},{"Commit-ID":"commit e7184063b0fa20fbbb9802863143a11183858656 1320402274 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Nov 4 10:24:34 2011 +0000]","Body":"BOOKKEEPER-102: Make bookkeeper use ZK from temporary repo (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1197489 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Nov 04 11:24:34 CET 2011"},{"Commit-ID":"commit c17dfb9aa2aeb6d3d1c6fa934dc9ef15bf6b5bc2 1320403604 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Nov 4 10:46:44 2011 +0000]","Body":"BOOKKEEPER-50: NullPointException at LedgerDescriptor#cmpMasterKey (Sijie Guo via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1197495 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Nov 04 11:46:44 CET 2011"},{"Commit-ID":"commit 2ea2fd09f2bbbea18e183c8af8e82e81eee9fe79 1320775098 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Nov 8 17:58:18 2011 +0000]","Body":"BOOKKEEPER-107: memory leak in HostAddress of hedwig c++ client (Sijie Guo via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1199368 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Nov 08 18:58:18 CET 2011"},{"Commit-ID":"commit 6e3b195d16ef4b24618d7bb13b3eede6b9126e74 1320775789 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Nov 8 18:09:49 2011 +0000]","Body":"BOOKKEEPER-80: subscription msg queue race condition in hedwig c++ client (Sijie Guo via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1199372 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Nov 08 19:09:49 CET 2011"},{"Commit-ID":"commit cc467bd5880c2879e6c0355469d51759f89bbabc 1321007059 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Fri Nov 11 10:24:19 2011 +0000]","Body":"BOOKKEEPER-82: support journal rolling (Sijie Guo via fpj)\n\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1200806 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Nov 11 11:24:19 CET 2011"},{"Commit-ID":"commit 75dbf699b90dd01b0dd44e4bdda60e7176b3ee12 1321382578 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Tue Nov 15 18:42:58 2011 +0000]","Body":"BOOKKEEPER-106: recoveryBookieData can select a recovery bookie which is already in the ledgers ensemble\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1202370 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Nov 15 19:42:58 CET 2011"},{"Commit-ID":"commit 64411b9af4eede947f0cf0fd46da4d3170ec18e4 1321382673 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Tue Nov 15 18:44:33 2011 +0000]","Body":"BOOKKEEPER-106:\trecoveryBookieData can select a recovery bookie which is already in the ledgers ensemble (forgot to edit CHANGES.txt)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1202372 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Nov 15 19:44:33 CET 2011"},{"Commit-ID":"commit 4d9f0c0ebe8614e0190c5df5bbd68c6fa1c05180 1321459552 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Nov 16 16:05:52 2011 +0000]","Body":"BOOKKEEPER-101 : Add Fencing to Bookkeeper (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1202758 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Nov 16 17:05:52 CET 2011"},{"Commit-ID":"commit 4be547c861f024e48a7b0074effb8c26ff0a97fc 1321466464 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Nov 16 18:01:04 2011 +0000]","Body":"BOOKKEEPER-104: Add versioning between bookie and its filesystem layout (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1202814 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Nov 16 19:01:04 CET 2011"},{"Commit-ID":"commit b83d00086a263af5b51e3e061170934c53447976 1321518450 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Thu Nov 17 08:27:30 2011 +0000]","Body":"BOOKKEEPER-109: Add documentation to describe how bookies flushes data (Sijie Guo via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1203103 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Nov 17 09:27:30 CET 2011"},{"Commit-ID":"commit 304bf8fe61bd545072d09c7089d8b92fc3c2f1d3 1321520376 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Thu Nov 17 08:59:36 2011 +0000]","Body":"BOOKKEEPER-81: disk space of garbage collected entry logger files isn't reclaimed util process quit (Sijie Guo via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1203118 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Nov 17 09:59:36 CET 2011"},{"Commit-ID":"commit 3969ff71a1865b5b8c32b60ac529999c6de71ab8 1321524992 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Thu Nov 17 10:16:32 2011 +0000]","Body":"BOOKKEEPER-91: Bookkeeper and hedwig clients should not use log4j directly (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1203138 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Nov 17 11:16:32 CET 2011"},{"Commit-ID":"commit 03e03c2b4a0eb0266cad4eb5e34099100629425e 1321538427 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Thu Nov 17 14:00:27 2011 +0000]","Body":"BOOKKEEPER-87: TestHedwigHub exhausts direct buffer memory with netty 3.2.4.Final (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1203191 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Nov 17 15:00:27 CET 2011"},{"Commit-ID":"commit e14618559769b7f3fa68360a4571a84392e162e3 1321565929 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Thu Nov 17 21:38:49 2011 +0000]","Body":"BOOKKEEPER-90: Hedwig API changes for initial Bookkeeper release (ivank via fpj)\n\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1203380 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Nov 17 22:38:49 CET 2011"},{"Commit-ID":"commit 4049d4c2b115f81008ef7a3920fd9153ced2f53c 1321611485 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Nov 18 10:18:05 2011 +0000]","Body":"BOOKKEEPER-108: add configuration support for BK (Sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1203568 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Nov 18 11:18:05 CET 2011"},{"Commit-ID":"commit 4afc000c193174857925f357a32950ab743490bc 1321612726 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Nov 18 10:38:46 2011 +0000]","Body":"BOOKKEEPER-69: ServerRedirectLoopException when a machine (hosts bookie server & hub server) reboot, which is caused by race condition of topic manager (Sijie, ivank via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1203576 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Nov 18 11:38:46 CET 2011"},{"Commit-ID":"commit d33f843a67ad8bc73367259c78170c0bfab24cdc 1321639573 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Nov 18 18:06:13 2011 +0000]","Body":"BOOKKEEPER-115: LocalBookKeeper fails after BOOKKEEPER-108 (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1203774 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Nov 18 19:06:13 CET 2011"},{"Commit-ID":"commit aed845b574b88abc825634d3c860dcfd40351fb8 1321642703 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Nov 18 18:58:23 2011 +0000]","Body":"BOOKKEEPER-114: add a shutdown hook to shut down bookie server safely. (Sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1203790 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Nov 18 19:58:23 CET 2011"},{"Commit-ID":"commit 1bcbc47bcc6394b0c6fdeb73203aab59eab0fee5 1321871560 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Nov 21 10:32:40 2011 +0000]","Body":"BOOKKEEPER-79: randomly startDelivery/stopDelivery will core dump in c++ hedwig client (Sijie Guo via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1204437 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Nov 21 11:32:40 CET 2011"},{"Commit-ID":"commit e110067476eb55289d6dd86a94a6a1b0ab1a2ad8 1322482552 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Nov 28 12:15:52 2011 +0000]","Body":"BOOKKEEPER-118: Hedwig client doesn't kill and remove old subscription channel after redirection. (Sijie Guo via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1207099 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Nov 28 13:15:52 CET 2011"},{"Commit-ID":"commit 9daeb60bc274a425b9e90ed50d3454a6bfb3cf31 1322493468 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Nov 28 15:17:48 2011 +0000]","Body":"BOOKKEEPER-117: Support multi threads in hedwig cpp client to leverage multi-core hardware (Sijie Guo via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1207289 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Nov 28 16:17:48 CET 2011"},{"Commit-ID":"commit d5d73a8591369458c075034b8111f0dfabc2916d 1322497947 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Mon Nov 28 16:32:27 2011 +0000]","Body":"BOOKKEEPER-119: Keys in configuration have inconsistent style (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1207396 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Nov 28 17:32:27 CET 2011"},{"Commit-ID":"commit 3af9f38fc3b53c40751904972384ecb9a4e9fb44 1322504718 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Nov 28 18:25:18 2011 +0000]","Body":"BOOKKEEPER-39: Bookie server failed to restart because of too many ledgers (more than ~50,000 ledgers) (Sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1207495 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Nov 28 19:25:18 CET 2011"},{"Commit-ID":"commit 924fb834de0ae926ea075385c47dd29f8dd804a3 1322517713 -----sp","Author":"PersonIdent[Benjamin Reed, breed@apache.org, Mon Nov 28 22:01:53 2011 +0000]","Body":"BOOKKEEPER-53: race condition of outstandingMsgSet@SubscribeResponseHandler\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1207648 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Nov 28 23:01:53 CET 2011"},{"Commit-ID":"commit c323c003687319d20eb7539c0e85a9cf3a4a6d08 1322557553 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Nov 29 09:05:53 2011 +0000]","Body":"BOOKKEEPER-124: build has RAT failures (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1207797 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Nov 29 10:05:53 CET 2011"},{"Commit-ID":"commit 504867718d934b66dfa4df8edc55c9c888aa3d42 1322588758 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Nov 29 17:45:58 2011 +0000]","Body":"BOOKKEEPER-125: log4j still used in some places (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1207996 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Nov 29 18:45:58 CET 2011"},{"Commit-ID":"commit da088187d80bf0b935aad14c1a4aa73e4920378f 1322588796 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Nov 29 17:46:36 2011 +0000]","Body":"BOOKKEEPER-62: Bookie can not start when encountering corrupted records (breed via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1207997 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Nov 29 18:46:36 CET 2011"},{"Commit-ID":"commit 8b6f36788cb4614d506e0e526475592cd8fbeb6a 1322596818 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Nov 29 20:00:18 2011 +0000]","Body":"BOOKKEEPER-121: Review Hedwig client documentation (breed via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1208050 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Nov 29 21:00:18 CET 2011"},{"Commit-ID":"commit aa1d8296672a1a29fdc3de630f5995c0d1a21429 1322605613 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Nov 29 22:26:53 2011 +0000]","Body":"BOOKKEEPER-127: Make poms use official zookeeper 3.4.0 (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1208109 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Nov 29 23:26:53 CET 2011"},{"Commit-ID":"commit e3b52e82ccccf4807100db0950609ec7ede8378c 1322605782 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Nov 29 22:29:42 2011 +0000]","Body":"BOOKKEEPER-120: Review BookKeeper client documentation (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1208111 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Nov 29 23:29:42 CET 2011"},{"Commit-ID":"commit 544f4b5c0480bb383134fe6e26c2fe0e0a6c8b11 1322607324 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Nov 29 22:55:24 2011 +0000]","Body":"BOOKKEEPER-122: Review BookKeeper server documentation (fpj & ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1208123 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Nov 29 23:55:24 CET 2011"},{"Commit-ID":"commit 86040b51874dcb40d1693593942d975c8327e919 1322608502 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Nov 29 23:15:02 2011 +0000]","Body":"BOOKKEEPER-122: Review BookKeeper server documentation (fpj & ivank) [Forgot to add 2 files]\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1208129 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Nov 30 00:15:02 CET 2011"},{"Commit-ID":"commit 49aa4df144abcd6b117ac376b71ac70a5af946b7 1322608778 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Nov 29 23:19:38 2011 +0000]","Body":"BOOKKEEPER-111: Document bookie recovery feature (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1208133 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Nov 30 00:19:38 CET 2011"},{"Commit-ID":"commit fa78ba95d4e6ccff5ebb734e6036b11c802b3030 1322647643 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Nov 30 10:07:23 2011 +0000]","Body":"BOOKKEEPER-128: pom and script modifications required for generating release packages (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1208358 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Nov 30 11:07:23 CET 2011"},{"Commit-ID":"commit 92e69b331797ea6a4eb4d46b668360e6c7bb9bd4 1322649546 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Nov 30 10:39:06 2011 +0000]","Body":"BOOKKEEPER-129: ZK_TIMEOUT typo in client/server configuration (Sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1208372 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Nov 30 11:39:06 CET 2011"},{"Commit-ID":"commit 12840c3e9e85ac400597d26663b19277c41987a7 1322651444 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Nov 30 11:10:44 2011 +0000]","Body":"BOOKKEEPER-130: Add developer KEYS file to svn (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1208382 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Nov 30 12:10:44 CET 2011"},{"Commit-ID":"commit f2e9d4ca08e6ce254c61e0a27a04a7b2f95c6642 1322653825 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Nov 30 11:50:25 2011 +0000]","Body":"Cleanup of CHANGES.txt before cutting 4.0.0 branch\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1208395 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Nov 30 12:50:25 CET 2011"},{"Commit-ID":"commit 814f0ab6b4d43a35992e995c8abd804326ec633b 1322653921 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Nov 30 11:52:01 2011 +0000]","Body":"Preparing for release 4.0.0\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1208396 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Nov 30 12:52:01 CET 2011"},{"Commit-ID":"commit 5b90ba75a5cfa13a77297fd488024cd05ce07420 1322654397 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Nov 30 11:59:57 2011 +0000]","Body":"Fixing CHANGES.txt for new trunk\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1208398 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Nov 30 12:59:57 CET 2011"},{"Commit-ID":"commit 9794cc0c6d8531c1a6540db660e55add2469d019 1322654515 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Nov 30 12:01:55 2011 +0000]","Body":"Bumping version number for trunk: 4.0.0 -> 4.1.0\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1208399 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Nov 30 13:01:55 CET 2011"},{"Commit-ID":"commit 3bc2bdb0d0f38b004fa95a58e8b02104005c663b 1322667734 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Nov 30 15:42:14 2011 +0000]","Body":"BOOKKEEPER-66: use IPv4 for builds (mmorel via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1208472 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Nov 30 16:42:14 CET 2011"},{"Commit-ID":"commit 63b032331f28fe434ea37d7cb2e515609298b7ed 1322669925 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Nov 30 16:18:45 2011 +0000]","Body":"BOOKKEEPER-132: Sign artifacts before deploying to maven (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1208487 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Nov 30 17:18:45 CET 2011"},{"Commit-ID":"commit 86844d7303f62a8e2361ca56d83ba2d47e5c77b8 1322773688 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Dec 1 21:08:08 2011 +0000]","Body":"BOOKKEEPER-131: Fix zookeeper test dependency (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1209237 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Dec 01 22:08:08 CET 2011"},{"Commit-ID":"commit dcfe4bcc5123eb70a5366bbf3b4931d8d23f9e48 1322778406 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Dec 1 22:26:46 2011 +0000]","Body":"BOOKKEEPER-134: Delete superfluous lib directories (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1209276 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Dec 01 23:26:46 CET 2011"},{"Commit-ID":"commit 213db5d6a6d55b5b093776a4c54fa5c8ffed5f0d 1322850163 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Dec 2 18:22:43 2011 +0000]","Body":"Reverting BOOKKEEPER-130: Add developer KEYS file to svn (ivank) \n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1209621 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Dec 02 19:22:43 CET 2011"},{"Commit-ID":"commit d006007ccf86f924d0773e267675a52e98314710 1322854423 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Dec 2 19:33:43 2011 +0000]","Body":"BOOKKEEPER-138: NOTICE.txt is invalid (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1209650 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Dec 02 20:33:43 CET 2011"},{"Commit-ID":"commit 1c90beb59a6aa94f18ca6b5ca1f94a0db5e0cc14 1322855939 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Dec 2 19:58:59 2011 +0000]","Body":"BOOKKEEPER-139: Binary packages do not carry NOTICE.txt (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1209671 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Dec 02 20:58:59 CET 2011"},{"Commit-ID":"commit 9eb549d4c308963af0be3288a59b0c4c39cbb5e6 1324035811 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Dec 16 11:43:31 2011 +0000]","Body":"BOOKKEEPER-142: Parsing last log id is wrong, which may make entry log files overwritten (Sijie Gou via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1215098 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Dec 16 12:43:31 CET 2011"},{"Commit-ID":"commit 015097021c1a2d2860643fda7fcb3e8a0d191442 1324045978 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Dec 16 14:32:58 2011 +0000]","Body":"BOOKKEEPER-141: Run extracting ledger id from entry log files in GC thread to speed up bookie restart (Sijie Gou via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1215156 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Dec 16 15:32:58 CET 2011"},{"Commit-ID":"commit 8f755ed13f193ad6491fdca1794d834f3d3d4dcc 1324485803 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Dec 21 16:43:23 2011 +0000]","Body":"BOOKKEEPER-140: Hub server doesn't subscribe remote region correctly when a region is down. (Sijie Gou via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1221798 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Dec 21 17:43:23 CET 2011"},{"Commit-ID":"commit 0975f069d90748eb43fcec7622d3961b0446ea28 1324575348 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Dec 22 17:35:48 2011 +0000]","Body":"BOOKKEEPER-133: Hub server should update subscription state to zookeeper when losing topic or shutting down (Sijie Gou via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1222365 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Dec 22 18:35:48 CET 2011"},{"Commit-ID":"commit e32715ad96558a9941910dd6ae91fc1c646baeb6 1326293189 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Wed Jan 11 14:46:29 2012 +0000]","Body":"BOOKKEEPER-148: Jenkins build is failing (ivank via fpj)\n\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1230070 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jan 11 15:46:29 CET 2012"},{"Commit-ID":"commit 0d43f404ea145a35d46371967975f9590649a033 1326474401 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Jan 13 17:06:41 2012 +0000]","Body":"BOOKKEEPER-40: BookieClientTest fails intermittantly (fpj via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1231187 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Jan 13 18:06:41 CET 2012"},{"Commit-ID":"commit c7c8af741a2f532b554dcdabf85237c23ea14aaa 1326815536 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Jan 17 15:52:16 2012 +0000]","Body":"BOOKKEEPER-150: Entry is lost when recovering a ledger with not enough bookies. (Sijie Guo via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1232448 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Jan 17 16:52:16 CET 2012"},{"Commit-ID":"commit cdcfbb52cbf8f0e6f17d56d7185cf0d04c9c856b 1326888588 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Jan 18 12:09:48 2012 +0000]","Body":"BOOKKEEPER-95: extends zookeeper JMX to monitor and manage bookie server (Sijie Guo via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1232852 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jan 18 13:09:48 CET 2012"},{"Commit-ID":"commit f56e596d70c66dac170008ffbe19489eee05be08 1326895906 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Jan 18 14:11:46 2012 +0000]","Body":"BOOKKEEPER-153: Ledger can't be opened or closed due to zero-length metadata (Sijie Guo via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1232890 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jan 18 15:11:46 CET 2012"},{"Commit-ID":"commit 7e12629ed7a2006e4805dac0e5c006324a52d5db 1328094392 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Feb 1 11:06:32 2012 +0000]","Body":"BOOKKEEPER-23: Timeout requests (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1239068 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Feb 01 12:06:32 CET 2012"},{"Commit-ID":"commit 5a7f4991610ad60d277830b72dc5d890c63a0f07 1328097497 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Feb 1 11:58:17 2012 +0000]","Body":"BOOKKEEPER-98: collect add/read statistics on bookie server (Sijie Guo via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1239096 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Feb 01 12:58:17 CET 2012"},{"Commit-ID":"commit d5fc00dc6b0a888b68131b7dff7309687c96d07e 1328097709 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Feb 1 12:01:49 2012 +0000]","Body":"Removing file accidentally added in r1239096\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1239098 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Feb 01 13:01:49 CET 2012"},{"Commit-ID":"commit 835d963cb26d0a5d5b1cc79a0faf185b49673d16 1328109597 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Wed Feb 1 15:19:57 2012 +0000]","Body":"BOOKKEEPER-157. For small packets, increasing number of bookies actually degrades performance. (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1239167 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Feb 01 16:19:57 CET 2012"},{"Commit-ID":"commit cfe3e650b69b2b599dd5b2f27f2164af38c7a2be 1328608997 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Feb 7 10:03:17 2012 +0000]","Body":"BOOKKEEPER-161: PerChannelBookieClient tries to reuse HashedWheelTimer, throws Exception (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1241404 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Feb 07 11:03:17 CET 2012"},{"Commit-ID":"commit 3272204448bf210d03377ba822d01419ad197a17 1328697619 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Feb 8 10:40:19 2012 +0000]","Body":"BOOKKEEPER-167: PerChannelBookieClient doesn't use ClientConfiguration (Sijie Guo via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1241854 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Feb 08 11:40:19 CET 2012"},{"Commit-ID":"commit bd2efa12f1f63afa90723ce405caebafb4afd6be 1328697643 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Feb 8 10:40:43 2012 +0000]","Body":"BOOKKEEPER-156: BookieJournalRollingTest failing (Sijie Guo via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1241855 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Feb 08 11:40:43 CET 2012"},{"Commit-ID":"commit a3c9c953db49bc1ec3d72f01212e6cbcd58cc5d3 1328698150 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Feb 8 10:49:10 2012 +0000]","Body":"BOOKKEEPER-77: Add a console client for hedwig (Sijie Guo via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1241858 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Feb 08 11:49:10 CET 2012"},{"Commit-ID":"commit beca5951f73cb9c39be10a4166a90dee9fff3c1c 1328712869 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Feb 8 14:54:29 2012 +0000]","Body":"BOOKKEEPER-165: Add versioning support for journal files (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1241922 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Feb 08 15:54:29 CET 2012"},{"Commit-ID":"commit c65d6ada34215ee3a5466c495d565d745857c435 1328807669 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Feb 9 17:14:29 2012 +0000]","Body":"BOOKKEEPER-137: Do not create Ledger index files until absolutely necessary. (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1242404 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Feb 09 18:14:29 CET 2012"},{"Commit-ID":"commit 29a472598083e522645f918ec602dd91d800f0d5 1329128357 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Mon Feb 13 10:19:17 2012 +0000]","Body":"BOOKKEEPER-162: LedgerHandle.readLastConfirmed does not work (fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1243462 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Feb 13 11:19:17 CET 2012"},{"Commit-ID":"commit 5a3b29d05abd71c6e5d1b3045abafd434db15f24 1329144398 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Feb 13 14:46:38 2012 +0000]","Body":"BOOKKEEPER-152: Can't recover a ledger whose current ensemble contain failed bookie. (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1243539 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Feb 13 15:46:38 CET 2012"},{"Commit-ID":"commit 3defe9e5110472da995789b5ae14c286f58f1293 1329299917 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Feb 15 09:58:37 2012 +0000]","Body":"BOOKKEEPER-171: ServerConfiguration can't use more than one directory for ledgers\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1244421 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Feb 15 10:58:37 CET 2012"},{"Commit-ID":"commit 633a23b3a20b27a551328be2efe5f057be3c99e2 1329318713 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Wed Feb 15 15:11:53 2012 +0000]","Body":"BOOKKEEPER-170: Bookie constructor starts a number of threads. (ivank via fpj)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1244528 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Feb 15 16:11:53 CET 2012"},{"Commit-ID":"commit bad375aa35a2c17c466d2be7481e7d16220d59b0 1329473880 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Feb 17 10:18:00 2012 +0000]","Body":"BOOKKEEPER-169: bookie hangs on reading header when encountering partial header index file (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1245369 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Feb 17 11:18:00 CET 2012"},{"Commit-ID":"commit 014bcd501c14141facd0e3eb4bb488ccba3a2b7d 1329479423 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Feb 17 11:50:23 2012 +0000]","Body":"BOOKKEEPER-174: Bookie can't start when replaying entries whose ledger were deleted and garbage collected. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1245411 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Feb 17 12:50:23 CET 2012"},{"Commit-ID":"commit 110d36673bcc393853aaab4bb423d785daa947c7 1330103420 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Fri Feb 24 17:10:20 2012 +0000]","Body":"BOOKKEEPER-172: Upgrade framework for filesystem layouts (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1293342 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Feb 24 18:10:20 CET 2012"},{"Commit-ID":"commit 9523193456992a2edd36106120a8a9f246af6995 1330106881 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Feb 24 18:08:01 2012 +0000]","Body":"BOOKKEEPER-177: Index file is lost or some index pages aren't flushed. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1293369 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Feb 24 19:08:01 CET 2012"},{"Commit-ID":"commit 2ec70d4dbf2266b17bdb99975f974f30afa65593 1330107656 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Feb 24 18:20:56 2012 +0000]","Body":"BOOKKEEPER-178: Delay ledger directory creation until the ledger index file was created (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1293372 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Feb 24 19:20:56 CET 2012"},{"Commit-ID":"commit 9366322bfe3461a44a8b0444e66cd774ea1ac7d8 1330110477 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Feb 24 19:07:57 2012 +0000]","Body":"BOOKKEEPER-113: NPE In BookKeeper test (fpj via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1293383 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Feb 24 20:07:57 CET 2012"},{"Commit-ID":"commit 76818a6aadd4aa40a45aca6f5b0acba79cd42515 1330611017 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Mar 1 14:10:17 2012 +0000]","Body":"BOOKKEEPER-74: Bookkeeper Persistence Manager should give up topic on error (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1295571 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Mar 01 15:10:17 CET 2012"},{"Commit-ID":"commit 431554da9e2598c73edfbaf671e87cfd9ae94716 1330613888 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Thu Mar 1 14:58:08 2012 +0000]","Body":"BOOKKEEPER-176: HierarchicalBookieFailureTest Hung (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1295604 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Mar 01 15:58:08 CET 2012"},{"Commit-ID":"commit e911559291b6ae9aa310a695fb4174796921ac81 1331205203 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Mar 8 11:13:23 2012 +0000]","Body":"BOOKKEEPER-160: bookie server needs to do compaction over entry log files to reclaim disk space (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1298357 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Mar 08 12:13:23 CET 2012"},{"Commit-ID":"commit cb8296636b961253f9586f535db285bfafa54a8a 1331231091 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Mar 8 18:24:51 2012 +0000]","Body":"BOOKKEEPER-180: bookie server doesn't quit when running out of disk space (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1298492 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Mar 08 19:24:51 CET 2012"},{"Commit-ID":"commit 028a6d5360637417141f7f819a404e8e71117f9b 1331300900 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Fri Mar 9 13:48:20 2012 +0000]","Body":"BOOKKEEPER-158: Move latest benchmarking code into trunk (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1298825 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Mar 09 14:48:20 CET 2012"},{"Commit-ID":"commit 8207445ea25bef37e3369e749913acc0d597d9b2 1331303260 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Mar 9 14:27:40 2012 +0000]","Body":"Set benchmark script to executable (BOOKKEEPER-158)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1298847 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Mar 09 15:27:40 CET 2012"},{"Commit-ID":"commit c6cc7cca3a85603c8e935ba6d06fbf3d8d7a7eb5 1331620296 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Mar 13 06:31:36 2012 +0000]","Body":"BOOKKEEPER-163: Prevent incorrect NoSuchLedgerException for readLastConfirmed. (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1299984 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Mar 13 07:31:36 CET 2012"},{"Commit-ID":"commit fd5bb2bce8585ef49ba01d853241a4ee36d487e2 1331724543 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Mar 14 11:29:03 2012 +0000]","Body":"BOOKKEEPER-168: Message bounding on subscriptions (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1300510 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Mar 14 12:29:03 CET 2012"},{"Commit-ID":"commit e8a1dec3fbea9b2f8c59c32e2f189d60c1864688 1331741514 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Mar 14 16:11:54 2012 +0000]","Body":"BOOKKEEPER-185: Remove bookkeeper-server dependency on hadoop-common (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1300616 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Mar 14 17:11:54 CET 2012"},{"Commit-ID":"commit a4bded985ca1346a17ee0dcf08fe9dcd570dcfb7 1331804263 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Mar 15 09:37:43 2012 +0000]","Body":"BOOKKEEPER-184: CompactionTest failing on Jenkins (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1300862 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Mar 15 10:37:43 CET 2012"},{"Commit-ID":"commit 33bef6356dfcf14928314e14c20ae73de80bdf99 1331890905 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Mar 16 09:41:45 2012 +0000]","Body":"BOOKKEEPER-182: Entry log file is overwritten when fail to read lastLogId. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1301395 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Mar 16 10:41:45 CET 2012"},{"Commit-ID":"commit 0663029788d504f38e98fd79e625a466bb4780c9 1332158691 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Mar 19 12:04:51 2012 +0000]","Body":"BOOKKEEPER-96: extends zookeeper JMX to monitor and manage hedwig server (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1302392 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Mar 19 13:04:51 CET 2012"},{"Commit-ID":"commit 3abac4eb86d64286d057d73024a177ef300283b0 1332165735 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Mar 19 14:02:15 2012 +0000]","Body":"BOOKKEEPER-186: Bookkeeper throttling - permits is not released when read has failed from all replicas (Rakesh R via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1302458 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Mar 19 15:02:15 CET 2012"},{"Commit-ID":"commit 841e7dc187b17e6cf4c437fc211f9e285191dd7c 1332244263 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Mar 20 11:51:03 2012 +0000]","Body":"BOOKKEEPER-187: Create well defined interface for LedgerCache (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1302851 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Mar 20 12:51:03 CET 2012"},{"Commit-ID":"commit 7199719beebe79325a93ef57a1140c2ed50c26e9 1332248947 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Mar 20 13:09:07 2012 +0000]","Body":"BOOKKEEPER-175: Bookie code is very coupled (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1302870 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Mar 20 14:09:07 CET 2012"},{"Commit-ID":"commit f3a404e4e6b0d0c2a0b2a83d38cdedaff0683e68 1332306803 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Mar 21 05:13:23 2012 +0000]","Body":"BOOKKEEPER-188: Garbage collection code is in the wrong place (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1303286 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Mar 21 06:13:23 CET 2012"},{"Commit-ID":"commit 3d32544c0b2b1cd5b184531846a451f518486c7d 1332308455 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Mar 21 05:40:55 2012 +0000]","Body":"BOOKKEEPER-189: AbstractZkLedgerManager doesn't disregard cookies (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1303291 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Mar 21 06:40:55 CET 2012"},{"Commit-ID":"commit 6d56d60831a63fe9520ce156686d0cb1142e44f5 1332971860 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Mar 28 21:57:40 2012 +0000]","Body":"BOOKKEEPER-195: HierarchicalLedgerManager doesn't consider idgen as a \"specialNode\" (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1306616 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Mar 28 23:57:40 CEST 2012"},{"Commit-ID":"commit c805430253c6e6bb4341ad51b406ceabeafcd4e8 1333022833 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Mar 29 12:07:13 2012 +0000]","Body":"BOOKKEEPER-97: collect pub/sub/consume statistics on hub server (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1306798 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Mar 29 14:07:13 CEST 2012"},{"Commit-ID":"commit 48304c7c07513a15d26cb61f311c9f4b998fd8fc 1333027114 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Mar 29 13:18:34 2012 +0000]","Body":"BOOKKEEPER-190: Add entries would fail when number of open ledgers reaches more than openFileLimit. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1306839 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Mar 29 15:18:34 CEST 2012"},{"Commit-ID":"commit 83e8672a10fab050a5bbcc1beeb9a210c1b2b90b 1333028481 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Mar 29 13:41:21 2012 +0000]","Body":"BOOKKEEPER-194: Get correct latency for addEntry operations for JMX. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1306857 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Mar 29 15:41:21 CEST 2012"},{"Commit-ID":"commit 4b32e049dca4a1a8eea4bfb2325aee2de629b132 1333105220 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Mar 30 11:00:20 2012 +0000]","Body":"BOOKKEEPER-166: Bookie will not recover its journal if the length prefix of an entry is truncated (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1307353 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Mar 30 13:00:20 CEST 2012"},{"Commit-ID":"commit 30c68b0bebff1e0a012dd81e8f05ebbf83b4ff5f 1333177987 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Mar 31 07:13:07 2012 +0000]","Body":"BOOKKEEPER-193: Ledger is garbage collected by mistake. (sijie, ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1307725 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Mar 31 09:13:07 CEST 2012"},{"Commit-ID":"commit 235bc1fec4d60567d113202b44f6fb4c1616d1ce 1333179114 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Mar 31 07:31:54 2012 +0000]","Body":"BOOKKEEPER-198: replaying entries of deleted ledgers would exhaust ledger cache. (sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1307732 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Mar 31 09:31:54 CEST 2012"},{"Commit-ID":"commit 682a23fb23c8de7756d5ef226fd6e97dd8d4e561 1333184331 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Mar 31 08:58:51 2012 +0000]","Body":"BOOKKEEPER-112: Bookie Recovery on an open ledger will cause LedgerHandle#close on that ledger to fail (sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1307743 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Mar 31 10:58:51 CEST 2012"},{"Commit-ID":"commit 47244dd77fb291ec95d5da4c96751ea92bc2d516 1333363098 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Apr 2 10:38:18 2012 +0000]","Body":"BOOKKEEPER-135: Fencing does not check the ledger masterPasswd (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1308294 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Apr 02 12:38:18 CEST 2012"},{"Commit-ID":"commit f694716e289c448ab89cab5fa81ea0946f9d9193 1333468964 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Tue Apr 3 16:02:44 2012 +0000]","Body":"BOOKKEEPER-207: BenchBookie doesn't run correctly (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1309007 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Apr 03 18:02:44 CEST 2012"},{"Commit-ID":"commit 8f02fb64ec9612af8422f23ed7908d7f6ccf5332 1333964521 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Mon Apr 9 09:42:01 2012 +0000]","Body":"BOOKKEEPER-212: Bookie stops responding when creating and deleting many ledgers (sijie via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1311177 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Apr 09 11:42:01 CEST 2012"},{"Commit-ID":"commit df5789843b6624ebda9c6e839458cdfbc3ed7d84 1334028115 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Apr 10 03:21:55 2012 +0000]","Body":"BOOKKEEPER-211: Bookie fails to to start (sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1311564 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Apr 10 05:21:55 CEST 2012"},{"Commit-ID":"commit 22bb0534ceebb3e9044b727177146fc220683b81 1334099123 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Tue Apr 10 23:05:23 2012 +0000]","Body":"BOOKKEEPER-200: Fix format and comments (fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1312034 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Apr 11 01:05:23 CEST 2012"},{"Commit-ID":"commit 8a1ad4c3208ad0e5b546ab8e5738132698fa56f5 1334543359 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Apr 16 02:29:19 2012 +0000]","Body":"BOOKKEEPER-197: HedwigConsole uses the same file to load bookkeeper client config and hub server config (sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1326464 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Apr 16 04:29:19 CEST 2012"},{"Commit-ID":"commit 3d834bd3798f22a43dc434d4b809a5c22731da38 1334585511 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Apr 16 14:11:51 2012 +0000]","Body":"BOOKKEEPER-216: Bookie doesn't exit with right exit code (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1326624 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Apr 16 16:11:51 CEST 2012"},{"Commit-ID":"commit 4a94ce1d8184f5f38def015d80777a8113b96690 1334657935 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Apr 17 10:18:55 2012 +0000]","Body":"BOOKKEEPER-196: Define interface between bookie and ledger storage (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1327027 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Apr 17 12:18:55 CEST 2012"},{"Commit-ID":"commit cf846eb5f57af19f68ccad42edda7551c852041d 1334661386 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Apr 17 11:16:26 2012 +0000]","Body":"BOOKKEEPER-218: Provide journal manager to manage journal related operations (sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1327045 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Apr 17 13:16:26 CEST 2012"},{"Commit-ID":"commit b5c0791d38a093936016a7989c35363063cdb202 1334797321 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Apr 19 01:02:01 2012 +0000]","Body":"BOOKKEEPER-213: PerChannelBookieClient calls the wrong errorOut function when encountering an exception (Aniruddha via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1327761 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Apr 19 03:02:01 CEST 2012"},{"Commit-ID":"commit 57a62a1c3ce151e1354a2a4ed212e9e8965928bf 1334913548 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Apr 20 09:19:08 2012 +0000]","Body":"BOOKKEEPER-168: Message bounding on subscriptions (ivank) [missing test]\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1328270 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Apr 20 11:19:08 CEST 2012"},{"Commit-ID":"commit 2f25ef611dd2c8ea2c94b48af09f183d74b6167e 1334942316 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Fri Apr 20 17:18:36 2012 +0000]","Body":"BOOKKEEPER-173: Uncontrolled number of threads in bookkeeper (sijie via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1328452 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Apr 20 19:18:36 CEST 2012"},{"Commit-ID":"commit 4e9ee8d75582a66f3e11d78dea280afbb864db7e 1335289074 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Apr 24 17:37:54 2012 +0000]","Body":"BOOKKEEPER-56: Race condition of message handler in connection recovery in Hedwig client (sijie & Gavin Li via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1329883 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Apr 24 19:37:54 CEST 2012"},{"Commit-ID":"commit 7f9005baadbbf312db857be6c3d3c095fe800c54 1335289326 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Apr 24 17:42:06 2012 +0000]","Body":"BOOKKEEPER-217: NPE in hedwig client when enable DEBUG (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1329886 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Apr 24 19:42:06 CEST 2012"},{"Commit-ID":"commit f7c1ad57ead301df4d3326b5d8c8950964387fa9 1335600674 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Apr 28 08:11:14 2012 +0000]","Body":"BOOKKEEPER-56: Race condition of message handler in connection recovery in Hedwig client (added AlreadyStartDeliveryException file missed in r1329883) (sijie & Gavin Li via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1331704 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Apr 28 10:11:14 CEST 2012"},{"Commit-ID":"commit 6d50e72732aa741d3a620c4b3ec04593c68f1b62 1335604288 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Apr 28 09:11:28 2012 +0000]","Body":"BOOKKEEPER-231: ZKUtil.killServer not closing the FileTxnSnapLog from ZK. (Uma Maheswara Rao G via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1331720 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Apr 28 11:11:28 CEST 2012"},{"Commit-ID":"commit 268bdb8c6b5f642967329a99ec1dce5ba0af46d7 1336155103 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri May 4 18:11:43 2012 +0000]","Body":"BOOKKEEPER-228: Fix the bugs in BK benchmark (umamaheswararao via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1334107 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri May 04 20:11:43 CEST 2012"},{"Commit-ID":"commit 6fc326ebd647afbbcc0beab6764b5d3748e50088 1336409287 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon May 7 16:48:07 2012 +0000]","Body":"BOOKKEEPER-232: AsyncBK tests failing (umamaheswararao via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1335117 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon May 07 18:48:07 CEST 2012"},{"Commit-ID":"commit a7d658179db3226dc33d53f4d25afd64ea90c061 1336462547 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Tue May 8 07:35:47 2012 +0000]","Body":"BOOKKEEPER-229: Deleted entry log files would be garbage collected again and again. (sijie via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1335367 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue May 08 09:35:47 CEST 2012"},{"Commit-ID":"commit 36a4a4190c342d7b3a1d5859c545ca1fc1b713cf 1336547765 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Wed May 9 07:16:05 2012 +0000]","Body":"BOOKKEEPER-241: Add documentation for bookie entry log compaction (sijie via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1335947 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed May 09 09:16:05 CEST 2012"},{"Commit-ID":"commit 3e224c4b6d4a0d9317060f7fe0d3519fccc68f5a 1336549430 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed May 9 07:43:50 2012 +0000]","Body":"BOOKKEEPER-215: Deadlock occurs under high load (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1335958 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed May 09 09:43:50 CEST 2012"},{"Commit-ID":"commit 9efe73998fe1ee72ffae95f3e1b1e65884019710 1336551454 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed May 9 08:17:34 2012 +0000]","Body":"BOOKKEEPER-242: Bookkeeper not able to connect other zookeeper when shutdown the zookeeper server where the BK has connected. (sijie & rakeshr via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1335973 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed May 09 10:17:34 CEST 2012"},{"Commit-ID":"commit 47ee081e6796ec84c774167dca67c3fd3ceda170 1336552773 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed May 9 08:39:33 2012 +0000]","Body":"BOOKKEEPER-234: EntryLogger will throw NPE, if any dir does not exist or IO Errors. (umamaheswararao via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1335996 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed May 09 10:39:33 CEST 2012"},{"Commit-ID":"commit d368d86e287ef982fa70e069001e30124ee22b48 1336561238 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Wed May 9 11:00:38 2012 +0000]","Body":"BOOKKEEPER-235: Bad syncing in entrylogger degrades performance for many concurrent ledgers (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1336083 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed May 09 13:00:38 CEST 2012"},{"Commit-ID":"commit 5f25edeba1cbf5de489e1f5a3070188f0163b51b 1336562454 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Wed May 9 11:20:54 2012 +0000]","Body":"BOOKKEEPER-236: Benchmarking improvements from latest round of benchmarking (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1336100 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed May 09 13:20:54 CEST 2012"},{"Commit-ID":"commit c32edf860040ebba19c6c57d226b12cd487a00d2 1336643859 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu May 10 09:57:39 2012 +0000]","Body":"BOOKKEEPER-245: Intermittent failures in PersistanceManager tests (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1336569 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu May 10 11:57:39 CEST 2012"},{"Commit-ID":"commit 3a2fdc683eb7c8881e4ce9608bb1d7c3548e27d4 1336654057 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu May 10 12:47:37 2012 +0000]","Body":"BOOKKEEPER-224: Fix findbugs in bookkeeper-server component (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1336645 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu May 10 14:47:37 CEST 2012"},{"Commit-ID":"commit eaf6cf985ae7ca4a4f62da2de3ecb569ccc5d3f7 1337076296 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue May 15 10:04:56 2012 +0000]","Body":"BOOKKEEPER-145: Put notice and license file for distributed binaries in SVN (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1338616 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue May 15 12:04:56 CEST 2012"},{"Commit-ID":"commit ba0ab04216f94411bae27a52670c9c8b4da03476 1337077718 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue May 15 10:28:38 2012 +0000]","Body":"BOOKKEEPER-209: Typo in ServerConfiguration for READAHEAD_ENABLED (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1338630 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue May 15 12:28:38 CEST 2012"},{"Commit-ID":"commit 132849503c0547d4d89d50cd14f700302b391ee2 1337263502 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu May 17 14:05:02 2012 +0000]","Body":"BOOKKEEPER-224: Fix findbugs in bookkeeper-server component [missing changes] (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1339607 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu May 17 16:05:02 CEST 2012"},{"Commit-ID":"commit f05021f1e9e8461182f082b9ab7819b71703655c 1337270194 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu May 17 15:56:34 2012 +0000]","Body":"BOOKKEEPER-254: Bump zookeeper version in poms (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1339672 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu May 17 17:56:34 CEST 2012"},{"Commit-ID":"commit 73dc3481846fdc0c97944c6a7c6ce0cef17ee938 1337272325 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu May 17 16:32:05 2012 +0000]","Body":"BOOKKEEPER-72: Fix warnings issued by FindBugs (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1339691 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu May 17 18:32:05 CEST 2012"},{"Commit-ID":"commit 1c2141183dd3422c85314b64e7b538c8faacd283 1337272680 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu May 17 16:38:00 2012 +0000]","Body":"BOOKKEEPER-238: Add log4j.properties in conf/ for bin packages (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1339698 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu May 17 18:38:00 CEST 2012"},{"Commit-ID":"commit 24e7fb03f6c9e3666aa83cc174b5088926eae3d1 1337274464 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu May 17 17:07:44 2012 +0000]","Body":"BOOKKEEPER-251: Noise error message printed when scanning entry log files those have been garbage collected. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1339715 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu May 17 19:07:44 CEST 2012"},{"Commit-ID":"commit 67cbcdd7a2d1668c9bba0d45d6ea3235e4bd11e3 1337836376 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu May 24 05:12:56 2012 +0000]","Body":"BOOKKEEPER-263: ZK ledgers root path is hard coded (Aniruddha via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1342145 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu May 24 07:12:56 CEST 2012"},{"Commit-ID":"commit c59b7b8a285e5d4da72aea1232a29f31610c2306 1337939285 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri May 25 09:48:05 2012 +0000]","Body":"BOOKKEEPER-146: TestConcurrentTopicAcquisition sometimes hangs (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1342550 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri May 25 11:48:05 CEST 2012"},{"Commit-ID":"commit 7ed489997c11c891f91b9fe0659c803a87d57489 1337952638 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri May 25 13:30:38 2012 +0000]","Body":"BOOKKEEPER-266: Review versioning documentation (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1342617 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri May 25 15:30:38 CEST 2012"},{"Commit-ID":"commit cc28541520136968edd3258861e88c5433c5e154 1337956703 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Fri May 25 14:38:23 2012 +0000]","Body":"BOOKKEEPER-265: Review JMX documentation (sijie via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1342646 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri May 25 16:38:23 CEST 2012"},{"Commit-ID":"commit a1eac18799ddc640bd42e6c038a31e1e26769056 1337958824 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Fri May 25 15:13:44 2012 +0000]","Body":"BOOKKEEPER-260: Define constant for -1 (invalid entry id) (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1342678 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri May 25 17:13:44 CEST 2012"},{"Commit-ID":"commit 1dde3e5191e51a6f648c0d16b14ecc1e02fcff0a 1338052605 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat May 26 17:16:45 2012 +0000]","Body":"BOOKKEEPER-258: CompactionTest failed (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1342933 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat May 26 19:16:45 CEST 2012"},{"Commit-ID":"commit bfd09dd0bb5cb2d786d0f413f2c6bc8243d06d54 1338324420 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Tue May 29 20:47:00 2012 +0000]","Body":"BOOKKEEPER-269: Review documentation for hedwig console client (sijie via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1343973 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue May 29 22:47:00 CEST 2012"},{"Commit-ID":"commit 0cb40cf90f13eedd54392ec954feadf8df28dede 1338325226 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Tue May 29 21:00:26 2012 +0000]","Body":"BOOKKEEPER-270: Review documentation on bookie cookie (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1343981 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue May 29 23:00:26 CEST 2012"},{"Commit-ID":"commit f97ac5b415294aafb7e788c3569636882fa7ee4c 1338325324 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Tue May 29 21:02:04 2012 +0000]","Body":"BOOKKEEPER-270: Review documentation on bookie cookie (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1343986 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue May 29 23:02:04 CEST 2012"},{"Commit-ID":"commit 887546e7937db1c45e42b7ca49b3c82d790adca9 1338325958 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Tue May 29 21:12:38 2012 +0000]","Body":"BOOKKEEPER-271: Review documentation for message bounding (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1343996 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue May 29 23:12:38 CEST 2012"},{"Commit-ID":"commit d68727ddd09dc0646af2748c3531e8844fdcaaf4 1338390791 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed May 30 15:13:11 2012 +0000]","Body":"BOOKKEEPER-273: LedgerHandle.deleteLedger() should be idempotent (Matteo Merli via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1344301 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed May 30 17:13:11 CEST 2012"},{"Commit-ID":"commit 687de61ce5077451957307a37c2feecdfb1ed8b5 1338430941 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu May 31 02:22:21 2012 +0000]","Body":"Preparing for release 4.1.0\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1344538 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu May 31 04:22:21 CEST 2012"},{"Commit-ID":"commit 586873a6163021a3c1b218b20f4f9c4ebc921af3 1338431386 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu May 31 02:29:46 2012 +0000]","Body":"Bump version number to 4.2.0\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1344543 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu May 31 04:29:46 CEST 2012"},{"Commit-ID":"commit 10b9c5b40bcb66690f6a25330500610c8b296779 1338876019 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jun 5 06:00:19 2012 +0000]","Body":"BOOKKEEPER-281: BKClient is failing when zkclient connection delays (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1346247 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Jun 05 08:00:19 CEST 2012"},{"Commit-ID":"commit a788614f5c73b0ab2c18f73d9eff7a858229a94e 1338878428 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jun 5 06:40:28 2012 +0000]","Body":"BOOKKEEPER-279: LocalBookKeeper is failing intermittently due to zkclient connection establishment delay (Rakesh R via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1346257 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Jun 05 08:40:28 CEST 2012"},{"Commit-ID":"commit 27b6dd6a40f3e4721a29ea2030d96994869a8260 1338890174 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jun 5 09:56:14 2012 +0000]","Body":"BOOKKEEPER-285: TestZkSubscriptionManager quits due to NPE, so other tests are not run in hedwig server. (sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1346321 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Jun 05 11:56:14 CEST 2012"},{"Commit-ID":"commit 25552d910c5d32307bda64cc3ae022e607850b7c 1338894163 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jun 5 11:02:43 2012 +0000]","Body":"BOOKKEEPER-286: Compilation warning (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1346340 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Jun 05 13:02:43 CEST 2012"},{"Commit-ID":"commit d5caab3aae143352f2d8c3faea71dce11fdb6b45 1338999236 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jun 6 16:13:56 2012 +0000]","Body":"BOOKKEEPER-287: NoSuchElementException in LedgerCacheImpl (sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1346966 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jun 06 18:13:56 CEST 2012"},{"Commit-ID":"commit 0a3ea6222061e4ba504cdf8ab8937ab26f71b5a9 1339078555 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jun 7 14:15:55 2012 +0000]","Body":"BOOKKEEPER-288: NOTICE files don't have the correct year (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1347628 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jun 07 16:15:55 CEST 2012"},{"Commit-ID":"commit 2f5024bbc720f2159efa67eed7a9f21d208a134b 1339078912 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jun 7 14:21:52 2012 +0000]","Body":"update release date for release 4.1.0\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1347634 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jun 07 16:21:52 CEST 2012"},{"Commit-ID":"commit 863f32a8ed33a5be3c9c622fb1c701bf3b48a2e0 1339515477 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Jun 12 15:37:57 2012 +0000]","Body":"BOOKKEEPER-289: mvn clean doesn't remove test output files (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1349400 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Jun 12 17:37:57 CEST 2012"},{"Commit-ID":"commit aa7f37c6095f61e89a290fc608fd14a50bc7b0e0 1339518192 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Jun 12 16:23:12 2012 +0000]","Body":"BOOKKEEPER-274: Hedwig cpp client library should not link to cppunit which is just used for test. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1349423 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Jun 12 18:23:12 CEST 2012"},{"Commit-ID":"commit a2cd9899405ef7313a50e87a370aecef543ae4eb 1339599474 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Jun 13 14:57:54 2012 +0000]","Body":"BOOKKEEPER-183: Provide tools to read/check data files in bookie server (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1349896 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jun 13 16:57:54 CEST 2012"},{"Commit-ID":"commit 9472fae8739be41301847b1c8e31954f376997e6 1340031295 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Jun 18 14:54:55 2012 +0000]","Body":"BOOKKEEPER-298: We run with preferIPv4Stack in the scripts but not in the tests (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1351374 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Jun 18 16:54:55 CEST 2012"},{"Commit-ID":"commit 297eb745440443eea1a8217c89299abf8d18fc3f 1340102377 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Jun 19 10:39:37 2012 +0000]","Body":"BOOKKEEPER-203: improve ledger manager interface to remove zookeeper dependency on metadata operations. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1351646 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Jun 19 12:39:37 CEST 2012"},{"Commit-ID":"commit 18728877881a23d2639eb650d47b7c41bbccd9ca 1340103496 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Jun 19 10:58:16 2012 +0000]","Body":"BOOKKEEPER-292: Test backward compatibility automatically between versions. (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1351651 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Jun 19 12:58:16 CEST 2012"},{"Commit-ID":"commit d193780cc404c2e3694c82385d7f422accc416f3 1340773846 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jun 27 05:10:46 2012 +0000]","Body":"BOOKKEEPER-307: BookieShell introduces 4 findbugs warnings (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1354326 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jun 27 07:10:46 CEST 2012"},{"Commit-ID":"commit 744edf07394472d3146e57831592a69d5a86616c 1340804111 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Jun 27 13:35:11 2012 +0000]","Body":"BOOKKEEPER-303: LedgerMetadata should serialized using protobufs (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1354492 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jun 27 15:35:11 CEST 2012"},{"Commit-ID":"commit 4d15e5675c0394cb910e54c9b0d9743e98fb64c7 1340903986 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Jun 28 17:19:46 2012 +0000]","Body":"BOOKKEEPER-302: No more messages delivered when hub server scans messages over two ledgers. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1355079 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jun 28 19:19:46 CEST 2012"},{"Commit-ID":"commit 441bf650859bc96a49b667961a19afd936b67e4c 1340904746 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Jun 28 17:32:26 2012 +0000]","Body":"BOOKKEEPER-322: New protobufs generates findbugs errors (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1355083 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jun 28 19:32:26 CEST 2012"},{"Commit-ID":"commit de432058b7e7c026fcf0b69b1e20bcf9ae1b1de2 1340988234 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Jun 29 16:43:54 2012 +0000]","Body":"BOOKKEEPER-280: LedgerHandle.addEntry() should return an entryId (mmerli via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1355467 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Jun 29 18:43:54 CEST 2012"},{"Commit-ID":"commit 18f5927a2bd0f423197a2da49ddd5733cdccb651 1341409448 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Jul 4 13:44:08 2012 +0000]","Body":"BOOKKEEPER-320: Let hedwig cpp client could publish messages using Message object instead of string. (jiannan via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1357264 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jul 04 15:44:08 CEST 2012"},{"Commit-ID":"commit 763479b6f94fd4827ee28e9f698cfa9a31095061 1341411450 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Jul 4 14:17:30 2012 +0000]","Body":"BOOKKEEPER-324: Flakeyness in LedgerCreateDeleteTest (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1357277 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jul 04 16:17:30 CEST 2012"},{"Commit-ID":"commit 6b249579f1cdf4e9fb940b0bf54b8d55a1ab38b2 1341465047 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jul 5 05:10:47 2012 +0000]","Body":"BOOKKEEPER-318: Spelling mistake in MultiCallback log message. (surendra via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1357464 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jul 05 07:10:47 CEST 2012"},{"Commit-ID":"commit db71147d9df0ad9efa697275e934330d21c99a88 1341465969 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jul 5 05:26:09 2012 +0000]","Body":"BOOKKEEPER-296: It's better provide stop script for bookie (nijel via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1357466 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jul 05 07:26:09 CEST 2012"},{"Commit-ID":"commit 09e5d180231f5307a58a89d0c89169bca890bddf 1341492333 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Jul 5 12:45:33 2012 +0000]","Body":"BOOKKEEPER-294: Not able to start the bookkeeper before the ZK session timeout. (rakeshr via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1357581 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jul 05 14:45:33 CEST 2012"},{"Commit-ID":"commit fbcc0b583fd698cfa9ca232f4be5b0d584bb3ee5 1341799791 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jul 9 02:09:51 2012 +0000]","Body":"BOOKKEEPER-328: Bookie DeathWatcher is missing thread name (Rakesh via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1358895 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Jul 09 04:09:51 CEST 2012"},{"Commit-ID":"commit c2efd0a48c5d1ea4edd7bf33c69a7e5270942eb4 1342026666 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Jul 11 17:11:06 2012 +0000]","Body":"BOOKKEEPER-250: Need a ledger manager like interface to manage metadata operations in Hedwig (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1360300 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jul 11 19:11:06 CEST 2012"},{"Commit-ID":"commit 0e06ddeb7e47bd8794fd378629602e41ea4a1fd9 1342027488 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Jul 11 17:24:48 2012 +0000]","Body":"BOOKKEEPER-329: provide stop scripts for hub server (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1360311 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jul 11 19:24:48 CEST 2012"},{"Commit-ID":"commit 51ca99b871ebf85738c82cb1f86eb7de223a44b2 1342434919 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jul 16 10:35:19 2012 +0000]","Body":"BOOKKEEPER-310: Changes in hedwig server to support JMS spec (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1361968 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Jul 16 12:35:19 CEST 2012"},{"Commit-ID":"commit e60f542937a51dd3bb05b770a989478625c734af 1342514527 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jul 17 08:42:07 2012 +0000]","Body":"BOOKKEEPER-306: Change C++ client to use gtest for testing (ivank via sijie) (fix wrong entry in CHANGES.txt)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1362408 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Jul 17 10:42:07 CEST 2012"},{"Commit-ID":"commit f13b9f4e26fe9b213837d1e68596b55f74163070 1342623647 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jul 18 15:00:47 2012 +0000]","Body":"BOOKKEEPER-2: bookkeeper does not put enough meta-data in to do recovery properly (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1362974 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jul 18 17:00:47 CEST 2012"},{"Commit-ID":"commit df619306ca4c6dd9eba94cbc5ce159e43a5b9ee5 1343079553 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Mon Jul 23 21:39:13 2012 +0000]","Body":"BOOKKEEPER-327: System.currentTimeMillis usage in BookKeeper (uma via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1364808 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Jul 23 23:39:13 CEST 2012"},{"Commit-ID":"commit 051320f212b2a6263d2d95db780db62911b9c0f6 1343269970 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jul 26 02:32:50 2012 +0000]","Body":"BOOKKEEPER-349: Entry logger should close all the chennels which are there in Map, instead of closing only current channel. (umamaheswararao via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1365869 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jul 26 04:32:50 CEST 2012"},{"Commit-ID":"commit 6e33b2519f98f08faa248056e9e017dd8ba8de90 1343271627 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jul 26 03:00:27 2012 +0000]","Body":"BOOKKEEPER-317: Exceptions for replication (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1365870 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jul 26 05:00:27 CEST 2012"},{"Commit-ID":"commit 3de1c6668a60999230f446011ca27fa7629b4465 1343272954 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jul 26 03:22:34 2012 +0000]","Body":"BOOKKEEPER-330: System.currentTimeMillis usage in Hedwig (uma via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1365873 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jul 26 05:22:34 CEST 2012"},{"Commit-ID":"commit 46a2663a842c6d256c73fba1bd12eb70559c115e 1343397082 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Fri Jul 27 13:51:22 2012 +0000]","Body":"BOOKKEEPER-352: Should not use static ServerStats/BKStats instance in TestServerStats/TestBKStats (sijie via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1366384 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Jul 27 15:51:22 CEST 2012"},{"Commit-ID":"commit 0092518bb3e345de2113f29450c9e1557cfc8020 1343661655 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jul 30 15:20:55 2012 +0000]","Body":"BOOKKEEPER-331: Let hedwig support returning message seq id for publish requests. (Mridul via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1367117 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Jul 30 17:20:55 CEST 2012"},{"Commit-ID":"commit 4088f7ac7b700588a935485b0a9723a36cc995f3 1344015725 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Aug 3 17:42:05 2012 +0000]","Body":"BOOKKEEPER-343: Failed to register hedwig JMX beans in test cases (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1369115 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Aug 03 19:42:05 CEST 2012"},{"Commit-ID":"commit 41b399cd2a4c85fa0b077f0a7749f5cca4e9c423 1344247817 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Aug 6 10:10:17 2012 +0000]","Body":"BOOKKEEPER-339: Let hedwig cpp client support returning message seq id for publish requests. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1369767 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Aug 06 12:10:17 CEST 2012"},{"Commit-ID":"commit 4d9f3d32a063975303f42a7108cbd4892062ab89 1344250896 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Aug 6 11:01:36 2012 +0000]","Body":"BOOKKEEPER-259: Create a topic manager using versioned write for leader election (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1369778 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Aug 06 13:01:36 CEST 2012"},{"Commit-ID":"commit 5c59fa532fa44a1803e1d986181c58c1b00f0a4c 1344262625 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Aug 6 14:17:05 2012 +0000]","Body":"BOOKKEEPER-340: Test backward compatibility for hedwig between different versions. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1369854 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Aug 06 16:17:05 CEST 2012"},{"Commit-ID":"commit ec17d0be6a1a655a40ae4e56abff3e121f7d6f20 1344525977 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Aug 9 15:26:17 2012 +0000]","Body":"BOOKKEEPER-191: Hub server should change ledger to write, so consumed messages have chance to be garbage collected. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1371255 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Aug 09 17:26:17 CEST 2012"},{"Commit-ID":"commit 391f9246890b416398e48886fe5ed3c4d2e866ab 1344850680 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Aug 13 09:38:00 2012 +0000]","Body":"BOOKKEEPER-326: DeadLock during ledger recovery (rakeshr via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1372343 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Aug 13 11:38:00 CEST 2012"},{"Commit-ID":"commit 74e097e0b171871f4f0c067600949376ff98cb5d 1344937234 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Aug 14 09:40:34 2012 +0000]","Body":"BOOKKEEPER-246: Recording of underreplication of ledger entries (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1372808 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Aug 14 11:40:34 CEST 2012"},{"Commit-ID":"commit f4daacff80da6802528320f5a920e1989cf20fac 1345197518 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Aug 17 09:58:38 2012 +0000]","Body":"BOOKKEEPER-338: Create Version.NEW and Version.ANY static instances of Version so that were not passing around nulls (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1374189 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Aug 17 11:58:38 CEST 2012"},{"Commit-ID":"commit fbba5c91318c00d77bd62c211066ae13a14d9d00 1345200105 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Aug 17 10:41:45 2012 +0000]","Body":"BOOKKEEPER-247: Detection of under replication (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1374195 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Aug 17 12:41:45 CEST 2012"},{"Commit-ID":"commit bb0888acafee138989dffb1cfee732145c953f38 1345211792 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Aug 17 13:56:32 2012 +0000]","Body":"BOOKKEEPER-283: Improve Hedwig Console to use Hedwig Metadata Manager. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1374265 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Aug 17 15:56:32 CEST 2012"},{"Commit-ID":"commit 14e23b6d9cf4015cd76c7ed3d5258bfbcbb05ef8 1345217543 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Aug 17 15:32:23 2012 +0000]","Body":"BOOKKEEPER-332: Add SubscriptionPreferences to record all preferences for a subscription (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1374321 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Aug 17 17:32:23 CEST 2012"},{"Commit-ID":"commit 45034f5f4a51225b9f963840741818da7869a85c 1345218112 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Aug 17 15:41:52 2012 +0000]","Body":"BOOKKEEPER-332: Add SubscriptionPreferences to record all preferences for a subscription (sijie via ivank) [missing files]\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1374327 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Aug 17 17:41:52 CEST 2012"},{"Commit-ID":"commit be94b88ea61b75246586b6495f8d3710d4c4217a 1345220735 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Aug 17 16:25:35 2012 +0000]","Body":"BOOKKEEPER-372: Check service name in bookie start/stop script. (nijel via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1374345 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Aug 17 18:25:35 CEST 2012"},{"Commit-ID":"commit 89e1c0913e70ce4c345c1c82b92ae91fac80b1d2 1345369173 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Sun Aug 19 09:39:33 2012 +0000]","Body":"BOOKKEEPER-299: Provide LedgerFragmentReplicator which should replicate the fragments found from LedgerChecker (umamahesh via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1374719 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sun Aug 19 11:39:33 CEST 2012"},{"Commit-ID":"commit c0746ba1c9569427d5839e3f350f4d8394f01320 1345541879 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Aug 21 09:37:59 2012 +0000]","Body":"BOOKKEEPER-354: [BOOKKEEPER-296] [Documentation] Modify the bookkeeper start script and document the bookkeeper stop command in bookkeeperConfig.xml (Kiran BC via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1375448 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Aug 21 11:37:59 CEST 2012"},{"Commit-ID":"commit b3331cbc528aa32ceb30dcbc676d298beda62df3 1345837877 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Aug 24 19:51:17 2012 +0000]","Body":"BOOKKEEPER-378: ReplicationWorker may not get ZK watcher notification on UnderReplication ledger lock deletion. (umamaheswararao & ivank via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1377075 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Aug 24 21:51:17 CEST 2012"},{"Commit-ID":"commit 97c76a36d79d1d96314cd7e832d1dfbd1211965d 1345841067 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Aug 24 20:44:27 2012 +0000]","Body":"BOOKKEEPER-248: Rereplicating of under replicated data (umamahesh via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1377100 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Aug 24 22:44:27 CEST 2012"},{"Commit-ID":"commit 621ace8d93eb322f01416e9a98aac23ac87799e3 1346062162 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Aug 27 10:09:22 2012 +0000]","Body":"BOOKKEEPER-380: ZkLedgerUnderreplicationManager.markLedgerUnderreplicated() is adding duplicate missingReplicas while multiple bk failed for the same ledger (rakeshr via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1377630 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Aug 27 12:09:22 CEST 2012"},{"Commit-ID":"commit 8e9a19f762fa27d297bf1b401c55fdbabdbcdc82 1346071407 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Aug 27 12:43:27 2012 +0000]","Body":"BOOKKEEPER-381: ReadLastConfirmedOp's Logger class name is wrong (surendra via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1377656 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Aug 27 14:43:27 CEST 2012"},{"Commit-ID":"commit c59b3d2e495e4ab7483b161ab9c2ce59f0c1e013 1346073305 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Aug 27 13:15:05 2012 +0000]","Body":"BOOKKEEPER-382: space missed at concatenations in GarbageCollectorThread logging (Brahma via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1377671 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Aug 27 15:15:05 CEST 2012"},{"Commit-ID":"commit d930b579a1e96757e1698bf91bc1c99ac1cb5f35 1346079317 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Aug 27 14:55:17 2012 +0000]","Body":"BOOKKEEPER-304: Prepare bookie vs ledgers cache and will be used by the Auditor (rakeshr via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1377703 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Aug 27 16:55:17 CEST 2012"},{"Commit-ID":"commit 6b44bc232811e379463f71a27293c3f31ed398ba 1346082239 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Aug 27 15:43:59 2012 +0000]","Body":"BOOKKEEPER-272: Provide automatic mechanism to know bookie failures (rakeshr via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1377716 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Aug 27 17:43:59 CEST 2012"},{"Commit-ID":"commit 6379ae858d11bac62a95ccb06675e2bd511f822a 1346088076 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Aug 27 17:21:16 2012 +0000]","Body":"BOOKKEEPER-333: server-side message filter (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1377756 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Aug 27 19:21:16 CEST 2012"},{"Commit-ID":"commit cb8415d5defb27efeb8fa7ab1c92a60d4f5c31af 1346143877 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Aug 28 08:51:17 2012 +0000]","Body":"BOOKKEEPER-337: Add entry fails with MetadataVersionException when last ensemble has morethan one bookie failures (rakeshr via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1378023 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Aug 28 10:51:17 CEST 2012"},{"Commit-ID":"commit 06f8f930786ad5c771b8f06ec5d6fe4af5ad3c89 1346156741 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Aug 28 12:25:41 2012 +0000]","Body":"BOOKKEEPER-376: LedgerManagers should consider 'underreplication' node as a special Znode (Uma via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1378103 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Aug 28 14:25:41 CEST 2012"},{"Commit-ID":"commit fbfd10fa94d909144c369e1514db31669a16872b 1346158291 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Aug 28 12:51:31 2012 +0000]","Body":"BOOKKEEPER-371: NPE in hedwig hub client causes hedwig hub to shut down. (Aniruddha via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1378112 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Aug 28 14:51:31 CEST 2012"},{"Commit-ID":"commit 9fcb7c0cddee8b78e1c3aa8db5f7478d9a13397c 1346419539 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Aug 31 13:25:39 2012 +0000]","Body":"BOOKKEEPER-384: Clean up LedgerManagerFactory and LedgerManager usage in tests (rakeshr via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1379445 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Aug 31 15:25:39 CEST 2012"},{"Commit-ID":"commit 2ffc123e5ffb37163512a89301a128f07f05750c 1346685253 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Sep 3 15:14:13 2012 +0000]","Body":"BOOKKEEPER-334: client-side message filter for java client. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1380268 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Sep 03 17:14:13 CEST 2012"},{"Commit-ID":"commit d169f8843e819e7ef49c1fdfe69a85308f420a4a 1346686031 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Sep 3 15:27:11 2012 +0000]","Body":"BOOKKEEPER-335: client-side message filter for cpp client. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1380273 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Sep 03 17:27:11 CEST 2012"},{"Commit-ID":"commit 504369377af29b6d09a801243ead58805784765a 1346691250 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Sep 3 16:54:10 2012 +0000]","Body":"BOOKKEEPER-385: replicateLedgerFragment should throw Exceptions in error conditions (umamahesh via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1380293 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Sep 03 18:54:10 CEST 2012"},{"Commit-ID":"commit 800fe7de43333d14dedb2ab64e08a89a78fa31b2 1346747955 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Sep 4 08:39:15 2012 +0000]","Body":"BOOKKEEPER-386: It should not be possible to replicate a ledger fragment which is at the end of an open ledger (ivank & umamahesh via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1380488 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Sep 04 10:39:15 CEST 2012"},{"Commit-ID":"commit 64fa78224ed46189032a616f00e1755fd71d93e2 1346987547 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Sep 7 03:12:27 2012 +0000]","Body":"BOOKKEEPER-394: CompositeException message is not useful (Stu Hood via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1381848 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Sep 07 05:12:27 CEST 2012"},{"Commit-ID":"commit 0eee9e5cd4b5b3affd930a736a3cc2d68a8da976 1346994273 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Sep 7 05:04:33 2012 +0000]","Body":"BOOKKEEPER-300: Create Bookie format command (Vinay via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1381870 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Sep 07 07:04:33 CEST 2012"},{"Commit-ID":"commit 3d036b0bf3939b042f4ba01a80b8b81ca6774d1b 1346994768 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Sep 7 05:12:48 2012 +0000]","Body":"BOOKKEEPER-395: HDFS dep transitively depends on a busted pom (Stu Hood via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1381874 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Sep 07 07:12:48 CEST 2012"},{"Commit-ID":"commit 06b50969499330d4a5421b48a042fdee63857d23 1346995600 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Sep 7 05:26:40 2012 +0000]","Body":"BOOKKEEPER-387: BookKeeper Upgrade is not working. (surendra via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1381879 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Sep 07 07:26:40 CEST 2012"},{"Commit-ID":"commit 6f364a214d2b65f5823af2e5699bbc59dc08a4c9 1347024138 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Sep 7 13:22:18 2012 +0000]","Body":"BOOKKEEPER-383: NPE in BookieJournalTest  (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1382016 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Sep 07 15:22:18 CEST 2012"},{"Commit-ID":"commit 26671da549558c4b16da42f2eabfad65fa223831 1347352257 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Sep 11 08:30:57 2012 +0000]","Body":"BOOKKEEPER-396: Compilation issue in TestClient.java of BenchMark ( showing this in eclipse) (umamahesh via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1383286 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Sep 11 10:30:57 CEST 2012"},{"Commit-ID":"commit e353a8f93ad48d8785bbaa7162a8a9ebca40a15f 1347443990 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Sep 12 09:59:50 2012 +0000]","Body":"BOOKKEEPER-208: Separate write quorum from ack quorum (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1383872 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Sep 12 11:59:50 CEST 2012"},{"Commit-ID":"commit 420a6e5e6cab583929622d190d2cd3b360cbd102 1347474851 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Sep 12 18:34:11 2012 +0000]","Body":"BOOKKEEPER-325: Delay the replication of a ledger if RW found that its last fragment is in underReplication. (umamahesh via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1384080 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Sep 12 20:34:11 CEST 2012"},{"Commit-ID":"commit 6bffc3245ae3c2f9a671a0549f394c192460217f 1347544344 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Sep 13 13:52:24 2012 +0000]","Body":" BOOKKEEPER-392: Racey ConcurrentMap usage in java hedwig-client (Stu Hood via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1384336 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Sep 13 15:52:24 CEST 2012"},{"Commit-ID":"commit 4f2b11213baf8551ef778599b14a6fc17d95f21d 1347616393 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Sep 14 09:53:13 2012 +0000]","Body":"BOOKKEEPER-403: ReReadMetadataCb is not executed in the thread responsible for that ledger (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1384700 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Sep 14 11:53:13 CEST 2012"},{"Commit-ID":"commit ec977dbe1e7bfb56dc93b6ba72d11f0468345668 1347630131 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Sep 14 13:42:11 2012 +0000]","Body":"BOOKKEEPER-32: Clean up LOG.debug statements (Stu Hood via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1384782 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Sep 14 15:42:11 CEST 2012"},{"Commit-ID":"commit 820ce5949c6a32ddca32ce7b408a57e27f5086bb 1347639377 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Sep 14 16:16:17 2012 +0000]","Body":"BOOKKEEPER-252: Hedwig: provide a subscription mode to kill other subscription channel when hedwig client is used as a proxy-style server. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1384836 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Sep 14 18:16:17 CEST 2012"},{"Commit-ID":"commit 53d3fbf26af00ccc25605fb80bbd73c09c3d90f0 1348052607 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Sep 19 11:03:27 2012 +0000]","Body":"BOOKKEEPER-405: Let's add Thread name for ReplicationWorker thread. (umamahesh via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1387525 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Sep 19 13:03:27 CEST 2012"},{"Commit-ID":"commit 00341197badcc1646b8d3fb4ec87ac526ed93b85 1348242341 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Sep 21 15:45:41 2012 +0000]","Body":"BOOKKEEPER-388: Document bookie format command (vinayrpet via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1388557 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Sep 21 17:45:41 CEST 2012"},{"Commit-ID":"commit cf414cc06ad85d9222de710152cb81bd60943aa5 1348242427 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Sep 21 15:47:07 2012 +0000]","Body":"BOOKKEEPER-388: Document bookie format command (kiran_bc via ivank) [Corrected CHANGES.txt]\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1388558 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Sep 21 17:47:07 CEST 2012"},{"Commit-ID":"commit 881cda5c85d17f952bdc2c7e101eef669bce35d2 1348657448 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Sep 26 11:04:08 2012 +0000]","Body":"BOOKKEEPER-397: Make the hedwig client in RegionManager configurable. (Aniruddha via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1390401 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Sep 26 13:04:08 CEST 2012"},{"Commit-ID":"commit eba338eb398f8a22987c6bd8352bf2d649fb7c33 1348703538 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Sep 26 23:52:18 2012 +0000]","Body":"BOOKKEEPER-364: re-factor hedwig java client to support both one-subscription-per-channel and multiplex-subscriptions-per-channel. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1390777 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Sep 27 01:52:18 CEST 2012"},{"Commit-ID":"commit 853ac6bf0107a8b80e44328ce825a8e710ee8986 1349098591 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Oct 1 13:36:31 2012 +0000]","Body":"BOOKKEEPER-143: Add SSL support for hedwig cpp client (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1392319 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Oct 01 15:36:31 CEST 2012"},{"Commit-ID":"commit 24fb0bca0dbdd2ad14c5afcd7fb2fc31f80882f5 1349347229 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Oct 4 10:40:29 2012 +0000]","Body":"BOOKKEEPER-278: Ability to disable auto recovery temporarily (rakeshr via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1393983 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Oct 04 12:40:29 CEST 2012"},{"Commit-ID":"commit f57cbe507d0f366fa76e0e163e867e4a7f93d958 1349357431 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Oct 4 13:30:31 2012 +0000]","Body":"BOOKKEEPER-367: Server-Side Message Delivery Flow Control (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1394066 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Oct 04 15:30:31 CEST 2012"},{"Commit-ID":"commit ba01aed276fc847926310376520d3ec513503c61 1349368269 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Oct 4 16:31:09 2012 +0000]","Body":"BOOKKEEPER-319: Manage auditing and replication processes (Vinay via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1394145 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Oct 04 18:31:09 CEST 2012"},{"Commit-ID":"commit e2487b794ef8d93a1d1380a62ffa212381930393 1349447082 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Oct 5 14:24:42 2012 +0000]","Body":"BOOKKEEPER-315: Ledger entries should be replicated sequentially instead of parallel. (umamahesh via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1394542 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Oct 05 16:24:42 CEST 2012"},{"Commit-ID":"commit c4519d96d592967aaad1d056db3d31cbe56de865 1349862329 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Oct 10 09:45:29 2012 +0000]","Body":"BOOKKEEPER-415: Rename DeliveryThrottle to MessageWindowSize (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1396524 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Oct 10 11:45:29 CEST 2012"},{"Commit-ID":"commit ce0e7b2077d495ca9f4192da1154f565cb9def5b 1349863758 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Oct 10 10:09:18 2012 +0000]","Body":"BOOKKEEPER-413: Hedwig C++ client: Rename RUN_AS_SSL_MODE to SSL_ENABLED (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1396531 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Oct 10 12:09:18 CEST 2012"},{"Commit-ID":"commit de64ff31f01e2a6e7889bae8d75681d2176f21bc 1349864943 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Oct 10 10:29:03 2012 +0000]","Body":"BOOKKEEPER-418: Store hostname of locker in replication lock (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1396536 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Oct 10 12:29:03 CEST 2012"},{"Commit-ID":"commit bf3d55f0cbd3461626148ad436a78923047dd797 1350399668 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Oct 16 15:01:08 2012 +0000]","Body":"BOOKKEEPER-417: Hierarchical zk underreplication manager should clean up its hierarchy when done to allow for fast acquisition of underreplicated entries (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1398834 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Oct 16 17:01:08 CEST 2012"},{"Commit-ID":"commit 2385d7a7054dd7e4c3241374b1f5f57360a5a468 1350422426 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Oct 16 21:20:26 2012 +0000]","Body":"BOOKKEEPER-436: Journal#rollLog may leak file handler (umamahesh via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1398995 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Oct 16 23:20:26 CEST 2012"},{"Commit-ID":"commit cb059545270e4517c90d2b52000ea06404307f16 1350465589 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Wed Oct 17 09:19:49 2012 +0000]","Body":"BOOKKEEPER-422: Simplify AbstractSubscriptionManager (stu via fpj)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1399159 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Oct 17 11:19:49 CEST 2012"},{"Commit-ID":"commit 5f9f6ef0719a19e48815e8b021da43e8ad15f6f7 1350557974 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Oct 18 10:59:34 2012 +0000]","Body":"BOOKKEEPER-369: re-factor hedwig cpp client to provide better interface to support both one-subscription-per-channel and multiple-subscriptions-per-channel. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1399578 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Oct 18 12:59:34 CEST 2012"},{"Commit-ID":"commit 794d8c6a363433bc129deeb5568e83ac716379e6 1350571230 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Oct 18 14:40:30 2012 +0000]","Body":"BOOKKEEPER-345: Detect IOExceptions on entrylogger and bookie should consider next ledger dir(if any) (Vinay via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1399680 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Oct 18 16:40:30 CEST 2012"},{"Commit-ID":"commit 81aa20165c13aab333f9f0fd6b4e948de2ba1cef 1350900638 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Oct 22 10:10:38 2012 +0000]","Body":"BOOKKEEPER-435: Create SubscriptionChannelManager to manage all subscription channel (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1400827 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Oct 22 12:10:38 CEST 2012"},{"Commit-ID":"commit d0807e31f6d531cee5898bea3c2af3e312dbe61b 1350903887 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Oct 22 11:04:47 2012 +0000]","Body":"BOOKKEEPER-411: Add CloseSubscription Request for multiplexing support (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1400836 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Oct 22 13:04:47 CEST 2012"},{"Commit-ID":"commit db1484669db7076d71b0ad890f8867e86a18229f 1350998563 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Oct 23 13:22:43 2012 +0000]","Body":"BOOKKEEPER-427: TestConcurrentTopicAcquisition hangs every so often (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1401286 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Oct 23 15:22:43 CEST 2012"},{"Commit-ID":"commit eb01b7c1a9d22a55f0107d8b3ba60807d4fd05f4 1351172128 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Oct 25 13:35:28 2012 +0000]","Body":"BOOKKEEPER-424: Bookie start is failing intermittently when zkclient connection delays (rakeshr via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1402146 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Oct 25 15:35:28 CEST 2012"},{"Commit-ID":"commit 2c7236cf339a2de3cf3fbc0aaa8cd88cc4398ca0 1351174719 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Oct 25 14:18:39 2012 +0000]","Body":"BOOKKEEPER-424: Bookie start is failing intermittently when zkclient connection delays (rakeshr via ivank) [missing files]\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1402159 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Oct 25 16:18:39 CEST 2012"},{"Commit-ID":"commit 7dced572419c90b27b587eccc09d48032e7a6a9c 1351176605 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Oct 25 14:50:05 2012 +0000]","Body":"BOOKKEEPER-416: LedgerChecker returns underreplicated fragments for an closed ledger with no entries (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1402172 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Oct 25 16:50:05 CEST 2012"},{"Commit-ID":"commit ffd46bcd1c7e2c78f6d41355a2215f73661764c1 1351245351 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Oct 26 09:55:51 2012 +0000]","Body":"BOOKKEEPER-441: InMemorySubscriptionManager should back up top2sub2seq before change it (Yixue via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1402459 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Oct 26 11:55:51 CEST 2012"},{"Commit-ID":"commit 3a9a88708d3a1e9e2337a8cc99c3bb727f93ffc4 1351248704 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Oct 26 10:51:44 2012 +0000]","Body":"BOOKKEEPER-346: Detect IOExceptions in LedgerCache and bookie should look at next ledger dir(if any) (Vinay via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1402464 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Oct 26 12:51:44 CEST 2012"},{"Commit-ID":"commit 223a3fb3fbc78fe4dc1922967fe3daa3edfc3fb2 1351257189 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Oct 26 13:13:09 2012 +0000]","Body":"BOOKKEEPER-439: No more messages delivered after deleted consumed ledgers. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1402501 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Oct 26 15:13:09 CEST 2012"},{"Commit-ID":"commit 536d86ec4b93909e870d6bc65fba7037360ea036 1351261547 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Fri Oct 26 14:25:47 2012 +0000]","Body":"BOOKKEEPER-425: Cleanup Bookie id generation (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1402526 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Oct 26 16:25:47 CEST 2012"},{"Commit-ID":"commit fb28dd140d1c0f6b3737f840b9d62da36713d820 1351680046 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Oct 31 10:40:46 2012 +0000]","Body":"BOOKKEEPER-430: Remove manual bookie registration from overview (fpj via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1404083 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Oct 31 11:40:46 CET 2012"},{"Commit-ID":"commit 0658723fdbcfeceddc983b770d78b01602a64f06 1351703767 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Oct 31 17:16:07 2012 +0000]","Body":"BOOKKEEPER-434: [Hedwig CPP Client] Delay resolving default host until necessary. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1404255 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Oct 31 18:16:07 CET 2012"},{"Commit-ID":"commit f633075dd0b0cae6c50db0f7284798089a9cf83b 1351872899 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Nov 2 16:14:59 2012 +0000]","Body":"BOOKKEEPER-368 Implementing multiplexing java client. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1405028 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Nov 02 17:14:59 CET 2012"},{"Commit-ID":"commit 2dd4ff7d82d7dc95eb959ad803164f2a5df96968 1351889252 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Nov 2 20:47:32 2012 +0000]","Body":"BOOKKEEPER-370: implement multiplexing cpp client. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1405159 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Nov 02 21:47:32 CET 2012"},{"Commit-ID":"commit da1b308ba8eb4dc0cd93b5ad19065067c354f242 1352285865 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Nov 7 10:57:45 2012 +0000]","Body":"BOOKKEEPER-452: Rename ClientConfiguration multiplexing_enabled to subscription_connection_sharing_enabled (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1406541 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Nov 07 11:57:45 CET 2012"},{"Commit-ID":"commit c32437ad4ff1d1e267f885a0bd67100cebb57ba6 1352305640 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Nov 7 16:27:20 2012 +0000]","Body":"BOOKKEEPER-444: Refactor pending read op to make speculative reads possible (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1406707 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Nov 07 17:27:20 CET 2012"},{"Commit-ID":"commit 9b7b78890c2f0631a2b62bbbaa8de35ede102c0e 1352477590 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Nov 9 16:13:10 2012 +0000]","Body":"BOOKKEEPER-204: Provide a MetaStore interface, and a mock implementation. (Jiannan Wang via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1407520 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Nov 09 17:13:10 CET 2012"},{"Commit-ID":"commit 0a164a8f7166b853cbf874b91f9a82e51f13f668 1353490303 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Nov 21 09:31:43 2012 +0000]","Body":"BOOKKEEPER-468: Remove <echo> from protobuf generation in hedwig (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1412025 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Nov 21 10:31:43 CET 2012"},{"Commit-ID":"commit 10091096ec339c1524877195172325343b20e02f 1353497070 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Nov 21 11:24:30 2012 +0000]","Body":"BOOKKEEPER-466: ZooKeeper test utility sets the port number as the tickTime (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1412061 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Nov 21 12:24:30 CET 2012"},{"Commit-ID":"commit afa7a082a6f8ab6936729fb68d84bcebf09e1f19 1353605780 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Nov 22 17:36:20 2012 +0000]","Body":"BOOKKEEPER-454: hedwig c++ tester script assumes sh is bash (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1412629 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Nov 22 18:36:20 CET 2012"},{"Commit-ID":"commit b3a05cd74652affe4a69f40609de0b92769e05a4 1353667791 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Nov 23 10:49:51 2012 +0000]","Body":"BOOKKEEPER-467: Allocate ports for testing dynamically (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1412818 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Nov 23 11:49:51 CET 2012"},{"Commit-ID":"commit e789bc0dae00b6e8881912a73c1e55f370c83c84 1353944575 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Nov 26 15:42:55 2012 +0000]","Body":"BOOKKEEPER-460: LedgerDeleteTest checks wrong place for log file (Fangmin Lv via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1413685 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Nov 26 16:42:55 CET 2012"},{"Commit-ID":"commit 967149c238389e96b760dbda4d4f722aee46b0b5 1353946424 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Nov 26 16:13:44 2012 +0000]","Body":"BOOKKEEPER-460: LedgerDeleteTest checks wrong place for log file (Fangmin Lv via ivank) [missing file]\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1413700 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Nov 26 17:13:44 CET 2012"},{"Commit-ID":"commit e2d624f8b09beca1f3a5c9224aad1aa254642f28 1353952074 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Nov 26 17:47:54 2012 +0000]","Body":"BOOKKEEPER-440: Make Write/Delete SubscriptionData Restricted to Version (Fangmin Lv via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1413745 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Nov 26 18:47:54 CET 2012"},{"Commit-ID":"commit 8a3b4ac9a70eca5e55f7c5163c9c62d677c06aa7 1354009856 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Nov 27 09:50:56 2012 +0000]","Body":"BOOKKEEPER-471: Add scripts for preCommit testing (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1414044 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Nov 27 10:50:56 CET 2012"},{"Commit-ID":"commit d3ee645781a1ed422d53a027e3d397451dd4c0d2 1354026983 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Tue Nov 27 14:36:23 2012 +0000]","Body":"BOOKKEEPER-479: Fix apache-rat issues in tree (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1414207 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Nov 27 15:36:23 CET 2012"},{"Commit-ID":"commit 38336805e367664fbda2a9c6993d5d343c956752 1354031565 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Tue Nov 27 15:52:45 2012 +0000]","Body":"BOOKKEEPER-477: In ReadOnlyBookieTest, we should wait for the bookie to die before asserting on it (ivank via fpj)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1414233 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Nov 27 16:52:45 CET 2012"},{"Commit-ID":"commit 9512c57d2c370604e732037c8a3cf262cb60b8a9 1354048390 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Tue Nov 27 20:33:10 2012 +0000]","Body":"BOOKKEEPER-476: Log to file during tests (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1414382 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Nov 27 21:33:10 CET 2012"},{"Commit-ID":"commit 0d198abad7b41d8326913384967aeb1239ab0528 1354198739 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Nov 29 14:18:59 2012 +0000]","Body":"BOOKKEEPER-457: Create a format command for Hedwig to cleanup its metadata. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1415176 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Nov 29 15:18:59 CET 2012"},{"Commit-ID":"commit ea84d6cc0f7ba8549466104175777369b6de5fac 1354208099 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Nov 29 16:54:59 2012 +0000]","Body":"BOOKKEEPER-487: Add existed hub server settings to configuration template file (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1415269 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Nov 29 17:54:59 CET 2012"},{"Commit-ID":"commit aa1fecd255bcc3c23d4037c675df88c9c0ba78ab 1354247654 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Nov 30 03:54:14 2012 +0000]","Body":"BOOKKEEPER-481: Fix javadoc warnings (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1415491 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Nov 30 04:54:14 CET 2012"},{"Commit-ID":"commit 2522f9863b30359b617b6fd2ab6190c1f1cc8570 1354247762 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Nov 30 03:56:02 2012 +0000]","Body":"BOOKKEEPER-480: Fix javac warnings (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1415492 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Nov 30 04:56:02 CET 2012"},{"Commit-ID":"commit 3ce797955e66d709fd9d96419bc484cab4ddeec3 1354289323 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Nov 30 15:28:43 2012 +0000]","Body":"BOOKKEEPER-389: add documentation for message filter. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1415691 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Nov 30 16:28:43 CET 2012"},{"Commit-ID":"commit e14983cbea5238a75a45bff4f23a8e431a5892f0 1354339969 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Dec 1 05:32:49 2012 +0000]","Body":"BOOKKEEPER-482: Precommit is reporting findbugs errors in trunk (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1415920 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Dec 01 06:32:49 CET 2012"},{"Commit-ID":"commit 100785f6f1feb2e6dd1c7de769adab5c88e87427 1354370669 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Sat Dec 1 14:04:29 2012 +0000]","Body":"BOOKKEEPER-485: TestFencing hung (ivank via fpj)\n\n--THIS line, and those below, will be ignored--\n\nM    CHANGES.txt\nA    bookkeeper-server/src/test/java/org/apache/bookkeeper/proto/TestPerChannelBookieClient.java\nM    bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1416000 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Dec 01 15:04:29 CET 2012"},{"Commit-ID":"commit c958b32da81936cee535c411f2214d900f54442c 1354512220 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Dec 3 05:23:40 2012 +0000]","Body":"BOOKKEEPER-351: asyncAddEntry should not throw an exception (Matteo Merli via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1416352 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Dec 03 06:23:40 CET 2012"},{"Commit-ID":"commit f12b7896e1640bed64cedb0d96bdd82b6cf26a86 1354527965 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Dec 3 09:46:05 2012 +0000]","Body":"BOOKKEEPER-336 bookie readEntries is taking more time if the ensemble has failed bookie(s) Basic speculative functionality  in place\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1416393 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Dec 03 10:46:05 CET 2012"},{"Commit-ID":"commit 6a6d25e7e9a2c3cc4370799ec2529915929e5acc 1354528197 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Dec 3 09:49:57 2012 +0000]","Body":"BOOKKEEPER-291: BKMBeanRegistry uses log4j directly (fpj via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1416400 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Dec 03 10:49:57 CET 2012"},{"Commit-ID":"commit bdf3bfd631493d82688404dde35eed491ec946ad 1354528501 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Dec 3 09:55:01 2012 +0000]","Body":"[REVERT] BOOKKEEPER-336 bookie readEntries is taking more time if the ensemble has failed bookie(s) Basic speculative functionality  in place\nAccidently committed this change, before approval. Reverting (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1416408 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Dec 03 10:55:01 CET 2012"},{"Commit-ID":"commit 03bf28db4e8e99a4326e0e01c7a9f7134f151a7b 1354542859 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Dec 3 13:54:19 2012 +0000]","Body":"BOOKKEEPER-459: Rename metastore mock implementation to InMemory implementation (jiannan via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1416519 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Dec 03 14:54:19 CET 2012"},{"Commit-ID":"commit 4380e52969beac534fd1da6a68bd28d48b9ba7e9 1354543478 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Dec 3 14:04:38 2012 +0000]","Body":"BOOKKEEPER-459: Rename metastore mock implementation to InMemory implementation (jiannan via ivank) [remove directory]\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1416526 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Dec 03 15:04:38 CET 2012"},{"Commit-ID":"commit 0ea460606e4a45a07a79c356ad1d58a6119e0d31 1354548452 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Dec 3 15:27:32 2012 +0000]","Body":"BOOKKEEPER-442: Failed to deliver messages due to inconsistency between SubscriptionState and LedgerRanges. (jiannan via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1416560 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Dec 03 16:27:32 CET 2012"},{"Commit-ID":"commit 7f6adbe34f828f6c86fe30bfa398180fdb512425 1354553944 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Dec 3 16:59:04 2012 +0000]","Body":"BOOKKEEPER-347: Provide mechanism to detect r-o bookie by the bookie clients (Vinay via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1416590 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Dec 03 17:59:04 CET 2012"},{"Commit-ID":"commit c86eb1c481fd837269d370cbcc248274708b0887 1354566711 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Mon Dec 3 20:31:51 2012 +0000]","Body":"BOOKKEEPER-484: Misc fixes for test scripts (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1416655 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Dec 03 21:31:51 CET 2012"},{"Commit-ID":"commit 55f6300ef7eea86c7573d07d65341e2f9ad982a4 1354570688 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Mon Dec 3 21:38:08 2012 +0000]","Body":"BOOKKEEPER-399: Let hub server configure write quorum from ack quorum. (sijie via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1416677 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Dec 03 22:38:08 CET 2012"},{"Commit-ID":"commit 6030beaba9e770db9b856b8de1b06dab843b2ccc 1354642055 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Dec 4 17:27:35 2012 +0000]","Body":"BOOKKEEPER-470: Possible infinite loop in simple.SubscribeReconnectCallback (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1417046 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Dec 04 18:27:35 CET 2012"},{"Commit-ID":"commit 7f67e765c73890a2f838ec8f5d43b814ce42c84b 1354643663 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Dec 4 17:54:23 2012 +0000]","Body":"BOOKKEEPER-461: Delivery throughput degrades when there are lots of publishers w/ high traffic. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1417066 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Dec 04 18:54:23 CET 2012"},{"Commit-ID":"commit 366d393f2e58acdd5494da4ae60513c3ae5730c4 1354655747 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Tue Dec 4 21:15:47 2012 +0000]","Body":"BOOKKEEPER-475: BookieRecoveryTest#testSyncBookieRecoveryToRandomBookiesCheckForDupes() iterates too much (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1417190 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Dec 04 22:15:47 CET 2012"},{"Commit-ID":"commit baef283841c05bcb4ebceaaa5d540f7a30e4af1a 1354879312 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Dec 7 11:21:52 2012 +0000]","Body":"BOOKKEEPER-453: Extract commonality from MultiplexSubscribeResponseHandler and SimpleSubscribeResponseHandler and put into an abstract class  (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1418280 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Dec 07 12:21:52 CET 2012"},{"Commit-ID":"commit 66a0dde14f8d69ebdd409f3a2011d03bcd6b62cd 1354961910 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Sat Dec 8 10:18:30 2012 +0000]","Body":"BOOKKEEPER-431: Duplicate definition of COOKIES_NODE (uma via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1418637 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Dec 08 11:18:30 CET 2012"},{"Commit-ID":"commit d0217c170a0906bdf3188cc89a290f6da0950146 1354963371 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Sat Dec 8 10:42:51 2012 +0000]","Body":"BOOKKEEPER-431: Duplicate definition of COOKIES_NODE (uma via fpj). \nAdditional commit to fix the DEFAULT_ZK_LEDGERS_ROOT_PATH constant.\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1418638 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Dec 08 11:42:51 CET 2012"},{"Commit-ID":"commit 40ac04bfee52f2e0fd45397cf5d02fa31236c753 1354979692 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Sat Dec 8 15:14:52 2012 +0000]","Body":"BOOKKEEPER-474:  BookieReadWriteTest#testShutdown doesn't make sense (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1418685 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Dec 08 16:14:52 CET 2012"},{"Commit-ID":"commit a063f9b19d035d8c2d9e76e3741368cf41e7d292 1355133499 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Mon Dec 10 09:58:19 2012 +0000]","Body":"BOOKKEEPER-469: Remove System.out.println from TestLedgerManager (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1419306 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Dec 10 10:58:19 CET 2012"},{"Commit-ID":"commit 7d3dde696ae859297ece4e2c9a047afde4fa5865 1355133858 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Mon Dec 10 10:04:18 2012 +0000]","Body":"BOOKKEEPER-465: CreateNewLog may overwrite lastLogId with smaller value (yixue, fpj via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1419311 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Dec 10 11:04:18 CET 2012"},{"Commit-ID":"commit 77efd1c00100b533d67e716579b439e94d4050e3 1355151762 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Mon Dec 10 15:02:42 2012 +0000]","Body":"BOOKKEEPER-498: BookieRecoveryTest.tearDown NPE (fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1419496 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Dec 10 16:02:42 CET 2012"},{"Commit-ID":"commit be155aa0c61f6b7bc0bf3d4f2ea56a9b97e590bf 1355220919 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Tue Dec 11 10:15:19 2012 +0000]","Body":"BOOKKEEPER-491: Hedwig doc for configuration (fpj, sijie via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1420069 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Dec 11 11:15:19 CET 2012"},{"Commit-ID":"commit 7467d2697103abba54d8f665724d630721064e78 1355248761 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Tue Dec 11 17:59:21 2012 +0000]","Body":"BOOKKEEPER-495: Revise BK config doc (fpj, ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1420308 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Dec 11 18:59:21 CET 2012"},{"Commit-ID":"commit 7275006bf7d13194aff768b22da55814e11b1cc2 1355249798 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Tue Dec 11 18:16:38 2012 +0000]","Body":"BOOKKEEPER-495: Revise BK config doc (fpj, ivank via fpj)\n(a few extra edits to bookieCOnfigParams.textile)\n \n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1420318 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Dec 11 19:16:38 CET 2012"},{"Commit-ID":"commit 7fa41ff318a31f973d1de12afe8db0f9893ac653 1355291663 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Dec 12 05:54:23 2012 +0000]","Body":"BOOKKEEPER-497: GcLedgersTest has a potential race (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1420532 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Dec 12 06:54:23 CET 2012"},{"Commit-ID":"commit 5414cec92a99135c8ba0bc0f6768bd348c65e2fb 1355307638 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Dec 12 10:20:38 2012 +0000]","Body":"BOOKKEEPER-205: implement a MetaStore based ledger manager for bookkeeper client. (jiannan via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1420607 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Dec 12 11:20:38 CET 2012"},{"Commit-ID":"commit 55610c26eb3b8b4cd5dd1955a434c2642334c605 1355333219 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Dec 12 17:26:59 2012 +0000]","Body":"BOOKKEEPER-493: moveLedgerIndexFile might have chance pickup same directory (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1420854 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Dec 12 18:26:59 CET 2012"},{"Commit-ID":"commit 1e35d5d5e6de6a33cd4ca200f3d5d92dcf7cb58d 1355379992 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Dec 13 06:26:32 2012 +0000]","Body":"BOOKKEEPER-404: Deprecate non-SubscriptionOptions Subscriber Apis (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1421083 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Dec 13 07:26:32 CET 2012"},{"Commit-ID":"commit b6c1a8bbd7c2d44c2edb59d9938fa073f6f478de 1355398391 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Dec 13 11:33:11 2012 +0000]","Body":"BOOKKEEPER-365: Ledger will never recover if one of the quorum bookie is down forever and others dont have entry (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1421235 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Dec 13 12:33:11 CET 2012"},{"Commit-ID":"commit d58a71dbd1f07a3edf65c4af80ae18a4d9a95755 1355399465 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Thu Dec 13 11:51:05 2012 +0000]","Body":"BOOKKEEPER-458:  Annoy BKReadException error when changing ledger. (jiannan via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1421239 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Dec 13 12:51:05 CET 2012"},{"Commit-ID":"commit 496f442a7a68dd549355e845540c6c72c2fbb44c 1355400472 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Dec 13 12:07:52 2012 +0000]","Body":"BOOKKEEPER-336: bookie readEntries is taking more time if the ensemble has failed bookie(s) (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1421242 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Dec 13 13:07:52 CET 2012"},{"Commit-ID":"commit d932c9b2181cc9f9b6bb3b43abd5af04cda206b8 1355413459 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Thu Dec 13 15:44:19 2012 +0000]","Body":"BOOKKEEPER-483: precommit tests only check toplevel rat file, not the one for submodules. (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1421346 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Dec 13 16:44:19 CET 2012"},{"Commit-ID":"commit 3a950e6f7f5ca8b646e82c61c98a65991df8d88f 1355418357 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Dec 13 17:05:57 2012 +0000]","Body":"BOOKKEEPER-262: Implement a meta store based hedwig metadata manager. (jiannan via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1421384 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Dec 13 18:05:57 CET 2012"},{"Commit-ID":"commit 4320f6f8a2621c852c19fa81ba7edd8a9e6c87a7 1355418762 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Dec 13 17:12:42 2012 +0000]","Body":"BOOKKEEPER-341: add documentation for bookkeeper ledger manager interface. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1421388 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Dec 13 18:12:42 CET 2012"},{"Commit-ID":"commit e0011de4475969c19023694f5074b50e5d12a08f 1355420043 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Dec 13 17:34:03 2012 +0000]","Body":"BOOKKEEPER-408: BookieReadWriteTest will enter the endless loop and will not leave out (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1421401 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Dec 13 18:34:03 CET 2012"},{"Commit-ID":"commit 8125700069b14f80ebd135ddd1a2b67de256cb1e 1355480284 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Dec 14 10:18:04 2012 +0000]","Body":"BOOKKEEPER-426: Make auditor Vote znode store a protobuf containing the host that voted (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1421781 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Dec 14 11:18:04 CET 2012"},{"Commit-ID":"commit dffe13f5b16200e192c36547021c34c186d00de8 1355494493 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Dec 14 14:14:53 2012 +0000]","Body":"BOOKKEEPER-504: Fix findbugs warning in PendingReadOp (fpj via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1421875 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Dec 14 15:14:53 CET 2012"},{"Commit-ID":"commit e4a42af6933c0cb0be441b3d9d5d28790aa9a7b9 1355513211 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Fri Dec 14 19:26:51 2012 +0000]","Body":"BOOKKEEPER-428: Expose command options in bookie scripts to disable/enable auto recovery temporarily (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1422054 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Dec 14 20:26:51 CET 2012"},{"Commit-ID":"commit 5428454ca34823a225eafb114128931d313d9e2f 1355513357 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Fri Dec 14 19:29:17 2012 +0000]","Body":"BOOKKEEPER-428: Expose command options in bookie scripts to disable/enable auto recovery temporarily (rakesh, ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1422056 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Dec 14 20:29:17 CET 2012"},{"Commit-ID":"commit 8c1e71f2b9cb8425046517f69a5024c31d47783c 1355535906 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Dec 15 01:45:06 2012 +0000]","Body":"BOOKKEEPER-511: BookieShell is very noisy (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1422173 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Dec 15 02:45:06 CET 2012"},{"Commit-ID":"commit d1a3c6d11eb4433c7e25eeba6ac21fe2db3a2696 1355537312 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Dec 15 02:08:32 2012 +0000]","Body":"BOOKKEEPER-512: BookieZkExpireTest fails periodically (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1422174 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Dec 15 03:08:32 CET 2012"},{"Commit-ID":"commit a8d61e64604a6ea5ce6caccc5d29aea2abac69f3 1355755343 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Dec 17 14:42:23 2012 +0000]","Body":"BOOKKEEPER-375: Document about Auto replication service in BK (umamahesh via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1422952 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Dec 17 15:42:23 CET 2012"},{"Commit-ID":"commit 3ab615ebbce3871b1d15099f4e24ecaae9e83d8a 1355809706 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Dec 18 05:48:26 2012 +0000]","Body":"BOOKKEEPER-490: add documentation for MetaStore interface (sijie, ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1423278 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Dec 18 06:48:26 CET 2012"},{"Commit-ID":"commit c784b602325361a7606f2f53b677996e2c23f730 1355809941 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Dec 18 05:52:21 2012 +0000]","Body":"BOOKKEEPER-342: add documentation for hedwig metadata manager interface. (sijie, ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1423281 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Dec 18 06:52:21 CET 2012"},{"Commit-ID":"commit a4d8a34fb0779551208ad003b950e0b9a9d86d42 1355828134 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Dec 18 10:55:34 2012 +0000]","Body":"BOOKKEEPER-509: TestBookKeeperPersistenceManager failed on latest trunk (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1423405 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Dec 18 11:55:34 CET 2012"},{"Commit-ID":"commit e5b0dd0d9e47394202f5a20cedf409f487d90beb 1355828449 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Dec 18 11:00:49 2012 +0000]","Body":"BOOKKEEPER-496: Ensure that the auditor and replication worker will shutdown if they lose their ZK session (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1423409 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Dec 18 12:00:49 CET 2012"},{"Commit-ID":"commit d69986c4df6b51ed6ed27c5f45a7b6850e69dacd 1355832291 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Dec 18 12:04:51 2012 +0000]","Body":"BOOKKEEPER-500: Fencing doesn't work when restarting bookies. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1423419 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Dec 18 13:04:51 CET 2012"},{"Commit-ID":"commit a3da8c74c4226b7d92e9d0eba9591334351afa45 1355982536 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Dec 20 05:48:56 2012 +0000]","Body":"BOOKKEEPER-520: BookieFailureTest hangs on precommit build (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1424335 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Dec 20 06:48:56 CET 2012"},{"Commit-ID":"commit fa13426970bd4b6d7ffc086e776559f87349ef71 1356324602 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Dec 24 04:50:02 2012 +0000]","Body":"BOOKKEEPER-463: Refactor garbage collection code for ease to plugin different GC algorithm. (Fangmin, ivank, fpj via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1425585 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Dec 24 05:50:02 CET 2012"},{"Commit-ID":"commit a0ae97c232caafa1fda9955f9aaa9f99564b74fe 1356325549 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Dec 24 05:05:49 2012 +0000]","Body":"BOOKKEEPER-522: TestHedwigHub is failing silently on Jenkins (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1425586 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Dec 24 06:05:49 CET 2012"},{"Commit-ID":"commit 7de3ecbd5d5052138a9c4aded9256c5030ab2f6d 1356326592 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Dec 24 05:23:12 2012 +0000]","Body":"BOOKKEEPER-447: Bookie can fail to recover if index pages flushed before ledger flush acknowledged (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1425588 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Dec 24 06:23:12 CET 2012"},{"Commit-ID":"commit 8a396e1f74ff9f9cf25d3b4bfc43c8a112992555 1356646600 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Thu Dec 27 22:16:40 2012 +0000]","Body":"BOOKKEEPER-520: BookieFailureTest hangs on precommit build (sijie via fpj, jira reopened)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1426349 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Dec 27 23:16:40 CET 2012"},{"Commit-ID":"commit ea36e59a1c314bf698d572e5f714e0b68e554a6e 1356694335 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Fri Dec 28 11:32:15 2012 +0000]","Body":"BOOKKEEPER-514: TestDeadLock hanging sometimes (ivank, sijie via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1426461 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Dec 28 12:32:15 CET 2012"},{"Commit-ID":"commit 7b2b91579000bc99d6fdded3aefb349975058c6f 1356795106 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Sat Dec 29 15:31:46 2012 +0000]","Body":"BOOKKEEPER-523: Every test should have a timeout (ivank, sijie via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1426772 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Dec 29 16:31:46 CET 2012"},{"Commit-ID":"commit a27b64e340a6ad12f1e9588d1d55fa51f0b2d1f0 1357161873 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Jan 2 21:24:33 2013 +0000]","Body":"BOOKKEEPER-55: SubscribeReconnectRetryTask might retry subscription endlessly when another subscription is already successfully created previously (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1428059 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jan 02 22:24:33 CET 2013"},{"Commit-ID":"commit b4e985b32cbb5aa7c6b109898f9d8bf51b2fd330 1357207584 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Jan 3 10:06:24 2013 +0000]","Body":"BOOKKEEPER-409: Integration Test - Perform bookie rereplication cycle by Auditor-RW processes (rakeshr via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1428258 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jan 03 11:06:24 CET 2013"},{"Commit-ID":"commit ee29f75f3f6a0168008da2e424e4174f2aee8cbb 1357211276 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Jan 3 11:07:56 2013 +0000]","Body":"BOOKKEEPER-507: Race condition happens if closeSubscription and subscribe happened at the same time (in multiplexed client). (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1428277 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jan 03 12:07:56 CET 2013"},{"Commit-ID":"commit 005b62cc60093dd5b32d4abecd06c2e441bc62ae 1357295569 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Jan 4 10:32:49 2013 +0000]","Body":"BOOKKEEPER-293: Periodic checking of ledger replication status (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1428777 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Jan 04 11:32:49 CET 2013"},{"Commit-ID":"commit f80dcedaeea5f701822f02484c098cf4df2f04da 1357526906 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jan 7 02:48:26 2013 +0000]","Body":"BOOKKEEPER-524: Bookie journal filesystem gets full after SyncThread is terminated with exception (Matteo, fpj via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1429650 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Jan 07 03:48:26 CET 2013"},{"Commit-ID":"commit b625fdc27a429341143e204338cf5deab3188e9e 1357557906 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Jan 7 11:25:06 2013 +0000]","Body":"BOOKKEEPER-355: Ledger recovery will mark ledger as closed with -1, in case of slow bookie is added to ensemble during recovery add (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1429756 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Jan 07 12:25:06 CET 2013"},{"Commit-ID":"commit f7ce39d522827a0359a0183eae02694ebb35bafd 1357595634 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Jan 7 21:53:54 2013 +0000]","Body":"BOOKKEEPER-534: Flakeyness in AuditorBookieTest (umamahesh via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1430041 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Jan 07 22:53:54 CET 2013"},{"Commit-ID":"commit ed9b6037be51845f7cab2446593df695ffcede59 1357602273 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Mon Jan 7 23:44:33 2013 +0000]","Body":"BOOKKEEPER-532: AbstractSubscriptionManager#AcquireOp read subscriptions every time even it already owned the topic. (sijie via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1430091 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Jan 08 00:44:33 CET 2013"},{"Commit-ID":"commit faf407d5d40e9d476bab2a926f41b993bf87098f 1357730979 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Jan 9 11:29:39 2013 +0000]","Body":"BOOKKEEPER-531: Cache thread should wait until old entries are collected (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1430795 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jan 09 12:29:39 CET 2013"},{"Commit-ID":"commit 55a6e1b983420b40813b327f67bbbff8196a8e41 1357745678 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Wed Jan 9 15:34:38 2013 +0000]","Body":"BOOKKEEPER-541: Add guava to notice file (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1430898 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jan 09 16:34:38 CET 2013"},{"Commit-ID":"commit f0db18abedd30af1d6191d068652b93db0c68fc6 1357748287 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Wed Jan 9 16:18:07 2013 +0000]","Body":"BOOKKEEPER-533: TestSubAfterCloseSub fails strangely in tests (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1430933 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jan 09 17:18:07 CET 2013"},{"Commit-ID":"commit 1f5278d06ddbf4da0d2d6ed41676321f89a4aecd 1357750056 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Jan 9 16:47:36 2013 +0000]","Body":"BOOKKEEPER-529: stopServingSubscriber in delivery manager should remove stub callbacks in ReadAheadCache (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1430954 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jan 09 17:47:36 CET 2013"},{"Commit-ID":"commit 5c19add8bc394d3caae4fddf566e149281370a52 1357753731 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Jan 9 17:48:51 2013 +0000]","Body":"BOOKKEEPER-542: Remove trailing spaces in IndexCorruptionTest (fpj via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1430972 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jan 09 18:48:51 CET 2013"},{"Commit-ID":"commit a9b851b3afe2d8031ad426fdd2e579ba003fe02c 1357810765 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jan 10 09:39:25 2013 +0000]","Body":"BOOKKEEPER-543: Read zk host list in a wrong way in hedwig server (Fangmin via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1431232 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jan 10 10:39:25 CET 2013"},{"Commit-ID":"commit 40de140171a26b0943909900d6af4a73b31a641e 1357810939 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jan 10 09:42:19 2013 +0000]","Body":"BOOKKEEPER-540: #stopServingSubscriber when channel is disconnected. (Fangmin via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1431235 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jan 10 10:42:19 CET 2013"},{"Commit-ID":"commit 7c1793d2979b01062682b70687839a978bf65c4c 1357827596 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Jan 10 14:19:56 2013 +0000]","Body":"BOOKKEEPER-530: data might be lost during compaction. (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1431378 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jan 10 15:19:56 CET 2013"},{"Commit-ID":"commit 4250c1f93962af30e6e40759e006035a7089613e 1357841638 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Thu Jan 10 18:13:58 2013 +0000]","Body":"BOOKKEEPER-538: Race condition in BookKeeper#close (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1431536 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jan 10 19:13:58 CET 2013"},{"Commit-ID":"commit 1374b7ad2738f6c52a2aed1d0ee4e412aa382086 1357877801 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jan 11 04:16:41 2013 +0000]","Body":"BOOKKEEPER-539: ClientNotSubscribedException & doesn't receive enough messages in TestThrottlingDelivery#testServerSideThrottle (sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1431869 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Jan 11 05:16:41 CET 2013"},{"Commit-ID":"commit 96b5aa8e6463c36a0421e47f9892479aa63f885b 1358013326 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Sat Jan 12 17:55:26 2013 +0000]","Body":"BOOKKEEPER-503: The test case of TestThrottlingDelivery#testServerSideThrottle failed sometimes (jiannan & sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1432485 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Jan 12 18:55:26 CET 2013"},{"Commit-ID":"commit 7d8079c446110872d8f6d50eff86268a3cb4e989 1358167549 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Jan 14 12:45:49 2013 +0000]","Body":"BOOKKEEPER-513: TestMessageFilter fails periodically (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1432902 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Jan 14 13:45:49 CET 2013"},{"Commit-ID":"commit 17de3dbe64450bfab7505d7cf51e082eb5672bc8 1358171308 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Jan 14 13:48:28 2013 +0000]","Body":"Updating version in CHANGES.txt before branching for 4.2.0\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1432916 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Jan 14 14:48:28 CET 2013"},{"Commit-ID":"commit 582370359c8e0e399b30df5a7e60a569b0d5aadf 1358171541 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Jan 14 13:52:21 2013 +0000]","Body":"Updating version in CHANGES.txt & pom.xml after branching for 4.2.0\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1432921 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Jan 14 14:52:21 CET 2013"},{"Commit-ID":"commit 087e490270c6e006b9e4b47035f20fea843149be 1358179147 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Jan 14 15:59:07 2013 +0000]","Body":"BOOKKEEPER-472: Provide an option to start Autorecovery along with Bookie Servers (umamahesh via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1432964 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Jan 14 16:59:07 CET 2013"},{"Commit-ID":"commit ec430abc550d8d1d66e9dd8dc3c096f44e666eeb 1358180968 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Jan 14 16:29:28 2013 +0000]","Body":"Fixup for CHANGES.txt (some issues were missing or wrongly placed, also removed tabs)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1432977 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Jan 14 17:29:28 CET 2013"},{"Commit-ID":"commit 7bed2a74a98f49b31c1653a513944f60a359776c 1359052547 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Jan 24 18:35:47 2013 +0000]","Body":"BOOKKEEPER-544: Modify hedwig server tests to allow client testcases to start/stop them as part of their tests (mridul via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1438120 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jan 24 19:35:47 CET 2013"},{"Commit-ID":"commit e95b9392d4ba38c68617dff16de53e523d8ea51b 1359657177 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Jan 31 18:32:57 2013 +0000]","Body":"BOOKKEEPER-312: Implementation of JMS provider (mridul via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1441108 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jan 31 19:32:57 CET 2013"},{"Commit-ID":"commit b4bac04a8141fa116223de8028471facbe343555 1360164504 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Feb 6 15:28:24 2013 +0000]","Body":"BOOKKEEPER-526: multiple threads for delivery manager (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1443017 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Feb 06 16:28:24 CET 2013"},{"Commit-ID":"commit f060c0d2745b47314562bc94ecb5f525e2addb07 1360346929 -----sp","Author":"PersonIdent[Uma Maheswara Rao G, umamahesh@apache.org, Fri Feb 8 18:08:49 2013 +0000]","Body":"BOOKKEEPER-561 Findbugs report errors with openjdk. Contributed by Ivan Kelly.\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1444174 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Feb 08 19:08:49 CET 2013"},{"Commit-ID":"commit 3902ae5a6056ba6348f71c873d23f74ac32cebef 1360396787 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Feb 9 07:59:47 2013 +0000]","Body":"BOOKKEEPER-556: BookieServerMXBean#getServerState makes no sense (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1444340 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Feb 09 08:59:47 CET 2013"},{"Commit-ID":"commit 3bcabc5adb48e75dd041384ebcbb0017d56c3299 1360645218 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Feb 12 05:00:18 2013 +0000]","Body":"BOOKKEEPER-554: fd leaking when move ledger index file (sijie, ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1445033 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Feb 12 06:00:18 CET 2013"},{"Commit-ID":"commit 26731c770bf8e3cb54ec0466c027b6e313983bba 1360664204 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Feb 12 10:16:44 2013 +0000]","Body":"BOOKKEEPER-555: Make BookieServer use Netty rather than a custom IO server (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1445085 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Feb 12 11:16:44 CET 2013"},{"Commit-ID":"commit 5b7b6835c74a11162164e90e66bb05a84411a8c2 1360902668 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Feb 15 04:31:08 2013 +0000]","Body":"BOOKKEEPER-568: NPE during GC with HierarchicalLedgerManager (Matteo via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1446444 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Feb 15 05:31:08 CET 2013"},{"Commit-ID":"commit cda181255f0bb2ebc1a69f75b2b6f84b50c4fba0 1361026952 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Sat Feb 16 15:02:32 2013 +0000]","Body":"BOOKKEEPER-569: Critical performance bug in InterleavedLedgerStorage (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1446902 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Feb 16 16:02:32 CET 2013"},{"Commit-ID":"commit 040a442bef5b93143a9e07c0b601fddea88c5712 1361286947 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Feb 19 15:15:47 2013 +0000]","Body":"BOOKKEEPER-548: Document about periodic ledger checker configuration (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1447756 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Feb 19 16:15:47 CET 2013"},{"Commit-ID":"commit f4d189431ee77d1133b617dba9e939756cb9d721 1361287162 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Feb 19 15:19:22 2013 +0000]","Body":"BOOKKEEPER-549: Documentation missed for readOnlyMode support (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1447759 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Feb 19 16:19:22 CET 2013"},{"Commit-ID":"commit d40d380363f7ab608231e91b84dd94e3478f3773 1361289155 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Feb 19 15:52:35 2013 +0000]","Body":"BOOKKEEPER-567: ReadOnlyBookieTest hangs on shutdown (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1447772 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Feb 19 16:52:35 CET 2013"},{"Commit-ID":"commit f31a366fa581b5561bc51d6dd06ce2ebfe3c9f03 1361848344 -----sp","Author":"PersonIdent[Uma Maheswara Rao G, umamahesh@apache.org, Tue Feb 26 03:12:24 2013 +0000]","Body":"BOOKKEEPER-574: Extend the bookkeeper shell to get a list of available bookies. Contributed by Ivan Kelly\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1450005 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Feb 26 04:12:24 CET 2013"},{"Commit-ID":"commit ea5a13d748918f495ad1cb1e37c0f995e3d53072 1362505558 -----sp","Author":"PersonIdent[Uma Maheswara Rao G, umamahesh@apache.org, Tue Mar 5 17:45:58 2013 +0000]","Body":"BOOKKEEPER-559: Fix occasional failure in AuditorBookieTest. Contributed by Ivan Kelly.\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1452915 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Mar 05 18:45:58 CET 2013"},{"Commit-ID":"commit 94ea9a8629ce404566d875895208dabe82c99fbe 1362786164 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Mar 8 23:42:44 2013 +0000]","Body":"BOOKKEEPER-579: TestSubAfterCloseSub was put in a wrong package (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1454625 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Mar 09 00:42:44 CET 2013"},{"Commit-ID":"commit 1b7cb6fa9704d10a3a6134edfd0b12d85bf0012c 1363563080 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Mar 17 23:31:20 2013 +0000]","Body":"BOOKKEEPER-576: Bookie client should use netty Decoder/Encoder (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1457592 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Mar 18 00:31:20 CET 2013"},{"Commit-ID":"commit 9f0d2a3e2f4279921f8fa1df8aad708773124cd5 1363563237 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Mar 17 23:33:57 2013 +0000]","Body":" BOOKKEEPER-585: Auditor logs noisily when a ledger has been deleted (ivank via sijie) \n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1457596 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Mar 18 00:33:57 CET 2013"},{"Commit-ID":"commit 9868081b708b27f272e2a92cf04163996caf9544 1363563607 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Mar 17 23:40:07 2013 +0000]","Body":"BOOKKEEPER-573: Script to start a bookkeeper cluster (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1457598 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Mar 18 00:40:07 CET 2013"},{"Commit-ID":"commit f2bb5603ff33b8ac54bcdf2daddb61cf3e65de80 1364189243 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Mar 25 05:27:23 2013 +0000]","Body":"BOOKKEEPER-557: Compiler error showing up badly with jdk 7 (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1460523 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Mar 25 06:27:23 CET 2013"},{"Commit-ID":"commit d1bb8ec0e7c65e241f55c8b700395570e0ee5daf 1364190481 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Mar 25 05:48:01 2013 +0000]","Body":"BOOKKEEPER-583: Read from a ReadOnlyBookie fails if index fileinfo is not in ledger cache (vinay via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1460524 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Mar 25 06:48:01 CET 2013"},{"Commit-ID":"commit 6268be59c7d8cf411860a6807a2cb45bc1c891f4 1364224221 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Mar 25 15:10:21 2013 +0000]","Body":"BOOKKEEPER-586: Remove recursive call in delivery manager (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1460709 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Mar 25 16:10:21 CET 2013"},{"Commit-ID":"commit e14cbe41b5db846a5d819fcae6e82bc489ebeb73 1364228808 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Mar 25 16:26:48 2013 +0000]","Body":"BOOKKEEPER-506: Provide better topic release algorithm (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1460751 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Mar 25 17:26:48 CET 2013"},{"Commit-ID":"commit 455aabfd3b6ffd4247f6df63cb29d0694b359cdd 1364230961 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Mar 25 17:02:41 2013 +0000]","Body":"BOOKKEEPER-581: Ledger recovery doesn't work correctly when recovery adds force changing ensembles. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1460765 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Mar 25 18:02:41 CET 2013"},{"Commit-ID":"commit feb077afa2e5064f24f011067fd626c81ede8491 1364912085 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Apr 2 14:14:45 2013 +0000]","Body":"BOOKKEEPER-597: Add flag to output test logs to stdout (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1463555 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Apr 02 16:14:45 CEST 2013"},{"Commit-ID":"commit c8f9135e7d3147a2a474df31b430b8c403e2792a 1364917129 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Apr 2 15:38:49 2013 +0000]","Body":"BOOKKEEPER-595: Crash of inprocess autorecovery daemon should not take down the bookie (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1463599 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Apr 02 17:38:49 CEST 2013"},{"Commit-ID":"commit b118823702e946ccdeb14843e2691fdd760a59e4 1365067286 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Apr 4 09:21:26 2013 +0000]","Body":"BOOKKEEPER-596: Ledgers are gc'ed by mistake in MSLedgerManagerFactory. (sijie & ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1464385 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Apr 04 11:21:26 CEST 2013"},{"Commit-ID":"commit cdf138e24b76f934721eb1e82a226d0be296b838 1365358026 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Apr 7 18:07:06 2013 +0000]","Body":"BOOKKEEPER-599: NPE in PerChannelBookieClient (jiannan via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1465437 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sun Apr 07 20:07:06 CEST 2013"},{"Commit-ID":"commit 09ec928ee0218caeef5661ba60978fd18b2e553b 1365358281 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Apr 7 18:11:21 2013 +0000]","Body":"BOOKKEEPER-598: Fails to compile - RESUBSCRIBE_EXCEPTION conflict (Matthew Farrellee via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1465438 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sun Apr 07 20:11:21 CEST 2013"},{"Commit-ID":"commit 685ca079690f8be2cbcfacb615fc0eb5a798b8da 1366994282 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Apr 26 16:38:02 2013 +0000]","Body":"BOOKKEEPER-584: Data loss when ledger metadata is overwritten (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1476283 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Apr 26 18:38:02 CEST 2013"},{"Commit-ID":"commit d175ada58dcaf78f0a70b0ebebf489255ae67b5f 1367670130 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Sat May 4 12:22:10 2013 +0000]","Body":"BOOKKEEPER-564: Better checkpoint mechanism (sijie & ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1479085 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat May 04 14:22:10 CEST 2013"},{"Commit-ID":"commit 3a4f8920ba5017ef37d7641d3d5f0eeb0bbc590b 1367861565 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Mon May 6 17:32:45 2013 +0000]","Body":"BOOKKEEPER-562: Ability to tell if a ledger is closed or not (fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1479649 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon May 06 19:32:45 CEST 2013"},{"Commit-ID":"commit f86e4929ef9c0ddfa7d26d230caefa369a2a0dde 1367956159 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Tue May 7 19:49:19 2013 +0000]","Body":"BOOKkEEPER-577: BookieFailureTest uses sync/wait()/notify() incorrectly (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1480051 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue May 07 21:49:19 CEST 2013"},{"Commit-ID":"commit c2bb7ffb366d5c1942ee2e040516af749a705115 1368092495 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu May 9 09:41:35 2013 +0000]","Body":"BOOKKEEPER-608: Make SyncThread a reusable component (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1480580 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu May 09 11:41:35 CEST 2013"},{"Commit-ID":"commit 4c89310f8b8e09f2ad394a7e7fd5fffc8f51e701 1368182758 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri May 10 10:45:58 2013 +0000]","Body":"BOOKKEEPER-257: Ability to list all ledgers (fpj via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1480978 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri May 10 12:45:58 CEST 2013"},{"Commit-ID":"commit ccc9545c4565c337ef6ea06004149de75b4dd3af 1369994579 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Fri May 31 10:02:59 2013 +0000]","Body":"BOOKKEEPER-611: Speed up bookkeeper tests (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1488138 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri May 31 12:02:59 CEST 2013"},{"Commit-ID":"commit cf2a858bb7bc669e12058e2dda1a996a67d3d37a 1370257410 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Jun 3 11:03:30 2013 +0000]","Body":"BOOKKEEPER-603: Support Boost 1.53 for Hedwig Cpp Client (jiannan via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1488954 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Jun 03 13:03:30 CEST 2013"},{"Commit-ID":"commit faf2ed87762fabe4f6cb5f629cf5a7132869ca60 1370425741 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Jun 5 09:49:01 2013 +0000]","Body":"BOOKKEEPER-617: BOOKKEEPER-544 breaks hedwig-server/bin/hedwig script (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1489775 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jun 05 11:49:01 CEST 2013"},{"Commit-ID":"commit 1c04906c0077d228076c3d157d815e5c7219bb0c 1371055307 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Jun 12 16:41:47 2013 +0000]","Body":"BOOKKEEPER-592: allow application to recommend ledger data locality (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1492274 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jun 12 18:41:47 CEST 2013"},{"Commit-ID":"commit 0a208e10117f8c5201e0414ce3d644d2367b5abc 1371308024 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Sat Jun 15 14:53:44 2013 +0000]","Body":"BOOKKEEPER-626: BOOKIE_EXTRA_OPTS are added twice (vinay via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1493373 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Jun 15 16:53:44 CEST 2013"},{"Commit-ID":"commit 5ef7f760d8ccf2bc765e77891447ed050926f4a3 1371308898 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Sat Jun 15 15:08:18 2013 +0000]","Body":"BOOKKEEPER-627: LedgerDirsMonitor is missing thread name (rakesh via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1493377 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Jun 15 17:08:18 CEST 2013"},{"Commit-ID":"commit fce6d459242361e2363b9b92f8c764b04c7ddfd7 1371315945 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Sat Jun 15 17:05:45 2013 +0000]","Body":"BOOKKEEPER-618: Better resolution of bookie address (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1493400 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Jun 15 19:05:45 CEST 2013"},{"Commit-ID":"commit a3de791cb79873c4f9b99e7ac1b9ade75ea225ac 1371833460 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Jun 21 16:51:00 2013 +0000]","Body":"BOOKKEEPER-619: Bookie should not create local cookie files if zookeeper is uninitialized (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1495508 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Jun 21 18:51:00 CEST 2013"},{"Commit-ID":"commit 01cccee0298f3e0f9d32acc550ed94a7c9fafdfd 1371835597 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Jun 21 17:26:37 2013 +0000]","Body":"BOOKKEEPER-313: Bookkeeper shutdown call from Bookie thread is not shutting down server (vinay via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1495513 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Jun 21 19:26:37 CEST 2013"},{"Commit-ID":"commit 119e2034303b45478123a0fa62c1c48925b201c1 1372210024 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jun 26 01:27:04 2013 +0000]","Body":"BOOKKEEPER-623: LedgerChecker should avoid segments of closed ledger with higher start entryId than closed entry. (vinay via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1496705 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jun 26 03:27:04 CEST 2013"},{"Commit-ID":"commit 0cd4be8fde5206d956addd29cbad0391ceca1716 1372210518 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jun 26 01:35:18 2013 +0000]","Body":"BOOKKEEPER-633: ConcurrentModificationException in RackawareEnsemblePlacementPolicy when a bookie is removed from available list (vinay via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1496706 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jun 26 03:35:18 CEST 2013"},{"Commit-ID":"commit bf3224adf56b74e7d8c2792eec9dcdab9c49e3d3 1372433228 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Jun 28 15:27:08 2013 +0000]","Body":"BOOKKEEPER-620: PerChannelBookieClient race during channel disconnect (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1497814 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Jun 28 17:27:08 CEST 2013"},{"Commit-ID":"commit ad11d4144dbf024fcdfd22a2a043c7790f940dc3 1372786899 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Jul 2 17:41:39 2013 +0000]","Body":"BOOKKEEPER-637: NoSuchEntry exception when reading an entry from a bookie should not print ERROR level message (mmerli via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1499032 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Jul 02 19:41:39 CEST 2013"},{"Commit-ID":"commit 0d9708c65998f48ba9b692ff5532251a0e1b8bc9 1372865941 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Jul 3 15:39:01 2013 +0000]","Body":"BOOKKEEPER-641: DeathWatcher thread is unnecessarily running even after bookie shutdown (rakeshr via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1499445 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jul 03 17:39:01 CEST 2013"},{"Commit-ID":"commit ed3bb58f5cc5cd4176573cb696bb7277c628b26a 1372939297 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Jul 4 12:01:37 2013 +0000]","Body":"BOOKKEEPER-636: Latest txn logs might be deleted in a race condition which is not recoverable if BK goes down before next txn log created. (vinay via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1499731 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jul 04 14:01:37 CEST 2013"},{"Commit-ID":"commit 0ce12e55edb179fc55bc9c5749a589a52bb36b3a 1373729005 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Sat Jul 13 15:23:25 2013 +0000]","Body":"BOOKKEEPER-601: readahead cache size isn't updated correctly (sijie via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1502803 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Jul 13 17:23:25 CEST 2013"},{"Commit-ID":"commit 53c208b09483c90207aecf0e27e669ee810619c2 1373842535 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Sun Jul 14 22:55:35 2013 +0000]","Body":"BOOKKEEPER-600: shouldClaim flag isn't cleared for hedwig multiplex java client (sijie via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1503075 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Jul 15 00:55:35 CEST 2013"},{"Commit-ID":"commit 4d66c36cf8825ab3f9f4a389bddfb924a0df9107 1374343179 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Jul 20 17:59:39 2013 +0000]","Body":"BOOKKEEPER-563: Avoid Journal polluting page cache (Robin Dhamankar via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1505174 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Jul 20 19:59:39 CEST 2013"},{"Commit-ID":"commit f3731732ce984f41b8530939254706f9e597583d 1374343590 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Jul 20 18:06:30 2013 +0000]","Body":"BOOKKEEPER-610: Make SyncThread use an executor (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1505175 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Jul 20 20:06:30 CEST 2013"},{"Commit-ID":"commit d9682edfc57911ccb9d70ae41c6627112a96a355 1374344197 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Jul 20 18:16:37 2013 +0000]","Body":"BOOKKEEPER-635: jenkins build should highlight which lines of the patch cause raw analysis errors (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1505179 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Jul 20 20:16:37 CEST 2013"},{"Commit-ID":"commit 4a2c740129d506f620dcfbdb5e1e852258a726d2 1374344694 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Jul 20 18:24:54 2013 +0000]","Body":"BOOKKEEPER-646: BookieShell readjournal command is throwing BufferUnderflowException (Rakesh via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1505181 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Jul 20 20:24:54 CEST 2013"},{"Commit-ID":"commit 61e619c2b2215fca05df3498256e3f0966a668ff 1374345004 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Jul 20 18:30:04 2013 +0000]","Body":"BOOKKEEPER-652: Logger class name is wrong in LedgerCacheImpl.java (Rakesh via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1505185 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Jul 20 20:30:04 CEST 2013"},{"Commit-ID":"commit a889f63d1041a84d6b894874b31681ed35312781 1374509018 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Jul 22 16:03:38 2013 +0000]","Body":"BOOKKEEPER-607: Filtered Messages Require ACK from Client Causes User Being Throttled Incorrectly Forever (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1505726 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Jul 22 18:03:38 CEST 2013"},{"Commit-ID":"commit 67ffec189fc77e53a8dcbe666b1695a3b790e8da 1374675278 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Jul 24 14:14:38 2013 +0000]","Body":"BOOKKEEPER-653: Timeout option is missing in few testcases (Rakesh via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1506569 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jul 24 16:14:38 CEST 2013"},{"Commit-ID":"commit d3328c5a78137de5416f3d8bc1f269f2ac648e6b 1374677731 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Jul 24 14:55:31 2013 +0000]","Body":"BOOKKEEPER-642: Bookie returns incorrect exitcode, ExitCode.ZK_REG_FAIL is getting overridden (Rakesh via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1506582 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jul 24 16:55:31 CEST 2013"},{"Commit-ID":"commit 22509a7a2c8acbd5cce182529169fc0057e55b0d 1375093832 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Jul 29 10:30:32 2013 +0000]","Body":"BOOKKEEPER-663: HierarchicalLedgerManager iterator is missing some ranges and the last ledger in the range (mmerli via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1507997 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Jul 29 12:30:32 CEST 2013"},{"Commit-ID":"commit d1ad860f8e83530e0d8f1498a35da2e9fbb85962 1376326865 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Aug 12 17:01:05 2013 +0000]","Body":"BOOKKEEPER-604: Ledger storage can log an exception if GC happens concurrently. (sijie & ivank via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1513198 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Aug 12 19:01:05 CEST 2013"},{"Commit-ID":"commit 94d65d8d2e3239ad0694d3c2252fca0e3dbea8b3 1376397157 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Aug 13 12:32:37 2013 +0000]","Body":"BOOKKEEPER-667: Client write will fail with BadMetadataVersion in case of multiple Bookie failures with AutoRecovery enabled (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1513459 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Aug 13 14:32:37 CEST 2013"},{"Commit-ID":"commit 2179f1bf6d656d7c5f7e89f2eeaaa0732f0b9608 1376995910 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Aug 20 10:51:50 2013 +0000]","Body":"BOOKKEEPER-668: Race between PerChannelBookieClient#channelDisconnected() and disconnect() calls can make clients hang while add/reading entries in case of multiple bookie failures (sijie & ivank via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1515769 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Aug 20 12:51:50 CEST 2013"},{"Commit-ID":"commit f41bb6f8b521e26a0a746530e648a9ca2120af51 1376996579 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Aug 20 11:02:59 2013 +0000]","Body":"BOOKKEEPER-624: Reduce logs generated by ReplicationWorker (vinay via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1515774 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Aug 20 13:02:59 CEST 2013"},{"Commit-ID":"commit c4fd34f0f13a044c0261732ff2dd454acc4b73de 1377083961 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Aug 21 11:19:21 2013 +0000]","Body":"BOOKKEEPER-632: AutoRecovery should consider read only bookies (vinay via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1516139 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Aug 21 13:19:21 CEST 2013"},{"Commit-ID":"commit d8e6972385e6662ddcf398fc2de47622a9bef22d 1377182410 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Aug 22 14:40:10 2013 +0000]","Body":"BOOKKEEPER-649: Race condition in sync ZKUtils.createFullPathOptimistic() (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1516465 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Aug 22 16:40:10 CEST 2013"},{"Commit-ID":"commit 98d6dcec7403c523cfd07cf48ed878e1ab13eae0 1377276517 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Aug 23 16:48:37 2013 +0000]","Body":"BOOKKEEPER-580: improve close logic (sijie & ivank via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1516929 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Aug 23 18:48:37 CEST 2013"},{"Commit-ID":"commit aadaae443e1bc70505150a3218a54ff66ebfb921 1378818880 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Sep 10 13:14:40 2013 +0000]","Body":"BOOKKEEPER-446: BookKeeper.createLedger(..) should not mask the error with ZKException (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1521474 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Sep 10 15:14:40 CEST 2013"},{"Commit-ID":"commit bc0eb8b14278999a5c6550fbca6531b862beb12b 1378852446 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Sep 10 22:34:06 2013 +0000]","Body":"BOOKKEEPER-675: Log noise fixup before cutting 4.2.2 (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1521667 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Sep 11 00:34:06 CEST 2013"},{"Commit-ID":"commit 441891b2d76b3b0244d00480e0ab70f2d2121d57 1380274627 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Sep 27 09:37:07 2013 +0000]","Body":"BOOKKEEPER-683: TestSubAfterCloseSub fails on 4.2 (jiannan via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1526841 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Sep 27 11:37:07 CEST 2013"},{"Commit-ID":"commit dea488afbf4615e4416079f5517a6e3ae1000c17 1380687813 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Oct 2 04:23:33 2013 +0000]","Body":"BOOKKEEPER-640: Log improvement - add shutdown/exit log message for the bookie services (rakesh via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1528304 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Oct 02 06:23:33 CEST 2013"},{"Commit-ID":"commit e2013e3f2b2e3e10ce5d1977adac8e073fd0404d 1380688839 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Oct 2 04:40:39 2013 +0000]","Body":"BOOKKEEPER-666: Naming threads of ExecutorService (rakesh via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1528305 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Oct 02 06:40:39 CEST 2013"},{"Commit-ID":"commit 3d9bb20a7f7e510bce7c16be392c0ac82c3a3496 1380689675 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Oct 2 04:54:35 2013 +0000]","Body":"BOOKKEEPER-645: Bookkeeper shell command to get a list of readonly bookies (rakesh via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1528306 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Oct 02 06:54:35 CEST 2013"},{"Commit-ID":"commit 8dafa943a1d5a1cf562d94cc6d2f656e0c0be17e 1380690112 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Oct 2 05:01:52 2013 +0000]","Body":"BOOKKEEPER-686: Bookie startup will fail if one of the configured ledgerDir is full and the same is used for replaying the journal (Rakesh via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1528307 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Oct 02 07:01:52 CEST 2013"},{"Commit-ID":"commit 0f853a49d7e6899151f63ae9b1912ed936e5a5fb 1381473387 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Oct 11 06:36:27 2013 +0000]","Body":"BOOKKEEPER-658: ledger cache refactor (Robin Dhamankar via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1531203 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Oct 11 08:36:27 CEST 2013"},{"Commit-ID":"commit d9f4e60c850291d17e12ed44776b88cf02335701 1381501120 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Oct 11 14:18:40 2013 +0000]","Body":"BOOKKEEPER-638: Two bookies could start at the same time to access bookie data. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1531302 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Oct 11 16:18:40 CEST 2013"},{"Commit-ID":"commit bedfebf93f8c9f93fac19bd58005dce6e0ffbd17 1381549341 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Oct 12 03:42:21 2013 +0000]","Body":"BOOKKEEPER-657: Journal Improvement (Robin Dhamankar via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1531494 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Oct 12 05:42:21 CEST 2013"},{"Commit-ID":"commit dc1f36e982f3fc2955141c8e0de5e04c6ac06053 1381549410 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Oct 12 03:43:30 2013 +0000]","Body":"BOOKKEEPER-657: Journal Improvement (Robin Dhamankar via sijie) (add missing file)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1531495 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Oct 12 05:43:30 CEST 2013"},{"Commit-ID":"commit 16978d671b8d6d9e563edb3a6119a4be574245af 1381761804 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Oct 14 14:43:24 2013 +0000]","Body":"BOOKKEEPER-605: Use static Logger objects everywhere for bookkeeper (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1531920 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Oct 14 16:43:24 CEST 2013"},{"Commit-ID":"commit a3575c3ebcb323a53d7a193488453aa44557c97a 1381765124 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Oct 14 15:38:44 2013 +0000]","Body":"BOOKKEEPER-676: Make add asynchrounous in ledger recovery (aniruddha via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1531944 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Oct 14 17:38:44 CEST 2013"},{"Commit-ID":"commit 33ea58027b0a3ba160f7ac19d20568709f453f4d 1381768347 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Oct 14 16:32:27 2013 +0000]","Body":"BOOKKEEPER-673: Ledger length can be inaccurate in failure case (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1531970 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Oct 14 18:32:27 CEST 2013"},{"Commit-ID":"commit 24dc8ac30c97620cf4dbef48deff2bb957932eb8 1382420146 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Oct 22 05:35:46 2013 +0000]","Body":"BOOKKEEPER-688: NPE exception in PerChannelBookieClient (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1534498 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Oct 22 07:35:46 CEST 2013"},{"Commit-ID":"commit 9602c32f16184e10873d53c269e270e3cd0ebeed 1382420653 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Oct 22 05:44:13 2013 +0000]","Body":"BOOKKEEPER-664: Compaction increases latency on journal writes (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1534503 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Oct 22 07:44:13 CEST 2013"},{"Commit-ID":"commit bf5c1838b4b0d764aa9f24842643fd9339610b9c 1382451688 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Oct 22 14:21:28 2013 +0000]","Body":"BOOKKEEPER-659: LRU page management in ledger cache. (Aniruddha, Robin Dhamankar & sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1534640 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Oct 22 16:21:28 CEST 2013"},{"Commit-ID":"commit 2d0cd0d1b9d41f3b600f6dac308c6d34317ae676 1383020058 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Oct 29 04:14:18 2013 +0000]","Body":"BOOKKEEPER-602: we should have request timeouts rather than channel timeout in PerChannelBookieClient (Aniruddha, ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1536584 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Oct 29 05:14:18 CET 2013"},{"Commit-ID":"commit cd05194d8bbb03a08d8d9fbeb09738bd8a2e09a8 1383037734 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Oct 29 09:08:54 2013 +0000]","Body":"BOOKKEEPER-614: Generic stats interface, which multiple providers can be plugged into (sijie & ivank via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1536616 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Oct 29 10:08:54 CET 2013"},{"Commit-ID":"commit 6c6ec2b2f9cb1aff37001f3d9f002cc820096404 1383040682 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Oct 29 09:58:02 2013 +0000]","Body":"BOOKKEEPER-615: Twitter stats implementation of stats interface (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1536635 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Oct 29 10:58:02 CET 2013"},{"Commit-ID":"commit f345cb9472250eca2b724fa14b8d2c08425b6a2f 1383109187 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Oct 30 04:59:47 2013 +0000]","Body":"BOOKKEEPER-698: Bookie client closure is not considering timeoutExecutor (rakesh via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1536965 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Oct 30 05:59:47 CET 2013"},{"Commit-ID":"commit ea4a13a45d8d2102f5f0098e404d3de66777a39b 1383146634 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Oct 30 15:23:54 2013 +0000]","Body":"BOOKKEEPER-700: GarbageCollectorThread exsiting with ArrayIndexOutOfBoundsException (rakeshr via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1537130 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Oct 30 16:23:54 CET 2013"},{"Commit-ID":"commit eb7066a02a50e2b15e66dfd4e99706ecf79454e6 1384022995 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Nov 9 18:49:55 2013 +0000]","Body":"BOOKKEEPER-699: Codahale metrics implementation of stats API (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1540366 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Nov 09 19:49:55 CET 2013"},{"Commit-ID":"commit 67dccebdbee27476657898a370c4f1808231fc4b 1385113215 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Nov 22 09:40:15 2013 +0000]","Body":"BOOKKEEPER-678: BookieServer shutdown hangs indefinitely at NioServerSocketChannelFactory.releaseExternalResources (rakeshr via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1544452 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Nov 22 10:40:15 CET 2013"},{"Commit-ID":"commit 7c7e009691bc24642018e4f5c81123a0667d4e8b 1386006313 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Dec 2 17:45:13 2013 +0000]","Body":"BOOKKEEPER-565: Make an option to separate storing entry log files from index files. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1547123 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Dec 02 18:45:13 CET 2013"},{"Commit-ID":"commit 810f10e9c628604a7697172df79478d9186be637 1386225211 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Dec 5 06:33:31 2013 +0000]","Body":"BOOKKEEPER-711: bookkeeper-daemon.sh will not remove the pid file one successful stop (vinay via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1548023 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Dec 05 07:33:31 CET 2013"},{"Commit-ID":"commit 42185c2e3d9e6d85b095842ac051f3a3c4a4d22f 1386225356 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Dec 5 06:35:56 2013 +0000]","Body":"BOOKKEEPER-712: bookkeeper script should use java from JAVA_HOME (vinay via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1548024 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Dec 05 07:35:56 CET 2013"},{"Commit-ID":"commit 34c260bfc7db379351fa8807897603b9a9b9012b 1386311976 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Dec 6 06:39:36 2013 +0000]","Body":"BOOKKEEPER-701: Improve exception handling of Bookkeeper threads (rakesh via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1548385 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Dec 06 07:39:36 CET 2013"},{"Commit-ID":"commit 5c3a30f8e423da51b1ee03173a336400335de3b8 1388769162 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Fri Jan 3 17:12:42 2014 +0000]","Body":"BOOKKEEPER-709: SlowBookieTest#testSlowBookie fails intermittently (Rakesh R via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1555158 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Jan 03 18:12:42 CET 2014"},{"Commit-ID":"commit 79a73f0f71be5701b44ab47c14f92945989b1417 1389249011 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jan 9 06:30:11 2014 +0000]","Body":"BOOKKEEPER-714: Logging channel exceptions in PerChannelBookieClient (sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1556732 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jan 09 07:30:11 CET 2014"},{"Commit-ID":"commit da8864ad7cd53d302eb27ab31f942bdbae160a98 1389797880 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Jan 15 14:58:00 2014 +0000]","Body":"BOOKKEEPER-662: Major GC should kick in immediately if remaining space reaches a warning threshold (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1558410 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jan 15 15:58:00 CET 2014"},{"Commit-ID":"commit 78c0d2515f2e381b2c690bdbf2bf9bad03d1250c 1389978823 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Jan 17 17:13:43 2014 +0000]","Body":"BOOKKEEPER-710: OpenLedgerNoRecovery should watch ensemble change. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1559192 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Jan 17 18:13:43 CET 2014"},{"Commit-ID":"commit 96cc0e11ca2166a5e5326be4ead0dab595b7e4bc 1390277100 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jan 21 04:05:00 2014 +0000]","Body":"BOOKKEEPER-429: Provide separate read and write threads in the bookkeeper server (Aniruddha via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1559917 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Jan 21 05:05:00 CET 2014"},{"Commit-ID":"commit 75f103d9d6694ae0116fe741a2dfbf60e3c63ce1 1390277949 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jan 21 04:19:09 2014 +0000]","Body":"BOOKKEEPER-696: stats collection on bookkeeper client (Aniruddha, ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1559918 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Jan 21 05:19:09 CET 2014"},{"Commit-ID":"commit 23f3760dd5d79e6894616834aa41d59089c9548a 1390318889 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Jan 21 15:41:29 2014 +0000]","Body":"BOOKKEEPER-719: Inconsistent synchronization of org.apache.bookkeeper.stats.CodahaleMetricsProvider.metrics (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1560045 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Jan 21 16:41:29 CET 2014"},{"Commit-ID":"commit 9b1e561cb5e4f081f40bf8b751bcc2c16226092e 1390321583 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Jan 21 16:26:23 2014 +0000]","Body":"BOOKKEEPER-661: Turn readonly back to writable if spaces are reclaimed. (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1560066 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Jan 21 17:26:23 CET 2014"},{"Commit-ID":"commit 7b44d9552d8b854160278582db3f5ca07882358a 1390372655 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jan 22 06:37:35 2014 +0000]","Body":"BOOKKEEPER-720: CheckpointSource.MIN#compareTo does exactly the opposite of what it should (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1560263 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jan 22 07:37:35 CET 2014"},{"Commit-ID":"commit 694568b0ff0d048c284c8d5db0c9455d30dfa3ce 1390397703 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Jan 22 13:35:03 2014 +0000]","Body":"BOOKKEEPER-643: Improve concurrency of entry logger (sijie & Aniruddha via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1560348 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Jan 22 14:35:03 CET 2014"},{"Commit-ID":"commit 8bb0cde556cf1dc07d62cd74ca6739b392242cf0 1390551974 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jan 24 08:26:14 2014 +0000]","Body":"BOOKKEEPER-703: Document all the settings added in BOOKKEEPER-656 (sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1560917 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Jan 24 09:26:14 CET 2014"},{"Commit-ID":"commit 0345c8095ee47aefd7d40a07e2a621079c94f4fd 1391319225 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Feb 2 05:33:45 2014 +0000]","Body":"BOOKKEEPER-708: Shade protobuf library to avoid incompatible versions (rakesh, ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1563566 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sun Feb 02 06:33:45 CET 2014"},{"Commit-ID":"commit 92a62781682721e7c6bb47a95c72029fb91d2e2f 1391636619 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Wed Feb 5 21:43:39 2014 +0000]","Body":"BOOKKEEPER-644: Provide a bookie address wrapper (sijie via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1564946 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Feb 05 22:43:39 CET 2014"},{"Commit-ID":"commit 94ebe62b8c6ddcd2b52e8bc4eac4e102ff4cf720 1391637125 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Wed Feb 5 21:52:05 2014 +0000]","Body":"BOOKKEEPER-727: Names of bookie write/read threads are backwards (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1564949 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Feb 05 22:52:05 CET 2014"},{"Commit-ID":"commit 63232dec02952e3404beeafd0c73fc61c2c7cd17 1391674868 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Feb 6 08:21:08 2014 +0000]","Body":"BOOKKEEPER-728: Bookkeeper#Builder is not public, so can't be used outside of client package (ivank via fpj)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1565105 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Feb 06 09:21:08 CET 2014"},{"Commit-ID":"commit b62a67b1b11a10fe378a0bef25b846887cd104b1 1391675145 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Feb 6 08:25:45 2014 +0000]","Body":"BOOKKEEPER-729: Bookie shouldn't exit with 0, if exiting from deathwatcher and thread death was caused by OOM (ivank via fpj)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1565109 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Feb 06 09:25:45 CET 2014"},{"Commit-ID":"commit 3870ff300c64dc41828fdc8c9627e76450cff077 1391675471 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Feb 6 08:31:11 2014 +0000]","Body":"BOOKKEEPER-725: AutoRecoveryMain should exit with error code if deathwatcher finds dead thread (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1565112 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Feb 06 09:31:11 CET 2014"},{"Commit-ID":"commit 7e0b69cac5d406c777765bc1fa879520ea9176ec 1391675655 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Feb 6 08:34:15 2014 +0000]","Body":"BOOKKEEPER-726: PerChannelBookieClient should print address that it failed to connect to when it fails to correct (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1565115 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Feb 06 09:34:15 CET 2014"},{"Commit-ID":"commit 8aafd10f6634f039e33b0576d4b61121b494e93a 1391686334 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Thu Feb 6 11:32:14 2014 +0000]","Body":"BOOKKEEPER-724: Shade introduces RAT error (sijie via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1565180 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Feb 06 12:32:14 CET 2014"},{"Commit-ID":"commit 68ffb83d69e6e9be3da94e78d5f76bd6c57b2316 1392011540 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Feb 10 05:52:20 2014 +0000]","Body":"BOOKKEEPER-732: Add env variable ENTRY_FORMATTER_CLASS to the bkenv.sh (rakesh via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1566510 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Feb 10 06:52:20 CET 2014"},{"Commit-ID":"commit f19744d30ed879022a66de885cb1236d54582d2b 1392011637 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Feb 10 05:53:57 2014 +0000]","Body":"BOOKKEEPER-731: Missing BOOKIE_PID_DIR and BOOKIE_STOP_TIMEOUT in env variables list (rakesh via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1566512 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Feb 10 06:53:57 CET 2014"},{"Commit-ID":"commit 653dd6d733e9022a6189a2c8546bb8e3afa22715 1393005677 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Feb 21 18:01:17 2014 +0000]","Body":"BOOKKEEPER-654: Bookkeeper client operations are allowed even after its closure, bk#close() (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1570647 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Feb 21 19:01:17 CET 2014"},{"Commit-ID":"commit 261bb8f671dc233d3b604b3355bb20d82edac539 1394194485 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Mar 7 12:14:45 2014 +0000]","Body":"BOOKKEEPER-717: journal should look forward to group time-out entries (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1575243 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Mar 07 13:14:45 CET 2014"},{"Commit-ID":"commit 12daded8c22edc11363ec4eddfbba670e66ee9ad 1394195454 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Mar 7 12:30:54 2014 +0000]","Body":"BOOKKEEPER-715: bookie: delay dropping journal cached pages (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1575246 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Mar 07 13:30:54 CET 2014"},{"Commit-ID":"commit 9d4ce1671cd6731b9b9652399c24a91c34e0bc65 1394195659 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Mar 7 12:34:19 2014 +0000]","Body":"BOOKKEEPER-730: Shade pom file missing apache license header (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1575247 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Mar 07 13:34:19 CET 2014"},{"Commit-ID":"commit 2d427e8d4b2c1d889ab5586e28e198c140a10489 1394213977 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri Mar 7 17:39:37 2014 +0000]","Body":"BOOKKEEPER-363: Re-distributing topics among newly added hubs. (aniruddha via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1575338 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Mar 07 18:39:37 CET 2014"},{"Commit-ID":"commit 1ac25ebe98dd3038f68fe80e79570b9beceb0be8 1394417675 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Mar 10 02:14:35 2014 +0000]","Body":"BOOKKEEPER-740: AutoRecoveryMainTest#testAutoRecoverySessionLoss is failing (Rakesh via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1575795 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Mar 10 03:14:35 CET 2014"},{"Commit-ID":"commit 88533163987f328be1d36c9f6fc208667f2144a0 1394656018 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Mar 12 20:26:58 2014 +0000]","Body":"BOOKKEEPER-432: Improve performance of entry log range read per ledger entries (yixue, sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1576883 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Mar 12 21:26:58 CET 2014"},{"Commit-ID":"commit e1838f47800120252a3b5db77b7d1169e1daf801 1398329036 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Apr 24 08:43:56 2014 +0000]","Body":"BOOKKEEPER-742: Fix for empty ledgers losing quorum. (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1589636 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Apr 24 10:43:56 CEST 2014"},{"Commit-ID":"commit 54c54f71a5fad10838c66c6a6b28ef13d9388931 1398343474 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Thu Apr 24 12:44:34 2014 +0000]","Body":"BOOKKEEPER-743: Periodic ledger check running too often as doc doesn't match implementation. (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1589694 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Apr 24 14:44:34 CEST 2014"},{"Commit-ID":"commit 5c18886657c88f48672554c0f814cf6418ad1e18 1398802032 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Apr 29 20:07:12 2014 +0000]","Body":"BOOKKEEPER-716: padding writes for bookie journal (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1591079 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Apr 29 22:07:12 CEST 2014"},{"Commit-ID":"commit 4c27506835dd0a58ee0a37c4422c44237a344b30 1399372254 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue May 6 10:30:54 2014 +0000]","Body":"BOOKKEEPER-744: Run the auditor bookie check periodically (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1592705 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue May 06 12:30:54 CEST 2014"},{"Commit-ID":"commit e824ac2691f4e86ac5ced675cd3ffb66f00e059a 1399372802 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue May 6 10:40:02 2014 +0000]","Body":"BOOKKEEPER-744: Run the auditor bookie check periodically (ivank) [missing files]\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1592706 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue May 06 12:40:02 CEST 2014"},{"Commit-ID":"commit 19b821c63b91293960041bca7b031614a109a7b8 1399637085 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri May 9 12:04:45 2014 +0000]","Body":"BOOKKEEPER-629: Support hostname based ledger metadata to help users to change IP with existing installation (rakeshr via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1593518 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri May 09 14:04:45 CEST 2014"},{"Commit-ID":"commit 3ed06c0e9246a3ac21e1340d01f1ee7be612194f 1399875000 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon May 12 06:10:00 2014 +0000]","Body":"BOOKKEEPER-747: Implement register/unregister LedgerMetadataListener in MSLedgerManagerFactory (fpj via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1593889 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon May 12 08:10:00 CEST 2014"},{"Commit-ID":"commit e3594b50f93b881f8ded9fe26c9ae2f875e054ea 1400107263 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Wed May 14 22:41:03 2014 +0000]","Body":"BOOKKEEPER-755: Incorrect number of seconds specified in a day (Joseph Redfern via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1594744 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu May 15 00:41:03 CEST 2014"},{"Commit-ID":"commit 151c50dbe992efcaf0fa831dbf829b792b8bb925 1400863565 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Fri May 23 16:46:05 2014 +0000]","Body":"BOOKKEEPER-750. Flake in BookieAutoRecoveryTest#testEmptyLedgerLosesQuorumEventually (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1597124 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri May 23 18:46:05 CEST 2014"},{"Commit-ID":"commit d67f3a752d291b1f55e5b9597eca6b135d3626ee 1400863691 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Fri May 23 16:48:11 2014 +0000]","Body":"BOOKKEEPER-750. Flake in BookieAutoRecoveryTest#testEmptyLedgerLosesQuorumEventually (ivank via fpj)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1597125 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri May 23 18:48:11 CEST 2014"},{"Commit-ID":"commit ce3abc6e03216563613db23bd8dd11cf58645982 1401191761 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue May 27 11:56:01 2014 +0000]","Body":"BOOKKEEPER-756: Use HashedwheelTimer for request timeouts for PCBC (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1597752 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue May 27 13:56:01 CEST 2014"},{"Commit-ID":"commit 209dbf4982eb997c9691c4331dcaea3b7e4af6d6 1401446507 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri May 30 10:41:47 2014 +0000]","Body":"BOOKKEEPER-763: findbugs fails to run on jenkins (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1598541 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri May 30 12:41:47 CEST 2014"},{"Commit-ID":"commit 64d0170510849e29de9762957a7107d1a7f07284 1401451294 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri May 30 12:01:34 2014 +0000]","Body":"BOOKKEEPER-758: Add TryReadLastAddConfirmed API (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1598565 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri May 30 14:01:34 CEST 2014"},{"Commit-ID":"commit d11665de31b5ee6969128062569f2081b5d9cf79 1401455234 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Fri May 30 13:07:14 2014 +0000]","Body":"BOOKKEEPER-751: Ensure all the bookkeeper callbacks not run under ledger handle lock (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1598585 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri May 30 15:07:14 CEST 2014"},{"Commit-ID":"commit d86917af98c2a7442619f1b71aa6d4d1da5945f4 1401702843 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Jun 2 09:54:03 2014 +0000]","Body":"BOOKKEEPER-745: Fix for false reports of ledger unreplication during rolling restarts. (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1599145 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Jun 02 11:54:03 CEST 2014"},{"Commit-ID":"commit 404b83abafb94b62c0ced2ba7cf6878762643746 1401791713 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Jun 3 10:35:13 2014 +0000]","Body":"BOOKKEEPER-746: 5 new shell commands. List ledgers, list metadata, list underreplicated, show auditor and simpletest (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1599470 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Jun 03 12:35:13 CEST 2014"},{"Commit-ID":"commit 68deb96d2d1de45eea0c358c0eab39847d51e1f8 1401965789 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Thu Jun 5 10:56:29 2014 +0000]","Body":"BOOKKEEPER-766: Update notice.txt files to include 2014 (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1600594 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jun 05 12:56:29 CEST 2014"},{"Commit-ID":"commit 80c6e5526c63409e4f359905d0fd319ac7d2b129 1402061387 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Fri Jun 6 13:29:47 2014 +0000]","Body":"BOOKKEEPER-767: Allow loopback in tests (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1600881 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Jun 06 15:29:47 CEST 2014"},{"Commit-ID":"commit c9db762707538a99a92852e60b88bed577b01377 1402394505 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Jun 10 10:01:45 2014 +0000]","Body":"BOOKKEEPER-765 bookkeeper script should fall back to java in path if JAVA_HOME is not set (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1601592 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Jun 10 12:01:45 CEST 2014"},{"Commit-ID":"commit 37fda574a530eedc6bd3ba5030e2f3e0805c10f8 1405408161 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jul 15 07:09:21 2014 +0000]","Body":"BOOKKEEPER-768: fix typo seconds to milliseconds in benchmark output (jialin via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1610596 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Jul 15 09:09:21 CEST 2014"},{"Commit-ID":"commit 8f09334e24deaa8e80674a702c498d802986f3c8 1406158879 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Wed Jul 23 23:41:19 2014 +0000]","Body":"BOOKKEEPER-739: Test timeouts mostly ignored (sijie via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1612972 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Jul 24 01:41:19 CEST 2014"},{"Commit-ID":"commit c81076e4d9521bc67653a917e9fb9edbe27bf073 1406241259 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Thu Jul 24 22:34:19 2014 +0000]","Body":"BOOKKEEPER-582: Make bookie and client use protobuf for requests (non-wire part)\n(sijie via fpj)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1613315 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Jul 25 00:34:19 CEST 2014"},{"Commit-ID":"commit 4ec0bf11c3fdb78e390c5c889140d8fbf87ce60b 1406357512 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Jul 26 06:51:52 2014 +0000]","Body":"BOOKKEEPER-582: Make bookie and client use protobuf for requests (non-wire part) (missing files) (sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1613567 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Jul 26 08:51:52 CEST 2014"},{"Commit-ID":"commit 69620e6561196975295752175b01354877a9fdde 1407002526 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Sat Aug 2 18:02:06 2014 +0000]","Body":"BOOKEEPER-697. stats collection on bookkeeper server (sijie via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1615338 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Aug 02 20:02:06 CEST 2014"},{"Commit-ID":"commit e30e116fc65088aad428b4151e1ab39c73c99676 1407300522 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Aug 6 04:48:42 2014 +0000]","Body":"BOOKKEEPER-697: stats collection on bookkeeper server (sijie via fpj) (missing file)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1616094 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Aug 06 06:48:42 CEST 2014"},{"Commit-ID":"commit b6f33e49d0671a5b982bcb3613c5c9844f6aec8b 1407996959 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Aug 14 06:15:59 2014 +0000]","Body":"BOOKKEEPER-774: Flaky test org.apache.bookkeeper.test.ReadOnlyBookieTest.testBookieShouldTurnWritableFromReadOnly (sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1617888 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Aug 14 08:15:59 CEST 2014"},{"Commit-ID":"commit 38a6fd30048c5fe165409a9ca536fb1ffbdbf537 1408395615 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Aug 18 21:00:15 2014 +0000]","Body":"BOOKKEEPER-704: reconnectable zookeeper client wrapper (sijie via ivank)\n\nChange-Id: I00c73788f4ed5911713906b4d7622ca6dcec79a5\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1618732 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Aug 18 23:00:15 CEST 2014"},{"Commit-ID":"commit c0cef66c6b34c635ec69a69ef033f96600ca5b99 1408395821 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Aug 18 21:03:41 2014 +0000]","Body":"BOOKKEEPER-630: Add tag to o.a.b.net.* to indict which release of hadoop they came from, move DNS to o.a.b.net.* and indent (sijie via ivank)\n\nChange-Id: I9dd16912da6f23543d069434e9419495fdf8f314\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1618737 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Aug 18 23:03:41 CEST 2014"},{"Commit-ID":"commit e61a1968c488a7517912be69e5d2cc98eb421040 1408437143 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Aug 19 08:32:23 2014 +0000]","Body":"BOOKKEEPER-704: reconnectable zookeeper client wrapper (sijie via ivank) [missing file]\n\nChange-Id: I46cf3237ec5e1998039fedee9d127752c1389a73\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1618817 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Aug 19 10:32:23 CEST 2014"},{"Commit-ID":"commit 0c96765dffe3850ae6fc80397f9bc221421f1fa3 1409867371 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Thu Sep 4 21:49:31 2014 +0000]","Body":"BOOKKEEPER-780: Findbug issue in trunk (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1622568 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Sep 04 23:49:31 CEST 2014"},{"Commit-ID":"commit 8f81eba34d2af8444be9f713447e12f4387e5932 1409980433 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Sep 6 05:13:53 2014 +0000]","Body":"BOOKKEEPER-777: Flake in LedgerCloseTest (ivank via fpj)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1622827 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Sep 06 07:13:53 CEST 2014"},{"Commit-ID":"commit fd6835e4f06d3cbb6a33062f582e4756d0a3139b 1409981222 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Sep 6 05:27:02 2014 +0000]","Body":"BOOKKEEPER-779: jmx reporter for codahale metrics provider (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1622828 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Sep 06 07:27:02 CEST 2014"},{"Commit-ID":"commit 8abec018fca57d9cee9efd13a7085d8808a3b57e 1409982668 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Sep 6 05:51:08 2014 +0000]","Body":"BOOKKEEPER-718: AuditorLedgerCheckerTest is flakey (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1622830 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Sep 06 07:51:08 CEST 2014"},{"Commit-ID":"commit 6fe9f6349443aaa193749e7d436a7aaca30d3ccd 1409983127 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Sep 6 05:58:47 2014 +0000]","Body":"BOOKKEEPER-736: Stats for AutoRecovery (sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1622832 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Sat Sep 06 07:58:47 CEST 2014"},{"Commit-ID":"commit caf9ef945c93833f8cbc3bb0e6e451e1e58855cb 1410235030 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Sep 9 03:57:10 2014 +0000]","Body":"BOOKKEEPER-778: Flake in TestTryReadLastConfirmed (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1623618 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Sep 09 05:57:10 CEST 2014"},{"Commit-ID":"commit 2e1346c5fb6f8641f23dd926e1626211657be2ca 1410253380 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Tue Sep 9 09:03:00 2014 +0000]","Body":"BOOKKEEPER-781: Fix OOM on Hedwig Tests (sijie via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1623713 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Sep 09 11:03:00 CEST 2014"},{"Commit-ID":"commit fb6324b064e5b367d48d59fc44381462431d500a 1410259201 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Tue Sep 9 10:40:01 2014 +0000]","Body":"BOOKKEEPER-776: Flaky test BookieRecoveryTest (ivank via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1623741 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Sep 09 12:40:01 CEST 2014"},{"Commit-ID":"commit 77e68b5b033f306f8575b66278e8765784394413 1410388888 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Wed Sep 10 22:41:28 2014 +0000]","Body":"BOOKKEEPER-775: Improve MultipleThreadReadTest to reduce flakiness (sijie via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1624161 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Sep 11 00:41:28 CEST 2014"},{"Commit-ID":"commit c918051659f9f9231989531304a0a0a15f0f939e 1410964368 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Sep 17 14:32:48 2014 +0000]","Body":"BOOKKEEPER-783: Avoid running out of fds in MutlipleThreadReadTest (sijie via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1625611 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Sep 17 16:32:48 CEST 2014"},{"Commit-ID":"commit 4f0e52d027ed277576344ecbde1938ed3eeb7aae 1411015642 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Sep 18 04:47:22 2014 +0000]","Body":"BOOKKEEPER-785: Fix javadoc warnings in trunk (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1625885 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Sep 18 06:47:22 CEST 2014"},{"Commit-ID":"commit 4a2174a91fbd6b85fed640ef58f1c98fd28ee2d4 1411016001 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Sep 18 04:53:21 2014 +0000]","Body":"BOOKKEEPER-784: BookKeeperCloseTest#testLedgerCheck is failing intermittently (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1625886 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Sep 18 06:53:21 CEST 2014"},{"Commit-ID":"commit 86480a21d366210eec96a7f47f2d43f1313705cc 1411016237 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Sep 18 04:57:17 2014 +0000]","Body":"BOOKKEEPER-782: Use builder pattern for Cookie (rakeshr via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1625888 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Thu Sep 18 06:57:17 CEST 2014"},{"Commit-ID":"commit 36478d1e639ba099cc4256ca2b2fbcc98f7649dd 1411380695 -----sp","Author":"PersonIdent[Flavio Paiva Junqueira, fpj@apache.org, Mon Sep 22 10:11:35 2014 +0000]","Body":"BOOKKEEPER-786: Fix Findbugs Error In Codahale Stats Provider (sijie via fpj)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1626721 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Sep 22 12:11:35 CEST 2014"},{"Commit-ID":"commit 479cb452d43785c88c729934e079d5ca4939ba90 1411487620 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Tue Sep 23 15:53:40 2014 +0000]","Body":"BOOKKEEPER-787: Modify Cookie by removing 'znodeVersion' state/field (rakeshr via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1627068 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Sep 23 17:53:40 CEST 2014"},{"Commit-ID":"commit 2d630bbd594de7a79afbf227ed41f84484a527f5 1412000962 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Mon Sep 29 14:29:22 2014 +0000]","Body":"BOOKKEEPER-773: Provide admin tool to rename bookie identifier in Cookies (rakeshr via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1628193 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Mon Sep 29 16:29:22 CEST 2014"},{"Commit-ID":"commit 643992144d17297d2a5a8414f0a1e106d0fc8b99 1412320897 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Oct 3 07:21:37 2014 +0000]","Body":"Preparing for release 4.3.0\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1629124 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Oct 03 09:21:37 CEST 2014"},{"Commit-ID":"commit 528270848b98f2090d51dfea9f6652aa1fc10b66 1412321430 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Oct 3 07:30:30 2014 +0000]","Body":"Bump version number to 4.4.0\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1629127 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Fri Oct 03 09:30:30 CEST 2014"},{"Commit-ID":"commit 334f75ea5516158a9cb544be7ee678c3945ec0a9 1413276430 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Oct 14 08:47:10 2014 +0000]","Body":"Update README to reflect bookkeeper modules\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1631681 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Oct 14 10:47:10 CEST 2014"},{"Commit-ID":"commit ea03266f5c5af20281de7bd147faeb9bc715065f 1413276560 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Oct 14 08:49:20 2014 +0000]","Body":"Add JNA license in NOTICE files\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1631683 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Tue Oct 14 10:49:20 CEST 2014"},{"Commit-ID":"commit 3020fcb555d978c986e4e014e79c14d9817b606a 1413350821 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Oct 15 05:27:01 2014 +0000]","Body":"BOOKKEEPER-793: Move to java 7\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1631943 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Oct 15 07:27:01 CEST 2014"},{"Commit-ID":"commit b17a30a46a820a9914bcee713f156698d93ff734 1416416411 -----sp","Author":"PersonIdent[Ivan Brendan Kelly, ivank@apache.org, Wed Nov 19 17:00:11 2014 +0000]","Body":"BOOKKEEPER-797: IllegalArgumentException when calling CodahaleOpStatsLogger#toOpStatsData()\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1640597 13f79535-47bb-0310-9956-ffa450edef68\n","Date":"Wed Nov 19 18:00:11 CET 2014"},{"Commit-ID":"commit 6a94e45c6b813978d6b4fa98eeb87175d0241d96 1417692505 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Dec 4 12:28:25 2014 +0100]","Body":"BOOKKEEPER-815: Ledger fence state is lost when the ledger file is evicted (Charles Xie via ivank)\n\nChange-Id: I7de7a893043f1304b75d7545899ec5b022148e6b\n","Date":"Thu Dec 04 12:28:25 CET 2014"},{"Commit-ID":"commit 78d6e49d4d6bf83ee53655e6198848b896c4239c 1417785020 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Dec 5 14:10:20 2014 +0100]","Body":"BOOKKEEPER-800: Expose whether a ledger is closed or not (ivank)\n","Date":"Fri Dec 05 14:10:20 CET 2014"},{"Commit-ID":"commit 5de01f700ede31f186f5d8d97afac382f1e45327 1417798276 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Dec 5 17:51:16 2014 +0100]","Body":"BOOKKEEPER-799: Distribution schedule coverage sets don't take gaps in response lists into account when writequorum > ackquorum (ivank)\n","Date":"Fri Dec 05 17:51:16 CET 2014"},{"Commit-ID":"commit 130ebfa8f3763c1b98b29124a2bb648b2a810281 1417845259 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Dec 5 21:54:19 2014 -0800]","Body":"BOOKKEEPER-805: NullPointException in bookie server when using twitter-ostrich-provider (Youngjoon Kim via sijie)\n","Date":"Sat Dec 06 06:54:19 CET 2014"},{"Commit-ID":"commit 0dfb4fb94d0ccc98e1050f662712d85bcf2003b1 1417845919 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Dec 5 22:05:19 2014 -0800]","Body":"BOOKKEEPER-809: Wrong metric on LedgerDeleteOp and LedgerOpenOp (Charles Xie via sijie)\n","Date":"Sat Dec 06 07:05:19 CET 2014"},{"Commit-ID":"commit 8a5ac72762480f5f972aafcf1fc8207e12ef76e3 1417846349 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Dec 5 22:12:29 2014 -0800]","Body":"BOOKKEEPER-805: NullPointException in bookie server when using twitter-ostrich-provider (Youngjoon Kim via sijie) (missing CHANGES.txt)\n","Date":"Sat Dec 06 07:12:29 CET 2014"},{"Commit-ID":"commit ff5d2c5125d7d7fbe48d7935524820c55a887124 1417846399 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Dec 5 22:13:19 2014 -0800]","Body":"BOOKKEEPER-809: Wrong metric on LedgerDeleteOp and LedgerOpenOp (Charles Xie via sijie) (missing CHANGES.txt)\n","Date":"Sat Dec 06 07:13:19 CET 2014"},{"Commit-ID":"commit 492997b1e6fe73426dda799a6eaf228329a9342f 1417847179 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Dec 5 22:26:19 2014 -0800]","Body":"BOOKKEEPER-820: print out fi.isFenced() in BookieShell (zhaijia via sijie)\n","Date":"Sat Dec 06 07:26:19 CET 2014"},{"Commit-ID":"commit 2b88b11fa7597254ccbf828f16efc665e852788d 1417847924 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Dec 5 22:38:44 2014 -0800]","Body":"BOOKKEEPER-804: Client program is not terminated when using openLedgerNoRecovery (ivank via sijie)\n","Date":"Sat Dec 06 07:38:44 CET 2014"},{"Commit-ID":"commit e790cab6d89de3cff3ee32842347d0176b6e24c5 1417848453 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Dec 5 22:47:33 2014 -0800]","Body":"BOOKKEEPER-813: BookieShell doesn't find index directory (Charles Xie via sijie)\n","Date":"Sat Dec 06 07:47:33 CET 2014"},{"Commit-ID":"commit 92e502233d1489290fbcb448b932fdc4b569d431 1417848881 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Dec 5 22:54:41 2014 -0800]","Body":"BOOKKEEPER-810: Allow to configure TCP connect timeout (Charles Xie via sijie)\n","Date":"Sat Dec 06 07:54:41 CET 2014"},{"Commit-ID":"commit 24591f1514624e09a07ef2f34ba35116ea847266 1417849393 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Dec 5 23:03:13 2014 -0800]","Body":"BOOKKEEPER-811: Recovery tool doesn't remove cookie after recovering one bookie (Charles Xie via sijie)\n","Date":"Sat Dec 06 08:03:13 CET 2014"},{"Commit-ID":"commit e79f8736a7dfc2c7191455e4e88b85a85f0472bf 1418151463 -----sp","Author":"PersonIdent[Ivan Kelly, ivan@bleurgh.com, Tue Dec 9 19:57:43 2014 +0100]","Body":"BOOKKEEPER-795: Race condition causes writes to hang if ledger is fenced (sijie via ivank)\n","Date":"Tue Dec 09 19:57:43 CET 2014"},{"Commit-ID":"commit 0e3d95c9411289b89961e434ce760e3726290761 1418237004 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Dec 10 19:43:24 2014 +0100]","Body":"BOOKKEEPER-814: clean up temp files that generated by test cases. (zhaijia via ivank)\n","Date":"Wed Dec 10 19:43:24 CET 2014"},{"Commit-ID":"commit 91b80f6c8d538fd9c16b30907c95d93ee90af04a 1418382663 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Dec 12 12:09:02 2014 +0100]","Body":"BOOKKEEPER-801: Bookkeeper client tutorial (ivank)\n","Date":"Fri Dec 12 12:09:02 CET 2014"},{"Commit-ID":"commit 264995cf2fc97ae527a8c24b369790a424d88d87 1418382872 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Dec 12 12:14:32 2014 +0100]","Body":"BOOKKEEPER-803: Guide for making a replicated log out of ledgers (ivank)\n","Date":"Fri Dec 12 12:14:32 CET 2014"},{"Commit-ID":"commit 4050e79654704ebc0224cc024980e297fdc56473 1421072335 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Jan 12 15:18:55 2015 +0100]","Body":"BOOKKEEPER-832: Allow starting bookie in ReadOnly mode (zhaijia via ivank)\n","Date":"Mon Jan 12 15:18:55 CET 2015"},{"Commit-ID":"commit 99b40326fed855906b709cbe1f562f45bda79e5d 1421150778 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Jan 13 13:06:18 2015 +0100]","Body":"BOOKKEEPER-634: Provide admin tool to rename bookie identifier in ledger metadata (rakeshr via ivank)\n","Date":"Tue Jan 13 13:06:18 CET 2015"},{"Commit-ID":"commit 0d6a65d3b14122f0c0a3a4e9d6a4fbe569165ec7 1421420223 -----sp","Author":"PersonIdent[fpj, fpj@apache.org, Fri Jan 16 14:57:03 2015 +0000]","Body":"BOOKKEEPER-827 change throttle in GarbageCollector to use either \"by entry\" or \"by byte\" (Jia Zhai via fpj)\n","Date":"Fri Jan 16 15:57:03 CET 2015"},{"Commit-ID":"commit afbab15ad6778f1010b726b7f765a47417fbbed0 1421701303 -----sp","Author":"PersonIdent[fpj, fpj@apache.org, Mon Jan 19 21:01:43 2015 +0000]","Body":"BOOKKEEPER-830: Documentation has no structure (ivank via fpj)\n","Date":"Mon Jan 19 22:01:43 CET 2015"},{"Commit-ID":"commit 8b23bd30c5e7388e91f650615671d754a9ee2727 1424675491 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Feb 22 23:11:31 2015 -0800]","Body":"BOOKKEEPER-838: ForceWriteThread::run() leaks \u201clogFile.close()\u201d when interrupt comes (zhaijia via sijie)\n","Date":"Mon Feb 23 08:11:31 CET 2015"},{"Commit-ID":"commit e89ee080f1894143ed3415f27017b89eefe3ceb1 1426144889 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Mar 12 00:21:29 2015 -0700]","Body":"BOOKKEEPER-839: AuditorPeriodicCheckTest timeout (rakeshr via sijie)\n","Date":"Thu Mar 12 08:21:29 CET 2015"},{"Commit-ID":"commit 0c7dfc077b413d4019b68133cb7461832eae3541 1426145840 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Mar 12 00:37:20 2015 -0700]","Body":"BOOKKEEPER-837: UpdateLedgerOp - Replace AbstractFuture with SettableFuture (rakeshr via sijie)\n","Date":"Thu Mar 12 08:37:20 CET 2015"},{"Commit-ID":"commit f2928dca4860b3c1461b99b834992e16901c8a87 1426147002 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Mar 12 00:56:42 2015 -0700]","Body":"BOOKKEEPER-831: Outdated links in tutorial (ivank via sijie)\n","Date":"Thu Mar 12 08:56:42 CET 2015"},{"Commit-ID":"commit 68c5b5a40c33b813482e8a2371eedcb2e0d224e8 1426656217 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Mar 17 22:23:37 2015 -0700]","Body":"BOOKKEEPER-840: Deadlock on flushLock on compaction (sijie)\n","Date":"Wed Mar 18 06:23:37 CET 2015"},{"Commit-ID":"commit 4a4802ab5ef1a98eb40cd2bfb4b2f76409745220 1426659490 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Mar 17 23:18:10 2015 -0700]","Body":"BOOKKEEPER-828: Script for updating docs on website from master branch (ivank via sijie)\n","Date":"Wed Mar 18 07:18:10 CET 2015"},{"Commit-ID":"commit 7177f2a03c52ca0457ea7d1a9c946f194ffb1c5f 1426660292 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Mar 17 23:31:32 2015 -0700]","Body":"BOOKKEEPER-834: test case error in test class TestDiskChecker (zhaijia via sijie)\n","Date":"Wed Mar 18 07:31:32 CET 2015"},{"Commit-ID":"commit c181ea8aa409ed17f28e5b901ae33adc0faaf4be 1426660704 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Mar 17 23:38:24 2015 -0700]","Body":"BOOKKEEPER-844: Add more metrics about latency and bytes characteristics on bookie operations (Tong Yu via sijie)\n","Date":"Wed Mar 18 07:38:24 CET 2015"},{"Commit-ID":"commit 638b332569a0ce4c502cc4d15be535a67d464f9d 1426660862 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Mar 17 23:41:02 2015 -0700]","Body":"BOOKKEEPER-844: Add more metrics about latency and bytes characteristics on bookie operations (Tong Yu via sijie) (missing file)\n","Date":"Wed Mar 18 07:41:02 CET 2015"},{"Commit-ID":"commit 6622b46d4979c92cd9c3f450e3832d63513c6a22 1429600665 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Apr 21 00:17:45 2015 -0700]","Body":"BOOKKEEPER-849: Collect stats with sub-milliseconds precision (Matteo Merli via sijie)\n","Date":"Tue Apr 21 09:17:45 CEST 2015"},{"Commit-ID":"commit fe6259c7eade644c8d2a5e96aba61c1792d64843 1429601028 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Apr 21 00:23:48 2015 -0700]","Body":"BOOKKEEPER-850: Use nanoseconds to calculate poll timeout when doing group commit (Matteo Merli via sijie)\n","Date":"Tue Apr 21 09:23:48 CEST 2015"},{"Commit-ID":"commit b24cd7fd85bb3235036e660ff3a295dc939705e6 1429601722 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Apr 21 00:35:22 2015 -0700]","Body":"BOOKKEEPER-847: ArrayIndexOutOfBoundsException in LedgerFragmentReplicator::updateEnsembleInfo (zhaijia via sijie)\n","Date":"Tue Apr 21 09:35:22 CEST 2015"},{"Commit-ID":"commit 70da24d504e3f4cba0d87a0914a0add7ea19394d 1429601971 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Apr 21 00:39:31 2015 -0700]","Body":"BOOKKEEPER-848: Use volatile for lastAddConfirmed (Matteo Merli via sijie)\n","Date":"Tue Apr 21 09:39:31 CEST 2015"},{"Commit-ID":"commit b6dd505342051f267ca6af5fba1b70637c1e3fe0 1429602292 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Apr 21 00:44:52 2015 -0700]","Body":"BOOKKEEPER-695: Some entry logs are not removed from the bookie storage (Matteo Merli via sijie)\n","Date":"Tue Apr 21 09:44:52 CEST 2015"},{"Commit-ID":"commit e0d331781ec7a0e415bc6f16c38686aab34cb0c5 1429602903 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Apr 21 00:55:03 2015 -0700]","Body":"BOOKKEEPER-836: disable compaction when disk becomes full, otherwise compaction will fill up disk quickly (zhaijia via sijie)\n","Date":"Tue Apr 21 09:55:03 CEST 2015"},{"Commit-ID":"commit da1a2fa6b19ddcdba68834147bf6afbe5bf90cbf 1429603358 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Apr 21 01:02:38 2015 -0700]","Body":"BOOKKEEPER-833: EntryLogId and EntryLogLimit should not be larger than Integer.MAX_VALUE (sijie)\n","Date":"Tue Apr 21 10:02:38 CEST 2015"},{"Commit-ID":"commit 26b17cba50aded931afb2e66d549fbeb8f4f1d39 1429604364 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Apr 21 01:19:24 2015 -0700]","Body":"BOOKKEEPER-846: TestLedgerChecker times out (rakeshr via sijie)\n","Date":"Tue Apr 21 10:19:24 CEST 2015"},{"Commit-ID":"commit 6688d96b52072496202f607f8c55976472f4c9a6 1432020974 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue May 19 00:36:14 2015 -0700]","Body":"BOOKKEEPER-835: Update copyright for 2015 on all active branches\n","Date":"Tue May 19 09:36:14 CEST 2015"},{"Commit-ID":"commit 5bd2edbf82bd0c8bd9ea9e507b07d23cb856f934 1432021343 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue May 19 00:42:23 2015 -0700]","Body":"BOOKKEEPER-835: Update copyright for 2015 on all active branches (sijie) (missing CHANGES.txt file)\n","Date":"Tue May 19 09:42:23 CEST 2015"},{"Commit-ID":"commit 1387b2be44686abfe78bf4efee4ad52d2d699e12 1432095345 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue May 19 21:15:45 2015 -0700]","Body":"BOOKKEEPER-854: NPE on InterleavedLedgerStorage.onRotateEntryLog (sijie)\n","Date":"Wed May 20 06:15:45 CEST 2015"},{"Commit-ID":"commit 6286c39eaa8f7422323fc3405c72f9c6333f444f 1432102804 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue May 19 23:20:04 2015 -0700]","Body":"BOOKKEEPER-821: Failing to write lastId to ledger directories should not fail startup of bookies (zhaijia via sijie)\n","Date":"Wed May 20 08:20:04 CEST 2015"},{"Commit-ID":"commit 35fbcc357970f126b6b9f9a7bf2a453bd3786044 1433224926 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jun 1 23:02:06 2015 -0700]","Body":"BOOKKEEPER-858: Fix broken links and typos in bookkeeper documents (Youngjoon Kim via sijie)\n","Date":"Tue Jun 02 08:02:06 CEST 2015"},{"Commit-ID":"commit 8df7e0fb18547e9805238f4bb15d3d0d67978422 1436250266 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jul 6 23:24:26 2015 -0700]","Body":"BOOKKEEPER-823: Clean up temp files created by hedwig tests (Jia Zhai via sijie)\n","Date":"Tue Jul 07 08:24:26 CEST 2015"},{"Commit-ID":"commit a80bba272ecd7344ac552f3888ef5db49cbbdeb5 1436561339 -----sp","Author":"PersonIdent[fpj, fpj@apache.org, Fri Jul 10 21:48:59 2015 +0100]","Body":"BOOKKEEPER-796: Make bookkeeper client use reconnectable zookeeper wrapper (sijie via fpj)\n","Date":"Fri Jul 10 22:48:59 CEST 2015"},{"Commit-ID":"commit 8c1b9ebc22988aabb42ba9cfe79be8898fc5a69e 1437028126 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jul 15 23:28:46 2015 -0700]","Body":"BOOKKEEPER-687: Use static final Logger for hedwig related modules (Ankur Garg via sijie)\n","Date":"Thu Jul 16 08:28:46 CEST 2015"},{"Commit-ID":"commit 8bf97fb5ba115b1d053bbc9a779335455e6926c5 1438083870 -----sp","Author":"PersonIdent[fpj, fpj@apache.org, Tue Jul 28 12:44:30 2015 +0100]","Body":"BOOKKEEPER-760: Don't close PCBC proactively if bookies disappeared from zookeeper znodes (sijie via fpj)\n","Date":"Tue Jul 28 13:44:30 CEST 2015"},{"Commit-ID":"commit c29a4f2601f72f8543cc4b1db419c84b01de75ce 1439344852 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Aug 11 19:00:52 2015 -0700]","Body":"BOOKKEEPER-863: Potential resource leak with unclosed LedgerManager in BookieShell (Ted Yu via sijie)\n","Date":"Wed Aug 12 04:00:52 CEST 2015"},{"Commit-ID":"commit a59bd5687e2f5c4a4ac3f2a957543b5a1a3148d8 1441641506 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Sep 7 08:58:26 2015 -0700]","Body":"BOOKKEEPER-802: Bookkeeper protocol documentation (ivank via sijie)\n","Date":"Mon Sep 07 17:58:26 CEST 2015"},{"Commit-ID":"commit 5662416d8ecef535fb089baa0a10e0dae08ae805 1442306306 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Sep 15 01:38:26 2015 -0700]","Body":"BOOKKEEPER-438: Move ledger id generation out of LedgerManager (Tong Yu via sijie)\n","Date":"Tue Sep 15 10:38:26 CEST 2015"},{"Commit-ID":"commit 6cfecea6c3e2b6e327fb53ac85f1894df81a10b2 1444118718 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Oct 6 01:05:18 2015 -0700]","Body":"BOOKKEEPER-862: Add tracing and stats to OrderedSafeExecutor for debugging slow tasks (Leigh Stewart via sijie)\n","Date":"Tue Oct 06 10:05:18 CEST 2015"},{"Commit-ID":"commit 48ab23ef3e16f8edfda2a977f9c0fc99c441db40 1444121326 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Oct 6 01:48:46 2015 -0700]","Body":"BOOKKEEPER-868: Add ADD_ENTRY quorum timeout (Leigh Stewart via sijie)\n","Date":"Tue Oct 06 10:48:46 CEST 2015"},{"Commit-ID":"commit 885cebf113ea104dc579f93d6e112825a3bf1959 1444122735 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Oct 6 02:12:15 2015 -0700]","Body":"BOOKKEEPER-826: PendingAddOp is ignoring ack response after meet ack quorum constraint (sijie)\n","Date":"Tue Oct 06 11:12:15 CEST 2015"},{"Commit-ID":"commit 9803ee8e6293dcd0346b1ca3cb0f2666b5e12382 1444495091 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Oct 10 09:38:11 2015 -0700]","Body":"BOOKKEEPER-872: Resource leak with unclosed LedgerManager in HierarchicalLedgerManagerFactory#format() (Ted Yu via sijie)\n","Date":"Sat Oct 10 18:38:11 CEST 2015"},{"Commit-ID":"commit 8a3922e00d5fc3f82cb28ca032595b02db1a516e 1444971657 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Oct 15 22:00:57 2015 -0700]","Body":"BOOKKEEPER-866: Fix compile issue when Updating junit to latest release version( 4.12) in the test of  Bookkeeper-server. (Jia Zhai via sijie)\n","Date":"Fri Oct 16 07:00:57 CEST 2015"},{"Commit-ID":"commit 355ddbc7c13e39c49a58371d467e87aa80f696d7 1445498556 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Oct 22 00:22:36 2015 -0700]","Body":"BOOKKEEPER-867: New Client API to allow applications pass-in EntryId. (Venkateswararao Jujjuri via sijie)\n","Date":"Thu Oct 22 09:22:36 CEST 2015"},{"Commit-ID":"commit e47fb5703d1a26db238dd20aa58bc580830dd5af 1445498654 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Oct 22 00:24:14 2015 -0700]","Body":"BOOKKEEPER-867: New Client API to allow applications pass-in EntryId. (Venkateswararao Jujjuri via sijie) (missing CHANGES.txt)\n","Date":"Thu Oct 22 09:24:14 CEST 2015"},{"Commit-ID":"commit e42efa9a84d554c8c0cdc9faf39d5efb85fe01f0 1453439942 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jan 21 21:19:02 2016 -0800]","Body":"BOOKKEEPER-877: Script for generating patch for reviews (sijie)\n","Date":"Fri Jan 22 06:19:02 CET 2016"},{"Commit-ID":"commit 19160e44d3d6814127e35f9a2c1062bcae57213f 1453657190 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Jan 24 09:39:50 2016 -0800]","Body":"BOOKKEEPER-885: Script to merge github pull request (sijie via mmerli)\n\nUtility for creating well-formed pull request merges and pushing them to Apache. A modified version based on Spark project (https://github.com/apache/spark/blob/master/dev/merge_spark_pr.py)\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nCloses #4 from sijie/sijie/BOOKKEEPER-885\n","Date":"Sun Jan 24 18:39:50 CET 2016"},{"Commit-ID":"commit 92722ee9c34b069e23d1a87d7fc78256b8540268 1453842664 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jan 26 13:11:04 2016 -0800]","Body":"BOOKKEEPER-855: handle session expire event in bookie (sijie)\n\nThis change is to retry bookie registration when zookeeper session expired.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Matteo Merli <mmerli@apache.org>\n\nCloses #1 from sijie/sijie/BOOKKEEPER-855\n","Date":"Tue Jan 26 22:11:04 CET 2016"},{"Commit-ID":"commit 8729d12be50295086e7440dfa5d0256abb7688d5 1455001923 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Feb 8 23:12:03 2016 -0800]","Body":"BOOKKEEPER-883: Test timeout in bookkeeper-benchmark\n\nProblem:\n\nThe BenchReadThroughputLatency is tight with FlatLedgerManager. so lots of assumptions are made based on how the znodes are changed when ledgers are created. There was a change introduced LedgerIdGenerator, which broke the assumptions that made by BenchReadThroughputLatency.\n\nFix:\n\n- Use a hashset to cache processed ledgers on reacting on children changes\n- Remove unpredictable test on next ledger\n- Fix an error logging on FlatLedgerManager processing ledgers\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nCloses #10 from sijie/BOOKKEEPER-883\n","Date":"Tue Feb 09 08:12:03 CET 2016"},{"Commit-ID":"commit 626b7e8bb0b84271df97cfbf0a1b157c6cfe5a18 1455002614 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon Feb 8 23:23:34 2016 -0800]","Body":"BOOKKEEPER-890: Concurrent modification exception when removing listener in\u2026\n\n\u2026 Bookkeeper ZK ledger manager\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #9 from merlimat/bk-890-concurrent-modification\n","Date":"Tue Feb 09 08:23:34 CET 2016"},{"Commit-ID":"commit 61390322ea591bcfe3186e289c27f331c86941ad 1455002889 -----sp","Author":"PersonIdent[Siddharth Boobna, sboobna@yahoo-inc.com, Mon Feb 8 23:28:09 2016 -0800]","Body":"BOOKKEEPER-892: Bookie sanity test\n\nAuthor: Siddharth Boobna <sboobna@yahoo-inc.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #13 from sid825/BOOKKEEPER-892\n","Date":"Tue Feb 09 08:28:09 CET 2016"},{"Commit-ID":"commit 63a2a91eba191e92a1902cf5400325dcf4d36089 1455003029 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@yahoo-inc.com, Mon Feb 8 23:30:29 2016 -0800]","Body":"BOOKKEEPER-888: Dispatch individual callbacks from journal in different threads\n\nCurrently the journal is sending all the responses from a single thread, after the entries in a batch are synced. Since a thread pool has been configured, it is better to spread the send-response tasks to all the available threads.\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #8 from merlimat/bk-888\n","Date":"Tue Feb 09 08:30:29 CET 2016"},{"Commit-ID":"commit d96a2db912278e3d88ed59d8d3e15b62bc37ffd4 1455003148 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@yahoo-inc.com, Mon Feb 8 23:32:28 2016 -0800]","Body":"BOOKKEEPER-886: Allow to disable ledgers operation throttling\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #7 from merlimat/bk-886-disable-throttling\n","Date":"Tue Feb 09 08:32:28 CET 2016"},{"Commit-ID":"commit 63395a3e3d9bb253ea2745042631e44a3d195ea0 1455003423 -----sp","Author":"PersonIdent[Siddharth Boobna, sboobna@yahoo-inc.com, Mon Feb 8 23:37:03 2016 -0800]","Body":"BOOKKEEPER-893: explicitly call bk shutdown to set the exit code\n\nAuthor: Siddharth Boobna <sboobna@yahoo-inc.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #14 from sid825/BOOKKEEPER-893\n","Date":"Tue Feb 09 08:37:03 CET 2016"},{"Commit-ID":"commit 9c937f5d814d4079b6134db361a0e2de1e37cd05 1455003590 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon Feb 8 23:39:50 2016 -0800]","Body":"BOOKKEEPER-891: Read entries failure should trigger callback only once\n\nWhen reading multiple entries with `LedgerHandle.asyncReadEntries()`, in case there is a read error, the callback is currently being invoked for each of the requested entries.\nSince a single \"success\" callback is expected, we should also have a single \"failure\" callback invocation.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #12 from merlimat/bk-891-read-callbacks\n","Date":"Tue Feb 09 08:39:50 CET 2016"},{"Commit-ID":"commit bac3ed3603f9dc9864beb610bea215c186ef4fab 1456251366 -----sp","Author":"PersonIdent[eolivelli, eolivelli@gmail.com, Tue Feb 23 10:16:06 2016 -0800]","Body":"BOOKKEEPER-879: Record ledger creation time\n\nAuthor: eolivelli <eolivelli@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Flavio Junqueira <fpj@apache.org>\n\nCloses #2 from eolivelli/master and squashes the following commits:\n\n509ad4f [eolivelli] BOOKKEEPER-879: Record ledger creation time\n227d50c [eolivelli] BOOKKEEPER-879: Record ledger creation time\n94cdee6 [eolivelli] BOOKKEEPER-879: Record ledger creation time\n2a8e700 [eolivelli] BOOKKEEPER-879: Record ledger creation time\nc43f0b4 [eolivelli] BOOKKEEPER-879: Record ledger creation time\ne33f2e0 [eolivelli] BOOKKEEPER-879: Record ledger creation time\n","Date":"Tue Feb 23 19:16:06 CET 2016"},{"Commit-ID":"commit 9bd9e061bc225f36d8c9d516d4265aa209e4e90e 1456270470 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Feb 23 15:34:30 2016 -0800]","Body":"BOOKKEEPER-897: Fix findbugs warnings and missing apache license header\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nCloses #15 from sijie/sijie/BOOKKEEPER-897\n","Date":"Wed Feb 24 00:34:30 CET 2016"},{"Commit-ID":"commit 2c567d008c644df5db8c441fb9aaf135ed36db95 1456271071 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Feb 23 15:44:31 2016 -0800]","Body":"BOOKKEEPER-841: Bookie should calculate ledgers map writing a new entry log file\n\nsijie I've addressed all comments from https://reviews.apache.org/r/33061\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #5 from merlimat/bk-841\n","Date":"Wed Feb 24 00:44:31 CET 2016"},{"Commit-ID":"commit 96adbf1d613a63602c8b1b4aad1b0a7d17e6eee3 1457416192 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon Mar 7 21:49:52 2016 -0800]","Body":"BOOKKEEPER-851: Configurable LedgerStorage implementation\n\nsijie Addressed almost all comments from https://reviews.apache.org/r/33096\n\nOnly point still open is how to treat the `SortedLedgerStorage` and the flag `sortedLedgerStorageEnabled=true` in the config file\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #6 from merlimat/bk-851-configurable-ledger-storage\n","Date":"Tue Mar 08 06:49:52 CET 2016"},{"Commit-ID":"commit c8255f8c5f73a2353293ec1d9612dbb98f291ccc 1457417200 -----sp","Author":"PersonIdent[Siddharth Boobna, sboobna@yahoo-inc.com, Mon Mar 7 22:06:40 2016 -0800]","Body":"BookKeeper client should try not to use bookies with errors/timeouts when forming a new ensemble\n\n\u2026hen forming ensembles\n\nAuthor: Siddharth Boobna <sboobna@yahoo-inc.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #11 from sboobna/BOOKKEEPER-889\n","Date":"Tue Mar 08 07:06:40 CET 2016"},{"Commit-ID":"commit bfa74f736ba270cc1a0bd0f7a1a6c643a00e385d 1457417650 -----sp","Author":"PersonIdent[Siddharth Boobna, sboobna@yahoo-inc.com, Mon Mar 7 22:14:10 2016 -0800]","Body":"Bookie should return to read-write mode once the disk usage drops before the threshold\n\n\u2026o read only mode\n\nAuthor: Siddharth Boobna <sboobna@yahoo-inc.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #18 from sboobna/BOOKKEEPER-899\n","Date":"Tue Mar 08 07:14:10 CET 2016"},{"Commit-ID":"commit fe52b500cfec1c93725fa967ad2d5e0e7350580c 1457417763 -----sp","Author":"PersonIdent[Siddharth Boobna, sboobna@yahoo-inc.com, Mon Mar 7 22:16:03 2016 -0800]","Body":"read only bookie runs replicator and does not release the under replicated lock after failing\n\n\u2026 only bookie\n\nAuthor: Siddharth Boobna <sboobna@yahoo-inc.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #17 from sboobna/BOOKKEEPER-900\n","Date":"Tue Mar 08 07:16:03 CET 2016"},{"Commit-ID":"commit a77042db1b024b5cb2bdd2a5f49ea18a43bc036b 1457417892 -----sp","Author":"PersonIdent[Siddharth Boobna, sboobna@yahoo-inc.com, Mon Mar 7 22:18:12 2016 -0800]","Body":"BOOKKEEPER-898: listen to read only bookie changes also in auditor\n\nAuthor: Siddharth Boobna <sboobna@yahoo-inc.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #19 from sboobna/BOOKKEEPER-898\n","Date":"Tue Mar 08 07:18:12 CET 2016"},{"Commit-ID":"commit 410ff7263a477d4b75a43d006adde3549225a4b9 1457933955 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sun Mar 13 22:39:15 2016 -0700]","Body":"BOOKKEEPER-902: Test failures in EntryLogTest\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #22 from merlimat/bk-902\n","Date":"Mon Mar 14 06:39:15 CET 2016"},{"Commit-ID":"commit 9a8d62b1d1231f2fe6feca7e0c407a426a1278d5 1458099834 -----sp","Author":"PersonIdent[Robin Dhamankar, robindh@apache.org, Tue Mar 15 20:43:54 2016 -0700]","Body":"BOOKKEEPER-769: Remove the Hedwig Code\n\n- Remove code directories for Hedwig code\n- Remove code directories under compat\n- Remove Hedwig related documentation\n- Remove references to Hedwig code in pom files\n\n* There is an unrelated findbugs violation in BookieWatcher which is not related to this change\n* There were flaky tests that failed locally but passed when I reran them\n\nAuthor: Robin Dhamankar <robindh@Robins-MacBook-Air.local>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #27 from robindh/RemoveHedwig\n","Date":"Wed Mar 16 04:43:54 CET 2016"},{"Commit-ID":"commit 1a98088e38ca0a43c26d9a4847619b0a27bb90e8 1458100260 -----sp","Author":"PersonIdent[Matteo Merli, matteo.merli@gmail.com, Tue Mar 15 20:51:00 2016 -0700]","Body":"BOOKKEEPER-594: AutoRecovery shutting down on SyncDisconnected\n\nAuthor: Matteo Merli <matteo.merli@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #26 from merlimat/bk-594\n","Date":"Wed Mar 16 04:51:00 CET 2016"},{"Commit-ID":"commit a13d75d7eae29f1ce42dbfe5c6b4878a822fdf91 1458101013 -----sp","Author":"PersonIdent[Siddharth Boobna, sboobna@yahoo-inc.com, Tue Mar 15 21:03:33 2016 -0700]","Body":"BOOKKEEPER-894: add command to read ledger entries form shell\n\nAuthor: Siddharth Boobna <sboobna@yahoo-inc.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #24 from sboobna/BOOKKEEPER-894\n","Date":"Wed Mar 16 05:03:33 CET 2016"},{"Commit-ID":"commit e32c38890ffbd0291e24e2b3f2625374b27f1f67 1459457610 -----sp","Author":"PersonIdent[Arun M. Krishnakumar, akrishnakumar@salesforce.com, Thu Mar 31 13:51:45 2016 -0700]","Body":"BOOKKEEPER-909: ZooKeeper of LocalBookkeeper should use the correct tickTime\n\nReviewers: Matteo Merli <mmerli@apache.org>\n","Date":"Thu Mar 31 22:51:45 CEST 2016"},{"Commit-ID":"commit b1c12c0f41b7c27b2452fef311f12077d771f431 1459838751 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@yahoo-inc.com, Mon Apr 4 23:45:51 2016 -0700]","Body":"BOOKKEEPER-901: Authentication framework\n\nAuthor: Ivan Kelly <ivank@yahoo-inc.com>\n\nReviewers: Sijie Guo<sijie@apache.org>\n\nCloses #23 from merlimat/authentication-framework and squashes the following commits:\n\naa01548 [Ivan Kelly] BOOKKEEPER-901: Add an authentication framework\nf930fbd [Ivan Kelly] BOOKKEEPER-794 BookkeeperProtocol.Response.status is completely ignored\n","Date":"Tue Apr 05 08:45:51 CEST 2016"},{"Commit-ID":"commit d607b366ba493617408888a768a99ee3f3ffb976 1459839037 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon Apr 4 23:50:37 2016 -0700]","Body":"BOOKKEEPER-578: LedgerCacheImpl is reserving 1/3 of Heap size but allocates NonHeap memory\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #28 from merlimat/bk-578\n","Date":"Tue Apr 05 08:50:37 CEST 2016"},{"Commit-ID":"commit e5939ed587d81212fb032a37b2b83401359fa7fc 1459874827 -----sp","Author":"PersonIdent[eolivelli, eolivelli@gmail.com, Tue Apr 5 09:47:07 2016 -0700]","Body":"BOOKKEEPER-896: VM-local transport\n\nAuthor: eolivelli <eolivelli@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Matteo Merli <mmerli@apache.org>\n\nCloses #21 from eolivelli/BOOKKEEPER-896\n","Date":"Tue Apr 05 18:47:07 CEST 2016"},{"Commit-ID":"commit 19a5efe21ca0b33156a405f1084ddaa9ba4b28f5 1459886022 -----sp","Author":"PersonIdent[Arun M. Krishnakumar, akrishnakumar@salesforce.com, Tue Apr 5 12:52:16 2016 -0700]","Body":"BOOKKEEPER-910: In LocalBookkeeper, Zookeeper server and client use different host addresses\n\nAuthor: Arun M. Krishnakumar <akrishnakumar@salesforce.com>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n","Date":"Tue Apr 05 21:52:16 CEST 2016"},{"Commit-ID":"commit 3fe7e7dad1a1a5a1ac958ef245f244d36523c0ea 1459960695 -----sp","Author":"PersonIdent[eolivelli, eolivelli@gmail.com, Wed Apr 6 09:38:15 2016 -0700]","Body":"BOOKKEEPER-904: BookieInitializationTest.testDuplicateBookieServerStartup fails on non-english machines\n\nAuthor: eolivelli <eolivelli@gmail.com>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nCloses #30 from eolivelli/master\n","Date":"Wed Apr 06 18:38:15 CEST 2016"},{"Commit-ID":"commit 3efde26e0510be38237c73a7bfeeb105f25d8dbe 1460057986 -----sp","Author":"PersonIdent[Andrey Yegorov, ayegorov@salesforce.com, Thu Apr 7 12:39:46 2016 -0700]","Body":"BOOKKEEPER-914: ReadOnlyBookieTest.testBookieShouldTurnWritableFromReadOnly is intermettently failing\n\nBOOKKEEPER-914 fixed testBookieShouldTurnWritableFromReadOnly flapping.\nNow test waits for bookie to transition to read-only.\n\nAuthor: Andrey Yegorov <ayegorov@salesforce.com>\n\nReviewers: Matteo Merli <mmerli@apache.org>, Sijie Guo <sijie@apache.org>\n\nCloses #32 from dlg99/bugfix/BOOKKEEPER-914\n","Date":"Thu Apr 07 21:39:46 CEST 2016"},{"Commit-ID":"commit 89b032a1b59bebaf1bd48a95c0eb0f3e0caa2519 1460137389 -----sp","Author":"PersonIdent[eolivelli, eolivelli@gmail.com, Fri Apr 8 10:43:09 2016 -0700]","Body":"BOOKKEEPER-880: Make LedgerHandle implement AutoCloseable\n\nAuthor: eolivelli <eolivelli@gmail.com>\n\nReviewers: Matteo Merli <mmerli@apache.org>, Rakesh R <rakeshr.radhakrishnan.potty@intel.com>\n\nCloses #33 from eolivelli/BOOKKEEPER-880\n","Date":"Fri Apr 08 19:43:09 CEST 2016"},{"Commit-ID":"commit f2bc62b85e9bb855416fa4ea424cfd19ae9944e5 1460258398 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sat Apr 9 20:19:58 2016 -0700]","Body":"BOOKKEEPER-913: Fix flakiness in TestBackwardCompat\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #31 from merlimat/bk-913\n","Date":"Sun Apr 10 05:19:58 CEST 2016"},{"Commit-ID":"commit b42d8db2b03079ce65d603d808442297ad759433 1460260720 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sat Apr 9 20:58:40 2016 -0700]","Body":"BOOKKEEPER-917: LocalBookKeeperTest seems to be silently failing\n\nFixing the `AuthHandler` to use localhost address when passed a `LocalChannel`\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #34 from merlimat/bk-917\n","Date":"Sun Apr 10 05:58:40 CEST 2016"},{"Commit-ID":"commit 10cab08d0a8b4ca4b182554dee95834dc42175d2 1460587904 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Apr 13 15:51:44 2016 -0700]","Body":"BOOKKEEPER-870: Change the default value for bookie settings.\n\n- ENTRY_LOG_SIZE_LIMIT to 1GB\n- increase GC_WAIT_TIME to 10 minutes, since 1 second isn't good for a real production environment\n- FLUSH_INTERVAL to 10 second. lowering this value won't help since the actual checkpoint only happened on entry log file rolling\n- OPEN_FILE_LIMIT to 20000.\n- JOURNAL_MAX_GROUP_WAIT_MSEC to 2 ms. make the default value for low latency\n- READ_ONLY_MODE_ENABLED to true. enable readonly mode by default.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nCloses #35 from sijie/sijie/BOOKKEEPER-870\n","Date":"Thu Apr 14 00:51:44 CEST 2016"},{"Commit-ID":"commit 91595fc04ac6168b5a652e803e55caadae757f74 1461740434 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Apr 27 00:00:34 2016 -0700]","Body":"BOOKKEEPER-911: Fix TestReplicationWorker tests in master\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>, Flavio Junqueira <fpj@apache.org>\n\nCloses #29 from merlimat/bk-911\n","Date":"Wed Apr 27 09:00:34 CEST 2016"},{"Commit-ID":"commit d66b9f0b4d27eae59fb9d6e607f24b2e8a0e611a 1461740828 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Apr 27 00:07:08 2016 -0700]","Body":"BOOKKEEPER-920: Extend bk-merge-pr.py to add more info to Jira ticket\u2026\n\n\u2026 when merging\n\nAuthor: user.email <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #36 from merlimat/bk-920\n","Date":"Wed Apr 27 09:07:08 CEST 2016"},{"Commit-ID":"commit 40af841a366323d19fde2ae73d198824c16af688 1461742236 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Apr 27 00:30:36 2016 -0700]","Body":"Auditor is sometimes marking as failed a bookie switching from available to read-only mode\n\n\u2026hing from available to read-only mode\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Guo Sijie <sijie@apache.org>\n\nCloses #37 from merlimat/bk-919\n","Date":"Wed Apr 27 09:30:36 CEST 2016"},{"Commit-ID":"commit dd575a16decbeaab1f230db271bc400d7e434216 1461743719 -----sp","Author":"PersonIdent[Siddharth Boobna, sboobna@yahoo-inc.com, Wed Apr 27 00:55:19 2016 -0700]","Body":"BOOKKEEPER-895: GC ledgers that are no longer a part of the ensemble\n\nAuthor: Siddharth Boobna <sboobna@yahoo-inc.com>\n\nReviewers: Matteo Merli <mmerli@apache.org>, Guo Sijie <sijie@apache.org>\n\nCloses #25 from sboobna/BOOKKEEPER-895\n","Date":"Wed Apr 27 09:55:19 CEST 2016"},{"Commit-ID":"commit 696a1515bcd4ef41ef27944dad64ac3e1c9d4991 1461744323 -----sp","Author":"PersonIdent[Arun M. Krishnakumar, arunmk95@gmail.com, Wed Apr 27 01:05:23 2016 -0700]","Body":"BOOKKEEPER-921: Typo in LocalBookkeeper: Use InetAddress.getHostAddress instead of InetAddress\n","Date":"Wed Apr 27 10:05:23 CEST 2016"},{"Commit-ID":"commit 101de10a817d2a0704ce746eaed90cc0d73ca078 1461784287 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Apr 27 12:11:27 2016 -0700]","Body":"BOOKKEEPER-925: Fix FindBugs discovered issues in master\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Siddharth Boobna <siddharth.boobna@gmail.com>, Guo Sijie <sijie@apache.org>\n\nCloses #39 from merlimat/bk-925\n","Date":"Wed Apr 27 21:11:27 CEST 2016"},{"Commit-ID":"commit f8e0331f14a933ad2ed3d933c5eea927020b4967 1461899137 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Apr 28 20:05:37 2016 -0700]","Body":"BOOKKEEPER-925: Fix FindBugs discovered issues in master\n\nsijie Fixed the other findbugs error\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Guo Sijie <sijie@apache.org>\n\nCloses #40 from merlimat/bk-925\n","Date":"Fri Apr 29 05:05:37 CEST 2016"},{"Commit-ID":"commit d32010f5fcc6a040a56dc8b983cc14d107cff2df 1462370146 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed May 4 06:55:46 2016 -0700]","Body":"BOOKKEEPER-926: Compacted entries are not properly synced before updating index\n\n\u2026ting index\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Guo Sijie <sijie@apache.org>\n\nCloses #41 from merlimat/bk-926\n","Date":"Wed May 04 15:55:46 CEST 2016"},{"Commit-ID":"commit d1df2dbdc06666490867285812654ca8e91647a9 1462465311 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu May 5 07:06:45 2016 -0700]","Body":"Updated CHANGES.txt for release 4.4.0\n","Date":"Thu May 05 16:06:45 CEST 2016"},{"Commit-ID":"commit f36bb289c19f5528572b677d1529951ae4346a93 1462465329 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu May 5 09:21:18 2016 -0700]","Body":"Bump version to 4.5.0-SNAPSHOT\n","Date":"Thu May 05 18:21:18 CEST 2016"},{"Commit-ID":"commit 7e7fcf6618417a0846baae4b6ee84778571a3556 1462820768 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Mon May 9 12:06:08 2016 -0700]","Body":"Initial Check-in for distributedlog oss\n","Date":"Mon May 09 21:06:08 CEST 2016"},{"Commit-ID":"commit 5a71ed88116fcdffcccdb99eb79055912c46a85e 1462820768 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Mon May 9 12:06:08 2016 -0700]","Body":"Initial Check-in for distributedlog oss\n","Date":"Mon May 09 21:06:08 CEST 2016"},{"Commit-ID":"commit 089735246f6084e9f68085ab03999394c7158a72 1463105912 -----sp","Author":"PersonIdent[Dave Rusek, dave.rusek@gmail.com, Thu May 12 20:18:32 2016 -0600]","Body":"Fixes #14: remove concurrency from ConfigurationSubscription tests (#16)","Date":"Fri May 13 04:18:32 CEST 2016"},{"Commit-ID":"commit 5c768b0a3cf573a4ba71f8b6edc9f183fdce4f65 1464085234 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Tue May 24 03:20:34 2016 -0700]","Body":"Add documents on running distributedlog in distributed mode\n","Date":"Tue May 24 12:20:34 CEST 2016"},{"Commit-ID":"commit 88f134e018608a4cccfc8f374ea8168581d1b839 1464282504 -----sp","Author":"PersonIdent[Arvind Kandhare, arvind.kandhare@emc.com, Thu May 26 10:08:24 2016 -0700]","Body":"Added vagrant files to start 3 ZK nodes and 3 BK nodes with writeproxy\n","Date":"Thu May 26 19:08:24 CEST 2016"},{"Commit-ID":"commit bd2ebcd75f41552f37166616e05821f4f7752f26 1465427094 -----sp","Author":"PersonIdent[Rithin, rithin.shetty@salesforce.com, Wed Jun 8 16:04:54 2016 -0700]","Body":"BOOKKEEPER-881: Upgrade surefire plugin to 2.19.1\n\nUpgrade to using maven surefire plugin version 2.19.1\n\nAuthor: Rithin Shetty <rithingmail.com>\n\nAuthor: Rithin <rithin.shetty@salesforce.com>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nCloses #47 from rithin-shetty/surefire-upgrade\n","Date":"Thu Jun 09 01:04:54 CEST 2016"},{"Commit-ID":"commit 8ad9b2929dbddb5124b58c86feaca5fca73d9acf 1466732789 -----sp","Author":"PersonIdent[arvindkandhare, sweet.kandy@gmail.com, Thu Jun 23 18:46:29 2016 -0700]","Body":"Vagrant based solution to create multi-node deployment (#34)\n\n* Added vagrant files to start 3 ZK nodes and 3 BK nodes with writeproxy\r\n\r\n* Removed comments\r\n\r\n* Setting env vars for writeproxy\r\n\r\n* Got it working for proxy and normal writes\r\n\r\n* Fixing minor bugs\r\n\r\n* Updated with comments on the pull request\r\n\r\n* Creating a docker file which calls into the vagrant bookkeeper script\r\n\r\n* Updated to the public version of twitter bookkeeper\r\n","Date":"Fri Jun 24 03:46:29 CEST 2016"},{"Commit-ID":"commit bb31fd75bf4cf022001e9be25ea725477b0a5e16 1466780559 -----sp","Author":"PersonIdent[Kandhare, arvind.kandhare@emc.com, Fri Jun 24 08:02:39 2016 -0700]","Body":"Merge remote-tracking branch 'origin/master' into dockerize\n","Date":"Fri Jun 24 17:02:39 CEST 2016"},{"Commit-ID":"commit ab069c3628562a90357b989e50d626acfc608695 1468219266 -----sp","Author":"PersonIdent[Franck Cuny, fcuny@twitter.com, Sun Jul 10 23:41:06 2016 -0700]","Body":"Add executions for maven-assembly-plugin.\n\nAdd the executions steps to produce a single archive with all the jars,\nscripts and configuration files.\n\nAuthor: Franck Cuny <fcuny@twitter.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #42 from franckcuny/fcuny/maven-assembly\n","Date":"Mon Jul 11 08:41:06 CEST 2016"},{"Commit-ID":"commit 3196448632fd93b53964d58aaf070709d2bb050c 1468263255 -----sp","Author":"PersonIdent[Franck Cuny, franckcuny@gmail.com, Mon Jul 11 11:54:15 2016 -0700]","Body":"A few changes to the shell scripts to start bookies\n\nAuthor: Franck Cuny <franckcuny@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #43 from franckcuny/fcuny/scripts-start-server\n","Date":"Mon Jul 11 20:54:15 CEST 2016"},{"Commit-ID":"commit e5f3afa5ef84dbc466562664f1f8b0cd60779c02 1468270403 -----sp","Author":"PersonIdent[JV, vjujjuri@salesforce.com, Mon Jul 11 13:53:23 2016 -0700]","Body":"BOOKKEEPER-908: BKLedgerExistException creation is missing\n\nAdd missing case statement for Code.LedgerExistException\nin the crearte() function of BKException class\n\nSigned-off-by: Venkateswararao Jujjuri (JV) <vjujjurisalesforce.com>\n\nAuthor: JV <vjujjuri@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #44 from jvrao/bookkeeper-908\n","Date":"Mon Jul 11 22:53:23 CEST 2016"},{"Commit-ID":"commit 6d71b8292bc255e21f2dcf048be191650c01b4dc 1468270890 -----sp","Author":"PersonIdent[Rithin, rithin.shetty@salesforce.com, Mon Jul 11 14:01:30 2016 -0700]","Body":"BOOKKEEPER-922: CreaterId in ledger metadata\n\nIntroduces a generic Map<String, byte[]> customMetadata to be stored as part of ledger metadata on the metadata server(zk).\n\nAuthor: Rithin Shetty <rithingmail.com>\n\nAuthor: Rithin <rithin.shetty@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nCloses #46 from rithin-shetty/JIRA-922-ledgerCustomMetadata\n","Date":"Mon Jul 11 23:01:30 CEST 2016"},{"Commit-ID":"commit d5cea821c2201db77bd75a9bc48ff4bf9f483ce2 1468271194 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon Jul 11 14:06:34 2016 -0700]","Body":"BOOKKEEPER-932: Move to JDK 8\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #48 from merlimat/bk-932\n","Date":"Mon Jul 11 23:06:34 CEST 2016"},{"Commit-ID":"commit 2506c98f8cc474d538df84ca30d229fbe0470e29 1468275573 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jul 11 15:19:33 2016 -0700]","Body":"BOOKKEEPER-939: Fix typo of bookkeeper merge pr script\n\nThere is typo of bk-merge-pr.py script on merging pr without a jira id.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nCloses #53 from sijie/sijie/fix_merge_script\n","Date":"Tue Jul 12 00:19:33 CEST 2016"},{"Commit-ID":"commit 2f71beb5e4b06691d4fd6c2601b78632236b3533 1468530153 -----sp","Author":"PersonIdent[eolivelli, eolivelli@gmail.com, Thu Jul 14 14:02:33 2016 -0700]","Body":"BOOKKEEPER-940: Fix findbugs warnings after bumping to java 8\n\nAuthor: eolivelli <eolivelli@gmail.com>\n\nReviewers: Matteo Merli <mmerli@apache.org>, Sijie Guo <sijie@apache.org>\n\nCloses #55 from eolivelli/BOOKKEEPER-940\n","Date":"Thu Jul 14 23:02:33 CEST 2016"},{"Commit-ID":"commit 1f7e47005588eedd879d0b9d163b4f125c6a0d59 1469485354 -----sp","Author":"PersonIdent[JV, vjujjuri@salesforce.com, Mon Jul 25 15:22:34 2016 -0700]","Body":"BOOKKEEPER-927: LedgerHandleAdv to handle disabled ledgers operation \u2026\n\n\u2026throttling\n\nBOOKKEEPER-886 missed taking care of LedgerHandleAdv.\nThis takes care of that issue.\n\nSigned-off-by: Venkateswararao Jujjuri (JV) <vjujjurisalesforce.com>\n\nAuthor: JV <vjujjuri@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #45 from jvrao/bookkeeper-927\n","Date":"Tue Jul 26 00:22:34 CEST 2016"},{"Commit-ID":"commit 7f2b59a7e6fa115793ed71d8cc1ad1cb9da677be 1482886166 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Thu Jul 28 21:10:33 2016 -0700]","Body":"DL-101: Improve session expire handling on fetching log segments for readers\n\nThis change focuses on improving the session expire handling on fetching log segments for readers.\n\nThe log segment management in DL is now done by 3 parts.\n\n- a LogSegmentMetadataStore (one per namespace instance): it is used for fetching the log segments from log segment metadata store (ZooKeeper). it doesn't do any caching.\n- a LogSegmentMetadataCache (one per namespace instance): it is a guava cache based metadata cache. it maintains a mapping between log segment metadata path and the log segment metadata. it manages the cache for the log segments that will be accessed in this namespace instance. it doesn't manage the sequence of the log segments for streams.\n- a PerStreamLogSegmentCache for each BKLogHandler. the log segment cache is per stream. it maintains the sequence of the log segments.\n\nBKLogWriteHandler doesn't watch the log segment changes. It fetches minimal number of log segments when it is created and fetches the full list of log segments for truncations. New log segments will be added to the per stream log segment cache with log segment rolling.\n\nBKLogReadHandler watch the log segments changes and only notify when the list of log segments is changed. the session handling which is specific to the metadata store is hidden to the implementations of LogSegmentMetadataStore.\n\nThe change tries to cleanup bunch of unused methods in BKLog{Read,Write}Handler too.\n","Date":"Fri Jul 29 06:10:33 CEST 2016"},{"Commit-ID":"commit 037713709672b3b500f7375a1bd81c1649956e3f 1482886166 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Thu Jul 28 21:10:33 2016 -0700]","Body":"DL-101: Improve session expire handling on fetching log segments for readers\n\nThis change focuses on improving the session expire handling on fetching log segments for readers.\n\nThe log segment management in DL is now done by 3 parts.\n\n- a LogSegmentMetadataStore (one per namespace instance): it is used for fetching the log segments from log segment metadata store (ZooKeeper). it doesn't do any caching.\n- a LogSegmentMetadataCache (one per namespace instance): it is a guava cache based metadata cache. it maintains a mapping between log segment metadata path and the log segment metadata. it manages the cache for the log segments that will be accessed in this namespace instance. it doesn't manage the sequence of the log segments for streams.\n- a PerStreamLogSegmentCache for each BKLogHandler. the log segment cache is per stream. it maintains the sequence of the log segments.\n\nBKLogWriteHandler doesn't watch the log segment changes. It fetches minimal number of log segments when it is created and fetches the full list of log segments for truncations. New log segments will be added to the per stream log segment cache with log segment rolling.\n\nBKLogReadHandler watch the log segments changes and only notify when the list of log segments is changed. the session handling which is specific to the metadata store is hidden to the implementations of LogSegmentMetadataStore.\n\nThe change tries to cleanup bunch of unused methods in BKLog{Read,Write}Handler too.\n","Date":"Fri Jul 29 06:10:33 CEST 2016"},{"Commit-ID":"commit 2cdd371f8799f47a5d473eb429f72d95337ca607 1482886167 -----sp","Author":"PersonIdent[Leigh Stewart, lstewart@apache.org, Thu Jul 28 21:36:49 2016 -0700]","Body":"DL-102: Add routing service to write proxy server side\n\nthis change is to add getOwner rpc in write proxy. so we can change the client side to get owner from write proxy first for routing service. in this way, we can start experiementing any resource placement algorithms.\n","Date":"Fri Jul 29 06:36:49 CEST 2016"},{"Commit-ID":"commit fdee73641c1841448451bf34f859a78ac6bd9d08 1482886167 -----sp","Author":"PersonIdent[Leigh Stewart, lstewart@apache.org, Thu Jul 28 21:36:49 2016 -0700]","Body":"DL-102: Add routing service to write proxy server side\n\nthis change is to add getOwner rpc in write proxy. so we can change the client side to get owner from write proxy first for routing service. in this way, we can start experiementing any resource placement algorithms.\n","Date":"Fri Jul 29 06:36:49 CEST 2016"},{"Commit-ID":"commit 8324632b2983beba1528ab53a999340756c7f563 1469944408 -----sp","Author":"PersonIdent[eolivelli, eolivelli@gmail.com, Sat Jul 30 22:53:28 2016 -0700]","Body":"BOOKKEEPER-933: ClientConfiguration always inherits System properties\n\nAuthor: eolivelli <eolivelli@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #50 from eolivelli/BOOKKEEPER-933 and squashes the following commits:\n\n0bcae1e [eolivelli] BOOKKEEPER-933 ClientConfiguration always inherits System properties\nbeb68fb [eolivelli] BOOKKEEPER-933 ClientConfiguration always inherits System properties\n","Date":"Sun Jul 31 07:53:28 CEST 2016"},{"Commit-ID":"commit c43858b5095318b50f4c7f86fc33b0a9e454bee5 1469944588 -----sp","Author":"PersonIdent[Robin Dhamankar, robindh@Robins-MacBook-Air.local, Sat Jul 30 22:56:28 2016 -0700]","Body":"BOOKKEEPER-941: Feature Switches for controling client and server behavior\n\n- Introduce Features that are dynamic configuration options\n- Allow specifying Features as configuration parameters\n\nThis is a port of the feature switches following changes\nhttps://github.com/twitter/bookkeeper/commit/c2a092ab9b585f1d30d9e9b9dead0533efa49855\nhttps://github.com/twitter/bookkeeper/commit/f9762d126e311a6b129e6e169dc62c2a0bdb7b4a\n\nAuthor: Robin Dhamankar <robindh@Robins-MacBook-Air.local>\n\nReviewers: Matteo Merli <mmerli@apache.org>, Sijie Guo <sijie@apache.org>\n\nCloses #54 from robindh/FeatureSwitches\n","Date":"Sun Jul 31 07:56:28 CEST 2016"},{"Commit-ID":"commit bf0f60c84034c7d3a1b4f51ef686db5de2bf9f2c 1469951861 -----sp","Author":"PersonIdent[Yiming Zang, yzang@twitter.com, Sun Jul 31 00:57:41 2016 -0700]","Body":"DL-20: Validate bk read timeout in configuration\n\nDL-20: Ensure bkcReadTimeoutSeconds is larger than readLACLongPollTimeout\n\nAuthor: Yiming Zang <yzang@twitter.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #4 from yzang/yzang/validate_configuration\n","Date":"Sun Jul 31 09:57:41 CEST 2016"},{"Commit-ID":"commit 64f596f4563436b3e4cfe0f57714fc3012778b4c 1470031449 -----sp","Author":"PersonIdent[Andrey Yegorov, ayegorov@salesforce.com, Sun Jul 31 23:04:09 2016 -0700]","Body":"BOOKKEEPER-938 ledger digestType autodetection on open\n\nCurrently digestType verification in LedgerOpenOp seems to be treated as part of security logic.\nSince it is checked after password and error explicitly states that digestType mismatched,\nall that evil hacker has to do is to change digest type to another one. There are only two of them after all.\n\nhere is the scenario significantly affected by current behavior:\n\n1. user rolls out clients with digestType set to MAC and creates lots of ledgers.\n2. user notices that MAC is slower than CRC32 and decides to change digestType.\n3. more ledgers created with CRC32.\n4. user tries to read old and new ledgers\n-> now old ledgers cannot be read because of the digest type mismatch.\n\nAuthor: Andrey Yegorov <ayegorov@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #52 from dlg99/fix/BOOKKEEPER-938-digest-autodetect\n","Date":"Mon Aug 01 08:04:09 CEST 2016"},{"Commit-ID":"commit 9eabddb64a0b47d7c2c2096e571f5f2586f28d11 1482886167 -----sp","Author":"PersonIdent[Jordan Bull, jbull@twitter.com, Tue Aug 9 11:36:53 2016 -0700]","Body":"DL-104: BKClientReadTimeout can be equal to getReadLACLongPollTimeout so current config validates\n","Date":"Tue Aug 09 20:36:53 CEST 2016"},{"Commit-ID":"commit 1eb1b1e94407de828694c1caead6b865b7e28887 1482886167 -----sp","Author":"PersonIdent[Yiming Zang, yzang@twitter.com, Wed Aug 10 16:18:53 2016 -0700]","Body":"DL-105: Make compression stats available per stream\n","Date":"Thu Aug 11 01:18:53 CEST 2016"},{"Commit-ID":"commit b42a8c34511612bef539d30d7ade5f68234297af 1482886168 -----sp","Author":"PersonIdent[Yiming Zang, yzang@twitter.com, Fri Aug 12 10:30:39 2016 -0700]","Body":"DL-106: Use namespace after it is closed will throw AlreadyClosedException\n","Date":"Fri Aug 12 19:30:39 CEST 2016"},{"Commit-ID":"commit 28f23e80bc1f64a22b45c52166cd51d526eacb5b 1471369333 -----sp","Author":"PersonIdent[Andrey Yegorov, ayegorov@salesforce.com, Tue Aug 16 10:42:13 2016 -0700]","Body":"BOOKKEEPER-937: Upgrade protobuf to 2.6\n\nprotobuf/protoc 2.4 cannot be installed with brew on mac and building it on mac always result is build errors hence leaves an option of switching to linux to run protoc.\nI upgraded to 2.6 instead. It is compatible with 2.4 on the wire and shaded so should not create any problems. All tests passed.\nPlease ignore changes in java files in attached patch during review; these are auto-generated.\n\nprotobuf 2.4 in compat* dependencies is shaded now to not conflict with 2.6.\n\nAuthor: Andrey Yegorov <ayegorov@salesforce.com>\n\nReviewers: eolivelli@gmail.com <eolivelli@gmail.com>, zhaijia03@gmail.com <zhaijia03@gmail.com>, sijie@apache.org <sijie@apache.org>\n\nCloses #51 from dlg99/task/BOOKKEEPER-937\n","Date":"Tue Aug 16 19:42:13 CEST 2016"},{"Commit-ID":"commit b99cee8295439e10c88d4290abe21e422eff833d 1471374126 -----sp","Author":"PersonIdent[Yiming Zang, yzang@twitter.com, Tue Aug 16 12:02:06 2016 -0700]","Body":"DL-21: Fix DL flaky test cases\n\nDL-21: Fixed a few DL flaky test cases.\n\nAuthor: Yiming Zang <yzang@twitter.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #5 from yzang/yzang/fix_flaky_test\n","Date":"Tue Aug 16 21:02:06 CEST 2016"},{"Commit-ID":"commit 13a7381f50fea4b9300cd111fdd5b671954fbd7e 1482886168 -----sp","Author":"PersonIdent[Phillip Su, psu@twitter.com, Mon Aug 22 17:47:28 2016 -0700]","Body":"DL-107: Added unregistering gauges for distributedlog-core and distributedlog-benchmark\n","Date":"Tue Aug 23 02:47:28 CEST 2016"},{"Commit-ID":"commit 25af8e2950670648c04047e65ed67136c6a81ba7 1471914013 -----sp","Author":"PersonIdent[jiazhai, zhaijia03@gmail.com, Mon Aug 22 18:00:13 2016 -0700]","Body":"DL-1: Clean up the distributedlog pom files\n\n- changed the version to 0.4.0-incubating\n- changed names to include 'Apache DistributedLog' and use '::' as separator\n- add developers, mail lists and jira\n\nAuthor: jiazhai <zhaijia03@gmail.com>\n\nReviewers: Franck Cuny <franck.cuny@gmail.com>, Sijie Guo <sijie@apache.org>\n\nCloses #10 from jiazhai/zhaijia/fix_apache_version\n","Date":"Tue Aug 23 03:00:13 CEST 2016"},{"Commit-ID":"commit 55937e03ec9f9d9c9939af6dcaa7f420cd655924 1471914013 -----sp","Author":"PersonIdent[jiazhai, zhaijia03@gmail.com, Mon Aug 22 18:00:13 2016 -0700]","Body":"DL-1: Clean up the distributedlog pom files\n\n- changed the version to 0.4.0-incubating\n- changed names to include 'Apache DistributedLog' and use '::' as separator\n- add developers, mail lists and jira\n\nAuthor: jiazhai <zhaijia03@gmail.com>\n\nReviewers: Franck Cuny <franck.cuny@gmail.com>, Sijie Guo <sijie@apache.org>\n\nCloses #10 from jiazhai/zhaijia/fix_apache_version\n","Date":"Tue Aug 23 03:00:13 CEST 2016"},{"Commit-ID":"commit e39e3b036145907e9df87f72fb7b9773c4f35b45 1471914339 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Mon Aug 22 18:05:39 2016 -0700]","Body":"DL-31: Provide flag to disable zk based distributed lock\n\nDL doesn't enforce any leader election. However it still provides a zookeeper ephemeral znode based lock for leader election. It is unnecessary if applications use core library directly already have its own leader election mechanism.\n\nThis change is to provide a flag to allow disable the zk based lock.\n\nAuthor: Sijie Guo <sijieg@twitter.com>\n\nReviewers: Leigh Stewart <lstewart@apache.org>\n\nCloses #9 from sijie/sijie/flag_to_disable_lock\n","Date":"Tue Aug 23 03:05:39 CEST 2016"},{"Commit-ID":"commit 18ad45fa87c18f362e93060922d6b25729d503ce 1472270947 -----sp","Author":"PersonIdent[Jon Derrick, jonathan.derrickk@gmail.com, Fri Aug 26 21:09:07 2016 -0700]","Body":"DL-36: travis ci build failed with assembly plugin\n\n- use 'mvn package' instead of 'mvn verify'\n- fix the assembly script\n- added missed license headers\n\nAuthor: Jon Derrick <jonathan.derrickk@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #14 from jderrickk/jd/fix_assembly_package\n","Date":"Sat Aug 27 06:09:07 CEST 2016"},{"Commit-ID":"commit a1890ec9992442ca0e051a674df2a130de6fd0a9 1473237507 -----sp","Author":"PersonIdent[jiazhai, zhaijia03@gmail.com, Wed Sep 7 01:38:27 2016 -0700]","Body":"Mark some dl tests as flaky\n\nmark some dl tests as flaky and link the corresponding investigation jiras\n\nAuthor: jiazhai <zhaijia03@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #20 from jiazhai/zhaijia/fix_travis_build\n","Date":"Wed Sep 07 10:38:27 CEST 2016"},{"Commit-ID":"commit 9db51b8d532d18485798d9dd96973c22450a0495 1473532063 -----sp","Author":"PersonIdent[eolivelli, eolivelli@gmail.com, Sat Sep 10 11:27:43 2016 -0700]","Body":"BOOKKEEPER-930: Option to disable Bookie networking\n\nAuthor: eolivelli <eolivelli@gmail.com>\n\nReviewers: sijie@apache.org <sijie@apache.org>\n\nCloses #49 from eolivelli/BOOKKEEPER-930\n","Date":"Sat Sep 10 20:27:43 CEST 2016"},{"Commit-ID":"commit 9dc05fc080ddf01e69eb89ce1b0865c552d3de53 1473534087 -----sp","Author":"PersonIdent[Rithin, rithin.shetty@salesforce.com, Sat Sep 10 12:01:27 2016 -0700]","Body":"BOOKKEEPER-945: Add counters to track the activity of auditor and repl\u2026\n\n\u2026ication workers\n\nOnce we enable auto recovery, auditor and replication workers start their activity.\nToday there is no way to monitor it using counters. This change introduces the\nfollowing counters to track various activities of auditor and replication workers like:\n\n- Time taken by auditor to build the bookie->ledger list\n- No. of under replicated ledgers detected\n- Time taken by auditor to publish the under replicated ledger list\n- Time taken by auditor to check all the ledgers in the cluster\n- No. of ledgers replicated by each replication worker\n- No. of entries and bytes of data read and written by each replication worker\n- Auditor can also report the distribution of ledgers within the cluster: how many bookies own a piece of ledger, etc.\n\nAuthor: Rithin <rithin.shetty@salesforce.com>\n\nReviewers: sijie@apache.org <sijie@apache.org>\n\nCloses #57 from rithin-shetty/auto_recovery_counters\n","Date":"Sat Sep 10 21:01:27 CEST 2016"},{"Commit-ID":"commit 941bd8ddf4b65e4dc0cec56f1e76c3cfe157be5a 1473731504 -----sp","Author":"PersonIdent[jiazhai, zhaijia03@gmail.com, Mon Sep 12 18:51:44 2016 -0700]","Body":"Add infinite retry policy to zookeeper client used by tests\n\nThis change is to improve the tests running on travis ci\n\nAuthor: jiazhai <zhaijia03@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #25 from jiazhai/zhaijia/fix_federated_namespace\n","Date":"Tue Sep 13 03:51:44 CEST 2016"},{"Commit-ID":"commit 0d424a17571ab19039f8b7c7a5766980b6373090 1482886168 -----sp","Author":"PersonIdent[Yiming Zang, yzang@twitter.com, Fri Sep 16 17:35:51 2016 -0700]","Body":"DL-108: Log rate limiting more clearly\n","Date":"Sat Sep 17 02:35:51 CEST 2016"},{"Commit-ID":"commit bbd1eb8d8560b03834175fbd996b85237df09f5c 1476337842 -----sp","Author":"PersonIdent[Robin Dhamankar, robin.dhamankar@gmail.com, Wed Oct 12 22:50:42 2016 -0700]","Body":"BOOKKEEPER-612: Region aware placement\n\n- Introduce the concept of a two level Network Topology with region as the first level and rack as the second level\n- NodeBase, Node and NetworkTopology manage this two level hierarchy and position of individual nodes in this hierarchy\n- An implementation of RegionawareEnsemblePlacementPolicy that distributes nodes across regions and within regions uses rack aware placement to place nodes\n\nThis is a stacked diff (opening to start a review), we would still merge the dependent pull request first.\n\nAuthor: Robin Dhamankar <robindh@Robins-MacBook-Air.local>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #56 from robindh/RegionAwarePlacement\n","Date":"Thu Oct 13 07:50:42 CEST 2016"},{"Commit-ID":"commit bf4a4d6a07f9d615752054c6743035cebd86716e 1476343638 -----sp","Author":"PersonIdent[eolivelli, eolivelli@gmail.com, Thu Oct 13 00:27:18 2016 -0700]","Body":"BOOKKEEPER-924: addEntry() is susceptible to spurious wakeups\n\nUse Java8 CompletableFuture instead of SyncCounter\n\nAuthor: eolivelli <eolivelli@gmail.com>\n\nReviewers: sijie@apache.org <sijie@apache.org>\n\nCloses #60 from eolivelli/BOOKKEEPER-924 and squashes the following commits:\n\n61e6b1a [eolivelli] BOOKKEEPER-924 addEntry() is susceptible to spurious wakeups\n7d7eaf7 [eolivelli] BOOKKEEPER-924 addEntry() is susceptible to spurious wakeups\nf865610 [eolivelli] BOOKKEEPER-924 addEntry() is susceptible to spurious wakeups\ne75569a [eolivelli] BOOKKEEPER-924 addEntry() is susceptible to spurious wakeups\ncdd32c3 [eolivelli] BOOKKEEPER-924 addEntry() is susceptible to spurious wakeups\n","Date":"Thu Oct 13 09:27:18 CEST 2016"},{"Commit-ID":"commit b9247a10caa4ff635184da52c8975a921877b500 1476344831 -----sp","Author":"PersonIdent[Jon Derrick, jonathan.derrickk@gmail.com, Thu Oct 13 00:47:11 2016 -0700]","Body":"DL-32: Fix Findbug warnings\n\n- Bump the version to 3.0.3\n- Fix all the findbug warnings\n- Enable findbugs:check on travis ci\n\nAuthor: Jon Derrick <jonathan.derrickk@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #19 from jderrickk/jd/fix_findbugs_error and squashes the following commits:\n\nc48c89c [Jon Derrick] Merge branch 'master' into jd/fix_findbugs_error\nd9b0425 [Jon Derrick] verify findbugs on travis ci\n985501b [Jon Derrick] Fix findbug errors on all modules\n18e8267 [Jon Derrick] Remove distributedlog-example\nffa8361 [Jon Derrick] Fix findbugs in distributedlog-protocol\n","Date":"Thu Oct 13 09:47:11 CEST 2016"},{"Commit-ID":"commit 2b2f33f51c8d3ac78fb7b969294eab952d730a99 1476344831 -----sp","Author":"PersonIdent[Jon Derrick, jonathan.derrickk@gmail.com, Thu Oct 13 00:47:11 2016 -0700]","Body":"DL-32: Fix Findbug warnings\n\n- Bump the version to 3.0.3\n- Fix all the findbug warnings\n- Enable findbugs:check on travis ci\n\nAuthor: Jon Derrick <jonathan.derrickk@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #19 from jderrickk/jd/fix_findbugs_error and squashes the following commits:\n\nc48c89c [Jon Derrick] Merge branch 'master' into jd/fix_findbugs_error\nd9b0425 [Jon Derrick] verify findbugs on travis ci\n985501b [Jon Derrick] Fix findbug errors on all modules\n18e8267 [Jon Derrick] Remove distributedlog-example\nffa8361 [Jon Derrick] Fix findbugs in distributedlog-protocol\n","Date":"Thu Oct 13 09:47:11 CEST 2016"},{"Commit-ID":"commit 4383b0b171d5fdfcdfa55c196998bbc6b7fdc260 1476985113 -----sp","Author":"PersonIdent[Yiming Zang, yzang@twitter.com, Thu Oct 20 10:38:33 2016 -0700]","Body":"BOOKKEEPER-952: Fix RegionAwareEnsemblePlacementPolicy\n\nallocate bookies evenly as much as possible across all regions\n\nhttps://issues.apache.org/jira/browse/BOOKKEEPER-952\n\nRB_ID=880463\n\nAuthor: Yiming Zang <yzang@twitter.com>\n\nReviewers: sijie@apache.org <sijie@apache.org>\n\nCloses #61 from yzang/apache_master and squashes the following commits:\n\na0a9979 [Yiming Zang] fix Inefficient use of keySet iterator instead of entrySet iterator\nd882c28 [Yiming Zang] fix RegionAwareEnsemblePlacementPolicy test case fix the algorithm for balanced placement across regions.\n","Date":"Thu Oct 20 19:38:33 CEST 2016"},{"Commit-ID":"commit 35587d3d70cf60b84f425db13718b4537336fd80 1482886168 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Thu Oct 27 10:18:52 2016 -0700]","Body":"DL-109: Add a tool to find the stream containing the given ledger\n","Date":"Thu Oct 27 19:18:52 CEST 2016"},{"Commit-ID":"commit 0abf37c64ced0fe49a6470bc0e2be632e47902d6 1478656954 -----sp","Author":"PersonIdent[Rithin, rithin.shetty@salesforce.com, Tue Nov 8 18:02:34 2016 -0800]","Body":"BOOKKEEPER-946: Provide an option to delay auto recovery of lost bookies\n\nIf auto recovery is enabled, and a bookie goes down for upgrade or even if it looses zk connection\nintermittently, the auditor detects it as a lost bookie and starts under replication detection and\nthe replication workers on other bookie nodes start replicating the under replicated ledgers. All\nof this stops once the bookie comes up but by then a few ledgers would get replicated. Given the\nfact that we have multiple copies of data, it is probably not necessary to start the recovery as\nsoon as a bookie goes down. We can wait for an hour or so and then start recovery. This should\ncover cases like planned upgrade, intermittent network connectivity loss, etc.\n\nThis change:\n    1) Provides a bookie option 'lostBookieRecoveryDelay' in secs, which when set to a non zero value,\n       will delay the start of recovery by that number of seconds. By default, this option is set to 0;\n       which means the audit is not delayed.\n    2) If another bookie were to go down in this interval, the recovery is immediately started and the\n       one scheduled for future is canceled.\n    3) Adds counters to track how many audits were delayed(#1) and how many scheduled audits were\n       canceled due to multiple bookie failures(#2).\n    4) Three junit tests to verify the new feature.\n\nAuthor: Rithin <rithin.shetty@salesforce.com>\n\nReviewers: siddharth.boobna@gmail.com <siddharth.boobna@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>\n\nCloses #58 from rithin-shetty/audit_delay\n","Date":"Wed Nov 09 03:02:34 CET 2016"},{"Commit-ID":"commit 309cbba65c8532ef84c70efe181b3162e3078333 1478657157 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Tue Nov 8 18:05:57 2016 -0800]","Body":"BOOKKEEPER-903: metaformat command fix\n\nmetaformat command should delete underreplicated ledger\nznodes and lock nodes\n\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\n\nReviewers: sijie@apache.org <sijie@apache.org>\n\nCloses #62 from reddycharan/metaformatfix\n","Date":"Wed Nov 09 03:05:57 CET 2016"},{"Commit-ID":"commit cc3d2701687ce1a4ff14502e2214a381b43aed5f 1478657324 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Tue Nov 8 18:08:44 2016 -0800]","Body":"BOOKKEEPER-956: Fix for HierarchicalLedgerRangeIterator\n\nFix for HierarchicalLedgerRangeIterator, to make it work\nfor LedgerIds of length 9 and 10\n\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\n\nReviewers: sijie@apache.org <sijie@apache.org>\n\nCloses #64 from reddycharan/hierarchicalledgermanagerfix\n","Date":"Wed Nov 09 03:08:44 CET 2016"},{"Commit-ID":"commit 8f0bed9f8401001abd683c420757610996cf96d8 1478677494 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Tue Nov 8 23:44:54 2016 -0800]","Body":"BOOKKEEPER-957: LedgerHandleAdv fixes\n\n- making addToLength call synchronized\n- adding op to pendingAddOps after doing sanity check\n\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #65 from reddycharan/ledgerhandleadvfix\n","Date":"Wed Nov 09 08:44:54 CET 2016"},{"Commit-ID":"commit 026ef10e1e9706ead4f1bc6763ded2e28c91480d 1478677760 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Tue Nov 8 23:49:20 2016 -0800]","Body":"BOOKKEEPER-958: Fix for ZeroBuffer Bug\n\nFix for readOnlyBuffer of ZeroBuffer bug\n\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #66 from reddycharan/zerobufferfix\n","Date":"Wed Nov 09 08:49:20 CET 2016"},{"Commit-ID":"commit 7673febb6519fedb96320ec98db71601826a63b1 1478918113 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri Nov 11 18:35:13 2016 -0800]","Body":"BOOKKEEPER-961: Assign read/write requests for same ledger to a single thread\n\nWhen entries for the same ledger are processed by the bookie we should avoid\nthe reordering of the request. Currently, if multiple read/write threads are\nconfigured, the requests will be passed to the executor and writes for same\nledger will be spread across multiple threads.\n\nThis poses 2 issues:\n 1. Mutex contention to access the LedgerDescriptor\n 2. If the client receives add-entry acks out of order it has anyway to wait\n    for the acks of previous entries before acknowledging the whole sequence\n    to the application. In practice, the reordering is increasing the latency\n   experienced by the application.\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #69 from merlimat/bk-fixed-ledger-thread\n","Date":"Sat Nov 12 03:35:13 CET 2016"},{"Commit-ID":"commit 2ba9a2c4f7192ec0abaccdfd334025b4ddb9da66 1478918255 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri Nov 11 18:37:35 2016 -0800]","Body":"BOOKKEEPER-962: Add more journal timing stats\n\nIt is useful to know the sync latency on the journal to identify disk/filesystem\nrelated latency spikes that will cause all the entries to queue up. In the same\nline, it's useful to track the amount of time spent in the journal queue.\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #70 from merlimat/bk-journal-latency\n","Date":"Sat Nov 12 03:37:35 CET 2016"},{"Commit-ID":"commit d606ee4ba0080431c5ec67b8805ff3bb269005d6 1483006015 -----sp","Author":"PersonIdent[Yiming Zang, yzang@twitter.com, Wed Nov 16 14:14:52 2016 -0800]","Body":"DL-115: fix force get log segment logic\n\nSummary:\n\nWe should remove the ledger closed check:\n\n- force to get log segments if the reader has been idle for a while after open the ledger\n- idleReaderWarnThreshold should be 2x larger than readLACLongPollTimeout\n","Date":"Wed Nov 16 23:14:52 CET 2016"},{"Commit-ID":"commit 9359d682a1598e30364eca6021d976f911e055b2 1479424715 -----sp","Author":"PersonIdent[Robin Dhamankar, robindh@Robins-MacBook-Air.local, Thu Nov 17 15:18:35 2016 -0800]","Body":"BOOKKEEPER-965: Long Polling Part I: Changes in the write path\n\nThis is the first in the series of changes for enabling long polling between bookkeeper client and the bookkeeper server. The changes were originally implemented in the Twitter fork and these pull request combine multiple commits from Twitter's bookkeeper fork as they include not only the changes made initially but also bug fixes added since.\n\nThe first change captures the changes on the write path (AddEntry). We track the last add confirmed in the FileInfo so that we can trigger actions when the value is updated\n\nAuthor: Robin Dhamankar <robindh@Robins-MacBook-Air.local>\n\nReviewers: sijie@apache.org <sijie@apache.org>\n\nCloses #73 from robindh/LongPollWritePath\n","Date":"Fri Nov 18 00:18:35 CET 2016"},{"Commit-ID":"commit 95ea4815b5313ea2ab02e5192c9f577d1c0fe24e 1479426246 -----sp","Author":"PersonIdent[eolivelli, eolivelli@gmail.com, Thu Nov 17 15:44:06 2016 -0800]","Body":"BOOKKEEPER-912: Allow EnsemblePlacementPolicy to choose bookies using ledger custom data (multitenancy support)\n\nAuthor: eolivelli <eolivelli@gmail.com>\n\nReviewers: sijie@apache.org <sijie@apache.org>\n\nCloses #68 from eolivelli/BOOKKEEPER-912 and squashes the following commits:\n\n6c1eaca [eolivelli] BOOKKEEPER-912 Allow EnsemblePlacementPolicy to choose bookies using ledger custom data (multitenancy support)\n7c0ab37 [eolivelli] BOOKKEEPER-912 Allow EnsemblePlacementPolicy to choose bookies using ledger custom data (multitenancy support)\n","Date":"Fri Nov 18 00:44:06 CET 2016"},{"Commit-ID":"commit b90cce8bbffa23f348058f8977a740b97f39dee2 1482886169 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Mon Nov 21 16:17:51 2016 -0800]","Body":"DL-110: Write control record if necessary when roll a log segment\n","Date":"Tue Nov 22 01:17:51 CET 2016"},{"Commit-ID":"commit ee117235dc1a6fa76093c315c0fed4239831cd63 1482886169 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Mon Nov 21 17:30:13 2016 -0800]","Body":"DL-111: ReadAhead Cache should cache entries rather than records\n\nCurrent readahead cache cache records. So it will be a lot of callbacks (function calls) when polling a record off the readahead cache. Most of the cpu cycles are unnecessarily spent\non function calls on polling records off the readahead cache. It is the throughput bottleneck for a DL reader.\n\nThis change is to change ReadAhead cache to cache entries rather than records. Defer the deserilization of records later on when the reader wants to access the records. It also make\nthe cache more efficient to reduce the memory footprint.\n","Date":"Tue Nov 22 02:30:13 CET 2016"},{"Commit-ID":"commit c9e76260dee1d661906c8bf89b032950f92c6d0e 1482886169 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Mon Nov 21 17:35:40 2016 -0800]","Body":"DL-112: Improve SyncReader to access readahead cache directly\n\nThis changes the implementation of SyncReader to let it access the read ahead cache directly, rather\nthan calling AsyncReader to fetch the entries. It would reduce the function calls that SyncReader spends\non reading individual records.\n","Date":"Tue Nov 22 02:35:40 CET 2016"},{"Commit-ID":"commit 7c4476cd01e2ed7530cbb6f429d78f083837b838 1482886170 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Mon Nov 21 17:41:26 2016 -0800]","Body":"DL-113: Improve the sync reader benchmark\n\nAdd more logging information for calcuating the stats for catching up reads\n","Date":"Tue Nov 22 02:41:26 CET 2016"},{"Commit-ID":"commit baa0afc059dc0a96d5fb8c902a0504cf8fd30e02 1480449017 -----sp","Author":"PersonIdent[Khurrum Nasim, khurrumnasimm@gmail.com, Tue Nov 29 11:50:17 2016 -0800]","Body":"Fix deadlock on BKSyncLogReaderDLSN\n\nChange the lastSeenDLSN to volatile to remove the synchronization block to avoid deadlock with sharedLock\n\nAuthor: Khurrum Nasim <khurrumnasimm@gmail.com>\n\nReviewers: Leigh Stewart <lstewart@apache.org>\n\nCloses #42 from khurrumnasimm/kn/fix_deadlock\n","Date":"Tue Nov 29 20:50:17 CET 2016"},{"Commit-ID":"commit 66515e74d3fb03d21cad4eccb446a90ab7e94597 1480460547 -----sp","Author":"PersonIdent[Rithin, rithin.shetty@salesforce.com, Tue Nov 29 15:02:27 2016 -0800]","Body":"BOOKKEEPER-948: Provide an option to add more ledger/index directorie\u2026\n\n\u2026s to a bookie\n\nThis change allows the addition of new ledger and index directories to a bookie. Thus\nincreasing ts storage capacity. The option is exposed via 'allowStorageExpansion'\nboolean configuration option. Also, the newly added directories need to be empty to be\naccepted. Two new test cases have been added to test this functionality.\n\nAuthor: Rithin <rithin.shetty@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nCloses #59 from rithin-shetty/storage_expansion\n","Date":"Wed Nov 30 00:02:27 CET 2016"},{"Commit-ID":"commit 4cf097871d28b70a53f8c6bffaf1c2022e9953b2 1480460862 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Tue Nov 29 15:07:42 2016 -0800]","Body":"BOOKKEEPER-955: in listLedgers method currentRange variable has to be\u2026\n\n\u2026 updated to the next iterator\n\nin BookKeeperAdmin listLedgers method currentRange variable is not getting updated to next iterator\nwhen it has run out of elements\n\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\n\nReviewers: Venkateswararao Jujjuri <vjujjuri@salesforce.com>\n\nCloses #63 from reddycharan/listledgersfix\n","Date":"Wed Nov 30 00:07:42 CET 2016"},{"Commit-ID":"commit ecbb053e6e873859507e247cae727f4bc8b9f7fa 1480461466 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@yahoo-inc.com, Tue Nov 29 15:17:46 2016 -0800]","Body":"BOOKKEEPER-964: Add concurrent maps and sets for primitive types\n\nIn BookKeeper there are many instances of maps and sets that use ledger id\nand entry ids as keys or values. JDK concurrent collections have the overhead\nof boxing all the primitive values into objects (eg: long --> Long) that would\nneed to be allocated from the heap. In addition to that, JDK map implementations\nare closed hash tables and they will require at least one more allocation to hold\nthe linked-list/tree node.\n\nThere are already available libraries that offer primitive collections with\nzero-allocation, but none of these support concurrent maps/sets.\n\nWe have added a handful of specializations, all based on the same implementation\nidea. We have a hash table which is broken down into multiple sections. Each\nsections, on its own, is an open hash table with linear probing, protected by\na stamped lock.\n\nAll insertions, lookups and iterations on these collections are allocation free.\n\n```\nConcurrentLongHashMap: Map<long, Object>\nConcurrentLongHashSet: Set<long>\nConcurrentLongLongHashMap: Map<long, long>\nConcurrentLongLongPairHashMap: Map< Pair<long, long>, Pair<long, long> >\nConcurrentOpenHashMap: Map<Object, Object>\nConcurrentOpenHashSet: Set<Object>\n```\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <Enrico.olivelli@diennea.com>\n\nCloses #72 from merlimat/bk-collections\n","Date":"Wed Nov 30 00:17:46 CET 2016"},{"Commit-ID":"commit f710e5a44569aa080b80eff855fff2c3810957fd 1480461547 -----sp","Author":"PersonIdent[eolivelli, eolivelli@gmail.com, Tue Nov 29 15:19:07 2016 -0800]","Body":"BOOKKEEPER-976 Fix license headers\n\n\u2026ftware Foundation\"\n\nAuthor: eolivelli <eolivelli@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #84 from eolivelli/BOOKKEEPER-976\n","Date":"Wed Nov 30 00:19:07 CET 2016"},{"Commit-ID":"commit 68f796019ce771a44ba20548046a444177143be0 1483006047 -----sp","Author":"PersonIdent[Yiming Zang, yzang@twitter.com, Wed Nov 30 14:16:14 2016 -0800]","Body":"DL-116: Add tool for deleting subscriber from subscription store\n\nTest Plan:\n\n1. manually create znode for subscribers resume point\n2. use the tool to delete the subscriberId\n","Date":"Wed Nov 30 23:16:14 CET 2016"},{"Commit-ID":"commit de4711ddf87571c4de5686385663aef3f19fcaf7 1483006113 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Wed Nov 30 17:14:05 2016 -0800]","Body":"DL-117: Stream metadata store\n\nThis change is to abstract the zookeeper operations into a stream metadata store, so we can replace zookeeper with other metadata store easily.\n\nSo the metadata operations in distributedlog now are managed by 3 classes:\n\n- LogMetadataStore : it is the namespace metadata store : it manages the location (uri) mapping for streams and handle namespace operations.\n- LogStreamMetadataStore: it is the stream metadata store : it manages the metadata for a single stream, such as managing read/write lock, retriving/creating stream metadata, deleting metadata and such.\n- LogSegmentMetadataStore: it is the segment metadata store : it manages the log segment metadata for individual log segment.\n\nLogMetadataStore and LogSegmentMetadataStore are already there. This change focus on LogStreamMetadataStore\n\nChanged:\n\n* abstract all the zookeeper metadata operation in log handlers to LogStreamMetadataStore\n* remove disabling max tx id santify check, as maxTxId update is part of the metadata update transaction\n\nNot changed:\n\nthe name of ZKLogMetadataForReader and ZKLogMetadataForWriter are not changed. I will send out a change to rename these two classes as they are not related to zookeeper anymore.\n","Date":"Thu Dec 01 02:14:05 CET 2016"},{"Commit-ID":"commit 3a512326dc2cec7e4c62e0dc8fe569fdc5305373 1483006140 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Wed Nov 30 18:17:46 2016 -0800]","Body":"DL-118: Stream metadata store followup - rename ZKLogMetadata* to LogMetadata*\n\nAs the followup change, this change is to remove 'ZK' from 'ZKLogMetadata*' class\n","Date":"Thu Dec 01 03:17:46 CET 2016"},{"Commit-ID":"commit 09a34b0e9b814bf602dceccd64ad7dbfc718fcfb 1483006180 -----sp","Author":"PersonIdent[Yiming Zang, yzang@twitter.com, Wed Nov 30 18:21:08 2016 -0800]","Body":"DL-119: Fix the logging on closing readahead worker\n","Date":"Thu Dec 01 03:21:08 CET 2016"},{"Commit-ID":"commit aebd68049eec8417769059d7500ab9a4ebb19c27 1480737219 -----sp","Author":"PersonIdent[Franck Cuny, fcuny@apache.org, Fri Dec 2 19:53:39 2016 -0800]","Body":"Update a couple of scripts\n\nMostly style.\n\nAuthor: Franck Cuny <fcuny@apache.org>\nAuthor: Leigh Stewart <lstewart@twitter.com>\nAuthor: Khurrum Nasim <khurrumnasimm@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #46 from franckcuny/fcuny/update-scripts and squashes the following commits:\n\n50c16ec [Franck Cuny] Rename a variable in one of the shell script.\n924ba7e [Franck Cuny] Run `git rev-parse` only once when building the bundle.\nf1d3b3f [Franck Cuny] Remove more duplicated shell scripts.\n90ce66f [Franck Cuny] Do not duplicate code for the 'bundle' script.\n13987ea [Franck Cuny] Build cobertura report only on master for successful builds\n525ec9a [Khurrum Nasim] Fix deadlock on BKSyncLogReaderDLSN\n23c9190 [Leigh Stewart] Add documentation for distributedlog-benchmark\n85aa8a7 [Franck Cuny] Make the shell style more consistent.\n4f81ba2 [Franck Cuny] Rely on git to find the root directory.\n","Date":"Sat Dec 03 04:53:39 CET 2016"},{"Commit-ID":"commit 2717eb4e37c88925fc4c0059bba013fd0f3aba97 1480747543 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Fri Dec 2 22:45:43 2016 -0800]","Body":"DL-49: Support building project with scala 2.10 and 2.11\n\nAuthor: Sijie Guo <sijieg@twitter.com>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Franck Cuny <franck.cuny@gmail.com>\n\nCloses #22 from sijie/sijie/support_scala_2.10_and_2.11\n","Date":"Sat Dec 03 07:45:43 CET 2016"},{"Commit-ID":"commit 3a0025998c65df7794ae2a1b20ad1d58c03bf410 1481585874 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Dec 12 15:37:54 2016 -0800]","Body":"DL-127: Fix coverall report\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Franck Cuny <franck.cuny@gmail.com>\n\nCloses #53 from sijie/sijie/remove_reporting\n","Date":"Tue Dec 13 00:37:54 CET 2016"},{"Commit-ID":"commit 8a4f4a63b1f066598e887ca34620d88f7db2bdd5 1481585874 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Dec 12 15:37:54 2016 -0800]","Body":"DL-127: Fix coverall report\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Franck Cuny <franck.cuny@gmail.com>\n\nCloses #53 from sijie/sijie/remove_reporting\n","Date":"Tue Dec 13 00:37:54 CET 2016"},{"Commit-ID":"commit da53069b9858fd904a68ce84b5954c60a0ba05b2 1483006232 -----sp","Author":"PersonIdent[Jordan Bull, jbull@twitter.com, Tue Dec 13 11:11:03 2016 -0800]","Body":"DL-157: resource placement for write proxy\n","Date":"Tue Dec 13 20:11:03 CET 2016"},{"Commit-ID":"commit 13b890b738f6470463a6c8f72917fe94cdfb97bd 1481847657 -----sp","Author":"PersonIdent[Franck Cuny, fcuny@apache.org, Thu Dec 15 16:20:57 2016 -0800]","Body":"Clean up and fix a few shell scripts\n\nThis is still in progress.\n\n- remove trailing white spaces in a few places\n- fix some scripts (not rely on git); style consistency\n- validate that the vagrant configuration works\n- one of the Dockerfile was not correct\n\nAuthor: Franck Cuny <fcuny@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #55 from franckcuny/fcuny/hack-week-cleanup and squashes the following commits:\n\nfe3965d [Franck Cuny] Fix dlog script for core.\nf15cefd [Franck Cuny] fix a few more things in the common script.\nc32dee2 [Franck Cuny] Remove useless cd\n622d3ab [Franck Cuny] Fix bundle for service.\n93e9485 [Franck Cuny] A few more fixes for benchmarks' scripts.\na3fc4ef [Franck Cuny] Remove trailing white spaces in the doc\n27f90f1 [Franck Cuny] Rename bookkeeper hosts from node to bk.\n21d89f8 [Franck Cuny] Do not assume git is available in the shell scripts.\n480bc34 [Franck Cuny] Remove comment from Dockerfile\na7ac7c0 [Franck Cuny] Git ignore pid files\n179eddc [Franck Cuny] Ignore .vagrant directory created by vagrant.\n9bf33fc [Franck Cuny] Create a valid snapshot.\n5800829 [Franck Cuny] Remove Dockerfile and docker directory.\n","Date":"Fri Dec 16 01:20:57 CET 2016"},{"Commit-ID":"commit 0451d59c89b0df346e39c921acf6f066d949bfe0 1481915721 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Fri Dec 16 11:15:21 2016 -0800]","Body":"DL-141: Fix broken scripts in tutorials and add integration test to travis ci\n\n- fix the broken scripts used in tutorials\n- fix the write_proxy configuration (a change was merged to validate configuration which it brokes the configuration too)\n- add integration test to validate the basic end-to-end functionalities\n\nAuthor: Sijie Guo <sijieg@twitter.com>\n\nReviewers: Leigh Stewart <lstewart@apache.org>\n\nCloses #76 from sijie/sijie/script_for_ci\n","Date":"Fri Dec 16 20:15:21 CET 2016"},{"Commit-ID":"commit 6d2737ca22533aed461ed71e94d2472a6664df3c 1481938780 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Dec 16 17:39:40 2016 -0800]","Body":"BOOKKEEPER-984: Fix BookieClientTest.testWriteGaps\n\nin commit 9359d682a1598e30364eca6021d976f911e055b2, the third field (last add confirmed) in the message. changed the test to include the lac in the test so the test logic can work as expected.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nCloses #91 from sijie/sijie/BOOKKEEPER-984\n","Date":"Sat Dec 17 02:39:40 CET 2016"},{"Commit-ID":"commit d2e82d4942be079cbfdb179e9a3fe3e574beff8d 1481938825 -----sp","Author":"PersonIdent[eolivelli, eolivelli@gmail.com, Fri Dec 16 17:40:25 2016 -0800]","Body":"BOOKKEEPER-987: BookKeeper build is broken due to the shade plugin\n\nThis is simply an upgrade of the maven-shade-plugin to version 2.4.3\n\nAuthor: eolivelli <eolivelli@gmail.com>\n\nReviewers: Rithin Shetty <rithin@gmail.com>, Sijie Guo <sijie@apache.org>\n\nCloses #94 from eolivelli/BOOKKEEPER-987\n","Date":"Sat Dec 17 02:40:25 CET 2016"},{"Commit-ID":"commit 4bb57ef0b1b72eb1118963efc3ab9f0e9bec0e1c 1481938938 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Fri Dec 16 17:42:18 2016 -0800]","Body":"BOOKKEEPER-967: New testsuite for RackPlacement\n\nAdded New Testsuite for testing\nRackAwareEnsemblePlacementPolicy using\nScriptBasedMapping. It works\nonly on Unix based OS, because of Shell\nscript.\n\nThis testsuite has similar testscenarios as in\nTestRackawareEnsemblePlacementPolicy.java.\n\nAlso here it is assumed that the script file\nhas execution permission.\n\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #86 from reddycharan/testrackawareusingscript\n","Date":"Sat Dec 17 02:42:18 CET 2016"},{"Commit-ID":"commit be99f024df5d53b3988f585ab46d6b604592acf1 1481939014 -----sp","Author":"PersonIdent[jiazhai, jia.zhai@emc.com, Fri Dec 16 17:43:34 2016 -0800]","Body":"BOOKKEEPER-971: update bk codahale stats provider version\n\nUpdate bk stats provider: from codahale to yammer.\nCurrently io.dropwizard.metrics 3.1.0 is used most widely. will change version to 3.1.0.\n\nAnd change CodahaleMetricsProvider.getMetrics() to public, since this would be used outside package.\n\nAnd a small bug here:\n```\n            File outdir;\n            if (Strings.isNullOrEmpty(prefix)) {  < === if (!)\n                outdir = new File(csvDir, prefix);\n            } else {\n                outdir = new File(csvDir);\n            }\n```\n\nAuthor: jiazhai <jia.zhai@emc.com>\nAuthor: jiazhai <jiazhai@users.noreply.github.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #83 from jiazhai/BOOKKEEPER-971\n","Date":"Sat Dec 17 02:43:34 CET 2016"},{"Commit-ID":"commit 669ab4ac32bcbf6b3d883a07ed942d36d25b8a6e 1481939064 -----sp","Author":"PersonIdent[Rithin, rithin.shetty@salesforce.com, Fri Dec 16 17:44:24 2016 -0800]","Body":"BOOKKEEPER-946: Provide an option to delay auto recovery of lost bookies\n\nFixing a bug in the test AuditorLedgerCheckerTest.testDelayedAuditOfLostBookies which\nfails sometimes with:\nAuditorLedgerCheckerTest.testDelayedAuditOfLostBookies:367->_testDelayedAuditOfLostBookies:345 audit of lost bookie isn't delayed\n\nAuthor: Rithin <rithin.shetty@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nCloses #82 from rithin-shetty/audit_delay_fix\n","Date":"Sat Dec 17 02:44:24 CET 2016"},{"Commit-ID":"commit 73edd4a99191d3c710b24a85eed3e2dbcd0a93bc 1481939111 -----sp","Author":"PersonIdent[jiazhai, jia.zhai@emc.com, Fri Dec 16 17:45:11 2016 -0800]","Body":"BOOKKEEPER-966: change bookieServer cmdline to make conf-file and option co-exist\n\nCurrently, when using bookieServer cmdline to start a bookie, you will either give it a cofiguration file by \"-c booke.conf\"; or add some options like \"<bookie_port> <zk_servers> <journal_dir> <ledger_dir [ledger_dir]>\" in a fix sequential.\nIt may not satisfy some of the requirement. So changed it to be co-exist for configuration file and options.\n\nBy this change, it will first use settings in configuration file; and then use options to overwrite some of the settings, if there are some options provided.\n\nHere is an example after this change:\n```\nBookieServer -c bookie.conf -z localhost:2181 -m /bookkeeper/ledgers -p 3181 -j /mnt/journal -l \"/mnt/ledger1 /mnt/ledger2 /mnt/ledger3\u201d\n```\nHere, in this command:\n-z is for \u201cZookeeper client instance\u201d;\n-m is for \"Zookeeper ledgers root path for bookies\";\n-p is for \"bookie service port exported\";\n-j is for \"bookie journal directory\";\n-l is for \"bookie ledgers directories\".\n\nAuthor: jiazhai <jia.zhai@emc.com>\nAuthor: jiazhai <jiazhai@users.noreply.github.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nCloses #75 from jiazhai/BOOKKEEPER-966\n","Date":"Sat Dec 17 02:45:11 CET 2016"},{"Commit-ID":"commit 7b5dc6231e89d282fe00b95cb845ddaf15b034e8 1481953863 -----sp","Author":"PersonIdent[Jordan Bull, jbull@twitter.com, Fri Dec 16 21:51:03 2016 -0800]","Body":"DL-86: Improve handling of lock conflicts in zk session lock\n\nmerge twitter's change from Sijie Guo.\n\nAuthor: Jordan Bull <jbull@twitter.com>\nAuthor: Sijie Guo <sijieg@twitter.com>\n\nReviewers: Leigh Stewart <lstewart@apache.org>\n\nCloses #58 from sijie/merge/DL-86\n","Date":"Sat Dec 17 06:51:03 CET 2016"},{"Commit-ID":"commit db17ed7b24abd2a938dc344a0bae4a703349c207 1481957004 -----sp","Author":"PersonIdent[Jordan Bull, jbull@twitter.com, Fri Dec 16 22:43:24 2016 -0800]","Body":"DL-87: Introduce periodic keepalive control record in writer\n\nmerge twitter's change from Leigh Stewart\n\nAuthor: Jordan Bull <jbull@twitter.com>\nAuthor: Sijie Guo <sijieg@twitter.com>\nAuthor: Leigh Stewart <lstewart@twitter.com>\n\nReviewers: Leigh Stewart <lstewart@apache.org>\n\nCloses #59 from sijie/merge/DL-87\n","Date":"Sat Dec 17 07:43:24 CET 2016"},{"Commit-ID":"commit b06b537a54654824eb130e11bd3286c1120723d4 1481957441 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Fri Dec 16 22:50:41 2016 -0800]","Body":"DL-88: remove watches when unregister children watches\n\nmerge twitter's change from Sijie Guo\n\nAuthor: Sijie Guo <sijieg@twitter.com>\nAuthor: Jordan Bull <jbull@twitter.com>\nAuthor: Leigh Stewart <lstewart@twitter.com>\n\nReviewers: Leigh Stewart <lstewart@apache.org>\n\nCloses #60 from sijie/merge/DL-88\n","Date":"Sat Dec 17 07:50:41 CET 2016"},{"Commit-ID":"commit 6aa61c918ff2b3ddd1ba2fd9b98f8423d2411006 1481961348 -----sp","Author":"PersonIdent[Dave Rusek, drusek@apache.org, Fri Dec 16 23:55:48 2016 -0800]","Body":"DL-90: Don't use stack and codec together for configuring thriftmux\n\nmerge Twitter's change on thriftmux\n\nAuthor: Sijie Guo <sijieg@twitter.com>\nAuthor: Jordan Bull <jbull@twitter.com>\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Leigh Stewart <lstewart@twitter.com>\nAuthor: Dave Rusek <dave.rusek@gmail.com>\nAuthor: Dave Rusek <drusek@twitter.com>\n\nReviewers: Leigh Stewart <lstewart@apache.org>\n\nCloses #62 from sijie/merge/DL-90\n","Date":"Sat Dec 17 08:55:48 CET 2016"},{"Commit-ID":"commit 8b05fe3a171bc8aba245ef3e0b3cccd785691387 1482214852 -----sp","Author":"PersonIdent[Brennon York, brennon.york@capitalone.com, Mon Dec 19 22:20:52 2016 -0800]","Body":"DL-136: Avoid empty catch blocks\n\n* resolves the 9 empty catch blocks in `src/main`\n* leaves 49 errors within `src/test` unchanged\n  * if we want to resolve those as well let me know, wasn't sure how we wanted to handle that\n\nUsed an independent checkstyle that looked for [empty catch blocks](http://checkstyle.sourceforge.net/config_blocks.html#EmptyBlock). Did a quick manual analysis and cannot find any other empty catch blocks in `src/main` so cannot rectify the original 22 as stated in the [Kiuwan blog](https://www.kiuwan.com/blog/analyzing_distributedlog_twitter-2/).\n\nAuthor: Brennon York <brennon.york@capitalone.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #74 from brennonyork/DL-136\n","Date":"Tue Dec 20 07:20:52 CET 2016"},{"Commit-ID":"commit 64bcb21f5e6e21b49ac743941445d63b8b4e87d3 1482214957 -----sp","Author":"PersonIdent[Brennon York, brennon.york@capitalone.com, Mon Dec 19 22:22:37 2016 -0800]","Body":"DL-123: Every tests should have timeout\n\n* used a simple bash script to find any tests without a timeout\n\nHere is the below bash executed from the root directory. This could be expanded to take in more than one line above the initial `grep` although, for more, it only reduces the false positive rate. After this patch there are only 4 false positives (tests where the text immediately above is not `Test(timeout = ...)`).\n```\ngrep -r \"public void test\" -B 1 * | awk '($NR+1) % 3 !=0 {printf $0; printf \" \"} NR % 3 == 0 {print \" \"}' | grep -v \"timeout\"\n```\n\nAuthor: Brennon York <brennon.york@capitalone.com>\n\nReviewers: Leigh Stewart <lstewart@apache.org>\n\nCloses #75 from brennonyork/DL-123\n","Date":"Tue Dec 20 07:22:37 CET 2016"},{"Commit-ID":"commit 715fa5cefc31a7041725cb959641287f60921dd7 1482215103 -----sp","Author":"PersonIdent[Brennon York, brennon.york@capitalone.com, Mon Dec 19 22:25:03 2016 -0800]","Body":"DL-122: Use assertions from Junit rather than assert() for tests\n\n* changed all instances of `assert()` to junit versions in `src/test`\n\nHere is the script I used to find all instances of `assert()` inside the `src/test` folder:\n\n```\ngrep -r \"assert(\" * 2>/dev/null | grep -v \"main\"\n```\n\nThe `grep -v \"main\"` removes all instances of the usage within the main source tree (which there are quite a few). I did this as I assumed the JIRA ticket spirit was not to remove those instances from the main tree and thus would require including `junit` in core compilation rather than scoped for `test` as is.\n\nAuthor: Brennon York <brennon.york@capitalone.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #77 from brennonyork/DL-122\n","Date":"Tue Dec 20 07:25:03 CET 2016"},{"Commit-ID":"commit 6fb1a5d564eb72cabd94b28e58e0b7052424335b 1482215304 -----sp","Author":"PersonIdent[xieliang, xieliang007@gmail.com, Mon Dec 19 22:28:24 2016 -0800]","Body":"DL-28: using /* */ style comment to avoid scrooge windows platform issue\n\nAuthor: xieliang <xieliang007@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Leigh Stewart <lstewart@apache.org>\n\nCloses #73 from xieliang/DL-28\n","Date":"Tue Dec 20 07:28:24 CET 2016"},{"Commit-ID":"commit 77de65efa4e06aa4434ba87f4760e6851ae8c6ba 1482221091 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Tue Dec 20 00:04:51 2016 -0800]","Body":"DL-91: Be able to close writer within a timeout duration\n\nmerge twitter's change on closing writer.\n\nAuthor: Sijie Guo <sijieg@twitter.com>\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Jordan Bull <jbull@twitter.com>\nAuthor: Leigh Stewart <lstewart@twitter.com>\nAuthor: Dave Rusek <dave.rusek@gmail.com>\nAuthor: Dave Rusek <drusek@twitter.com>\n\nReviewers: Leigh Stewart <lstewart@apache.org>\n\nCloses #64 from sijie/merge/DL-91\n","Date":"Tue Dec 20 09:04:51 CET 2016"},{"Commit-ID":"commit 54863473365572f955a8e7a3e022614f5f5e4604 1482270188 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Dec 20 13:43:08 2016 -0800]","Body":"BOOKKEEPER-988: Add missing license header\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nCloses #95 from sijie/sijie/fix_license_header\n","Date":"Tue Dec 20 22:43:08 CET 2016"},{"Commit-ID":"commit 9a506c261d3702ddd3f39556f4331b91da952a6e 1482280953 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Tue Dec 20 16:42:33 2016 -0800]","Body":"BOOKKEEPER-983: BookieShell LedgerDelete Command\n\nBookieShell Command for LedgerDelete\n\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #90 from reddycharan/ledgerdeletecommand\n","Date":"Wed Dec 21 01:42:33 CET 2016"},{"Commit-ID":"commit 6e738d0c02ebe6710a24aad505e2fd9386bb8821 1482281328 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Tue Dec 20 16:48:48 2016 -0800]","Body":"BOOKKEEPER-986: Handle memtable flush failure\n\n- If the memtable flush is failed previously then\nfor the next addEntry call it will try to flush the\nexisting snapshot\n\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #92 from reddycharan/handlememtableflushfailure\n","Date":"Wed Dec 21 01:48:48 CET 2016"},{"Commit-ID":"commit a6a463591a823bd930aa8b921b17cef70ea445c1 1482282037 -----sp","Author":"PersonIdent[Xi Liu, xiliuant@gmail.com, Tue Dec 20 17:00:37 2016 -0800]","Body":"DL-129: Enable checkstyle plugin for distributedlog-protocol module\n\n- add build-tools module for check style configurations\n- fix style problems in distributedlog-protocol\n  * sorted import\n  * fix javadoc\n  * constant static name and static name\n\nAuthor: Xi Liu <xiliuant@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #54 from xiliuant/xi/checkstyle\n","Date":"Wed Dec 21 02:00:37 CET 2016"},{"Commit-ID":"commit ed4d2bff7443f861a288ac3e0d47ec036bc751f2 1482307797 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Dec 21 00:09:57 2016 -0800]","Body":"DL-97: Remove unused methods in BKLogHandler\n\nmerge code change on remove unused methods in BKLogHandler.\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Sijie Guo <sijieg@twitter.com>\nAuthor: Leigh Stewart <lstewart@twitter.com>\nAuthor: Jordan Bull <jbull@twitter.com>\nAuthor: Dave Rusek <dave.rusek@gmail.com>\nAuthor: Dave Rusek <drusek@twitter.com>\n\nReviewers: Leigh Stewart <lstewart@apache.org>\n\nCloses #69 from sijie/merge/DL-97\n","Date":"Wed Dec 21 09:09:57 CET 2016"},{"Commit-ID":"commit f53cbf82758af7f620ecd1506c76801bd0e75c86 1482345628 -----sp","Author":"PersonIdent[eolivelli, eolivelli@gmail.com, Wed Dec 21 10:40:28 2016 -0800]","Body":"BOOKKEEPER-964: Ignore findbugs warnings\n\nAuthor: eolivelli <eolivelli@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #96 from eolivelli/BOOKKEEPER-964-findbugs\n","Date":"Wed Dec 21 19:40:28 CET 2016"},{"Commit-ID":"commit ef4572afa128dabf0607068eadfb6f3e50d43da2 1482857847 -----sp","Author":"PersonIdent[xieliang, xieliang007@gmail.com, Tue Dec 27 08:57:27 2016 -0800]","Body":"DL-145: the write requests should be error out immediately even if the rolling writer still be creating\n\nPassed all test cases locally, now TestDistributedLogService#testServiceTimeout case is stable on my box\n\nAuthor: xieliang <xieliang007@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #78 from xieliang/DL-145\n","Date":"Tue Dec 27 17:57:27 CET 2016"},{"Commit-ID":"commit 3953dfb058ce841c8a23faadfc707ed5995f7b40 1482858300 -----sp","Author":"PersonIdent[xieliang, xieliang007@gmail.com, Tue Dec 27 09:05:00 2016 -0800]","Body":"DL-155: fix flaky TestAsyncReaderLock#testReaderLockMultiReadersScenario\n\nRan the case with changed patch 30 times, all are passed;   and it'll fail w/o patch\n\nAuthor: xieliang <xieliang007@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #88 from xieliang/DL-155\n","Date":"Tue Dec 27 18:05:00 CET 2016"},{"Commit-ID":"commit 30742c0375eb11dd653f92f734aaa478faa6c0cc 1482885943 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Tue Dec 27 16:45:43 2016 -0800]","Body":"DL-150: Ensure namespace path is created for TestZKLogMetadataForWriter\n\nAuthor: Sijie Guo <sijieg@twitter.com>\n\nReviewers: Leigh Stewart <lstewart@apache.org>\n\nCloses #83 from sijie/sijie/FixTestCreateLogMetadata\n","Date":"Wed Dec 28 01:45:43 CET 2016"},{"Commit-ID":"commit ff21a477e2697daa0759d6a3b7daf5354db156df 1482886026 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Tue Dec 27 16:47:06 2016 -0800]","Body":"DL-151: TestBKLogReadHandler#testGetFirstDLSNWithOpenLedger is flaky\n\n- Flush/Commit records only after the data are written\n- Disable immediate flush\n- Reduce num writes from 100 to 10\n\nAuthor: Sijie Guo <sijieg@twitter.com>\n\nReviewers: Leigh Stewart <lstewart@apache.org>\n\nCloses #84 from sijie/sijie/FixTestGetFirstDLSNWithOpenLedger\n","Date":"Wed Dec 28 01:47:06 CET 2016"},{"Commit-ID":"commit fd08cedc7e1e5df4cdf307a1dd615319bdc1bdd6 1483006253 -----sp","Author":"PersonIdent[Yiming Zang, yzang@twitter.com, Wed Dec 28 14:49:50 2016 -0800]","Body":"DL-158: update truncation status for all completed log segments\n\nupdate turncation status for all completed log segments, when purge truncated log segments we will leave one complete log segment.\n","Date":"Wed Dec 28 23:49:50 CET 2016"},{"Commit-ID":"commit a5e892fc1901100e267e6a677261936a87b9d22b 1483006283 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Wed Dec 28 14:51:54 2016 -0800]","Body":"DL-195: ReadAhead Improvement (part 1) - Interface for LogSegmentEntryReader and LogSegmentEntryWriter\n\nCreate interface for log segment entry reader and writer to abstract data write/read operations.\n","Date":"Wed Dec 28 23:51:54 CET 2016"},{"Commit-ID":"commit e2c6bc0d7faa7b7912a51a7a4ed6e1b9ac5653bf 1483006283 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Wed Dec 28 14:51:54 2016 -0800]","Body":"DL-195: ReadAhead Improvement (part 1) - Interface for LogSegmentEntryReader and LogSegmentEntryWriter\n\nCreate interface for log segment entry reader and writer to abstract data write/read operations.\n","Date":"Wed Dec 28 23:51:54 CET 2016"},{"Commit-ID":"commit 714ae49baff3c9f390fb65afa9b8cf801c5a5316 1483006300 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Wed Dec 28 15:09:38 2016 -0800]","Body":"DL-159: ReadAhead Improvement (part 2) - New ReadAhead Reader using the LogSegmentEntryReader interface\n\nProvide a new ReadAhead reader using the log segment entry reader interface. It does reading entries in a batch in parallel for batches, rather than reading entries in batch by batch. This would help mitigate the slow bookie problem.\n\nThe core change is the new ReadAheadEntryReader.\n","Date":"Thu Dec 29 00:09:38 CET 2016"},{"Commit-ID":"commit d7105aa88f29faecd779c4371fb023775e2c7e40 1483006300 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Wed Dec 28 15:09:38 2016 -0800]","Body":"DL-159: ReadAhead Improvement (part 2) - New ReadAhead Reader using the LogSegmentEntryReader interface\n\nProvide a new ReadAhead reader using the log segment entry reader interface. It does reading entries in a batch in parallel for batches, rather than reading entries in batch by batch. This would help mitigate the slow bookie problem.\n\nThe core change is the new ReadAheadEntryReader.\n","Date":"Thu Dec 29 00:09:38 CET 2016"},{"Commit-ID":"commit 590805a487fbfcc3c85c9baf5988106a9037dc2f 1483006324 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Wed Dec 28 16:27:38 2016 -0800]","Body":"DL-160: Remove 'DLSN' suffix from async and sync readers\n","Date":"Thu Dec 29 01:27:38 CET 2016"},{"Commit-ID":"commit 1166e11904ab83ec64e0147998cebffc653bdbf3 1483006345 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Wed Dec 28 16:48:47 2016 -0800]","Body":"DL-161: Rename ledger id to log segment id\n\nAlong with providing log segment store related interfaces, clean up the naming from 'ledger id' to 'log segment id'. So it would become clear when we can plugin different log segment store.\n","Date":"Thu Dec 29 01:48:47 CET 2016"},{"Commit-ID":"commit a83b233a79300c0bf1b3dcac0a24fef628ad48f8 1483006382 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Wed Dec 28 17:09:57 2016 -0800]","Body":"DL-162: Use log segment entry store interface\n\n- Use log segment entry store interface\n- Delete the old readahead implementation\n","Date":"Thu Dec 29 02:09:57 CET 2016"},{"Commit-ID":"commit d15bc06466e345651f53ef7a7f5a771ac4880446 1483006410 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Wed Dec 28 17:47:12 2016 -0800]","Body":"DL-163: clean up direct zookeeper and bookkeeper usage and use metadata/data store abstraction\n\n- introduce NamespaceDriver class to manage metadata/data store abstractions\n- clean up direct zookeeper and bookkeeper usage and use metadata/data store abstraction\n- separate MetadataAccessor from DistributedLogManager\n- remove deprecated classes\n","Date":"Thu Dec 29 02:47:12 CET 2016"},{"Commit-ID":"commit da6cd40e0864548b94fee3fed63549026e446dd9 1483006442 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Wed Dec 28 19:09:59 2016 -0800]","Body":"DL-164: Create stream operation should not be submitted by StreamImpl\n","Date":"Thu Dec 29 04:09:59 CET 2016"},{"Commit-ID":"commit aa60a4e830183f6d9a61ab9100cf845712e281b7 1482994008 -----sp","Author":"PersonIdent[Leigh Stewart, agrodellic@gmail.com, Wed Dec 28 22:46:48 2016 -0800]","Body":"DL-114: Add namespace watch tool\n\nPort simple namespace watch tool from downstream\n\nAuthor: Leigh Stewart <agrodellic@gmail.com>\nAuthor: Leigh Stewart <lstewart@twitter.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #80 from leighst/lstewart/dlog/watch_tool\n","Date":"Thu Dec 29 07:46:48 CET 2016"},{"Commit-ID":"commit c7e78df8b7555b3a57f69ffbdff3072d29b8e024 1483519316 -----sp","Author":"PersonIdent[xieliang, xieliang007@gmail.com, Wed Jan 4 00:41:56 2017 -0800]","Body":"DL-140: Fix distributedlog-core findbug inconsistent synchronization warings\n\nAuthor: xieliang <xieliang007@gmail.com>\n\nReviewers: Leigh Stewart <lstewart@apache.org>\n\nCloses #71 from xieliang/DL-140\n","Date":"Wed Jan 04 09:41:56 CET 2017"},{"Commit-ID":"commit ef1ca0e73e8ca832dabc46497058aeda6ca6b537 1483574941 -----sp","Author":"PersonIdent[xieliang, xieliang007@gmail.com, Wed Jan 4 16:09:01 2017 -0800]","Body":"DL-165: Add TestTimedOutTestsListener to dump timed out cases thread dump\n\nAuthor: xieliang <xieliang007@gmail.com>\n\nReviewers: Leigh Stewart <lstewart@apache.org>\n\nCloses #91 from xieliang/DL-165-TimedOutTestsListener\n","Date":"Thu Jan 05 01:09:01 CET 2017"},{"Commit-ID":"commit 3319bc0231f27322f2008c326e0256c90e799f67 1483574941 -----sp","Author":"PersonIdent[xieliang, xieliang007@gmail.com, Wed Jan 4 16:09:01 2017 -0800]","Body":"DL-165: Add TestTimedOutTestsListener to dump timed out cases thread dump\n\nAuthor: xieliang <xieliang007@gmail.com>\n\nReviewers: Leigh Stewart <lstewart@apache.org>\n\nCloses #91 from xieliang/DL-165-TimedOutTestsListener\n","Date":"Thu Jan 05 01:09:01 CET 2017"},{"Commit-ID":"commit e0e819b015b4e2910ac267321123cdbfd0f71fd0 1483577179 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Wed Jan 4 16:44:15 2017 -0800]","Body":"DL-4: Repackage the source under apache namespace\n","Date":"Thu Jan 05 01:44:15 CET 2017"},{"Commit-ID":"commit 817989ce704261be588d33ff952719706599b6c6 1483577179 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Wed Jan 4 16:44:15 2017 -0800]","Body":"DL-4: Repackage the source under apache namespace\n","Date":"Thu Jan 05 01:44:15 CET 2017"},{"Commit-ID":"commit 6cd251227258da58b2ab5d6ebffc620431e04b92 1483749032 -----sp","Author":"PersonIdent[xieliang, xieliang007@gmail.com, Fri Jan 6 16:30:32 2017 -0800]","Body":"DL-171: adding a short sleep to let the WriteCompleteListener have time to run before the final position be requested\n\nonce the \"writer.write\" is done, if \"writer.position()\" be invoked easier than the WriteCompleteListener onSuccess callback, due to the \"synchronized\", the position result will be 0, not the expected 33. we can just add a short sleep to avoid this test issue.\n\nAuthor: xieliang <xieliang007@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #98 from xieliang/DL-171-Fix-TestAppendOnlyStreamWriter\n","Date":"Sat Jan 07 01:30:32 CET 2017"},{"Commit-ID":"commit 361b423a14753a2a8b696fd352115bc87fb9284c 1483750266 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Fri Jan 6 16:51:06 2017 -0800]","Body":"DL-176: Rename the DL artifact from com.twitter to org.apache.distributedlog\n\nAuthor: Sijie Guo <sijieg@twitter.com>\n\nReviewers: Dave Rusek <drusek@apache.org>, Leigh Stewart <lstewart@apache.org>\n\nCloses #102 from sijie/sijie/fix_pom_file_layout\n","Date":"Sat Jan 07 01:51:06 CET 2017"},{"Commit-ID":"commit 9d1f3bdfd01fdb3f003120d33aa5e5655fefb768 1483750266 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Fri Jan 6 16:51:06 2017 -0800]","Body":"DL-176: Rename the DL artifact from com.twitter to org.apache.distributedlog\n\nAuthor: Sijie Guo <sijieg@twitter.com>\n\nReviewers: Dave Rusek <drusek@apache.org>, Leigh Stewart <lstewart@apache.org>\n\nCloses #102 from sijie/sijie/fix_pom_file_layout\n","Date":"Sat Jan 07 01:51:06 CET 2017"},{"Commit-ID":"commit 4b6c849f1b19571f3b38db71ae520b2b39cd5438 1483912895 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Sun Jan 8 14:01:35 2017 -0800]","Body":"DL-83: Add javadoc to website\n\n- update the javadoc plugin to aggregate api by 'core library' and 'proxy service'. (turn some java class to package private and delete unused files. so they won't appear in java doc)\n- improve the website build script to include javadoc\n- update some readme files to include user mail list and slack channel\n\nAuthor: Sijie Guo <sijieg@twitter.com>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Leigh Stewart <lstewart@apache.org>\n\nCloses #96 from sijie/sijie/merge_website_script\n","Date":"Sun Jan 08 23:01:35 CET 2017"},{"Commit-ID":"commit 965c82de9f22f66b2cde9dc03e14137e87145656 1483912895 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Sun Jan 8 14:01:35 2017 -0800]","Body":"DL-83: Add javadoc to website\n\n- update the javadoc plugin to aggregate api by 'core library' and 'proxy service'. (turn some java class to package private and delete unused files. so they won't appear in java doc)\n- improve the website build script to include javadoc\n- update some readme files to include user mail list and slack channel\n\nAuthor: Sijie Guo <sijieg@twitter.com>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Leigh Stewart <lstewart@apache.org>\n\nCloses #96 from sijie/sijie/merge_website_script\n","Date":"Sun Jan 08 23:01:35 CET 2017"},{"Commit-ID":"commit c248f9dbbc87bddb087fe7b3012772049241636a 1483912993 -----sp","Author":"PersonIdent[adamtracymartin, atmartin@yahoo.com, Sun Jan 8 14:03:13 2017 -0800]","Body":"DL-28: changed // comments to /* */\n\nAuthor: adamtracymartin <atmartin@yahoo.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #100 from adamtracymartin/DL-28\n","Date":"Sun Jan 08 23:03:13 CET 2017"},{"Commit-ID":"commit 9bfb2a2d52dfd2f8890049accf96f3fa4f79878c 1483913437 -----sp","Author":"PersonIdent[Gerrit Sundaram, gerritsundaram@gmail.com, Sun Jan 8 14:10:37 2017 -0800]","Body":"DL-170: All dependency versions should be defined in the parent pom\n\nmake all dependencies' version be defined in the parent pom file.\n\nAuthor: Gerrit Sundaram <gerritsundaram@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #97 from gerritsundaram/DL-170\n","Date":"Sun Jan 08 23:10:37 CET 2017"},{"Commit-ID":"commit 8ba3c921f1b650df6e1f924f2e4a0bd7d5acdfa8 1483913437 -----sp","Author":"PersonIdent[Gerrit Sundaram, gerritsundaram@gmail.com, Sun Jan 8 14:10:37 2017 -0800]","Body":"DL-170: All dependency versions should be defined in the parent pom\n\nmake all dependencies' version be defined in the parent pom file.\n\nAuthor: Gerrit Sundaram <gerritsundaram@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #97 from gerritsundaram/DL-170\n","Date":"Sun Jan 08 23:10:37 CET 2017"},{"Commit-ID":"commit c3077c499489e114ef17bfd31afc5509387d664e 1483915562 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Sun Jan 8 14:46:02 2017 -0800]","Body":"Remove Xlint compiler arguments for building release\n","Date":"Sun Jan 08 23:46:02 CET 2017"},{"Commit-ID":"commit b7d28756c5be788ac7819dbeb5e7d8d92e920afb 1483915609 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Sun Jan 8 14:46:49 2017 -0800]","Body":"[maven-release-plugin] prepare branch release-0.4.0-incubating\n","Date":"Sun Jan 08 23:46:49 CET 2017"},{"Commit-ID":"commit eeb96c180b1b53d6608b13cf7077e3006ffdcb47 1483915609 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Sun Jan 8 14:46:49 2017 -0800]","Body":"[maven-release-plugin] prepare branch release-0.4.0-incubating\n","Date":"Sun Jan 08 23:46:49 CET 2017"},{"Commit-ID":"commit a1e1bb1fc016a99c383bc9f20220342ac2ee5561 1483915613 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Sun Jan 8 14:46:53 2017 -0800]","Body":"[maven-release-plugin] prepare for next development iteration\n","Date":"Sun Jan 08 23:46:53 CET 2017"},{"Commit-ID":"commit 5548c21dff62d544a0035f0cbb3cc59e385a4bd5 1483915613 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Sun Jan 8 14:46:53 2017 -0800]","Body":"[maven-release-plugin] prepare for next development iteration\n","Date":"Sun Jan 08 23:46:53 CET 2017"},{"Commit-ID":"commit 90e09af0fbfa6f05106e07ac8833be26abfa3f9a 1484113542 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jan 10 21:45:42 2017 -0800]","Body":"Fix the script to make sure binary package can execute scripts correctly\n\n- fix the release jar path\n- copy the common script to each modules otherwise the built package won't be able to execute\n- change the type of runner and copy the runner script to each tutorial module\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <zhaijia@apache.org>\n\nCloses #111 from sijie/sijie/copy_all_scripts_to_modules\n","Date":"Wed Jan 11 06:45:42 CET 2017"},{"Commit-ID":"commit 15d6f600e7158e2eecb0ae7231455305e5d1ceaa 1484116499 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Tue Jan 10 22:34:59 2017 -0800]","Body":"BOOKKEEPER-992: ReadLog Command Enhancement\n\n- Take arguments lid and eid and prints just that entry\n- Take arguments of position range and print entries\nwhich are located in that position range\n\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #102 from reddycharan/readlogcommand\n","Date":"Wed Jan 11 07:34:59 CET 2017"},{"Commit-ID":"commit 0fbb98b3629df18518ab6b2298bdd6fe5f19af7e 1484116675 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Tue Jan 10 22:37:55 2017 -0800]","Body":"BOOKKEEPER-991: Get list of disk files\n\nBKShell Command for\nGetting list of DiskFiles -\nJournals/EntryLogs/IndexFiles\n\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #100 from reddycharan/listfilesondisc\n","Date":"Wed Jan 11 07:37:55 CET 2017"},{"Commit-ID":"commit 43971c3b9e4a9ac37ee07b398ed5506e040f9310 1484116881 -----sp","Author":"PersonIdent[eolivelli, eolivelli@gmail.com, Tue Jan 10 22:41:21 2017 -0800]","Body":"BOOKKEEPER-943: Reduce log level of AbstractZkLedgerManager\n\nJust change from \"info\" to \"debug\"\n\nAuthor: eolivelli <eolivelli@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #98 from eolivelli/BOOKKEEPER-943-reduce-logs\n","Date":"Wed Jan 11 07:41:21 CET 2017"},{"Commit-ID":"commit ca7e5fd80662745e7f64ee8f70c66dc9734f6e3a 1485808261 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Mon Jan 30 12:31:01 2017 -0800]","Body":"BOOKKEEPER-907: EntryFormatter should be configured\n\nfor ReadLedgerEntriesCmd, EntryFormatter should\nbe configurable and HexDumpEntryFormatter should\nbe one of them.\n\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #101 from reddycharan/entryformatter\n","Date":"Mon Jan 30 21:31:01 CET 2017"},{"Commit-ID":"commit ba5dadcb3e1fa942f2f1a17178fd368c4bd0f0c4 1485815101 -----sp","Author":"PersonIdent[JV, vjujjuri@salesforce.com, Mon Jan 30 14:25:01 2017 -0800]","Body":"BOOKKEEPER-949: Allow entryLog creation for compaction\n\nAllow entryLog creation even when bookie\nis in RO mode for compaction\n\nSigned-off-by: Venkateswararao Jujjuri (JV) <vjujjurisalesforce.com>\nReviewed-by: Andrey Yegorov <ayegorovsalesforce.com>\nReviewed-by: Charan Reddy Guttapalem <cguttapalemsalesforce.com>\n\nAuthor: JV <vjujjuri@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #99 from reddycharan/entrylogcreationforcompaction\n","Date":"Mon Jan 30 23:25:01 CET 2017"},{"Commit-ID":"commit 26b09abb4202362ca37d6944ce75eb2a3309dc3c 1485825089 -----sp","Author":"PersonIdent[Andrey Yegorov, ayegorov@salesforce.com, Mon Jan 30 17:11:29 2017 -0800]","Body":"BOOKKEEPER-968: Entry log flushes at configurable chunks\n\nWith this patch one can configure interval (in bytes) for entry log to flush writes to the disk.\n\nAuthor: Andrey Yegorov <ayegorov@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #77 from dlg99/task/entry-log-flush\n","Date":"Tue Jan 31 02:11:29 CET 2017"},{"Commit-ID":"commit 13d668f2208bf472e4938cfdfd2de912eaa11275 1485825262 -----sp","Author":"PersonIdent[eolivelli, eolivelli@gmail.com, Mon Jan 30 17:14:22 2017 -0800]","Body":"BOOKKEEPER-959: ClientAuthProvider and BookieAuthProvider Public API used Protobuf Shaded classes\n\nThis fix removes the explicit usage of protobuf from ClientAuthProvider and BookieAuthProvider API, since protobuf library is shaded and relocated on the distributed public version of BookKeeper\n\nAuthor: eolivelli <eolivelli@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #67 from eolivelli/BOOKKEEPER-959\n","Date":"Tue Jan 31 02:14:22 CET 2017"},{"Commit-ID":"commit 42e8f1294f206cbe51a6af669cf605833b78bf42 1485826914 -----sp","Author":"PersonIdent[Venkateswara, vjujjuri@salesforce.com, Mon Jan 30 17:41:54 2017 -0800]","Body":" BOOKKEEPER-873 and BOOKKEEPER-553\n\n    BOOKKEEPER-873: CreateLedgerAPI to accept ledgerId\n    Add ledgerCreateAdv with ledgerId interface to Bookkeeper\n    and corresponding Junit tests.\n\n    BOOKKEEPER-553: LongHierarchicalLedgerManager\n    - LongHierarchicalLedgerManager to support 63 bits ledgerid (positive long)\n    - LongHierarchicalLedgerManager splits the generated id into 5 parts (3-4-4-4-4)\n\nAuthor: Venkateswara <vjujjuri@salesforce.com>\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #88 from reddycharan/ledgerhandleadvwithledgerid\n","Date":"Tue Jan 31 02:41:54 CET 2017"},{"Commit-ID":"commit 712d1cb77f53a814bd2f678fcdd1f9c9db637292 1485827549 -----sp","Author":"PersonIdent[xieliang, xieliang007@gmail.com, Mon Jan 30 17:52:29 2017 -0800]","Body":"DL-186: fix common.sh grep bug; kill MultiReader java process as expected\n\nAuthor: xieliang <xieliang007@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #114 from xieliang/DL-186-smoketest\n","Date":"Tue Jan 31 02:52:29 CET 2017"},{"Commit-ID":"commit c813b3d3298586ded02032a57a99d5fc6c974581 1485831708 -----sp","Author":"PersonIdent[JV, vjujjuri@salesforce.com, Mon Jan 30 19:01:48 2017 -0800]","Body":"BOOKKEEPER-874: Explict LAC from Writer to Bookies\n\nIntroduce a new feature for sending explicit LAC to bookies.\nA writable LedgerHandle creates a timer thread to send explicit LACs\nat the intervals specified through configuration paramenter,\nexplicitLacInterval. If this is set to zero, this feature is disabled,\nno timer thread is created.\n\nExplicit LAC is sent only if the client did not get a chance to send\nLAC through piggyback method for \"explicitLacInterval\" time.\nTo implement this, introduced two new protocol messages to the\nBookkeeper protocol -  WRITE_LAC and READ_LAC, in addition to its\ncurrent READ_ENTRY and ADD_ENTRY.\n\nReviewed-by: Charan Reddy Guttapalem <cguttapalemsalesforce.com>\nSigned-off-by: Venkateswararao Jujjuri (JV) <vjujjurisalesforce.com>\nCo-Author : Charan Reddy Guttapalem <cguttapalemsalesforce.com>\n\nAuthor: JV <vjujjuri@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #89 from reddycharan/explicitlacsinglecommit\n","Date":"Tue Jan 31 04:01:48 CET 2017"},{"Commit-ID":"commit 91db1254c1118c4efa1c520f61850a3382f41fff 1485899136 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jan 31 13:45:36 2017 -0800]","Body":"BOOKKEEPER-996: LongHierarchicalLedgerManagerFactory is missing license header\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nCloses #103 from sijie/sijie/fix_rat_issue\n","Date":"Tue Jan 31 22:45:36 CET 2017"},{"Commit-ID":"commit 123eccd435a4a96a9147ed4a24efbe9025fe79ba 1490219686 -----sp","Author":"PersonIdent[Govind Menon, govindappumenon@gmail.com, Wed Mar 22 14:54:46 2017 -0700]","Body":"BOOKKEEPER-1009: Use multiple journals in bookie\n\nMostly https://github.com/apache/bookkeeper/pull/71 with comments addressed\n\nWill shortly add tests.\n\nmerlimat  Would it be ok to close 71?\n\nAuthor: Govind Menon <govindappumenon@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nCloses #115 from govind-menon/BOOKKEEPER-1009_B\n","Date":"Wed Mar 22 22:54:46 CET 2017"},{"Commit-ID":"commit 28c264c8655f74e09ceee5ad499942cfb0dc65dc 1490226486 -----sp","Author":"PersonIdent[Robert (Bobby) Evans, evans@yahoo-inc.com, Wed Mar 22 16:48:06 2017 -0700]","Body":"BOOKKEEPER-998: Increased the max entry size to 5MB\n\nFull disclosure, most of these changes were actually done by merlimat For this I am mostly just putting them back into open source.\n\nAuthor: Robert (Bobby) Evans <evans@yahoo-inc.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Venkateswararao Jujjuri (JV) <None>\n\nCloses #104 from revans2/BOOKKEEPER-998\n","Date":"Thu Mar 23 00:48:06 CET 2017"},{"Commit-ID":"commit 32ebf0ad68f85daffdec571e28206339a4d09443 1490226708 -----sp","Author":"PersonIdent[Robert (Bobby) Evans, evans@yahoo-inc.com, Wed Mar 22 16:51:48 2017 -0700]","Body":"BOOKKEEPER-999: Stop leaking threads in BookKeeper client\n\nAuthor: Robert (Bobby) Evans <evans@yahoo-inc.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <zhaijia03@gmail.com>, Kai S <None>, Venkateswararao Jujjuri (JV) <None>\n\nCloses #105 from revans2/BOOKKEEPER-999\n","Date":"Thu Mar 23 00:51:48 CET 2017"},{"Commit-ID":"commit f3671fc9f588c7a53a9b3cdd520580c45dae06e3 1490226882 -----sp","Author":"PersonIdent[Kishor Patil, kpatil@yahoo-inc.com, Wed Mar 22 16:54:42 2017 -0700]","Body":"BOOKKEEPER-1003: Fix TestDiskChecker so it can be used on /dev/shm\n\nThe test generates a threshold which is negative if used on a disk where\nthe usable disk size is very close to the total disk size. A negative\nthreshold is invalid so the test fails in the wrong way. This fix stops\nthe threshold from going negative.\n\nFull disclosure, most of these changes were actually done by ivankelly  For this I am mostly just putting them back into open source.\n\nAuthor: Kishor Patil <kpatil@yahoo-inc.com>\n\nReviewers: Venkateswararao Jujjuri (JV) <vjujjuri@salesforce.com>, Sijie Guo <sijie@apache.org>\n\nCloses #107 from kishorvpatil/BOOKKEEPER-1003\n","Date":"Thu Mar 23 00:54:42 CET 2017"},{"Commit-ID":"commit f20568eaa25e0efe6926ede9030a210382e3005b 1490227193 -----sp","Author":"PersonIdent[eolivelli, eolivelli@gmail.com, Wed Mar 22 16:59:53 2017 -0700]","Body":"BOOKKEEPER-1007: Explicit LAC: make the interval configurable in ms\n\nAuthor: eolivelli <eolivelli@gmail.com>\n\nReviewers: Robert (Bobby) Evans <None>, Venkateswararao Jujjuri (JV) <None>, Sijie Guo <sijie@apache.org>\n\nCloses #111 from eolivelli/BOOKKEEPER-1007-explicitlac-ms\n","Date":"Thu Mar 23 00:59:53 CET 2017"},{"Commit-ID":"commit b2285e64df3258dbab1d84687118cbdc041891d8 1490239639 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Mar 22 23:27:19 2017 -0400]","Body":"DL-191: Fix license header issues\n\nthe copyright year is wrong.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Leigh Stewart <lstewart@apache.org>, Flavio Junqueira <fpj@apache.org>\n\nCloses #121 from sijie/sijie/fix_license_header\n","Date":"Thu Mar 23 04:27:19 CET 2017"},{"Commit-ID":"commit 3d3340be7d754af1738a117ee07e3bed04ec5547 1490280912 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Mar 23 10:55:12 2017 -0400]","Body":"BOOKKEEPER-1013: Fix findbugs errors on latest master\n\n- 100% synchronization on _explicitLac_ on FileInfo\n- 100% synchronization on _length_ on LedgerHandle\n- fixed the print format issue on journal dir names array\n- fix checkpointsource list hashCode, equals()\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nCloses #118 from sijie/sijie/bk_1013\n","Date":"Thu Mar 23 15:55:12 CET 2017"},{"Commit-ID":"commit 986110c4d03a38db81c166216cf4db81a9cb5cb7 1490281088 -----sp","Author":"PersonIdent[Francesco Caliumi - Diennea, francesco.caliumi@diennea.com, Thu Mar 23 10:58:08 2017 -0400]","Body":"BOOKKEEPER-1001: Make LocalBookiesRegistry.isLocalBookie() public\n\nAuthor: Francesco Caliumi - Diennea <francesco.caliumi@diennea.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Venkateswararao Jujjuri (JV) <None>, Sijie Guo <sijie@apache.org>\n\nCloses #106 from caiok/BOOKKEEPER-1001\n","Date":"Thu Mar 23 15:58:08 CET 2017"},{"Commit-ID":"commit 1e4ccaf167936fb4ad0de8c29ecf840bed3e89ed 1490281141 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Mar 23 10:59:01 2017 -0400]","Body":"BOOKKEEPER-970: Bump the zookeeper version to 3.5\n\nin DL, we need to leverage the asynchronous version of 'multi' in zookeeper. so this jira is to bump the zookeeper version to 3.5 to support async multi.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nCloses #79 from sijie/sijie/bump_zookeeper_version\n","Date":"Thu Mar 23 15:59:01 CET 2017"},{"Commit-ID":"commit 03c53f514867dac06d72ec587827b22acb457d73 1490684987 -----sp","Author":"PersonIdent[xieliang, xieliang007@gmail.com, Tue Mar 28 00:09:47 2017 -0700]","Body":"DL-184: reduce server_graceful_shutdown_period_ms from 35s to 20s, which is smaller than the default daemon stop timeout value\n\nAuthor: xieliang <xieliang007@gmail.com>\n\nReviewers: Leigh Stewart <lstewart@apache.org>, Sijie Guo <sijie@apache.org>\n\nCloses #115 from xieliang/DL-184-graceful\n","Date":"Tue Mar 28 09:09:47 CEST 2017"},{"Commit-ID":"commit 0583175de72446d00088611000310b000e8e61df 1490733330 -----sp","Author":"PersonIdent[Rithin, rithin.shetty@salesforce.com, Tue Mar 28 13:35:30 2017 -0700]","Body":"BOOKKEEPER-950: Ledger placement policy to accomodate different storage capacity of bookies\n\n\u2026ge capacity of bookies\n\nThis change introduces Disk weight based ledger placement. Currently free disk space is the only supported\nweight for a bookie. This change also introduces a new protocol message between bk client and server\ncalled GET_BOOKIE_INFO. This message is used by the client to retrieve the free disk space info from\nall the bookies. The existing placement policies: DefaultPlacementPolicy and RackAwarePlacementPolicy\nhave been enhanced to make use of the weight while selecting bookies. New test cases have been added to\ntest RackawarePlacement with weights. A new test class has been added to test the weight based selection\nalgorithm in a stand alone fashion.\n\nAuthor: Rithin <rithin.shetty@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nCloses #93 from rithin-shetty/weightBasedPlacementDec13\n","Date":"Tue Mar 28 22:35:30 CEST 2017"},{"Commit-ID":"commit bf8ef14bc1bfdde6c6c8edcd7f380b4beca023f6 1490733436 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Mar 28 13:37:16 2017 -0700]","Body":"BOOKKEEPER-852: Release LedgerDescriptor and master-key objects when not used anymore\n\nMaps with ledger descriptors and master-keys are not cleaned after a ledger gets deleted.\n\nFor this PR, please only take a look at the last commit 18e3455. The other 2 commits are already in separate PRs. I'll rebase this PR once they'll get merged.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #78 from merlimat/bk-ledger-descriptor\n","Date":"Tue Mar 28 22:37:16 CEST 2017"},{"Commit-ID":"commit 825e0e7b4a27730d85afbe823a405ba333de3a65 1490733562 -----sp","Author":"PersonIdent[Govind Menon, govindappumenon@gmail.com, Tue Mar 28 13:39:22 2017 -0700]","Body":"BOOKKEEPER-1004: Allow bookie garbage collection to be triggered manu\u2026\n\nRan CompactionTest#testForceGarbageCollection\n\nAuthor: Govind Menon <govindappumenon@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nCloses #109 from govind-menon/BOOKKEEPER-1004\n","Date":"Tue Mar 28 22:39:22 CEST 2017"},{"Commit-ID":"commit b30b527ba995978694ebf735c02b508374001021 1490733635 -----sp","Author":"PersonIdent[eolivelli, eolivelli@gmail.com, Tue Mar 28 13:40:35 2017 -0700]","Body":"BOOKKEEPER-390: Provide support for ZooKeeper authentication\n\nAuthor: eolivelli <eolivelli@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #76 from eolivelli/BOOKKEEPER-390\n","Date":"Tue Mar 28 22:40:35 CEST 2017"},{"Commit-ID":"commit 9836c87dc2c082c46692d60c60cf9e23c7b0b06c 1491238660 -----sp","Author":"PersonIdent[eolivelli, eolivelli@apache.org, Mon Apr 3 09:57:40 2017 -0700]","Body":"BOOKKEEPER-1020: Fix Explicit LAC tests on master\n\nAuthor: eolivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>, Robert (Bobby) Evans <evans@yahoo-inc.com>\n\nCloses #122 from eolivelli/BOOKKEEPER-1020-fix-explicitlac-test\n","Date":"Mon Apr 03 18:57:40 CEST 2017"},{"Commit-ID":"commit 9001e300ce0d5d2655d437e3eaa52f91487caed6 1491247907 -----sp","Author":"PersonIdent[Govind Menon, govindappumenon@gmail.com, Mon Apr 3 12:31:47 2017 -0700]","Body":"BOOKKEEPER-1018: Allow client to select older V2 protocol (no protobuf)\n\nOriginally done by Matteo Merli (merlimat). Tagging sijie and eolivelli  for review.\n\nAuthor: Govind Menon <govindappumenon@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #120 from govind-menon/BOOKKEEPER-1018\n","Date":"Mon Apr 03 21:31:47 CEST 2017"},{"Commit-ID":"commit f30f60889e0810a47797daf4107c0d9bc2ee998c 1491268927 -----sp","Author":"PersonIdent[Govind Menon, govindappumenon@gmail.com, Mon Apr 3 18:22:07 2017 -0700]","Body":"BOOKKEEPER-1018: Revert \": Allow client to select older V2 protocol (no\u2026\n\n\u2026 protobuf)\"\n\nThis reverts commit 9001e300ce0d5d2655d437e3eaa52f91487caed6.\n\nI broke trunk - not exactly sure how - I will fix it and put up the PR again. For now I'm reverting the commit.\n\nAuthor: Govind Menon <govindappumenon@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #124 from govind-menon/BOOKKEEPER-1018-Revert\n","Date":"Tue Apr 04 03:22:07 CEST 2017"},{"Commit-ID":"commit ab707d2c6b3251b2a9a30a6d14074704460b3da5 1491892117 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Apr 10 23:28:37 2017 -0700]","Body":"BOOKKEEPER-1021: Improve merge script to handle github reviews api\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Govind Menon <None>\n\nCloses #123 from sijie/sijie/improve_merge_scripts\n","Date":"Tue Apr 11 08:28:37 CEST 2017"},{"Commit-ID":"commit 48aa69dd0ba41f5ba7bb2b04f31172c919be4391 1491934459 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Tue Apr 11 11:14:19 2017 -0700]","Body":"BOOKKEEPER-1031: close the ledger handle in ReplicationWorker.rereplicate\n\n\u2026cate\n\nOtherwise, we build up an unbounded set of Listeners in the\nAbstractZkLedgerManager listenerSet structure which never go\naway.\n\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nCloses #130 from athanatos/forupstream/BOOKKEEPER-1031\n","Date":"Tue Apr 11 20:14:19 CEST 2017"},{"Commit-ID":"commit 0f155f38bb48d23aab4ac8489f7908925b8f0cca 1491934519 -----sp","Author":"PersonIdent[Matteo Merli, matteo.merli@gmail.com, Tue Apr 11 11:15:19 2017 -0700]","Body":"BOOKEEPER-1002: Limiting the number of open files to avoid process max\n\nAuthor: Matteo Merli <matteo.merli@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nCloses #129 from kishorvpatil/bk1002\n","Date":"Tue Apr 11 20:15:19 CEST 2017"},{"Commit-ID":"commit 12bb13cdb1feca0fa6739f8e6287c326fb5fdb94 1491934762 -----sp","Author":"PersonIdent[eolivelli, eolivelli@apache.org, Tue Apr 11 11:19:22 2017 -0700]","Body":"BOOKKEEPER-1022: Make BookKeeperAdmin implement AutoCloseable\n\nAuthor: eolivelli <eolivelli@apache.org>\n\nReviewers: Robert (Bobby) Evans <None>, Sijie Guo <sijie@apache.org>, Matteo Merli <mmerli@apache.org>\n\nCloses #128 from eolivelli/BOOKKEEPER-1022-bkadmin-autocloseable\n","Date":"Tue Apr 11 20:19:22 CEST 2017"},{"Commit-ID":"commit 24fae0322327d8fd75c30524546924f27e278448 1491934829 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Apr 11 11:20:29 2017 -0700]","Body":"BOOKKEEPER-997: Wire protocol change for supporting long poll\n\nadding fields in ReadRequest to support piggying back lac on read responses and support long poll requests.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nCloses #125 from sijie/longpoll/part0_wire_protocol_changes\n","Date":"Tue Apr 11 20:20:29 CEST 2017"},{"Commit-ID":"commit 0dd0e4fe0ae29dec3864e7539144a6ffca64df19 1492055651 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Apr 12 20:54:11 2017 -0700]","Body":"DL-196: Remove 'Copyright 2017 The Apache Software Foundation' from license header\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <zhaijia03@gmail.com>\n\nCloses #126 from sijie/sijie/fix_license_headers\n","Date":"Thu Apr 13 05:54:11 CEST 2017"},{"Commit-ID":"commit ba3505e60f83f8f99c480414a56dd6dec25a832b 1492058179 -----sp","Author":"PersonIdent[adamtracymartin, atmartin@yahoo.com, Wed Apr 12 21:36:19 2017 -0700]","Body":"DL-173: changed FileUtils.deleteDirectory to FileUtils.forceDeleteOnExit so d\u2026\n\nI am doing a new pull request because I deleted the branch in the remote.\nActions done to fix the conflict.\n1. git checkout DL-173\n2. git checkout master distributedlog-protocol/src/main/thrift/service.thrift\n3. git fetch\n4. git add *\n5. git commit with message\n\nThe actual fix for this branch is changing FileUtils.deleteDirectory to FileUtils.forceDeleteOnExit.\n\nAuthor: adamtracymartin <atmartin@yahoo.com>\n\nReviewers: Jia Zhai <zhaijia03@gmail.com>, Sijie Guo <sijie@apache.org>, Leigh Stewart <lstewart@apache.org>\n\nCloses #116 from adamtracymartin/DL-173\n","Date":"Thu Apr 13 06:36:19 CEST 2017"},{"Commit-ID":"commit 6a80ebc30244da56bc0e3fc64d02650ddfd6d6cb 1492058312 -----sp","Author":"PersonIdent[adamtracymartin, atmartin@yahoo.com, Wed Apr 12 21:38:32 2017 -0700]","Body":"DL-174: added getParent method to Utils to replace usage of File.getParent which changes / to \\ on Windows\n\n\u2026ich changes / to \\ in Windows.\n\nAuthor: adamtracymartin <atmartin@yahoo.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #104 from adamtracymartin/DL-174\n","Date":"Thu Apr 13 06:38:32 CEST 2017"},{"Commit-ID":"commit f74d07d6b96ba3e6f1270d053fa36676cf680304 1492257514 -----sp","Author":"PersonIdent[Govind Menon, govindappumenon@gmail.com, Sat Apr 15 13:58:34 2017 +0200]","Body":"BOOKKEEPER-1018: Allow client to select older V2 protocol (no protobuf)\n\nTested manually - running all tests locally. Will tag contributors. when ready for review (for now putting up to test via Screwdriver and manual review)\n\nAuthor: Govind Menon <govindappumenon@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nCloses #126 from govind-menon/BOOKKEEPER-1018\n","Date":"Sat Apr 15 13:58:34 CEST 2017"},{"Commit-ID":"commit de59bd2ad038428cfa61cfdefe1266f3356e1937 1492538373 -----sp","Author":"PersonIdent[eolivelli, eolivelli@apache.org, Tue Apr 18 10:59:33 2017 -0700]","Body":"BOOKKEEPER-1039: bk-merge-pr.py ask to run findbugs and rat before merge\n\nAdd the ability to optionally run findbugs and apache RAT before every merge using the PR merge script\n\nAuthor: eolivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #132 from eolivelli/BOOKKEEPER-1039-merge-findbugs\n","Date":"Tue Apr 18 19:59:33 CEST 2017"},{"Commit-ID":"commit 83d5d9e2a51c8c135bfc97d3831beccebe11a69a 1492710916 -----sp","Author":"PersonIdent[eolivelli, eolivelli@apache.org, Thu Apr 20 10:55:16 2017 -0700]","Body":"BOOKKEEPER-1038: Fix findbugs warnings and upgrade to 3.0.4\n\n- upgrade to findbugs 3.0.4\n- fix DLS_DEAD_LOCAL_STORE At BookieInfoReader.java (introduce a constant)\n- fix EQ_OVERRIDING_EQUALS_NOT_SYMMETRIC At PerChannelBookieClient.java (introduce a V3CompletionKey)\n\nAuthor: eolivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #131 from eolivelli/BOOKKEEPER-1038-findbugs\n","Date":"Thu Apr 20 19:55:16 CEST 2017"},{"Commit-ID":"commit c94bbbacd7dcf369c51480a21ad8e55f1af4c9a6 1493037006 -----sp","Author":"PersonIdent[eolivelli, eolivelli@apache.org, Mon Apr 24 14:30:06 2017 +0200]","Body":"BOOKKEEPER-1043: Upgrade Apache Parent Pom Reference to latest version\n\nAuthor: eolivelli <eolivelli@apache.org>\n\nReviewers: Ivan Kelly <ivan@ivankelly.net>\n\nCloses #133 from eolivelli/BOOKKEEPER-1043-upgrade-pom\n","Date":"Mon Apr 24 14:30:06 CEST 2017"},{"Commit-ID":"commit c72ff5efbfaa21cbc95c21f89692190aa52a5a29 1493668522 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Mon May 1 21:55:22 2017 +0200]","Body":"BOOKKEEPER-1042: Deploy SNAPSHOTS of master to public Apache Repository\n\nMake all pom.xml files have a -SNAPSHOT version.\n\nCurrently we have the 'compats' subprojects which have a strange versioning scheme.\nActual versioning scheme for that poms will clash will other versions of the project, because they are fixed and do not depend on the common parent pom.\n\nChanging the version will make the build more reproducible and it is a prerequisite for the deployment of -SNAPSHOT version to the official Apache Snapshots Repository\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>, Sijie Guo <sijie@apache.org>\n\nCloses #134 from eolivelli/BOOKKEEPER-1042-pom-for-snapshots\n","Date":"Mon May 01 21:55:22 CEST 2017"},{"Commit-ID":"commit 9c79e078b8cfefc24251aefcb727760fb99229ed 1493755644 -----sp","Author":"PersonIdent[eolivelli, eolivelli@apache.org, Tue May 2 22:07:24 2017 +0200]","Body":"BOOKKEEPER-1019: Support for reading entries after LAC\n\nThis patch introduces a new client-side configuration option to allow reads outside the boundary of the local LastAddConfirmed value.\n\nAuthor: eolivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>, Matteo Merli <mmerli@apache.org>\n\nCloses #121 from eolivelli/BOOKKEEPER-1019-read-after-lac\n","Date":"Tue May 02 22:07:24 CEST 2017"},{"Commit-ID":"commit 057af8dbce6c08794eb8b46ca52ca13f222d9bbb 1493759097 -----sp","Author":"PersonIdent[Kyle Nusbaum, knusbaum@yahoo-inc.com, Tue May 2 14:04:57 2017 -0700]","Body":"BOOKKEEPER-552: 64 Bits Ledger ID Generation\n\nThis PR supersedes #112\n\nInstead of moving LongHierarchicalLedgerManager to HierarchicalLedgerManager, LongHierarchicalLedgerManager is still a stand-alone manager. HierarchicalLedgerManager has been moved to LegacyHierarchicalLedgerManager, and a new HierarchicalLedgerManager class has been put in its place, which is backwards-compatible with the original (now legacy) HierarchicalLedgerManager.\n\nThis new HierarchicalLedgerManager leverages the new LongZkLedgerIdGenerator to generate Ids, and uses the LongHierarchicalLedgerManager to manage metadata for ledger IDs > 31 bits long. For shorter ledger ids, the LegacyHierarchicalLedgerManager is used, to keep backwards-compatibility.\n\nAuthor: Kyle Nusbaum <knusbaum@yahoo-inc.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nCloses #114 from knusbaum/BOOKKEEPER-552\n","Date":"Tue May 02 23:04:57 CEST 2017"},{"Commit-ID":"commit 5d282dceae140577b97a12db5b2b531c7d84e985 1493886464 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu May 4 10:27:44 2017 +0200]","Body":"BOOKKEEPER-1045: Execute tests in different JVM processes\n\nThe current Maven Surefire configuration is using:\n```xml\n<forkMode>always<\/forkMode>\n```\n\nThis is a deprecated config and apparently it's not creating new processes for each test as intended.\n\nCurrently the tests are leaking a big number of files and threads due to several reasons:\n * Tests that instantiate bookies and call shutdown() without calling start() before are creating and initializing the ledger storage but not closing it, leaking threads and several fds\n  * ZooKeeperClient sometimes doesn't shutdown the zk handle if the test completes too quickly, leaking sockets.\n * Several tests are passing bad config, so the bookie/client start gets exception (on purpose) and then doesn't clean up some partial objects.\n * ...\n\nThat make running the test suite to be dependent on ulimit of the machine.\n\nUntil we can fix (almost) all the test to do proper cleanup, we should make maven to run tests in separated processes.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli<eolivelli@apache.org>, Jia Zhai <zhaijia@apache.org>\n\nCloses #135 from merlimat/bk-1045-test-forks\n","Date":"Thu May 04 10:27:44 CEST 2017"},{"Commit-ID":"commit 25c113f62a40bff6ff91cf82f699fd1d35b102fb 1493924053 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@yahoo-inc.com, Thu May 4 20:54:13 2017 +0200]","Body":"BOOKKEEPER-1046: Avoid long to Long conversion in OrderedSafeExecutor task submit\n\nWhen submitting tasks to an OrderedSafeExecutor, most of the time a ledger id is being passed. Given that the method accepts and Object, the primitive `long` is boxed into a `Long` allocated on the heap.\n\nAdded specific method overload to directly accept longs as the key in the OrderedSafeExecutor.\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>\n\nCloses #136 from merlimat/executor-long-conversion\n","Date":"Thu May 04 20:54:13 CEST 2017"},{"Commit-ID":"commit d5af77c05256d5942c19aff2654c5d8f5ac1eb79 1493924321 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu May 4 20:58:41 2017 +0200]","Body":"BOOKKEEPER-1047: Add missing error code in ZK setData return path\n\nThe log warning is not printing the error code returned by ZooKeeper\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>\n\nCloses #137 from merlimat/missing-error-msg\n","Date":"Thu May 04 20:58:41 CEST 2017"},{"Commit-ID":"commit 61a5446b8923e5ce0b2a46891a385fd480275bac 1494361493 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue May 9 13:24:53 2017 -0700]","Body":"BOOKKEEPER-1050: Cache journalFormatVersionToWrite when starting Journal\n\nReading the journal version format from `ServiceConfiguration` each time is inefficient.\n`ServiceConfiguration` is based on Java properties which is based on a String to object hashtable. Each read implies acquiring a mutex and converting from object to int.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <None>\n\nCloses #140 from merlimat/cache-journal-conf\n","Date":"Tue May 09 22:24:53 CEST 2017"},{"Commit-ID":"commit 1a2e017b65812e6e50975213a365aa37eba9fa96 1494363962 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue May 9 14:06:02 2017 -0700]","Body":"BOOKKEEPER-1051: Fast shutdown for GarbageCollectorThread\n\nSeveral unit tests are taking very long time to complete (eg: `BookieLedgerIndexTest` taking ~10 minutes).\nThe reason is that these tests are playing with the ZK quorum shutting it down and after the test succeeds, the shutdown phase is taking long time, since we try to do graceful shutdown with 1min wait time.\nI think is better to interrupt immediately the garbage collector thread when shutting down the bookie.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <None>\n\nCloses #141 from merlimat/fast-gc-thread-shutdown\n","Date":"Tue May 09 23:06:02 CEST 2017"},{"Commit-ID":"commit 5531014ab1cf282d35d4d53db975192b853bf7a6 1494364065 -----sp","Author":"PersonIdent[Siddharth Boobna, sboobna@yahoo-inc.com, Tue May 9 14:07:45 2017 -0700]","Body":"BOOKKEEPER-1052: Print autorecovery enabled or not in bookie shell\n\nPrint the current status of auto-recovery, whether it's enabled or disabled.\n\nAuthor: Siddharth Boobna <sboobna@yahoo-inc.com>\n\nReviewers: Enrico Olivelli <None>\n\nCloses #142 from merlimat/autorecovery-enabled\n","Date":"Tue May 09 23:07:45 CEST 2017"},{"Commit-ID":"commit d8a7ac310947049f65687e33d92b847c44c91a39 1494379039 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue May 9 18:17:19 2017 -0700]","Body":"BOOKKEEPER-1053: Upgrade RAT maven version to 0.12 and ignore Eclipse project files\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Jia Zhai <None>\n\nCloses #143 from merlimat/rat\n","Date":"Wed May 10 03:17:19 CEST 2017"},{"Commit-ID":"commit af397e2247d453af25db6a1f33426fb9c69e2cdf 1494449222 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed May 10 13:47:02 2017 -0700]","Body":"BOOKKEEPER-1060: Add utility to use SafeRunnable from Java8 Lambda\n\nSince BK-4.5.0 is already switched to Java8, we should have a simple and concise way to pass lambdas where a `SafeRunnable` is required.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <None>\n\nCloses #148 from merlimat/safe-runnable\n","Date":"Wed May 10 22:47:02 CEST 2017"},{"Commit-ID":"commit fc4800544bcd60c66fa682e6ffcbf2789b7fbb74 1494450905 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed May 10 14:15:05 2017 -0700]","Body":"BOOKKEEPER-1059: Upgrade to SLF4J-1.7.25\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <None>\n\nCloses #147 from merlimat/slf4j-1.7\n","Date":"Wed May 10 23:15:05 CEST 2017"},{"Commit-ID":"commit eeaddeda66fc687d20c2309a8cbc109c5dfeed89 1494451063 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed May 10 14:17:43 2017 -0700]","Body":"BOOKKEEPER-1054: Add gitignore file\n\nWe should have a .gitignore file to hide all build generated files.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Jia Zhai <None>\n\nCloses #144 from merlimat/git-ignore\n","Date":"Wed May 10 23:17:43 CEST 2017"},{"Commit-ID":"commit e2894a9e9946b4cc4647c280094bcb2eb1a521ea 1494595056 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri May 12 15:17:36 2017 +0200]","Body":"BOOKKEEPER-1066: Introduce GrowableArrayBlockingQueue\n\nIn multiple places, (eg: journal, ordered executor, etc..), we are using `LinkedBlockingQueue` instances to pass objects between threads.\n\nThe `LinkedBlockingQueue` differs from the `ArrayBlockingQueue` in that it doesn't require to define a max queue size, though, being implemented with a linked list, it requires to allocates list nodes each time an item is added.\n\nWe can use a `GrowableArrayBlockingQueue` that behaves in the same way as the `LinkedBlockingQueue`, but it's implemented with an array that can be resized when the queue reaches the capacity.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>\n\nCloses #153 from merlimat/growable-blocking-queue\n","Date":"Fri May 12 15:17:36 CEST 2017"},{"Commit-ID":"commit d7f7b922f3ea0471452115c6271fd18ab63d3505 1494595231 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri May 12 15:20:31 2017 +0200]","Body":"BOOKKEEPER-1064: ConcurrentModificationException in AuditorLedgerCheckerTest\n\nAs seen in:\nhttps://builds.apache.org/job/bookkeeper-master-git-pullrequest/371/\n\nThe test is iterating over a hash map that gets updated by a different thread. The map needs to be concurrent.\n\n```\njava.util.ConcurrentModificationException\n\tat org.apache.bookkeeper.replication.AuditorLedgerCheckerTest.stopAuditorElectors(AuditorLedgerCheckerTest.java:130)\n\tat org.apache.bookkeeper.replication.AuditorLedgerCheckerTest.tearDown(AuditorLedgerCheckerTest.java:114)\n```\n\nAll subsequent tests in the same class are failing because of the 1st test not cleaning up properly.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>\n\nCloses #151 from merlimat/bk-1064-auditor-ledger-test\n","Date":"Fri May 12 15:20:31 CEST 2017"},{"Commit-ID":"commit 5130d3596f7fb862e38910bf0a0a1dae3ed892e8 1494599944 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@yahoo-inc.com, Fri May 12 16:39:04 2017 +0200]","Body":"BOOKKEEPER-1063: Use executor.execute() instead of submit()\n\n\u2026 creation of unused FutureTask\n\nWhen submitting tasks to an executor, if the `FutureTask` object is not being used we should use `execute()` instead of `submit()` in order to avoid the task object allocation.\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>\n\nCloses #150 from merlimat/executor-execute\n","Date":"Fri May 12 16:39:04 CEST 2017"},{"Commit-ID":"commit 811ece53a1c975c4e768422f3d622ac9de6b3e41 1494869546 -----sp","Author":"PersonIdent[rdhabalia, rdhabalia@yahoo-inc.com, Mon May 15 10:32:26 2017 -0700]","Body":"BOOKKEEPER-1058: Ignore already deleted ledger on replication audit\n\nReplication auditor should skip ledgers that were deleted since the auditing was started.\n\nAuthor: rdhabalia <rdhabalia@yahoo-inc.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nCloses #146 from merlimat/ignore-deleted-ledgers-in-replication\n","Date":"Mon May 15 19:32:26 CEST 2017"},{"Commit-ID":"commit 74f795136c1fff3badb29fc982d0cc2d43096b45 1494870773 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon May 15 10:52:53 2017 -0700]","Body":"BOOKKEEPER-1008: Netty 4.1\n\nAdded more ref-count fixes from yahoo-4.3 branch on top of #116\n\nAuthor: Matteo Merli <mmerli@apache.org>\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\nAuthor: Kishore Kasi Udayashankar <kudayashankar@salesforce.com>\n\nReviewers: Jia Zhai <zhaijia03@gmail.com>, Sijie Guo <sijie@apache.org>\n\nCloses #138 from merlimat/netty-4.1\n","Date":"Mon May 15 19:52:53 CEST 2017"},{"Commit-ID":"commit d863513719b696638e3369f4bbfde9abf5fd3d5f 1494876318 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon May 15 12:25:18 2017 -0700]","Body":"BOOKKEEPER-1067: Add Prometheus stats provider\n\nPrometheus (https://prometheus.io) is a metrics collection system, similar but much more flexible than graphite.\n\nIt would be good to expose the Bookie and BookKeeper client stats directly so that a Prometheus instance can collect them (and also check the process status and add alerts).\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nCloses #154 from merlimat/prometheus\n","Date":"Mon May 15 21:25:18 CEST 2017"},{"Commit-ID":"commit 5d43260e84c6121df72c0ee4c844651bfb726638 1494876926 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon May 15 12:35:26 2017 -0700]","Body":"BOOKKEEPER-1061: BookieWatcher should not do ZK blocking operations from ZK async callback thread\n\nIn some cases, the BookieWatcher can get the ZK event thread stuck. This happens when a ZK blocking request is issued from a ZK callback thread.\n\nWe should decouple the blocking requests in a separate executor to avoid deadlocking ZK client.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nCloses #149 from merlimat/bookie-watcher-thread\n","Date":"Mon May 15 21:35:26 CEST 2017"},{"Commit-ID":"commit 0f81461d2d1dc5cf9db4de9a46599d7d64e3dac6 1494887516 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon May 15 15:31:56 2017 -0700]","Body":"BOOKKEEPER-1048: Use ByteBuf in LedgerStorage interface\n\nTo pass ref-counted buffer from Netty directly to the storage and the Journal, we need to have LedgerStorage to accept ByteBuf instead of ByteBuffer\n\n#### Note\n\nThis commit is on top of BOOKKEEPER-1048 / #138. Once that gets merged, I will rebase. Posting now to get Jenkins run. Please review last commit f53f772f79d0a334edc0f05e66edb7cc645b1ffa in this PR for now.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <None>\n\nCloses #139 from merlimat/bytebuf-in-ledger-storage\n","Date":"Tue May 16 00:31:56 CEST 2017"},{"Commit-ID":"commit e44c7388399e5589cf44e38c58bb84c74da544af 1494933656 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@yahoo-inc.com, Tue May 16 13:20:56 2017 +0200]","Body":"BOOKKEEPER-1069: If client uses V2 proto, set the connection to always decode V2 messages\n\nAvoid handling parsing exception for each request and instead adapt to what the client is sending.\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Enrico Olivelli <None>, Sijie Guo <None>\n\nCloses #157 from merlimat/always-v2\n","Date":"Tue May 16 13:20:56 CEST 2017"},{"Commit-ID":"commit 0f16da8961521372b9bec953ab62c8913bb8dc31 1495004257 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed May 17 08:57:37 2017 +0200]","Body":"BOOKKEEPER-1055: Optimize handling of masterKey in case it is empty\n\nOn each request client and bookies are exchanging the ledger masterKey, which is a 20 bytes MAC digest of the ledger password.\n\nFor each request there is a considerable overhead in allocating byte arrays when parsing the add/read requests.\n\nIf the client is a passing an empty password, we should optimize the data path to skip all allocations (related to the masterKey) and instead rely on a static byte array.\n\nAuthor: Matteo Merli <mmerli@apache.org>\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Venkateswararao Jujjuri (JV) <None>\n\nCloses #156 from merlimat/empty-password\n","Date":"Wed May 17 08:57:37 CEST 2017"},{"Commit-ID":"commit 7da9ed293db87103efcc28b7e706c0b386131ec1 1495117297 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Thu May 18 16:21:37 2017 +0200]","Body":"BOOKKEEPER-1070: bk-merge-pr.py use apache-rat:check goal\n\nAuthor: eolivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>\n\nCloses #158 from eolivelli/BOOKKEEPER-1070-rat\n","Date":"Thu May 18 16:21:37 CEST 2017"},{"Commit-ID":"commit bc973476cbed0fa5bc2e5349c4478f7697c7dadd 1495645723 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu May 25 01:08:43 2017 +0800]","Body":"Remove package-info.java under com.twitter.distributedlog.subscription\n\nThere is still one file left under com.twitter.distributedlog after repackage. This change is to delete this file.\n\nhttps://github.com/apache/incubator-distributedlog/tree/master/distributedlog-core/src/main/java/com/twitter/distributedlog/subscription\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <zhaijia03@gmail.com>\n\nCloses #129 from sijie/sijie/remove_subscription_files\n","Date":"Wed May 24 19:08:43 CEST 2017"},{"Commit-ID":"commit 667390d1a6305c31608130929ba0d68a0b5a4763 1495711864 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Thu May 25 13:31:04 2017 +0200]","Body":"BOOKKEEPER-391: Support Kerberos authentication of bookkeeper\n\nThis patch contains a very basic AuthProvider which uses JAAS and so enables the usage or GSSAPI/Kerberos for BookKeeper authentication\n\nAuthor: eolivelli <eolivelli@apache.org>\nAuthor: eolivelli <eolivelli@gmail.com>\n\nReviewers: Robert (Bobby) Evans <None>, Sijie Guo <None>\n\nCloses #110 from eolivelli/BOOKKEEPER-391-kerberos\n","Date":"Thu May 25 13:31:04 CEST 2017"},{"Commit-ID":"commit 8ba8ab9403dbc464c68caf6e7cd3fc490670731e 1495712249 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu May 25 13:37:29 2017 +0200]","Body":"BOOKKKEEPER-1072: CompactionTest is flaky when disks are almost full\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <None>, Jia Zhai <None>\n\nCloses #159 from sijie/BOOKKEEPER-1072\n","Date":"Thu May 25 13:37:29 CEST 2017"},{"Commit-ID":"commit 7b1eec47092d0de6776c5a89575dbfc678165ee7 1495714983 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@yahoo-inc.com, Thu May 25 14:23:03 2017 +0200]","Body":"BOOKKEEPER-1068: Expose ByteBuf in LedgerEntry to avoid data copy\n\nTo avoid copying the entries payloads when writing/reading on a ledger and having to allocate a lot of `byte[]` on the JVM heap, we need to accept Netty ByteBuf buffer.\n\nBy passing a ByteBuf, an application can use a pooled buffer, pointing to direct memory, to the `LedgerHandle.addEntry()` and have the same buffer forwarded on the connection sockets to the bookies.\n\nThe same thing on the read side, `LedgerEntry` exposes an additional `getEntryBuffer()` method that can be used to get the underlying buffer and possibly forward that to some other connection, with zero-copy behavior (excluding getting data in-out of the kernel).\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Jia Zhai, Sijie Guo, Enrico Olivelli\n\nCloses #155 from merlimat/byte-buf-ledger-entry\n","Date":"Thu May 25 14:23:03 CEST 2017"},{"Commit-ID":"commit 64bedc2f92d5bb17783c6ea2a2db7ea29170f264 1495715517 -----sp","Author":"PersonIdent[Alex Yarmula, ak@twitter.com, Thu May 25 14:31:57 2017 +0200]","Body":"BOOKKEEPER-1075: BK LedgerMetadata: more memory-efficient parsing of configs\n\nIt is the contribution from Alex Yarmula\n\ncommit 9d9d7dd26235a9beda4421b7bed750fea1789076\nAuthor: Alex Yarmula <aktwitter.com>\nDate: Wed Sep 23 05:57:30 2015 -0700\n\nBK LedgerMetadata: more memory-efficient parsing of configs\nLooking at the most prevalent client-side memory allocations, I noticed that we allocate 4KB every time we open a ledger. This is caused by allocating a 4KB buffer (in TextFormat.toStringBuilder) to account for the maximum possible Protobufs message, which is unnecessary in our case: we know the exact size of the metadata ( << 500 B) and don't need to allocate more.\nTextFormat.merge(Readable, Message.Builder) is the current method we use. This changes to use TextFormat.merge(CharSequence, Message.Builder), which avoids the extra 4K allocation conversion + an extra StringBuilder.\n\nRB_ID=745700\n\nAuthor: Alex Yarmula <ak@twitter.com>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli, Sijie Guo\n\nCloses #162 from sijie/bk_ledger_metadata_efficiency\n","Date":"Thu May 25 14:31:57 CEST 2017"},{"Commit-ID":"commit 6698912e4d35119a2e85a6ea3877c6771073489c 1495795108 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Fri May 26 12:38:28 2017 +0200]","Body":"BOOKKEEPER-1077: Allow configuration journal/ledger paths for local bookkeeper.\n\nAuthor: Sijie Guo <sijieg@twitter.com>\nAuthor: Robin Dhamankar <rdhamankar@twitter.com>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>\n\nCloses #163 from sijie/to_string_mark\n","Date":"Fri May 26 12:38:28 CEST 2017"},{"Commit-ID":"commit fd3331a2769a29c379ed63e21ed2dc3c0f85ba25 1495810377 -----sp","Author":"PersonIdent[arvindkandhare, arvind.kandhare@emc.com, Fri May 26 16:52:57 2017 +0200]","Body":"BOOKKEEPER-1010: Moving Guava to 20.0\n\nThis patch updates Guava to version 20.0 and shades it\n\nAuthor: arvindkandhare <arvind.kandhare@emc.com>\nAuthor: eolivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo, Enrico Olivelli\n\nCloses #166 from eolivelli/guava_version\n","Date":"Fri May 26 16:52:57 CEST 2017"},{"Commit-ID":"commit 9bade929dd87829a8903e402f6c3e3be366a854a 1495827867 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Fri May 26 15:44:27 2017 -0400]","Body":"BOOKKEEPER-1079: shell lastMark throws NPE\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo\n\nCloses #167 from eolivelli/BOOKKEEPER-1079\n","Date":"Fri May 26 21:44:27 CEST 2017"},{"Commit-ID":"commit fc51f73cbc9cdaae9876bc08cafa3e7a80826207 1496300145 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jun 1 08:55:45 2017 +0200]","Body":"BOOKKEEPER-1073: Several stats provider related changes.\n\n- add finagle stats provider\n- provide the ability to remove gauge and scopes\n- update jetty versions for twitter-sciences stats provider\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai, Enrico Olivelli\n\nCloses #160 from sijie/add_channel_writer_timer\n","Date":"Thu Jun 01 08:55:45 CEST 2017"},{"Commit-ID":"commit da70648719679fd1db001c74ad873bf134f16198 1496303248 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@yahoo-inc.com, Thu Jun 1 09:47:28 2017 +0200]","Body":"BOOKKEEPER-1071: Use per connection instances of request encoder/decoder\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Enrico Olivelli, Sijie Guo\n\nCloses #170 from merlimat/bk-1071\n","Date":"Thu Jun 01 09:47:28 CEST 2017"},{"Commit-ID":"commit 0eca5ff57f6e19fe5829d5ef8df228411467401f 1496309474 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jun 1 11:31:14 2017 +0200]","Body":"BOOKKEEPER-1078: Local BookKeeper enhancements for testability\n\nBookKeeper: Local Bookkeeper enhancements for testability\n\n1. Allow creating local bookies without always starting a zookeeper server - This is required as tests may want to create and use their own instance of a test zookeeper\n2. Allow using non default zookeeper host and more importantly non default ZK port\n3. Allowing the caller to specify the initial port for the bookies\n4. Optionally shutdown bookies when the bookie thread exits\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Sijie Guo <sijieg@twitter.com>\nAuthor: Robin Dhamankar <rdhamankar@twitter.com>\n\nReviewers: Enrico Olivelli, Jia Zhai\n\nCloses #164 from sijie/local_bookkeeper_enhancements\n","Date":"Thu Jun 01 11:31:14 CEST 2017"},{"Commit-ID":"commit 77a01dc7e6431092f82a7efb02789beb165b75e2 1496310124 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Thu Jun 1 11:42:04 2017 +0200]","Body":"BOOKKEEPER-1084: Make variables finale if necessary\n\nnot all logger in bookkeeper & hedwig are static. some class like PendnigReadOp and LedgerEntry would have lots of objects, it might be bad. so this task is to make logger as a static variable if it didn't.\n\nwith benefit, cleaning up the imports when touching that file.\n\nRB_ID=141138\n\nAuthor: Sijie Guo <sijieg@twitter.com>\n\nReviewers: Jia Zhai, Enrico Olivelli\n\nCloses #172 from sijie/make_finale\n","Date":"Thu Jun 01 11:42:04 CEST 2017"},{"Commit-ID":"commit e33ec10aa400f32c2e0278c15ea80a0f624e5919 1496313054 -----sp","Author":"PersonIdent[Robin Dhamankar, rdhamankar@twitter.com, Thu Jun 1 12:30:54 2017 +0200]","Body":"BOOKKEEPER-1083: Improvements on OrderedSafeExecutor\n\n    - use listeningscheduledexecutorservice for the threads\n    - as a general util class, expose chooseThread to allow applications use specific thread\n    - add a method to force shutdown executor\n\nAuthor: Robin Dhamankar <rdhamankar@twitter.com>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli\n\nCloses #171 from sijie/add_monitored_thread_pool\n","Date":"Thu Jun 01 12:30:54 CEST 2017"},{"Commit-ID":"commit d1f37dafbb475d4d6aab4769335550428c680269 1496315808 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jun 1 13:16:48 2017 +0200]","Body":"BOOKKEEPER-1085: Introduce the AlertStatsLogger\n\nIntroduce the AlertStatsLogger used to increment a metric whenever an event that should never happen is detected. Allow specifying an optional scope to better classify the error conditions\n\nRB_ID=598662\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Robin Dhamankar <rdhamankar@twitter.com>\n\nReviewers: Enrico Olivelli, Jia Zhai\n\nCloses #173 from sijie/add_alert_state_logger\n","Date":"Thu Jun 01 13:16:48 CEST 2017"},{"Commit-ID":"commit dd08ce1a644de00967dd5fe34ce15caa9789d775 1496315998 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jun 1 13:19:58 2017 +0200]","Body":"BOOKKEEPER-1074: Remove JMX Bean\n\nThis change is based on #160 , the change here is: gitsha [b3be81f](https://github.com/sijie/bookkeeper/commit/b3be81fadae50f2d4a2e938c2735fa35c6c31421)\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Sijie Guo <sijieg@twitter.com>\n\nReviewers: Enrico Olivelli, Matteo Merli\n\nCloses #161 from sijie/remove_jmx_beam\n","Date":"Thu Jun 01 13:19:58 CEST 2017"},{"Commit-ID":"commit a9fe7d94f1890f697633fdca8abdeff23903025f 1496344859 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@yahoo-inc.com, Thu Jun 1 21:20:59 2017 +0200]","Body":"BOOKKEEPER-1056: Removed PacketHeader serialization/deserialization allocation\n\nWhen parsing the request packet header, use static methods to avoid creating a `PacketHeader` instance.\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Enrico Olivelli <None>, Sijie Guo <None>, Venkateswararao Jujjuri (JV) <None>\n\nCloses #175 from merlimat/packet-header-parsing\n","Date":"Thu Jun 01 21:20:59 CEST 2017"},{"Commit-ID":"commit 5c81acaccfb0cb1260acdfd7d0bb95ae84f85654 1496349568 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Thu Jun 1 22:39:28 2017 +0200]","Body":"BOOKKEEPER-1086: Ledger Recovery - Refactor PendingReadOp\n\nthis change is the first part of improving ledger recovery. it is basically a refactor change, which:\n\n- abstract an interface for LedgerEntryRequest in PendingReadOp\n- rename current implementation to SequenceReadRequest, which read the entry in the sequence of quorum.\n\nAuthor: Sijie Guo <sijieg@twitter.com>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>\n\nCloses #176 from sijie/recovery_improvements\n","Date":"Thu Jun 01 22:39:28 CEST 2017"},{"Commit-ID":"commit 55d1dc45c4761f150c59a34b94d21e39e69f872c 1496350784 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jun 1 13:59:44 2017 -0700]","Body":"BOOKKEEPER-989: Enable Travis CI for Apache BookKeeper\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nCloses #168 from sijie/enable_travis_ci\n","Date":"Thu Jun 01 22:59:44 CEST 2017"},{"Commit-ID":"commit 5f945f8a02f5171608810eb002443193c3eb058c 1496354301 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@yahoo-inc.com, Thu Jun 1 23:58:21 2017 +0200]","Body":"BOOKKEEPER-1090: Use LOG.isDebugEnabled() to avoid unexpected allocations\n\nUsing `LOG.debug(...)` can lead to multiple unexpected memory allocation, even when the logger it's turned off.\nFor example, int and long parameter are boxed into Integer and Long objects and the var-arg parameters are using an `Object[]` to hold\nthem.\nWe should guard all usages of `LOG.debug()` with the `if (LOG.isDebugEnabled()` guard.\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Enrico Olivelli, Sijie Guo\n\nCloses #179 from merlimat/if-debug\n","Date":"Thu Jun 01 23:58:21 CEST 2017"},{"Commit-ID":"commit efd8ec26926d2e75f51d6d576543a0dcc116b83f 1496687452 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Mon Jun 5 11:30:52 2017 -0700]","Body":"BOOKKEEPER-944: LowWaterMark Storage Threshold\n\nBOOKKEEPER-944: LowWaterMark Storage Threshold\n\nLowWaterMark Storage Threshold and code refactoring\n\n    - Current implementation toggles READONLY status of the bookie as soon as a directory usage falls below the disk storage threshold.\n      Added LowWaterMark parameter that limits such switches.\n    \t1. Bookie transition from RW to RONLY only when all the ledger dirs usage > HWM (storage threshold)\n    \t2. Bookie transition from RONLY to  RW only when total system disk usage (ledger/index disks) capacity is < LWM\n    \t3. When bookie is in RW mode all disks which are < HWM (storage threshold) are RW\n    - refactored code and separated LedgerDirsMonitor from LedgerDirsManager, to remove circular dependency\n      between LedgerDirsManager and LedgerDirsMonitor and also it improves testability by making them separate classes.\n      It becomes easier to do functional/unit level testing and fault-injection testing at LedgerDirsMonitor class level.\n    - relevant testcases\n\nAuthor: Andrey Yegorov <ayegorovsalesforce.com>\nCo-Author: Charan Reddy Guttapalem <cguttapalemsalesforce.com>\n\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nCloses #108 from reddycharan/lwmhwm\n","Date":"Mon Jun 05 20:30:52 CEST 2017"},{"Commit-ID":"commit b3b958c2b6a7195b23477d181db3fea1e7d1c248 1496692113 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jun 5 12:48:33 2017 -0700]","Body":"BOOKKEEPER-1087: Ledger Recovery (part 2) - Add a parallel reading request in PendingReadOp\n\nTHIS CHANGE IS BASED ON #176 (you can review f0fb89c)\n\nbookkeeper recovery improvement (part-2): add a parallel reading request in PendingReadOp\n\n- add a parallel reading request in PendingReadOp\n- allow PendingReadOp to configure whether to do parallel reading or not\n- add flag in ClientConfiguration to allow configuring whether to do parallel reading in LedgerRecoveryOp or not.\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Sijie Guo <sijieg@twitter.com>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nCloses #177 from sijie/recovery_improvements_part2\n","Date":"Mon Jun 05 21:48:33 CEST 2017"},{"Commit-ID":"commit 5fe86525a9c823f79b3e97fd82ea4aa1c75c79eb 1496693611 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jun 5 13:13:31 2017 -0700]","Body":"BOOKKEEPER-1088: Ledger Recovery (part-3) - Add a ReadEntryListener to callback on individual request\n\nTHIS CHANGE IS BASED ON #177  (you can review 868a3c8 for the only change that belongs to BOOKKEEPER-1088).\n\nbookkeeper recovery improvement (part-3): add a ReadEntryListener to callback on individual request.\n\n- add read entry listener which allow doing batch read, but callback on individual entries in sequence. so in recovery op, we could issue batch reads, then on each individual callback do add entry and stop when received NoSuchEntry.\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Sijie Guo <sijieg@twitter.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Venkateswararao Jujjuri (JV) <None>\n\nCloses #178 from sijie/recovery_improvements_part3 and squashes the following commits:\n\ndd24faf [Sijie Guo] Merge branch 'master' into recovery_improvements_part3\n2e1ebb9 [Sijie Guo] Merge branch 'master' into recovery_improvements_part3\n8b8a3c8 [Sijie Guo] bookkeeper recovery improvement (part-3): add a ReadEntryListener to callback on individual request.\ndb3e98b [Sijie Guo] Address conflicts\nf0fb89c [Sijie Guo] bookkeeper recovery improvement (part-2): add a parallel reading request in PendingReadOp\n80ffc6c [Sijie Guo] Address conflicts\n3db0b84 [Sijie Guo] bookkeeper recovery improvement (part-1): refactor PendingReadOp\n","Date":"Mon Jun 05 22:13:31 CEST 2017"},{"Commit-ID":"commit 58b92de8b5feee37f8bc9a99d8c98c2a9d9df383 1496694317 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jun 5 13:25:17 2017 -0700]","Body":"BOOKKEEPER-748: Move fence requests out of read threads\n\nThis change is moving the fence request out of current read threads and using callback to trigger scheduling read entry and also it refactors the ReadEntryProcessV3 to support long poll in the subsequent requests.\n\nMajor changes:\n\n- change fence request to use SettableFuture\n- refactor ReadEntryProcessV3: to support run fence request in callback and support long poll (in subsequent requests)\n- fix stats issue: requests stats measure the latency from bookie receives the request until it sends the response.\n- remove \"public static final\" for state fields. it is not needed for variables in Interface.\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Robin Dhamankar <rdhamankar@twitter.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nCloses #174 from sijie/longpoll/part1_server_side_change\n","Date":"Mon Jun 05 22:25:17 CEST 2017"},{"Commit-ID":"commit 13c5c88f63f4b7faa63c8c7e42d95f94c6a8d204 1497095737 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Jun 10 13:55:37 2017 +0200]","Body":"BOOKKEEPER-1088: CompactionTest tests are broken because of\n\nProblem:\n\n5fe86525a9c823f79b3e97fd82ea4aa1c75c79eb this commit broken the master. It is because the merge/rebase introduce duplicated lines\n\nSolution:\n\nThis change is to remove the duplicated lines introduced at 5fe86525a9c823f79b3e97fd82ea4aa1c75c79eb\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>\n\nCloses #187 from sijie/sijie/fix_merge_issue\n","Date":"Sat Jun 10 13:55:37 CEST 2017"},{"Commit-ID":"commit 07852d35856dca232450135913090bac27b29abe 1497280853 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Mon Jun 12 08:20:53 2017 -0700]","Body":"BOOKKEEPER-1096: recursive znode delete\n\nWhen ledger is deleted, along with leaf node\nall the eligible branch nodes should be\ndeleted in ZooKeeper.\n\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #186 from reddycharan/recursiveznodedelete\n","Date":"Mon Jun 12 17:20:53 CEST 2017"},{"Commit-ID":"commit b90ad5d89717bb3ca161387af4fce4f913c9e0ae 1497282301 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jun 12 08:45:01 2017 -0700]","Body":"DL-205: Remove StatusCode dependency on DLException\n\n- Remove StatusCode from exceptions. Use integer as exception codes.\n- Also re-organize the modules:\n\n- [ ] distributedlog-protocol (for core structures) and distributedlog-core (for core library).\n- [ ] proxy: distributedlog-proxy-protocol (new module for thrift generated protocol), distributedlog-proxy-client (proxy client) and distributedlog-proxy-server (proxy server)\n- [ ] benchmark & tutorials.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Leigh Stewart <lstewart@apache.org>\n\nCloses #131 from sijie/new_layout\n","Date":"Mon Jun 12 17:45:01 CEST 2017"},{"Commit-ID":"commit 8618b21a2395834ac2a6ede41635832b9d26d03f 1497282301 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jun 12 08:45:01 2017 -0700]","Body":"DL-205: Remove StatusCode dependency on DLException\n\n- Remove StatusCode from exceptions. Use integer as exception codes.\n- Also re-organize the modules:\n\n- [ ] distributedlog-protocol (for core structures) and distributedlog-core (for core library).\n- [ ] proxy: distributedlog-proxy-protocol (new module for thrift generated protocol), distributedlog-proxy-client (proxy client) and distributedlog-proxy-server (proxy server)\n- [ ] benchmark & tutorials.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Leigh Stewart <lstewart@apache.org>\n\nCloses #131 from sijie/new_layout\n","Date":"Mon Jun 12 17:45:01 CEST 2017"},{"Commit-ID":"commit 83c527c32f9aa7ffd89aac2085e0b798a3ced1af 1497297341 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jun 12 12:55:41 2017 -0700]","Body":"DL-199: Be able to support filesystem-path like name\n\nIn order to support hierarchical namespace, we need to be able to support filesystem path like log name.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Leigh Stewart <lstewart@apache.org>\n\nCloses #130 from sijie/DL_199\n","Date":"Mon Jun 12 21:55:41 CEST 2017"},{"Commit-ID":"commit 46e6b70feda2e8ad61ba13928df93b2c94d3dd4e 1497301933 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jun 12 14:12:13 2017 -0700]","Body":"DL-204: Bump libthrift to latest version for distributedlog-core\n\nCurrently finagle heavily depends on an out-of-dated version - libthrift 5.0. Proxy modules (client, server) depend on this version, however the core library doesn't really depend on libthrift.\n\nThis change is to change libthrift to 0.9.* in distributedlog-core and shade it to avoid it conflict with the version used by finagle.\n\nThis change is based on #131 . The main change is at gitsha [6e58786](https://github.com/apache/incubator-distributedlog/commit/6e587869f87cdce50ae93ba3d52767719d1ab5a6)\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Leigh Stewart <lstewart@apache.org>\n\nCloses #132 from sijie/change_thrift_for_core_module\n","Date":"Mon Jun 12 23:12:13 CEST 2017"},{"Commit-ID":"commit 164c44bb97e5b3ea8c658f5f376390b787061125 1497597811 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jun 16 09:23:31 2017 +0200]","Body":"ISSUE #184: Support GitHub issues in bk-merge script\n\n- Recoganize the issue title and normalize it\n- Close the corresponding issue when closing the pr\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>\n\nThis closes #194 from sijie/support_github_issues, closes #184\n","Date":"Fri Jun 16 09:23:31 CEST 2017"},{"Commit-ID":"commit 363c5d00b847b7eb2a93826b6d947fd3180a37dd 1498065197 -----sp","Author":"PersonIdent[jiazhai, zhaijia@live.com, Wed Jun 21 10:13:17 2017 -0700]","Body":"ISSUE #191: add template for ISSUE and PR\n\nFollowing BP-9, provide a template for ISSUE and PR.\nWhen create issue, will use ISSUE template; while create PR will use PR template.\n\nAuthor: jiazhai <zhaijia@live.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #192 from jiazhai/issue_191, closes #191\n","Date":"Wed Jun 21 19:13:17 CEST 2017"},{"Commit-ID":"commit 1bf73e9f5b1d9a982182681156c90c6de026ce17 1498065615 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jun 21 10:20:15 2017 -0700]","Body":"DL-124: Use Java8 Future rather than twitter Future\n\nSwitch to use Java8 CompletableFuture, to reduce dependencies introduced by twitter future and make it more friendly to users (users don't think of using which version of scala).\n\nThis change is based on #132 . Gitsha ce0686e is the change to review.\n\nThe changes:\n\n- Change Future to CompletableFuture\n- Map to thenApply\n- flatMap to thenCompose\n- Added a FutureEventListener, and switch addEvenListener to whenComplete (or whenCompleteAsync)\n- setValue to complete\n- setException to completeExceptionally\n- add rescue, ignore, ensure to FutureUtils as util functions.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Leigh Stewart <lstewart@apache.org>\n\nCloses #133 from sijie/change_twitter_future_to_java_future\n","Date":"Wed Jun 21 19:20:15 CEST 2017"},{"Commit-ID":"commit 7e63cff1c110b7b9435a88ab8ab321659057c298 1498065615 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jun 21 10:20:15 2017 -0700]","Body":"DL-124: Use Java8 Future rather than twitter Future\n\nSwitch to use Java8 CompletableFuture, to reduce dependencies introduced by twitter future and make it more friendly to users (users don't think of using which version of scala).\n\nThis change is based on #132 . Gitsha ce0686e is the change to review.\n\nThe changes:\n\n- Change Future to CompletableFuture\n- Map to thenApply\n- flatMap to thenCompose\n- Added a FutureEventListener, and switch addEvenListener to whenComplete (or whenCompleteAsync)\n- setValue to complete\n- setException to completeExceptionally\n- add rescue, ignore, ensure to FutureUtils as util functions.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Leigh Stewart <lstewart@apache.org>\n\nCloses #133 from sijie/change_twitter_future_to_java_future\n","Date":"Wed Jun 21 19:20:15 CEST 2017"},{"Commit-ID":"commit b4770a090a95802250dc69b13487eeb7ff6e0bb3 1498065615 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jun 21 10:20:15 2017 -0700]","Body":"DL-124: Use Java8 Future rather than twitter Future\n\nSwitch to use Java8 CompletableFuture, to reduce dependencies introduced by twitter future and make it more friendly to users (users don't think of using which version of scala).\n\nThis change is based on #132 . Gitsha ce0686e is the change to review.\n\nThe changes:\n\n- Change Future to CompletableFuture\n- Map to thenApply\n- flatMap to thenCompose\n- Added a FutureEventListener, and switch addEvenListener to whenComplete (or whenCompleteAsync)\n- setValue to complete\n- setException to completeExceptionally\n- add rescue, ignore, ensure to FutureUtils as util functions.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Leigh Stewart <lstewart@apache.org>\n\nCloses #133 from sijie/change_twitter_future_to_java_future\n","Date":"Wed Jun 21 19:20:15 CEST 2017"},{"Commit-ID":"commit 90a8f283999ddbfee818629e1be17102e63be22c 1498067423 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Wed Jun 21 10:50:23 2017 -0700]","Body":"BOOKKEEPER-1089: Ledger Recovery (part-4) - allow batch reads in ledger recovery\n\nThis change is based on #178 - (you can review git sha 82f73ef)\n\nbookkeeper recovery improvement (part-4): allow batch reading in ledger recovery\n\n    - enable batch read in ledger recovery, so we could parallel reading to improve recovery time.\n\n    RB_ID=266145\n\nAuthor: Sijie Guo <sijieg@twitter.com>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis closes #181 from sijie/recovery_improvements_part4\n","Date":"Wed Jun 21 19:50:23 CEST 2017"},{"Commit-ID":"commit 90e4e46bccdd1a788e10056f4a3818aa2aead452 1498067880 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jun 21 10:58:00 2017 -0700]","Body":"BOOKKEEPER-1093: Piggyback LAC on ReadResponse\n\nThis change is based #178 - (you can review git sha 40ca8c2)\n\nbookkeeper: LAC piggyback at read response\n\n        - bookie server changes\n          * cache maximum lac in file info\n          * provide getLastAddConfirmed & setLastAddConfirmed in ledger storage\n          * addEntry will set its lac thru setLastAddConfirmed\n          * readEntry will read latest lac and piggyback\n        - client change\n          * check whether the response has lac piggybacked, if there is lac update lac in its corresponding ledger handle.\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Sijie Guo <sijieg@twitter.com>\n\nReviewers: Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis closes #180 from sijie/piggyback_lac\n","Date":"Wed Jun 21 19:58:00 CEST 2017"},{"Commit-ID":"commit 256e7587331eddd51b7c05f27717c9d4dc848500 1498071615 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jun 21 12:00:15 2017 -0700]","Body":"BOOKKEEPER-1092: Ledger Recovery (Part 5) - Add Test Case for Parallel Ledger Recovery\n\nThis change is based on #180 (ebf7020 is the change for review)\n\n- Add test case for parallel ledger recovery\n- More stats for ledger recovery\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Sijie Guo <sijieg@twitter.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis closes #182 from sijie/recovery_improvements_part5\n","Date":"Wed Jun 21 21:00:15 CEST 2017"},{"Commit-ID":"commit 59696600784c54192877a5742c6b141eadb07e26 1498072059 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Wed Jun 21 12:07:39 2017 -0700]","Body":"BOOKKEEPER-1097: GC test when no WritableDirs\n\n- Functional test validating that Compaction takes place even if there\nare no writableledgerdir but there are ledgerdirs according to\nLedgerDirsManager.getWritableLedgerDirsForNewLog\n\n- end-to-end testcase of Bookie recovery, incase of Bookie ledgerdir reaching\nthe threshold, and recovering by forcing the gc/compaction\n\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #188 from reddycharan/gctestnowritabledirs\n","Date":"Wed Jun 21 21:07:39 CEST 2017"},{"Commit-ID":"commit 189d7e80b4b0096d580bafa66323fa5f099df65d 1498141260 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jun 22 16:21:00 2017 +0200]","Body":"ISSUE #203: TestFencing is failing due to LAC piggyback changes\n\nDescriptions of the changes in this PR:\n\nProblem:\n\nTestFencing is failing after merging LAC piggyback changes. Because LAC piggyback will advance last add confirmed when reading entries.\n\nSolution:\n\nMove the addEntry verification to after reading entries.\n\nAt the same time, add more logging to #testManyOpen\n\n---\nBe sure to do all of the following to help us incorporate your contribution\nquickly and easily:\n\n- [x] Make sure the PR title is formatted like:\n    `<Issue #>: Description of pull request`\n    `e.g. Issue 123: Description ...`\n- [x] Make sure tests pass via `mvn clean apache-rat:check install findbugs:check`.\n- [x] Replace `<Issue #>` in the title with the actual Issue number, if there is one.\n\n---\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>\n\nThis closes #204 from sijie/fix_test_fencing, closes #203\n","Date":"Thu Jun 22 16:21:00 CEST 2017"},{"Commit-ID":"commit fe8ded50ed8f008457665138ec0e6a88bba67f73 1498684177 -----sp","Author":"PersonIdent[Diego Salvi, lothruin.mirwen@gmail.com, Wed Jun 28 14:09:37 2017 -0700]","Body":"ISSUE #216: Remove useless and misleading '&= true'\n\nThis is just a super minor issue, I stumbled upon it looking into https://github.com/apache/bookkeeper/pull/58...\n\nAssignments like 'shutDownTask =& true' aren't useful at all. I presume that compiler could strip them out but the code is less readable. (Just note that 'x & true == x').\n\nRemoved useless assignments.\n\nAuthor: Diego Salvi <lothruin.mirwen@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #215 from diegosalvi/master, closes #216\n","Date":"Wed Jun 28 23:09:37 CEST 2017"},{"Commit-ID":"commit 9ddd9e6f9e48b03a57a2c78ec2630303abd49782 1498685045 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Wed Jun 28 14:24:05 2017 -0700]","Body":"BOOKKEEPER-1034: Bookie start in RO when diskfull\n\nWhen the disk is above threshold, Bookie goes to RO. If we have to restart the\nbookie, on the way back, bookie tries to create new entrylog and other files,\nwhich will fail because disk usage is above threshold,\nhence bookie refuses to come up. So with this fix we will try to start in RO\nmode if RO is enabled.\n\nAlso, if bookie has died abruptly then it may missed flushing EntryMemtable and\nIndexInMemoryPageManager. So next time when it starts when disc is full\nit is failing to create index file and it is shutting down, though we expect it\nto start in readonlymode. So Bookie should be able to create index file\nthough it has reached the diskusagethreshold, while starting the Bookie in\nReadonly Mode. But ofcourse there should be some config to safeguard when\ndisk usable space is so low.\n\nMinor fixes in shutdown logic of Bookie and Bookieserver.\n\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #190 from reddycharan/bookiestartinreadonlywhendiskfull\n","Date":"Wed Jun 28 23:24:05 CEST 2017"},{"Commit-ID":"commit 32c2859f0bec9ab74965d954bce038480e4dc2ba 1498685318 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Wed Jun 28 14:28:38 2017 -0700]","Body":"BOOKKEEPER-1086: ZkUnderreplicationManager cache watcher\n\nPreviously, getLedgerToReplicate left watches each time it traversed the\ntree until it found a suitable replication target.  Since we don't have\na way of canceling watches, these watches tended to get abandoned,\nparticularly on interior nodes, which aren't changed much.  Thus,\nover time, some nodes would build up a very large number of watch.\n\nInstead, introduce a caching mechanism to remember outstanding watches\nand avoid ever creating two watches on the same node.\n\nAuthor: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #193 from athanatos/forupstream/BOOKKEEPER-1098\n","Date":"Wed Jun 28 23:28:38 CEST 2017"},{"Commit-ID":"commit b9648998802ce4bf256e33ffd6296b4c973a4824 1498724278 -----sp","Author":"PersonIdent[Jia Zhai, jiazhai@users.noreply.github.com, Thu Jun 29 16:17:58 2017 +0800]","Body":"Issue 212: change github PR template to adjust both issue# and jira# (#213)\n\nchange PR template to adjust both issue# and jira#\r\n\r\ncloses #212 \r\n\r\n","Date":"Thu Jun 29 10:17:58 CEST 2017"},{"Commit-ID":"commit 75aca2397e43ec321a049aaec514c99cc9fad235 1498773436 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jun 29 14:57:16 2017 -0700]","Body":"ISSUE #207: change the HashSet to BitSet to handle duplicated bookies on reading entries\n\nDescriptions of the changes in this PR:\n\nProblem:\n\nIf there happens to have duplicated bookies in same ledger (it happened before when ensemble change still has problem), the read doesn't work as expected. It hang forever.\n\nSolution:\n\nChange the HashSet to BitSet to use bookieIndex rather than InetSocketAddress to track the heardfrom bookies set.\n\n---\nBe sure to do all of the following to help us incorporate your contribution\nquickly and easily:\n\n- [x] Make sure the PR title is formatted like:\n    `<Issue #>: Description of pull request`\n    `e.g. Issue 123: Description ...`\n- [x] Make sure tests pass via `mvn clean apache-rat:check install findbugs:check`.\n- [x] Replace `<Issue #>` in the title with the actual Issue number, if there is one.\n\n---\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Sijie Guo <sijieg@twitter.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis closes #199 from sijie/client_changes/bitset, closes #207\n","Date":"Thu Jun 29 23:57:16 CEST 2017"},{"Commit-ID":"commit 95ebc45fa2d0c4028c31c66b790743f4a7909800 1498774097 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Thu Jun 29 15:08:17 2017 -0700]","Body":"ISSUE #209: Introduce Speculative Read/Read LAC policy\n\nDescriptions of the changes in this PR:\n\n    - Separate out the logic that determines when speculative reads are scheduled from the individual requests into a separate SpeculativeRequestExecutionPolicy\n    - Implement the default speculative read execution policy based on the current mechanism of using first and max timeout\n    - Initialize the policy once in the BookKeeper object and use it for individual requests by keeping information about the requests in the call chain.\n\n---\nBe sure to do all of the following to help us incorporate your contribution\nquickly and easily:\n\n- [x] Make sure the PR title is formatted like:\n    `<Issue #>: Description of pull request`\n    `e.g. Issue 123: Description ...`\n- [x] Make sure tests pass via `mvn clean apache-rat:check install findbugs:check`.\n- [x] Replace `<Issue #>` in the title with the actual Issue number, if there is one.\n\n---\n\nAuthor: Sijie Guo <sijieg@twitter.com>\nAuthor: Robin Dhamankar <rdhamankar@twitter.com>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #200 from sijie/client_changes/speculative_policy, closes #209\n","Date":"Fri Jun 30 00:08:17 CEST 2017"},{"Commit-ID":"commit 5e399df67c2aa1e5f228c62ba8533ca3293ab147 1498774360 -----sp","Author":"PersonIdent[Sijie Guo, sijieg@twitter.com, Thu Jun 29 15:12:40 2017 -0700]","Body":"BOOKKEEPER-759: Delay Ensemble Change & Disable Ensemble Change\n\nDescriptions of the changes in this PR:\n\nThis pull request contains the changes around ensemble change.\n\n- Delay Ensemble Change: Provide a flag to allow delay ensemble change. if that is set to change, will not do ensemble change until it breaks ack quorum requirements.\n- Disable Ensemble Change: Provide a runtime feature flag to allow disabling ensemble change. The ensemble change behavior can be disabled on-the-fly via the FeatureProvider.\n\n---\nBe sure to do all of the following to help us incorporate your contribution\nquickly and easily:\n\n- [x] Make sure the PR title is formatted like:\n    `<Issue #>: Description of pull request`\n    `e.g. Issue 123: Description ...`\n- [x] Make sure tests pass via `mvn clean apache-rat:check install findbugs:check`.\n- [x] Replace `<Issue #>` in the title with the actual Issue number, if there is one.\n\n---\n\nAuthor: Sijie Guo <sijieg@twitter.com>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #202 from sijie/client_changes/delay_ensemble_changes\n","Date":"Fri Jun 30 00:12:40 CEST 2017"},{"Commit-ID":"commit 1b0492bf2ac547cf583736d3eaf9849498e42f80 1498799442 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jun 30 13:10:42 2017 +0800]","Body":"ISSUE #198: TestBackwardCompat.testCompat410 often fails due to io.netty.util.IllegalReferenceCountException\n\nDescriptions of the changes in this PR:\n\nProblem:\n\nin TestBackwardCompat#testCompact400, the test is to verify the current client can't talk to a 4.0.0 server.\n\nThe 4.5.0 client is sending a protobuf encoded request to 4.0.0 server. The 4.0.0 server will interpret the 4.5.0 protobuf encoded request, but it will realize this is bad request and sending v2 protocol encoded response. because the request is a bad request, 4.0.0 server sent a response back with unknown op code.\n\nIn current v2 ResponseEnDecoder (listed as below), when it doesn't know the op code, it will return the buffer to the channel. this might cause the misbehavior in the channel pipeline to decrement reference count.\n\nSolution:\n\nthrow exception in the EnDeCoder when receiving unknown op code. so the netty can close the connection, error out the pending requests and cleaning up the resources.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <None>\n\nThis closes #219 from sijie/issue_198, closes #198\n","Date":"Fri Jun 30 07:10:42 CEST 2017"},{"Commit-ID":"commit 450629d4314cf467fbf78da2d2a43840d0ccf783 1498892743 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Jul 1 15:05:43 2017 +0800]","Body":"ISSUE #221: Make netty server shutdown idempotent\n\nDescriptions of the changes in this PR:\n\n(see the detailed discussion in #221 )\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <None>, Jia Zhai <None>\n\nThis closes #222 from sijie/make_shutdown_idempotent, closes #221\n","Date":"Sat Jul 01 09:05:43 CEST 2017"},{"Commit-ID":"commit e735c0305c8b3737e78ba5a1ba15b5d80a5ffb47 1499140781 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jul 4 11:59:41 2017 +0800]","Body":"Issue 225: Remove Parameterized from CompactionTest\n\nDescriptions of the changes in this PR:\n\n- Split the CompactionTest into two, one is by bytes, while the other one is by entries.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <None>, Jia Zhai <None>\n\nThis closes #226 from sijie/compaction_tests\n","Date":"Tue Jul 04 05:59:41 CEST 2017"},{"Commit-ID":"commit 21366fee0e43e69591a03d7b517cf66dff2861d9 1499141651 -----sp","Author":"PersonIdent[sigee, sigee15@gmail.com, Tue Jul 4 12:14:11 2017 +0800]","Body":"Issue 223: Code cleanups\n\nDescriptions of the changes in this PR:\n\nThere are some different kind of cleanups by commits. To make the code more readeable and improve code quality and improve performance in some cases.\nE.g.:\n - Remove unnecessary semicolons\n - Remove unused/unneeded/duplicated imports\n- Replace l to L in long literals\n- Remove boxing on an already boxed value\n- Replace iterations to bulk operations\n\nAuthor: sigee <sigee15@gmail.com>\n\nReviewers: Enrico Olivelli <None>, Jia Zhai <None>, Sijie Guo <None>\n\nThis closes #217 from sigee/cleanups\n","Date":"Tue Jul 04 06:14:11 CEST 2017"},{"Commit-ID":"commit ee0dddee6849d1968500af666571df668d34393a 1499142441 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jul 4 12:27:21 2017 +0800]","Body":"BOOKKEEPER-772: Reorder Read Sequence\n\nDescriptions of the changes in this PR:\n\n    - for rackware placement policy, the bookie in the same rack will be preferred.\n    - for region-aware placement policy, the bookie in the same region will be preferred.\n    - for any readonly or unavailable (high score in bookie failure history) bookies, they will be at the last position in the sequence.\n\nThis change is based on #220 . Please review gitsha 1f7dccd for the reorder change.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <None>, Matteo Merli <None>\n\nThis closes #224 from sijie/reorder_reads\n","Date":"Tue Jul 04 06:27:21 CEST 2017"},{"Commit-ID":"commit b59d63e8be237e80872f73d92a31b4213d9a649b 1499149468 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jul 4 08:24:28 2017 +0200]","Body":"Add missed tests for SortedLedgerStorage\n\nAdded two missed tests for SortedLedgerStorage. It was missed when we (twitter) merged the SortedLedgerStorage back.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli, Jia Zhai\n\nThis closes #227 from sijie/more_memory_table_related_tests\n","Date":"Tue Jul 04 08:24:28 CEST 2017"},{"Commit-ID":"commit 29eb420f1cca07c1a3a7748ed7fbb8a5bc54f2fa 1499397085 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Thu Jul 6 20:11:25 2017 -0700]","Body":"BOOKKEEPER-1028 and BOOKKEEPER-1029\n\n    BOOKKEEPER-1028: inc/excl opts listunderreplicated\n\n    - Introduce including and excluding BookieId options\n    for listunderreplicatedLedgers\n\n    - But there is limitation that, since replicaslist wont be\n    updated in underreplicatedledger zNode there is possibility\n    of stale information\n\n      ---------------------------------------------------------\n\n    BOOKKEEPER-1029: BookieDecommision Workflow\n\n    - LostBookieRecoveryDelay config param is stored in ZK\n    - if LostBookieRecoveryDelay is reset to same value then it force triggers audit immediately\n    - Added logic to trigger immediately or schedule pending audittask depending on the changed value in ZK\n    - good number of testcases validating focetrigger/reschedluing audittask\n    - added bookieshell command to get/set LostBookieRecoveryDelay from ZK\n    - added bookieshell command to triggeraudit by resetting LostBookieRecoveryDelay\n    - added decommissionbookie bkshell command, which validates the complete replication of ledgers stored in the bookie\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <guosijie@gmail.com>\n\nThis closes #127 from reddycharan/listunderreplicatedpredicate and squashes the following commits:\n\n34bacf3c [cguttapalem] BOOKKEEPER-1029: BookieDecommision Workflow\neb43ec49 [Charan Reddy Guttapalem] BOOKKEEPER-1029: BookieDecommision Workflow\nfcb399df [cguttapalem] BOOKKEEPER-1028: inc/excl opts listunderreplicated\n","Date":"Fri Jul 07 05:11:25 CEST 2017"},{"Commit-ID":"commit 9aff6d52e01b50f25f5dbe1086ff10012ca25c48 1499408397 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Thu Jul 6 23:19:57 2017 -0700]","Body":"BOOKKEEPER-1033: Handle DirsPartitionDuplication\n\n- Provide configuration for allowDirsPartitionDuplication\n- while calculating total disk metrics account Partition Duplication\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <guosijie@gmail.com>\n\nThis closes #189 from reddycharan/dirspartitionduplication and squashes the following commits:\n\n99fc6fc1 [cguttapalem] BOOKKEEPER-1033: Handle DirsPartitionDuplication\n1d453975 [cguttapalem] BOOKKEEPER-1033: Handle DirsPartitionDuplication\n","Date":"Fri Jul 07 08:19:57 CEST 2017"},{"Commit-ID":"commit 3b33d636a058f211e1cc24b748dc9888256899c6 1499585771 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Sun Jul 9 15:36:11 2017 +0800]","Body":"ISSUE #235: Setter for JournalMaxGroupWaitMSec/JOURNAL_MAX_GROUP_WAIT_M\u2026\n\nAdd a setter for JournalMaxGroupWaitMSec configuration property\n\n- [x] Make sure the PR title is formatted like:\n    `<Issue # or BOOKKEEPER-#>: Description of pull request`\n    `e.g. Issue 123: Description ...`\n    `e.g. BOOKKEEPER-1234: Description ...`\n- [x] Make sure tests pass via `mvn clean apache-rat:check install findbugs:check`.\n- [x] Replace `<Issue # or BOOKKEEPER-#>` in the title with the actual Issue/JIRA number.\n\n---\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #236 from eolivelli/JOURNAL_MAX_GROUP_WAIT_MSEC, closes #235\n","Date":"Sun Jul 09 09:36:11 CEST 2017"},{"Commit-ID":"commit 8aac2cab6630de6dee5e1ccef7f15a6f41758b5f 1499938633 -----sp","Author":"PersonIdent[Edward Ribeiro, eribeiro@users.noreply.github.com, Thu Jul 13 06:37:13 2017 -0300]","Body":"ISSUE #239: typo in class name SpeculativeRequestExecutor (#240)\n\n","Date":"Thu Jul 13 11:37:13 CEST 2017"},{"Commit-ID":"commit 8bb699ed468c39e1ae1c01dd7fc02033d7b74ce2 1500028567 -----sp","Author":"PersonIdent[jiazhai, zhaijia@live.com, Fri Jul 14 12:36:07 2017 +0200]","Body":"y\n\nDescriptions of the changes in this PR:\nHandle handle non-ascii chars in username in merge script.\n\n---\nBe sure to do all of the following to help us incorporate your contribution\nquickly and easily:\n\n- [X] Make sure the PR title is formatted like:\n    `<Issue # or BOOKKEEPER-#>: Description of pull request`\n    `e.g. Issue 123: Description ...`\n    `e.g. BOOKKEEPER-1234: Description ...`\n- [X] Make sure tests pass via `mvn clean apache-rat:check install findbugs:check`.\n- [X] Replace `<Issue # or BOOKKEEPER-#>` in the title with the actual Issue/JIRA number.\n\n---\n\nAuthor: jiazhai <zhaijia@live.com>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>\n\nThis closes #242 from jiazhai/issue_241\n","Date":"Fri Jul 14 12:36:07 CEST 2017"},{"Commit-ID":"commit ccf83ed5bd49155697e909e13edb572082e838ec 1500206503 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Sun Jul 16 14:01:43 2017 +0200]","Body":"ISSUE #232: Add code-coverage report\n\nIntroduce Cobertura And Coveralls.io plugins in order to run code coverage reports\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #233 from eolivelli/code-coverage, closes #232\n","Date":"Sun Jul 16 14:01:43 CEST 2017"},{"Commit-ID":"commit c49621bacaa960d240afbbee83a9703b4cbc3ec2 1500324457 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jul 17 13:47:37 2017 -0700]","Body":"ISSUE #208: Improve ledger fence logic\n\nDescriptions of the changes in this PR:\n\nProblem:\n    When bookie receive a fence request and couldn't find any writable dirs for the new index file, it will throw exception. This behavior can be improved, because as long as ledger fence request be persisted in Journal, we can say the fence request succeed. It should not depends on the success of flushing new index file.\n\nSolution:\n\n- Add option to fall back to pick from all directories regardless of writable or not when we getFileInfo for a new ledger\n- Return success only when ledger fence request has been persisted in Journal\n\n---\nBe sure to do all of the following to help us incorporate your contribution\nquickly and easily:\n\n- [x] Make sure the PR title is formatted like:\n    `<Issue #>: Description of pull request`\n    `e.g. Issue 123: Description ...`\n- [x] Make sure tests pass via `mvn clean apache-rat:check install findbugs:check`.\n- [x] Replace `<Issue #>` in the title with the actual Issue number, if there is one.\n\n---\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Yiming Zang <yzang@twitter.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #205 from sijie/improve_fencing_behavior, closes #208\n","Date":"Mon Jul 17 22:47:37 CEST 2017"},{"Commit-ID":"commit 387dc83d6d2db6a1d30bac3216a92f875083d144 1500324818 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jul 17 13:53:38 2017 -0700]","Body":"ISSUE #228: BookKeeper Server: Index Page Management Memory Growth\n\nDescriptions of the changes in this PR:\n\n** Improvements **\n\n- Never delete a LedgerEntryPage that has been allocated.\n- Track free LedgerEntryPage in a separate list\n- Use pages from the free pages list as though they were being freshly allocated\n- This guarantees that the direct buffer allocation never exceeds the allocated space for index pages\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #229 from sijie/lru_related_changes, closes #228\n","Date":"Mon Jul 17 22:53:38 CEST 2017"},{"Commit-ID":"commit a84b5e11114c5a6eabeaf17ba60975439593fa2d 1500325239 -----sp","Author":"PersonIdent[sigee, sigee15@gmail.com, Mon Jul 17 14:00:39 2017 -0700]","Body":"Add Checkstyle to the build process (Part 1)\n\nAdd checkstyle to\n- bookkeeper-benchmark\n- Stats API for bookkeeper\n- Stats provider for codahale metrics\n- Stats provider for Prometheus\n- Stats provider for Finagle stats\n- Stats provider for twitter-ostrich package\n- Stats provider for twitter-stats package\n\nand fix issues checkstyle reported.\n\n---\nBe sure to do all of the following to help us incorporate your contribution\nquickly and easily:\n\n- [X] Make sure the PR title is formatted like:\n    `<Issue # or BOOKKEEPER-#>: Description of pull request`\n    `e.g. Issue 123: Description ...`\n    `e.g. BOOKKEEPER-1234: Description ...`\n- [ ] Make sure tests pass via `mvn clean apache-rat:check install findbugs:check`.\n- [X] Replace `<Issue # or BOOKKEEPER-#>` in the title with the actual Issue/JIRA number.\n\n---\n\nAuthor: sigee <sigee15@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #231 from sigee/checkstyle\n","Date":"Mon Jul 17 23:00:39 CEST 2017"},{"Commit-ID":"commit dc1fba1685fe04931ae2966d2ccc5b418af257ca 1500325722 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Mon Jul 17 14:08:42 2017 -0700]","Body":"ISSUE #237: Upgrade to ZooKeeper 3.5.3-BETA\n\nDescriptions of the changes in this PR:\n\nUpdate ZooKeeper dependency from 3.5.1-alpha to 3.5.3-beta.\nThis will enable ZooKeeper over SSL\n\n---\nBe sure to do all of the following to help us incorporate your contribution\nquickly and easily:\n\n- [x ] Make sure the PR title is formatted like:\n    `<Issue # or BOOKKEEPER-#>: Description of pull request`\n    `e.g. Issue 123: Description ...`\n    `e.g. BOOKKEEPER-1234: Description ...`\n- [ x] Make sure tests pass via `mvn clean apache-rat:check install findbugs:check`.\n- [ x] Replace `<Issue # or BOOKKEEPER-#>` in the title with the actual Issue/JIRA number.\n\n---\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #238 from eolivelli/zookeeper-3.5.3, closes #237\n","Date":"Mon Jul 17 23:08:42 CEST 2017"},{"Commit-ID":"commit 1b79adaae7ffd4736530bd1088b45de8ac049f98 1500326833 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jul 17 14:27:13 2017 -0700]","Body":"BOOKKEEPER-1095: Long Poll - Server and Client Side Changes\n\nDescriptions of the changes in this PR:\n\n- changes on FileInfo to support notifications on LAC changes\n- a new ReadEntryLongPollV3 processor to process readEntry requests with long poll flags\n- a new public API for long poll: readLastConfirmedAndEntry. if it is reading beyond the LAC, it will become a long poll request and wait for advancing LAC on bookie side; if it isn't reading beyond the LAC it will be normal reads.\n- also have a speculative mechanism for long poll reads.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #220 from sijie/BOOKKEEPER-1094\n","Date":"Mon Jul 17 23:27:13 CEST 2017"},{"Commit-ID":"commit 086537beda9427c057a286ad6c4614659da6ed7f 1500346923 -----sp","Author":"PersonIdent[sigee, sigee15@gmail.com, Tue Jul 18 11:02:03 2017 +0800]","Body":"ISSUE #230: Add Checkstyle to the build process (Part 2)\n\nFix issues checkstyle reported in\n  - org.apache.bookkeeper.auth\n  - org.apache.bookkeeper.bookie\n\nCheckstyle is not added to the bookkeeper-server yet.\n\n---\nBe sure to do all of the following to help us incorporate your contribution\nquickly and easily:\n\n- [X] Make sure the PR title is formatted like:\n    `<Issue # or BOOKKEEPER-#>: Description of pull request`\n    `e.g. Issue 123: Description ...`\n    `e.g. BOOKKEEPER-1234: Description ...`\n- [ ] Make sure tests pass via `mvn clean apache-rat:check install findbugs:check`.\n- [X] Replace `<Issue # or BOOKKEEPER-#>` in the title with the actual Issue/JIRA number.\n\n---\n\nAuthor: sigee <sigee15@gmail.com>\n\nReviewers: Jia Zhai <None>, Sijie Guo <None>\n\nThis closes #234 from sigee/checkstyle2, closes #230\n","Date":"Tue Jul 18 05:02:03 CEST 2017"},{"Commit-ID":"commit d61cfaba69cb0f87bc388889a58f2095f4034f30 1500366887 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jul 18 16:34:47 2017 +0800]","Body":"ISSUE #252: Enable four-letter-words zookeeper commands in localbookie\n\nDescriptions of the changes in this PR:\n\nEnable four-letter-words zookeeper commands in localbookie\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <None>, Jia Zhai <None>, Matteo Merli <None>\n\nThis closes #253 from sijie/fix_4letters_issue, closes #252\n","Date":"Tue Jul 18 10:34:47 CEST 2017"},{"Commit-ID":"commit f47dd4272f54bb95fd38abdd6c492dbe199dd7a4 1500367663 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jul 18 16:47:43 2017 +0800]","Body":"BOOKKEEPER-980: BookKeeper Tools doesn't process the argument correctly\n\nDescriptions of the changes in this PR:\n\nFix the issue described in [BOOKKEEPER-980](https://issues.apache.org/jira/browse/BOOKKEEPER-980).\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <None>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #255 from sijie/BOOKKEEPER-980\n","Date":"Tue Jul 18 10:47:43 CEST 2017"},{"Commit-ID":"commit 7277657740c276b6f036322177c147264ba5100b 1500367857 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jul 18 16:50:57 2017 +0800]","Body":"ISSUE #249: Organize findbugs and checkstyle files in buildtools module\n\nDescriptions of the changes in this PR:\n\nOrganize findbugs and checkstyle files in buildtools module\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Matteo Merli <None>\n\nThis closes #250 from sijie/buildtools, closes #249\n","Date":"Tue Jul 18 10:50:57 CEST 2017"},{"Commit-ID":"commit 7e9350cff67f0cb72ab757d500d98044cbdd4264 1500446594 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jul 19 08:43:14 2017 +0200]","Body":"ISSUE #256: BookieInitializationTest.testWithDiskFullAndAbilityToCreateNewIndexFile failed\n\nDescriptions of the changes in this PR:\n\nin c49621b, we allow creating FileInfo even when disk is full to allow fence requests succeed at this case.\n\nit is conflicted with Charan's change. Since there is already a setting to configure the min usable size to allow index file creation. if we configure that to be zero, it is same as allowing index file creation even disks are full. so removing the fallback logic introduced in c49621b.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Charan Reddy Guttapalem, Enrico Olivelli\n\nThis closes #257 from sijie/issue_256, closes #256\n","Date":"Wed Jul 19 08:43:14 CEST 2017"},{"Commit-ID":"commit 11fdac3cfdfe0900db994b45aa17500974ba3907 1500449464 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jul 19 09:31:04 2017 +0200]","Body":"ISSUE #258: BookieInitializationTest.testRegNodeExistsAfterSessionTimeOut failed\n\nDescriptions of the changes in this PR:\n\nConstruct new zookeeper client to ensure the tests get new zookeeper session.\n\n(this change is based on 77c7721 )\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>\n\nThis closes #259 from sijie/issue_258, closes #258\n","Date":"Wed Jul 19 09:31:04 CEST 2017"},{"Commit-ID":"commit 2d992e39da0fc121901a72849b424c86fb099f03 1500557074 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jul 20 15:24:34 2017 +0200]","Body":"BOOKKEEPER-1027: Cleanup README\n\nDescriptions of the changes in this PR:\n\n- Move README to README.md (written it in markdown syntax)\n- Organized the README as below:\n  - what is bookkeeper and what it can be used for\n  - getting started\n  - documentation\n  - contribution\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli, Jia Zhai\n\nThis closes #248 from sijie/update_readme\n","Date":"Thu Jul 20 15:24:34 CEST 2017"},{"Commit-ID":"commit 0ef4a29c9c34022816c7584943404d0fb52b9a1c 1500597325 -----sp","Author":"PersonIdent[Yiming Zang, yzang@twitter.com, Fri Jul 21 08:35:25 2017 +0800]","Body":"ISSUE #267: Bookie should serve in read only mode during shutting down.\n\nDescriptions of the changes in this PR:\n\nSet the bookie in readonly mode during shutting down. (contributed by yzang)\n\nAuthor: Yiming Zang <yzang@twitter.com>\n\nReviewers: Enrico Olivelli <None>, Jia Zhai <None>\n\nThis closes #268 from sijie/readonly_on_shutdown, closes #267\n","Date":"Fri Jul 21 02:35:25 CEST 2017"},{"Commit-ID":"commit 1c567f88d5827d6728f05adc1d478648859d3ff0 1500604285 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jul 21 10:31:25 2017 +0800]","Body":"ISSUE #263: Enable request rate limiter in zookeeper client\n\nDescriptions of the changes in this PR:\n\nEanble request rate limiter in zookeeper client. The rate limiter logic is in place, but is never enabled. This change is to expose the settings in configurations and enable them in zookeeper client at both client and server.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <None>, Jia Zhai <None>\n\nThis closes #264 from sijie/interface_syncs, closes #263\n","Date":"Fri Jul 21 04:31:25 CEST 2017"},{"Commit-ID":"commit 626ce687e2342b8a75005cf018540fda76ee15d8 1500894482 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Mon Jul 24 13:08:02 2017 +0200]","Body":"Provide a minimal test case using v2wireprotocol option\n\nAdd testcases on addEntry/readEntries and basic fencing\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo\n\nThis closes #273 from eolivelli/issue-272-testv2\n","Date":"Mon Jul 24 13:08:02 CEST 2017"},{"Commit-ID":"commit 96d82102bef3152934f564db16373b12b1689ead 1500904982 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Mon Jul 24 16:03:02 2017 +0200]","Body":"Issue#243 - asyncAddEntry fails with NPE with LedgerHandlerAdv\n\nFix asyncAddEntry on LedgerHandleAdv and clean up the asyncAddEntry API, drops BKException which is never thrown in asynch functions\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo\n\nThis closes #244 from eolivelli/asyncadd-adv, closes #243\n","Date":"Mon Jul 24 16:03:02 CEST 2017"},{"Commit-ID":"commit 24ac8ead6240aaaaa845afccb4e606fbe0da1602 1500973476 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jul 25 11:04:36 2017 +0200]","Body":"BOOKKEEPER-1044: Entrylogger is not readding rolled logs back to the logChannelsToFlush list when exception happens while trying to flush rolled logs\n\nDescriptions of the changes in this PR:\n\nThis is a straightforward fix to add unflushed list of entry log files back to flushed list.\n\nTest is missing at this point because it is a bit complicated to test this without proper mocking. I would defer adding the test later and creating a github issue later on if it makes sense.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>\n\nThis closes #286 from sijie/BOOKKEEPER-1044\n","Date":"Tue Jul 25 11:04:36 CEST 2017"},{"Commit-ID":"commit ce57acaa1686493fd32fc58d3332d956db06122b 1500973683 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jul 25 11:08:03 2017 +0200]","Body":"ISSUE #247: Missing JavaDoc for classes\n\nDescriptions of the changes in this PR:\n\n- Addressed the `TODO` comments by adding JavaDoc\n- Make sure there is a Github issue for each unaddressed `TODO` comment\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>\n\nThis closes #285 from sijie/issue_247, closes #247\n","Date":"Tue Jul 25 11:08:03 CEST 2017"},{"Commit-ID":"commit 313cfa66018836e8d6372b06c29ec551fca91e34 1501060012 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Wed Jul 26 17:06:52 2017 +0800]","Body":"BOOKKEEPER-1017: Create documentation for ZooKeeper ACLs\n\nThis is the documentation for ZooKeeper security and there is an intro about security in general.\nIt is work-in-progress, I created this PR in order to make it visible and gather suggestions while writing\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <None>\n\nThis closes #185 from eolivelli/BOOKKEEPER-1017-zookeeper-docs\n","Date":"Wed Jul 26 11:06:52 CEST 2017"},{"Commit-ID":"commit f27bf45e2643016742f997e3c467363cc3407be7 1501066806 -----sp","Author":"PersonIdent[Nicolò Boschi, nicolo.boschi@diennea.com, Wed Jul 26 13:00:06 2017 +0200]","Body":"ISSUE #196: Create Jenkins configuration using OpenStack Jenkins Job Builder\n\nDescriptions of the changes in this PR:\n\nIntroduction of Jenkins Job Builder script, in order to have the configuration of Jenkins jobs directly stored in GIT repo.\nThis will enable reviews of Jenkins configuration\n\nAuthor: Nicolò Boschi <nicolo.boschi@diennea.com>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #206 from nicoloboschi/JenkinsJobBuilder, closes #196\n","Date":"Wed Jul 26 13:00:06 CEST 2017"},{"Commit-ID":"commit 671ec2b21d6e603f00abc8f92a04bbec7d5750b2 1501079317 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia03@gmail.com, Wed Jul 26 16:28:37 2017 +0200]","Body":"ISSUE #295: LocalBookKeeper fails to start up\n\nDescriptions of the changes in this PR:\n\nremote the zk port and zk servers from the classes and use the values passed in from the method.\n\nAuthor: Jia Zhai <zhaijia03@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>\n\nThis closes #298 from zhaijack/issue_295, closes #295\n","Date":"Wed Jul 26 16:28:37 CEST 2017"},{"Commit-ID":"commit c00cb9f69104c99d7ad10242c04175a5d9ef3801 1501124643 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Thu Jul 27 05:04:03 2017 +0200]","Body":"ISSUE #271: LedgerHandle#readEntries leaks ByteBufs\n\nAdd a setNettyUsePooledBuffers() client configuration option to let the user decide to use Pooled vs Unpooled ByteBufs.\nUsing v2 wire protocol Application receives the original ByteBuf return from Channel and it is responsible for 'releasing' it.\n\nAdd assertions on LedgerEntry to prevent the user from accessing data more then once\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Matteo Merli, Sijie Guo\n\nThis closes #276 from eolivelli/issue-271-leaks, closes #271\n","Date":"Thu Jul 27 05:04:03 CEST 2017"},{"Commit-ID":"commit d5f824755028e08e07e7f3b326b097148c9b3bec 1501168033 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Thu Jul 27 23:07:13 2017 +0800]","Body":"ISSUE #308: LocalBookKeeper.java rethrow Exception in case of failed boot\n\nDo not swallow generic Exceptions during the boot of LocalBookKeeper and let the caller handle errors\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <None>\n\nThis closes #309 from eolivelli/issue-308-localboo-exce, closes #308\n","Date":"Thu Jul 27 17:07:13 CEST 2017"},{"Commit-ID":"commit c9cf161d81d3fb8afd0af647e1f3d23f9fb50f04 1501204132 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jul 28 09:08:52 2017 +0800]","Body":"ISSUE #306: Update SCM info for using mvn:release\n\nDescriptions of the changes in this PR:\n\n- update the SCM info in the pom files, so that mvn:release is able to create release branch.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <None>, Matteo Merli <None>\n\nThis closes #307 from sijie/use_maven_release, closes #306\n","Date":"Fri Jul 28 03:08:52 CEST 2017"},{"Commit-ID":"commit 7a480d3f8e5ec5c8c3592c332cbcab19b4043dad 1501211477 -----sp","Author":"PersonIdent[zhaijack, zhaijia03@gmail.com, Fri Jul 28 11:11:17 2017 +0800]","Body":"ISSUE #296: Bookie supports ephemeral port\n\nDescriptions of the changes in this PR:\n\n- add a flag to allow/disable using ephemeral ports\n- change the initialization sequence to support ephmeral port\n- added two tests on verifying this behavior\n\nAuthor: zhaijack <zhaijia03@gmail.com>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <None>\n\nThis closes #297 from zhaijack/issue_296, closes #296\n","Date":"Fri Jul 28 05:11:17 CEST 2017"},{"Commit-ID":"commit 0ccbc0e9c3e6a82d5e44b8347cc6567e043f253f 1501216743 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Fri Jul 28 12:39:03 2017 +0800]","Body":"BOOKKEEPER-1104: Fix testWithDiskFullAndAbilityToCreateNewIndexFile\n\nThe usage threshhold was chosen to be very close to the actual disk\nusage at test time.  This made the test unnecessarily fragile in the\ncase that there other things concurrently using the disk.  Since we\naren't really testing that here, simply set the threshhold to be really\nlow.\n\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Jia Zhai <None>, Matteo Merli <None>\n\nThis closes #310 from athanatos/forupstream/BOOKKEEPER-1104\n","Date":"Fri Jul 28 06:39:03 CEST 2017"},{"Commit-ID":"commit b63eb86da3757a3740f922093128868d5a53394c 1501234303 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Fri Jul 28 17:31:43 2017 +0800]","Body":"ISSUE #300: EnsemblePlacementPolicy must not use com.google.common.base.Optional but java.util.Optional\n\nUse standard java8 java.util.Optional instead of Optional from Guava.\nIn BookKeeper 4.5 we are shading Guava so this class is not available to downstream projects\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Matteo Merli <None>, Sijie Guo <None>\n\nThis closes #302 from eolivelli/issue-300-no-guava, closes #300\n","Date":"Fri Jul 28 11:31:43 CEST 2017"},{"Commit-ID":"commit cf2936548aa7f91e99bb53a8d53cbca567649535 1501265557 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jul 28 11:12:37 2017 -0700]","Body":"BOOKKEEPER-935: Javadoc improvements and publish sources and javadocs to Maven Central\n\nDescriptions of the changes in this PR:\n\n- sources: attached source jar for each module\n- javadocs: attached javdocs jar for bookkeeper-server, bookkeeper-stats (they are client-facing modules)\n\nfor javadocs:\n- improve javadoc:aggregate to generate new client-facing api doc. it is comprised with 3 sections now : bookkeeper client, bookkeeper stats api, bookkeeper stats providers\n- auditing the client package to make changes to avoid expose internal classes to public.\n- introduce interface audience and stability for documenting public interfaces\n- improve javadoc for publish api\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis patch had conflicts when merged, resolved by\nCommitter: Sijie Guo <sijie@apache.org>\n\nThis closes #311 from sijie/attach_sources_jar\n","Date":"Fri Jul 28 20:12:37 CEST 2017"},{"Commit-ID":"commit fdbea38d9767e6eb28fbf8ec7c61491be3e06e66 1501271674 -----sp","Author":"PersonIdent[Luc Perkins, lucperkins@gmail.com, Fri Jul 28 12:54:34 2017 -0700]","Body":"ISSUE #294: Beta version of the new website\n\nA generated version of the new site can be seen here:\n\nhttps://lucperkins.github.io/bookkeeper/\n\nAuthor: Luc Perkins <lucperkins@gmail.com>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis patch had conflicts when merged, resolved by\nCommitter: Sijie Guo <sijie@apache.org>\n\nThis closes #293 from lucperkins/documentation-changes, closes #294\n","Date":"Fri Jul 28 21:54:34 CEST 2017"},{"Commit-ID":"commit 3908d9ce6a5530ae2ae8526b9988b983423c026c 1501274098 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Fri Jul 28 13:34:58 2017 -0700]","Body":"BOOKKEEPER-1103: Fix LedgerMetadataCreateTest random id loop\n\nThe previous version would loop indefinitely upon collision.\n\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #303 from athanatos/forupstream/BOOKKEEPER-1103\n","Date":"Fri Jul 28 22:34:58 CEST 2017"},{"Commit-ID":"commit 809f2cbf16d9ecb1b04fda23d610deea4c9bfabe 1501289988 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jul 28 17:59:48 2017 -0700]","Body":"ISSUE #320: add scripts for publishing new website to staging and apache\n\nDescriptions of the changes in this PR:\n\n- script for staging changes to a staging-site repo\n- steps for how to staging changes for reviews\n- script for pushing changes to apache\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Luc Perkins <lucperkins@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #322 from sijie/publish_scripts, closes #320\n","Date":"Sat Jul 29 02:59:48 CEST 2017"},{"Commit-ID":"commit 50f67361d5deea529d0af80a61e3312a8dd31e7e 1501537557 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jul 31 14:45:57 2017 -0700]","Body":"ISSUE #323: [WEBSITE] ci job to automatically publish website to apache once the pull request is merged\n\nDescriptions of the changes in this PR:\n\n- add a Dockerfile to use ruby:2.4.1 to build website\n- add scripts to run docker file interactively (run.sh) and in ci (ci.sh)\n- also remove a few scripts that were not used by jenkins anymore.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nThis closes #332 from sijie/sijie/jenkin_jobs, closes #323\n","Date":"Mon Jul 31 23:45:57 CEST 2017"},{"Commit-ID":"commit f581e030c79abbde81bf165603fccdb5e6a1d38a 1501568070 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia03@gmail.com, Mon Jul 31 23:14:30 2017 -0700]","Body":"ISSUE #314: Enable checkstyle on bookkeeper-server\n\nDescriptions of the changes in this PR:\n\n- enable checkstyle plugin in bookkeeper-server with a suppression configuration file\n- enable sort order rule (it was disabled when the rule was imported)\n\nAuthor: Jia Zhai <zhaijia03@gmail.com>\nAuthor: zhaijack <zhaijia03@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #315 from zhaijack/enable_checkstyle, closes #314\n","Date":"Tue Aug 01 08:14:30 CEST 2017"},{"Commit-ID":"commit a5f8580f53464065243a9af038935f5893434166 1501569247 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Mon Jul 31 23:34:07 2017 -0700]","Body":"BOOKKEEPER-1102: Clarify BookieInfoReader and fix associated test flappers\n\nBookieInfoReader:\n\nThe previous syncronization logic wasn't really correct, and the logic\nat the top of the method was far more complicated than it needed to be.\nRestrict bookies to be non-null.  Restructure the code to simply use\nthe BookieInfoReader instance as a single lock.\n\nOne significant behavioral change is that we scan every bookie not in\nthe map, and we clear from the map bookies which returned an error.\n\nAlso, explicitely cache the most recent bookie set reported by the\nBookieWatcher.  This eliminates the need to call into BookieWatcher\nfrom getReadWriteBookieInfo and the corresponding error path.  The\nperiodic scan continues to explicitely check.\n\nAnother departure is the addition of an explicit retry-on-error param to\ntrigger retry if any of the requests failed\n(getBookieInfoRetryIntervalSeconds).  We'll only retry the ones that\nactually failed (along with any new additions since the last run).  This\nis useful because bookie startup triggers the addition of the bookie\nnode to zk before the bookie actually becomes available for the bookie\ninfo request, so there can be rare races in the unit tests between\nBookieInfoReader requesting the info and the bookie actually being up.\n\nAlso, add a method to allow tests to wait for updates to be reflected.\n\nPerChannelBookieClient: fix error handling for BookieInfo keys\n\nPassing a key corresponding to a GET_BOOKIE_INFO operation to\nerrorOutReadKey results in a casting exception, clean up the invalid\ncalls.\n\nBookKeeperClusterTestCase: add killBookieAndWaitForZK\n\nShould reduce the need for tests to wait for an arbitrary period to let\nthe cluster \"settle\".\n\nBookKeeperDiskSpaceWeightedLedgerPlacementTest:\n\nThis test was heavily time dependent, and the Thread.sleep values did\nnot work universally.  Instead, eliminate the arbitrary Thread.sleep\nvalues and instead verify the free space changes on each change.\n\nAlso, switch the delay on\ntestDiskSpaceWeightedBookieSelectionWithPeriodicBookieInfoUpdate\nto simply use an atomic boolean to signal the value switch.\n\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis patch had conflicts when merged, resolved by\nCommitter: Sijie Guo <sijie@apache.org>\n\nThis closes #275 from athanatos/forupstream/BOOKKEEPER-1102\n","Date":"Tue Aug 01 08:34:07 CEST 2017"},{"Commit-ID":"commit b299a699794c1f0aa8447704795361739a8bd055 1501617258 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Aug 1 12:54:18 2017 -0700]","Body":"ISSUE #321: Update \"who are we?\"\n\nDescriptions of the changes in this PR:\n\n- add JV to the PMC list\n- add siddharth and charan to the committers list\n- sort the people by apache ids\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #334 from sijie/sijie/update_who_are_we, closes #321\n","Date":"Tue Aug 01 21:54:18 CEST 2017"},{"Commit-ID":"commit 3daf94143ba2b1352a56c68e1b886d7d7cd499a5 1501617499 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia03@gmail.com, Tue Aug 1 12:58:19 2017 -0700]","Body":"ISSUE #339: Use ephemeral port for bookkeeper tests and variable unit test improvements\n\nDescriptions of the changes in this PR:\n\n- Enable ephemeral port by default for all BookKeeperClusterTestCase based test cases\n- Removed Multi* based classes. A lot of unit tests unnecessarily extended from those base classes. Converted them to extend BookKeeperClusterTestCase directly. Confirmed this with sijie\n- Reduce sleep period for some test cases\n\nLedgerEntry fixes for #317\n- use checkState rather than checkNull to keep the behavior consistent as before\n- fix BookKeeperTest#testReadEntryReleaseByteBufs\n\nTestBackwardCompat:\n- removed testCompact400 (400 has been very long time ago, no one is running 400)\n- BookKeeperNettyServer should shut down netty server when failed to construct a bookie\n\nTestDiskChecker:\n- increased the threshold to 0.99f. be consistent with TestBKConfiguration\n\nBookieInitializationTest\n- make each test method using different ledgers path, so registration won't be conflicting between tests\n\nBookieJournalRollingTest\n- make sure bookie port is used correctly on restarting bookies.\n\nAuthor: Jia Zhai <zhaijia03@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #340 from zhaijack/use_ephemral_ports, closes #339\n","Date":"Tue Aug 01 21:58:19 CEST 2017"},{"Commit-ID":"commit 3713aa7e09eb99f6d9c7221943e40bc33a025071 1501622239 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Aug 1 14:17:19 2017 -0700]","Body":"ISSUE #344: add a releases page\n\nDescriptions of the changes in this PR:\n\nAdd a releases page for keeping the history of apache releases.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Luc Perkins <lucperkins@gmail.com>\n\nThis closes #345 from sijie/redirection_on_old_releases, closes #344\n","Date":"Tue Aug 01 23:17:19 CEST 2017"},{"Commit-ID":"commit 45e7f08f6a88de2fbb2f23df4c15a88625edff5d 1501622304 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia03@gmail.com, Tue Aug 1 14:18:24 2017 -0700]","Body":"ISSUE #333: [WEBSITE] add bookkeeper slack channel to README.md and website\n\nDescriptions of the changes in this PR:\n\n- add slack channel to README\n- add slack channel to website\n\nAuthor: Jia Zhai <zhaijia03@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Luc Perkins <lucperkins@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #341 from zhaijack/issue_333, closes #333\n","Date":"Tue Aug 01 23:18:24 CEST 2017"},{"Commit-ID":"commit 8e0bd2c3d81b522e97434d8646915f36422a104b 1501627786 -----sp","Author":"PersonIdent[kishorekasi, kkasiud1@gmail.com, Tue Aug 1 15:49:46 2017 -0700]","Body":"BOOKKEEPER-588: SSL Support for Bookkeeper\n\n+ Merged changes from eoliville\n+ Mutual Authentication\n\nAuthor: kishorekasi <kkasiud1@gmail.com>\nAuthor: Kishore Kasi Udayashankar <kudayashankar@salesforce.com>\nAuthor: Kishore Udayashankar <kudayashankar@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis patch had conflicts when merged, resolved by\nCommitter: Sijie Guo <sijie@apache.org>\n\nThis closes #183 from kishorekasi/BOOKKEEPER-588-kishore\n","Date":"Wed Aug 02 00:49:46 CEST 2017"},{"Commit-ID":"commit 41f63c86a3d228887f08946dde14d485a40ac7b9 1501636591 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Aug 2 09:16:31 2017 +0800]","Body":"Address the problem on merging #183\n\nDescriptions of the changes in this PR:\n\nlistenOn should be running in constructing netty server. because we use binding to prevent two bookies start at the same time. #183\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #348 from sijie/ssl_merge, closes #183\n","Date":"Wed Aug 02 03:16:31 CEST 2017"},{"Commit-ID":"commit 610b603a34c0d7fbea151f7d1fd4951a6db1ac9b 1501654688 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia03@gmail.com, Tue Aug 1 23:18:08 2017 -0700]","Body":"ISSUE #351: Apache rat check failed on master\n\nDescriptions of the changes in this PR:\n\nExcludes cacerts from apache-rat check\n\nAuthor: Jia Zhai <zhaijia03@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #352 from zhaijack/fix_rat_issue, closes #351\n","Date":"Wed Aug 02 08:18:08 CEST 2017"},{"Commit-ID":"commit 3b7c06481262d5ac84c1a79fa2479570975100a6 1501707104 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia03@gmail.com, Wed Aug 2 13:51:44 2017 -0700]","Body":"ISSUE #351: Apache rat check failed on master\n\nDescriptions of the changes in this PR:\n\nThis fix on #352 was adding the exclusion rule in wrong location. this fix is to address that.\n\nAuthor: Jia Zhai <zhaijia03@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #353 from zhaijack/fix_rat_issue, closes #351\n","Date":"Wed Aug 02 22:51:44 CEST 2017"},{"Commit-ID":"commit 23f9d815f1f7fa6fa3df55883fa2ec22535d1d2b 1501707137 -----sp","Author":"PersonIdent[Luc Perkins, lucperkins@gmail.com, Wed Aug 2 13:52:17 2017 -0700]","Body":"Fix navbar hover issue on the main page\n\nThis PR fixes the navbar dropdown UX issue shown in the attached image.\n\n<img width=\"681\" alt=\"screen shot 2017-08-02 at 10 04 20 am\" src=\"https://user-images.githubusercontent.com/1523104/28886622-05333fcc-776f-11e7-8bea-163f60acaaa1.png\">\n\nAuthor: Luc Perkins <lucperkins@gmail.com>\n\nReviewers: Matteo Merli <mmerli@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #370 from lucperkins/docs/fix-dropdown\n","Date":"Wed Aug 02 22:52:17 CEST 2017"},{"Commit-ID":"commit 8b895d3087130107f4b5714560e7493349c10f5d 1501748071 -----sp","Author":"PersonIdent[zhaijack, zhaijia03@gmail.com, Thu Aug 3 16:14:31 2017 +0800]","Body":"ISSUE #360: [DOCUMENTATION] configuration settings\n\nDescriptions of the changes in this PR:\n-  make sure bk_server.conf contains all the settings in ServerConfiguration.java\n-  update site/docs/reference/config.md (http://bookkeeper.apache.org/test/content/docs/reference/config/)\n\n---\nBe sure to do all of the following to help us incorporate your contribution\nquickly and easily:\n\n- [X] Make sure the PR title is formatted like:\n    `<Issue # or BOOKKEEPER-#>: Description of pull request`\n    `e.g. Issue 123: Description ...`\n    `e.g. BOOKKEEPER-1234: Description ...`\n- [ ] Make sure tests pass via `mvn clean apache-rat:check install findbugs:check`.\n- [X] Replace `<Issue # or BOOKKEEPER-#>` in the title with the actual Issue/JIRA number.\n\n---\n\nAuthor: zhaijack <zhaijia03@gmail.com>\n\nReviewers: Luc Perkins <None>, Sijie Guo <None>\n\nThis closes #368 from zhaijack/issue_360, closes #360\n","Date":"Thu Aug 03 10:14:31 CEST 2017"},{"Commit-ID":"commit 6c340e06bbc13bd5ce7526f3531a9bab23108776 1501748281 -----sp","Author":"PersonIdent[zhaijack, zhaijia03@gmail.com, Thu Aug 3 16:18:01 2017 +0800]","Body":"ISSUE #362: [DOCUMENTATION] update command line tools\n\nDescriptions of the changes in this PR:\n\nenrich doc for bookie shell\n\n---\nBe sure to do all of the following to help us incorporate your contribution\nquickly and easily:\n\n- [X] Make sure the PR title is formatted like:\n    `<Issue # or BOOKKEEPER-#>: Description of pull request`\n    `e.g. Issue 123: Description ...`\n    `e.g. BOOKKEEPER-1234: Description ...`\n- [ ] Make sure tests pass via `mvn clean apache-rat:check install findbugs:check`.\n- [X] Replace `<Issue # or BOOKKEEPER-#>` in the title with the actual Issue/JIRA number.\n\n---\n\nAuthor: zhaijack <zhaijia03@gmail.com>\n\nReviewers: Luc Perkins <None>, Sijie Guo <None>\n\nThis closes #369 from zhaijack/issue_362, closes #362\n","Date":"Thu Aug 03 10:18:01 CEST 2017"},{"Commit-ID":"commit 398d33218eb2d9a4932fa69b9b3a29f02b2dce02 1501794009 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Aug 3 14:00:09 2017 -0700]","Body":"Issue #377: Make Prometheus stats logger registration idempotent\n\nMake sure the metric are only registered once on Prometheus client lib.\n\nDiscusses in #377.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <None>, Sijie Guo <None>\n\nThis closes #378 from merlimat/fix-metrics-double-registration, closes #377\n","Date":"Thu Aug 03 23:00:09 CEST 2017"},{"Commit-ID":"commit 464fa55c6debf5fdc835077135846e89729321c6 1501795247 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Aug 3 14:20:47 2017 -0700]","Body":"Issue #372: Allow to configure advertised address in bookies\n\nAdd option to configure advertised address for bookies.\n\nReasons for this are outlined in #372\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <None>, Sijie Guo <None>\n\nThis closes #373 from merlimat/advertised-address, closes #372\n","Date":"Thu Aug 03 23:20:47 CEST 2017"},{"Commit-ID":"commit 70533f54a7e53a808f56e7a1112d0e0f7d260397 1501820185 -----sp","Author":"PersonIdent[eolivelli, eolivelli@apache.org, Fri Aug 4 12:16:25 2017 +0800]","Body":"ISSUE #269: upgrade findbugs to 3.0.4\n\nJust update findbugs plugin to latest version. No new warnings to address\n\nAuthor: eolivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Matteo Merli <None>\n\nThis closes #379 from eolivelli/findbugs-304, closes #269\n","Date":"Fri Aug 04 06:16:25 CEST 2017"},{"Commit-ID":"commit 7a500dc8082580ad4c85c307ef073edae3ae7f7a 1501820386 -----sp","Author":"PersonIdent[eolivelli, eolivelli@apache.org, Fri Aug 4 12:19:46 2017 +0800]","Body":"ISSUE #376: Skip getSysFileDescriptor if JournalRemovePagesFromCache=false\n\nSkip illegal reflective calls if not needed, this way the Bookie will run on Java9 cleanly\n\nWe need to access internals of FileDescriptor class only if JournalRemovePagesFromCache=true.\nThis change will allow to run the bookie on Java9 just by using JournalRemovePagesFromCache=false.\n\nsee #376\n\nAuthor: eolivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Matteo Merli <None>\n\nThis closes #380 from eolivelli/issue-376-minimal-java9, closes #376\n","Date":"Fri Aug 04 06:19:46 CEST 2017"},{"Commit-ID":"commit 423fa658419fe8b4b0731ede52b8f34610a3f663 1501824167 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Aug 3 22:22:47 2017 -0700]","Body":"ISSUE #381: update old releases url to achives\n\nDescriptions of the changes in this PR:\n\n- the cms content has been copied from cms to asf-site branch under /content/archives. it is available under http://bookkeeper.apache.org/test/content/archives/\n- update the release url from 'bookkeeper.apache.org/docs/rx.y.z' to '{{ site.baseurl }}achives/rx.y.z'\n\nscripts:\n\n- update the scripts to use clone and copy to avoid trash everything in remote. this would prevent overwrite `archives` directory.\n\ncontent:\n\n- fix syntax error in `shell.yaml` to be able to build website\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis closes #382 from sijie/fix_links, closes #381\n","Date":"Fri Aug 04 07:22:47 CEST 2017"},{"Commit-ID":"commit 18f5c6a0a3de8727bcc12a8f6b1747c9a6a3c305 1501833050 -----sp","Author":"PersonIdent[eolivelli, eolivelli@apache.org, Fri Aug 4 15:50:50 2017 +0800]","Body":"ISSUE #262: Useless option explicitLacInterval is set to 1 in default bk_server.conf\n\nRemove an useless line from default bk_server.conf file\n\nAuthor: eolivelli <eolivelli@apache.org>\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Matteo Merli <None>\n\nThis closes #375 from eolivelli/issue-262, closes #262\n","Date":"Fri Aug 04 09:50:50 CEST 2017"},{"Commit-ID":"commit 1c8101ed688d97fa93a8143c697f6c7489d5c6f9 1501880021 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Aug 4 13:53:41 2017 -0700]","Body":"ISSUE #383: mvn release:branch fails\n\nDescriptions of the changes in this PR:\n\n- change `compilerArguments` to `compilerArgs`\n- use `compilerArg` for configuring the arguments for compilation.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #384 from sijie/sijie/fix_release, closes #383\n","Date":"Fri Aug 04 22:53:41 CEST 2017"},{"Commit-ID":"commit 02580c0c2b2d998e1cdfdffe75458d3b7e85d1fc 1501890394 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Aug 5 07:46:34 2017 +0800]","Body":"ISSUE #391: CI failed with java.lang.ClassNotFoundException: org.hamcrest.SelfDescribing\n\nDescriptions of the changes in this PR:\n\n- include hamcrest dependency for tests (according to [junit](https://github.com/junit-team/junit4/wiki/Download-and-Install) instruction)\n- exclude `.repository` to turn ci builds to run with its own local repository\n- dump the rat check output to console (easier for debugging on jenkins)\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Matteo Merli <None>\n\nThis closes #392 from sijie/bookkeeper-test, closes #391\n","Date":"Sat Aug 05 01:46:34 CEST 2017"},{"Commit-ID":"commit 31960b027f391ee8ca7400cb3e647c20864966a3 1501913628 -----sp","Author":"PersonIdent[zhaijack, zhaijia03@gmail.com, Fri Aug 4 23:13:48 2017 -0700]","Body":"ISSUE #367: [DOCUMENTATION] add api readUnconfirmedEntries in website doc\n\nDescriptions of the changes in this PR:\n\nadd api readUnconfirmedEntries in website doc\n\n---\nBe sure to do all of the following to help us incorporate your contribution\nquickly and easily:\n\n- [X] Make sure the PR title is formatted like:\n    `<Issue # or BOOKKEEPER-#>: Description of pull request`\n    `e.g. Issue 123: Description ...`\n    `e.g. BOOKKEEPER-1234: Description ...`\n- [ ] Make sure tests pass via `mvn clean apache-rat:check install findbugs:check`.\n- [X] Replace `<Issue # or BOOKKEEPER-#>` in the title with the actual Issue/JIRA number.\n\n---\n\nAuthor: zhaijack <zhaijia03@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #371 from zhaijack/issue367, closes #367\n","Date":"Sat Aug 05 08:13:48 CEST 2017"},{"Commit-ID":"commit 8986f32db757799ea678fa8c31823566572f3082 1501915063 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Aug 4 23:37:43 2017 -0700]","Body":"ISSUE #393: [CI] publish-website job will be marked as failure if it is an empty commit\n\nDescriptions of the changes in this PR:\n\n- use `git diff-index` to checkout if there is any changes to commit or not\n- port some changes from CI back to script.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nThis closes #394 from sijie/issue_393, closes #393\n","Date":"Sat Aug 05 08:37:43 CEST 2017"},{"Commit-ID":"commit bf1d58f197b9a99863f563ce0fdcb0e1f3483b8d 1501921980 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Aug 5 16:33:00 2017 +0800]","Body":"ISSUE #390: [CI] Test errors in TestRackawareEnsemblePlacementPolicyUsingScript\n\nDescriptions of the changes in this PR:\n\n`Shell` class was ported from hadoop, but it contains a lot of unused code. Especially there is not `HADOOP_HOME` will set, so an exception will be thrown. (although the issue seems to be hidden in mac)\n\nThis change is to clean up the `Shell` class. The `Shell` class is only used for executing shell script configured in rackaware placement policy.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Enrico Olivelli <None>\n\nThis closes #396 from sijie/sijie/cleanup_shell, closes #390\n","Date":"Sat Aug 05 10:33:00 CEST 2017"},{"Commit-ID":"commit 1b7ed6be98a2f41dc61fa18c5e678deab933f48e 1501956350 -----sp","Author":"PersonIdent[JV, vjujjuri@salesforce.com, Sat Aug 5 11:05:50 2017 -0700]","Body":"[maven-release-plugin] prepare branch branch-4.5\n","Date":"Sat Aug 05 20:05:50 CEST 2017"},{"Commit-ID":"commit 59562a7bb2b300b0706d17e9fc034d6604b71626 1501956355 -----sp","Author":"PersonIdent[JV, vjujjuri@salesforce.com, Sat Aug 5 11:05:55 2017 -0700]","Body":"[maven-release-plugin] prepare for next development iteration\n","Date":"Sat Aug 05 20:05:55 CEST 2017"},{"Commit-ID":"commit cbcc64d6d0fd1a3d6738e4efcb0db3d5005ad0f8 1501971182 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Aug 5 15:13:02 2017 -0700]","Body":"ISSUE #397: [CI] publish-website job failed when mvn:release bump version to 4.6.0-SNAPSHOT\n\nDescriptions of the changes in this PR:\n\nUse `mvn install` rather than `mvn compile`\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <None>\n\nThis closes #398 from sijie/issue_397, closes #397\n","Date":"Sun Aug 06 00:13:02 CEST 2017"},{"Commit-ID":"commit d107f969a915362dfce8f1b66c221debd434aefd 1502024891 -----sp","Author":"PersonIdent[zhaijack, zhaijia03@gmail.com, Sun Aug 6 21:08:11 2017 +0800]","Body":"ISSUE #338: add first draft Docker image including community suggestions\n\nThis is the first part of #335. And it is based on #197\nMain changes:\n 327: Docker image: Drop versions and Alpine support.\n 260: Docker image: provide a way to pass any desired configuration property via ENV vars.\n\n---\nBe sure to do all of the following to help us incorporate your contribution\nquickly and easily:\n\n- [X] Make sure the PR title is formatted like:\n    `<Issue # or BOOKKEEPER-#>: Description of pull request`\n    `e.g. Issue 123: Description ...`\n    `e.g. BOOKKEEPER-1234: Description ...`\n- [ ] Make sure tests pass via `mvn clean apache-rat:check install findbugs:check`.\n- [X] Replace `<Issue # or BOOKKEEPER-#>` in the title with the actual Issue/JIRA number.\n\n---\n\nAuthor: zhaijack <zhaijia03@gmail.com>\n\nReviewers: Matteo Merli <None>, Sijie Guo <None>\n\nThis closes #342 from zhaijack/issue_338, closes #338\n","Date":"Sun Aug 06 15:08:11 CEST 2017"},{"Commit-ID":"commit c6e2f75dce44082e1a3b9ba06d1e37ed3ff5998f 1502102635 -----sp","Author":"PersonIdent[zhaijack, zhaijia03@gmail.com, Mon Aug 7 18:43:55 2017 +0800]","Body":"Fix zkCli issue\n\nDescriptions of the changes in this PR:\n/opt/zk/bin/zkCli.sh was leaked to replace by /opt/bookkeeper/bin/bookkeeper org.apache.zookeeper.ZooKeeperMain and cause:\n\n/opt/bookkeeper/entrypoint.sh: line 61: /opt/zk/bin/zkCli.sh: No such file or directory\n\nAuthor: zhaijack <zhaijia03@gmail.com>\n\nReviewers: Sijie Guo <None>\n\nThis closes #404 from zhaijack/docker_fix\n","Date":"Mon Aug 07 12:43:55 CEST 2017"},{"Commit-ID":"commit ae1ba84f0935fdac43e7dd500647a70b2c4ca7f3 1502130302 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Aug 7 11:25:02 2017 -0700]","Body":"ISSUE #325: [WEBSITE] how to manage documentation between releases\n\nDescriptions of the changes in this PR:\n\n- move `docs` to `docs/latest`\n- add a script to proceed release steps\n   - copy `docs/latest` to `docs/{version}`\n   - in docs/{version}, replace versions\n   - bump versions in `_config.yml`\n   - generate placeholders for releaseNotes\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Luc Perkins <lucperkins@gmail.com>, Jia Zhai <None>\n\nThis closes #400 from sijie/release_versions, closes #325\n","Date":"Mon Aug 07 20:25:02 CEST 2017"},{"Commit-ID":"commit 188d7e5fb8d8beb137f13a49b7df8a9cd861cefc 1502130742 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Aug 7 11:32:22 2017 -0700]","Body":"ISSUE #366: [DOCUMENTATION] LedgerHandleAdv\n\nDescriptions of the changes in this PR:\n\n- add documentation about LedgerHandleAdv\n- update overview\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis closes #401 from sijie/issue_366, closes #366\n","Date":"Mon Aug 07 20:32:22 CEST 2017"},{"Commit-ID":"commit f90fa787522d59114caa3fe8b70345effb627f8e 1502131306 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Aug 7 11:41:46 2017 -0700]","Body":"ISSUE #355: upgrade guide\n\nDescriptions of the changes in this PR:\n\n- provide a general upgrade guide\n- document notes for upgrading from 4.4 to 4.5.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Luc Perkins <lucperkins@gmail.com>, Jia Zhai <None>\n\nThis closes #403 from sijie/upgrade_guide, closes #355\n","Date":"Mon Aug 07 20:41:46 CEST 2017"},{"Commit-ID":"commit 49b90a66f830482fc970ba625057c7101c201f62 1502131579 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Aug 7 11:46:19 2017 -0700]","Body":"ISSUE #349: Documentation for security feature in 4.5.0\n\nDescriptions of the changes in this PR:\n\n- add a section for `security`\n- overview to introduce security feature\n- encryption and authentication using tls\n- sasl authentication\n- zookeeper authentication\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Luc Perkins <lucperkins@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #350 from sijie/security_docs, closes #349\n","Date":"Mon Aug 07 20:46:19 CEST 2017"},{"Commit-ID":"commit bee543487a2dd18034df2030a175b8f437f8fae3 1502136748 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Aug 7 13:12:28 2017 -0700]","Body":"ISSUE #349: Move `security` docs under `latest` (hotfix)\n\nDescriptions of the changes in this PR:\n\n#325 moved the docs to under `docs/latest`. so we need to move `security` docs to under `docs/latest/security`.\n\nAt the same time, fix two broken links.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nThis closes #408 from sijie/fix_bad_merges, closes #349\n","Date":"Mon Aug 07 22:12:28 CEST 2017"},{"Commit-ID":"commit b7b0a6845e5dc47c30d93d86797deb4aa463df04 1502139144 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Aug 7 13:52:24 2017 -0700]","Body":"Flip apache baseurl from `/test/content` to `/`\n\nDescriptions of the changes in this PR:\n\nINFRA is cutting the bookkeeper website from CMS to git. we need to flip '/test/content' to '/'.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <None>\n\nThis closes #411 from sijie/sijie/move_baseurl_to_root\n","Date":"Mon Aug 07 22:52:24 CEST 2017"},{"Commit-ID":"commit 755f8f624e20fb8775b100473c14d9775fe8851c 1502150166 -----sp","Author":"PersonIdent[Francesco Caliumi - Diennea, francesco.caliumi@diennea.com, Tue Aug 8 07:56:06 2017 +0800]","Body":"406\n\nDescriptions of the changes in this PR:\n- Fix non-privileged user execution\n- Change the Makefile in order to always use current user when run the bk image\n- Fix Makefile in order to run \"make run-demo\"\n- Adjust unneeded packages remove in Dockerfile\n\nAuthor: Francesco Caliumi - Diennea <francesco.caliumi@diennea.com>\n\nReviewers: Jia Zhai <None>, Matteo Merli <None>, Sijie Guo <None>\n\nThis closes #406 from caiok/master\n","Date":"Tue Aug 08 01:56:06 CEST 2017"},{"Commit-ID":"commit bbcf1d8aec197074f707bf3d16684705396322f3 1502250129 -----sp","Author":"PersonIdent[zhaijack, zhaijia03@gmail.com, Wed Aug 9 11:42:09 2017 +0800]","Body":"Fix typo: TSL should be TLS in server_conf\n\nTSL should be TLS in server_conf\n\nAuthor: zhaijack <zhaijia03@gmail.com>\n\nReviewers: Sijie Guo <None>\n\nThis closes #421 from zhaijack/fix_conf_typo\n","Date":"Wed Aug 09 05:42:09 CEST 2017"},{"Commit-ID":"commit 6e99bb7344463f6b132dd2df5ecc0f5de31909be 1502303342 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Aug 9 11:29:02 2017 -0700]","Body":"ISSUE #422: Don't use community layout for documentation pages\n\nDescriptions of the changes in this PR:\n\nThe layout of documentation page is marked as community. when users navigate to this page, it is a bit difficult for the users to figure out where they are. We should stick documentation pages to doc layout.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #423 from sijie/documentation_index, closes #422 and squashes the following commits:\n\n4ec16d6 [Sijie Guo] remove community layout for docs page\n21320b4 [Sijie Guo] The index page for documentation should use documentation layout rather than community layout\n","Date":"Wed Aug 09 20:29:02 CEST 2017"},{"Commit-ID":"commit eb316394c7d4c4426cfb86d2a9fc794302e5ad0d 1502312366 -----sp","Author":"PersonIdent[Luc Perkins, lucperkins@gmail.com, Wed Aug 9 13:59:26 2017 -0700]","Body":"Issue #416: Some small post-release documentation fixes\n\nThere were a few issues pointed out with the new BookKeeper website/documentation. This fixes issue #416 and makes a handful of spelling and wording fixes.\n\nAuthor: Luc Perkins <lucperkins@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #426 from lucperkins/docs/small-post-release-fixes, closes #416\n","Date":"Wed Aug 09 22:59:26 CEST 2017"},{"Commit-ID":"commit f5c96ebc9e5952a89f86d0a50093ff65c821701b 1502329280 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Aug 10 09:41:20 2017 +0800]","Body":"ISSUE #427: [WEBSITE] sidebar doesn't work on documentation index page\n\nDescriptions of the changes in this PR:\n\nsidebar uses `../../` for relative paths. in order to make this work, we need to move any pages under `docs` on level down and not use `index.md`.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Luc Perkins <None>, Matteo Merli <None>\n\nThis closes #428 from sijie/issue_427, closes #427\n","Date":"Thu Aug 10 03:41:20 CEST 2017"},{"Commit-ID":"commit 4615742cc3947e4794aa0afda668876fd01887b1 1502395008 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Aug 10 12:56:48 2017 -0700]","Body":"release 4.5.0: update website\n\nDescriptions of the changes in this PR:\n\nunder `site`, run `./scripts/release.sh`\n\nwhat the script does:\n\n- copy the `latest` to `4.5.0`.\n- finalize the version\n- update config yml\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nThis closes #429 from sijie/update_website_for_4.5_release\n","Date":"Thu Aug 10 21:56:48 CEST 2017"},{"Commit-ID":"commit 3ebd42936c3af4395823e2754155c0088eb6a579 1502396913 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Aug 10 13:28:33 2017 -0700]","Body":"ISSUE #356: Release notes 4.5.0\n\nDescriptions of the changes in this PR:\n\n- summary for release 4.5.0\n- highlights for 4.5.0\n- full list of JIRA and Github issues.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Matteo Merli <mmerli@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #402 from sijie/release_notes_4.5.0, closes #356\n","Date":"Thu Aug 10 22:28:33 CEST 2017"},{"Commit-ID":"commit 88a61eefcc23a72e9ec18d64168dddd0e2e01269 1502400125 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Aug 10 14:22:05 2017 -0700]","Body":"ISSUE #432: Add \"Google Analytics\" to the website\n\nDescriptions of the changes in this PR:\n\nAdd \"google analytics\" script to the website for tracking the documentation traffic. We can learn the pattern and improve documentation.\n\nThe google account for analytics is managed by bookkeeper pmc.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nThis closes #433 from sijie/google_analytics, closes #432\n","Date":"Thu Aug 10 23:22:05 CEST 2017"},{"Commit-ID":"commit b4a1c76054c54d05d38a89399efa716201a2206b 1502446988 -----sp","Author":"PersonIdent[zhaijack, zhaijia03@gmail.com, Fri Aug 11 03:23:08 2017 -0700]","Body":"ISSUE #414: use a clone of baseconf in new ServerConfiguration(baseConf)\n\nDescriptions of the changes in this PR:\nThis PR fix Issue #414 , and in the comments of that issue contains the anysis of the bug.  Main changes:\n- Privde a clone of baseConf while do loadconf(baseConf), so make baseConf and newConf work independently.\n- Remove 'loadConf(Configuration otherConf) ', since Configuration is an interface in common-configs and not have a clone method.\n\n---\nBe sure to do all of the following to help us incorporate your contribution\nquickly and easily:\n\n- [X] Make sure the PR title is formatted like:\n    `<Issue # or BOOKKEEPER-#>: Description of pull request`\n    `e.g. Issue 123: Description ...`\n    `e.g. BOOKKEEPER-1234: Description ...`\n- [ ] Make sure tests pass via `mvn clean apache-rat:check install findbugs:check`.\n- [X] Replace `<Issue # or BOOKKEEPER-#>` in the title with the actual Issue/JIRA number.\n\n---\n\nAuthor: zhaijack <zhaijia03@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #424 from zhaijack/issue_414, closes #414\n","Date":"Fri Aug 11 12:23:08 CEST 2017"},{"Commit-ID":"commit 1ff17d899f9998cdefc99c47f0f38a75b99d1c0e 1502489972 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Aug 11 15:19:32 2017 -0700]","Body":"ISSUE #431 ISSUE #221: merge scripts should mark milestone when merging pull requests\n\nDescriptions of the changes in this PR:\n\nimprove merge script to do:\n\n- assign a milestone\n- add `area/` label\n- add `type/` label\n- add `release/` label\n- when a change needs to merge to a different branch, add the bug fix `release/` label\n\nThis also addresses #221 to trim the template from pull request body.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <zhaijia03@gmail.com>\n\nThis closes #437 from sijie/merge_script_for_bug_releases, closes #431, closes #221\n","Date":"Sat Aug 12 00:19:32 CEST 2017"},{"Commit-ID":"commit caba6b1dbd7eab07c8c6dd518797c55739f3524e 1502490447 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Aug 11 15:27:27 2017 -0700]","Body":"ISSUE #435: Build javadoc for releases\n\nDescriptions of the changes in this PR:\n\n- add javadoc links on sidebar and overview pages (try to promote this link for users to find the link easier)\n- update javadoc-gen.sh to be able to generate latest javadoc and all javadocs for versions under `docs`\n\nminor fixes:\n- pass \"JEKYLL_ENV=production\" to docker because ci uses docker to build the documentation\n-\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nThis closes #438 from sijie/publish_javadocs, closes #435\n","Date":"Sat Aug 12 00:27:27 CEST 2017"},{"Commit-ID":"commit 739540896357e0079a946b95881a3cef4e6f9a72 1502491108 -----sp","Author":"PersonIdent[zhaijack, zhaijia03@gmail.com, Fri Aug 11 15:38:28 2017 -0700]","Body":"ISSUE #418: bump docker to use bk - 4.5.0\n\nDescriptions of the changes in this PR:\n-  bump the docker image to use 4.5.0 binary, update pgp_key and bk version.\n-  delete yum install for md5sum and sha1sum, since they are already in coreutils, which is default installed; and left them here will report error: 'No Match for argument: md5sum/sha1sum', while 'yum remove' in docker build.\n\nhave tested by running make run-dice.\n\nAuthor: zhaijack <zhaijia03@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Francesco Caliumi <None>\n\nThis closes #436 from zhaijack/issue_418, closes #418\n","Date":"Sat Aug 12 00:38:28 CEST 2017"},{"Commit-ID":"commit f657b5e00d2e44a3fa476a4ab2c933c4a404717a 1502491256 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Fri Aug 11 15:40:56 2017 -0700]","Body":"ISSUE #385: Upgrade to commons-lang 2.6\n\nUpgrade to commons-lang 2.6 which can run on Java9\nsee explanation on #385\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #386 from eolivelli/commonslang26, closes #385\n","Date":"Sat Aug 12 00:40:56 CEST 2017"},{"Commit-ID":"commit e988a3cb876b5939e103e36b985ddab05173569c 1502686448 -----sp","Author":"PersonIdent[zhaijack, zhaijia03@gmail.com, Sun Aug 13 21:54:08 2017 -0700]","Body":"ISSUE #441: fix typos\n\nDescriptions of the changes in this PR:\nFix typos in docker readme.\n\"Apache ZooKeeper is a software project of the Apache Software Foundation\"\n->\n\"Apache Bookkeeper is a software project of the Apache Software Foundation\"\n\n\"bookkepeer servers\" -> \"bookkeeper servers\"\n\n\"The client only need to connect to a Zookkeeper server in the ensamble\"\n->\n\"The client only need to connect to a Zookeeper server in the ensemble\"\n\ntypo of other place:\nbookeeper\n->\nbookkeeper\n\nwile\n->\nwhile\n\nacknoledge\n->\nacknowledge\n\nAuthor: zhaijack <zhaijia03@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #442 from zhaijack/issue_441, closes #441\n","Date":"Mon Aug 14 06:54:08 CEST 2017"},{"Commit-ID":"commit 9df2c62f2b1296aaf9e303e5aef26f90fbe184f9 1502732261 -----sp","Author":"PersonIdent[zhaijack, zhaijia03@gmail.com, Mon Aug 14 10:37:41 2017 -0700]","Body":"ISSUE #444: remove doc directory\n\nDescriptions of the changes in this PR:\n\nThe doc directory was used by CMS to generate the old bookkeeper website. since we already moved to a new jekyll website, the files in this directory are not used anymore. we can remove them.\n\nAuthor: zhaijack <zhaijia03@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #446 from zhaijack/issue_444, closes #444\n","Date":"Mon Aug 14 19:37:41 CEST 2017"},{"Commit-ID":"commit 0d1593773041dc8a9484ffcf130cb3678e19e825 1502733934 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Aug 14 11:05:34 2017 -0700]","Body":"ISSUE #440: Update \"who are we?\" page\n\nDescriptions of the changes in this PR:\n\n- add new DL PPMC members to BK PMC\n- fix full name and affiliations for a few members\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nThis closes #447 from sijie/issue_440-, closes #440\n","Date":"Mon Aug 14 20:05:34 CEST 2017"},{"Commit-ID":"commit 3b41dca602d87d511c203df61d3463d12f9fe756 1502733991 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Aug 14 11:06:31 2017 -0700]","Body":"ISSUE #443: Update the mailing list\n\nDescriptions of the changes in this PR:\n\nAdd a section about `issues` mailing list.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nThis closes #445 from sijie/issue_443, closes #443\n","Date":"Mon Aug 14 20:06:31 CEST 2017"},{"Commit-ID":"commit affc7b073ff229345a5569025f4b65983358a352 1502756527 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Aug 14 17:22:07 2017 -0700]","Body":"ISSUE #434: Move the content from wikis to website\n\nDescriptions of the changes in this PR:\n\ncopied bunch of links from wiki pages and re-organized the links under `community`.\n\n- first section: mailing list, issue tracking, release schedule and community meetings.\n- second section: a few guides on how to contribute, how to report issue and how to release\n- last section: resources (e.g. presentations, proposals)\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nThis closes #448 from sijie/sijie/move_contents, closes #434\n","Date":"Tue Aug 15 02:22:07 CEST 2017"},{"Commit-ID":"commit 2bdb069b9ea9bf114d7beed9d3a4502702fc444a 1502756842 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Aug 14 17:27:22 2017 -0700]","Body":"ISSUE #304: New Release Guide\n\nDescriptions of the changes in this PR:\n\nThis is an attempt to improve the current release guide base on a few references :  [Beam](https://beam.apache.org/contribute/release-guide/) [Pulsar](https://github.com/apache/incubator-pulsar/wiki/Release-process)\n\nAdd this in main repo for reviews. We can later on make it part of website once #293 is completed.\n\nA few items are TBD. comments are welcome.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #305 from sijie/release_guide, closes #304\n","Date":"Tue Aug 15 02:27:22 CEST 2017"},{"Commit-ID":"commit ab11ad85562b9fed1d4c6f4fbcbd70731a18ef24 1502759588 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia03@gmail.com, Mon Aug 14 18:13:08 2017 -0700]","Body":"Issue 141: graduation changes, remove/change incubate related things\n\n- remove the \"-incubating\" from the code base.\n- change website link from http://distributedlog.incubator.apache.org into https://bookkeeper.apache.org/distributedlog\n- change repo from https://github.com/apache/incubator-distributedlog into https://github.com/apache/distributedlog\n- git from https://git-wip-us.apache.org/repos/asf/incubator-distributedlog.git into https://gitbox.apache.org/repos/asf/distributedlog.git\n- remove website foot, whch contains incubate infos in websiteindex.md\n- remove Disclaimer file and its references\n\nAuthor: Jia Zhai <zhaijia03@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #143 from zhaijack/issue_141\n","Date":"Tue Aug 15 03:13:08 CEST 2017"},{"Commit-ID":"commit 6a8ed75be57d1ed4ace6bf34910a1093da9c5ef5 1502759588 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia03@gmail.com, Mon Aug 14 18:13:08 2017 -0700]","Body":"Issue 141: graduation changes, remove/change incubate related things\n\n- remove the \"-incubating\" from the code base.\n- change website link from http://distributedlog.incubator.apache.org into https://bookkeeper.apache.org/distributedlog\n- change repo from https://github.com/apache/incubator-distributedlog into https://github.com/apache/distributedlog\n- git from https://git-wip-us.apache.org/repos/asf/incubator-distributedlog.git into https://gitbox.apache.org/repos/asf/distributedlog.git\n- remove website foot, whch contains incubate infos in websiteindex.md\n- remove Disclaimer file and its references\n\nAuthor: Jia Zhai <zhaijia03@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #143 from zhaijack/issue_141\n","Date":"Tue Aug 15 03:13:08 CEST 2017"},{"Commit-ID":"commit d318022d356d4468b8ced7f1a97c78cdf11e8f74 1502759588 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia03@gmail.com, Mon Aug 14 18:13:08 2017 -0700]","Body":"Issue 141: graduation changes, remove/change incubate related things\n\n- remove the \"-incubating\" from the code base.\n- change website link from http://distributedlog.incubator.apache.org into https://bookkeeper.apache.org/distributedlog\n- change repo from https://github.com/apache/incubator-distributedlog into https://github.com/apache/distributedlog\n- git from https://git-wip-us.apache.org/repos/asf/incubator-distributedlog.git into https://gitbox.apache.org/repos/asf/distributedlog.git\n- remove website foot, whch contains incubate infos in websiteindex.md\n- remove Disclaimer file and its references\n\nAuthor: Jia Zhai <zhaijia03@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #143 from zhaijack/issue_141\n","Date":"Tue Aug 15 03:13:08 CEST 2017"},{"Commit-ID":"commit de9eecc180cc78fb65b509d7ae0e5ea82fd5dc8c 1502847424 -----sp","Author":"PersonIdent[Yiming Zang, yzang@twitter.com, Tue Aug 15 18:37:04 2017 -0700]","Body":"BOOKKEEPER-1100: Add module for Bookkeeper Http Endpoint\n\nAdd Bookkeeper Http Server as a new module [bookkeeper-http]\n\n1. Add children module [http-server], which provide generic api for setting up a Http Server for bookkeeper, allowing to plugin different Http frameworks and inject the implementation of different BK related services to Http Handler to handle different endpoints\n\n2. Add children module [vertx-http-server], which is a Vertx.io based http server implementation\n\n3. Add children module [twitter-http-server], which is a TwitterServer based http server implementation\n\n4. Add a package or org.apache.bookkeeper.http in [bookkeeper-server], which include all the implementation for the services that handle different http endpoint request.\n\nAuthor: Yiming Zang <yzang@twitter.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis patch had conflicts when merged, resolved by\nCommitter: Sijie Guo <sijie@apache.org>\n\nThis closes #278 from yzang/yzang/BOOKKEEPER-1100\n","Date":"Wed Aug 16 03:37:04 CEST 2017"},{"Commit-ID":"commit f5d2ba66d6253fb54811d3ceb40d4ef4591dfb20 1502847709 -----sp","Author":"PersonIdent[Andrey Yegorov, ayegorov@salesforce.com, Tue Aug 15 18:41:49 2017 -0700]","Body":"BOOKKEEPER-1105: RackAwarePolicy: Failure to map node into rack may result in failure to add other nodes.\n\n- RackAwarePolicy's no longer uses /default-region if rack mapping fails unless required (by RegionAwarePolicy)\n- it no longer fails to add rest of nodes after one node's failed addition,\n- added unit tests\n- added counters for successful/failed bookie adds/removal\n(PR description content here)...\n\nUpdateLedgerOpTest failed but it seems to be known/unrelated issue.\n\nAuthor: Andrey Yegorov <ayegorov@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #425 from dlg99/fix/rackaware\n","Date":"Wed Aug 16 03:41:49 CEST 2017"},{"Commit-ID":"commit 075d5b0e0cf7de9ef676a0a0389f08eb40d2196f 1503013913 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia03@gmail.com, Thu Aug 17 16:51:53 2017 -0700]","Body":"DL-2: DistributedLog should work with the official apache bookkeeper\n\nThis change is to upgrade bookkeeper version to BK 4.5.0.\n\n- upgrade bookkeeper version to 4.5.0-SNAPSHOT (still waiting a few pull requests to merge apache/bookkeeper#297 apache/bookkeeper#287\n  - change registerSuccessEvent for StatsLogger to add TimeUnit\n  - use netty4 eventloop\n  - move twitter repository dependencies to proxy related module only. core library will not depend on scala dependency anymore.\n\nThis change is a collaboration change with sijie\n\nWe will provide a performance comparison between 0.4.0 (using Twitter BK) and 0.5.0 (using BK 4.5.) in a separate pull request or email.\n\nAuthor: Jia Zhai <zhaijia03@gmail.com>\nAuthor: Jia Zhai <zhaijia@apache.org>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Leigh Stewart <lstewart@apache.org>\n\nThis closes #135 from zhaijack/bump_dl_version\n","Date":"Fri Aug 18 01:51:53 CEST 2017"},{"Commit-ID":"commit f528fb39918f01551327530f3567fdb36852abc4 1503013913 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia03@gmail.com, Thu Aug 17 16:51:53 2017 -0700]","Body":"DL-2: DistributedLog should work with the official apache bookkeeper\n\nThis change is to upgrade bookkeeper version to BK 4.5.0.\n\n- upgrade bookkeeper version to 4.5.0-SNAPSHOT (still waiting a few pull requests to merge apache/bookkeeper#297 apache/bookkeeper#287\n  - change registerSuccessEvent for StatsLogger to add TimeUnit\n  - use netty4 eventloop\n  - move twitter repository dependencies to proxy related module only. core library will not depend on scala dependency anymore.\n\nThis change is a collaboration change with sijie\n\nWe will provide a performance comparison between 0.4.0 (using Twitter BK) and 0.5.0 (using BK 4.5.) in a separate pull request or email.\n\nAuthor: Jia Zhai <zhaijia03@gmail.com>\nAuthor: Jia Zhai <zhaijia@apache.org>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Leigh Stewart <lstewart@apache.org>\n\nThis closes #135 from zhaijack/bump_dl_version\n","Date":"Fri Aug 18 01:51:53 CEST 2017"},{"Commit-ID":"commit eaed168536d09c2e56e52fc4a43aabb41b44e6e2 1503013913 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia03@gmail.com, Thu Aug 17 16:51:53 2017 -0700]","Body":"DL-2: DistributedLog should work with the official apache bookkeeper\n\nThis change is to upgrade bookkeeper version to BK 4.5.0.\n\n- upgrade bookkeeper version to 4.5.0-SNAPSHOT (still waiting a few pull requests to merge apache/bookkeeper#297 apache/bookkeeper#287\n  - change registerSuccessEvent for StatsLogger to add TimeUnit\n  - use netty4 eventloop\n  - move twitter repository dependencies to proxy related module only. core library will not depend on scala dependency anymore.\n\nThis change is a collaboration change with sijie\n\nWe will provide a performance comparison between 0.4.0 (using Twitter BK) and 0.5.0 (using BK 4.5.) in a separate pull request or email.\n\nAuthor: Jia Zhai <zhaijia03@gmail.com>\nAuthor: Jia Zhai <zhaijia@apache.org>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Leigh Stewart <lstewart@apache.org>\n\nThis closes #135 from zhaijack/bump_dl_version\n","Date":"Fri Aug 18 01:51:53 CEST 2017"},{"Commit-ID":"commit 3e4c02731787e730c039d6da17ab85b69e73daa1 1503344285 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Mon Aug 21 21:38:05 2017 +0200]","Body":"ISSUE #407: Enable allowLoopback when starting localbookie\n\nAdd allowLoopback=true flag in ServerConfiguration used in main() of LocalBookie facility\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nThis closes #457 from eolivelli/issue-407, closes #407\n","Date":"Mon Aug 21 21:38:05 CEST 2017"},{"Commit-ID":"commit b15e167f49d968d0e990a0eb467ca1f186bdc0a7 1503406951 -----sp","Author":"PersonIdent[Arvin, arvindevel@gmail.com, Tue Aug 22 21:02:31 2017 +0800]","Body":"ISSUE #254: Remove BookKeeperTools\n\nDescriptions of the changes in this PR:\nremove the BookKeeperTools,\nupdate the latest admin docs and BookieRecoveryTest's annotation.\n\nAuthor: Arvin <arvindevel@gmail.com>\n\nReviewers: Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #452 from ArvinDevel/master, closes #254\n","Date":"Tue Aug 22 15:02:31 CEST 2017"},{"Commit-ID":"commit 35cffdf6a38b5dba702b11e5902d5aa745429b01 1503426883 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Tue Aug 22 11:34:43 2017 -0700]","Body":"ISSUE #453: fix image broken in website\n\nDescriptions of the changes in this PR:\nFix image broken in website\n\nAfter fix, image works well.\n<img width=\"1535\" alt=\"default\" src=\"https://user-images.githubusercontent.com/26834121/29500286-ee3e4d88-8651-11e7-80c2-d4febffb0bfe.png\">\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #455 from zhaijack/issue_453, closes #453\n","Date":"Tue Aug 22 20:34:43 CEST 2017"},{"Commit-ID":"commit e28ea6baecc181f90b5e26f5456ec3b657938b24 1503427105 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Tue Aug 22 11:38:25 2017 -0700]","Body":"ISSUE #410: BookKeeper binary distribution package contains a CHANGES.txt file\n\nDrop CHANGES.txt\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #456 from eolivelli/issue-410, closes #410\n","Date":"Tue Aug 22 20:38:25 CEST 2017"},{"Commit-ID":"commit f4a9a53ce725f8c495e100430a05dc13942d0837 1503493646 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Wed Aug 23 15:07:26 2017 +0200]","Body":"ISSUE #459: fix loadConf in AbstractConfiguration\n\nDescriptions of the changes in this PR:\nIn loadConf, call setProperty for all k-v in baseConf.\nPlease reference #459 for more anlysis and details.\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #460 from zhaijack/issue_459, closes #459\n","Date":"Wed Aug 23 15:07:26 CEST 2017"},{"Commit-ID":"commit 13f88fec96258124e7c20f90f9ed3babced5dc81 1503552340 -----sp","Author":"PersonIdent[Yiming Zang, yzang@twitter.com, Wed Aug 23 22:25:40 2017 -0700]","Body":"DL-206: Delete the log should also delete the underline ledgers\n\nProblem:\nWe're not deleting the ledgers when we delete the whole log stream using dlm.delete() API. This would cause a lot of garbage/orphan ledgers in Bookkeeper.\n\nThe fix is to delete the ledger when we delete the log stream. Also added a test to validate.\n\nAuthor: Yiming Zang <yzang@twitter.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #152 from yzang/yzang/DL-206\n","Date":"Thu Aug 24 07:25:40 CEST 2017"},{"Commit-ID":"commit 17c5c445db8a700c595e620ab33275f33c95e4a6 1503559750 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Thu Aug 24 09:29:10 2017 +0200]","Body":"ISSUE #464: Add JaCoCo code coverage configuration to master pom.xml\n\nIntroduce JaCoCo configuration to the master pom.xml.\nJaCoCo handles Java8 syntax better than Cobertura\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #465 from eolivelli/issue-464-jacoco, closes #464\n","Date":"Thu Aug 24 09:29:10 CEST 2017"},{"Commit-ID":"commit 51c660ec87a541a4827742569da72a649e2ed5c7 1503568785 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Thu Aug 24 17:59:45 2017 +0800]","Body":"ISSUE #337: Docker image: K8s for bookkeeper and instructions on usage\n\nDescriptions of the changes in this PR:\n\nK8s deployment for bookkeeper and instructions on usage\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Luc Perkins <lucperkins@gmail.com>\n\nThis closes #461 from zhaijack/issue_337, closes #337\n","Date":"Thu Aug 24 11:59:45 CEST 2017"},{"Commit-ID":"commit 160e975a98abfa18a8de9423137763e4a1125b47 1503795281 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Aug 27 08:54:41 2017 +0800]","Body":"ISSUE #466: Move backward compatibility tests into a separate module\n\nDescriptions of the changes in this PR:\n\n- move backward compatibility test related stuffs to a separate module `test/backward`.\n- fix checkstyle for backward compatibility related tests\n- other pom file changes: move common dependencies to root pom, use variables\n- for bookkeeper-server module, produce a non-shaded jar and a shaded jar. so applications can choose what jar to use.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #467 from sijie/integration_tests, closes #466\n","Date":"Sun Aug 27 02:54:41 CEST 2017"},{"Commit-ID":"commit 814edb69dda698e6f719bf4b0c970c206064f606 1503795590 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Aug 27 08:59:50 2017 +0800]","Body":"ISSUE #473: Bump protobuf version from 2.x to 3.x\n\nDescriptions of the changes in this PR:\n\n- Bump protobuf version from 2.x to 3.x\n- Removed the generated protobuf files from source repo.\n- Use maven protobuf plugin to generate the protobuf files.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #474 from sijie/protobuf3, closes #473\n","Date":"Sun Aug 27 02:59:50 CEST 2017"},{"Commit-ID":"commit 5c83b6e2ab7329c428b2c63415f3c695f4edaf12 1503910467 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Aug 28 01:54:27 2017 -0700]","Body":"ISSUE #343: TestFencing.testManyOpenParallel\n\nDescriptions of the changes in this PR:\n\nProblem:\n\nThe `LastAddConfirmed` was advanced due to piggyback on recovery adds. It will cause recovery adds become stall because\nof the entry id check.\n\nThis problem only occurs when there are multiple clients concurrently recover same ledger.\n\nSolution:\n\nDisable lac piggyback on recovery adds.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #477 from sijie/tests, closes #343\n","Date":"Mon Aug 28 10:54:27 CEST 2017"},{"Commit-ID":"commit 6e6556f29ecbf966404423b7d67897e5dcba712a 1503910853 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Aug 28 02:00:53 2017 -0700]","Body":"ISSUE #462: TestTLS failures\n\nDescriptions of the changes in this PR:\n\nProblem:\n\nThe behavior of loading configuration in `AbstractConfiguration` was changed recently.\nSo the TLS provider was not cleared correctly for the failed tests.\n\nSolution:\n\nExplicitly clear TLS provider for each configuratio to address the failed tests.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #478 from sijie/fix_tls_test, closes #462\n","Date":"Mon Aug 28 11:00:53 CEST 2017"},{"Commit-ID":"commit b2c2e9e597eb970f511d21adff00fda00b5b6360 1503910903 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Mon Aug 28 02:01:43 2017 -0700]","Body":"ISSUE #475: Move code-coverage activation to a Maven profile\n\nMove JaCoCo and Coveralls.io configuration to a separate code-coverage profile\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #476 from eolivelli/issue-475-profile-codecoverage, closes #475\n","Date":"Mon Aug 28 11:01:43 CEST 2017"},{"Commit-ID":"commit c0fdfa5c1a05bd5cadb175928aa02a8e1c3f1e1f 1503911385 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Aug 28 02:09:45 2017 -0700]","Body":"ISSUE #468: Introduce JMH for micro benchmarking\n\nDescriptions of the changes in this PR:\n\n- add a `test/jmh` module for micro-benchmarking\n- add a protocol related test: serializing and deserializing requests\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis patch had conflicts when merged, resolved by\nCommitter: Sijie Guo <sijie@apache.org>\n\nThis closes #469 from sijie/add_jmh_benchmark, closes #468\n","Date":"Mon Aug 28 11:09:45 CEST 2017"},{"Commit-ID":"commit ae58e92bd3f0c17ed242544a097dd19656d39c42 1503993918 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Aug 29 16:05:18 2017 +0800]","Body":"ISSUE #479: CompactionTest#testCompactionWithEntryLogRollover failed\n\nDescriptions of the changes in this PR:\n\n- restart bookie with disabling gc for #testCompactionWithEntryLogRollover\n- improve other tests to remove `Thread.sleep` and use a more deterministic way for doing gc\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #480 from sijie/fix_compaction_test, closes #479\n","Date":"Tue Aug 29 10:05:18 CEST 2017"},{"Commit-ID":"commit dd9680373188948f0e7b8f3b994309626a472856 1504049824 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Aug 30 07:37:04 2017 +0800]","Body":"ISSUE #463: Improve bookkeeper unit test\n\nDescriptions of the changes in this PR:\n\n- remove `timeout` on individual tests, instead setting globalTimeout on base test `BookKeeperClusterTestCase` to simplify managing timeout on individual tests\n- use maven docker build to run unit tests\n- zookeeper cluster uses port 0\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #481 from sijie/merge_fix, closes #463\n","Date":"Wed Aug 30 01:37:04 CEST 2017"},{"Commit-ID":"commit 29e74229eda138c13c88ec890ce3d2c215972303 1504078231 -----sp","Author":"PersonIdent[arvindkandhare, arvind.kandhare@emc.com, Wed Aug 30 09:30:31 2017 +0200]","Body":"ISSUE #274: Ensuring the right number of bookies are passed.\n\nDescriptions of the changes in this PR:\nThis fixes #274. Ensures that benchmark measure right number of bookies for the warmup.\n\nAuthor: arvindkandhare <arvind.kandhare@emc.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #482 from arvindkandhare/issue-274-benchmarkfix, closes #274\n","Date":"Wed Aug 30 09:30:31 CEST 2017"},{"Commit-ID":"commit 0e76212e2295032b2fad29de58bbeacb9c0018ac 1504162065 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Wed Aug 30 23:47:45 2017 -0700]","Body":"ISSUE #156: Provide a shading jar for distributedlog-core\n\nDescriptions of the changes in this PR:\n\n- provide a shade-all jar (shading all the dependencies) for distributedlog-core. the `shade-all` jar is classified as `shaded`.\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #161 from zhaijack/shade_libs, closes #156\n","Date":"Thu Aug 31 08:47:45 CEST 2017"},{"Commit-ID":"commit 813c675e8d6a5a92d73821ddd1f49883ff2eb0c7 1504162253 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Aug 30 23:50:53 2017 -0700]","Body":"DL-45: DL should allow ByteBuf based API to avoid copying bytes array\n\nDescriptions of the changes in this PR:\n\nThis change leverages the `ByteBuf` api introduced in bookkeeper 4.5.0. It will avoid copying bytes array between LogRecord and LogRecordSet/Entry, and avoid copying bytes from DL to BK client.\n\nThis change also bump the lz4 library to `1.3.0` to leverage the `ByteBuffer` binding.\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Jia Zhai <zhaijia03@gmail.com>\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>, Leigh Stewart <None>\n\nThis closes #151 from sijie/zero_copy\n","Date":"Thu Aug 31 08:50:53 CEST 2017"},{"Commit-ID":"commit 25abd3675da9a6fc7b47ea80a5f1556eb129de8b 1504162253 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Aug 30 23:50:53 2017 -0700]","Body":"DL-45: DL should allow ByteBuf based API to avoid copying bytes array\n\nDescriptions of the changes in this PR:\n\nThis change leverages the `ByteBuf` api introduced in bookkeeper 4.5.0. It will avoid copying bytes array between LogRecord and LogRecordSet/Entry, and avoid copying bytes from DL to BK client.\n\nThis change also bump the lz4 library to `1.3.0` to leverage the `ByteBuffer` binding.\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Jia Zhai <zhaijia03@gmail.com>\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>, Leigh Stewart <None>\n\nThis closes #151 from sijie/zero_copy\n","Date":"Thu Aug 31 08:50:53 CEST 2017"},{"Commit-ID":"commit 5a5ad4625548a5ba78764e01f83dcdbfe0cbeca2 1504162253 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Aug 30 23:50:53 2017 -0700]","Body":"DL-45: DL should allow ByteBuf based API to avoid copying bytes array\n\nDescriptions of the changes in this PR:\n\nThis change leverages the `ByteBuf` api introduced in bookkeeper 4.5.0. It will avoid copying bytes array between LogRecord and LogRecordSet/Entry, and avoid copying bytes from DL to BK client.\n\nThis change also bump the lz4 library to `1.3.0` to leverage the `ByteBuffer` binding.\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Jia Zhai <zhaijia03@gmail.com>\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>, Leigh Stewart <None>\n\nThis closes #151 from sijie/zero_copy\n","Date":"Thu Aug 31 08:50:53 CEST 2017"},{"Commit-ID":"commit fd27e99ecbb152ef7bbf05a36a9d85c8997d3744 1504224777 -----sp","Author":"PersonIdent[Arvin, arvindevel@gmail.com, Fri Sep 1 08:12:57 2017 +0800]","Body":"ISSUE #485: Change 'segment' to 'fragment' in docs\n\nDescriptions of the changes in this PR:\n Change  'segment' to 'fragment' in docs, and make some relative code more clearer\n\nAuthor: Arvin <arvindevel@gmail.com>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #486 from ArvinDevel/issue_485, closes #485\n","Date":"Fri Sep 01 02:12:57 CEST 2017"},{"Commit-ID":"commit 34b2920f9890f5ab320094b8584f9f93720fd71f 1504282696 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Sat Sep 2 00:18:16 2017 +0800]","Body":"y\n\nDescriptions of the changes in this PR:\nWhen added the documentation, the sidebar was not updated, need to update to include k8s deployment.\n\nAfter fix:\n<img width=\"1371\" alt=\"default\" src=\"https://user-images.githubusercontent.com/26834121/29860959-4101c23a-8d9a-11e7-8e6b-3eeb17a3a5b4.png\">\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #484 from zhaijack/fix_sidebar\n","Date":"Fri Sep 01 18:18:16 CEST 2017"},{"Commit-ID":"commit efc115af4979a5d2009714586daf5e8651a4be3f 1504282853 -----sp","Author":"PersonIdent[Arvin, arvindevel@gmail.com, Sat Sep 2 00:20:53 2017 +0800]","Body":"Issue #430: Add an instruction in docker README to run standalone cluster\n\nDescriptions of the changes in this PR:\nAdd an instruction in docker README to run standalone cluster, and change the docker image description more accurately\n\nAuthor: Arvin <arvindevel@gmail.com>\n\nReviewers: Francesco Caliumi <None>, Jia Zhai <None>\n\nThis closes #470 from ArvinDevel/issue_430, closes #430\n","Date":"Fri Sep 01 18:20:53 CEST 2017"},{"Commit-ID":"commit e48f9d02924208ad1e929c2876ae2acfcfab0c5d 1504661320 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Tue Sep 5 18:28:40 2017 -0700]","Body":"ISSUE #492: set the protobuf syntax to 'proto2'\n\nDescriptions of the changes in this PR:\n\nExplicitly set protobuf syntax to `proto2`.\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #493 from zhaijack/metadata/set_protobuf_syntax_version, closes #492\n","Date":"Wed Sep 06 03:28:40 CEST 2017"},{"Commit-ID":"commit 8c8338738c8e54087990f25c15d18eafd7935ef4 1504668282 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Sep 6 11:24:42 2017 +0800]","Body":"ISSUE #166: Code cleanup for 0.5.0 release\n\nDescriptions of the changes in this PR:\n\n- add InterfaceAudience and InterfaceStability for public API to inform people what changes would be expected for those interface.\n- avoid using guava classes in public API since we will provide a shaded jar for distributedlog-core\n- enable ImportOrder checkstyle rule in some modules\n- move `org.apache.distributedlog.io` to `distributedlog-common` module\n- rename `setReadyToFlush` to `flush` and rename `flushAndSync` to `commit` for the new API\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Leigh Stewart <None>\n\nThis closes #172 from sijie/finalize_api, closes #166\n","Date":"Wed Sep 06 05:24:42 CEST 2017"},{"Commit-ID":"commit 7da9187853c12ee6cf64287e0d5fcb56bdd2b6d0 1504668282 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Sep 6 11:24:42 2017 +0800]","Body":"ISSUE #166: Code cleanup for 0.5.0 release\n\nDescriptions of the changes in this PR:\n\n- add InterfaceAudience and InterfaceStability for public API to inform people what changes would be expected for those interface.\n- avoid using guava classes in public API since we will provide a shaded jar for distributedlog-core\n- enable ImportOrder checkstyle rule in some modules\n- move `org.apache.distributedlog.io` to `distributedlog-common` module\n- rename `setReadyToFlush` to `flush` and rename `flushAndSync` to `commit` for the new API\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Leigh Stewart <None>\n\nThis closes #172 from sijie/finalize_api, closes #166\n","Date":"Wed Sep 06 05:24:42 CEST 2017"},{"Commit-ID":"commit ae9dbfe9c5f1862af664cb51efaf7446276c16a2 1504668282 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Sep 6 11:24:42 2017 +0800]","Body":"ISSUE #166: Code cleanup for 0.5.0 release\n\nDescriptions of the changes in this PR:\n\n- add InterfaceAudience and InterfaceStability for public API to inform people what changes would be expected for those interface.\n- avoid using guava classes in public API since we will provide a shaded jar for distributedlog-core\n- enable ImportOrder checkstyle rule in some modules\n- move `org.apache.distributedlog.io` to `distributedlog-common` module\n- rename `setReadyToFlush` to `flush` and rename `flushAndSync` to `commit` for the new API\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Leigh Stewart <None>\n\nThis closes #172 from sijie/finalize_api, closes #166\n","Date":"Wed Sep 06 05:24:42 CEST 2017"},{"Commit-ID":"commit 96a45e2a5733c91d89f9e91755ac3f42fdcea4d4 1504668465 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Sep 6 11:27:45 2017 +0800]","Body":"ISSUE #496: some docker images don't need port forwarding\n\nDescriptions of the changes in this PR:\n\nsome docker images don't need port forwarding. remove port forwarding from them.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #497 from sijie/remove_docker_port, closes #496\n","Date":"Wed Sep 06 05:27:45 CEST 2017"},{"Commit-ID":"commit abb311cdf839c02a941f416e6f97c8b85afd6fb0 1504766008 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Sep 6 23:33:28 2017 -0700]","Body":"ISSUE #160: Introduce backward compatibility testing\n\nDescriptions of the changes in this PR:\n\nThe core testing logic is in `tests/bin/docker-backward-test.sh`.\n\n- introduce an all module for packaging\n- add docker images for 0.3.51, 0.4.0-incubating and latest\n- add two backward compat testing module\n- using docker images for backward compatibility testing\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Leigh Stewart <None>\n\nThis closes #175 from sijie/docker_image, closes #160\n","Date":"Thu Sep 07 08:33:28 CEST 2017"},{"Commit-ID":"commit 1459adbe39715c94b012113b58f1be76c99a79b6 1504769837 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Thu Sep 7 15:37:17 2017 +0800]","Body":"[maven-release-plugin] prepare branch release-0.5.0\n","Date":"Thu Sep 07 09:37:17 CEST 2017"},{"Commit-ID":"commit fae15d4249505003ef940687dd5203d396a12bdf 1504769867 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Thu Sep 7 15:37:47 2017 +0800]","Body":"[maven-release-plugin] prepare for next development iteration\n","Date":"Thu Sep 07 09:37:47 CEST 2017"},{"Commit-ID":"commit a5c061ce5a99f85b9496c7f010093ee0ccb40052 1504769867 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Thu Sep 7 15:37:47 2017 +0800]","Body":"[maven-release-plugin] prepare for next development iteration\n","Date":"Thu Sep 07 09:37:47 CEST 2017"},{"Commit-ID":"commit b9af3d5d7cc8961ec839e1f28b1b7495f38fe971 1504769867 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Thu Sep 7 15:37:47 2017 +0800]","Body":"[maven-release-plugin] prepare for next development iteration\n","Date":"Thu Sep 07 09:37:47 CEST 2017"},{"Commit-ID":"commit d338addc369cbe3b96af4ee4232d0cce7d72d089 1504786587 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Thu Sep 7 14:16:27 2017 +0200]","Body":"ISSUE #494: Rename ZkVersion to LongVersion\n\nDescriptions of the changes in this PR:\n\n- rename `ZkVersion` to `LongVersion`\n- move it from `meta` package to `versioning` package\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>\n\nThis closes #495 from zhaijack/metadata/rename_zkversion_to_longversion, closes #494\n","Date":"Thu Sep 07 14:16:27 CEST 2017"},{"Commit-ID":"commit 131d1272e53e59645f6cf250e84f29da11568a08 1505293944 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Sep 13 17:12:24 2017 +0800]","Body":"ISSUE #507: Introduce @FlakyTest annotation for marking a few tests as flaky\n\nDescriptions of the changes in this PR:\n\n- introduced FlakyTest annotation\n- mark a few tests as flaky tests (create issues for them)\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #504 from sijie/mark_test_as_failures, closes #507\n","Date":"Wed Sep 13 11:12:24 CEST 2017"},{"Commit-ID":"commit aa03c523126a2ad9aa0cae3665410bbc4dfb5edd 1505529506 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Sep 16 10:38:26 2017 +0800]","Body":"BOOKKEEPER-31: Project Logo\n\nDescriptions of the changes in this PR:\n\n- upload the bookkeeper logo to site directory (including both svg and png format)\n- add &trademark; to Apache BookKeeper.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis closes #511 from sijie/BOOKKEEPER-31\n","Date":"Sat Sep 16 04:38:26 CEST 2017"},{"Commit-ID":"commit 777a89c5a133207fe6cd0b27590d6588a65f957d 1515874017 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Sun Sep 17 02:11:00 2017 -0700]","Body":"Stream Store: Protocol module\n\n- add the protocol module for protocol related classes\n- basic concepts (collection, stream), rpc service, clients\n\n(cherry-picked from stream storage work, co-authored by Jia Zhai and Sijie Guo)\n","Date":"Sun Sep 17 11:11:00 CEST 2017"},{"Commit-ID":"commit 6befd491916326d856f42da9537a62ccdd58fb77 1515874035 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Sun Sep 17 02:38:56 2017 -0700]","Body":"Stream Store: Define the table API in stream store.\n\n(cherry-picked from stream storage work, co-authored by Jia Zhai and Sijie Guo)\n","Date":"Sun Sep 17 11:38:56 CEST 2017"},{"Commit-ID":"commit 32ad5134fdc36d6d1dfb9bca840d5cc3780a44a2 1515874113 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Sun Sep 17 15:28:29 2017 -0700]","Body":"Stream Store: Client\n\n- add client module\n- implement the location, root range and metadata range apis\n- implement the table api\n\n(cherry-picked from stream storage work, co-authored by Jia Zhai and Sijie Guo)\n","Date":"Mon Sep 18 00:28:29 CEST 2017"},{"Commit-ID":"commit e62bd805d1f66c971284837649d6194f22f18991 1515874134 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Sun Sep 17 16:44:57 2017 -0700]","Body":"Stream Store : storage api & impl\n\n(cherry-picked from stream storage work, co-authored by Jia Zhai and Sijie Guo)\n","Date":"Mon Sep 18 01:44:57 CEST 2017"},{"Commit-ID":"commit eba4d6e5d7eab8beab699c6dba8ac41e5ceec3db 1505777004 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Sep 19 07:23:24 2017 +0800]","Body":"ISSUE #515: Run bookies using hostIP instead of containerIP in k8s\n\nDescriptions of the changes in this PR:\n\n- use `status.hostIP` rather than `status.containerIP`. so the identifier (ip) of a bookie pod will not be changed after it is restarted.\n- use `adverstiseAddress` to advertise hostip as the ip of a bookie pod\n- change it to use `hierarchical` ledger manager\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis closes #516 from sijie/run_bookie_using_hostport_bk, closes #515\n","Date":"Tue Sep 19 01:23:24 CEST 2017"},{"Commit-ID":"commit 3ede9c6c507aa93432757c4f1fe47c538fa83e34 1505812228 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Tue Sep 19 11:10:28 2017 +0200]","Body":"ISSUE #508: Introduce lifecycle components for managing components in bookie server\n\nDescriptions of the changes in this PR:\n\nThe motivation of creating lifecycle components is described in #508.\n\nThis changes include:\n\n- create bookkeeper-common module, move some common classes (such as interface annotations) to common module.\n- add the lifecycle components in bookkeeper-common module.\n- add a package `org.apache.bookkeeper.server` for keeping all server related classes.\n- rewrite BookieServer using the lifecycle components: stats provider | bookie server | auto recovery | http endpoint\n- BookieServer is still kept for backward compatible, all the main functions are delegated to `org.apache.bookkeeper.server.Main`.\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>\n\nThis closes #509 from zhaijack/metadata/lifecycle_management, closes #508\n","Date":"Tue Sep 19 11:10:28 CEST 2017"},{"Commit-ID":"commit 31bef62d7e63d5a8b198dd09ca2e72646a6bffc8 1505918199 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Wed Sep 20 16:36:39 2017 +0200]","Body":"ISSUE #499: make a package contains all the jar\n\nDescriptions of the changes in this PR:\nThis is a sub-task for #458:\nMake Prometheus provider the default in bk_server.conf,\nInclude stats providers in a -all package,\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>\n\nThis closes #500 from zhaijack/all_bin, closes #499\n","Date":"Wed Sep 20 16:36:39 CEST 2017"},{"Commit-ID":"commit 80b7676045c34f4678f754f7f78d77c156ba518d 1506503013 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Wed Sep 27 11:03:33 2017 +0200]","Body":"ISSUE #517: port shared-resource-manager utils from distributredlog\n\nDescriptions of the changes in this PR:\n\nTry to portshared-resource-manager utils  from DistributedLog, so it can be used later on.\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>\n\nThis closes #518 from zhaijack/shared_resource, closes #517\n","Date":"Wed Sep 27 11:03:33 CEST 2017"},{"Commit-ID":"commit 2bbecd7da52824c991e1a28573ccf8c8515ea5dd 1507026719 -----sp","Author":"PersonIdent[Yiming Zang, yzang@twitter.com, Tue Oct 3 12:31:59 2017 +0200]","Body":"BOOKKEEPER-1106: Introduce write FileInfo cache and read FileInfo cache\n\nProblem: when read behind happens, it would quickly read bunch of ledgers, which will evict current active ledgers for writing from the ledger cache. with the ledger being evicted from cache, it would impact the write performance.\n\nThis feature is contributed by sijie , in which we introduced write file info cache and read file info cache to cache the ledger index separately for read and write, so that when catch up read happens, it will not evict the file info for writes.\n\nAuthor: Yiming Zang <yzang@twitter.com>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>, Jia Zhai\n\nThis closes #513 from yzang/yzang/BOOKKEEPER-1106\n","Date":"Tue Oct 03 12:31:59 CEST 2017"},{"Commit-ID":"commit 8399707f054e5d387e1af18384efab4cd1b26e57 1507027574 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Tue Oct 3 12:46:14 2017 +0200]","Body":"ISSUE #527: Introduce backoff and retry utilities\n\nDescriptions of the changes in this PR:\nMainly want to  Introduce backoff and retires utilities:\nBackoff implements various backoff strategiesis, and id intended to determine the duration after which a task is to be retried.\nRetries is a util class for supporting retries with customized backoff.\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #528 from zhaijack/retries_backoff, closes #527\n","Date":"Tue Oct 03 12:46:14 CEST 2017"},{"Commit-ID":"commit 029fc609cd4933b55af4d40af69ef59dad83a842 1507085178 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Wed Oct 4 10:46:18 2017 +0800]","Body":"ISSUE #532: Drop all @Test(timeout) annotations\n\nSimply drop the 'timeout' parameter for Test annotations, we have already a global timeout set in surefire configuration\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #533 from eolivelli/task/cleaup-timeouts, closes #532\n","Date":"Wed Oct 04 04:46:18 CEST 2017"},{"Commit-ID":"commit d82dc1c3e64e12e27ac8492ecbd4204a5529099c 1507085468 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Oct 4 10:51:08 2017 +0800]","Body":"ISSUE #535: Prometheus metrics provider fails to initialize\n\nDescriptions of the changes in this PR:\n\n- the parameter of `collectorNames` should be Collector rather than String\n- add test case for prometheus metrics provider\n- rename the classes to under `org.apache.bookkeeper.stats.prometheus` rather than taking the common `stats` package.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis closes #536 from sijie/fix_promethus, closes #535\n","Date":"Wed Oct 04 04:51:08 CEST 2017"},{"Commit-ID":"commit 758cdebb655bb68f7fd8017d289ce66ba9072e3e 1507102249 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Oct 4 00:30:49 2017 -0700]","Body":"ISSUE #537: Compilation warning on unchecked cast\n\nDescriptions of the changes in this PR:\n\nadd `SuppressWarnings(\"unchecked\")` in TestPrometheusMetricsProvider.java\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #538 from sijie/fix_compilation_error, closes #537\n","Date":"Wed Oct 04 09:30:49 CEST 2017"},{"Commit-ID":"commit e5cd0fe690f47575f62761f7bd4f3ad35c42c801 1507106895 -----sp","Author":"PersonIdent[Arvin, arvindevel@gmail.com, Wed Oct 4 01:48:15 2017 -0700]","Body":"ISSUE #181: Enable LogRecord ByteBuf based constructor public\n\nDescriptions of the changes in this PR:\nchange LogRecord ByteBuf based constructor to public\n\nAuthor: Arvin <arvindevel@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #182 from ArvinDevel/issue_181, closes #181\n","Date":"Wed Oct 04 10:48:15 CEST 2017"},{"Commit-ID":"commit db06aca15b5bab62500ea973c7626636e2f173a9 1507107585 -----sp","Author":"PersonIdent[Arvin, arvindevel@gmail.com, Wed Oct 4 01:59:45 2017 -0700]","Body":"ISSUE #165: Enable checkstyle in core module\n\nDescriptions of the changes in this PR:\n\nFix checkstyle error in core module\n\nAuthor: Arvin <arvindevel@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #192 from ArvinDevel/enable_check, closes #165\n","Date":"Wed Oct 04 10:59:45 CEST 2017"},{"Commit-ID":"commit 32ad7bae8201b3b7ce5fe7431f099fb9380eb8f8 1507107897 -----sp","Author":"PersonIdent[Arvin, arvindevel@gmail.com, Wed Oct 4 02:04:57 2017 -0700]","Body":"ISSUE #193: Shade Bookkeeper and unshade ZooKeeper in core module\n\nDescriptions of the changes in this PR:\n\nShade Bookkeeper and unshade ZooKeeper in core module\n\nAuthor: Arvin <arvindevel@gmail.com>\n\nReviewers: Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #194 from ArvinDevel/shade_bk, closes #193\n","Date":"Wed Oct 04 11:04:57 CEST 2017"},{"Commit-ID":"commit 9d0f5b00ac82d37f57a67984c731d95a1895e700 1507845035 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Oct 4 02:48:04 2017 -0700]","Body":"Avoid copying bytebuf for constructing log record to write\n","Date":"Wed Oct 04 11:48:04 CEST 2017"},{"Commit-ID":"commit 2de1f6dbd278e518c19378748606646158e9bad3 1507844643 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Oct 4 03:07:05 2017 -0700]","Body":"Fix the flaky test TestBKDistributedLogManager.deleteDuringRead\n","Date":"Wed Oct 04 12:07:05 CEST 2017"},{"Commit-ID":"commit 9694fd263a3ee5e03740f99ca21e99918262f395 1507188160 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Oct 5 00:22:40 2017 -0700]","Body":"ISSUE #540: BookieServer failed to start because lifecycle component name is not provided\n\nDescriptions of the changes in this PR:\n\n- add component name `bookie-server`\n- remove the catch block\n- fix the prometheus stats provider package name in configuration files.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #541 from sijie/fix_lifecycle_stack, closes #540\n","Date":"Thu Oct 05 09:22:40 CEST 2017"},{"Commit-ID":"commit 655057cf2fff39dcb1be3d508799080a373efc78 1507188288 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Oct 5 00:24:48 2017 -0700]","Body":"ISSUE #534: Download docs reference old release\n\nDescriptions of the changes in this PR:\n\nuse the latest release in the download page\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #539 from sijie/fix_documentation, closes #534\n","Date":"Thu Oct 05 09:24:48 CEST 2017"},{"Commit-ID":"commit 79f359ff9b77cfce23d52d7a99715768497ee00f 1507627719 -----sp","Author":"PersonIdent[Ivan Kelly, ivan@ivankelly.net, Tue Oct 10 11:28:39 2017 +0200]","Body":"ISSUE #525: Refactor PerChannelBookieClient\n\nThere's a lot of duplicate code in PerChannelBookieClient, particularly in the completions. It makes it more difficult to add anything to the class.\n\nConcretely the patch:\n- Factors out common code from PCBC completions\n- Makes erroring out a member of completion classes\n- Refactors out writing and flushing messages, so all RPCs use same code path\n- Moves timeout handling into CompletionValue\n- Moves response handling into completions\n- Moves logging and status conversion into a common method\n\nAuthor: Ivan Kelly <ivan@ivankelly.net>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #526 from ivankelly/refactor-pcbc, closes #525\n","Date":"Tue Oct 10 11:28:39 CEST 2017"},{"Commit-ID":"commit 7d3d02e588c1a06f195533c48c5af8149b813978 1507686274 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Oct 11 09:44:34 2017 +0800]","Body":"ISSUE #547: Allow load extra lifecycle components when running a bookie server.\n\nDescriptions of the changes in this PR:\n\n- make a common `ServerLifecycleComponet` for the components loaded by a bookie server\n- add a flag to allow start extra components.\n- add test cases\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #548 from sijie/loadable_components, closes #547\n","Date":"Wed Oct 11 03:44:34 CEST 2017"},{"Commit-ID":"commit 95373234a273920fadc06742479ddcc4e603fa1b 1507700626 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Wed Oct 11 13:43:46 2017 +0800]","Body":"ISSUE #520: Add more http endpoint\n\nDescriptions of the changes in this PR:\n\n#278 introduces BookKeeper Http Endpoint module. However there are only two endpoints, which is \u201c/heartbeat\u201d and \u201c/api/config/serverConfig\u201d. In order to fully leverage the http modules, The goal is to add more endpoints to this modules.\nPlease reference BP-17 for more details.\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #521 from zhaijack/http_endpoint, closes #520\n","Date":"Wed Oct 11 07:43:46 CEST 2017"},{"Commit-ID":"commit c2bf327c907080e2ec40c460dcf9c768fc0699d1 1507701758 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Oct 11 14:02:38 2017 +0800]","Body":"ISSUE #197: Provide a guide for running on k8s\n\nDescriptions of the changes in this PR:\n\nadd one page for how to deploy on k8s. it is based on http://bookkeeper.apache.org/docs/latest/deployment/kubernetes/ and use distributedlog image and add instructions on how to create distributedlog namespaces and run benchmark.\n\nThis change is based on #196\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #198 from sijie/add_docker, closes #197\n","Date":"Wed Oct 11 08:02:38 CEST 2017"},{"Commit-ID":"commit bd50cacd2b759d53b06a2356c5a9369b6100d635 1507911269 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Fri Oct 13 18:14:29 2017 +0200]","Body":"ISSUE #506: BP-15 New CreateLedger API\n\nBP-15 New CreateLedeger API\nIntroduce new org.apache.bookkeeper.client.api package\nIntroduce new Mockito based test suite for BookKeeper client\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie.apache.org>, Ivan Kelly <ivank@apache.org>\n\nThis closes #549 from eolivelli/bp15-createledger-api-2, closes #506\n","Date":"Fri Oct 13 18:14:29 CEST 2017"},{"Commit-ID":"commit 7d7497b70507ea3d31b184ebe04d98c733e2cf5b 1508225197 -----sp","Author":"PersonIdent[Ali Ahmed, a.ahmed@streaml.io, Tue Oct 17 09:26:37 2017 +0200]","Body":"ISSUE #561: Remove exec commands to start in the shell pid\n\nAuthor: Ali Ahmed <a.ahmed@streaml.io>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>, Jia Zhai, Sijie Guo <sijie@apache.org>\n\nThis closes #557 from aahmed-se/master, closes #561\n","Date":"Tue Oct 17 09:26:37 CEST 2017"},{"Commit-ID":"commit 40a7f1de440e6aec0b6640fc34a0ec7460c29ab7 1508225567 -----sp","Author":"PersonIdent[Robert Evans, evans@yahoo-inc.com, Tue Oct 17 15:32:47 2017 +0800]","Body":"BOOKKEEPER-1062: Fixed the race in AuditorLedgerCheckerTest\n\nDescriptions of the changes in this PR:\n\nThis fixes the race condition in the auditor between read only bookies and available bookies.  But because I am not sure of the performance impacts to modifying getReadOnlyBookies, I have opted to add in a new getROBookies.  But I am happy to change it.  This pull request is mostly to show my work and see what others think.\n\nAuthor: Robert Evans <evans@yahoo-inc.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #556 from revans2/BOOKKEEPER-1062\n","Date":"Tue Oct 17 09:32:47 CEST 2017"},{"Commit-ID":"commit 1bd7a80bd295b8e9c82281764864ec949222b5cb 1508257328 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Tue Oct 17 18:22:08 2017 +0200]","Body":"ISSUE #559: Fix findbugs error on SyncCallbackUtils\n\nFix FindBugs warning BC_UNCONFIRMED_CAST in  class SyncCallbackUtils\n\nAuthor: eolivelli <eolivelli@apache.org>\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Ivan Kelly <ivan@ivankelly.net>, Jia Zhai <None>\n\nThis closes #560 from eolivelli/findbugs-synccallback, closes #559\n","Date":"Tue Oct 17 18:22:08 CEST 2017"},{"Commit-ID":"commit 7254090d6a822e3c9c244c46fdb354bf56ddb2f3 1508310940 -----sp","Author":"PersonIdent[Ivan Kelly, ivan@midokura.com, Wed Oct 18 09:15:40 2017 +0200]","Body":"Fix for BookKeeperBuildersTest\n\nPrevious findbugs fix broke it.\n\nAuthor: Ivan Kelly <ivan@midokura.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #638 from ivankelly/bkbuildertest-fail\n","Date":"Wed Oct 18 09:15:40 CEST 2017"},{"Commit-ID":"commit d31dcbf6ba3a737d66ec3958f8443b007d4e5fad 1508311058 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@yahoo-inc.com, Wed Oct 18 09:17:38 2017 +0200]","Body":"Recycle buffers used in EntryLogger#addEntry\n\nTo avoid creating a buffer and letting it go out of scope and be GC'd\neach time.\n\nThis change was originally made by merlimat in the yahoo-4.3 branch.\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>, Ivan Kelly <ivank@apache.org>\n\nThis closes #639 from ivankelly/recycle-buf\n","Date":"Wed Oct 18 09:17:38 CEST 2017"},{"Commit-ID":"commit 1dc9789e89a6bf167ed965edb1ab51fbc449d897 1508311457 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@yahoo-inc.com, Wed Oct 18 09:24:17 2017 +0200]","Body":"Use ByteBuf for entrylogger reads\n\nOriginal patch from merlimat in yahoo-4.3 branch\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Ivan Kelly <ivank@apache.org>\n\nThis patch had conflicts when merged, resolved by\nCommitter: Enrico Olivelli <eolivelli@apache.org>\n\nThis closes #640 from ivankelly/refcount-for-read\n","Date":"Wed Oct 18 09:24:17 CEST 2017"},{"Commit-ID":"commit 4462bc31a6ac40b94efd2184e54e35cbc568199d 1508354098 -----sp","Author":"PersonIdent[Shoukun Huai, shoukunhuai@gmail.com, Wed Oct 18 12:14:58 2017 -0700]","Body":"ISSUE #213: Correct logger name in BKLogWriteHandler\n\ncorrect logger name in BKLogWriteHandler\n\nDescriptions of the changes in this PR:\n\n(PR description content here)...\n\nAuthor: Shoukun Huai <shoukunhuai@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #215 from shoukunhuai/issue-213, closes #213\n","Date":"Wed Oct 18 21:14:58 CEST 2017"},{"Commit-ID":"commit ecca567eb7f51355e2196e07b0400e2f8b16d026 1508354218 -----sp","Author":"PersonIdent[Arvin, arvindevel@gmail.com, Wed Oct 18 12:16:58 2017 -0700]","Body":"ISSUE173: Implement AutoCloseable in BKDistributedLogNamespace\n\nDescriptions of the changes in this PR:\n\nImplement AutoCloseable in BKDistributedLogNamespace\n\nAuthor: Arvin <arvindevel@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #214 from ArvinDevel/issue173\n","Date":"Wed Oct 18 21:16:58 CEST 2017"},{"Commit-ID":"commit b737e9c77eaba28d6498691c968901f3c53d2a89 1508357199 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Wed Oct 18 13:06:39 2017 -0700]","Body":"Issue 201: Fix the flaky test TestBKDistributedLogManager.deleteDuringRead\n\nThis closes #204, #201 ","Date":"Wed Oct 18 22:06:39 CEST 2017"},{"Commit-ID":"commit 84ecaa8201bb97a041ed733ba015e2fe62d39a56 1508357374 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Oct 18 13:09:34 2017 -0700]","Body":"ISSUE #207: Support getFirstLogRecord\n\nDescriptions of the changes in this PR:\n\n- support getFirstLogRecord\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #208 from sijie/3_get_firstrecord_pr, closes #207\n","Date":"Wed Oct 18 22:09:34 CEST 2017"},{"Commit-ID":"commit fd477f6310a512e76fa3284b100d6e11411939b8 1508359204 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@yahoo-inc.com, Wed Oct 18 22:40:04 2017 +0200]","Body":"Fixed ref counting release on read errors\n\nOriginal change by merlimat in yahoo-3.4 branch\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #644 from ivankelly/fix-ref-read\n","Date":"Wed Oct 18 22:40:04 CEST 2017"},{"Commit-ID":"commit 9f55ccc7d75a4beedb96aaaeb0a9ca1357977482 1508364856 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Oct 18 15:14:16 2017 -0700]","Body":"ISSUE #211: Support listing logs by prefix\n\nDescriptions of the changes in this PR:\n\n- extend `getLogs` to `getLogs(prefix)`, so it provides a filesystem `listFiles`-like semantic.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #212 from sijie/5_support_list_logs_by_prefix_pr, closes #211\n","Date":"Thu Oct 19 00:14:16 CEST 2017"},{"Commit-ID":"commit 99bcf09f6d5bbcef2f4c5228cd70e023c2348b03 1508370211 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@yahoo-inc.com, Thu Oct 19 01:43:31 2017 +0200]","Body":"Fix concurrent v2 reads on the same ledger/entry\n\nOriginal fix from by merlimat in the yahoo-4.3 branch\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #645 from ivankelly/con-read-v2-fix\n","Date":"Thu Oct 19 01:43:31 CEST 2017"},{"Commit-ID":"commit 51a58cbe3ad6ca7833f433aa9b845480ee690e57 1508537948 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Sat Oct 21 00:19:08 2017 +0200]","Body":"Increase timeouts in TestDisableEnsembleChange\n\nIn some narrow cases, if we manage to connect to the bookie, but the bookie\nhasn't fully initialized, an add entry message will be dropped, and the\nclient will wait for the timeout to complete. The timeout is 5 seconds\nby default, which was 5x the timeout in the test. This patch increases\nthe test timeout to 10s, which should give enough time for the addEntry\nto fail and be retried.\n\nAuthor: Ivan Kelly <ivan@midokura.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #646 from ivankelly/ensemble-change-test\n","Date":"Sat Oct 21 00:19:08 CEST 2017"},{"Commit-ID":"commit ff6ec1905e645d45e7857cc928c37255a81b592d 1508741116 -----sp","Author":"PersonIdent[Arvin, arvindevel@gmail.com, Sun Oct 22 23:45:16 2017 -0700]","Body":"ISSUE164: Move findbug settings files to distributedlog-build-tools\n\nDescriptions of the changes in this PR:\n\nMove findbug settings files to distributedlog-build-tools,\nand a little change to bk-shade: add bk-common dependency and unshade netty.\n\nAuthor: Arvin <arvindevel@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #216 from ArvinDevel/issue164\n","Date":"Mon Oct 23 08:45:16 CEST 2017"},{"Commit-ID":"commit b6852900b5a538a21be816ec8707b4cb8b07d3d0 1508741116 -----sp","Author":"PersonIdent[Arvin, arvindevel@gmail.com, Sun Oct 22 23:45:16 2017 -0700]","Body":"ISSUE164: Move findbug settings files to distributedlog-build-tools\n\nDescriptions of the changes in this PR:\n\nMove findbug settings files to distributedlog-build-tools,\nand a little change to bk-shade: add bk-common dependency and unshade netty.\n\nAuthor: Arvin <arvindevel@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #216 from ArvinDevel/issue164\n","Date":"Mon Oct 23 08:45:16 CEST 2017"},{"Commit-ID":"commit 346e3a92be09bc294fbd4d964a7fc394795cee4f 1508741116 -----sp","Author":"PersonIdent[Arvin, arvindevel@gmail.com, Sun Oct 22 23:45:16 2017 -0700]","Body":"ISSUE164: Move findbug settings files to distributedlog-build-tools\n\nDescriptions of the changes in this PR:\n\nMove findbug settings files to distributedlog-build-tools,\nand a little change to bk-shade: add bk-common dependency and unshade netty.\n\nAuthor: Arvin <arvindevel@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #216 from ArvinDevel/issue164\n","Date":"Mon Oct 23 08:45:16 CEST 2017"},{"Commit-ID":"commit 6e7237c751949d101bba2dac93bd3a81200633c7 1508750042 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Oct 23 17:14:02 2017 +0800]","Body":"ISSUE #209: Support rename log\n\nDescriptions of the changes in this PR:\n\n- add rename operation in `Namespace`\n- add rename operation in `LogStreamMetadataStore`\n- implement the rename operation use zookeeper `multi` operation\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Shoukun Huai <shoukunhuai@gmail.com>\nAuthor: Arvin <arvindevel@gmail.com>\n\nReviewers: Jia Zhai <None>\n\nThis closes #210 from sijie/4_support_rename_pr, closes #209\n","Date":"Mon Oct 23 11:14:02 CEST 2017"},{"Commit-ID":"commit 8ca0dd414c1b4519aeb8014a0b65d60318f84f5c 1508785165 -----sp","Author":"PersonIdent[Ivan Kelly, ivan@midokura.com, Mon Oct 23 11:59:25 2017 -0700]","Body":"Fix a typo in PCBC logging\n\nAll ops had writeLac in their logged text, which is confusing\n\nAuthor: Ivan Kelly <ivan@midokura.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #647 from ivankelly/pcbc-typo\n","Date":"Mon Oct 23 20:59:25 CEST 2017"},{"Commit-ID":"commit 70e4bbe437f81f2b226480d7c20999737f686787 1508789950 -----sp","Author":"PersonIdent[Ivan Kelly, ivan@midokura.com, Mon Oct 23 13:19:10 2017 -0700]","Body":"Pool the V2 keys\n\nTo generate less garbage in the fast path.\n\nAuthor: Ivan Kelly <ivan@midokura.com>\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #648 from ivankelly/pool-keys\n","Date":"Mon Oct 23 22:19:10 CEST 2017"},{"Commit-ID":"commit 496843893dfb91c237cbd5ae1f245f90304ea34b 1508842723 -----sp","Author":"PersonIdent[Ivan Kelly, ivan@midokura.com, Tue Oct 24 12:58:43 2017 +0200]","Body":"Pool AddCompletions\n\nTo avoid generating garbage in the fastpath.\n\nAuthor: Ivan Kelly <ivan@midokura.com>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>\n\nThis closes #649 from ivankelly/pool-completions\n","Date":"Tue Oct 24 12:58:43 CEST 2017"},{"Commit-ID":"commit dfe465cdd0684bbb348d106b737acf431f29351a 1508844936 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Oct 24 19:35:36 2017 +0800]","Body":"Issue 225: Create log should create missing path components\n\nDescriptions of the changes in this PR:\n\nreuse the methods used by `rename` to create missing path components.\n\n(the test is covered by #227)\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #228 from sijie/fix_create_log_pr\n","Date":"Tue Oct 24 13:35:36 CEST 2017"},{"Commit-ID":"commit 3a1499044b64832635affcfaf6657725bc01411b 1508845759 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Oct 24 19:49:19 2017 +0800]","Body":"ISSUE #224: listing logs should exclude <default>\n\nDescriptions of the changes in this PR:\n\nexclude `<default>` from listing logs\n\n(the tests are covered by #227)\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #229 from sijie/fix_listing_log_pr, closes #224\n","Date":"Tue Oct 24 13:49:19 CEST 2017"},{"Commit-ID":"commit 54268cee2960ccba62fc984c4ae86997abb6e572 1508846202 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Oct 24 19:56:42 2017 +0800]","Body":"ISSUE #226: ByteBuf.release() was not called before it's garbage-collected\n\nDescriptions of the changes in this PR:\n\nthe problem is a new entry buffer was allocated when closing log segment writer. the entry buffer is never used and also never recycled. It causes an annoying logging.\n\nthe fix is to assign a dummy entry writer which basically rejects writes, when closing a log segment writer. it would prevent leaking bytebuf.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #230 from sijie/fix_bytebuf_release_pr, closes #226\n","Date":"Tue Oct 24 13:56:42 CEST 2017"},{"Commit-ID":"commit 0e13f700f662f20445094115a75f00e39f88565d 1508939127 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Wed Oct 25 15:45:27 2017 +0200]","Body":"ISSUE #606: Enhancements in developer environment\n\nImprovements in maven configuration in order to speed up development\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>\n\nThis closes #661 from eolivelli/plugins-upgrade, closes #606\n","Date":"Wed Oct 25 15:45:27 CEST 2017"},{"Commit-ID":"commit afcaade7c4c866a595b52ce71ee58b19352b2dbb 1508939980 -----sp","Author":"PersonIdent[Aaron Gresch, agresch@yahoo-inc.com, Wed Oct 25 15:59:40 2017 +0200]","Body":"Fail earlier when encountering DNS issues\n\nWe had some DNS issues today and various TestRegionAwareEnsemblePlacementPolicy tests were failing for me.\n\nThe LOG warning in RackawareEnsemblePlacementPolicyIml was not printing the right variable, which would have given a clue.\n\nAdditionally, the repp.myRegion was set to UNKNOWN, causing incorrect code flow.  Added an assert to kill the test as soon as this occurs.\n\nAuthor: Aaron Gresch <agresch@yahoo-inc.com>\n\nReviewers: Ivan Kelly <ivan@ivankelly.net>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #658 from agresch/agresch_dns_failure\n","Date":"Wed Oct 25 15:59:40 CEST 2017"},{"Commit-ID":"commit 5555e0bb3e82a1aed90a1ab174e6a17499ac6c01 1515383721 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Wed Oct 25 17:23:13 2017 -0700]","Body":"State Store: Define the k/v interface\n","Date":"Thu Oct 26 02:23:13 CEST 2017"},{"Commit-ID":"commit 0cd6116717b725dc5528a32ae78b5cc6a9074685 1515383746 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Thu Oct 26 03:08:45 2017 -0700]","Body":"State Store: Add MVCC Store Interface\n","Date":"Thu Oct 26 12:08:45 CEST 2017"},{"Commit-ID":"commit 3171228d0b8bfebcec81faac584854f93ae888f9 1515383753 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Thu Oct 26 14:43:22 2017 -0700]","Body":"Async and Sync MVCC Store\n","Date":"Thu Oct 26 23:43:22 CEST 2017"},{"Commit-ID":"commit e666fc3c6ea2ca57fe450fa7eb223cb8b63747f9 1515383760 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Fri Oct 27 01:25:16 2017 -0700]","Body":"Make all interfaces\n","Date":"Fri Oct 27 10:25:16 CEST 2017"},{"Commit-ID":"commit 72b87356a6714c906213a13e298e1194604e1b69 1515383785 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Fri Oct 27 01:27:47 2017 -0700]","Body":"Implement op and result\n","Date":"Fri Oct 27 10:27:47 CEST 2017"},{"Commit-ID":"commit 18e918ea576d03a8c42f368a274c450d612df995 1515383825 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Fri Oct 27 01:28:32 2017 -0700]","Body":"Implement Record Factory\n","Date":"Fri Oct 27 10:28:32 CEST 2017"},{"Commit-ID":"commit c2a5d41f1539feaa953f67604d17463a0e5266b1 1515383810 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Fri Oct 27 01:29:23 2017 -0700]","Body":"Add internal structure for mvcc record\n","Date":"Fri Oct 27 10:29:23 CEST 2017"},{"Commit-ID":"commit 481b57ed2367c80aebe63853c0b078a0f422ff15 1515383855 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Fri Oct 27 01:30:25 2017 -0700]","Body":"Implement Range and Put Operation\n","Date":"Fri Oct 27 10:30:25 CEST 2017"},{"Commit-ID":"commit 8315883abd0f1d01cd7e0b0bbe5d947ca2bf9c11 1515383738 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Fri Oct 27 01:50:31 2017 -0700]","Body":"Fix checkstyle and findbugs errors\n","Date":"Fri Oct 27 10:50:31 CEST 2017"},{"Commit-ID":"commit f16b5567ecbfe2c8015f5084262fbf3abb2036ec 1515383772 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Fri Oct 27 02:10:33 2017 -0700]","Body":"Add javadoc and annotation, fix checkstyle\n","Date":"Fri Oct 27 11:10:33 CEST 2017"},{"Commit-ID":"commit 97656e7cddba04a40b8eabea2d591367676ac112 1515383779 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Fri Oct 27 02:26:12 2017 -0700]","Body":"Reorganize builder and op\n","Date":"Fri Oct 27 11:26:12 CEST 2017"},{"Commit-ID":"commit 5e36a28c6b1d268088e0e4f3c205bc639f6e48ce 1515383844 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Fri Oct 27 03:04:27 2017 -0700]","Body":"address compilation issue with @FreeBuilder\n","Date":"Fri Oct 27 12:04:27 CEST 2017"},{"Commit-ID":"commit 767e4556b7f5cc523b127e7987cc442f707699d9 1509130292 -----sp","Author":"PersonIdent[Aaron Gresch, agresch@yahoo-inc.com, Fri Oct 27 11:51:32 2017 -0700]","Body":"Recycle instances of WriteEntryProcessor and ReadEntryProcessor\n\nmerge of some changes from Yahoo's repo\n\nAuthor: Aaron Gresch <agresch@yahoo-inc.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Matteo Merli <mmerli@apache.org>\n\nThis closes #669 from agresch/agresch_recycle_entryprocessor\n","Date":"Fri Oct 27 20:51:32 CEST 2017"},{"Commit-ID":"commit e9b857092703719c9ea38a3a74107fe5114af94a 1509130699 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Fri Oct 27 11:58:19 2017 -0700]","Body":"ISSUE #662: Introduce Bookie Registration Manager for bookie server\n\nDescriptions of the changes in this PR:\nWhile in BOOKKEEPER-628, It is trying to improve/generalize the bookie registration process.\nThis PR is for bookie side, it tries to introduce Bookie registration manager for bookie server.\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #663 from zhaijack/bookie_registration, closes #662\n","Date":"Fri Oct 27 20:58:19 CEST 2017"},{"Commit-ID":"commit 6fcabfc80c5bd6cdfa9252cdfc4ed209cc0620a6 1509145788 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Oct 27 16:09:48 2017 -0700]","Body":"ISSUE #596 ISSUE #583: Auto replication should honor ensemble placement policy\n\nDescriptions of the changes in this PR:\n\nThis pull request ports the changes from [twitter/bookkeeperfc7e171](https://github.com/twitter/bookkeeper/commit/fc7e171135a58cddb9e91f5f614b3ceb6f9f9fee)\n\nThe changes include:\n\n1. when bookkeeper admin re-replicates a ledger, it will pick a bookie from the available bookies in the cluster to satisfy the placement constraint. (#596)\n2. hence, remove `targetBookie` from ReplicationWorker, because the parameter will volatile the placement constraint. (#583)\n3. at the same time, change `LedgerFragement` to represent the number of bookies that need to be check and replicate. a) the ledger checker can use the correct bookie index for verifying the existence of entries in a bookie (for stripping case) b) only read entries one time when need to replicate them to multiple bookies.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>\n\nThis closes #641 from sijie/twitter_autorecovery_fixes, closes #596, closes #583\n","Date":"Sat Oct 28 01:09:48 CEST 2017"},{"Commit-ID":"commit 3a20fe0ab6c0259ae9143641105c46e48f625f7c 1509145990 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Oct 27 16:13:10 2017 -0700]","Body":"ISSUE #265: Add persistable bookie status\n\nDescriptions of the changes in this PR:\n\n- Add support for persisting bookie status\n- Add configuration to enable/disable this feature\n- Add test cases\n- Improve bookie status stat\n\nIt also includes changes for BOOKKEEPER-754 (flush ledger storage after replaying journal)\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Yiming Zang <yzang@twitter.com>\n\nReviewers: Yiming Zang <yzang2016@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #266 from sijie/server_side_crc32, closes #265\n","Date":"Sat Oct 28 01:13:10 CEST 2017"},{"Commit-ID":"commit 502c6b1e4b9d65a7ebd373eb6177e925648880f8 1509244090 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Oct 29 10:28:10 2017 +0800]","Body":"ISSUE #675: Enable checkstyle in a few packages\n\nThese packages include:\n\n- feature\n- processor\n- shims\n- stats\n- streaming\n- versioning\n- zookeeper\n\nnot fully enabled in conf package.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #676 from sijie/fix_checkstyles, closes #675\n","Date":"Sun Oct 29 03:28:10 CET 2017"},{"Commit-ID":"commit a914eed584bba706456c13619dcae5c38f916593 1515383865 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Sun Oct 29 20:51:28 2017 -0700]","Body":"Implement put and range operation in mvcc store\n","Date":"Mon Oct 30 04:51:28 CET 2017"},{"Commit-ID":"commit 26680c1507949bd8678af987a60fb3f5342fb1a6 1509337021 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Oct 30 12:17:01 2017 +0800]","Body":"DLFS - A FileSystem API wrapper over dlog API\n\nDescriptions of the changes in this PR:\n\n- FileSystem API wrapper built over dlog API\n\n(This is based on initial implementation from gerritsundaram at #43)\n\nFeatures supported:\n\n- create and append files\n- open files for reading\n- input stream and output stream for reading and writing data\n- list files\n- get file status\n- rename\n- mkdir\n\nFeatures aren't supported:\n\n- truncate\n- currently there is no clear distinguish between file and dir\n- only support delete recursive\n\n(This change includes small changes for #224 #225 #226 ).\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #227 from sijie/fix_create_log\n","Date":"Mon Oct 30 05:17:01 CET 2017"},{"Commit-ID":"commit 96e52dec37dafd0d452dc4e9e13b36e12abc398c 1515383889 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Oct 29 22:30:16 2017 -0700]","Body":"Make localStateStoreDir, stream and ioExecutor optional\n","Date":"Mon Oct 30 06:30:16 CET 2017"},{"Commit-ID":"commit cef37ed5980a47c8d739ea37590c97fcbb965ff0 1515383897 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Oct 29 23:35:43 2017 -0700]","Body":"Add protobuf definition for put/delete/txn request\n","Date":"Mon Oct 30 07:35:43 CET 2017"},{"Commit-ID":"commit 8e20a80b3d22ac1d14ba7a8f2046bdbbe5e95a44 1509392838 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Oct 30 20:47:18 2017 +0100]","Body":"DistributionSchedule uses custom wrapped int[] rather than HashSet\n\nThis avoids the autoboxing on Integers and allocations of cells for\nthe hashset.\n\nThis also implies using wrapped int[] object for the write set in the\nDistributionSchedules and PlacementPolicies.\n\nThis patch was originally submitted as dc7933b on the yahoo-4.3\nbranch, though this has been modified extensively to remove the\ndependency on carrotsearch hppc and to allow it to work with placement\npolicies which didn't exist at the time of the original patch.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #657 from ivankelly/yahoo-backports\n","Date":"Mon Oct 30 20:47:18 CET 2017"},{"Commit-ID":"commit 1c7d103431c15335cc6d6eae0e9c2197b58c1ad3 1509392974 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@yahoo-inc.com, Mon Oct 30 20:49:34 2017 +0100]","Body":"Recycle instances of callback to obtain a PerChannelBookie client\n\nThis change was originally commit e2e77863 in the yahoo-4.3 branch.\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #679 from ivankelly/yahoo-bp-3\n","Date":"Mon Oct 30 20:49:34 CET 2017"},{"Commit-ID":"commit c733494bfb42a00a91594730f2241df3ff0fb84f 1509427582 -----sp","Author":"PersonIdent[eolivelli, eolivelli@apache.org, Mon Oct 30 22:26:22 2017 -0700]","Body":"Copy site from 4.5.0 to 4.5.1\n\nCopy site directory in order to start new release notes for 4.5.1\n\nAuthor: eolivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #680 from eolivelli/release-notes-451-copy\n","Date":"Tue Oct 31 06:26:22 CET 2017"},{"Commit-ID":"commit 030aefa7dc97483886699efdcf07364f7020ef5e 1509552400 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Oct 31 01:31:51 2017 -0700]","Body":"Fix DistributedSchedule.WriteSet compilation issue\n\nDisributedSchedule writeset structure is changed in recent 4.6.0-SNAPSHOT version\n","Date":"Tue Oct 31 09:31:51 CET 2017"},{"Commit-ID":"commit a25d9f3c252f1082a3ace50db6958f109c53af3f 1515383926 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Oct 31 01:45:07 2017 -0700]","Body":"Implement MVCC Async Store using local rocksdb and distributedlog stream\n","Date":"Tue Oct 31 09:45:07 CET 2017"},{"Commit-ID":"commit 5170c52052dc89ac7023ba7736fc9fda7920a80f 1515383930 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Tue Oct 31 17:45:17 2017 -0700]","Body":"Implement delete op in local mvcc store\n","Date":"Wed Nov 01 01:45:17 CET 2017"},{"Commit-ID":"commit 34e8bf200c6f3797bd6fa4c5d86646e9eb7f0d3b 1509503481 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Oct 31 19:31:21 2017 -0700]","Body":"Recycle PendingAddOps\n\nAvoid creating a new PendingAddOp object for each entry added, thus\nsaving on garbage.\n\nOriginally commit 55ba4723 on the yahoo-4.3 branch.\n\nAuthor: Ivan Kelly <ivank@apache.org>\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #664 from ivankelly/yahoo-bp-1\n","Date":"Wed Nov 01 03:31:21 CET 2017"},{"Commit-ID":"commit c4c8069456a53669576569389ee45f4ed0e9654c 1509504198 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Tue Oct 31 19:43:18 2017 -0700]","Body":"ISSUE #666: Introduce registration client for bookkeeper client to do bookie discover\n\nDescriptions of the changes in this PR:\nwhile in BOOKKEEPER-628, It is trying to improve/generalize the bookie registration process.\n\nThis PR follows the work of #663, which provide bookie side registration, and it is for client side work, it tries to introduce RegistrationClient for bookkeeper client to do bookie discover.\n\nThis PR follows the work of #663, which provide bookie side registration,\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #667 from zhaijack/client_registration2, closes #666\n","Date":"Wed Nov 01 03:43:18 CET 2017"},{"Commit-ID":"commit e7292cdcdc307d356bb63d55608a530487c74f96 1515383937 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Tue Oct 31 23:58:57 2017 -0700]","Body":"Implement txn operation in local mvcc store\n","Date":"Wed Nov 01 07:58:57 CET 2017"},{"Commit-ID":"commit f0c251bd6c7880ff9ea84e916b9e2b56cf82e7a7 1515383943 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Wed Nov 1 01:38:22 2017 -0700]","Body":"Make keys optional for range operations and make range operations correctly handle head and tail ranges\n","Date":"Wed Nov 01 09:38:22 CET 2017"},{"Commit-ID":"commit f30766e95d5f0b284bb74edf65edee052e257e55 1509552400 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Wed Nov 1 01:39:24 2017 -0700]","Body":"Update exception handling in constructing bookkeeper client\n","Date":"Wed Nov 01 09:39:24 CET 2017"},{"Commit-ID":"commit 4424ba74748c7156e7b296d09f6b5f0b328e71c8 1515383950 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Wed Nov 1 01:56:23 2017 -0700]","Body":"Return the right revision for results\n","Date":"Wed Nov 01 09:56:23 CET 2017"},{"Commit-ID":"commit cc9a7a96792bde6a44c5ae48de93f37334884578 1515383961 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Wed Nov 1 15:55:22 2017 -0700]","Body":"Implement cas shortcuts in mvcc store\n\n- put, putIfAbsent\n- delete, delete(k, v), deleteRange()\n- cas put and delete based on version: vPut, vDelete\n- cas put and delete based on revision: rPut, rDelete\n- get and range\n","Date":"Wed Nov 01 23:55:22 CET 2017"},{"Commit-ID":"commit 02da55bfd4c275bc8fc77e2eb00dcea12225b8b9 1515383967 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Nov 1 16:30:38 2017 -0700]","Body":"Introduce StateStores and MVCCStores as factory for supplying stores\n","Date":"Thu Nov 02 00:30:38 CET 2017"},{"Commit-ID":"commit e202d955a022a501ea49bc5906c36b38bdbc50df 1509605715 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@yahoo-inc.com, Thu Nov 2 07:55:15 2017 +0100]","Body":"Recycle AddRequest/AddResponse objects\n\nThis change was originally afd0ecb6 & 75bf0fa1 on the yahoo-4.3 branch\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #665 from ivankelly/yahoo-bp-2\n","Date":"Thu Nov 02 07:55:15 CET 2017"},{"Commit-ID":"commit 952cedac10da487c72b7974152242dbc46349978 1509649863 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Nov 2 12:11:03 2017 -0700]","Body":"ISSUE #681: Deploying bookkeeper in k8s using StatefulSets\n\nDescriptions of the changes in this PR:\n\nProvide a yaml file to deploy bookkeeper in k8s using [StatefulSets](https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/)\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Ivan Kelly <ivank@apache.org>\nAuthor: eolivelli <eolivelli@apache.org>\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Ivan Kelly <ivan@ivankelly.net>, Jia Zhai <None>\n\nThis closes #682 from sijie/k8s/statefulsets, closes #681\n","Date":"Thu Nov 02 20:11:03 CET 2017"},{"Commit-ID":"commit 4c2e90d2536676f14df944c5d8b4288362aa48b9 1509694813 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Fri Nov 3 08:40:13 2017 +0100]","Body":"ISSUE #685: Merge script: make DEV_BRANCH_NAME configurable\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #686 from eolivelli/fix/issue-683-merge-other-branch, closes #685\n","Date":"Fri Nov 03 08:40:13 CET 2017"},{"Commit-ID":"commit 3ce2fb7ed510976413df07b00c81c3383f5494d1 1509725613 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Nov 3 17:13:33 2017 +0100]","Body":"ISSUE #501: Fix race in CompactionTest\n\ntestMinorCompactionWithNoWritableLedgerDirsButIsForceGCAllowWhenNoSpaceIsSet\nwas failing regularly on jenkins. The issue was that it was trying to\nkick off a forced garbage collection by setting the force flag and\ntriggering. However, in some cases another GC would be running and\nwould clear the flag after it had been set, but before the trigger was\ncalled.\n\nThis patch adds a new form of triggering which allows the caller to\nexplicitly specify which flags will be active for the GC run.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #690 from ivankelly/make-compat-fail, closes #501\n","Date":"Fri Nov 03 17:13:33 CET 2017"},{"Commit-ID":"commit 2291b51ab96b4b460b05dbe34fb50c5ccde58e2c 1509761754 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Sat Nov 4 03:15:54 2017 +0100]","Body":"fix merge script (#692)\n\nThe merge script is broken due to a typo in 4c2e90d2536676f14df944c5d8b4288362aa48b9\r\n","Date":"Sat Nov 04 03:15:54 CET 2017"},{"Commit-ID":"commit 8b2ead67bc895c9e6bfe18228e949da94583230b 1509761940 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Sat Nov 4 10:19:00 2017 +0800]","Body":"ISSUE #696: copy site/docs/4.5.0 to site/docs/4.6.0\n\nDescriptions of the changes in this PR:\ncopy site directory in order to start new release for 4.6.0,\nand then documentation changes of release 4.6.0 will be based on this, to make changes more clear.\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #698 from jiazhai/issue-696, closes #696\n","Date":"Sat Nov 04 03:19:00 CET 2017"},{"Commit-ID":"commit cbf6668af320135af65c4590385a29fcf6d8d6c8 1509979637 -----sp","Author":"PersonIdent[Antonio Ojea, antonio.ojea.garcia@gmail.com, Mon Nov 6 22:47:17 2017 +0800]","Body":"ISSUE #699: Docker healthchek is failing #699\n\nThe docker healthcheck is failing because it's trying to run the\nbookkeeper command without specifying a path.\n\nAdding the full path to the command fix this issue.\n\nSigned-off-by: Antonio Ojea <antonio.ojea.garciagmail.com>\n\nDescriptions of the changes in this PR:\n\n(PR description content here)...\n\nAuthor: Antonio Ojea <antonio.ojea.garcia@gmail.com>\n\nReviewers: Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis closes #700 from itsuugo/issue#699, closes #699, closes #699\n","Date":"Mon Nov 06 15:47:17 CET 2017"},{"Commit-ID":"commit 0ae8abc354c4c7706232aabf474ea37afea90fc2 1510082759 -----sp","Author":"PersonIdent[Luc Perkins, lucperkins@gmail.com, Tue Nov 7 11:25:59 2017 -0800]","Body":"Landing pages documentation fixes\n\nThere were a few \"broken windows\" on the current landing pages for the different versions of BookKeeper, including mis-applied code backticks, an incorrect HTML code (`&trades;` instead of `&trade;`), etc.\n\nAuthor: Luc Perkins <lucperkins@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #702 from lucperkins/bugs/docs-main-page\n","Date":"Tue Nov 07 20:25:59 CET 2017"},{"Commit-ID":"commit 3392beee5c70abe36d36604723e14d97b7764be9 1510140440 -----sp","Author":"PersonIdent[Yiming Zang, yzang@twitter.com, Wed Nov 8 19:27:20 2017 +0800]","Body":"BOOKKEEPER-1040: Use separate log for compaction and add transaction support\n\nProblem:\nCompaction might keep generating duplicated data which would cause disk full.\nThis is because we don't have transactional operation for compaction. So if compaction\nkeeps failing in the middle, bookie would end up with a lot of garbage data.\n\nChange:\n1. Introduce abstract class AbstractLogCompactor with an interface compact().\n2. Move the existing compaction logic to a separate class called EntryLogCompactor.\n3. Introduce transactional compaction, we can recover an incomplete compaction or rollback a compaction failure.\n4. Add an configuration to enable transactional compaction\n\nPotential Risk:\n1. No risk if we keep using the default compactor.\n2. If we choose to enable transactional compaction with separate log file, we need to be careful about it, since we use a separate log for compaction, if we have a lot of old small ledgers in the bookie, we will end up with a lot of small entry log files. And this will potentially cause bookkeeper \"Too many open files\" because GC will scan all the entry log files and keep them open.\n\nAuthor: Yiming Zang <yzang@twitter.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #704 from yzang/yzang/BOOKKEEPER-1040\n","Date":"Wed Nov 08 12:27:20 CET 2017"},{"Commit-ID":"commit d0c11d0bf982208008c1f45e62038a33e7d9a73d 1510188939 -----sp","Author":"PersonIdent[eolivelli, eolivelli@apache.org, Wed Nov 8 16:55:39 2017 -0800]","Body":"ISSUE #707: NOTICE file should not contain references to JLine\n\nAuthor: eolivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #708 from eolivelli/notice-jline, closes #707\n","Date":"Thu Nov 09 01:55:39 CET 2017"},{"Commit-ID":"commit e713953aec8523e1018e0eba458c019ec9ba1f9f 1510361489 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Nov 10 16:51:29 2017 -0800]","Body":"ISSUE #691: Move generated files into their own module\n\nUpcoming changes are using GRpc in conjunction with protobuf. GRpc\ngenerates code that created deprecation warnings when compiled with\njava 8, so this change moves all generated code out to another module,\nso that we don't have to turn off -Werror for all code.\n\nIn any case, at some point we should split the bookkeeper client out\nfrom the server module, at which point we would need the definitions\non a common place.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #711 from ivankelly/proto-module, closes #691\n","Date":"Sat Nov 11 01:51:29 CET 2017"},{"Commit-ID":"commit dd7dc6399504b246c65f7a09657597578b81cb6c 1510437357 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Nov 11 13:55:57 2017 -0800]","Body":"ISSUE #716: PendingAddOp accesses a released ByteBuf\n\nDescriptions of the changes in this PR:\n\n- release `toSend` bytebuf only when a PendingAddOp is recycled.\n- fix MockBookKeeperTestCase to run callbacks in the same executor thread.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #717 from sijie/issue_176, closes #716\n","Date":"Sat Nov 11 22:55:57 CET 2017"},{"Commit-ID":"commit a9b64e61598a987ffa6249ab398215436a7928f2 1510470145 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Nov 12 15:02:25 2017 +0800]","Body":"ISSUE #490: Add a flag to not serialize `ctime` field\n\nDescriptions of the changes in this PR:\n\nThis request is for DL bookkeeper version upgrade. Because twitter's bk version doesn't include this change, so any ledgers written by new bk version will fail to be read by old version. To simplify the upgrade story, it is good to allow not serialize ctime field.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>, Matteo Merli <mmerli@apache.org>\n\nThis closes #718 from sijie/flag_to_not_serialize_ctime, closes #490\n","Date":"Sun Nov 12 08:02:25 CET 2017"},{"Commit-ID":"commit dad7e2ce0d1cf8f04c7e2f128900ea69792c948d 1510470836 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Nov 12 15:13:56 2017 +0800]","Body":"ISSUE #612: Make bookie recovery work with recovering multiple bookies\n\nDescriptions of the changes in this PR:\n\nThis is a change ported from twitter branch.\n\n- Enable recovering multiple bookies in bookie shell\n- Add a unit test for BookieShell.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #714 from sijie/recover_command_fix, closes #612\n","Date":"Sun Nov 12 08:13:56 CET 2017"},{"Commit-ID":"commit 388d4a4c73dfe0f5ed0adc9f77f37ffd9457d117 1510474684 -----sp","Author":"PersonIdent[Jia Zhai, jiazhai@users.noreply.github.com, Sun Nov 12 16:18:04 2017 +0800]","Body":"ISSUE #694: ReadHandle doesn't have getLength() method\n\nDescriptions of the changes in this PR:\n\n- add `getLength()` to ReadHandle interface\n- add `getLastAddPushed` to WriteHandle interface\n- add unit tests and fix issue in MockBookKeeperTestCase\n\nAuthor: Jia Zhai <jiazhai@users.noreply.github.com>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #715 from sijie/api/support_get_length, closes #694\n","Date":"Sun Nov 12 09:18:04 CET 2017"},{"Commit-ID":"commit 3cc78ba8fb825f166ff6f6fbd217938f3c79b26c 1515874149 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Nov 13 19:37:22 2017 +0100]","Body":"[md_proxy2 6/14] Pluggable interface to resolve bookie address from name (#40)\n\n* Pluggable interface to resolve bookie address from name\n","Date":"Mon Nov 13 19:37:22 CET 2017"},{"Commit-ID":"commit ed7696b130a0b7b6fb63b4d37c4a873fa1f8f96f 1510599716 -----sp","Author":"PersonIdent[Aaron Gresch, agresch@yahoo-inc.com, Mon Nov 13 11:01:56 2017 -0800]","Body":"Bookies should not queue read request indefinitely\n\nIntegrating some changes made to Yahoo bookkeeper by Matteo Merli.\n\nThe apache bookkeeper thread pool in use by OrderedScheduler is different, and does not have access to setting a queue size limit, so I created QueueAssessibleExecutorService, and check the queue size instead.  Other than that, this code change is pretty similar to Yahoo's.\n\nOriginal bug description for this change:\n\nSince we are using a thread pool to handle read requests in bookies, we have seen that when the Bookie read IO is maxed out, the requests are being accumulated in the bookie.\n\nEssentially, the bookie is busy serving read requests that have already been timed out on the client side (end to end read latency can reach hours..). The queue keeps growing indefinitely, leading to OOM errors and bookie restart.\n\nAll unit tests pass for me locally with this change.\n\nAuthor: Aaron Gresch <agresch@yahoo-inc.com>\n\nReviewers: Ivan Kelly <ivan@ivankelly.net>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #706 from agresch/agresch_cms1254\n","Date":"Mon Nov 13 20:01:56 CET 2017"},{"Commit-ID":"commit e253ca32eb2f9f06b7525b85e7fa2ca870e6d0fa 1510651898 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Tue Nov 14 17:31:38 2017 +0800]","Body":"ISSUE #724: fix wrong link for slack signup\n\nDescriptions of the changes in this PR:\nChange the link of slack signup from http://apachebookkeeper.slack.com/ to https://apachebookkeeper.herokuapp.com/ in https://bookkeeper.apache.org/community/slack/ and click the self-register link.\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #725 from jiazhai/issue-724, closes #724\n","Date":"Tue Nov 14 10:31:38 CET 2017"},{"Commit-ID":"commit c9a150b58fb1c8636dabbd7930bc3acffbf89881 1510836882 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Nov 16 20:54:42 2017 +0800]","Body":"ISSUE #726: Unit Tests failure with BKMetadataVersionException\n\nDescriptions of the changes in this PR:\n\nProblem:\n\nThe problem is introduced after making storing ctime optional. the verification become inconsistent because the way how ctime was assigned and compared. It causes the test cases failing in #726\n\nSolution:\n\nThis change is to change `isConflict` to ignore comparing ctime if client disables storing system time as ctime.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #730 from sijie/fix_ctime_issue, closes #726\n","Date":"Thu Nov 16 13:54:42 CET 2017"},{"Commit-ID":"commit 07bb94f25a49c6f28c5b33ce930c0e2a3601db83 1510837247 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Nov 16 21:00:47 2017 +0800]","Body":"ISSUE #713: Mark new API as experimental\n\nDescriptions of the changes in this PR:\n\nmark new api as experimental - `InterfaceStability.Unstable`\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivan@ivankelly.net>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #736 from sijie/mark_api_experimental, closes #713\n","Date":"Thu Nov 16 14:00:47 CET 2017"},{"Commit-ID":"commit 9b538aff7da5cba15ae59b70e0b0c9bd2464dca3 1510837586 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Nov 16 21:06:26 2017 +0800]","Body":"ISSUE #734: bookkeeper-benchmark is broken after protobuf files are moved to bookkeeper-proto\n\nDescriptions of the changes in this PR:\n\nProblem:\n\nThe issue was introduced after protobuf files are moved to bookkeeper-proto. so the protobuf is not shaded correctly.\nSo in bookkeeper-benchmark, it is conflicted with the protobuf version introduced by hadoop.\n\nSolution:\n\n- update the bookkeeper-server pom.xml to shade protobuf correctly\n- remove hadoop dependency from bookkeeper-benchmark.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivan@ivankelly.net>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #735 from sijie/protobuf_issue, closes #734\n","Date":"Thu Nov 16 14:06:26 CET 2017"},{"Commit-ID":"commit 2b660b1e06a9b0deac011d0d6b8a2e990bf974b9 1510890698 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Nov 17 11:51:38 2017 +0800]","Body":"ISSUE #739: Move the implementation of http services to be under server package\n\nDescriptions of the changes in this PR:\n\nbookkeeper-http module provides the framework for http admin rest api. it is using 'org.apache.bookkeeper.http' and 'org.apache.bookkeeper.http.service. the http package inbookkeeper-server` is reusing these two packages. it is not good for two modules sharing same package name, it is going to be confusing javadoc.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #740 from sijie/http_impl, closes #739\n","Date":"Fri Nov 17 04:51:38 CET 2017"},{"Commit-ID":"commit 3fab8c69e2688cecf5849fce305f708b96542dbb 1510935400 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Fri Nov 17 17:16:40 2017 +0100]","Body":"Release notes for 4.5.1\n\nThis patch contains new site docs for 4.5.1\n\nAuthor: eolivelli <eolivelli@apache.org>\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #678 from eolivelli/releasenotes451\n","Date":"Fri Nov 17 17:16:40 CET 2017"},{"Commit-ID":"commit c8c3f6745b57cbae6d01deb31ab445ff29e16152 1510972330 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Sat Nov 18 10:32:10 2017 +0800]","Body":"ISSUE #674: Documentation for HTTP endpoints\n\nDescriptions of the changes in this PR:\nAdd a document for http endpoints.\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Luc Perkins <lucperkins@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #721 from zhaijack/http_doc, closes #674\n","Date":"Sat Nov 18 03:32:10 CET 2017"},{"Commit-ID":"commit c9a1b8adbb2eb4e7bd2fe9d55648ac684828fe8f 1511160498 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Sun Nov 19 22:48:18 2017 -0800]","Body":"ISSUE #550: add readLastAddConfirmedAndEntry in ReadHandle for long poll read\n\nDescriptions of the changes in this PR:\n1, add a class LastAddConfirmedAndEntry and metnod readLastAddConfirmedAndEntry() in ReadHandle;\n2, add implementation for readLastAddConfirmedAndEntry in LedgerHandler;\n3, add testcase in BookKeeperApiTest;\n4, remove un-used imports, break down long lines, fix wrong comments.\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #729 from zhaijack/issue-550, closes #550\n","Date":"Mon Nov 20 07:48:18 CET 2017"},{"Commit-ID":"commit 00a286be3fa1795b4b7a12a7ce417198d4f46710 1511218957 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Nov 20 15:02:37 2017 -0800]","Body":"ISSUE #747: Reorder releases menu - 4.5.1 should appear before 4.5.0\n\nDescriptions of the changes in this PR:\n\n- 4.5.1 should appear before 4.5.0\n- bump dlog version to 0.5.0\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #748 from sijie/issue_747, closes #747\n","Date":"Tue Nov 21 00:02:37 CET 2017"},{"Commit-ID":"commit 89d45bc550f89e16c967c5e691bcc4f6f7d6f2aa 1511238155 -----sp","Author":"PersonIdent[Arvin, arvindevel@gmail.com, Mon Nov 20 20:22:35 2017 -0800]","Body":"issue #236: shaded jar lose necessary bk jar to execute\n\nDescriptions of the changes in this PR:\n\n after bump to bk4.6, add bk-proto bk-http dependency to shaded jar\n\nAuthor: Arvin <arvindevel@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #237 from ArvinDevel/addBkDependencyInShade, closes #236\n","Date":"Tue Nov 21 05:22:35 CET 2017"},{"Commit-ID":"commit 87d1afcc329d7261f19a6310ca9a7cf2acce4dee 1511313068 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Wed Nov 22 09:11:08 2017 +0800]","Body":"ISSUE #731: refine LedgerEntry interface and implementation\n\nIn LedgerEntry interface, getEntry() and getEntryBuffer() have completely different behaviours. getEntry() releases bytebuf automatically, while getEntryBuffer() returns the bytebuf (if you don't call getEntry, you are responsible for releasing the entry buffer.\n\nIn this change:\nmake getEntry() reenter-able; make LedgerEntry implement AutoCloseable; LedgerEntry is responsible for releasing the bytebuf it is holding.\n\nDescriptions of the changes in this PR:\n1.  add `close` and `duplicate` in `api.LedgerEntry`,\n1.  LedgerEntryImpl implements `api.LedgerEntry`,\n1.  client.LedgerEntry doesn't implement the new api. it wraps an `api.LedgerEntry`,\n1.  add `close` in api.LastConfirmedAndEntry.\"\n1.  fix build and test errors.\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #738 from zhaijack/issue-731, closes #731\n","Date":"Wed Nov 22 02:11:08 CET 2017"},{"Commit-ID":"commit e086f1dec6af8120e692862f29c2f77565760025 1511316139 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Nov 22 10:02:19 2017 +0800]","Body":"ISSUE #688: add bookkeeper-all package and update notice files\n\nDescriptions of the changes in this PR:\n\n    - move src/ to bookkeeper-dist/src/\n    - built two packages in bookkeeper-dist: one is `bookkeeper-server` - server only package with prometheus stats provider and vertx http server,\n      the other one is `bookkeeper-all` - includes all packages.\n    - remove assembly plugin from bookkeeper-server module\n    - update release guide\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #737 from sijie/add_slim_module, closes #688\n","Date":"Wed Nov 22 03:02:19 CET 2017"},{"Commit-ID":"commit d120b7f136ab71daf95757145ea4c000c7145686 1511338968 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Nov 22 00:22:48 2017 -0800]","Body":"Add release 4.6.0 to releases menu\n\nDescriptions of the changes in this PR:\n\nThe documentation for release `4.6.0` was copied by #696. But this release is not updated in the releases menu.\n\nThis change is generated by running `site/scripts/release.sh` for preparing 4.6.0 release.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #752 from sijie/update_4.5.1_release_date\n","Date":"Wed Nov 22 09:22:48 CET 2017"},{"Commit-ID":"commit d446b3c5daa8a2593f55c1a166e99e6989e8bcb5 1511372966 -----sp","Author":"PersonIdent[eolivelli, eolivelli@apache.org, Wed Nov 22 09:49:26 2017 -0800]","Body":"fix releases.md, add release date for 4.5.1 and clean up file\n\nAuthor: eolivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #758 from eolivelli/updaterelmd451-460\n","Date":"Wed Nov 22 18:49:26 CET 2017"},{"Commit-ID":"commit 3b02baa43dfd9f55c81d57299f1ec4f26d0aa14d 1511417996 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Nov 23 14:19:56 2017 +0800]","Body":"ISSUE #766: Bump master to 4.7.0-SNAPSHOT\n\nDescriptions of the changes in this PR:\n\nThe master version was not updated when creating `branch-4.6`.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #767 from sijie/bump_master_version, closes #766\n","Date":"Thu Nov 23 07:19:56 CET 2017"},{"Commit-ID":"commit 7108ab4b8e8116dd48c24fdaf845a28e048d7836 1511424451 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Nov 23 16:07:31 2017 +0800]","Body":"ISSUE #750: support ByteBuf, ByteBuffer, byte[] in both WriteHandle, WriteAdvHandle, ReadHandle\n\nDescriptions of the changes in this PR:\n\n- WriteHandle supports append byte[], ByteBuf and ByteBuffer\n- WriteAdvHandle supports write byte[], ByteBuf and ByteBuffer\n- LedgerEntry returns byte[], ByteBuffer and ByteBuf\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivan@ivankelly.net>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #755 from sijie/issue_750, closes #750\n","Date":"Thu Nov 23 09:07:31 CET 2017"},{"Commit-ID":"commit 8e056d4dd0262f5ed5245a8dc8abe608b737f6f9 1511425578 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Nov 23 16:26:18 2017 +0800]","Body":"Issue #753: Allow option to disable data sync on journal\n\nContext in #753\n\nFor deployments where a RAID battery-backed cache is not available and where durability is not a requirements, we should allow bookies to rely on page cache and relax durability.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #754 from merlimat/option-to-disable-sync-master, closes #753\n","Date":"Thu Nov 23 09:26:18 CET 2017"},{"Commit-ID":"commit b20d95469e68acd7b1757e58fcfad0d04e26fec3 1511428104 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Nov 23 10:08:24 2017 +0100]","Body":"ISSUE #763: Javadoc layout should reflect new modules\n\nDescriptions of the changes in this PR:\n\n- add `org.apache.bookkeeper.client.api` in `BookKeeper Client (New Fluent API - Experimental)`\n- move prometheus package to `BookKeeper Stats Providers`\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Jia Zhai <zhaijia@apache.org>\n\nThis closes #768 from sijie/fix_javadoc_layout, closes #763\n","Date":"Thu Nov 23 10:08:24 CET 2017"},{"Commit-ID":"commit a6f4b792270194474649eda9261635c24c218b0a 1511438181 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Thu Nov 23 19:56:21 2017 +0800]","Body":"ISSUE #693: add interface and implementation of LedgerEntries\n\nIn the new API proposed in #506 , we return Iterable<LedgerEntry> for read entries. It is a bit problematic when returning multiple iterators and have no ability to release the entry buffers hold by ledger entries.\nIn this change, the implementation of retainIterator() increased the reference of the buffers when creating an iterator, it will be easy for byteBuf's management; it also make LedgerEntries a recycle object, and it is returned to the pool when #close() is called. on #close(), it also releases all the references to release resources.\n\nDescriptions of the changes in this PR:\n1. add interface LedgerEntries;\n2. add implemtation of LedgerEntries;\n3. fix related build and test errors.\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: ivankelly, sijie, eolivelli\n\nThis closes #727 from zhaijack/issue-693, closes #693\n","Date":"Thu Nov 23 12:56:21 CET 2017"},{"Commit-ID":"commit 2915f55c9714fcfb88ad443f5d957b786736ecbd 1511555335 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Nov 24 12:28:55 2017 -0800]","Body":"ISSUE #553: Documentation for new fluent API\n\nDescriptions of the changes in this PR:\n\n- Add documentation for the new fluent API: create/open/delete, append/write/read, createadv\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #764 from sijie/api_documentation, closes #553\n","Date":"Fri Nov 24 21:28:55 CET 2017"},{"Commit-ID":"commit dc49b8b5c5a5e8d914cb80d4bc18051db8cc5313 1511711817 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Sun Nov 26 07:56:57 2017 -0800]","Body":"Make LedgerEntries an Iterable<LedgerEntry>\n\nThis seems to have been overlooked in the previous changes. As the title\nsays, this change just adds the Iterable<LedgerEntry> to the interfaces\nfrom which LedgerEntries extends.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #770 from ivankelly/ledger-entries-iterable\n","Date":"Sun Nov 26 16:56:57 CET 2017"},{"Commit-ID":"commit ad546aeee2ce77213bfd99c456441a274013a1bb 1511834911 -----sp","Author":"PersonIdent[Aaron Coburn, acoburn@amherst.edu, Tue Nov 28 10:08:31 2017 +0800]","Body":"ISSUE #230: Enable Checkstyle on the tls package\n\nThis is part of #230 and adds Checkstyle verification to the TLS package in `bookkeeper-server`.\n\nAuthor: Aaron Coburn <acoburn@amherst.edu>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #779 from acoburn/checkstyle_tls, closes #230\n","Date":"Tue Nov 28 03:08:31 CET 2017"},{"Commit-ID":"commit 90a82c278dab9c878e649d5aa8b0da9580287830 1511858721 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Nov 28 09:45:21 2017 +0100]","Body":"Explicitly search for bookkeeper-server jar\n\nRather than listing all jars, and excluding some exceptions, search for\njars which match a specific pattern, namely:\n\n  bookkeeper-server-[version].jar\n\nWhere [version] may include numbers, dots and optionally -SNAPSHOT.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>, Matteo Merli <mmerli@apache.org>\n\nThis closes #772 from ivankelly/fix-local-bookie\n","Date":"Tue Nov 28 09:45:21 CET 2017"},{"Commit-ID":"commit d207432375e48c901ee13684ec1c395eeded9389 1511885124 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Nov 28 17:05:24 2017 +0100]","Body":"Don't print out redundant JMX notice\n\nUsers don't really care that JMX is enabled by default, so don't print\nit out.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #782 from ivankelly/no-jmx\n","Date":"Tue Nov 28 17:05:24 CET 2017"},{"Commit-ID":"commit 87ffad969c160b0e82944a6638f1710347b0bbeb 1511957048 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Nov 29 13:04:08 2017 +0100]","Body":"BP-20: Github workflow for bookkeeper proposals\n\nDescriptions of the changes in this PR:\n\nImplementing a github workflow for bookkeeper proposals, so all the bookkeeper proposals can be reviewed as code changes, and they can be maintained in the same way as how we maintain documentation.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <zhaijia03@gmail.com>\n\nThis closes #760 from sijie/BP_20\n","Date":"Wed Nov 29 13:04:08 CET 2017"},{"Commit-ID":"commit 819443cd5efc9393236d76ca2a5e2284efea0e22 1512010419 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Nov 29 18:53:39 2017 -0800]","Body":"ISSUE #544: Bootup cookie validation considers an empty journal to signify a new bookie\n\nDescriptions of the changes in this PR:\n\n- read cookie from registration manager as the source-of-truth (for all potential options)\n- remove duplicated code between checkEnvironment and checkEnvironmentWithStorageExpansion\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #712 from sijie/fix_cookie_issue, closes #544\n","Date":"Thu Nov 30 03:53:39 CET 2017"},{"Commit-ID":"commit 24d53cb241d0cd08c4fb99101d963bceb9b0d8cb 1512010683 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Nov 29 18:58:03 2017 -0800]","Body":"Tests wait for client to see started bookie\n\nUp until now we were only waiting for the bookie to exist in the\nbookie list, after which we triggered a read. However, when the\nregistration changes went in, the read wasn't actually populating the\nmechanism used to select bookies, so we ended up momentarily having\nunusable bookkeeper clients until the correct read triggered. This\nresulted in flakiness in random tests.\n\nThis change makes it so we wait until the client has seen a bookie\nbefore startBookie will return. It also makes sure that reading the\nbookie list actually populates the bookie selection mechanism.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #775 from ivankelly/no-enough-bookie-flake\n","Date":"Thu Nov 30 03:58:03 CET 2017"},{"Commit-ID":"commit 58d0fc2dcf327beabe31cda54b461bf9a6bbbafa 1512020129 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Thu Nov 30 13:35:29 2017 +0800]","Body":"ISSUE #695: add release notes for 4.6.0\n\nDescriptions of the changes in this PR:\nadd release notes for 4.6.0.\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #759 from zhaijack/issue-695, closes #695\n","Date":"Thu Nov 30 06:35:29 CET 2017"},{"Commit-ID":"commit 64650cfc3fc2f25393c71252341a37a03db5be15 1512021178 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Nov 30 13:52:58 2017 +0800]","Body":"ISSUE #765: Add `isClosed()` to ReadHandle\n\nDescriptions of the changes in this PR:\n\nadd `isClosed` to ReadHandle, so distributedlog can use this for implementing readers.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #786 from sijie/is_sealed, closes #765\n","Date":"Thu Nov 30 06:52:58 CET 2017"},{"Commit-ID":"commit 089c2ef0db37ae6ba781f1c49951877c3dbf2f8a 1512027032 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Nov 29 23:30:32 2017 -0800]","Body":"Make distributedlog compiled with latest bookkeeper version\n\nDescriptions of the changes in this PR:\n\nThere are code changes on PendingReadOp for new bookkeeper api in current master. DistributedLog uses PendingReadOp for some administration tools. So the current master doesn't compile with the latest bookkeeper version. This code change is to fix that.\n\nThe change here includes:\n\n- bump bk to 4.7.0-SNAPSHOT (will switch to 4.6.0 after it is released)\n- change to use the latest CompletableFuture in latest PendingReadOp. (this change doesn't target at making distributedlog work with new API)\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #240 from sijie/sijie/use_new_ledger_api\n","Date":"Thu Nov 30 08:30:32 CET 2017"},{"Commit-ID":"commit d5774858934bdfd22c8e873c355722750c50f33b 1512036718 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Nov 30 11:11:58 2017 +0100]","Body":"ISSUE #784: LedgerEntries#close should not throw checked exception\n\nDescriptions of the changes in this PR:\n\noverride `close()` in LedgerEntries to make it not throw checked exception.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Jia Zhai <zhaijia@apache.org>\n\nThis closes #785 from sijie/dont_throw_exception_on_close, closes #784\n","Date":"Thu Nov 30 11:11:58 CET 2017"},{"Commit-ID":"commit 5f3496f740629ba4ea0d0abb3272ca2e6d8ccba7 1512137629 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Dec 1 22:13:49 2017 +0800]","Body":"ISSUE #787: Client should be able to get ledger metadata from Handles.\n\nDescriptions of the changes in this PR:\n\n- create a `LedgerMetadata` interface for exposing public information\n- add `getLedgerMetadata` to Handle, so both WriteHandle and ReadHandle are able to access the metadata.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #788 from sijie/ledger_metadata_interface, closes #787\n","Date":"Fri Dec 01 15:13:49 CET 2017"},{"Commit-ID":"commit 77efe5a8ec69d3c53438eb8f7af2dd2339992388 1512144138 -----sp","Author":"PersonIdent[Aaron Coburn, acoburn@amherst.edu, Fri Dec 1 17:02:18 2017 +0100]","Body":"ISSUE 230: Enable Checkstyle on the conf package\n\nThis is part of #230 and adds Checkstyle verification to the conf\npackage in bookkeeper-server.\n\nAs with #792, most of the changes here should be non-controversial. However, as with #792, there is a constant field whose name needed to be renamed. `AbstractConfiguration` has a `protected static final` field called `defaultLoader`. This field is used in the two implementing classes, so keeping `protected` visibility seems right. So in this case, the field has been renamed to `DEFAULT_LOADER` while keeping the `protected static final` modifiers.\n\nThe changed line is: https://github.com/apache/bookkeeper/compare/master...acoburn:checkstyle_conf?expand=1#diff-b4f821552b13a688d62015e96092e08eR45\n\nAuthor: Aaron Coburn <acoburn@amherst.edu>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #796 from acoburn/checkstyle_conf\n","Date":"Fri Dec 01 17:02:18 CET 2017"},{"Commit-ID":"commit 86b915ce845f4ee3c7c0eb2971e051368d061943 1512144233 -----sp","Author":"PersonIdent[Aaron Coburn, acoburn@amherst.edu, Fri Dec 1 17:03:53 2017 +0100]","Body":"ISSUE #230: Enable Checkstyle on the meta package\n\nThis is part of #230 and adds Checkstyle verification to the meta\npackage in bookkeeper-server.\n\nAuthor: Aaron Coburn <acoburn@amherst.edu>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #797 from acoburn/checkstyle_meta, closes #230\n","Date":"Fri Dec 01 17:03:53 CET 2017"},{"Commit-ID":"commit ba7db47ab912269eca160bc1112f46cc417688d1 1512144320 -----sp","Author":"PersonIdent[Aaron Coburn, acoburn@amherst.edu, Fri Dec 1 17:05:20 2017 +0100]","Body":"ISSUE #230: Enable Checkstyle on the proto package\n\nThis is part of #230 and adds Checkstyle verification to the proto\npackage in bookeeper-server.\n\nThe changes here should generally be non-controversial, but I would like to highlight one change for particular review. In the `PerChannelBookieClient` class, there is a `public static final` field called `txnIdGenerator`. The checkstyle rules require that such public fields are ALL_CAPS. So one option would be to change that field to `TX_ID_GENERATOR` (this would be a change to the public API).\n\nThe relevant diff is here: https://github.com/apache/bookkeeper/compare/master...acoburn:checkstyle_proto?expand=1#diff-e50ee2c1aec1539ea185a94605b0e550R143\n\nHowever, that field is never used outside this class, so the other option is to make the field private and keep the name as-is. (Making the field private is also a change to the public API)\n\nI chose the second option because the field seemed more like an internal field. If, however, the field should be left public, I can add a commit that changes the name to `TX_ID_GENERATOR` so that it passes the checkstyle rules.\n\nAuthor: Aaron Coburn <acoburn@amherst.edu>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #792 from acoburn/checkstyle_proto, closes #230\n","Date":"Fri Dec 01 17:05:20 CET 2017"},{"Commit-ID":"commit 81cbba3cf620f2a6df48c0da6ee1ac019de24fbc 1512191153 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Dec 1 22:05:53 2017 -0700]","Body":"ISSUE #659: Fix Checkpoint logic in SortedLedgerStorage\n\nDescriptions of the changes in this PR:\n\n- add a test case to reproduce the behavior\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Charan Reddy Guttapalem <reddycharan18@gmail.com>\n\nThis closes #677 from sijie/fix_checkpoint, closes #659\n","Date":"Sat Dec 02 06:05:53 CET 2017"},{"Commit-ID":"commit 356c091b66a2d8b76943f707a5bebfa7939719b5 1512213963 -----sp","Author":"PersonIdent[Aaron Coburn, acoburn@amherst.edu, Sat Dec 2 19:26:03 2017 +0800]","Body":"ISSUE #230: Add Checkstyle to some packages\n\nThis is part of #230 and adds checkstyle verification to the following\npackages in bookkeeper-server:\n\n  - metastore\n  - net\n  - sasl\n\nDescriptions of the changes in this PR:\n\nMost of the changes are entirely stylistic, but there were a few minor functional changes:\n\n  - In `metastore.MetastoreUtils`, the protected `logger` field was changed to `private` (it is not accessed from outside the class).\n  - In `metastore.Value`, the package-protected `comparator` field was changed to `private` (it, too, is not accessed outside the class).\n\nAuthor: Aaron Coburn <acoburn@amherst.edu>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #799 from acoburn/more_checkstyle, closes #230\n","Date":"Sat Dec 02 12:26:03 CET 2017"},{"Commit-ID":"commit 257c21630ab93b6adccbf955899451bd550a1d07 1512215221 -----sp","Author":"PersonIdent[Aaron Coburn, acoburn@amherst.edu, Sat Dec 2 19:47:01 2017 +0800]","Body":"ISSUE #230: Enable checkstyle for more packages\n\nPart of #230, this enables the checkstyle plugin for the `replication` and\n`server.http.service` packages.\n\nDescriptions of the changes in this PR:\n\nMost of the changes here are merely cosmetic. The only change of any significance is in the `RecoveryBookieService.RecoveryRequestJsonBody` class in which the JSON object fields had to be changed in order to conform to the Checkstyle rules: `bookie_src` to `bookieSrc` and `delete_cookie` to `deleteCookie`. Using a Jackson annotation (`JsonProperty`), however, means that these field names continue to be parsed and serialized as `bookie_src` and `delete_cookie`, respectively.\n\nAuthor: Jia Zhai <jiazhai@users.noreply.github.com>\nAuthor: Aaron Coburn <acoburn@amherst.edu>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #800 from acoburn/checkstyle_replication, closes #230\n","Date":"Sat Dec 02 12:47:01 CET 2017"},{"Commit-ID":"commit 39a539e5c5a3381cad9e5e0da334c7f359e17c3b 1512372363 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Sun Dec 3 23:26:03 2017 -0800]","Body":"Removed all per-entry allocations in Journal operations\n\nThis change was originally b2cc158a from the yahoo-4.3 branch.\n\nAuthor: Ivan Kelly <ivank@apache.org>\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #798 from ivankelly/yahoo-bp-5\n","Date":"Mon Dec 04 08:26:03 CET 2017"},{"Commit-ID":"commit f671926f7fbc89e9bb20e2a3b5e937dc6b716cc3 1512376805 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Mon Dec 4 16:40:05 2017 +0800]","Body":"ISSUE #801: remove assembly plugin in root pom\n\nDescriptions of the changes in this PR:\nmvn release:prepare cmd will fail, for the wrong assembly plugin in root pom. This change remove it, for it has already in bookkeeper-dist/pom.\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #802 from jiazhai/issue-801, closes #801\n","Date":"Mon Dec 04 09:40:05 CET 2017"},{"Commit-ID":"commit a082e26129ef88f46f676e359011a5736e8dc7db 1512393978 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Dec 4 21:26:18 2017 +0800]","Body":"Fix bin/bookkeeper to work with release\n\nPart of the assembly process prepends the package name to the\nbookkeeper-server, which wasn't taken into account by\nbin/bookkeeper. This change takes it into account.\n\nIt also stops the script from printing a warning if a directory\ndoesn't exist.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #803 from ivankelly/bad-script\n","Date":"Mon Dec 04 14:26:18 CET 2017"},{"Commit-ID":"commit ee6d9233ae69433d198cb043700a538c4a7b0cbd 1512412123 -----sp","Author":"PersonIdent[eolivelli, eolivelli@apache.org, Mon Dec 4 10:28:43 2017 -0800]","Body":"ISSUE #689: improve release guide for minor versions\n\nAuthor: eolivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #777 from eolivelli/improve-guide-minor, closes #689\n","Date":"Mon Dec 04 19:28:43 CET 2017"},{"Commit-ID":"commit 7087fda4e91e9fe8974f9d36e01e275a08bf38f1 1512425282 -----sp","Author":"PersonIdent[Aaron Coburn, acoburn@amherst.edu, Mon Dec 4 14:08:02 2017 -0800]","Body":"ISSUE #230: Enable checkstyle on bookie and client\n\nPart of #230, this adds checkstyle verification to the bookie and client packages in `bookkeeper-server`.\n\nDescriptions of the changes in this PR:\n\nThe changes here are primarily cosmetic, but there are also two notable changes to point out:\n\n1. In both `TopologyAwareEnsemblePlacementPolicy.TruePredicate` and `TopologyAwareEnsemblePlacementPolicy.EnsembleForReplacementWithNoConstraints` a `public static final` field was renamed from `instance` to `INSTANCE`. This is consistent with the use of an `INSTANCE` field in the `bookkeeper-stats` package. An alternative would be to introduce a public method `getInstance()`, but either way the checkstyle rules don't like a public constant field in lower case.\n\n2. In `UpdateLedgerOp#updateBookieIdInLedgers()`, the `throws BKException` part of the signature is problematic and prevents the checkstyle validation from completing successfully. From what I can tell, that checked exception is never thrown; as such, I have removed that from the signature. I have also removed the corresponding guard from `bookie.BookieShell`.\n\nAuthor: Aaron Coburn <acoburn@amherst.edu>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #806 from acoburn/checkstyle_client_bookie, closes #230\n","Date":"Mon Dec 04 23:08:02 CET 2017"},{"Commit-ID":"commit a32a7f0eabf36ddc8310e9d3b506f2ab277102f1 1512425404 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Dec 4 14:10:04 2017 -0800]","Body":"Fixed simultaneus reads on same ledger/entry with v2 protocol\n\nThis change is coming from yahoo branch at yahoo/bookkeeperce7b0f7\n\nWith v2 protocol there's no way to disambiguate the read request since the completion key is made from (ledgerId, entryId).\nThis PR introduced an additional multimap to handle the conflicts (multiple simultaneus read requests for the same entry).\n\nAuthor: Ivan Kelly <ivank@apache.org>\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #720 from merlimat/concurrent-read-v2\n","Date":"Mon Dec 04 23:10:04 CET 2017"},{"Commit-ID":"commit d2f90de13d4d6c5da4c49d0d6c1a51dc0dbf6a49 1512430913 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Dec 4 15:41:53 2017 -0800]","Body":"Fix checkstyle in PCBC\n\nTwo inflight PRs clashes to create a broken build due to\ncheckstyle being enabled. This patch fixes the checkstyle issue, which\nwas import order.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #807 from ivankelly/fix-style\n","Date":"Tue Dec 05 00:41:53 CET 2017"},{"Commit-ID":"commit e366d97df11c84e29fcc4aadaab1bb23b30cf9db 1512431797 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon Dec 4 15:56:37 2017 -0800]","Body":"Use concurrent open hash map to track pending requests in PerChannelBookieClient\n\nConcurrentOpenHashMap doesn't allocate a Map.Entry for each\ninsertion/lookup, so this reduces garbage in the fast path.\n\nOriginal change 64ab580a in yahoo-4.3 branch.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #808 from ivankelly/yahoo-bp-6\n","Date":"Tue Dec 05 00:56:37 CET 2017"},{"Commit-ID":"commit 7b52db2fb58ac592b54a610b8afb0c9b42184386 1512521190 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Dec 5 16:46:30 2017 -0800]","Body":"Fix flake in TestPerChannelBookieClient\n\nFlake is in testRequestCompletesAfterDisconnectRace. It tests a race\nbetween disconnection and making a request. The flake occurred because\nwhen the disconnection happened, the request would be errorred out,\nand this would add a callback to the ordered executor. The test was\nshutting down the executor before the callback was actually run (it\nmay not even have been added in some cases), and this was causing the\nrequest to never complete, failing the test.\n\nThe fix is to move the shutdown of the executor to after the assertion\nthat the request has completed.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #816 from ivankelly/pcbc-flake\n","Date":"Wed Dec 06 01:46:30 CET 2017"},{"Commit-ID":"commit 0ab3ea0bab5c3d3fe0c84c8a3843467f0bea31cd 1512521397 -----sp","Author":"PersonIdent[Aaron Coburn, acoburn@amherst.edu, Tue Dec 5 16:49:57 2017 -0800]","Body":"ISSUE #230: Enable checkstyle on util package\n\nPart of #230, this adds checkstyle verification to the util package in\nbookkeeper-server.\n\nA few notable changes:\n  - in `util.HardLink`, the field `osType` becomes `OS_TYPE`.\n  - in `util.LocalBookkeeper`, a few package-protected fields are marked private and changed to camelCase.\n\nAuthor: Aaron Coburn <acoburn@amherst.edu>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #815 from acoburn/checkstyle_util, closes #230\n","Date":"Wed Dec 06 01:49:57 CET 2017"},{"Commit-ID":"commit 456451bbf925a3d3813238a378c794864f25cb36 1512521532 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Tue Dec 5 16:52:12 2017 -0800]","Body":"ISSUE #805: some fix in release_guide.md\n\nDescriptions of the changes in this PR:\n\nduring preparing release 4.6.0, there was some errors meet,\n1,\n`git tag -d ${VERSION} && git push apache :refs/tags/${VERSION}`\nshould be\n`git tag -d release-${VERSION} && git push apache :refs/tags/release-${VERSION}`\n\n2, .m2/settings.xml may not take effect for \"Apache Nexus repository\" setting, it may be not your \"global settings file\"\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #811 from jiazhai/issue-805, closes #805\n","Date":"Wed Dec 06 01:52:12 CET 2017"},{"Commit-ID":"commit b8dee21a253f4d6f449e53afa5596cc6c54b189c 1512521593 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Dec 5 16:53:13 2017 -0800]","Body":"Update the BP workflow\n\nDescriptions of the changes in this PR:\n\n- incorporate the feedback from JV last week: allow people to use google doc for writing a BP. Google doc is great for collaboration in general.\n- incorporate Ivan's comment on workflow #761  : how to handle failed BPs. The principle here is BPs are in general good ideas, we should keep those records for future references. so add an instruction on merging the failed BPs.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>\n\nThis closes #810 from sijie/fix_bp_workflow\n","Date":"Wed Dec 06 01:53:13 CET 2017"},{"Commit-ID":"commit 1d6b5506599accca30129348d52048b25766d1fa 1512522367 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Dec 5 17:06:07 2017 -0800]","Body":"Handle unexpected throwable in Bookie V2 request processors\n\nMerging from https://github.com/yahoo/bookkeeper/commit/c54eafbe\n\nWhen getting any exception, the request processor for V2 protocol must make sure to get some response back to client. In the specific case, it was some NPE that was thrown and not handled properly.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #813 from merlimat/handle-throwable\n","Date":"Wed Dec 06 02:06:07 CET 2017"},{"Commit-ID":"commit b07732e29df22acabb0a7b8198cdff41c04bb27b 1512522828 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Dec 6 02:13:48 2017 +0100]","Body":"BP-21:  New API close inconsistencies (#790)\n\nState: Rejected\r\nReason: Rejected due to lack of agreement that the issues raised in the motivation are valid.\r\n","Date":"Wed Dec 06 02:13:48 CET 2017"},{"Commit-ID":"commit 3abf2c7fa743efc72b48c13bdb8977ac64061744 1512523117 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Dec 6 02:18:37 2017 +0100]","Body":"BP-22: Separate closing ledgers from opening ledgers (#795)\n\nState: Rejected\r\nReason: Rejected due to lack of agreement that the issues raised in the motivation are valid.\r\n","Date":"Wed Dec 06 02:18:37 CET 2017"},{"Commit-ID":"commit a7991e5616b0f78d3b80334774a5b7d63dabb8c9 1512548928 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Dec 6 00:28:48 2017 -0800]","Body":"Recycle responses callbacks\n\nA response callback is created each time we receive a response from a\nserver, which can result in a lot of garbage in the fast path.\n\nThis change pools the callbacks.\n\nThis change was originally 729bd2d0 in the yahoo-4.3 branch.\n\nAuthor: Ivan Kelly <ivank@apache.org>\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #809 from ivankelly/yahoo-bp-7\n","Date":"Wed Dec 06 09:28:48 CET 2017"},{"Commit-ID":"commit b69f1e4d63e3f7adf04a772bd5cef002c81bc311 1512549044 -----sp","Author":"PersonIdent[Arvin, arvindevel@gmail.com, Wed Dec 6 00:30:44 2017 -0800]","Body":"ISSUE #568: Refactor EntryLoggerAllocator to enable preallocation\n\nDescriptions of the changes in this PR:\n\nEnable 'entryLogFilePreallocationEnabled' which is  never be used.\n\nAuthor: Arvin <arvindevel@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #814 from ArvinDevel/issue568, closes #568\n","Date":"Wed Dec 06 09:30:44 CET 2017"},{"Commit-ID":"commit 143bd1952851ac70ace9d16c3708ae30dad2a0aa 1512686566 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Dec 7 14:42:46 2017 -0800]","Body":"Use ConcurrentLongLongHashMap in EntryLogMetadata\n\nPorting commits https://github.com/yahoo/bookkeeper/commit/74afc16d1c1e93739edf4a78801c5ccb6afd3883 and https://github.com/yahoo/bookkeeper/commit/eba3bbfbbaf58118c0c5736b56d3897a5928bc89 from Yahoo branch.\n\nCurrently the `EntryLogger` is keeping a `ConcurrentHashMap<Long, Long>` to keep track of amount of data stored in a single entry log file for each of the ledgers.\n\nThe amount of memory required is high because of the objects boxing. The `Long` used for key and value are 16 bytes each and the hash-map node will take another ~24 bytes.\n\nAdditionally, all these objects are created, stored for hours and then GCed, after being tenured.\n\nBy using `ConcurrentLongLongHashMap`, we eliminate the object boxing and the need for the \"node\" since it's a open hashmap. This helps reducing a lot the memory used by the bookie when storing a large amount of entries (54 --> 16 bytes).\nAlso since we store the items in `long[]`, this will not need objects and it will not affect GC.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #821 from merlimat/entrylog-metadata\n","Date":"Thu Dec 07 23:42:46 CET 2017"},{"Commit-ID":"commit d9f764f9590411c8c2e7c4e9f1a47f77b9ab987f 1512693858 -----sp","Author":"PersonIdent[Aaron Coburn, acoburn@amherst.edu, Thu Dec 7 16:44:18 2017 -0800]","Body":"ISSUE #230: Enable checkstyle on some test classes\n\nPart of #230, this enables checkstyle verification on some\nof the test code. This does not do checkstyle validation on\nthe client or bookie package test code.\n\nEnabling checkstyle on the entire test codebase would result in a _very_ large PR. This is an attempt to break it up into smaller pieces. The changes here are almost exclusively related to whitespace, javadocs and import order.\n\nOne public change of note is in `replication.AuditorLedgerCheckerTest`: the `_testDelayedAuditOfLostBookies` method is changed to `testInnerDelayedAuditOfLostBookies`.\n\nAuthor: Aaron Coburn <acoburn@amherst.edu>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #819 from acoburn/checkstyle_test, closes #230\n","Date":"Fri Dec 08 01:44:18 CET 2017"},{"Commit-ID":"commit c682ecb076c9cf8b845917244acfc2bc575f4b9d 1512693962 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Dec 7 16:46:02 2017 -0800]","Body":"Use netty DefaultThreadFactory everywhere to take advantage of fast thread local access\n\nMerging https://github.com/yahoo/bookkeeper/commit/38ff21ad8bbd8ac8ec8a4898ef9ecf473fea94b7 from Yahoo branch.\n\nNetty has a special `FastThreadLocal` class that is used in many places (eg: when borrowing a buffer from a pool). The mechanism in which it works is that the thread has to be created from a particular thread factory to take advantage of it (it adds a couple of fields subclassing the `Thread` class).\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #823 from merlimat/thread-factory\n","Date":"Fri Dec 08 01:46:02 CET 2017"},{"Commit-ID":"commit b7bfac88ffae8acd82cae05fe6236f5a7db3a796 1512785963 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri Dec 8 18:19:23 2017 -0800]","Body":"Refactored EntryLogger Buffered channel\n\nPorting https://github.com/yahoo/bookkeeper/commit/ecce14449b07e0b40434835bbc01d75d0a36880b from Yahoo branch.\n\nRefactored entry logger to always use pooled `ByteBuf` when reading entries or scanning the log.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #824 from merlimat/entry-logger-refactor and squashes the following commits:\n\n6ddb31d6 [Matteo Merli] Fix DoubleByteBuf readableBytes()\na6df2974 [Matteo Merli] Fixed padding length and journal test\nbbe65eb8 [Matteo Merli] Removed BufferedReadChannel close since the buffer was not pooled anyway\nc50f4683 [Matteo Merli] Added required changes to uses of BufferedChannel from Journal\n6746d038 [Matteo Merli] Refactored EntryLogger Buffered channel\n","Date":"Sat Dec 09 03:19:23 CET 2017"},{"Commit-ID":"commit dcc13052f1f43ff6d6078d12a4d3c8444967b651 1512788340 -----sp","Author":"PersonIdent[Aaron Coburn, acoburn@amherst.edu, Sat Dec 9 10:59:00 2017 +0800]","Body":"ISSUE #230: Enable checkstyle on client tests\n\nDescriptions of the changes in this PR:\n\nThis enables checkstyle verification on the client test\ncode in the bookkeeper-server module.\n\nThese changes are almost entirely related to whitespace, javadocs and import order.\n\nMaster Issue: #230\n\nAuthor: Aaron Coburn <acoburn@amherst.edu>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #825 from acoburn/checkstyle_test_client, closes #230\n","Date":"Sat Dec 09 03:59:00 CET 2017"},{"Commit-ID":"commit 5dd324f65fbec5fab2d43a0d14bdf53adb32f9b3 1512808472 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Dec 9 16:34:32 2017 +0800]","Body":"Fix NOTICE and LICENSE\n\nDescriptions of the changes in this PR:\n\n- combine the NOTICE, LICENSE files into one for both src and binary distribution.\n- make a few dependencies as `provided`\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #820 from sijie/fix_notice_license\n","Date":"Sat Dec 09 09:34:32 CET 2017"},{"Commit-ID":"commit f14be643e9fdc4db39323bc98e2735cfb169e75e 1512808737 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Sat Dec 9 16:38:57 2017 +0800]","Body":"ISSUE #818: add api changes in release notes of 4.6.0\n\nDescriptions of the changes in this PR:\nadd changes of BookKeeper constructor and EnsemblePlacementPolicy in release notes of 4.6.0\n\nMaster Issue: #818\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #822 from jiazhai/issue-818, closes #818\n","Date":"Sat Dec 09 09:38:57 CET 2017"},{"Commit-ID":"commit a5ca3a9235fecc44e60cca0d46ddb546c2438613 1513025871 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Dec 11 21:57:51 2017 +0100]","Body":"Race in PCBC connection if channel inactive before callback\n\nThere's a race in PCBC where if the channel is errored before the\nconnection callback occurs, the channel will hang around as a zombie\nforever.\n\nThis caused a flake in\nTestDisableEnsembleChange#testRetryFailureBookie, but the problem\nitself could affect production code. This test hit it because it tries\nto reconnect in a tight loop as a bookie is booting.\n\nThe error occurs because we only change state with channelInactive if\nthe channelInactive occurred on the channel that matches the currently\nassigned this.channel. If the channel connects successfully, but\nchannelInactive occurs before the connect callback runs, the channel\nwill be closed, but the state will be transitioned to CONNECTED. No\nmore events will occur on the channel, so it'll hang around forever,\nand all requests on the channel will timeout.\n\nThe fix is to check that the channel is active before assigning it to\nthis.channel and setting state to CONNECTED. If the channel is not\nactive at this point, then the else clause of this block will run\nwhich closes the channel, and sets state to DISCONNECTED. In this\ncase, the next request will trigger a new connection attempt.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nThis closes #827 from ivankelly/ensemble-flake\n","Date":"Mon Dec 11 21:57:51 CET 2017"},{"Commit-ID":"commit 13c303f916b5b82702d73e2377b2caf75500243a 1513081302 -----sp","Author":"PersonIdent[Aaron Coburn, acoburn@amherst.edu, Tue Dec 12 13:21:42 2017 +0100]","Body":"ISSUE #230: Enable checkstyle on the bookie tests\n\nDescriptions of the changes in this PR:\n\nWith this change, checkstyle verification is enabled for the\nentire bookkeeper-server package, and all packages use the same `suppressions.xml` file.\n\nMaster Issue: #230\n\nAuthor: Aaron Coburn <acoburn@amherst.edu>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #830 from acoburn/checkstyle_test_bookie, closes #230\n","Date":"Tue Dec 12 13:21:42 CET 2017"},{"Commit-ID":"commit 786da273b0f90c1b35b7244b0408959fd034d411 1513154605 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Dec 13 16:43:25 2017 +0800]","Body":"Client times out requests in batch rather than individually\n\nThis patch is a squash of f59b597f, 00fc5cd2, 1658eb61 & 833dc307 from the yahoo-4.3 branch. The change removes the HashWheelTimer from PerChannelBookieClient and instead runs through all outstanding ops periodically, timing them out as necessary.\n\nThe motivation for this change is to reduce the number of objects created per add/read request. With HashWheelTimer a TimerTask needs to be added to the Timer, which allocates and returns a Timeout object. We had to be careful to cancel this timeout on success.\n\nThe new approach is simpler, doesn't require any allocation per request, and doesn't require any cancellation. Functionally the end result is the same - very slow requests are timed out.\n\nThe patch also makes some additions to the original changes (due to the codebase moving since it was originally written).\n- PendingAddOps are changed to use the same mechanism for quorum timeouts.\n- The checkTimeout method is moved to the PCBCPool so we can run the check on non-connected PCBC instances. This is necessary for TLS.\n\nAuthor: Ivan Kelly <ivank@apache.org>\nAuthor: Siddharth Boobna <sboobna@yahoo-inc.com>\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #817 from ivankelly/yahoo-bp-9\n","Date":"Wed Dec 13 09:43:25 CET 2017"},{"Commit-ID":"commit 271e6faa3ace16c1ca52e55caac3d76d26d1f6ab 1513154837 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Dec 13 16:47:17 2017 +0800]","Body":"DbLedgerStorage -- Write cache\n\n1st part of DbLedgerStorage related changes.\n\nThis PR introduces a `WriteCache` class that is used to store entries before they get flushed on the entryLogs.\n\nThe key part is that it provides a way to iterate in order over the entries and it is is garbage-free at steady state.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #828 from merlimat/db-ledger-storage-itemized\n","Date":"Wed Dec 13 09:47:17 CET 2017"},{"Commit-ID":"commit f1bee51d8157399fc4e1b777376b29656d154819 1513155102 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Wed Dec 13 16:51:42 2017 +0800]","Body":"ISSUE #831: move zkServers and zkTimeout into AbstractCofiguration\n\nDescriptions of the changes in this PR:\n\nboth ClientConfiguration and ServerConfiguration contain ZkServers and ZKTimeout, would like to move them into AbstractConfiguration.\n\nChanges:\n1, Regarding methods setZkServers/getZkServers/setZkTimeout/getZkTimeout,  remove them in ClientConfiguration and ServerConfiguration; added them in AbstractConfiguration;\n2, fix usage of above methods in test cases;\n\nMaster Issue: #831\n\nAuthor: Jia Zhai <zhaijia@apache.org>\nAuthor: Sijie Guo <guosijie@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #833 from zhaijack/issue-831, closes #831\n","Date":"Wed Dec 13 09:51:42 CET 2017"},{"Commit-ID":"commit 8e6c1a2e76a77b0dcf503e25a90a12d2d7b784ab 1513155394 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Dec 13 16:56:34 2017 +0800]","Body":"DbLedgerStorage -- KeyValue storage interface with RocksDB implementation\n\nAdd an interface for a generic key-value storage local library, with the default implementation based on RocksDB.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #829 from merlimat/key-value-storage\n","Date":"Wed Dec 13 09:56:34 CET 2017"},{"Commit-ID":"commit ddc09d55a4379846c68a56db56889cf94caa777d 1513196324 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Dec 13 12:18:44 2017 -0800]","Body":"Fixed RocksDb storage options instantiation after library is loaded\n\nIn previous commit 8e6c1a2e76a, the initialization of some RocksDb option objects was done before the RocksDB JNI library was loaded, leading to exceptions.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #840 from merlimat/key-value-storage\n","Date":"Wed Dec 13 21:18:44 CET 2017"},{"Commit-ID":"commit f207d2d9f432d43e2461f260056b91f1ba4803e1 1513201248 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Dec 13 13:40:48 2017 -0800]","Body":"Fix FlakyTest TestRegionAwareEnsemblePlacementPolicy\n\nDescriptions of the changes in this PR:\n\ninclude all possible resolved hostnames into the static dns resolver for region aware testing.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #837 from sijie/fix_regionaware\n","Date":"Wed Dec 13 22:40:48 CET 2017"},{"Commit-ID":"commit 50d50bd8064f67583c70688171bd3386ae418b64 1513201504 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Dec 13 13:45:04 2017 -0800]","Body":"Fix Flaky CreateNewLogTest\n\nDescriptions of the changes in this PR:\n\nCreateNewLogTest becomes flaky after fixing #568 because preallocation can happen in the background. Changing the sequence of creating entry logger and entry log file injection to make the test sequence deterministic.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #836 from sijie/fix_createnewlog_test\n","Date":"Wed Dec 13 22:45:04 CET 2017"},{"Commit-ID":"commit aecf6da41f8978ad82b1f0cf65fc914f242e1d16 1513201575 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Dec 13 13:46:15 2017 -0800]","Body":"Allow subclasses of AbstractConfiguration to use fluent style\n\nAnd in doing so, get rid of ugly casts.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #835 from ivankelly/abstract-conf-generic\n","Date":"Wed Dec 13 22:46:15 CET 2017"},{"Commit-ID":"commit 7c4e6c9b0035c561e051d028765b319e9ecc9268 1513202059 -----sp","Author":"PersonIdent[Matteo Minardi, matteo.minardi@diennea.com, Wed Dec 13 13:54:19 2017 -0800]","Body":"ISSUE #741: Switch to Spotbugs\n\nMoved from findbugs plugin to spotbugs.\n\nAuthor: Matteo Minardi <matteo.minardi@diennea.com>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #834 from mino181295/ISSUE#741, closes #741\n","Date":"Wed Dec 13 22:54:19 CET 2017"},{"Commit-ID":"commit 3e4ff0dca8557ff03dda2d292c3c6678df8f1a02 1513208630 -----sp","Author":"PersonIdent[eolivelli, eolivelli@apache.org, Wed Dec 13 15:43:50 2017 -0800]","Body":"ISSUE #744: BP-18 introduce write flags\n\nIntroduce writeflags on the API and on protobuf files.\nClient and server do not use these flags yet.\n\nAuthor: eolivelli <eolivelli@apache.org>\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #742 from eolivelli/bp14-writeflags, closes #744\n","Date":"Thu Dec 14 00:43:50 CET 2017"},{"Commit-ID":"commit e87bf7c10d2cd51453ddeb1c31ad8ce0a5f1544a 1513209570 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Dec 13 15:59:30 2017 -0800]","Body":"DbLedgerStorage -- ReadCache\n\nAdds a `ReadCache` class to be used from LedgerStorage.\n\nThe read cache is used when doing read-ahead caching after reading one entry.\n\nThe idea is that entries for the same ledger as stored in order (for each flush cycle, eg: 1min). When reading 1 entry, we expect the client to read all subsequent entries. We can then skip the RocksDb `get()` to fetch the index of the entries, by just keep reading from the entryLog, and exploiting page cache and seqeuential reads. The entries are then added to this ReadCache, where they will looked when the request for next entry comes in.\n\nThis implementation is based on dividing the memory into multiple segments. Whenever the read cache is full, the oldest segment gets recycled and overwritten with new entries.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #843 from merlimat/read-cache\n","Date":"Thu Dec 14 00:59:30 CET 2017"},{"Commit-ID":"commit 9d59e6f8066669f2f0a07d7a026d9d7dcdaa2e47 1513212021 -----sp","Author":"PersonIdent[Pasha Kuznetsov, pkuznetsov@salesforce.com, Wed Dec 13 16:40:21 2017 -0800]","Body":"ISSUE #841: Unnecessary new Object[] {}, new String[] {} etc calls\n\nThis takes care of a few new Object[] {}, new String[] {} etc calls,\nmostly leftovers from the older slf4j's LOG API which used to lack\nthe Object... \"vararg\" method overloads, making it easier to read\nand maintain.\n\nAuthor: Pasha Kuznetsov <pkuznetsov@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #842 from pasha-kuznetsov/redundant-arrays, closes #841\n","Date":"Thu Dec 14 01:40:21 CET 2017"},{"Commit-ID":"commit a671d92441c222052f9a5cdcb396a343d60882e5 1513283702 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Dec 14 12:35:02 2017 -0800]","Body":"DbLedgerStorage -- Make some entrylogger methods accessibles\n\nThis changes are needed for `DbLedgerStorage` implementation to access some of the protected methods of the EntryLogger.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #844 from merlimat/db-ledger-storage-itemized and squashes the following commits:\n\nb4d886ea [Matteo Merli] Removed timeout and fixed test\n46652dd4 [Matteo Merli] DbLedgerStorage -- Make entrylogger read methods accessibles\n","Date":"Thu Dec 14 21:35:02 CET 2017"},{"Commit-ID":"commit b727acf9f90314dd0deffad873841e474cc8b9d8 1513324260 -----sp","Author":"PersonIdent[Pasha Kuznetsov, pkuznetsov@salesforce.com, Fri Dec 15 15:51:00 2017 +0800]","Body":"ISSUE #668: Use try-with-resources blocks whenever is possible\n\nUse java7 try-with-resources blocks in order to have error prone code and more elegant\n\nAuthor: Pasha Kuznetsov <pkuznetsov@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #845 from pasha-kuznetsov/try-with-resources, closes #668\n","Date":"Fri Dec 15 08:51:00 CET 2017"},{"Commit-ID":"commit 3ba705057ecafb0529676603ae1d2c3f266362a0 1513327424 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Dec 15 00:43:44 2017 -0800]","Body":"ISSUE #326: Replace observer/observable with a simplified watcher/watchable implementation\n\nDescriptions of the changes in this PR:\n\n- long poll only need one-time notification on lac updates\n- replace observer/observable with a simplified watcher/watchable implementation. watchers are removed after they are fired.\n- add `RecycableHashSet` for `Watchable` keeping the list of watchers\n- object pooling on `Watchable` and `LastAddConfirmedUpdateNotification`\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #838 from sijie/rxjava, closes #326\n","Date":"Fri Dec 15 09:43:44 CET 2017"},{"Commit-ID":"commit bba1c6f5d0d92d647467438876cfa32b699780f6 1513358950 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri Dec 15 09:29:10 2017 -0800]","Body":"DbLedgerStorage -- Main implementation\n\n`LedgerStorage` implementation that uses the EntryLogger mechanism but stores the indexes in a RocksDB database.\n\nIn addition, there are also a WriteCache and a ReadCache that are used to completely decouple the read & write paths.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #855 from merlimat/db-ledger-storage-impl\n","Date":"Fri Dec 15 18:29:10 CET 2017"},{"Commit-ID":"commit d48d3228b991050fc709a8f10c307fd7c5469d5c 1513368816 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Dec 15 10:40:34 2017 -0800]","Body":"Add attribution for binary jars covered by New BSD License\n\nThis means a separate LICENSE file for server and all, as all pulls in\nmore stuff.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #854 from ivankelly/license-fix\n","Date":"Fri Dec 15 19:40:34 CET 2017"},{"Commit-ID":"commit 89ac2a2b7b7883f0b48978bf3dc3802ecf0fc6c1 1513367646 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri Dec 15 11:54:06 2017 -0800]","Body":"DbLedgerStorage -- Added bookie shell tools\n\nAdded BookieShell tools for DbLedgerStorage conversion operations:\n\n * `convert-to-db-storage` --> Convert interleaved indexes to db storage indexes\n * `convert-to-interleaved-storage` --> Convert back from db storage to interleaved storage indexes\n * `rebuild-db-ledger-locations-index` --> Rebuild the DbLedgerStorage index by scanning the entry log files.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #859 from merlimat/db-ledger-storage-itemized\n","Date":"Fri Dec 15 20:54:06 CET 2017"},{"Commit-ID":"commit 97c35e9c02f0b7be33881d1a1c0c500143f8fc55 1513369137 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Dec 15 12:18:57 2017 -0800]","Body":"ISSUE #778: Make build pass using JDK9\n\nDescriptions of the changes in this PR:\n\n- make bookkeeper can be compiled with java 9\n- add java9 to travis ci to make sure it can be built for both java8 and java9\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #857 from sijie/compile_with_java9, closes #778\n","Date":"Fri Dec 15 21:18:57 CET 2017"},{"Commit-ID":"commit d1d6804e15c03a138431945df59a2c41a4f1f205 1513443901 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@yahoo-inc.com, Sat Dec 16 09:05:01 2017 -0800]","Body":"During journal replay, force to re-insert the master key in ledger storage\n\nWhen the bookie crashes and restart, it will replay the entries from the journal. In the case of ledgers that were created, but their metadata was not flushed on disk, the ledger metadata might be lost.\n\nThis is more evident in `DbLedgerStorage`, since the ledger metadata is cached in memory and it's only inserted in the db at the checkpoint time, though it applies as well for `InterleavedLedgerStorage` where the ledger metadata was inserted in the cache but not fsynced on disk.\n\nIf the page cache content is gone, when replaying the journal content, the ledger will be tracked in memory but the bookie won't have the metadata on disk anymore.\n\nMerging from yahoo branch: https://github.com/yahoo/bookkeeper/commit/d3626396ecf1a2b98c782bb30a7b9c00c75c6cdf\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #867 from merlimat/master\n","Date":"Sat Dec 16 18:05:01 CET 2017"},{"Commit-ID":"commit 2b7b24dc569483bd0231e9cd1f2b9a14cc612045 1513561533 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Dec 18 09:45:33 2017 +0800]","Body":"Manage all the jenkins jobs using jenkins-dsl\n\nDescriptions of the changes in this PR:\n\n- use jenkins-dsl to manage all the bookkeeper jobs\n- the seed job will poll the files checked in under `.test-infra/jenkins` at master and automatically update other jenkins jobs\n- this enforces all the jenkins jobs' changes should go through github reviews and allows everyone can make changes to jenkins jobs.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #866 from sijie/test_infra_jenkins_dsl\n","Date":"Mon Dec 18 02:45:33 CET 2017"},{"Commit-ID":"commit bd89cdf20a6db14d2d0b906238c0e1d4a959b36f 1513562023 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon Dec 18 09:53:43 2017 +0800]","Body":"DbLedgerStorage -- Added config options in bk_server.conf\n\nAdded commented config options with default values.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis closes #860 from merlimat/db-storage-conf\n","Date":"Mon Dec 18 02:53:43 CET 2017"},{"Commit-ID":"commit 5199fad8afb49276372f71f49810e7565761cafd 1513631810 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Mon Dec 18 13:16:50 2017 -0800]","Body":"add try-with-resources in coding_guide\n\nDescriptions of the changes in this PR:\n\nThis is related to PR #845, and want to  add try-with-resources in coding_guide.\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #872 from jiazhai/fix_doc\n","Date":"Mon Dec 18 22:16:50 CET 2017"},{"Commit-ID":"commit 48c8fcf9ed04bd4be083d86e1b42736e9f7aa709 1513631857 -----sp","Author":"PersonIdent[Antonio Ojea, antonio.ojea.garcia@gmail.com, Mon Dec 18 13:17:37 2017 -0800]","Body":"Issue #328 - Add docker compose example file\n\nThis patch adds a docker-compose example file for helping new\nusers to use bookkeeper.\n\nIt runs by default an ensemble with 3 bookies and a client\napplication based in the following tutorial, but you can leverage docker\ncompose features to scale up the number of instances.\n\nhttps://bookkeeper.apache.org/archives/docs/master/bookkeeperTutorial.html\n\nRef: Issue #328\n\nSigned-off-by: Antonio Ojea <antonio.ojea.garciagmail.com>\n\nAuthor: Antonio Ojea <antonio.ojea.garcia@gmail.com>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #871 from aojea/docker, closes #328\n","Date":"Mon Dec 18 22:17:37 CET 2017"},{"Commit-ID":"commit 301ba6f90fafa77757990e5e0caf773530c06fe2 1513632382 -----sp","Author":"PersonIdent[Pasha Kuznetsov, pkuznetsov@salesforce.com, Mon Dec 18 13:26:22 2017 -0800]","Body":"ISSUE #863: BK client error messages need to be more descriptive\n\nThis improves logging of error codes as described in the issue #863. I only addressed the most glaring cases where bare `rc` was logged, by introducing a new logging utility which can be used as follows:\n```\nLOG.error(\"Closing ledger {} due to {}\", ledgerId, BKException.codeLogger(rc));\n```\nproducing messages similar to the following:\n\nWe can also discuss if the cases similar to the following should be brought in line with the above changes, which produces more information compared to the new approach, including stack trace, although not the original one:\n```\nif (rc != BKException.Code.OK) {\n    LOG.error(\"BK error opening ledger: \" + lId, BKException.create(rc)); // <------------------\n    finalLedgerIterCb.processResult(rc, null, null);\n    return;\n}\n```\n\nP.S. Please also note that we (Salesforce) are starting to add commit tags simplifying our merge process, e.g. `(bug W-3843968)` -- please let us know if that is significant enough to be discussed separately.\n\nAuthor: Pasha Kuznetsov <pkuznetsov@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #868 from pasha-kuznetsov/error-code-logger, closes #863\n","Date":"Mon Dec 18 22:26:22 CET 2017"},{"Commit-ID":"commit ff42188d069556626cf0673359c02ef9d7ec778b 1513633293 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Dec 18 13:41:33 2017 -0800]","Body":"Add a testing guide\n\nDescriptions of the changes in this PR:\n\nPutting up a page for `testing` related information. This is the first attempt to document all CI related information.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #874 from sijie/testing_guide_doc\n","Date":"Mon Dec 18 22:41:33 CET 2017"},{"Commit-ID":"commit 62de3cd677b9daa22ce51863562eecc28a144107 1513633459 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Mon Dec 18 13:44:19 2017 -0800]","Body":"ISSUE #849: LedgerIdFormatter and EntryFormatter Config options\n\nDescriptions of the changes in this PR:\n\n- LedgerIdFormatter, so it can be used for configuring format of LedgerId (Long/hex/UUID) in input/output of BKShell command\n- provide config options for both ledgeridformattet and entryformatter and java options for the same for BKShell commands\n- enhance ReadLedgerEntriesCmd command to have options rather than as arguments\n- fix checkstyle errors - \"Redundant 'final' modifier.\" and for invalid variable name format\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\nAuthor: Charan Reddy Guttapalem <reddycharan18@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #864 from reddycharan/ledgerformat, closes #849\n","Date":"Mon Dec 18 22:44:19 CET 2017"},{"Commit-ID":"commit 67d560f9dc2ad71e12ebffde74def7ac1738f6f9 1513666980 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Dec 19 15:03:00 2017 +0800]","Body":"ISSUE #884: Upgrade powermock and mockito to support java 9\n\nDescriptions of the changes in this PR:\n\npowermock supports java9 at the new version (see powermock/powermock#783). this pull request upgrades the powermock and mockito versions, so we are able to run tests on java 9.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #885 from sijie/use_powermock2, closes #884\n","Date":"Tue Dec 19 08:03:00 CET 2017"},{"Commit-ID":"commit 4a4896c9b66741000c923b587ee1eafafca40273 1513671840 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Dec 19 00:24:00 2017 -0800]","Body":"ISSUE #879: TestTLS fails when project path contains spaces\n\nDescriptions of the changes in this PR:\n\nUse `URI` rather than `URL`, so it won't use url-encoded path as the file path.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Yiming Zang <yzang2016@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #880 from sijie/relative_path, closes #879\n","Date":"Tue Dec 19 09:24:00 CET 2017"},{"Commit-ID":"commit e90692274d6ab9b7d80ff5e5dfe94a741e6cf042 1513671939 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Tue Dec 19 00:25:39 2017 -0800]","Body":"ISSUE #878: add .checkstyle file to apache-rat-plugin exclusion list\n\nDescriptions of the changes in this PR:\n\n- eclipse/checkstyle plugin autogenerates .checkstyle file in all the\nprojects/modules. So it has to be added to the exclusion list,\notherwise apache-rat:check (mvn clean apache-rat:check install\nspotbugs:check) would fail because of these files with unknown\nApache License header.\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #882 from reddycharan/excludecheckstyle, closes #878\n","Date":"Tue Dec 19 09:25:39 CET 2017"},{"Commit-ID":"commit cc84042a4d494fde42d215ead28093033da6861a 1513709081 -----sp","Author":"PersonIdent[Philip Su, psu@twitter.com, Tue Dec 19 10:44:41 2017 -0800]","Body":"ISSUE #709: Add Slow Bookkeeper Servers to Placement Policy for read ordering\n\nDescriptions of the changes in this PR:\n\nMaintain a list of slow bookkeeper hosts, which are tried only after readonly bookkeeper hosts are tried. Bookkeeper hosts can be categorized as \"slow\" when a speculative timeout occurs on that bookkeeper host.\n\nMaster Issue:: 709\n\nAuthor: Philip Su <psu@twitter.com>\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: philipsu522 <philip.su.522@gmail.com>\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Yiming Zang <yzang2016@gmail.com>, Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #883 from philipsu522/psu/ISSUE-709-2, closes #709\n","Date":"Tue Dec 19 19:44:41 CET 2017"},{"Commit-ID":"commit 39bdfbcf2e285fc863dfcf927a8d2201c8b1fa01 1513716926 -----sp","Author":"PersonIdent[Siddharth Boobna, siddharth.boobna@gmail.com, Tue Dec 19 12:55:26 2017 -0800]","Body":"make replaceBookie() exclude ensemble bookie racks\n\nDescriptions of the changes in this PR:\n\nThis is a change ported back from yahoo/bookkeeper0589d0d58d61364be1a897a5c1478d3109f4fc17. It excludes the ensemble bookie racks when replacing bookies. since there is already a new weight-based placement strategy introduced, so this change only applies when `weight-based` placement policy is not enabled.\n\nThis is a change contributed from Siddharth Boobna.\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Siddharth Boobna <sboobna@yahoo-inc.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #887 from sijie/use_bookie_address\n","Date":"Tue Dec 19 21:55:26 CET 2017"},{"Commit-ID":"commit cfd0428d3f5661505132a31ffcc7a68dda2115a2 1513737579 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Tue Dec 19 18:39:39 2017 -0800]","Body":"Misc LedgerHandle changes\n\nAdds logging for new ensembles, a getCtime call, and a check for ReadOnlyLedgerHandle in initializeExplicitLacInterval.\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #892 from athanatos/forupstream/misc-ledgerhandle-changes\n","Date":"Wed Dec 20 03:39:39 CET 2017"},{"Commit-ID":"commit 9ab30454343118e6c80ca3f3eb13d01e511c89fc 1513737637 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Dec 19 18:40:37 2017 -0800]","Body":"Add command line tool to manually recover ledgers\n\nDescriptions of the changes in this PR:\n\nThis is a change ported from yahoo/bookkeeperf4957610.\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #886 from sijie/manually_recover_ledgers\n","Date":"Wed Dec 20 03:40:37 CET 2017"},{"Commit-ID":"commit 155c3c95f3fcc823432e23a93a8cd3f51ebff917 1513737773 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Tue Dec 19 18:42:53 2017 -0800]","Body":"ISSUE #865: LongHierarchicalLedgerManager: refactor to fix races\n\nLongHierarchicalLedgerRangeIterator.initialize() could erroneously exit\nwith iteratorDone if the lexicographically first path in zk had fewer\nthan 4 levels.  This can happen for a few reasons including a case where\na client creating a ledger on that path crashed during the zk updates or\nthe iterator.hasNext() call simply raced with an in-progress node\ncreation or removal.  ScanAndCompareGarbageCollector is hasNext()\nreturns false will delete all ledgers on the bookie, so this is a fairly\nserious bug.\n\nRuling out other such bugs was fairly dificult with the structure of the\ncode as written, so instead use a simpler recursive iterator design with\nsimpler pre/post conditions.\n\nAlso, surface KeeperException.NoNodeException from\nZkUtils.getChildrenInSingleNode so that we can actually handle it in\nLHLM.\n\nMaster Issue: #865\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #875 from athanatos/forupstream/issue-865, closes #865\n","Date":"Wed Dec 20 03:42:53 CET 2017"},{"Commit-ID":"commit 9e4bd8e3de91cafaf87386a29d09f3d62909a5d4 1513822228 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Dec 20 18:10:28 2017 -0800]","Body":"BookKeeperBuilderTest has recovery backwards\n\nNoRecovery test was specifying withRecovery(true).\nRecovery test was specifying withRecovery(false).\n\nThis patch swaps them to how they should be.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #899 from ivankelly/recovery-test-fix\n","Date":"Thu Dec 21 03:10:28 CET 2017"},{"Commit-ID":"commit b94773ae733e7aca0ff3b6807929ded026dfbe07 1513881827 -----sp","Author":"PersonIdent[rdhabalia, rdhabalia@apache.org, Thu Dec 21 10:43:47 2017 -0800]","Body":"Fix: fail create-ledger callback on ledgerId generation failure\n\n### Motivation\n\nRecently, we have seen that when bk-client tries to create-ledger and if bk-client lost the zk-connection then bk-client doesn't complete the createLedger-callback. We can see following exception when bk-client fails to generate ledgerId from zookeeper.\n```\n05:43:35.364 [main-EventThread] ERROR o.a.b.meta.ZkLedgerIdGenerator       - Could not generate new ledger id\norg.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgers/idgen-long/HOB-0000000001/ID-\n        at org.apache.zookeeper.KeeperException.create(KeeperException.java:99) ~[zookeeper-3.4.6.jar:3.4.6-1569965]\n        at org.apache.zookeeper.KeeperException.create(KeeperException.java:51) ~[zookeeper-3.4.6.jar:3.4.6-1569965]\n        at org.apache.bookkeeper.meta.ZkLedgerIdGenerator$1.processResult(ZkLedgerIdGenerator.java:78) ~[bookkeeper-server-4.3.1.56-yahoo.jar:4.3.1.56-yahoo]\n        at org.apache.bookkeeper.util.ZkUtils$1.processResult(ZkUtils.java:79) [bookkeeper-server-4.3.1.56-yahoo.jar:4.3.1.56-yahoo]\n        at org.apache.bookkeeper.zookeeper.ZooKeeperClient$9$1.processResult(ZooKeeperClient.java:527) [bookkeeper-server-4.3.1.56-yahoo.jar:4.3.1.56-yahoo]\n        at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:605) [zookeeper-3.4.6.jar:3.4.6-1569965]\n        at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:498) [zookeeper-3.4.6.jar:3.4.6-1569965]\n```\n\n### Modifications\n\n- Bk-client handles and completes ledger-request callback on ledgerId-generation failure.\n\nAuthor: rdhabalia <rdhabalia@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>, Matteo Merli <mmerli@apache.org>\n\nThis closes #900 from rdhabalia/create_ledger_ap\n","Date":"Thu Dec 21 19:43:47 CET 2017"},{"Commit-ID":"commit 5ea3110e35e0694fc8ed2218698888041eaf23e8 1513921491 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Thu Dec 21 21:44:51 2017 -0800]","Body":"BookieProtoEncoding: log messages at TRACE rather than DEBUG\n\nLogging them at debug tends to make logging at DEBUG level pretty\nintractable, log them at TRACE instead.\n\n(bug W-4166441)\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #909 from athanatos/forupstream/small-fixes-1/trace\n","Date":"Fri Dec 22 06:44:51 CET 2017"},{"Commit-ID":"commit 037ce71e08bb7ca6a3d50c9b2d5ace39f37eaf18 1513921541 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Thu Dec 21 21:45:41 2017 -0800]","Body":"EntryLogTest,LedgerCacheTest: use correct tmp dir\n\nThese tests weren't overriding the journal dir and so weren't using\nan IOUtils tmp dir for the journal.\n\n(bug W-4267131)\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #910 from athanatos/forupstream/small-fixes-1/tmpdir\n","Date":"Fri Dec 22 06:45:41 CET 2017"},{"Commit-ID":"commit 0b3190e5cb6285b1ad30cfcdc074fde223772d38 1513921593 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Thu Dec 21 21:46:33 2017 -0800]","Body":"DefaultSpeculativeRequestExecutionPolicy: fix logger instantiation\n\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #911 from athanatos/forupstream/small-fixes-1/logger\n","Date":"Fri Dec 22 06:46:33 CET 2017"},{"Commit-ID":"commit c8b8267abf6b0aefdc5f3eaae665330f3998b2cc 1513921982 -----sp","Author":"PersonIdent[Dustin, dcastor@salesforce.com, Thu Dec 21 21:53:02 2017 -0800]","Body":"Journal: Fix journal write queue so it decrements properly.\n\n(bug W-3169683)\nSigned-off-by: Dustin <dcastorsalesforce.com>\n\nAuthor: Dustin <dcastor@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #912 from athanatos/forupstream/small-fixes-1/journal\n","Date":"Fri Dec 22 06:53:02 CET 2017"},{"Commit-ID":"commit 95ee60872ae6a47996dc3215ef911ce375458a72 1513922065 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Thu Dec 21 21:54:25 2017 -0800]","Body":"AbstractZkLedgerManager: wrap Log.debug in an isDebugEnabled check\n\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #908 from athanatos/forupstream/small-fixes-1/zklm-debug\n","Date":"Fri Dec 22 06:54:25 CET 2017"},{"Commit-ID":"commit de9fe40fd5b2189d89f1f51c62201aff08718064 1514205803 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Mon Dec 25 20:43:23 2017 +0800]","Body":"ISSUE #904: short hostname for bookieid\n\nDescriptions of the changes in this PR:\n\n- provide useShortHostName config to use short hostName for bookieId\n- corresponding testcases\n- For BKShell commands print appropriate string representation (hostname and ipaddress)\nand port number of bookies\n\nMaster Issue: #904\n\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #905 from reddycharan/shorthostname, closes #904\n","Date":"Mon Dec 25 13:43:23 CET 2017"},{"Commit-ID":"commit 54baa27426a9cb5e697f6b32333070e7f5ef02fb 1514207297 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Mon Dec 25 21:08:17 2017 +0800]","Body":"ISSUE #893: more options for UpdateCookieCmd\n\nDescriptions of the changes in this PR:\n\n- add ListCookie Options to UpdateCookie command\n- add DeleteCookie Option to UpdateCookie command\n- move expandstorage command to UpdateCookie command as option,\nsince expandstorage is just a cookie update operation\n- in listfilesondisc command use canonical path (full path)\n\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #894 from reddycharan/updatecookiecmd, closes #893\n","Date":"Mon Dec 25 14:08:17 CET 2017"},{"Commit-ID":"commit 4274f945da1c8bb556f51e623273a1584040b7b8 1514207773 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Mon Dec 25 21:16:13 2017 +0800]","Body":"ISSUE #895: print entrylog metadata\n\nDescriptions of the changes in this PR:\n\n- bookieshell command to print entrylog metadata\n\nMaster Issue: #895\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #896 from reddycharan/printentrylogmetadata, closes #895\n","Date":"Mon Dec 25 14:16:13 CET 2017"},{"Commit-ID":"commit 5648ba9da09b21bd0d13bc01b6665efb04a9b035 1514250283 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Tue Dec 26 09:04:43 2017 +0800]","Body":"ISSUE #697: bump version to 4.6.0 in Dockerfile\n\nDescriptions of the changes in this PR:\n\nSince 4.6.0 released, bump version to 4.6.0 in Dockerfile to use the latest release\n\nMaster Issue: #697\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #918 from jiazhai/issue-697, closes #697\n","Date":"Tue Dec 26 02:04:43 CET 2017"},{"Commit-ID":"commit 80d9abb9deaec66932cd8a7f18923ba0076b7ad8 1514335802 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Tue Dec 26 16:50:02 2017 -0800]","Body":"Fix user email typo in release_guide\n\nDescriptions of the changes in this PR:\n\nFix user email typo in release_guide\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #919 from jiazhai/fix_typo_in_releaseguide\n","Date":"Wed Dec 27 01:50:02 CET 2017"},{"Commit-ID":"commit 65f03e2fc17f56bcc61fa7799559dd0438690658 1514341543 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Wed Dec 27 10:25:43 2017 +0800]","Body":"Add a section for 4.6.0 in releases.md\n\nDescriptions of the changes in this PR:\n- add a section for 4.6.0 in releases.md,\n- add a check item for this in release_guide.md\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #920 from jiazhai/update_release_page\n","Date":"Wed Dec 27 03:25:43 CET 2017"},{"Commit-ID":"commit 1f8b26d5f02ae6bccf0d586bcb145f4461f4fde6 1514357280 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Tue Dec 26 22:48:00 2017 -0800]","Body":"ISSUE #870: ScanAndCompareGarbageCollector: harden against LM bugs\n\nThe idea behind this patch is to make it more likely that more than one\nLedgerManager bug would be required to erroneously believe a ledger to be\ndeleted.\n1) Remove the special handling for the completely empty LM.  It's not\nreally a common case nor is it much of an optimization even when it\nhappens.\n2) Add a config variable to cause the bookie to also check the\nLedgerManager.readLedgerMetadata path before actually removing a ledger.\nThe implementations of readLedgerMetadata and the iterator are\nsufficiently different that it seems worth it to have the option of\nchecking both to guard somewhat against a bug in either.\n\n(bug W-4292747)\n(bug W-3027938)\nSigned-off-by: Samuel Just <sjustsalesforce.com>\nSigned-off-by: Charan Reddy Guttapalem <cguttapalemsalesforce.com>\n\nMaster Issue: #870\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Arvin <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #876 from athanatos/forupstream/issue-870, closes #870\n","Date":"Wed Dec 27 07:48:00 CET 2017"},{"Commit-ID":"commit 1ed78912907cd2157f0b93ecaa653923ede4365c 1514602355 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Dec 30 10:52:35 2017 +0800]","Body":"ISSUE #922: changes to shading bookkeeper-server jar\n\nDescriptions of the changes in this PR:\n\n**Problem:**\n\n`shadedArtifactAttached` was introduced in 4.6.0 to generate plain and shaded artifact for `bookkeeper-server`. Because for projects (e.g. distributedlog) that would use same protobuf and guava version as bookkeeper, they will use the plain artifact (to avoid shading protobuf/guava multiple times). However there are a few problems with that:\n\n1) bookkeeper-common is not included in the shading include set.\n2) `shadedArtifactAttached` only generate a shaded artifact (with relocated classes), but doesn't generate a dependency-reduced pom file. so you have to manually exclude relocated dependencies.\n\n**Solutions:**\n\n- for shaded artifact of `bookkeeper-server`, include all the bookkeeper submodules that bookkeeper-server depends on. so the shaded artifact includes all the classes that need to be relocated.\n- introduce a `shaded` module for keeping new shaded libraries. Currently `bookkeeper-server-shaded` is a shaded module of `bookkeeper-server`, while `bookkeeper-server-tests-shaded` is a shaded moulde of the tests jar of `bookkeeper-server`.\n- update the client api documentation about the instructions on how to use shaded artifact of `bookkeeper-server` and the new shaded module `bookkeeper-server-shaded`.\n- add test cases to verify the shaded artifact and the new shaded modules generate the right artifacts.\n\n**This change doesn't address:**\n\nCurrently both client and server are bundled in one `bookkeeper-server`. this change will not introduce any shaded client-only jar. that would be deferred until we split `bookkeeper-server` module.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #928 from sijie/fix_shading, closes #922\n","Date":"Sat Dec 30 03:52:35 CET 2017"},{"Commit-ID":"commit 2fbb2916a323edfc097de0de9b2d81e59b37bf6f 1514881591 -----sp","Author":"PersonIdent[Andrey Yegorov, ayegorov@salesforce.com, Tue Jan 2 09:26:31 2018 +0100]","Body":"ISSUE #590 (@bug W-4556980@) Reduce excessive CPU usage on client side: add crc32c\n\n\u20262c with SSE processor instruction support, benchmark to make sure it is better than crc32\n\nDescriptions of the changes in this PR:\n\nCRC32C for bookkeeper\n\nMaster Issue: #590\n\nAuthor: Andrey Yegorov <ayegorov@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>, Matteo Merli <mmerli@apache.org>\n\nThis closes #856 from dlg99/feature/crc32c, closes #590\n","Date":"Tue Jan 02 09:26:31 CET 2018"},{"Commit-ID":"commit 7f62baec18ba8aa0d2d01134b7c5adfc25c49d42 1515143444 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Fri Jan 5 01:10:44 2018 -0800]","Body":"BookieRequestProcessor: shutdown the longPollThreadPool as well\n\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #938 from athanatos/forupstream/requestprocessorfixes/1\n","Date":"Fri Jan 05 10:10:44 CET 2018"},{"Commit-ID":"commit 477ff2b594afd4017f6fb9e8f294c9b2a75b0d6a 1515143597 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Fri Jan 5 01:13:17 2018 -0800]","Body":"ISSUE #931,#907: Add option to track task execution time\n\nFixes a bug in OrderedScheduler introduced in\ne33ec10aa400f32c2e0278c15ea80a0f624e5919 which failed to track execution\ntime with some calls and adds an option to enable it in the bookie.  Also\nfixes a bug with task_queued duration.\n\nAdd a simple mock for remembering stats long enough to verify that\ncounters are actually used and sensible in unit tests and bake it into\nBookKeeperClusterTestCase so that we can write tests to ensure that the\nstats are actually counted and make sense.  Use said mock to add simple\ntests for top level read and write stats validating this fix.\n\n(bug W-4276826)\n(bug W-4268290)\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #932 from athanatos/forupstream/issue-931, closes #931, closes #907\n","Date":"Fri Jan 05 10:13:17 CET 2018"},{"Commit-ID":"commit dc30763f21a3b06d6cb429998c3d3cb2a7aac8f2 1515180204 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Fri Jan 5 11:23:24 2018 -0800]","Body":"BookieNettyServer: add contextHandler to the local transport pipeline\n\nLeft off of 8e0bd2c3d81b522e97434d8646915f36422a104b.  In fact,\nauthentication is already enabled on LocalTransport.  This extra line is\nneeded for the machinery which allows auth plugins to access ssl state.\nCurrently, the only plugin which uses that machinery is in TestTLS.\nAdds test cases to validate that functionality with Local Transport\nenabled.\n\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #941 from athanatos/forupstream/requestprocessorfixes/4\n","Date":"Fri Jan 05 20:23:24 CET 2018"},{"Commit-ID":"commit 904857b9a67c7ae4afae38bfeeb3e1eda3daba5a 1515180473 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Fri Jan 5 11:27:53 2018 -0800]","Body":"ISSUE #877: add verifier.BookkeeperVerifier\n\nPlays and verifies a non-determinstic read/write stream against a\nbookkeeper cluster.\n\nMaster Issue: #877\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #890 from athanatos/forupstream/issue-877, closes #877\n","Date":"Fri Jan 05 20:27:53 CET 2018"},{"Commit-ID":"commit d320936c00c3eeae0a4e2795f0a9bfa780fd6f98 1515194535 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Fri Jan 5 15:22:15 2018 -0800]","Body":"ISSUE #950: EntryLogger.extractEntryLogMetadataByScanning: fix check\n\n0 is a valid ledger id. Seems to be causing\ntest2RWsShouldCompeteForReplicationOf2FragmentsAndCompleteReplication to\nfail in cases where the gc runs before the recovery reads happen. The gc\nwinds up believing the entry log to be empty and deletes it erroneously.\n\nIntroduced in 143bd1952851ac70ace9d16c3708ae30dad2a0aa.\n\n(bug W-4596080)\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #951 from athanatos/forupstream/issue-950, closes #950\n","Date":"Sat Jan 06 00:22:15 CET 2018"},{"Commit-ID":"commit 1a8b35d38737f6d043995a756da10ea111268b4a 1515303286 -----sp","Author":"PersonIdent[Pasha Kuznetsov, pkuznetsov@salesforce.com, Sat Jan 6 21:34:46 2018 -0800]","Body":"ISSUE #954: dir_*_usage stats are always 0\n\ndue to mismatch between the way they are initialized in `LedgerDirsManager` and\nthe way the `diskUsages` is populated subsequently in `LedgerDirsMonitor`\n\nDecisions potentially worth some attention:\n- stat names are kept `dir_{dir}_usage` while the actual dirs being checked have been changed to `{dir}/current`;\n- the stats aren't being updated if the bookie is in a readonly mode -- uncovered while testing, not sure if it's worth addressing at all, kept the fix minimalistic for now.\n\n(bug W-4594204)\n\nAuthor: Pasha Kuznetsov <pkuznetsov@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #957 from pasha-kuznetsov/dir-usage-stats, closes #954\n","Date":"Sun Jan 07 06:34:46 CET 2018"},{"Commit-ID":"commit f7cdb5775651e9deb268e5cf9dd57e77291be035 1515303428 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Jan 6 21:37:08 2018 -0800]","Body":"ISSUE #952: Split the multiple-jdk-versions ci jobs into two\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nWhen using a matrix job to define a CI job running on both java 9 and java 8, the workspace file path will be added with \"jdk name\" (e.g. \"JDK 1.8 latest\" and \"JDK 9 latest\"). This will cause file paths contain spaces, and fail the builds.\n\nfor example, #879 #880 is one of the examples. #937 can't pass ci because g++ fails when the file path contains spaces.\n\n*Solution*\n\nSplitting the matrix job into two separate jobs suffixed with \"java8\" and \"java9\", so it won't contains any space in workspace.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #953 from sijie/separate_jdk_cis, closes #952\n","Date":"Sun Jan 07 06:37:08 CET 2018"},{"Commit-ID":"commit a0b05c519b34dd1f4bcd1f440378aeb601c92c90 1515303953 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Jan 6 21:45:53 2018 -0800]","Body":"ISSUE #915: Part 1 - Copy pulsar-checksum module as circe-checksum\n\nDescriptions of the changes in this PR:\n\n- this change copies the files under `com.scurrilous.circe` in pulsar-checksum module into bookkeeper as `circe-checksum`.\n- this change doesn't copy files under `org.apache.pulsar` except NativeUtils. will have a subsequent change to add it.\n- Move NativeUtils to `com.scurrilous.circe.utils`.\n- Update notice files to respect to Trevor Robinson's change\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nThis closes #916 from sijie/copy_pulsar_checksum, closes #915\n","Date":"Sun Jan 07 06:45:53 CET 2018"},{"Commit-ID":"commit 312784812aa1349bf2864a5da07f6ace7ff687ba 1515304710 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Sat Jan 6 21:58:30 2018 -0800]","Body":"Issue 915: Part 2 - Add crc32c integer/long checksum utils under `com.scurrilous.circe.checksum` (#917)\n\nThis is the part 2 change of #915. It is based on #916, adding crc32c int/long checksum util classes under com.scurrilous.circe.checksum. It also fixes a incremental checksum issue on long crc32c. I added bunch of test cases to ensure the both long/int crc32 checksum is correct on incremental cases.\r\n","Date":"Sun Jan 07 06:58:30 CET 2018"},{"Commit-ID":"commit 1e2c24b82648aa27974d1a0b91fe80d97c30fef0 1515305729 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Jan 6 22:15:29 2018 -0800]","Body":"ISSUE #935 ISSUE #915: Part 3 - Make circe-checksum module work for both java 8 and java 9\n\nDescriptions of the changes in this PR:\n\n    - switch from jmockit to mockito, and from testng to junit. make testing and mocking framework consistent across modules.\n    - skip `-Werror` check in circe-checksum since `finalize` is deprecated at java 9\n    - change CRC32CDigestManager to use `circe-checksum` module\n    - fix shading to include `circe-checksum`\n\nThis change is based #917 . Gitsha 73049f8 contains the changes to make circe-checksum module work for both java8 and java9.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #937 from sijie/fix_pulsar_checksum, closes #935, closes #915\n","Date":"Sun Jan 07 07:15:29 CET 2018"},{"Commit-ID":"commit 7fe87f9354a04bb6789f8111242d35a1b730d3ba 1515306112 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Jan 6 22:21:52 2018 -0800]","Body":"Introduce MockClock and MockExecutorController to improve timer-based testing\n\nDescriptions of the changes in this PR:\n\n- introduce MockClock and MockExecutorController to control time advancing to trigger execution on tasks\n- convert LedgerDirsMonitor from using Thread to use ScheduledExecutorService (moved the logic in `run` method to `check` without code changes)\n- change TestLedgerDirsManager to use MockClock and MockExecutorController to remove the usage of `Thread.sleep`\n\nMaster Issue:  #943\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #944 from sijie/mock_scheduler\n","Date":"Sun Jan 07 07:21:52 CET 2018"},{"Commit-ID":"commit 578de75b097c53d1be9a658a05faa829f354f103 1515384568 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Jan 7 20:09:28 2018 -0800]","Body":"Move the module from `distributedlog-io/statestore` to root module\n","Date":"Mon Jan 08 05:09:28 CET 2018"},{"Commit-ID":"commit 37e2f2033c6bc8c354eeeedcb584dfc7ea62fcec 1515403414 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jan 8 01:23:34 2018 -0800]","Body":"Fix compilation issue after moved statestore out of distributedlog repo\n","Date":"Mon Jan 08 10:23:34 CET 2018"},{"Commit-ID":"commit cf4e8e07b6ca58440bf5758567d4b238cf271b90 1515403454 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jan 8 01:24:14 2018 -0800]","Body":"Incremental checkpoint on rocksdb\n\n- introduce checkpoint manager\n- implement rocksdb checkpoint and restore tasks\n- provide a filesystem based checkpoint manager\n","Date":"Mon Jan 08 10:24:14 CET 2018"},{"Commit-ID":"commit f9bba3c516b7fb2fceba0c5302bd0e23f52475ad 1515404862 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jan 8 01:47:42 2018 -0800]","Body":"Split the statestore module into api and impl\n","Date":"Mon Jan 08 10:47:42 CET 2018"},{"Commit-ID":"commit e29964296e4cbc9981e0b9d9a5af465fe13b28f0 1515407516 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jan 8 02:31:56 2018 -0800]","Body":"Move api classes to api module\n","Date":"Mon Jan 08 11:31:56 CET 2018"},{"Commit-ID":"commit a9b94efcf6035dd215112aa4a38a41825a7c0506 1515408200 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jan 8 02:43:20 2018 -0800]","Body":"Add LICENSE file\n","Date":"Mon Jan 08 11:43:20 CET 2018"},{"Commit-ID":"commit 40ef78045234c22a4f949ec11338e41ac139b33d 1515411212 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jan 8 03:33:32 2018 -0800]","Body":"Enable travis ci\n","Date":"Mon Jan 08 12:33:32 CET 2018"},{"Commit-ID":"commit 04afde6f26fa1d2a17347f046eac9bbbe8b29b94 1515411290 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jan 8 03:34:50 2018 -0800]","Body":"Remove duplicated matrix section\n","Date":"Mon Jan 08 12:34:50 CET 2018"},{"Commit-ID":"commit c4a73d985505f3a74387a031cd28da3216f3f6f5 1515411587 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jan 8 03:39:47 2018 -0800]","Body":"Enable apache-rat:check\n","Date":"Mon Jan 08 12:39:47 CET 2018"},{"Commit-ID":"commit 6be3e961d406259cb7ac51fc58ae9536478c7e57 1515411858 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jan 8 03:44:18 2018 -0800]","Body":"Exclude travis log for apache-rat:check\n","Date":"Mon Jan 08 12:44:18 CET 2018"},{"Commit-ID":"commit 131685252b714daed9daa80ecbaf148f208c9bc5 1515446319 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Jan 8 13:18:39 2018 -0800]","Body":"Refactor FileInfo locking and refcounting out IndexPersistenceMgr\n\nThere is a number of bugs in index persistence mgr related to how\nrefcounts are handled and how FileInfos are freed, due to the locking\nmechanism. These can result in the fencing bit being lost in ledgers,\nwhich is a serious issue. They also cause flakes in\nIndexPersistenceMgrTest#testEvictFileInfoWhenUnderlyingFileExists.\n\nFor details see the discussion at:\nhttps://github.com/apache/bookkeeper/pull/513/files/8075b0#r156676238\n\nThere are two key problems.\n\n1. FileInfos are flushed asynchronously on eviction. If another thread\ntries to read the FileInfo after the flush has been scheduled, but\nbefore it runs, it will read stale date (and we'll possibly lose the\nfence bit).\n2. FileInfos can be closed while it is still references in the\nIndexPersistenceMgr. This means that it can be fenced, but this will\nvery be flushed to disk because the FileInfo is already closed.\n\nThe patch solves this by moving FileInfo locking and refcount into a\nseparate class, FileInfoBackingCache. When either the write cache or\nread cache load a file info, it tries to load it from this backing\ncache. All writes to the the backing cache are done under a write\nlock. This class also takes care of reference counting. It hands out\nCachedFileInfo objects, which will be flushed to disk when all\nreferences are released.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Yiming Zang <yzang2016@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #913 from ivankelly/index-persist-lock\n","Date":"Mon Jan 08 22:18:39 CET 2018"},{"Commit-ID":"commit 6a5f6367a77094406ff0c938cf6b7f6d804451e1 1515455800 -----sp","Author":"PersonIdent[Arvin, arvindevel@gmail.com, Mon Jan 8 15:56:40 2018 -0800]","Body":"ISSUE280: Add StateManager to manage Bookie's state, and use it to turn bookie into readonly when sortedLedgerStorage failed to flush data\n\nDescriptions of the changes in this PR:\n\nAdd SortedLedgerStorageListener to implement, and add a test case to verify it.\n\nMaster Issue: #280\n\nAuthor: Arvin <arvindevel@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>, Ivan Kelly <ivank@apache.org>\n\nThis closes #873 from ArvinDevel/issue280\n","Date":"Tue Jan 09 00:56:40 CET 2018"},{"Commit-ID":"commit d6de867f594ee5f7aef25ed8d6591029befe8c19 1515456582 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Mon Jan 8 16:09:42 2018 -0800]","Body":"ISSUE #947: ZK configs for LocalBookkeeper\n\nDescriptions of the changes in this PR:\n\nMaster Issue: #947\n\n- make ZK's data directory configurable for local bookie\n- Localbookie to use ledgersrootpath from conf file\n\ne032218a910113b0e4de561a76da8bdf61ba3db7\n(bug W-2887104) make ZK's data directory configurable for local bookie\n\nAuthor: Andrey Yegorov <ayegorovsalesforce.com>\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #948 from reddycharan/localbookkeeperzkfixes, closes #947\n","Date":"Tue Jan 09 01:09:42 CET 2018"},{"Commit-ID":"commit f39c423c8d2c493343e1172a81484c50c1b71168 1515456645 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Mon Jan 8 16:10:45 2018 -0800]","Body":"BookieProtoEncoding: use retainedSlice() to reduce garbage\n\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Matteo Merli <mmerli@apache.org>\n\nThis closes #940 from athanatos/forupstream/requestprocessorfixes/3\n","Date":"Tue Jan 09 01:10:45 CET 2018"},{"Commit-ID":"commit 52f511e1a5cbd136e48528e5ed66630250593198 1515491915 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Tue Jan 9 10:58:35 2018 +0100]","Body":"Add descriptive message for TooManyRequestsException\n\nAfter upgrading from 4.5 to 4.6 I found a lot of \"Unexpected condition\" in some benchmarks.\n\nTooManyRequestsException is a new error introduced in 4.6, there is not description, so the default description is \"Unexpected condition\", without a debugger it is not possible to understand the cause of the error.\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\nAuthor: eolivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #921 from eolivelli/toomanyrequests-message\n","Date":"Tue Jan 09 10:58:35 CET 2018"},{"Commit-ID":"commit 998a55fe2b549c93907c5774333be7f4431de3e5 1515502011 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Tue Jan 9 20:46:51 2018 +0800]","Body":"ISSUE #897: un-bind zookeeper from bookkeeper admin\n\nDescriptions of the changes in this PR:\n- remove zookeeper from LedgerLayout to make LedgerLayout as a pure layout object,\n- add LayoutManager, move zookeeper related utils into ZKLayoutManager for storing/reading/delete layout from zookeeper,\n- unbind zookeeper from LedgerManagerFactory, use LayoutManager instead,\n- unbind zookeeper from bookkeeperadmin.format,\n- fix compile and test errors.\n\nMaster Issue: #897\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #936 from zhaijack/issue_897, closes #897\n","Date":"Tue Jan 09 13:46:51 CET 2018"},{"Commit-ID":"commit 0d42faead06db0d9ea1a1d19f806f9f97c4dd54a 1515502180 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Jan 9 20:49:40 2018 +0800]","Body":"Docker image for testing\n\nContains all released versioned and the current version (from the\ncurrent source tree). The image only gets built if the docker maven\nprofile is enabled:\n\n```\nmvn package -Pdocker\n```\n\nSupervisord is used to start and stop bookkeeper. Each version has its\nown supervisord config. The same journal and ledger directories are\nused for all versions. Logs are written to per version log files in\n/var/log/bookkeeper.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #959 from ivankelly/all-version-docker\n","Date":"Tue Jan 09 13:49:40 CET 2018"},{"Commit-ID":"commit 3a6699df9b553db569c6882b0de7d467dd504ea3 1515546200 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Wed Jan 10 09:03:20 2018 +0800]","Body":"Prepare website for 4.6.1 release\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #962 from eolivelli/new461website\n","Date":"Wed Jan 10 02:03:20 CET 2018"},{"Commit-ID":"commit af41b92b0f0c00be56e6f729f8ed7f9baddbcc6c 1515608721 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Jan 10 10:25:21 2018 -0800]","Body":"Tag all-versions-image with latest\n\nSo that scripts using it don't have to bump version each time.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #964 from ivankelly/latest-tag\n","Date":"Wed Jan 10 19:25:21 CET 2018"},{"Commit-ID":"commit 4bad1f0706609257bdcb2344feda796efaa89c15 1515608785 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jan 10 10:26:25 2018 -0800]","Body":"Add the testing page to navbar\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #963 from sijie/add_missing_guide\n","Date":"Wed Jan 10 19:26:25 CET 2018"},{"Commit-ID":"commit 45d49cac9403388a0690240c279aec5fb145fa46 1515615625 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jan 10 12:20:25 2018 -0800]","Body":"Move the simple kv statestore api/impl to `kv` package\n","Date":"Wed Jan 10 21:20:25 CET 2018"},{"Commit-ID":"commit 7d4345f684a630718f5c18336844e155a296c2fd 1515623512 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jan 10 14:31:52 2018 -0800]","Body":"- Move the journaling logic to an abstract implementation of AsyncStateStore\n- Provide async interfaces on simple kv store\n","Date":"Wed Jan 10 23:31:52 CET 2018"},{"Commit-ID":"commit be560d6bb982eb30b29c5224f55a6d57ccca5b9c 1515638962 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jan 10 18:49:22 2018 -0800]","Body":"implement the rocksdb based async kv store\n","Date":"Thu Jan 11 03:49:22 CET 2018"},{"Commit-ID":"commit 78f862362ef35d07f2889de81e1c64c1f1cc9b2a 1515683353 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Thu Jan 11 07:09:13 2018 -0800]","Body":"ISSUE #945: Enabling BookieShell for LocalBookKeeper\n\nDescriptions of the changes in this PR:\n\nWe should be able to execute BookieShell commands against bookies of LocalBookkeeper\n\neg. for Zookeeper/Metadata Operation\n./bookkeeper shell -localbookie listbookies -rw\n\neg. for Bookie operation\n./bookkeeper shell -localbookie 10.3.27.190:5000 lastmark\n./bookkeeper shell -localbookie 10.3.27.190:5000 listfilesondisc\n\nMaster Issue: #945\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #946 from reddycharan/localbookkeeper, closes #945\n","Date":"Thu Jan 11 16:09:13 CET 2018"},{"Commit-ID":"commit aaada2ee9fd6974a4bd79b55f4743d40dbecd4c1 1515693520 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Thu Jan 11 09:58:40 2018 -0800]","Body":"Rename `CheckpointManager` to `CheckpointStore` (#1)\n\n","Date":"Thu Jan 11 18:58:40 CET 2018"},{"Commit-ID":"commit 4ff90362b6591fda48fca69fbe9e29bc2bfc5ff5 1515699493 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jan 11 11:38:13 2018 -0800]","Body":"Use default column family for storing data and introduce a `.meta` column family\n","Date":"Thu Jan 11 20:38:13 CET 2018"},{"Commit-ID":"commit 362e912dfbbe0277e4d6676c7db36bd338233674 1515700992 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jan 11 12:03:12 2018 -0800]","Body":"Redirect tests output from console to files\n","Date":"Thu Jan 11 21:03:12 CET 2018"},{"Commit-ID":"commit be193caab408c7df1cda0944a22e2c29d148a976 1515727937 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jan 11 19:32:17 2018 -0800]","Body":"Add test cases for rocksdb incremental checkpointing\n","Date":"Fri Jan 12 04:32:17 CET 2018"},{"Commit-ID":"commit 793cc3a67ff978b923c09aa58dd87992bb8e31b6 1515741715 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jan 11 23:21:55 2018 -0800]","Body":"Enable checkpointing in AsyncStateStoreWithJournal\n","Date":"Fri Jan 12 08:21:55 CET 2018"},{"Commit-ID":"commit ade42464ad0f65419b1f47dd111514ce11e092ee 1515742197 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Thu Jan 11 23:29:57 2018 -0800]","Body":"ISSUE #956: gc: add more stats\n\nAdd new gc stats:\n * RECLAIMED_COMPACTION_SPACE_BYTES\n * ACTIVE_ENTRY_LOG_COUNT\n * ACTIVE_ENTRY_LOG_SPACE_BYTES\n * RECLAIMED_ENTRY_LOG_SPACE_BYTES\n * THREAD_RUNTIME\n * MAJOR_COMPACTION_COUNT\n * MINOR_COMPACTION_COUNT\n * ACTIVE_LEDGER_COUNT\n * DELETED_LEDGER_COUNT\n\nRemoves apparently unused (better named replacements above):\n * NUM_MINOR_COMP\n * NUM_MAJOR_COMP\n\n(bug W-3038773)\nSigned-off-by: Samuel Just <sjustsalesforce.com>\nSigned-off-by: Dustin Castor <dcastorsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #967 from athanatos/forupstream/stats1/gc, closes #956\n","Date":"Fri Jan 12 08:29:57 CET 2018"},{"Commit-ID":"commit c53756bdb1fafb3221b32222602cbc86327e17a7 1515745471 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Fri Jan 12 00:24:31 2018 -0800]","Body":"BookieWatcher: add stats for ensemble changes\n\n(bug W-3019451)\nSigned-off-by: Dustin Castor <dcastorsalesforce.com>\n[Fixed up merge/checkstyle issues, added tests]\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #969 from athanatos/forupstream/stats1/ensemblechange\n","Date":"Fri Jan 12 09:24:31 CET 2018"},{"Commit-ID":"commit 1a48c6cc66a1e896f0f3fa8b92f22a7f9f843d59 1515774343 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Jan 12 17:25:43 2018 +0100]","Body":"Move dev and dev-debug profiles to top level POM\n\nSo that they can be used from other modules.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #973 from ivankelly/move-dev-profile\n","Date":"Fri Jan 12 17:25:43 CET 2018"},{"Commit-ID":"commit 543ad2b5722988d3936680f605b53fd5be5df403 1515774502 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Jan 12 17:28:22 2018 +0100]","Body":"Upgrade nokogiri to 1.8.1\n\nUpgrade nokogiri as 1.8.0 has a security vulnerability.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nThis closes #972 from ivankelly/nokogiri-upgrade\n","Date":"Fri Jan 12 17:28:22 CET 2018"},{"Commit-ID":"commit 9a29dd66c9e1fc43d10dbf4ce375309dbcc99369 1515874149 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jan 12 13:50:15 2018 -0800]","Body":"Move `bookkeeper-common` as `common` module\n\nThis `common` module should be split and merged back to `bookkeeper-common` when stream store is open sourced\n","Date":"Fri Jan 12 22:50:15 CET 2018"},{"Commit-ID":"commit 30d889dffa482939512d46ae0be0f08409d08d5c 1515874149 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jan 12 13:52:41 2018 -0800]","Body":"Remove the simple name resolver factory.\n\nThis simple name resolver factory is introduced from thin client implementation. It is not needed by stream store.\n","Date":"Fri Jan 12 22:52:41 CET 2018"},{"Commit-ID":"commit c2c2ca3ec5df0439f41a1429ff1bdfa56e941e04 1515874149 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jan 12 14:46:28 2018 -0800]","Body":"Finished the import of streamstore module and make it compilable.\n","Date":"Fri Jan 12 23:46:28 CET 2018"},{"Commit-ID":"commit 4cf41eb5cd7d090e2b79d9de3a60e12fb0a44ca4 1515874149 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Jan 13 12:02:44 2018 -0800]","Body":"Move kv api from `stream.api.view.kv` to `api.kv`\n","Date":"Sat Jan 13 21:02:44 CET 2018"},{"Commit-ID":"commit 0f547bd4cb1dad3f52513be9ff2763ecee19e05f 1515874488 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Jan 13 12:14:48 2018 -0800]","Body":"Relocate the protocol package\n","Date":"Sat Jan 13 21:14:48 CET 2018"},{"Commit-ID":"commit 56ed506b6c727653671771a07d30a8912130a238 1515875005 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Jan 13 12:23:25 2018 -0800]","Body":"Relocate storage package\n","Date":"Sat Jan 13 21:23:25 CET 2018"},{"Commit-ID":"commit 9d621ff21dc47e1c884fb3e243c05e955e70257e 1515879660 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Jan 13 13:41:00 2018 -0800]","Body":"Refactor, cleanup and enable bookkeeper checkstyle\n\n- rename impl as statelib\n- move coder from api to common, so it can be shared between statelib and clients\n- move statestore api to statelib\n","Date":"Sat Jan 13 22:41:00 CET 2018"},{"Commit-ID":"commit 5ca0f0ea294c1a33283c54aaabc1de3dd70d5a90 1515882055 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Jan 13 14:20:55 2018 -0800]","Body":"Move client implementation from `streamstore/client` to clients/java\n","Date":"Sat Jan 13 23:20:55 CET 2018"},{"Commit-ID":"commit 81c2bca979df310f6d99e0b30d9472b74f6aed7c 1515971566 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Jan 14 15:12:46 2018 -0800]","Body":"Refactor client package from `stream.client` to `clients`\n","Date":"Mon Jan 15 00:12:46 CET 2018"},{"Commit-ID":"commit 87ea6ab78e9deec916990362d7b6d6f4fbbb902c 1515971842 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Jan 14 15:17:22 2018 -0800]","Body":"Add clients-parent module\n","Date":"Mon Jan 15 00:17:22 CET 2018"},{"Commit-ID":"commit db293f39c81664bff960d8f6b0f0eb83934fcd33 1515972610 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Jan 14 15:30:10 2018 -0800]","Body":"refactor `rangeservice` to `storage`\n","Date":"Mon Jan 15 00:30:10 CET 2018"},{"Commit-ID":"commit 059384693ae544f5db345e5c46df2e0b189762d8 1515973712 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Jan 14 15:48:32 2018 -0800]","Body":"Rename RangeServer as StorageServer\n\n`RangeServer` was used for servers that host individual `ranges`. since now the server becomes more generic for serving containers and ranges for both streams and tables.\n","Date":"Mon Jan 15 00:48:32 CET 2018"},{"Commit-ID":"commit 039084947d1af19d4d1e01e8ac94bf10ba007ace 1515974405 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Jan 14 16:00:05 2018 -0800]","Body":"Storage module should depends on the new client module\n","Date":"Mon Jan 15 01:00:05 CET 2018"},{"Commit-ID":"commit 70d7153a3cbe1aaa03c3f2a2f3946ee1964b9f47 1515974871 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Jan 14 16:07:51 2018 -0800]","Body":"Fix NPE on LocalClientImpl\n","Date":"Mon Jan 15 01:07:51 CET 2018"},{"Commit-ID":"commit f493c27da4248c2a5ef0d8a6fccf3f54404aa6d6 1515977585 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Sun Jan 14 16:53:05 2018 -0800]","Body":"Rename \"Collection\" to \"Namespace\" (#2)\n\nto simplify/unify the concepts with pulsar, rename the collection to namespace","Date":"Mon Jan 15 01:53:05 CET 2018"},{"Commit-ID":"commit 73bdbea10f469120d5b1574f0381da7901e2fa1a 1515978766 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia03@gmail.com, Sun Jan 14 17:12:46 2018 -0800]","Body":" Fix status codes which still reference collection (#3)\n\n#2 renamed collection to namespace but it doesn't finish cleaning up the status code references. This pull request fixes it.","Date":"Mon Jan 15 02:12:46 CET 2018"},{"Commit-ID":"commit 1e72c59c25da37953362cc491cf82560147a991c 1515979059 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia03@gmail.com, Sun Jan 14 17:17:39 2018 -0800]","Body":"Fix the namespace processor filenames (#4)\n\n","Date":"Mon Jan 15 02:17:39 CET 2018"},{"Commit-ID":"commit 0981dbc84be65c3be20eea7d0deb8603a58b666a 1516010742 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia03@gmail.com, Mon Jan 15 02:05:42 2018 -0800]","Body":"Introduce a store factory to manage and create mvcc stores (#5)\n\n","Date":"Mon Jan 15 11:05:42 CET 2018"},{"Commit-ID":"commit 02352236951a37f4981b0b1585444392f2ad92ee 1516016557 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Mon Jan 15 03:42:37 2018 -0800]","Body":"Use local state store to store root range (#6)\n\n* Use statelib to store metadata\r\n\r\n* Remove namespace\r\n\r\n* Use local state store to store root range\r\n","Date":"Mon Jan 15 12:42:37 CET 2018"},{"Commit-ID":"commit e95abb9e445f851b3be8bb82b087c3d2ea27f701 1516044028 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia03@gmail.com, Mon Jan 15 11:20:28 2018 -0800]","Body":"Cherry-pick the stream storage server module (#7)\n\n","Date":"Mon Jan 15 20:20:28 CET 2018"},{"Commit-ID":"commit 32f963d01734371ba29fd3af0e523d6d277d8234 1516054336 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Mon Jan 15 14:12:16 2018 -0800]","Body":"Cherry-pick integration tests from stream storage (#8)\n\n","Date":"Mon Jan 15 23:12:16 CET 2018"},{"Commit-ID":"commit f4d35c4aed390514a4f9965cb69e4bb7e9df8078 1516080865 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Mon Jan 15 21:34:25 2018 -0800]","Body":"store stream/range metadata in a mvcc local store (#9)\n\n","Date":"Tue Jan 16 06:34:25 CET 2018"},{"Commit-ID":"commit 8e53bdefa854ba56d897d5e7449b89decff42a31 1516083812 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Mon Jan 15 22:23:32 2018 -0800]","Body":" Expose table service to grpc endpoint  (#10)\n\n\r\n","Date":"Tue Jan 16 07:23:32 CET 2018"},{"Commit-ID":"commit 2d9c327fee60f5025ce9adad4d7c863958ab59ef 1516090689 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Tue Jan 16 16:18:09 2018 +0800]","Body":"Journal: add stat for cb queue size\n\nAlso adds a bit of functionality to TestStatsProvider to facilitate\ntesting.\n\n(bug W-3019451)\nSigned-off-by: Dustin Castor <dcastorsalesforce.com>\n[Adapted to current branch, added simple test]\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #968 from athanatos/forupstream/stats1/journal\n","Date":"Tue Jan 16 09:18:09 CET 2018"},{"Commit-ID":"commit c11f5f03139c3f42495e90cd68ce0b0c77aad616 1516091630 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Tue Jan 16 16:33:50 2018 +0800]","Body":"ISSUE #986: in LocalBK.main do Sys.exit in the case of an Exc\n\nDescriptions of the changes in this PR:\n\nin LocalBookKeeper.main method if there is any exception then it should do System.exit. This is needed,  because, some non-daemon thread (probably in ZK or some other dependent service) is preventing the JVM from exiting, though there is exception in main thread.\n\nMaster Issue: #986\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #987 from reddycharan/minorlocalbookkeeperfix, closes #986\n","Date":"Tue Jan 16 09:33:50 CET 2018"},{"Commit-ID":"commit d75ee302588669386629d10c755b61bc503e60cc 1516191202 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Wed Jan 17 04:13:22 2018 -0800]","Body":" Implement table storage using the local mvcc store  (#11)\n\n","Date":"Wed Jan 17 13:13:22 CET 2018"},{"Commit-ID":"commit 83f0796923992ec486d0828c2ba34bb8de7727c6 1516201432 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Wed Jan 17 23:03:52 2018 +0800]","Body":"LedgerHandle: add counters to track ledger->bookie counts\n\nWe can use this to detect distribution issues.\n\n(bug W-4188471)\nSigned-off-by: Venkateswararao Jujjuri (JV) <vjujjurisalesforce.com>\n[Ported to master, cleaned up a bit, added test]\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #977 from athanatos/forupstream/stats1/edist\n","Date":"Wed Jan 17 16:03:52 CET 2018"},{"Commit-ID":"commit 26c3379c9fdd812ef36da6176d83e26179705535 1516201582 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Jan 17 16:06:22 2018 +0100]","Body":"Fix tight loop in getFileInfo\n\nThe argument to assertions is not evaluated if assertions is disabled,\nwhich was messing up the refcounting for the fileinfo backing\ncache. We ended up with dead fileinfo objects in the guava caches,\nwhich triggered an infinite loop.\n\nThis patch fixes that by moving the tryRetain() out of the assert. It\nalso adds defensive code to getFileInfo to ensure that if a fileinfo\nobject is dead, that it doesn't exist any longer in the caches.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Yiming Zang <yzang2016@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #990 from ivankelly/inf-loop\n","Date":"Wed Jan 17 16:06:22 CET 2018"},{"Commit-ID":"commit 1f0d15356ef10c8ebb14dfb3048b66dbec6c0260 1516201630 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Wed Jan 17 23:07:10 2018 +0800]","Body":"ISSUE #988: more log lines for replication status changes\n\nDescriptions of the changes in this PR:\n\nmore log lines for replication status changes\n\nMaster Issue: #988\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #989 from reddycharan/replicatorlogs, closes #988\n","Date":"Wed Jan 17 16:07:10 CET 2018"},{"Commit-ID":"commit 25b0d93405e87efeb35ca50cbd04ab14488ceaea 1516201682 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Jan 17 16:08:02 2018 +0100]","Body":"Issue #981: Revert \"ISSUE #561: Remove exec commands to start in the shell pid\"\n\nThis reverts commit 7d7497b70507ea3d31b184ebe04d98c733e2cf5b.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #994 from ivankelly/revert-exec, closes #981, closes #561\n","Date":"Wed Jan 17 16:08:02 CET 2018"},{"Commit-ID":"commit d44bee59b25035ba69976386b55eecac82a1ae3a 1516201767 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Wed Jan 17 23:09:27 2018 +0800]","Body":"PendingReadOp: add counter for speculative reads\n\n(bug W-3324107)\nSigned-off-by: Dustin Castor <dcastorsalesforce.com>\n[Ported to current master, added test]\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #991 from athanatos/forupstream/stats1/specreadstats\n","Date":"Wed Jan 17 16:09:27 CET 2018"},{"Commit-ID":"commit ff4932b37f68303793acce91840a55fddfda231f 1516214093 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Wed Jan 17 10:34:53 2018 -0800]","Body":"DoubleByteBuf fix for Netty > 4.1.12\n\nThis is a port from Pulsar, DoubleByteBuf has problems with Netty Native Transport.\nOriginal author is  sschepens\n\nsee https://github.com/apache/incubator-pulsar/pull/1056\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #996 from eolivelli/fix/doublebytebuf\n","Date":"Wed Jan 17 19:34:53 CET 2018"},{"Commit-ID":"commit 1f66e478dd78fb2f9ba66b7c92da2ec17c5be089 1516236277 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Jan 17 16:44:37 2018 -0800]","Body":"Utilities for working with Arquillian and Docker\n\nThis patch contains the following utilities.\n- An arquillian StopAction which copy logs from /var/log/bookkeeper to\n  the target/ directory.\n- An arquillian StopAction which dumps the docker log to the target/\n  directory.\n- An arquillian AwaitStrategy which checks whether a zookeeper cluster\n  is running.\n- An arquillian AwaitStrategy which returns immediately (surprising\n  arquillian didn't already have this).\n- Utilities for working with a cluster of zookeeper/bookkeeper running\n  on docker.\n\nMaster Issue: #903\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #974 from ivankelly/arquillian-util\n","Date":"Thu Jan 18 01:44:37 CET 2018"},{"Commit-ID":"commit 9fca590d94bea9bf86a49f1dbdddf2ae37d3e949 1516240138 -----sp","Author":"PersonIdent[Sebastian Schepens, sebastian.schepens@mercadolibre.com, Thu Jan 18 02:48:58 2018 +0100]","Body":"revert DoubleByteBuf niobuffers() changes\n\nRevert some of the changes in https://github.com/apache/bookkeeper/pull/996 since they cause issues\n\nAuthor: Sebastian Schepens <sebastian.schepens@mercadolibre.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #998 from sschepens/double-bytebuf-fix-2\n","Date":"Thu Jan 18 02:48:58 CET 2018"},{"Commit-ID":"commit 70bb9d7f067413d2031229b29c5ef5c7e88d18eb 1516267589 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Thu Jan 18 01:26:29 2018 -0800]","Body":" Implement table storage using the local mvcc store (#12)\n\n","Date":"Thu Jan 18 10:26:29 CET 2018"},{"Commit-ID":"commit b18cdd521a65bd3ea0946411a1ed4986a5f799a8 1516267960 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Thu Jan 18 01:32:40 2018 -0800]","Body":"Fix compilation issue: remove duplicated method (#13)\n\n","Date":"Thu Jan 18 10:32:40 CET 2018"},{"Commit-ID":"commit 733ce31aa97c757f769048ec280316f493b80238 1516270424 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Jan 18 11:13:44 2018 +0100]","Body":"Maven classloader\n\nThis will allow us to test different versions of the client.\n\nAlso includes some extra methods to make it easier to work with the\nbookkeeper client.\n\nMaster Issue: #903\n\nAuthor: Ivan Kelly <ivank@apache.org>\nAuthor: Sijie Guo <guosijie@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #975 from ivankelly/maven-classloader\n","Date":"Thu Jan 18 11:13:44 CET 2018"},{"Commit-ID":"commit 5e32f634efa833e3ea7c5ae0b235e5a480ddcb95 1516289152 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Jan 18 16:25:52 2018 +0100]","Body":"Remove unused import from DoubleByteBuf\n\n9fca59 left behind an import, which triggers a failure in checkstyle.\nFix is to remove the import.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1011 from ivankelly/fix-checkstyle\n","Date":"Thu Jan 18 16:25:52 CET 2018"},{"Commit-ID":"commit 64da7e75f7d4ff84a3c9a9adddf6089c1cbf9165 1516302069 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Jan 18 11:01:09 2018 -0800]","Body":"Rework of binary distribution licenses\n\nAll redistributed jars are mentioned in the LICENSE file. If the jar\nis ASLv2, it is simply listed under the ASLv2 text. If these ASLv2\njars have their own NOTICE files, then the relevant portions are added\nto our NOTICE file.\n\nAll jar under license other than ASLv2 get their own section in\nLICENSE, which links to the full text of their license. Non-ASLv2\ngenerally do not require an update to NOTICE.\n\nThis change also includes a script, check-binary-license, which checks\nthat the contents on the LICENSE and NOTICE actually matches what\nbundled in the distribution tarball.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #888 from ivankelly/license-rework\n","Date":"Thu Jan 18 20:01:09 CET 2018"},{"Commit-ID":"commit 20db5fe96571a44429cdf0fad0dfd32240c55c51 1516302545 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Thu Jan 18 11:09:05 2018 -0800]","Body":"PendingReadOp: improve logging for speculative read targets\n\nAnd add more log messages around speculative read\nto understand what bookies were tried, before attempting\nspeculative read.\n\n(bug W-3315760)\nSigned-off-by: Venkateswararao Jujjuri (JV) <vjujjurisalesforce.com>\n[Fixed merge conflicts and checkstyle issues]\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #993 from athanatos/forupstream/stats1/specreadlogs\n","Date":"Thu Jan 18 20:09:05 CET 2018"},{"Commit-ID":"commit fe012e31248a68a53b3976babaa32dbd51fc8e89 1516302718 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jan 18 11:11:58 2018 -0800]","Body":"Increase page size for fetching github labels\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nThe default page size for github api is 30 items. The number of labels at bookkeeper are more than 30 items, so `type/task` is not showing up at merge script.\n\n*Solution*\n\nThis change is to bump the page size to 100 items.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1013 from sijie/increase_page_size\n","Date":"Thu Jan 18 20:11:58 CET 2018"},{"Commit-ID":"commit 9f901bcb04561d2dac5eff7fbd6fc39b74feedfc 1516323648 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Thu Jan 18 17:00:48 2018 -0800]","Body":"Add an integrate test case on testing end-to-end kv store (#14)\n\n","Date":"Fri Jan 19 02:00:48 CET 2018"},{"Commit-ID":"commit 0c9e88be25d3a37300cffc518d25a79a49456d24 1516352935 -----sp","Author":"PersonIdent[JV, vjujjuri@salesforce.com, Fri Jan 19 01:08:55 2018 -0800]","Body":"ISSUE #985: Add log messages to indicate bucket levels of entryLog.\n\n(bug W-3333413)\nSigned-off-by: Venkateswararao Jujjuri (JV) <vjujjurisalesforce.com>\n[Fixed merge issues]\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: JV <vjujjuri@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #997 from athanatos/forupstream/logs1/compaction, closes #985\n","Date":"Fri Jan 19 10:08:55 CET 2018"},{"Commit-ID":"commit 4487f7447ab90a8a1b80cacb5f77c8f6760bb056 1516353016 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Fri Jan 19 01:10:16 2018 -0800]","Body":"[MERGE YAHOO REPO] CMS-1487: Provide tool to read entries from a particular bookie\n\nDescriptions of the changes in this PR:\n\nCMS-1487: Provide tool to read entries from a particular bookie.\nHere is original commit:\nhttps://github.com/yahoo/bookkeeper/commit/1a884b02\n\nAuthor: Jia Zhai <zhaijia@apache.org>\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1009 from jiazhai/cherry_picks/i_115\n","Date":"Fri Jan 19 10:10:16 CET 2018"},{"Commit-ID":"commit 1e63756bde3a64ce787275fb645297d7d3f79954 1516353313 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Fri Jan 19 01:15:13 2018 -0800]","Body":"ZkRegistrationManager: add log line with root path for prepareFormat\n\nUseful for auditability.\n\n(bug W-4026563)\nSigned-off-by: Zhimeng Shi <zshisalesforce.com>\n[Updated for current patch]\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1015 from athanatos/forupstream/logs1/format\n","Date":"Fri Jan 19 10:15:13 CET 2018"},{"Commit-ID":"commit 71fa42a2019cafe15430544deeb351d87c253f8c 1516353382 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Fri Jan 19 01:16:22 2018 -0800]","Body":"proto/*Processor: clean up logging, include exception stack\n\nFor WriteEntryProcessorV3, log fence exception at error in order to help\nwith debugging the cause of a fenced ledger.\n\n(bug W-3299246)\n(bug W-3158835)\nSigned-off-by: Andrey Yegorov <ayegorovsalesforce.com>\nSigned-off-by: Venkateswararao Jujjuri (JV) <vjujjurisalesforce.com>\n[Minor formatting fixes]\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1016 from athanatos/forupstream/logs1/processors\n","Date":"Fri Jan 19 10:16:22 CET 2018"},{"Commit-ID":"commit 45e4c5e1c26284635e1eeac392cd896392e2084e 1516353574 -----sp","Author":"PersonIdent[Siddharth Boobna, sboobna@yahoo-inc.com, Fri Jan 19 01:19:34 2018 -0800]","Body":"[MERGE YAHOO REPO] CMS-1599: make sure we always release the underreplicated lock\n\nDescriptions of the changes in this PR:\n\nCMS-1599: make sure we always release the underreplicated lock\n\nHere is original commit:\nhttps://github.com/yahoo/bookkeeper/commit/850122ed\n\nAuthor: Siddharth Boobna <sboobna@yahoo-inc.com>\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1010 from jiazhai/cherry_picks/i_120\n","Date":"Fri Jan 19 10:19:34 CET 2018"},{"Commit-ID":"commit 95577675dd908855b6dba4dbe486d49d37dff1f0 1516388938 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Jan 19 20:08:58 2018 +0100]","Body":"Base modules for integration testing\n\nIntegration tests should all specify either of this modules as their\nparent.\n\nintegration-tests-base is for pure java integration tests.\nintegration-tests-base-groovy is for groovy integration tests, suchs\nas BC testing.\n\nMaster Issue: #903\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #976 from ivankelly/integ-base-mod\n","Date":"Fri Jan 19 20:08:58 CET 2018"},{"Commit-ID":"commit 6dda0a6c68fbaf2ca198cfbb693db4ac93a0feef 1516389068 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Jan 19 20:11:08 2018 +0100]","Body":"Utilities for bookies running in test containers\n\nThe changes include:\n- Updating configuration in bk_server.conf for one or all bookies\n- Run commands on all or one bookie\n- Wait for all bookies in the test are up\n\nThere are also improvements to DockerUtils#runCommand:\n- Better logging\n- Catches RunTime exceptions, as Docker-java throws them and it could\n  fail the test\n- Throw an exception is the command exits with anything but 0\n\nMaster Issue: #903\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1020 from ivankelly/bookie-util\n","Date":"Fri Jan 19 20:11:08 CET 2018"},{"Commit-ID":"commit 55313600735f0ea562fdab5d59671a823f5ce366 1516389250 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Jan 19 20:14:10 2018 +0100]","Body":"Fixups for broken versions in all versions images\n\nVarious versions of bookkeeper have shipped broken by default. This\npatch fixes them up in the all versions image, so that they can be\ntested.\n\nMaster Issue: #903\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1021 from ivankelly/broken-versions\n","Date":"Fri Jan 19 20:14:10 CET 2018"},{"Commit-ID":"commit 2edd68f5a55168a26b96b8ad993303d5a0be4757 1516582746 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Jan 22 08:59:06 2018 +0800]","Body":"Arquillian topologies module\n\nWill allow topologies to be shared among modules, which is important\nas arquillian builds and pulls down the containers on a per\nmodule/suite basis.\n\nCurrently contains a single topology, which is 3 BK nodes and 1 ZK\nnodes. The BK nodes contain all released versions, with no version\nstarted by default.\n\nMaster Issue: #903\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1023 from ivankelly/topologies\n","Date":"Mon Jan 22 01:59:06 CET 2018"},{"Commit-ID":"commit 11b278e202416a3893063e64e3a4579b360d2b5b 1516613009 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Jan 22 10:23:29 2018 +0100]","Body":"Only run integration tests with -DintegrationTests\n\nIntegration tests have a higher system requirement than normal unit\ntests, and take longer to run, so they should be explicitly enabled.\n\nMaster Issue: #903\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1022 from ivankelly/integ-flag\n","Date":"Mon Jan 22 10:23:29 CET 2018"},{"Commit-ID":"commit b212e85ccbf6eb8b08d776cce9147f4708c7a153 1516641479 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Jan 22 18:17:59 2018 +0100]","Body":"Allow groovy tests to compile on java 9\n\nOlder versions of the compiler cannot handle java9 modules.\n\nMaster Issue: #903\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1032 from ivankelly/groovy-j9\n","Date":"Mon Jan 22 18:17:59 CET 2018"},{"Commit-ID":"commit af6de4871cfa398eb3a95d4700a804455e0bf701 1516649925 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Jan 22 11:38:45 2018 -0800]","Body":"Test upgrade from old server version to new version\n\nThis patch contains two tests.\n- Upgrade between all released version, up to latest version\n- Upgrade direct from 4.1.0 to latest version\n\nIn all cases the old client should continue to work with the new version.\nIn one case(4.2->4.3), we broken client compatibility so the the new client\nstops working with the old server.\n\nThese tests replace and expand on the testing done by\nTestBackwardCompat#testCompat410 with the old BC tests.\n\nMaster Issue: #903\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1028 from ivankelly/compat401\n","Date":"Mon Jan 22 20:38:45 CET 2018"},{"Commit-ID":"commit f5b7e08d8ba35b7173c6c9fed4221d086cd38fdb 1516651218 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Jan 22 12:00:18 2018 -0800]","Body":"Test compatibility between old hierarchical ledger manager and current\n\nEnsures that the current client and server can handle ledgers created by the\nhierarchical ledger manager from 4.2.0.\n\nReplaces TestBackwardCompat#testCompatHierarchicalLedgerManager from old tests\n\nMaster Issue: #903\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis patch had conflicts when merged, resolved by\nCommitter: Sijie Guo <sijie@apache.org>\n\nThis closes #1029 from ivankelly/bc-heir\n","Date":"Mon Jan 22 21:00:18 CET 2018"},{"Commit-ID":"commit 1d7a489afb8fee8754b2da1d45745a47542eeca7 1516685578 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Mon Jan 22 21:32:58 2018 -0800]","Body":"ISSUE #1026: initbookie cmd\n\nDescriptions of the changes in this PR:\n\n- adding a new BookieShell command - \"initbookie\" command to decouple from\nbookieformat. This command initializes bookie, by making sure that the\njournalDirs, ledgerDirs and indexDirs are empty and there is no\nregistered Bookie with this BookieId.\n\nMaster Issue: #1027\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1027 from reddycharan/initbookiecmd, closes #1026\n","Date":"Tue Jan 23 06:32:58 CET 2018"},{"Commit-ID":"commit ef6f8719fe697458e50f8c9cf07c1ec07427acb9 1516742818 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Tue Jan 23 13:26:58 2018 -0800]","Body":"Improve the client api to a type-safe api (#15)\n\n","Date":"Tue Jan 23 22:26:58 CET 2018"},{"Commit-ID":"commit 7464dcca833a9fa7861c6f202cb2f672abd4bb86 1516759273 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Tue Jan 23 18:01:13 2018 -0800]","Body":"Enable txn on both server side and client side (#16)\n\n","Date":"Wed Jan 24 03:01:13 CET 2018"},{"Commit-ID":"commit caa97bd8968a1d0d19d8cf04822f42c2ab3c20cb 1516762480 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Tue Jan 23 18:54:40 2018 -0800]","Body":"Add some simplified kv methods in PTable (#17)\n\n","Date":"Wed Jan 24 03:54:40 CET 2018"},{"Commit-ID":"commit 716684a3f68e47aa50becbd4c51cf252425a1990 1516781625 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Tue Jan 23 21:34:33 2018 -0800]","Body":"Table -> Stream (part 1): add table writer for appending events to stream\n","Date":"Wed Jan 24 06:34:33 CET 2018"},{"Commit-ID":"commit 74185c398ff2bbffde65ae9dc587bfd89ee78c73 1516772073 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Tue Jan 23 21:34:33 2018 -0800]","Body":"Add Table api and its implementation (#18)\n\n","Date":"Wed Jan 24 06:34:33 CET 2018"},{"Commit-ID":"commit 16fb26bfc87035d4efda2d75ff42f3a0350e18ea 1516784401 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jan 24 01:00:01 2018 -0800]","Body":"Table -> Stream (part 2): Introduce `defaultBackendUri` in stream configuration\n\n`defaultBackendUri` points to the service that is used for storing the logs for ranges.\n","Date":"Wed Jan 24 10:00:01 CET 2018"},{"Commit-ID":"commit 81c8ed3cb61726f521df482590d2cd48068dff7d 1516787791 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jan 24 01:56:31 2018 -0800]","Body":"Table -> Stream (part 3): Implement dlog based table writer\n","Date":"Wed Jan 24 10:56:31 CET 2018"},{"Commit-ID":"commit 519743e51cdc40c3e3ddbfabd83640fc30838a10 1516795561 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Jan 24 13:06:01 2018 +0100]","Body":"Ledgers without masterkey in metadata can't be recovered\n\nTest that ledgers, created without a master key in the metadata, cannot be recovered until\nthe master key is known.\n\nReplaces TestBookieRecovery from the old tests.\n\nMaster Issue: #903\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1035 from ivankelly/bc-recovery\n","Date":"Wed Jan 24 13:06:01 CET 2018"},{"Commit-ID":"commit 51b93bad7622878b1f2f3246c9880851731e84af 1516819244 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Wed Jan 24 10:40:44 2018 -0800]","Body":"ISSUE #978: decouple metaformat cmd\n\nDescriptions of the changes in this PR:\n\n- introduce new commands - initnewcluster, nukeexistingcluster, whatisinstanceid\n- add testcases initnewcluster and nukeexistingcluster at BookKeeperAdmin level\n\nMaster Issue: #978\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #979 from reddycharan/splitmetaformat, closes #978\n","Date":"Wed Jan 24 19:40:44 CET 2018"},{"Commit-ID":"commit 2f3d5e9acd75cbeb9b8c0cc543901b3d017eac7c 1516819317 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@cguttapale-ltm1.internal.salesforce.com, Wed Jan 24 10:41:57 2018 -0800]","Body":"More testcases for LedgerHandle\n\nDescriptions of the changes in this PR:\n\n- New testcases for missing testcoverage in\nLedgerHandle and ReadOnlyLedgerHandle\n\nAuthor: Charan Reddy Guttapalem <cguttapalem@cguttapale-ltm1.internal.salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1045 from reddycharan/ledgerhandlemissingtests\n","Date":"Wed Jan 24 19:41:57 CET 2018"},{"Commit-ID":"commit 91dcbce5f0d686f013efab3b76b42962a4546f86 1516819391 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Wed Jan 24 10:43:11 2018 -0800]","Body":"AuditorPeriodicCheckTest: add test for entries with failed bookie writes\n\nValidate that the auditor's periodic check will detect entries\nwith failed bookie writes and repair them.\n\nSigned-off-by: Rithin <rithin.shettysalesforce.com>\n(bug W-3311952)(bug W-3311965)\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1044 from athanatos/forupstream/tests/failedwrites\n","Date":"Wed Jan 24 19:43:11 CET 2018"},{"Commit-ID":"commit 0ffac5ac9f7c573eab93a43dae86c1a78e1b61de 1516819733 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Wed Jan 24 10:48:53 2018 -0800]","Body":"ISSUE #1041: Adding new testcases\n\nDescriptions of the changes in this PR:\n\n- New Testclass for ZeroBuffer\n- New testcases for missing testcoverage in\nSortedLedgerStorage, EntryMemTable and LedgerHandleAdv\n\nMaster Issue: #1041\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1042 from reddycharan/missingtestcases, closes #1041\n","Date":"Wed Jan 24 19:48:53 CET 2018"},{"Commit-ID":"commit 9b36898dbdfed3fa95a00407d29413a5f8466c04 1516819907 -----sp","Author":"PersonIdent[Andrey Yegorov, ayegorov@salesforce.com, Wed Jan 24 10:51:47 2018 -0800]","Body":"CompactionTest: call storage.shutdown() prior to recreating\n\n(bug W-2962634)\nSigned-off-by: Andrey Yegorov <ayegorovsalesforce.com>\n[Ported to master]\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Andrey Yegorov <ayegorov@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1036 from athanatos/forupstream/tests/compaction\n","Date":"Wed Jan 24 19:51:47 CET 2018"},{"Commit-ID":"commit 381248d64d878b1e970e4842598646c054d7a989 1516820048 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Wed Jan 24 10:54:08 2018 -0800]","Body":"ISSUE #1039: BKClient tests with BookieErrors\n\nDescriptions of the changes in this PR:\n\n- end-to-end tests for validating BKClient readEntry\ncalls incase of combination of bookie timeouts and\ndata corruption\n\nMaster Issue: #1039\n\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1040 from reddycharan/bookkeeperclienttests, closes #1039\n","Date":"Wed Jan 24 19:54:08 CET 2018"},{"Commit-ID":"commit 38a3885a363971635fc2e45ec48d3331a16b8c63 1516820095 -----sp","Author":"PersonIdent[Andrey Yegorov, ayegorov@salesforce.com, Wed Jan 24 10:54:55 2018 -0800]","Body":"AuditorLedgerCheckerTest: wait for ro transition to make more reliable\n\n(bug W-2999244)\nSigned-off-by: Andrey Yegorov <ayegorovsalesforce.com>\n[Reworked for master]\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Andrey Yegorov <ayegorov@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1038 from athanatos/forupstream/tests/bookietransition\n","Date":"Wed Jan 24 19:54:55 CET 2018"},{"Commit-ID":"commit c0cd03031c7decf29276e286904c431b2be75fab 1516820142 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Wed Jan 24 10:55:42 2018 -0800]","Body":"BookKeeperClusterTestCase,UpdateLedgerOpTest: remove call to setAllow\u2026\n\n(bug W-2962634)\nSigned-off-by: Andrey Yegorov <ayegorovsalesforce.com>\n[Ported to master]\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1037 from athanatos/forupstream/tests/setallowloopback\n","Date":"Wed Jan 24 19:55:42 CET 2018"},{"Commit-ID":"commit 305efca865f1cc8d6c89f6e6a53669e0b1265948 1516820202 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Jan 24 10:56:42 2018 -0800]","Body":"Test compat with useHostNameAsBookieID\n\nTest that old client can continue to work with servers which are using their\nhostname as their bookie id.\n\nThis replaces TestBackwardCompat#testCompatWrites and TestBackwardCompat#testCompatReads\nfrom the old BC tests.\n\nMaster Issue: #903\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1033 from ivankelly/bc-hostname\n","Date":"Wed Jan 24 19:56:42 CET 2018"},{"Commit-ID":"commit a512b737160e7d52ed46964018c51302b2408967 1516820614 -----sp","Author":"PersonIdent[Arvin, arvindevel@gmail.com, Wed Jan 24 11:03:34 2018 -0800]","Body":"BP-25: MovingChecksumToProto--Refactor the checksum part of bookkeeper\n\nDescriptions of the changes in this PR:\n\nCurrent the checksum implementation is in client module while the checksum semantic is more close to protocol. Moreover, moving the checksum implementation to protocol will avoid server module's dependency to client module when doing checksum in server side.\n\nMaster Issue: #1007\n\nAuthor: Arvin <arvindevel@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri <vjujjuri@salesforce.com>\n\nThis closes #1008 from ArvinDevel/BP_25_MovingChecksumToProto\n","Date":"Wed Jan 24 20:03:34 CET 2018"},{"Commit-ID":"commit a764c7f3336d2acb6b15e1b0197b0dc4cff7e5b1 1516820700 -----sp","Author":"PersonIdent[Arvin, arvindevel@gmail.com, Wed Jan 24 11:05:00 2018 -0800]","Body":"ISSUE #1007: move checksum to proto\n\nDescriptions of the changes in this PR:\n\nRefactor checksum to proto\nMaster Issue: #<1007>\n\nAuthor: Arvin <arvindevel@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1018 from ArvinDevel/issue1007, closes #1007\n","Date":"Wed Jan 24 20:05:00 CET 2018"},{"Commit-ID":"commit 3d9b08d475af825bcc4d2691378c39b5541846a9 1516824114 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jan 24 12:01:54 2018 -0800]","Body":"Table -> Stream (part 4): storage server supports serving readonly table\n\na `readonly` table is only tailing updates from log streams and applying updates to table ranges.\nthis allows applications to mutate tables using table writer.\n","Date":"Wed Jan 24 21:01:54 CET 2018"},{"Commit-ID":"commit 1e1aa52419558cc6584c82e2ccf06b0828304d1a 1516831710 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jan 24 14:08:30 2018 -0800]","Body":"Support Increment (part 1): provide increment op support in local state store.\n","Date":"Wed Jan 24 23:08:30 CET 2018"},{"Commit-ID":"commit 9935bb0a5624b4d820601c9826263d80e9500051 1516835628 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jan 24 15:13:48 2018 -0800]","Body":"Support Increment (part 2): provide increment op support in storage container, server and client\n","Date":"Thu Jan 25 00:13:48 CET 2018"},{"Commit-ID":"commit eba314291a21a05a862ccb4060da79b66cebc3b6 1516836589 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jan 24 15:29:49 2018 -0800]","Body":" Support Increment (part 3): fix integration test\n","Date":"Thu Jan 25 00:29:49 CET 2018"},{"Commit-ID":"commit 4a4276fd44a3fd58b2b94e30ac9c4a11bc838d3e 1516859636 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jan 24 21:53:56 2018 -0800]","Body":"Mark BP-20/BP-25 as adopted\n\nDescriptions of the changes in this PR:\n\nBP-20 is adopted in #760  #761\nBP-25 is adopted in #1007 #1008\n\nThis closes #760 #761 #1007 #1008\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1047 from sijie/close_bp_25\n","Date":"Thu Jan 25 06:53:56 CET 2018"},{"Commit-ID":"commit 60ff22670f885058ebedb19c19ff40856e74b53c 1516859786 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Wed Jan 24 21:56:26 2018 -0800]","Body":"ISSUE #1014: LedgerManager.asyncProcessLedgers bug fixes\n\nDescriptions of the changes in this PR:\n\n- fix for Bug 2 of 1014. Fixing race condition with node removal in 'asyncProcessLedgers'\n and making it robust to concurrent modifications like deletions of ledgers.\n- fix for Bug 1 of 1014, is already made as part of Issue #978 (decouple metaformat cmd)\n feature.\n- testcases to validate the fixes.\n\nMaster Issue: #1014\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1048 from reddycharan/asyncprocessfix, closes #1014\n","Date":"Thu Jan 25 06:56:26 CET 2018"},{"Commit-ID":"commit 07ec9d897255d07f772a084561fb0e17e0f0bc7a 1516859839 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Wed Jan 24 21:57:19 2018 -0800]","Body":"Enhance exception logging.\n\nDescriptions of the changes in this PR:\n\n- log exception in the case of exception in Bookie.shutdown\nand BookKeeperClusterTestCase.tearDown.\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1050 from reddycharan/logexception\n","Date":"Thu Jan 25 06:57:19 CET 2018"},{"Commit-ID":"commit 97d72fcf4129d1a31770834e9f6f1e641a9c23f3 1516859889 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Wed Jan 24 21:58:09 2018 -0800]","Body":"New testcases for ZKClient\n\nDescriptions of the changes in this PR:\n\n- new testcases for ZKClient to improve code coverage.\n\nAuthor: Charan Reddy Guttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1051 from reddycharan/zkclienttests\n","Date":"Thu Jan 25 06:58:09 CET 2018"},{"Commit-ID":"commit cab8fd365b53fa5a7ae8a35b6c98abdf4e52f371 1516862833 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Wed Jan 24 22:47:13 2018 -0800]","Body":"Provide a standalone cluster and a storage cli to interact with it (#19)\n\n","Date":"Thu Jan 25 07:47:13 CET 2018"},{"Commit-ID":"commit 38f9295c3e1ab2047a82a5181d7f8d5286d4297b 1516889515 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Jan 25 15:11:55 2018 +0100]","Body":"Servers formatted without instance id can't join a cluster with insta\u2026\n\nTest that old client can continue to work with servers which are using their\nhostname as their bookie id.\n\nThis replaces TestBackwardCompat#testCompatWrites and TestBackwardCompat#testCompatReads\nfrom the old BC tests.\n\nMaster Issue: #903\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1034 from ivankelly/bc-cookie\n","Date":"Thu Jan 25 15:11:55 CET 2018"},{"Commit-ID":"commit 80530b3c786225f1567bba1beaf65e350845b582 1516926053 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Thu Jan 25 16:20:53 2018 -0800]","Body":"Use github repo as a temp location for deploying artifacts (#20)\n\n","Date":"Fri Jan 26 01:20:53 CET 2018"},{"Commit-ID":"commit 5ad6527c3cba4fb2ad2eb0715e9915b5fb939b8d 1516946656 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Jan 26 07:04:16 2018 +0100]","Body":"Remove old compat stuff\n\nAs compat tests are now docker based, the shading stuff is no longer\nneeded.\n\nMaster Issue: #903\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1052 from ivankelly/remove-old-bc\n","Date":"Fri Jan 26 07:04:16 CET 2018"},{"Commit-ID":"commit 8e499793195ed36bf71dd23d6ca8696c2e56b17b 1516947034 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Jan 26 07:10:34 2018 +0100]","Body":"Move backward compat tests under a parent module\n\nTo avoid having to many modules directly in tests/, this patch moves\nbackward compat tests under their own parent module,\ntests/backward-compat.\n\nMaster Issue: #1030\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1054 from ivankelly/move-dir\n","Date":"Fri Jan 26 07:10:34 CET 2018"},{"Commit-ID":"commit 89cf23d52c7876230df4e84a818f8f848a7a7c19 1516960394 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Jan 26 10:53:14 2018 +0100]","Body":"Enable rerunning flakes twice\n\nEnables a configuration in maven to rerun failed tests a second time.\n\nMaster issue: #1031\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1062 from ivankelly/retry-flake\n","Date":"Fri Jan 26 10:53:14 CET 2018"},{"Commit-ID":"commit 43a896a08dae2a3a273d02e4c1ed81516ab00c85 1516986491 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@yahoo-inc.com, Fri Jan 26 18:08:11 2018 +0100]","Body":"[MERGE YAHOO REPO] CMS-2060: Catch IndexOutOfBoundsException when reading entry log index map\n\nDescriptions of the changes in this PR:\nThis is cherry-pick from yahoo repo of branch yahoo-4.3.\n\noriginal commit is:\nhttps://github.com/yahoo/bookkeeper/commit/2b7aacc5\nCMS-2060: Catch IndexOutOfBoundsException when reading entry log index map\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1061 from jiazhai/cherry_picks/i_164\n","Date":"Fri Jan 26 18:08:11 CET 2018"},{"Commit-ID":"commit 01430750ce5a2f7c46cce942a7aa6116e41b9508 1516986995 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@yahoo-inc.com, Fri Jan 26 18:16:35 2018 +0100]","Body":"[MERGE YAHOO REPO] Fixed NPE when accessing readonly bookie list\n\nDescriptions of the changes in this PR:\nThis is cherry-pick from yahoo repo of branch yahoo-4.3.\n\noriginal commit is:\nhttps://github.com/yahoo/bookkeeper/commit/270b69e4\nFixed NPE when accessing readonly bookie list\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1058 from jiazhai/cherry_picks/i_165\n","Date":"Fri Jan 26 18:16:35 CET 2018"},{"Commit-ID":"commit ffbe842d11ddd4e64ee79a3b6f86183be942cfc4 1516987143 -----sp","Author":"PersonIdent[rdhabalia, rdhabalia@yahoo-inc.com, Fri Jan 26 18:19:03 2018 +0100]","Body":"[MERGE YAHOO REPO] Release addEntry-Bytebuf on readOnlyBookie to prevent memory-leak\n\nDescriptions of the changes in this PR:\nThis is cherry-pick from yahoo repo of branch yahoo-4.3.\n\noriginal commit is:\nhttps://github.com/yahoo/bookkeeper/commit/42bdc083\nRelease addEntry-Bytebuf on readOnlyBookie to prevent memory-leak\n\nAuthor: rdhabalia <rdhabalia@yahoo-inc.com>\n\nReviewers: Ivan Kelly <ivank@apache.org>\n\nThis closes #1059 from jiazhai/cherry_picks/i_173\n","Date":"Fri Jan 26 18:19:03 CET 2018"},{"Commit-ID":"commit b38cd67a042aae0cac32aef69e814d7ade31bf03 1516987200 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Fri Jan 26 18:20:00 2018 +0100]","Body":"[MERGE YAHOO REPO] Flush after writing out index\n\nDescriptions of the changes in this PR:\nThis is cherry-pick from yahoo repo of branch yahoo-4.3.\n\noriginal commit is:\nhttps://github.com/yahoo/bookkeeper/commit/fecdb751\nYBK-14: Flush after writing out index\n\nAuthor: Jia Zhai <zhaijia@apache.org>\nAuthor: Robert (Bobby) Evans <evans@yahoo-inc.com>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1060 from jiazhai/cherry_picks/i_177\n","Date":"Fri Jan 26 18:20:00 CET 2018"},{"Commit-ID":"commit 92b5ef5d70594f9d6a76fc2c34e62925248f7327 1516987415 -----sp","Author":"PersonIdent[rdhabalia, rdhabalia@yahoo-inc.com, Fri Jan 26 18:23:35 2018 +0100]","Body":"[MERGE YAHOO REPO] Fix bookie-shell readJournal by reading from correct journal-directory\n\nDescriptions of the changes in this PR:\nThis is cherry-pick from yahoo repo of branch yahoo-4.3.\n\noriginal change is:\nhttps://github.com/yahoo/bookkeeper/commit/c426efea\nFix bookie-shell readJournal by reading from correct journal-directory\n\nAuthor: rdhabalia <rdhabalia@yahoo-inc.com>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1056 from jiazhai/cherry_picks/i_207\n","Date":"Fri Jan 26 18:23:35 CET 2018"},{"Commit-ID":"commit d06fad25d82a504bc46c906b5c23b5634567d543 1516993318 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jan 26 11:01:58 2018 -0800]","Body":"BP-26: Move the development of distributedlog library to bookkeeper\n\nDescriptions of the changes in this PR:\n\nThis is a BP proposing moving the development of distributedlog library to bookkeeper. See details in the BP file.\n\nMaster Issue: #1024\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Henry Saputra <hsaputra@apache.org>, Matteo Merli <mmerli@apache.org>, Dave Rusek <dave.rusek@gmail.com>, Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>, Yiming Zang <yzang2016@gmail.com>\n\nThis closes #1025 from sijie/bp_move_distributedlog\n","Date":"Fri Jan 26 20:01:58 CET 2018"},{"Commit-ID":"commit fdf74acfcbbc0c6198b1f5b10128cada079fc5b4 1516994693 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jan 26 11:24:53 2018 -0800]","Body":"Move distributedlog-common module\n","Date":"Fri Jan 26 20:24:53 CET 2018"},{"Commit-ID":"commit 0459390ec483f8080a5c74ce3586fb1b61578be0 1516994934 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jan 26 11:28:54 2018 -0800]","Body":"Merge branch 'master' of /Users/sijie/Workspaces/bookkeeper/../distributedlog_merge into copy_distributedlog\n","Date":"Fri Jan 26 20:28:54 CET 2018"},{"Commit-ID":"commit f74b328e2da5bf485c7d91f1d8434ac753c5007c 1516995284 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jan 26 11:34:44 2018 -0800]","Body":"Move distributedlog-protocol module\n","Date":"Fri Jan 26 20:34:44 CET 2018"},{"Commit-ID":"commit f6fcf82d5606eef77450854a3f6fe2343b343481 1516995324 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jan 26 11:35:24 2018 -0800]","Body":"Merge branch 'master' of /Users/sijie/Workspaces/bookkeeper/../distributedlog_merge into copy_distributedlog\n","Date":"Fri Jan 26 20:35:24 CET 2018"},{"Commit-ID":"commit 57da05e53916b5d4ef04feb8e7469acc40fb77fe 1516995521 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jan 26 11:38:41 2018 -0800]","Body":"Move distributedlog-core module\n","Date":"Fri Jan 26 20:38:41 CET 2018"},{"Commit-ID":"commit 7d4ee6c1465a45131cdb816f29b4385060552ef0 1516995546 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jan 26 11:39:06 2018 -0800]","Body":"Merge branch 'master' of /Users/sijie/Workspaces/bookkeeper/../distributedlog_merge into copy_distributedlog\n","Date":"Fri Jan 26 20:39:06 CET 2018"},{"Commit-ID":"commit d9f3961b4fbc41bc9d5074ec0f1866ccadc183bf 1516995737 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jan 26 11:42:17 2018 -0800]","Body":"Move distributedlog-io module\n","Date":"Fri Jan 26 20:42:17 CET 2018"},{"Commit-ID":"commit 9f016a055782ac7dccb2371909588543730d0e6b 1516995770 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jan 26 11:42:50 2018 -0800]","Body":"Merge branch 'master' of /Users/sijie/Workspaces/bookkeeper/../distributedlog_merge into copy_distributedlog\n","Date":"Fri Jan 26 20:42:50 CET 2018"},{"Commit-ID":"commit 76c1fd0d8ad1358fc8799d66b6ec7f242fd2ba71 1517131815 -----sp","Author":"PersonIdent[Kishore Udayashankar, kudayashankar@salesforce.com, Sun Jan 28 01:30:15 2018 -0800]","Body":"ISSUE #933: Add support for PEM Key file formats\n\n(bug W-4203319) TLS authentication to support PEM format X.509\ncertificates along with JKS and PKCS12 formats.\n\nAdded another KeyStore Type to the list of formats (JKS, PKCS12)\ncurrently supported during SSLContext creation.\n\nrev ayegorov\n\nSigned-off-by: Kishore Kasi Udayashankar <kudayashankarsalesforce.com>\n\nDescriptions of the changes in this PR:\n\n(PR description content here)...\n\nMaster Issue: #933\n\nAuthor: Kishore Udayashankar <kudayashankar@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #965 from kishorekasi/tls-pem, closes #933\n","Date":"Sun Jan 28 10:30:15 CET 2018"},{"Commit-ID":"commit 61b6a5f00abf0633f5e2310bcc81ccf2f2e188d4 1517132000 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Sun Jan 28 01:33:20 2018 -0800]","Body":"Move backward compat tests into their own java package\n\nMaster Issue: #1030\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1064 from ivankelly/bc-java-package\n","Date":"Sun Jan 28 10:33:20 CET 2018"},{"Commit-ID":"commit 8cc967c9e8dee2e9225075b4c615307389df0057 1517132066 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Sun Jan 28 01:34:26 2018 -0800]","Body":"ISSUE #1049: Add PERMITTED_STARTUP_USERS to limit bookie startup users\n\nStarting the bookie as the wrong user (such as root) can cause problems\nas the on disk files may end up with the wrong permissions.  Add\nPERMITTED_STARTUP_USERS to protect against this kind of operational\nerror.\n\n(bug W-3599751)\nSigned-off-by: Dustin Castor <dcastorsalesforce.com>\n[Adapted to current code]\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1065 from athanatos/forupstream/permitted-startup-users, closes #1049\n","Date":"Sun Jan 28 10:34:26 CET 2018"},{"Commit-ID":"commit d6f4aa080b4d0586edbdae4a55bb8816471dafc8 1517186257 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Jan 28 16:37:37 2018 -0800]","Body":"remove \"distributedlog_\" from module names\n","Date":"Mon Jan 29 01:37:37 CET 2018"},{"Commit-ID":"commit 5d749d7b8cb152e2b004e50c2a8e8c4c3e09903f 1517240557 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jan 29 07:42:37 2018 -0800]","Body":"repackage under `org.apache.bookkeeper`\n","Date":"Mon Jan 29 16:42:37 CET 2018"},{"Commit-ID":"commit e4a0798c1e6412f58fccabdd956151d81e16bd46 1517252980 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jan 29 11:09:40 2018 -0800]","Body":"Format the indent to 4 spaces (to align with bookkeeper coding style)\n","Date":"Mon Jan 29 20:09:40 CET 2018"},{"Commit-ID":"commit c8a3c25557ef4e4fc2cfb4a823f5ca5a9e224f11 1517266574 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Jan 29 14:56:14 2018 -0800]","Body":"Cleanup classloaders in backward-compat tests\n\nThe BC tests run in the maven process (for classloader reasons), so we\nneed to make sure we clean stuff up to avoid running out of memory, as\nthe classloaders will load a bunch of jars into memory.\n\nMaster Issue: #1030\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1070 from ivankelly/cleanup-cl\n","Date":"Mon Jan 29 23:56:14 CET 2018"},{"Commit-ID":"commit e62445f378575e42f02b1c721663be8995d631c3 1517276328 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Mon Jan 29 17:38:48 2018 -0800]","Body":"Remove OrderedBy annotation (#21)\n\n","Date":"Tue Jan 30 02:38:48 CET 2018"},{"Commit-ID":"commit d923c89e6596fcf8e2c7af3f2a4f51f1b418d4c9 1517278185 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia03@gmail.com, Mon Jan 29 18:09:45 2018 -0800]","Body":"Cleanup unused protobuf definitions (#22)\n\n","Date":"Tue Jan 30 03:09:45 CET 2018"},{"Commit-ID":"commit 1b3108a5fd480ef9cba092c9eb0a06ed452e402e 1517299469 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Tue Jan 30 09:04:29 2018 +0100]","Body":"Release notes for 4.6.1\n\nAuthor: eolivelli <eolivelli@apache.org>\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Matteo Merli <mmerli@apache.org>, Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #980 from eolivelli/releasenotes461\n","Date":"Tue Jan 30 09:04:29 CET 2018"},{"Commit-ID":"commit 36350c2bfaa6073991cf045486e618abdc32e28f 1517299967 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Tue Jan 30 09:12:47 2018 +0100]","Body":"Add release date for 4.6.1 to the website\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1080 from eolivelli/update-website-4.6.1\n","Date":"Tue Jan 30 09:12:47 CET 2018"},{"Commit-ID":"commit f3166dde6f0429be121110ee534a5574d136248a 1517341582 -----sp","Author":"PersonIdent[Kishore Udayashankar, kudayashankar@salesforce.com, Tue Jan 30 11:46:22 2018 -0800]","Body":"ISSUE #934: Additional stats to track netty latencies in PCBC\n\nDescriptions of the changes in this PR:\n\n(bug W-4058645) add metrics to measure netty stack latency\n- Counters to track outstanding reads/writes operations\n- Collect Netty IO rate and latency histograms\n\nrev ayegorov\n\nPerChannelBookieClient: add additional stats\n\nAdds:\n- exceptionCounter\n- connectTimer\n- addEntryOutstanding\n- readEntryOutstanding\n- nettyOpLogger\n\nSigned-off-by: Kishore Kasi Udayashankar<kudayashankarsalesforce.com>\n\nMaster Issue: #934\n\nAuthor: Kishore Udayashankar <kudayashankar@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #971 from kishorekasi/pcbc-stats, closes #934\n","Date":"Tue Jan 30 20:46:22 CET 2018"},{"Commit-ID":"commit f6af755fd7f5f53b3b5b743bf4f314bcfa8cc89a 1517341711 -----sp","Author":"PersonIdent[Robert Evans, evans@yahoo-inc.com, Tue Jan 30 11:48:31 2018 -0800]","Body":"[MERGE YAHOO REPO] YBK-154: Add sleep after finding free port given OS time to release it\n\nDescriptions of the changes in this PR:\nThis is cherry-pick from yahoo repo of branch yahoo-4.3.\n\noriginal change is:\nhttps://github.com/yahoo/bookkeeper/commit/40196007\nYBK-154: Addign sleep after finding free port so the OS has time to release it\n\nAuthor: Robert Evans <evans@yahoo-inc.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1055 from jiazhai/cherry_picks/ii_205\n","Date":"Tue Jan 30 20:48:31 CET 2018"},{"Commit-ID":"commit 1ea725d1755995a004f191b24bc6742e100a7899 1517342434 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Jan 30 12:00:34 2018 -0800]","Body":"URLDecode key/cert paths in TestTLS\n\nIn TestTLS we load keys/certs from the classpath, which means we get\nthe filename as a URL. Since it is a URL it is URL encoded for special\ncharacters. Usually this is not an issue, but in the case that there\nare special characters in the path, these will be encoded, and then\nwhen we try to open the file we get a FileNotFoundException. This\noccurs on jenkins, when there are two parallel builds on the same\njob (it adds a N to the workspace name), and was causing all TLS\ntests to fail in that case.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1074 from ivankelly/tls-fix\n","Date":"Tue Jan 30 21:00:34 CET 2018"},{"Commit-ID":"commit 47854b9234f612b2080decd4720cf3d1772f8455 1517342569 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Tue Jan 30 12:02:49 2018 -0800]","Body":"Fixing validation in BookieShell.scanEntryLogForSpecificEntry\n\nDescriptions of the changes in this PR:\n\nhttps://github.com/apache/bookkeeper/commit/086537beda9427c057a286ad6c4614659da6ed7f\nhas messed up conditional checks in BookieShell.scanEntryLogForSpecificEntry.\nReverting those changes.\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1076 from reddycharan/fixScanEntryLogForSpecificEntry\n","Date":"Tue Jan 30 21:02:49 CET 2018"},{"Commit-ID":"commit d5dffc48a4eda6178bd25610097f2e49763f2377 1517342670 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Tue Jan 30 12:04:30 2018 -0800]","Body":"ISSUE #1078: use CachingStatsProvider underly PrometheusMetricsProvider\n\nDescriptions of the changes in this PR:\n- add CachingStatsProvider to wrapper PrometheusMetricsProvider;\n- add test verify the cache.\n\nMaster Issue: #1078\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1081 from jiazhai/issue-1078, closes #1078\n","Date":"Tue Jan 30 21:04:30 CET 2018"},{"Commit-ID":"commit c2d53a4c1781360a4fb5635e91f7fe133475c160 1517342802 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Tue Jan 30 12:06:42 2018 -0800]","Body":"ISSUE #1079: use CachingStatsProvider underly FinagleStatsProvider\n\nDescriptions of the changes in this PR:\nuse CachingStatsProvider underly FinagleStatsProvider to avoid creating a lot of brand new object\n\nMaster Issue: #1079\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1082 from jiazhai/issue-1079, closes #1079\n","Date":"Tue Jan 30 21:06:42 CET 2018"},{"Commit-ID":"commit 422620e29b0d5b6d17dfb8e22afa78d57f26c68c 1517342905 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Jan 30 12:08:25 2018 -0800]","Body":"Test that old clients work with current server\n\nTest that old clients(4.2.0 onwards) can create, open, read, write ledgers on\nthe latest version of the server.\n\nMaster Issue: #903\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1083 from ivankelly/new-server-old-client\n","Date":"Tue Jan 30 21:08:25 CET 2018"},{"Commit-ID":"commit a7fcf36ccf7485e8d169776950102c8a31a513f8 1517343017 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Jan 30 12:10:17 2018 -0800]","Body":"Lombok doesn't work with groovy\n\nSo the Cleanup annotation does nothing. I've changed it in the BC\ntest to a traditional try {} finally {} since groovy doesn't do\ntry-with-resources either, and its equivalent doesn't do multiple\nobjects.\n\nMaster Issue: #903\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1084 from ivankelly/lombok-dont-work\n","Date":"Tue Jan 30 21:10:17 CET 2018"},{"Commit-ID":"commit 8a25353ac7354cab2c29ef83d40993c6176ac7a4 1517346884 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jan 30 13:14:44 2018 -0800]","Body":"Increase job timeout to 200 mins\n\nDescriptions of the changes in this PR:\n\nthe postcommit jobs have been timedout for a few days. This change is to increase the build timeout to get all jenkins job enough time to complete.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1089 from sijie/increase_job_timeout\n","Date":"Tue Jan 30 22:14:44 CET 2018"},{"Commit-ID":"commit 7ebf12b9d7a49d6a9b27dcd5d094516a1d4d0309 1517398262 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia03@gmail.com, Wed Jan 31 03:31:02 2018 -0800]","Body":" Remove `type` from StorageContainerRequest (#36)\n\n","Date":"Wed Jan 31 12:31:02 CET 2018"},{"Commit-ID":"commit 937de490b8e2df9ea0e247f15b481015afa21c54 1517425144 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jan 31 10:59:04 2018 -0800]","Body":"Merge remote-tracking branch 'apache/master' into copy_distributedlog\n","Date":"Wed Jan 31 19:59:04 CET 2018"},{"Commit-ID":"commit a7f3f20024c17f9c99de68952ec1f1d79adedb7a 1517425360 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jan 31 11:02:40 2018 -0800]","Body":"Merge branch 'master' into BP-26/distributedlog_merge\n","Date":"Wed Jan 31 20:02:40 CET 2018"},{"Commit-ID":"commit 02d6f1d52484f7d8d1b613f4956193d1ed5b4477 1517426015 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Wed Jan 31 11:13:35 2018 -0800]","Body":"ZkUtils.asyncDeleteFullPathOptimistic: pass -1 as znodeVersion to parents\n\nznodeVersion for the child won't necessarily match the parents.  This\nisn't really meaningful to test since the version of the internal nodes\nfor all current users will be 0, but fixing it at least will reduce\nconfusion\n\nSigned-off-by: Charan Reddy Guttapalem <cguttapalemsalesforce.com>\n[Adapted to current patch]\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1073 from athanatos/forupstream/misc/zkutilsfullpath\n","Date":"Wed Jan 31 20:13:35 CET 2018"},{"Commit-ID":"commit 5ed8768d9ab267111cf2eafcfd0b570b9ab9646c 1517426071 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Wed Jan 31 11:14:31 2018 -0800]","Body":"[MERGE YAHOO REPO] Support DbLedgerStorage in LedgerCmd to get list of logger files for a given ledgerId\n\nDescriptions of the changes in this PR:\nThis is cherry-pick from yahoo repo of branch yahoo-4.3.\n\noriginal change is:\nhttps://github.com/yahoo/bookkeeper/commit/384414b6\nSupport DbLedgerStorage in LedgerCmd to get list of logger files for a given ledgerId\n\nAuthor: Jia Zhai <zhaijia@apache.org>\nAuthor: Rajan <dhabalia.me@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1057 from jiazhai/cherry_picks/i_209\n","Date":"Wed Jan 31 20:14:31 CET 2018"},{"Commit-ID":"commit 125cda66931f344a071167b9dd8e21d18fabb79a 1517426193 -----sp","Author":"PersonIdent[Arvin, arvindevel@gmail.com, Wed Jan 31 11:16:33 2018 -0800]","Body":"ISSUE #611: restrict max ensemble change numbers\n\nDescriptions of the changes in this PR:\n\nAdd max ensemble change number check\n\nMaster Issue: #611\n\nAuthor: Arvin <arvindevel@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #925 from ArvinDevel/restrict_ensemble_num, closes #611\n","Date":"Wed Jan 31 20:16:33 CET 2018"},{"Commit-ID":"commit 5cd311c7bd72273e116533d0c438254b881dd653 1517433213 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jan 31 13:13:33 2018 -0800]","Body":"BP-26 (task-2): make distributedlog modules be able to be built in bookkeeper repo\n\nDescriptions of the changes in this PR:\n\nThis is the second sub-task of #1024. This change is based on [BP-26/distributedlog_merge](https://github.com/apache/bookkeeper/tree/BP-26/distributedlog_merge) branch (created at #1068).\n\nThis change includes:\n\n- move the findbugs.xml and checkstyle/suppression.xml from distributedlog-build-tools to bookkeeper buildtools module.\n- mockito: dlog is using mockito 1 while bk is using mockito 2. this change make dlog modules use the mockito dependencies defined at root pom.xml.\n- change the description from \"Apache DistributedLog\" to \"Apache BookKeeper :: DistributedLog\".\n- change the versions from `0.6.0-SNAPSHOT` to `4.7.0-SNAPSHOT`.\n- fix the compilation issues with current latest bk\n\nThis PR *DOESNT* change the group id of distributedlog modules. They will remain using \"org.apache.distributedlog\" as the group id.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Yiming Zang <yzang2016@gmail.com>\n\nThis closes #1069 from sijie/compile_distributedlog\n","Date":"Wed Jan 31 22:13:33 CET 2018"},{"Commit-ID":"commit 67018bd4b1e006f4d957a1f70a1c0e01b9ebb70b 1517512769 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Thu Feb 1 11:19:29 2018 -0800]","Body":"Dont log ledgermetadata which contains password.\n\nDescriptions of the changes in this PR:\n\nDont log ledgermetadata contains password used to create\nthe ledger. Logs are not supposed to reveal such sensitive info.\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1092 from reddycharan/fixpasswordlog\n","Date":"Thu Feb 01 20:19:29 CET 2018"},{"Commit-ID":"commit a226dbedff03102291648df3a60e78a2c85ae65f 1517512880 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Thu Feb 1 11:21:20 2018 -0800]","Body":"BP-14 Implementation of WriteFlag.DEFERRED_SYNC on Journal\n\nImplement WriteFlags.DERERRED_SYNC on Bookie side.\nIn case of DEFERRED_SYNC write Journal will early acknowledge the write, just after flushing the buffer to the OS cache, but before waiting for an fsync.\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #889 from eolivelli/bp14-writeflags-journal\n","Date":"Thu Feb 01 20:21:20 CET 2018"},{"Commit-ID":"commit 67e818a97bac9204699af8474f42159056d407b9 1517539079 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Feb 2 10:37:59 2018 +0800]","Body":"Issue #605: bk_server.conf wrong default logSizeLimit\n\nIt's commented out, but the value is invalid. This patch changes it to\nmatch the default in ServerConfiguration.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1105 from ivankelly/entry-log-size, closes #605\n","Date":"Fri Feb 02 03:37:59 CET 2018"},{"Commit-ID":"commit f83efd4fe6a4a32ffbccb49d1905d50e8013f15b 1517544690 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Feb 2 12:11:30 2018 +0800]","Body":"Run checkstyle plugin at validate phase\n\nDescriptions of the changes in this PR:\n\nMost of the modules run checkstyle plugin at validate phase. However a few modules are still running at `test-compile` phase.\nUpdate the checkstyle plugins in those modules to run at validate phase. So the behavior is consistent across the project.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1098 from sijie/run_checkstyle_at_validate_phase\n","Date":"Fri Feb 02 05:11:30 CET 2018"},{"Commit-ID":"commit 49b011b3ba4d71482bb50be72f69b505c697aad4 1517555473 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Feb 2 15:11:13 2018 +0800]","Body":"BP-27: New BookKeeper CLI\n\nDescriptions of the changes in this PR:\n\n`BookieShell` is the current bookkeeper cli for interacting and operating a bookkeeper cluster. However, this class is getting bigger with more commands added to it. It is facing a few problems for maintenance and extensibility.\n\n- All commands sit in one gaint shell class. It is hard to tell if a command is used for managing a bookie only or if a command is used for managing a cluster.\n- Lack of unit tests. This class has very few test coverage. Most of the commands (introduced in early days) don't have a unit test.\n- Lack of extensibility. If a new function component (for example, dlog) is introduced, it is a bit hard to extend this CLI to have commands for new function component.\n\nAll these problems lead to the proposal here. This proposal is to propose refactoring/redesigning the bookkeeper CLI to allow better managebility for maintenance, better test coverage and better extensibility for new function components.\n\nMaster Issue: #1000\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Jia Zhai <None>\n\nThis closes #1093 from sijie/BP_27_new_bookkeeper_cli\n","Date":"Fri Feb 02 08:11:13 CET 2018"},{"Commit-ID":"commit 9d09a9c2a64b745271ef1c6dad9e5ab3ab3f2a5c 1517617376 -----sp","Author":"PersonIdent[JV Jujjuri, vjujjuri@vjujjuri-ltm2.internal.salesforce.com, Fri Feb 2 16:22:56 2018 -0800]","Body":"ISSUE #1063: Write keeps refCnt longer\n\nDescriptions of the changes in this PR:\n\nCurrent code keeps the toSend buffers until client receives\nresonses from all wq bookies. From the senders perspective,\nIt is not required to keep the refcount on it at the PendingAddOp\nlevel, as the ref is taken at bookie client level.\n\nKeeping these buffers longer will increase the memory pressure\non the client.\n\nSigned-off-by: Venkateswararao Jujjuri (JV) <vjujjurisalesforce.com>\n\nMaster Issue: #1091\n\nAuthor: JV Jujjuri <vjujjuri@vjujjuri-ltm2.internal.salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1091 from jvrao/bookkeeper-1063, closes #1063\n","Date":"Sat Feb 03 01:22:56 CET 2018"},{"Commit-ID":"commit e6a2a13876fe676b8fcafa56c3568ea450ad5f67 1517617605 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Fri Feb 2 16:26:45 2018 -0800]","Body":"ISSUE #1067: PendingReadOp: recovery, return NoSuchEntry on wQ-aQ+1 errors\n\nIn the case of a recovery read, we rely on a NoSuchEntry response on the\nfirst missing entry to determine the final LAC.  As such, we need to\nconsider an entry to be gone once we see wQ-aQ+1 NoSuchEntry/Ledger\nresponses from bookies.  Otherwise, a zombie bookie can prevent ledger\nrecovery from suceeding indefinitely (it'll hit the timeout each time).\n\nThere was some preexisting logic from\nhttps://issues.apache.org/jira/browse/BOOKKEEPER-365\nb6c1a8bbd7c2d44c2edb59d9938fa073f6f478de,\nbut it seems to have been too conservative in that it waited for all\nresponses and required that there were no other errors present.  It\nseems now to be unnecessary, and so has been removed.\n\nTestParallelRead.testFailParallelReadMissingEntryImmediately seemed to\nrely on the previous logic working outside of recovery, but I believe it\nwas really meant to test the recovery case, so it has been adjusted.\n\n(bug W-4651456)\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Samuel Just <sjust@salesforce.com>, Ivan Kelly <ivank@apache.org>, Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1077 from athanatos/forupstream/wip-4651456-recovery-read, closes #1067\n","Date":"Sat Feb 03 01:26:45 CET 2018"},{"Commit-ID":"commit 0fbe8b767eaeb1c2d5d90946b3620a4e853a7284 1517617867 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Feb 2 16:31:07 2018 -0800]","Body":"BP-26 (task 3) : Build dlog shaded jar in bookkeeper way\n\nDescriptions of the changes in this PR:\n\n- discard dlog shaded artifacts and build `distributedlog-core-shaded` jar similar as `bookkeeper-server-shaded`\n- discard bookkeeper-server shaded artifact\n- move all shaded related tests to `tests/shaded`\n\nMaster Issue: #1024\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Dave Rusek <dave.rusek@gmail.com>, Jia Zhai <None>, Yiming Zang <yzang2016@gmail.com>\n\nThis closes #1095 from sijie/dlog_shade_jar\n","Date":"Sat Feb 03 01:31:07 CET 2018"},{"Commit-ID":"commit bb3ae067a34e017098bf43011982a335b2768b90 1517617936 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Feb 2 16:32:16 2018 -0800]","Body":"BP-26 (task 4): run dlog tests when pull requests modify dlog modules\n\nDescriptions of the changes in this PR:\n\n- enable dlog tests on all post commit CI jobs\n- for pull requests, only run dlog tests on travis CI and only when the pull requests modify dlog modules.\n\nMaster Issue: #1024\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Yiming Zang <yzang2016@gmail.com>, Jia Zhai <None>\n\nThis closes #1096 from sijie/enable_dlog_ci\n","Date":"Sat Feb 03 01:32:16 CET 2018"},{"Commit-ID":"commit ee2f419b77564cca2bfbf8efed2b0f4c4615d542 1517618052 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Fri Feb 2 16:34:12 2018 -0800]","Body":"Use loopback network interface for testcases.\n\nDescriptions of the changes in this PR:\n\n- tests would be more reliable irrespective of the environment (and availability of network connection), if the loopback address is used in testsuites.\n- unless loopback address is set explicitly, in my env (while on company's VPN),\nUpdateCookieCmdTest is failing most of the times.\n- currently allowLoopback is set to true in BookKeeperClusterTestCase,\nbut it doesn't make Bookies to use loopback interface address.\n- loopback network interface should be set explicitly as\nlistening interface to use loopback address.\n\nNote:\n\n1) will create Issue for this depending on the PR feedback.\n2) in other places (where setAllowLoopback is set) also loopback interface needs to be set\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Samuel Just <sjust@salesforce.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1097 from reddycharan/loopbackaddress\n","Date":"Sat Feb 03 01:34:12 CET 2018"},{"Commit-ID":"commit 908972c73be2743b3aaa369a6d97fff8e46295f8 1517618161 -----sp","Author":"PersonIdent[Luc Perkins, lucperkins@gmail.com, Fri Feb 2 16:36:01 2018 -0800]","Body":"Revamped downloads page\n\nThis PR addresses issue #1090 and significantly revamps the downloads page to bring it in line with Apache standards. It also makes some changes to the website's general setup and build process to make that process less brittle.\n\nAuthor: Luc Perkins <lucperkins@gmail.com>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1104 from lucperkins/lperkins/asf-compliance\n","Date":"Sat Feb 03 01:36:01 CET 2018"},{"Commit-ID":"commit 4107804e1fda6f1314dff64a74a7133ff1ec64e5 1517618236 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Feb 2 16:37:16 2018 -0800]","Body":"Update release schedule\n\nDescriptions of the changes in this PR:\n\n- update current feature release to 4.7.0 and its release window\n- add a section in release guide for instructions to update release schedule\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1112 from sijie/update_release_schedule\n","Date":"Sat Feb 03 01:37:16 CET 2018"},{"Commit-ID":"commit 65953ca2a93b95101071171598edfa1316b24834 1517636162 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Feb 2 21:36:02 2018 -0800]","Body":"Update PR template\n\nDescriptions of the changes in this PR:\n\n- JIRA is not used anymore. Remove it from PR template.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1111 from sijie/update_pr_template\n","Date":"Sat Feb 03 06:36:02 CET 2018"},{"Commit-ID":"commit 3ddc5db190b049f181ce7ae29ca34cbc7a7b7eb3 1517679061 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Feb 3 09:31:01 2018 -0800]","Body":"Change default ledger manager factory from `Flat` to `Hierachical`\n\nDescriptions of the changes in this PR:\n\nthe discussion can be found at : http://mail-archives.apache.org/mod_mbox/bookkeeper-dev/201802.mbox/%3CCAO2yDyYdZ8%3D4tViNX1uL0Z67KX78JPD2XBGd7ermjO%3DK%3DscvcQ%40mail.gmail.com%3E\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Yiming Zang <yzang2016@gmail.com>, Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1115 from sijie/flip_default_ledger_manager\n","Date":"Sat Feb 03 18:31:01 CET 2018"},{"Commit-ID":"commit 12869703b90a98a62e4c7692e289ea2ae73cf4b1 1517679145 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Feb 3 09:32:25 2018 -0800]","Body":"Cleanup registration client interface\n\nDescriptions of the changes in this PR:\n\nThis change is mainly to remove `zookeeper` reference from metadata interface. The existence of `Optional<ZooKeeper>` is to allow passing an external zookeeper client to bookkeeper, so bookkeeper can reuse that client instance. That is useful for services like pulsar broker, which they can only instantiate a zookeeper client and pass the zookeeper client around to construct bookkeeper client. However, this pollutes the registration client interface, change the method to `Optional<Object>` as an optional context object and let the implementation interpret it.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1116 from sijie/clean_registration_client_interface\n","Date":"Sat Feb 03 18:32:25 CET 2018"},{"Commit-ID":"commit 46340f9b1fa3eb59abdf502107e46af7b36d4a44 1517679194 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Feb 3 09:33:14 2018 -0800]","Body":"Travis CI should not use a hardcoded release version for check-release script\n\nDescriptions of the changes in this PR:\n\nCI is going to be broken when we bumped to 4.8.0.  since travis CI is using a hardcoded version for check-release script.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Jia Zhai <None>\n\nThis closes #1118 from sijie/fix_check_release_script\n","Date":"Sat Feb 03 18:33:14 CET 2018"},{"Commit-ID":"commit c754c8d7cc59947816d5ce8c7b458ae83652bc8b 1517795395 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia03@gmail.com, Sun Feb 4 17:49:55 2018 -0800]","Body":"Use the kv api defined in client for statelib (#37)\n\n* Consolidate statelib to use kv api\r\n\r\n* Add ToString\r\n","Date":"Mon Feb 05 02:49:55 CET 2018"},{"Commit-ID":"commit 3d81d3527126398f1a80003d13ef2dedc00ad9fd 1517805327 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Feb 4 20:35:27 2018 -0800]","Body":"Use BookieServer#getLocalAddress() in BookieClientTest\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Charan Reddy Guttapalem <reddycharan18@gmail.com>\n\nThis closes #1119 from sijie/fix_bookie_client_test\n","Date":"Mon Feb 05 05:35:27 CET 2018"},{"Commit-ID":"commit e92bcec2a71eed2aee9cfb6df3cc7b67bb079414 1517876109 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Mon Feb 5 16:15:09 2018 -0800]","Body":"Consolidate the protobuf definition used in state store and in client/service (#38)\n\nstate store and client/service were started as two different projects, and were doing in parallel. so there are some duplication and overlaps on defining the k/v operations.\r\nnow these two projects were put together, it would be good to consolidate the protobuf definition to have it only exist in one place.","Date":"Tue Feb 06 01:15:09 CET 2018"},{"Commit-ID":"commit fce92affe3a2ced4a180f905656b42f8de4c0c99 1517896805 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Mon Feb 5 22:00:05 2018 -0800]","Body":"Fix compilation warnings (#39)\n\n\r\n","Date":"Tue Feb 06 07:00:05 CET 2018"},{"Commit-ID":"commit 011bb652363b471e52e082cd9a13ff6a31375525 1517897566 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Feb 5 22:12:46 2018 -0800]","Body":"BP-29: Metadata API module\n\nDescriptions of the changes in this PR:\n\nRelated to BP-28 (#1113), this proposal is to propose how we want to organize the metadata modules, to support different metadata storage implementation.\n\nMaster Ticket: #1123\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1117 from sijie/BP-29-metadata-store-api\n","Date":"Tue Feb 06 07:12:46 CET 2018"},{"Commit-ID":"commit 062525cb70ff1c1f7cb53d8b197bc6be651deec7 1518186225 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Feb 9 15:23:45 2018 +0100]","Body":"Entry count parameters for BenchBookie\n\nSo that they can be added in the test, to make the test run faster and\nnot timeout in CI and ruin an otherwise good test run.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1136 from ivankelly/bench-flake\n","Date":"Fri Feb 09 15:23:45 CET 2018"},{"Commit-ID":"commit ccc4ed4989a0d3b1f55cec75556065f03de35d99 1518186355 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Feb 9 15:25:55 2018 +0100]","Body":"Remove spammy log messages in Journal\n\nLooks like they were put in while debugging and not cleaned up.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1134 from ivankelly/spam-log\n","Date":"Fri Feb 09 15:25:55 CET 2018"},{"Commit-ID":"commit e2b93f28813556c1971a04c1ffe4b65cbe40c427 1518231808 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Sat Feb 10 11:03:28 2018 +0800]","Body":"[MERGE YAHOO REPO] Only reorder read sequence if any bookie is not available\n\nDescriptions of the changes in this PR:\nThis is cherry-pick from yahoo repo of branch yahoo-4.3.\n\noriginal change is:\nhttps://github.com/yahoo/bookkeeper/commit/1ddd14a1\nOnly reorder read sequence if any bookie is not available\n\nAuthor: Jia Zhai <zhaijia@apache.org>\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1120 from jiazhai/cherry_picks/i_161\n","Date":"Sat Feb 10 04:03:28 CET 2018"},{"Commit-ID":"commit dcb22dddf5a7d97d7c320605facb142cc836c5fd 1518515514 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Tue Feb 13 10:51:54 2018 +0100]","Body":"Issue-1143 Error on Java 9 using BookKeeperAdmin API and bookkeeper-server-shaded\n\nUpdate Maven Shade Plugin to 3.1.0\n\nRelates to issue #1143\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1144 from eolivelli/fix/update-shade-plugin\n","Date":"Tue Feb 13 10:51:54 CET 2018"},{"Commit-ID":"commit eae32f6b667f0842897f4ca151cc7b7d31ef2e91 1518530972 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Feb 13 15:09:32 2018 +0100]","Body":"Fix test regression due to change in default ledger manager\n\nTestBenchmark#testReadThroughputLatency() regressed due to the change\nin 3ddc5db, where the default ledger manager was changed from flat to\nhierarchical.\n\nThe fix is to use flat for this test. I've also cleaned up the test a\nlittle, and added some code to the benchmark to make the test run\nfaster.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1137 from ivankelly/bench-broke\n","Date":"Tue Feb 13 15:09:32 CET 2018"},{"Commit-ID":"commit 21a89a7c486b842846ba9c15d6ec52d4486dd74c 1518540636 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Feb 13 17:50:36 2018 +0100]","Body":"Require green CI before merge\n\nCI has been broken since the 2018-02-06, due to a non-green patch\nbeing merged. With the recent flake fixes, CI should only go green if\nthere's a good reason. More over, any remaining problems will get\nfixed faster, if people non-green builds start being a pain for\npeople.\n\nSo, this patch blocks merging with the merge script, if all checks are\nnot green. It can be overriden by adding a comment with the text\n\"Ignore CI\" (case insensitive), on the PR.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Dave Rusek <dave.rusek@gmail.com>, Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1145 from ivankelly/require-green\n","Date":"Tue Feb 13 17:50:36 CET 2018"},{"Commit-ID":"commit 89eca5ce717a04c6e3ffa2b0aca615f4e38eafe3 1518540774 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Feb 13 17:52:54 2018 +0100]","Body":"Fix shutdown race which left ZK session open\n\nThere was a race when shutting down a bookie, where both the main\nthread and the shutdown hook thread would try to close the bookie\nservice. This would result in them racing to set the lifecycle state\nand neither would end up cleaning up properly. Specifically, the\nstarter latch would be counted down, so the main thread would start to\nclose, then the shutdown hook would run, try to close, and get an\nexception when it tried to change the state. Once the all shutdown\nhooks end, the process exits, even if main hasn't completed. This\nleaves the zookeeper session open.\n\nI've removed the close from main(). The shutdown hook always runs\non a graceful shutdown, so that's the place to do the cleanup.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1132 from ivankelly/shut-race\n","Date":"Tue Feb 13 17:52:54 CET 2018"},{"Commit-ID":"commit 7b3c79bcda4db92fc45fc40dfa3e9a96bf411011 1518621201 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Feb 14 16:13:21 2018 +0100]","Body":"Split all versions images into released and latest\n\nThe released tarballs rarely change, while the latest changes every\nbuild. This patch splits the all version image into a base images with\nthe released tarballs, and a image which includes all released and the\nvery latest tarball.\n\nThis allows the released image to be cached/pushed to dockerhub, which\nwill in turn allow us to speed up our CI builds that use the all\nversion image.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1131 from ivankelly/image-split\n","Date":"Wed Feb 14 16:13:21 CET 2018"},{"Commit-ID":"commit aff98f2033da143a259396e9369e58f35c4dec63 1518626137 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Feb 14 17:35:37 2018 +0100]","Body":"Gather disk information before CI build\n\nI suspect that we are getting quite a few flakes because of over-full\ndisks in the CI workers. I'd like to confirm this hypothesis and\ngather some information before taking corrective action.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1142 from ivankelly/df-on-build\n","Date":"Wed Feb 14 17:35:37 CET 2018"},{"Commit-ID":"commit 8bd6f0270fdb36de3c7b7e0bf92eb48d39bdf52e 1518631771 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Feb 15 02:09:31 2018 +0800]","Body":"Specify repo in MavenClassLoader\n\nThis is required for testing yahoo's custom bookkeeper client, as it\ndoesn't reside in maven central.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1135 from ivankelly/classloader-repo\n","Date":"Wed Feb 14 19:09:31 CET 2018"},{"Commit-ID":"commit 204a671a5cd8dc9633a4a4be92b0724c59ce4ae4 1518705729 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Feb 15 15:42:09 2018 +0100]","Body":"Integration smoke test\n\nMost basic integration test we can have.\n- Boots a cluster\n- Writes a ledger\n- Reads back the ledger\n- Shutdown the cluster\n\nIf this test fails, something is very wrong.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1133 from ivankelly/smoke-test\n","Date":"Thu Feb 15 15:42:09 CET 2018"},{"Commit-ID":"commit 427eb81a3d77f70db046b350f35dd4c5e68f9ac7 1518705806 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Feb 15 15:43:26 2018 +0100]","Body":"Include yahoo custom version in all versions image\n\nTo ensure compatibility between versions during the merge, we need the\nyahoo custom version of bookkeeper.\n\nThe most straightforward way to get this version is through\npulsar. It's distributed as part of the pulsar distribution, with\nscripts to start it and all.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1146 from ivankelly/yahoo-in-image\n","Date":"Thu Feb 15 15:43:26 CET 2018"},{"Commit-ID":"commit fa620b78fa595ad2c0054e3cb6147b707b1276cb 1518734436 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Feb 15 23:40:36 2018 +0100]","Body":"Upgrade arquillian-cube to latest version (0.15.1)\n\nThis gets rid of an ugly exception that the framework was throwing.\nhttps://github.com/arquillian/arquillian-cube/issues/957\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1150 from ivankelly/arq-upgrade\n","Date":"Thu Feb 15 23:40:36 CET 2018"},{"Commit-ID":"commit 1b8ad9cba38ba7ecbfbe3836c6db98a8b319e094 1518737253 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Feb 15 15:27:33 2018 -0800]","Body":"Replace DoubleByteBuf with CompositeByteBuf because of perf regression with Netty > 4.1.12\n\nStarting from Netty-4.1.13 some internal behavior has changed and that has introduced a performance penalty when using the `DoubleByteBuf`.\n\nThe problem resides in the fact that netty falls back to calling `nioBuffers()` and that is creating an array of unpooled direct `ByteBuffers`. That is pretty heavy and the JVM is taking 1 to 3 seconds GC pause to reclaim them.\n\nShort term fix is to go back to `CompositeByteBuf` which doesn't have the problem (the `DirectByteBuffer` instances are pooled and reused). I have verified that GC is back to normal after this patch.\n\nMore mid-term, since `CompositeByteBuf` allocates a bunch of objects (counted ~10 per entry) I have a change to replace it with a `ByteBufList` holder class. I have the change almost done but it will take a while to test it to verify corner cases.\n\nThis should be considered for a 4.6.2 fix release.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1108 from merlimat/composite-byte-buf-master\n","Date":"Fri Feb 16 00:27:33 CET 2018"},{"Commit-ID":"commit 4528248da8fd5b3b462afac8527098b6dd1032d0 1518770819 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Feb 16 09:46:59 2018 +0100]","Body":"Add script missing from custom yahoo docker image\n\n427eb81 references a script which I never added to the commit,\nwhich means the image doesn't build.\n\nThis commit adds the script.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1151 from ivankelly/missing-script\n","Date":"Fri Feb 16 09:46:59 CET 2018"},{"Commit-ID":"commit 5130f3b66b3235ffcc6e42c37a338ae853403d30 1518771033 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Feb 16 09:50:33 2018 +0100]","Body":"Run integration tests on precommit\n\nBuilds integration test docker images and runs all tests under tests/.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1148 from ivankelly/jenkins-bc2\n","Date":"Fri Feb 16 09:50:33 CET 2018"},{"Commit-ID":"commit c43d8c49fe212a5253c2dfc27c3c3b8c018c697a 1518798563 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Feb 17 00:29:23 2018 +0800]","Body":"Fix auditor shutdown logic and move decommision tests out of BookKeeperAdminTest\n\nDescriptions of the changes in this PR:\n\n- the auditor shutdown logic is problematic. most of the tests can finish quickly however it spend more 30 seconds on shutting down.\n  because the shutdown logic will be blocked until `awaitTermination` timed out.\n- most of the tests in BookKeeperAdminTest don't need 6 bookies. so move the decommission tests to a separate class.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Charan Reddy Guttapalem <reddycharan18@gmail.com>, Jia Zhai <None>\n\nThis closes #1099 from sijie/improve_admin_tests\n","Date":"Fri Feb 16 17:29:23 CET 2018"},{"Commit-ID":"commit 92866a49de755b4dc1e171e25d56ad25aaaa90d0 1518799192 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Sat Feb 17 00:39:52 2018 +0800]","Body":"[MERGE YAHOO REPO] AsyncReadLastEntry should trigger callback with error when ledger is empty\n\nDescriptions of the changes in this PR:\nThis is cherry-pick from yahoo repo of branch yahoo-4.3.\n\noriginal change is:\nhttps://github.com/yahoo/bookkeeper/commit/9560ab0f\nAsyncReadLastEntry should trigger callback with error when ledger is empty\n\nAuthor: Jia Zhai <zhaijia@apache.org>\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1121 from jiazhai/cherry_picks/i_167\n","Date":"Fri Feb 16 17:39:52 CET 2018"},{"Commit-ID":"commit 28de2a8d626f43eda39af00e452e3c12c98c5cba 1518800332 -----sp","Author":"PersonIdent[Kishor Patil, kpatil@yahoo-inc.com, Sat Feb 17 00:58:52 2018 +0800]","Body":"Issue #1124: Lower memory usage in GarbageCollectionThread while extracting all ledger meta data\n\nDescriptions of the changes in this PR:\n\nThe PR contains the fix to cleanup non-existent ledger log entries from EntryLogMetadata while extracting all log entries.\n\nMaster Issue: #1124\n\nAuthor: Kishor Patil <kpatil@yahoo-inc.com>\n\nReviewers: Yiming Zang <yzang2016@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1125 from kishorvpatil/gcThreadFix, closes #1124\n","Date":"Fri Feb 16 17:58:52 CET 2018"},{"Commit-ID":"commit 40c89198af603d94815711da40698399f8f16c75 1518800642 -----sp","Author":"PersonIdent[Kishore Udayashankar, kudayashankar@salesforce.com, Sat Feb 17 01:04:02 2018 +0800]","Body":"ISSUE #1109: Error out pending ops on TLS key mismatch exception\n\nDescriptions of the changes in this PR:\n\n(W-4479117)\n\n- Add Testcase to test certificate mismatch scenario\n- On tls handshake failure, replace future.get() with channel.\n- Print a warning message on exception caught in a netty context\non connection close, drain pendingOps\n\nrev charan\n\nMaster Issue: #1109\n\nAuthor: Kishore Udayashankar <kudayashankar@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1110 from kishorekasi/tls-keymismatch, closes #1109\n","Date":"Fri Feb 16 18:04:02 CET 2018"},{"Commit-ID":"commit 41afe22e4f5eaec2cfbcdc0187df9fc5e1db7070 1518800752 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Sat Feb 17 01:05:52 2018 +0800]","Body":"Install pulsar keys when installing yahoo custom image\n\nThe pulsar installation script for installing the yahoo custom version\nwas missing a line to import the keys needed to verify the tarball.\n\nThis patch adds the line, and also deletes the original version of the\nscript which was in the wrong location.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1158 from ivankelly/pulsar-script-again\n","Date":"Fri Feb 16 18:05:52 CET 2018"},{"Commit-ID":"commit 969e7292af5a1b4f26cc06c7cacd06b1746224f4 1518801748 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Feb 17 01:22:28 2018 +0800]","Body":"BP-27 (part 1): New BookKeeper CLI Skeleton\n\nDescriptions of the changes in this PR:\n\nThis is first implementation of BP-27 (#1000). This change includes:\n\n- introduce a bookkeeper-tools module for keep the commands and also for developing the new CLI\n- introduce 4 command groups: `cluster`, `bookie`, `client`, `metadata`.\n- move 3 command: `listbookies` under `cluster` group, `lastmark` under `bookie` group, `simpletest` under `client` group.\n- unit tests for those 3 command.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Charan Reddy Guttapalem <reddycharan18@gmail.com>, Yiming Zang <yzang2016@gmail.com>\n\nThis closes #1094 from sijie/bookie_shell_refactor\n","Date":"Fri Feb 16 18:22:28 CET 2018"},{"Commit-ID":"commit 86d3f619f75e27397b05ccaa70a0bfd88169035d 1518826292 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Feb 17 08:11:32 2018 +0800]","Body":"Fix the travis config on building dlog module\n\nDescriptions of the changes in this PR:\n\nThe original intention is building dlog module on 1) branches (non pull requests) 2) pull requests that modify dlog module. However the check logic was wrong in travis.yml. This change fixes the travis yml.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>\n\nThis closes #1154 from sijie/debug_travis\n","Date":"Sat Feb 17 01:11:32 CET 2018"},{"Commit-ID":"commit 4d47418a5bfc186385a1adadeff55e7b8b19fbe3 1518849373 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Feb 17 14:36:13 2018 +0800]","Body":"BP-29 (task 1) : Introduce `metadataServiceUrl`\n\nDescriptions of the changes in this PR:\n\n- introduce a new setting `metadataServiceUrl` for replacing implementation specific settings `zkServers` and `zkLedgersRootPath`.\n- introduce a metadata driver interface for managing all the metadata interface\n- introduce a metadata driver manager for resolving `metadataServiceUrl` and load specific metadata service url based on service scheme. This\n  would replace configuring multiple different manager classes using one single `metadataServiceUrl`.\n\nPlease NOTE: this change only introduce the new classes, but it doesn't change the client and bookie to use the new setting. It will be done in\na subsequent change.\n\nMaster Issue: #1123\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1127 from sijie/introduce_service_uri\n","Date":"Sat Feb 17 07:36:13 CET 2018"},{"Commit-ID":"commit 25f42432321afa5357647110ff554aeee7858560 1518849666 -----sp","Author":"PersonIdent[Govind Menon, govindappumenon@gmail.com, Sat Feb 17 14:41:06 2018 +0800]","Body":"[MERGE YAHOO REPO] YBK-160: Doing distributed random verification of ledger fragments\n\nDescriptions of the changes in this PR:\nThis is cherry-pick from yahoo repo of branch yahoo-4.3.\n\noriginal change is:\nhttps://github.com/yahoo/bookkeeper/commit/280e39ee\nhttps://github.com/yahoo/bookkeeper/commit/21c23ff1\nhttps://github.com/yahoo/bookkeeper/commit/b1139ac9\nYBK-160: Doing distributed random verification of ledger fragments\nYBK-160: Addressing Review comments and fixing test\nYBK-160: Doing verification only for stored entries\n\nAuthor: Govind Menon <govindappumenon@gmail.com>\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1085 from jiazhai/cherry_picks/i_230\n","Date":"Sat Feb 17 07:41:06 CET 2018"},{"Commit-ID":"commit 353ca1ddf941a9502e3ecd8fcc383fccfcd91c6f 1518851153 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Sat Feb 17 15:05:53 2018 +0800]","Body":"Call static methods and build callbacks in MavenClassLoader\n\nTo properly test some functionality we need to be able to call static\nmethods (e.g. for the creation of ByteBuf), and also to be able to\nbuild callbacks (e.g. to call async methods).\n\nThis patch implements methods for doing this. For static methods, you\nneed to pass the className, the method name and a list of\narguments. It first tries to find the method using non-primitive\ntypes, but falls back to trying primative types if possible.\n\nInvokation looks like:\n```\ncl.callStaticMethod(\"org.apache.bookkeeper.client.BKException\",\n                    \"create\", [-101])\n```\n\nFor callbacks you specify an interface and the a groovy closure.\nIt is assumed the closure will take as many arguments as the\ncallback. The invokation handler doesn't check the method name\ncalled on the callback object, so it only works with callbacks\nwith a single method.\n\nInvokation looks like:\n```\ndef callback = classLoader.createCallback(\n    \"org.apache.bookkeeper.client.AsyncCallback\\$AddCallback\",\n        { rc, _ledger, entryId, ctx ->\n            // do something\n        })\n```\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1156 from ivankelly/mvn-cl-adv\n","Date":"Sat Feb 17 08:05:53 CET 2018"},{"Commit-ID":"commit 10812a46097d72e7d445675a9360b42aa7c46f8c 1518853873 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Feb 17 15:51:13 2018 +0800]","Body":"handle zookeeper session expire in zk ledger manager\n\nDescriptions of the changes in this PR:\n\ncherry-pick twitter/bookkeeperdfcda5cc2efdc03db99fe126499f8e3347f50484\n\nThis includes a test case to test `AbstractZkLedgerManager`, including\n\n    1) create/delete/read/write ledger metadata\n    2) register/unregister listeners\n    3) handling various watched events\n\nThis also fixes a couple of cases in the `AbstractZkLedgerManager` what is caught with test case.\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Sijie Guo <sijieg@twitter.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1130 from sijie/fix_session_expires\n","Date":"Sat Feb 17 08:51:13 CET 2018"},{"Commit-ID":"commit 5aab8ae5ff4c06f8a471a8cab90b20e173776bf3 1518855139 -----sp","Author":"PersonIdent[JV, vjujjuri@salesforce.com, Sat Feb 17 16:12:19 2018 +0800]","Body":"ISSUE #1075: Add a noop digest implentation\n\nThis digest will add a predefined digest key without actually computing\nit. This can be used for testing or in situations/use-cases where digest\nis considered overhead.\n\n(bug W-3245776)\nSigned-off-by: Venkateswararao Jujjuri (JV) <vjujjurisalesforce.com>\n[Adapted to current patch]\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: JV <vjujjuri@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1087 from athanatos/forupstream/misc/dummy, closes #1075\n","Date":"Sat Feb 17 09:12:19 CET 2018"},{"Commit-ID":"commit f17b422f2474e436ab7722dca16b778aa626f8ca 1518943472 -----sp","Author":"PersonIdent[JV, vjujjuri@salesforce.com, Sun Feb 18 00:44:32 2018 -0800]","Body":"ISSUE #966: Expose quorum write complete latency to the client\n\nAdd quorum write complete latency to the bookkeeper client API. This\nallows callers to find out exactly how long the quorum write took for\ndiagnostic purposes.\n\n(bug W-3616193)\nSigned-off-by: Venkateswararao Jujjuri (JV) <vjujjurisalesforce.com>\n[Fixed merge conflicts, added testing]\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: JV <vjujjuri@salesforce.com>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #970 from athanatos/forupstream/stats1/qlatency, closes #966\n","Date":"Sun Feb 18 09:44:32 CET 2018"},{"Commit-ID":"commit 5203d03930356a322f301e8e72a052ce1972adaa 1518944016 -----sp","Author":"PersonIdent[JV Jujjuri, vjujjuri@salesforce.com, Sun Feb 18 00:53:36 2018 -0800]","Body":"Issue #1152: stats for durability violations in write/read path\n\nDescriptions of the changes in this PR:\n\nDurability contract demands that there are WQ copies spread\nacross fault zones as per the ensemble placement policy.\nThere are lots of areas where this contract is violated.\n\nAdd stats to track two areas that are well:\na. Write Path: if the write fails after satisfying AQ\nb. Read Path: If the checksum error is detected on the read path\n\nSigned-off-by: Venkateswararao Jujjuri (JV) <vjujjurisalesforce.com>\n\nMaster Issue: #1152\n\nAuthor: JV Jujjuri <vjujjuri@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1155 from jvrao/bk-ssue-1152-stats-1, closes #1152\n","Date":"Sun Feb 18 09:53:36 CET 2018"},{"Commit-ID":"commit df71247a8c9644bbeda7d18d833fde4bef88fb3d 1518955700 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sun Feb 18 04:08:20 2018 -0800]","Body":"Replace DoubleByteBuf with ByteBufList\n\nThis PR aims at a better approach to fix the issue reported in #1108\n\nInstead of using `CompositeByteBuf` which has the downside of needing multiple object allocations per each usage (~7-8), we should have a way to aggregate multiple buffers into a single \"logical\" frame with no additional overhead.\n\nThis PR introduces a `ByteBufList` class which is just a holder of a list of buffers, without imitating the `ByteBuf` API. You can pass a `ByteBufList` to the channel and have the encoder take care of the multiple writes.\n\nInstances of ByteBufList are ref-counted and released to a pool after the write is completed. There are no object allocations or memory copies involved.\n\nAuthor: Matteo Merli <mmerli@apache.org>\nAuthor: Sijie Guo <guosijie@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1141 from merlimat/bytebuf-list-master\n","Date":"Sun Feb 18 13:08:20 CET 2018"},{"Commit-ID":"commit 7945fcf79652001f825ffade40a4215f68465403 1519024265 -----sp","Author":"PersonIdent[Pasha Kuznetsov, pkuznetsov@salesforce.com, Sun Feb 18 23:11:05 2018 -0800]","Body":"Issue #1169 Upgrade Surefire plugin to 2.20.1\n\n**Context**\n\nWe at Salesforce have been experiencing a series of hard to nail down test failures related to some of our changes causing Bookkeeper tests occasionally hanging up until they were terminated by Maven / Surefire. What's been making it harder to figure out was that the issue was only reproducing on Jenkins, not locally, and the lack of thread dumps along with Surefire failing to produce reports for these tests, making them next to invisible in Jenkins output.\n\n**Related**\n\nIssue #463 / PR #481 changes help terminate tests hanging in `Before` or `After` by changing `Test` based \"local\" timeouts to `Rule` based \"global\" ones.\n\n**Proposed changes**\n\nUpgrade Surefire plugin to 2.20.1 which has a few related [fixes and improvements since 2.19.1](https://issues.apache.org/jira/browse/SUREFIRE-1413?jql=project%20%3D%20SUREFIRE%20AND%20fixVersion%20in%20(2.20%2C%202.20.1)):\n* [SUREFIRE-1322](https://issues.apache.org/jira/browse/SUREFIRE-1322) Surefire and Failsafe should dump critical errors in dump file and console\n* [SUREFIRE-1435](https://issues.apache.org/jira/browse/SUREFIRE-1435) Improve Thread Dump\netc\n\n(bug W-4700391)\n\nAuthor: Pasha Kuznetsov <pkuznetsov@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1170 from pasha-kuznetsov/issue-1169-surefire-2-20-1, closes #1169\n","Date":"Mon Feb 19 08:11:05 CET 2018"},{"Commit-ID":"commit 9f6c7da19eef89e248a4b2ffa82d9c2a08789270 1519024640 -----sp","Author":"PersonIdent[JV Jujjuri, vjujjuri@salesforce.com, Sun Feb 18 23:17:20 2018 -0800]","Body":"ISSUE #1162: Test for unsetSuccessAndSendWriteRequest with LedgerHandleAdv\n\nDescriptions of the changes in this PR:\n\nAdd a test case to verify unsetSuccessAndSendWriteRequest with\nLedgerHandleAdv out of order writers which forces ensemble change.\n\nSigned-off-by: Venkateswararao Jujjuri (JV) <vjujjurisalesforce.com>\n\nMaster Issue: #1162\n\nAuthor: JV Jujjuri <vjujjuri@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1163 from jvrao/bk-issue-1162-test1, closes #1162\n","Date":"Mon Feb 19 08:17:20 CET 2018"},{"Commit-ID":"commit 546eed4913e148a8a4f075ee412d1abe28398ffa 1519026858 -----sp","Author":"PersonIdent[JV Jujjuri, vjujjuri@salesforce.com, Sun Feb 18 23:54:18 2018 -0800]","Body":"ISSUE #1139: Add debug to replication fencing\n\nDescriptions of the changes in this PR:\n\nWhen ledger is fenced, the client may get write error.\nNot having enough logging in this area making debugging harder.\nOptimised the code in addition to adding more logging in this area.\n\nSigned-off-by: Venkateswararao Jujjuri (JV) <vjujjurisalesforce.com>\n\nMaster Issue: #1139\n\nAuthor: JV Jujjuri <vjujjuri@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1140 from jvrao/bk-issue-1139, closes #1139\n","Date":"Mon Feb 19 08:54:18 CET 2018"},{"Commit-ID":"commit fa10b7dcd89c40222ba5f30bb60f785bd21669b2 1519027853 -----sp","Author":"PersonIdent[Kishore Udayashankar, kudayashankar@salesforce.com, Mon Feb 19 00:10:53 2018 -0800]","Body":"ISSUE #1103: Add channel TLS counters\n\n(bug W-4482570)\n\nAdd counters to track\n- active TLS\n- active non-TLS channel connections\n- failed TLS handshakes\n- failed connections\n\nAlso,\nAdded tests to verify counters\nDrain pendingOps on TLS handshake failure\n\nMaster Issue: #1103\n\nAuthor: Kishore Udayashankar <kudayashankar@salesforce.com>\nAuthor: kishorekasi <kkasiud1@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1106 from kishorekasi/tls-stats, closes #1103\n","Date":"Mon Feb 19 09:10:53 CET 2018"},{"Commit-ID":"commit 1329ec09f2024dc52d8b772e4ee70d9a9cdcfd0d 1519028308 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Feb 19 00:18:28 2018 -0800]","Body":"BP-29 (task 2) : Make LedgerManagerFactory a pure interface\n\nDescriptions of the changes in this PR:\n\n    The logic in LedgerManagerFactory#newLedgerManagerFactory is effectively the logic works for zookeeper based implementation.\n    In order to produce a clean metadata api, this change is moving this logic to AbstractZkLedgerManagerFactory.\n\nMaster Issue: #1123\n\nThis change is based on #1127. Only the second commit ce35173 is to review in this PR.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1128 from sijie/make_ledger_manager_factory_interface\n","Date":"Mon Feb 19 09:18:28 CET 2018"},{"Commit-ID":"commit 6e5210c29d2059e4ef7335b9dbae4bd83f9c26c2 1519034826 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Feb 19 02:07:06 2018 -0800]","Body":"Cleanup - remove writer api from table\n","Date":"Mon Feb 19 11:07:06 CET 2018"},{"Commit-ID":"commit 1807b1679c339bf650231c584a6a417264fadcac 1519035297 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Feb 19 02:14:57 2018 -0800]","Body":"Cleanup - remove `ByteBufUtils`\n\n`ByteBufUtils` is a duplication of netty `ByteBufUtil`.\n","Date":"Mon Feb 19 11:14:57 CET 2018"},{"Commit-ID":"commit d4277c06f62f680dba9383e68c0699c343e4e5ca 1519071505 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Feb 19 21:18:25 2018 +0100]","Body":"Cleanup threads from old clients in BC tests\n\nSome old clients don't clean up their threads correctly. This patch\nintroduces a thread reaper, which will check if a test has left any\nthreads running, and try to clean them up if they have.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1177 from ivankelly/thread-reaper\n","Date":"Mon Feb 19 21:18:25 CET 2018"},{"Commit-ID":"commit b24c986cd5a8057edb2c75f652ceec9feeef234c 1519077581 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Feb 19 13:59:41 2018 -0800]","Body":"Introduce \"IGNORE IT CI\" to ignore integration tests ci result\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nIntegration tests ci is not very reliable at this moment. so most of the time we have to \"IGNORE CI\" to allow changes\nto be merged. However \"IGNORE CI\" is a bit too ambiguous, which can potentially ignore other CI results.\n\n*Solution*\n\nThis change introduces \"IGNORE IT CI\" to ignore integration tests ci results only.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1173 from sijie/ignore_integration_tests\n","Date":"Mon Feb 19 22:59:41 CET 2018"},{"Commit-ID":"commit 2f0f6d1b977fbb532f9558242dc0255dd4ba1cb2 1519081142 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Mon Feb 19 14:59:02 2018 -0800]","Body":"Cleanup - remove unneeded test cases (#40)\n\nThis fixes #34","Date":"Mon Feb 19 23:59:02 CET 2018"},{"Commit-ID":"commit 32bd02a5771bfdb56b348dec54ec463c51cfedb6 1519081155 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Mon Feb 19 14:59:15 2018 -0800]","Body":"Introduce IncrementOption to support `incrementAndGet` (#41)\n\n","Date":"Mon Feb 19 23:59:15 CET 2018"},{"Commit-ID":"commit 85554309046597982ab649782e5a39f93de1e892 1519083781 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Feb 19 15:43:01 2018 -0800]","Body":"Use travis_wait on running mvn test on travis\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nThe travis build can take more than 30 minutes, which exceeds the default limit. so the travis builds on master usually fail\n\n*Solution*\n\nConfigure the travis build to use `travis_wait` and configure a higher timeout value.\n\nThis was set in dlog travis build : https://github.com/apache/distributedlog/blob/master/.travis.yml#L41\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1174 from sijie/use_tick_toc\n","Date":"Tue Feb 20 00:43:01 CET 2018"},{"Commit-ID":"commit 2a519586f616541182bafa0b135d4f6a04be4fba 1519083852 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Feb 19 15:44:12 2018 -0800]","Body":"Create a forked JVM for each bc test\n\nUntil now, BC tests have been running in the maven processes because\nthey do funny stuff with the classloader which didn't seem to work\nwith later versions of the surefire plugin. However, using a version\nof surefire less than or equal to 2.8.1, we can use\nuseSystemClassLoader to the same effect, and therefore fork a JVM for\neach test. This is desirable to isolate the tests from each other.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1175 from ivankelly/branch-per-bc-test\n","Date":"Tue Feb 20 00:44:12 CET 2018"},{"Commit-ID":"commit 7a8b22fb9f2cb0def631a0769a78968920229f7b 1519084076 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Feb 19 15:47:56 2018 -0800]","Body":"Handle for 4.6.0 and 4.6.1 specially in bc test shutdown\n\nThere is a race in 4.6.0 and 4.6.1 which can cause the zk session to\nbe leaked. The bc test should take this into account, and wait for the\nsession for expire before continuing.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1179 from ivankelly/wait-longer\n","Date":"Tue Feb 20 00:47:56 CET 2018"},{"Commit-ID":"commit b321d46a2a2719045d60b990e2bdcbd6c3c2937d 1519084183 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Feb 19 15:49:43 2018 -0800]","Body":"Fix name on smoke test in pom\n\nIt says backwards compat, should be integration\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1178 from ivankelly/smoke-test-name\n","Date":"Tue Feb 20 00:49:43 CET 2018"},{"Commit-ID":"commit 8c10e56db285788eeb17a4290a417a0745114a77 1519093563 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Feb 19 18:26:03 2018 -0800]","Body":"V2 decoder marks the reads index of the payload on write\n\nThis means that any storage implementation that receives that payload,\ncan reset the reader index, without jumping into bytes it knows\nnothing about.\n\nThis was the source of an issue when using V2 protocol with\nDbLedgerStorage where the data could not be successfully read back\nfrom the ledger.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1180 from ivankelly/broken-v2-rocks\n","Date":"Tue Feb 20 03:26:03 CET 2018"},{"Commit-ID":"commit 64e86868e8f887e3ffdb47c3955b90c19c124407 1519101051 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Feb 19 20:30:51 2018 -0800]","Body":"Enforce zkAcls on initNewCluster\n\nDescriptions of the changes in this PR:\n\ninitNewCluster was introduced #979. The new command doesn't honor to zookeeper acls settings. This change is to change those zookeeper calls to use `zkAcls`.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Charan Reddy Guttapalem <reddycharan18@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1171 from sijie/enforce_acls\n","Date":"Tue Feb 20 05:30:51 CET 2018"},{"Commit-ID":"commit cbb5ad555292d699e1fb2829cba46b9a7b69a7d8 1519101144 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Feb 19 20:32:24 2018 -0800]","Body":"Use BookieServer#getLocalAddress as the identifier in the test\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nIssue #1097 introduced using `loopback` nic as the bookie server identifier. However a few test cases construct the bookie socket address using `InetAddress.getLocalHost()` and the bookie port. This bookie socket address can be different from the actual socket address that a bookie is advertising to zookeeper. It will cause test cases fail with certain network settings.\n\n*Solution*\n\nThis change use `BookieServer#getLocalAddress()` to retrieve the actual bookie socket address. so it would respect to the server configuration and use the right socket address in the test.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Charan Reddy Guttapalem <reddycharan18@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1172 from sijie/use_bookie_server_get_local_address\n","Date":"Tue Feb 20 05:32:24 CET 2018"},{"Commit-ID":"commit 0c9f152336e8af012589b713242e46f475f7055d 1519106116 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Feb 19 21:55:16 2018 -0800]","Body":"Cleanup client correctly in TestCompatOldClients#testFencingOldClient\n\nPreviously we had been mistakenly cleaning up the classloader twice.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1176 from ivankelly/kill-client-bc-test\n","Date":"Tue Feb 20 06:55:16 CET 2018"},{"Commit-ID":"commit d8adde373f3d0a9a6831992003b1d0048d7285d2 1519108221 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Feb 19 22:30:21 2018 -0800]","Body":"MockBookKeeperTestCase failed on casting ByteBufList\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nIssue #1141 introduces ByteBufList. But `MockBookKeeperTestCase` still assumes `ByteBuf`. So it fails somes test cases\nthat use `MockBookKeeperTestCase`\n\n*Solution*\n\nFix `MockBookKeeperTestCase` to expect `ByteBufList` instead of `ByteBuf`.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nThis closes #1182 from sijie/fix_mock_bookkeeper_test_case\n","Date":"Tue Feb 20 07:30:21 CET 2018"},{"Commit-ID":"commit e3608d2a84d9d1606df9f136738d4106207fe1b3 1519114785 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Tue Feb 20 00:19:45 2018 -0800]","Body":"Bump bk/dl version to 4.7.0-SNAPSHOT (#42)\n\n","Date":"Tue Feb 20 09:19:45 CET 2018"},{"Commit-ID":"commit 5254818f0c7e01c24728c1f7e1e31f29b636942f 1519117628 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Tue Feb 20 01:07:08 2018 -0800]","Body":"Update readme (#43)\n\n- update readme\r\n- fix the classpath in scripts","Date":"Tue Feb 20 10:07:08 CET 2018"},{"Commit-ID":"commit b6558ff827835598bec90da5592e90ed0bac4ab1 1519117696 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Feb 20 01:08:16 2018 -0800]","Body":"Fix type in README\n","Date":"Tue Feb 20 10:08:16 CET 2018"},{"Commit-ID":"commit 7584b1b4809e961c90b400912cfd08f7f45f3bfb 1519121372 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Feb 20 02:09:32 2018 -0800]","Body":"Fix flaky travis build on checking license header\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nIn some environments, `BK_VERSION` is computed as `Downloading`, which is not a valid bookkeeper version. It fails the `dev/check-binary-license` script.\n\n```\n[0K$ if [ \"$TRAVIS_OS_NAME\" == \"linux\" ]; then dev/check-binary-license ./bookkeeper-dist/server/target/bookkeeper-server-${BK_VERSION}-bin.tar.gz; fi\ntar: ./bookkeeper-dist/server/target/bookkeeper-server-Downloading: Cannot open: No such file or directory\ntar: Error is not recoverable: exiting now\ntar: ./bookkeeper-dist/server/target/bookkeeper-server-Downloading: Cannot open: No such file or directory\ntar: Error is not recoverable: exiting now\ntar: ./bookkeeper-dist/server/target/bookkeeper-server-Downloading: Cannot open: No such file or directory\ntar: Error is not recoverable: exiting now\n```\n\n*Solution*\n\nRemove this `BK_VERSION` setting and use \"*\" in the file path.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>\n\nThis closes #1183 from sijie/address_travis_yml\n","Date":"Tue Feb 20 11:09:32 CET 2018"},{"Commit-ID":"commit b80b72e046adce3e4e74ebbeda595dc4b4e920c2 1519121907 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Feb 20 02:18:27 2018 -0800]","Body":"Allow to disable LZ4 compression in KeyValueStorageRocksDB\n\nIn some environments (eg: windows), LZ4 is not statically linked with the RocksDB JNI library bundled in the jar. In this cases we need to allow to disable LZ4 compression on the SST tables.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1181 from merlimat/allow-disabling-lz4-in-rocksdb\n","Date":"Tue Feb 20 11:18:27 CET 2018"},{"Commit-ID":"commit c106859d5a756768fc44738b2b1c60b1743909f5 1519122029 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Feb 20 02:20:29 2018 -0800]","Body":"ISSUE #1166: Create `readonly` path for LocalBookKeeper and BookKeeperClusterTestCase\n\nDescriptions of the changes in this PR:\n\nThis fixes #1166\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Sijie Guo <guosijie@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1167 from sijie/create_readonly_znode, closes #1166\n","Date":"Tue Feb 20 11:20:29 CET 2018"},{"Commit-ID":"commit 245f0c03cdfca0c5cc2ae1aeab3d22765ec3fad0 1519129984 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Feb 20 13:33:04 2018 +0100]","Body":"Prune networks from previous runs before IT\n\nIf a build fails, it can leave networks around. Run prune before the\nintegration tests to avoid this.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1184 from ivankelly/prune-networks\n","Date":"Tue Feb 20 13:33:04 CET 2018"},{"Commit-ID":"commit 9eb16c500db2db366851aed1f7b8afac2fc2ca0b 1519133219 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Feb 20 14:26:59 2018 +0100]","Body":"Disable tests reruns on dev profile\n\nSometimes you don't want the rerun because you _want_ to see the flake.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1149 from ivankelly/dev-rerun\n","Date":"Tue Feb 20 14:26:59 CET 2018"},{"Commit-ID":"commit e5af4a20f240f38c8ce712a5e3bba4976eb89a41 1519146474 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Feb 20 18:07:54 2018 +0100]","Body":"Allow default methods in MavenClassloader callbacks\n\nAsyncCallback.AddCallback has recently acquired a default method,\nwhich breaks the assumption that there is only one method on these\ncallbacks. However, if does have a default method that calls the one\nmethod. This patch takes advantage of that to allow us to use\nAddCallback in tests.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1187 from ivankelly/groovy-callback-default\n","Date":"Tue Feb 20 18:07:54 CET 2018"},{"Commit-ID":"commit 13dc9230e79c0ecbc30b8b804e506b978c3f9cb1 1519152141 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Feb 20 10:42:21 2018 -0800]","Body":"Propogate exception when bookie shutdown fails\n\nWhen a bookie fails to shutdown cleanly, we should propogate the\nexception that caused the problem to the main thread.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1186 from ivankelly/prop-ex\n","Date":"Tue Feb 20 19:42:21 CET 2018"},{"Commit-ID":"commit 9db6e919b023c9e3833c51b34c83d6c482b1e659 1519155462 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Feb 20 11:37:42 2018 -0800]","Body":"Issue #1164: TestTruncate#testPurgeLogs is flaky\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nlog segments are truncated in the background after TTL. the truncation is done asynchronously.\nso when we finish writing all the log records, the truncation might still not complete yet.\n\n*Solution*\n\nImprove the test case to wait until the last truncation attempt is completed before asserting the log segments\n\nMaster Issue: #1164\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1165 from sijie/fix_test_truncate, closes #1164\n","Date":"Tue Feb 20 20:37:42 CET 2018"},{"Commit-ID":"commit 2328569d868368530474de9105d1ef17ffdef790 1519155541 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Feb 20 11:39:01 2018 -0800]","Body":"Test that we don't break compat with Yahoo custom version\n\nWe've been merging a lot of changes from yahoo's internal bookkeeper\nfork in the past months. The plan is that once everything is in, yahoo\nwill move to using stock opensource bookkeeper. We need to ensure that\nthis move goes smoothly, otherwise they wouldn't move. So this set of\ntests checks whether master will work with what they are running\ninternally.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1190 from ivankelly/yahoo-bc\n","Date":"Tue Feb 20 20:39:01 CET 2018"},{"Commit-ID":"commit 979de4b17b9ed9e734b8973cb211d9754c0788d1 1519155667 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Feb 20 11:41:07 2018 -0800]","Body":"Always reset interrupted state after catching InterruptedException\n\nThere's many places we did not do it. I've added it.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1189 from ivankelly/interrupt-thread\n","Date":"Tue Feb 20 20:41:07 CET 2018"},{"Commit-ID":"commit 1f7bf2d5f8338476bfe868953f419bc39dc3052e 1519205400 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Wed Feb 21 01:30:00 2018 -0800]","Body":"Dump config\n\nDescriptions of the changes in this PR:\n\nDump config\n- add utility method to AbstractConfiguration to return config as string and log it\n- dump the config during the start of the BookieServer\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1160 from reddycharan/dumpconfig\n","Date":"Wed Feb 21 10:30:00 CET 2018"},{"Commit-ID":"commit f76041b9c81c3856843ce04b09ed39c14fe8c274 1519255576 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Feb 21 15:26:16 2018 -0800]","Body":"Fix GSSAPIBookKeeperTest\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nin GSSAPIBookKeeperTest, `InetAddress.getLocalHost().getHostName()` was used for adding principle to kdc keytab. However in the tests, it uses advertisedAddress (introduced by #1097).\n\nSo it causes authentication failed because server can't be found.\n\n*Solution*\n\nChange to use `Bookie. getBookieAddress(..)` to get the real hostname used by bookie for adding keytab entries.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Charan Reddy Guttapalem <reddycharan18@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1191 from sijie/fix_gssapibookkeeper_test\n","Date":"Thu Feb 22 00:26:16 CET 2018"},{"Commit-ID":"commit f70f034340dbfaaaeadd31ae7acc4f42b6517124 1519291296 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Feb 22 01:21:36 2018 -0800]","Body":"Update committers list\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1198 from sijie/add_new_committers\n","Date":"Thu Feb 22 10:21:36 CET 2018"},{"Commit-ID":"commit cb0c034f8e2e77ad41246a2952463cd7e3b55d6c 1519372952 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Fri Feb 23 00:02:32 2018 -0800]","Body":"Provide default values for LedgerIdFormatter and EntryFormatter\n\nDescriptions of the changes in this PR:\n\nProvide default values for LedgerIdFormatter and EntryFormatter.\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1199 from reddycharan/defaultformatter\n","Date":"Fri Feb 23 09:02:32 CET 2018"},{"Commit-ID":"commit bd69dbdb8d651d6ae482c0bb02e927b3a89fc796 1519377629 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Fri Feb 23 01:20:29 2018 -0800]","Body":"Upgrade JaCoCo and fix code coverage build system\n\n- Upgrade JaCoCo to version 0.8.0 which supports Java 9\n- Exclude generated sources from the NAR-plugin files\n- Update surefire configuration in order to not fail the build while using -Pcode-coverage\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\nAuthor: eolivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1129 from eolivelli/code-coverage-2\n","Date":"Fri Feb 23 10:20:29 CET 2018"},{"Commit-ID":"commit 34e6c7c44d8ed0011ca62b2eeedce18fa13dae29 1519383335 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Feb 23 02:55:35 2018 -0800]","Body":"Fix LifecycleComponentStarter\n","Date":"Fri Feb 23 11:55:35 CET 2018"},{"Commit-ID":"commit 547e017fe4f0bdc55e0a2e7628fad4656429d097 1519633162 -----sp","Author":"PersonIdent[eolivelli, eolivelli@apache.org, Mon Feb 26 00:19:22 2018 -0800]","Body":"Add Jenkins Configuration for Code Coverage nightly test\n\nAdd a job using Jenkins DSL to run every night a JaCoCo code coverage report which runs tests and sends the report to Coveralls.io\n\nAuthor: eolivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1203 from eolivelli/code-coverage-dsl\n","Date":"Mon Feb 26 09:19:22 CET 2018"},{"Commit-ID":"commit 8f6373e60fd77f3c6253657b5eff9b970a0d2143 1519633390 -----sp","Author":"PersonIdent[JV Jujjuri, vjujjuri@salesforce.com, Mon Feb 26 00:23:10 2018 -0800]","Body":"Issue #1195 Handle optional fields gracefully in ReadExplicitLac response\n\nDescriptions of the changes in this PR:\n\nExplicitLac and header of the last entry are optional fields in the protocol.\nHandle them as optionals in the response processing.\n\nTestPendingReadLacOp.java test added by: Samuel Just <sjustsalesforce.com>\n\nSigned-off-by: Venkateswararao Jujjuri (JV) <vjujjurisalesforce.com>\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nMaster Issue: #1195\n\nAuthor: JV Jujjuri <vjujjuri@salesforce.com>\nAuthor: JV <vjujjuri@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1196 from jvrao/bk-issue-1195-lacfix, closes #1195\n","Date":"Mon Feb 26 09:23:10 CET 2018"},{"Commit-ID":"commit c1988c15d0e0e1e68824dd39bd79525161248bf0 1519634760 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Feb 26 00:46:00 2018 -0800]","Body":"BP-28: Etcd as metadata store\n\nDescriptions of the changes in this PR:\n\nThis BP is exploring using Etcd as the metadata store.\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Sijie Guo <guosijie@gmail.com>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1113 from sijie/bp_28_etcd_metadata_store\n","Date":"Mon Feb 26 09:46:00 CET 2018"},{"Commit-ID":"commit 7a9f971d076041b87590cbca7747a8144d331d09 1519635145 -----sp","Author":"PersonIdent[JV Jujjuri, vjujjuri@salesforce.com, Mon Feb 26 00:52:25 2018 -0800]","Body":"BP-31 BookKeeper Durability Anchor\n\nDescriptions of the changes in this PR:\n\nThis is the anchor BP for durability related work.\nWhen sub BPs are created, this will be updated to\nreflect the sub BP numbers.\n\nSigned-off-by: Venkateswararao Jujjuri (JV) <vjujjurisalesforce.com>\n\nMaster Issue: #1202\n\nAuthor: JV Jujjuri <vjujjuri@salesforce.com>\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Sijie Guo <guosijie@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1138 from jvrao/BP-31-durability-anchor\n","Date":"Mon Feb 26 09:52:25 CET 2018"},{"Commit-ID":"commit 9bce1bf6831698d11c13b035ce92e3fb098f9ee2 1519635404 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Feb 26 00:56:44 2018 -0800]","Body":"BP-30: BookKeeper Table Service\n\nDescriptions of the changes in this PR:\n\nThis BP is proposing adding a table (aka key/value) service component as a contrib module to the bookkeeper, which can later be used for metadata storage. This BP together with other BPs forms the ideas of  improving metadata management in bookkeeper.\n\nBP Details: https://docs.google.com/document/d/155xAwWv5IdOitHh1NVMEwCMGgB28M3FyMiQSxEpjE-Y/edit#heading=h.56rbh52koe3f\n\nRelated BPs:\n\n- BP-29: Metadata API Module #1123\n- BP-28: Etcd Metadata Store #1113\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Sijie Guo <guosijie@gmail.com>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1185 from sijie/bp_30_table_service\n","Date":"Mon Feb 26 09:56:44 CET 2018"},{"Commit-ID":"commit c0aff9f91b79b8b573f50fb4ecd0e300816f6949 1519683102 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon Feb 26 14:11:42 2018 -0800]","Body":"Allow rackaware policy to be notified of any rack change\n\nThis PR is a port from Yahoo branch: https://github.com/yahoo/bookkeeper/commit/dbfd2073b6e687a5b4b9c56a0f0c3436f177db58\n\nIt adds a hook so that a placement policy implementation can add a way to notify the main rackaware policy that the rack mappings were updated.\n\nThis was used to have a specialized policy that keeps the mapping (bookie -> rack) in ZooKeeper. Whenever the new bookies are added (or updated), the administrator would update the mapping and we need to start using the new settings.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1204 from merlimat/rack-aware-notification\n","Date":"Mon Feb 26 23:11:42 CET 2018"},{"Commit-ID":"commit c618d9a72b4f79cb2162ba7653c934dda8878596 1519684854 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon Feb 26 14:40:54 2018 -0800]","Body":"Allow derived implementations of RackawareEnsemblePlacementPolicy\n\nLeave public constructor so that it's possible to create a placement policy that derives from RackawareEnsemblePlacementPolicy.\n\nFor example, in Pulsar we have an isolation policy that works in conjunction with the rack-aware: https://github.com/apache/incubator-pulsar/blob/ac94698df6c66c4b84faa9f96db71f0019bf955e/pulsar-zookeeper-utils/src/main/java/org/apache/pulsar/zookeeper/ZkIsolatedBookieEnsemblePlacementPolicy.java#L45\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1206 from merlimat/master\n","Date":"Mon Feb 26 23:40:54 CET 2018"},{"Commit-ID":"commit 754f257f8bf0fd28f4ea529311e93f97df593643 1519691709 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Feb 26 16:35:09 2018 -0800]","Body":"Prepare merging table service\n","Date":"Tue Feb 27 01:35:09 CET 2018"},{"Commit-ID":"commit 501d0c09088ae855797df60bdf9f02dfcbe737d5 1519691741 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Feb 26 16:35:41 2018 -0800]","Body":"Merge branch 'master' of ../stream_storage_merge into merge_table_service\n","Date":"Tue Feb 27 01:35:41 CET 2018"},{"Commit-ID":"commit 4897e43ca6b58f38f5bad7a04ba4b881b7c7551c 1519723774 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Feb 27 01:29:34 2018 -0800]","Body":"Added MockBookKeeper for unit tests\n\nThis mock class is what we use in Pulsar to do unit tests for the managed-ledger library.\n\nThis approach might be useful in general, in all cases when creating unit tests of an application that uses the BookKeeper API.\n\nThe `MockBookKeeper` behaves like the regular BK client, except it needs no bookies or zookkeeper. All ledgers and data are just kept in an hashmap in memory.\n\nIt is possible to inject failure in the sync/async calls, even after N steps. This is very useful to trigger failure in complex operations and cover this paths in unit tests.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1209 from merlimat/mock-bookkeeper\n","Date":"Tue Feb 27 10:29:34 CET 2018"},{"Commit-ID":"commit d8325409b8401bb464b457993dd2c007350f1b45 1519730164 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Feb 27 03:16:04 2018 -0800]","Body":"use FutureUtils/FutureEventListener in bookkeeper-common for dlog\n\nDescriptions of the changes in this PR:\n\nThis is a sub-task for apache/bookkeeper#1024\n\nAfter dlog is merged to bookkeeper, FutureUtils/FutureEventListener is duplicated at bookkeeper-common and distributedlog-common. This change is to remove FutureUtils/FutureEventListener from distributedlog-common and let dlog use the ones in bookkeeper-common.\n\nThe changes includes:\n\n- remove `FutureUtils/FutureEventListener` from distributedlog-common\n- change dlog classes to use the ones in bookkeeper-common\n- change the dlog `OrderScheduler` to extend bookkeeper `OrderedScheduler` (required by FutureUtils.within).\n\nMaster Issue: #1024\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1208 from sijie/use_bookkeeper_futureutils\n","Date":"Tue Feb 27 12:16:04 CET 2018"},{"Commit-ID":"commit cff50ee31feadf63bad1ccc1ccc3abcdf0fea79d 1519757941 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Tue Feb 27 10:59:01 2018 -0800]","Body":"Add Jia Zhai and Enrico Olivelli to PMC list\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1212 from eolivelli/fix/update-pmc-list\n","Date":"Tue Feb 27 19:59:01 CET 2018"},{"Commit-ID":"commit d237b537dc62b53d7ffc51860b98e5bd0a2ca9b8 1519766419 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Feb 27 13:20:19 2018 -0800]","Body":"ISSUE #1147: Move bookkeeper-server/{bin,conf} to root module\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nsince 4.7, we are shipping the binary distribution using bookkeeper-dist modules. so it is making more sense to have {bin,conf} directory at root module,\nrather than bookkeeper-server module.\n\n*Solution*\n\n- move bookkeeper-server/bin to bin\n- move bookkeeper-server/conf to conf\n- update the new bookkeeper cli related files as \"experimental\"\n\nThis change is needed for integrating with dlog scripts for BP-26 and new bookkeeper cli for BP-27.\n\nMaster Issue: #1147\n\nRelated Issues:\n\n- BP-26 #1024\n- BP-27 #1000\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>\n\nThis closes #1210 from sijie/move_bin_conf, closes #1147\n","Date":"Tue Feb 27 22:20:19 CET 2018"},{"Commit-ID":"commit 162df68d53c8f0fce34b55edf9119d47cdd6fac4 1519773768 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Feb 27 15:22:48 2018 -0800]","Body":"Merge remote-tracking branch 'apache/merge_table_service'\n","Date":"Wed Feb 28 00:22:48 CET 2018"},{"Commit-ID":"commit a5b0c6ece4a29d134ec2b2327821d880b42b19f9 1519783666 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Feb 27 18:07:46 2018 -0800]","Body":"Update release guide to remove old releases after a new release is completed\n\nDescriptions of the changes in this PR:\n\nAddress comments at #1213\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1215 from sijie/update_release_guide\n","Date":"Wed Feb 28 03:07:46 CET 2018"},{"Commit-ID":"commit b2ecd28f7f826517340f965af5fa72bf3fb588a5 1519783748 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Feb 27 18:09:08 2018 -0800]","Body":"Update download pages\n\nDescriptions of the changes in this PR:\n\n- remove redundant sentence in download pages (see comment at #1090)\n- change latest release to use mirror_url for downloading packages and dist for asc,md5 files\n- change other releases to use achive url for all files\n\nThis change fixes #1090\n\nrelated changes: #1213\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1214 from sijie/update_download_page\n","Date":"Wed Feb 28 03:09:08 CET 2018"},{"Commit-ID":"commit 538aee9e8bb5ef72fa780f76dba2b32701c947b3 1519783795 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Feb 27 18:09:55 2018 -0800]","Body":"Use the bk OrderedScheduler in dlog\n\nDescriptions of the changes in this PR:\n\nDlog has an implementation of OrderedScheduler inspired of bk `OrderedScheduler`. It would be good to remove duplicated implementation here since dlog is in the same repo as bk.\n\n- removed the dlog version of `OrderedScheduler`\n- make `OrderedScheduler` implement `ScheduledExecutorService` so it can be used by dlog\n- change dlog classes to use bk `OrderedScheduler`.\n\nMaster Issue: #1024\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1211 from sijie/merge_ordered_scheduler\n","Date":"Wed Feb 28 03:09:55 CET 2018"},{"Commit-ID":"commit 7540adf110671dc4cea94b5b79b2d379f068d41b 1519827724 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Feb 28 15:22:04 2018 +0100]","Body":"Bookies should prioritize recovery reads/writes\n\nThe change adds a new flag for reads, RECOVERY_READ. This flag is set\nwhen a client is retrying to recover a ledger. Recovery reads should\nbe higher priority than normal reads, as recovery usually happens when\na writer has failed, and another node needs to take over the stream\nthat that ledger belonged to. All writes on that stream are blocked\nuntil the ledger the ledger has been recovered, so giving these reads\npriority will mean the stream is out for action for the shortest\namount of time possible.\n\nPriority is given to these reads by executing the reads directly in\nthe BookieRequestProcessor, rather than adding them to the\nreadThreadPool where they could end up queuing.\n\nThis change was originally 372a99db in the yahoo.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #898 from ivankelly/yahoo-bp-10\n","Date":"Wed Feb 28 15:22:04 CET 2018"},{"Commit-ID":"commit 68088398f6aaea7b6fa64489d5f0b87e0c5a4bd5 1519828489 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Feb 28 15:34:49 2018 +0100]","Body":"BP-29 (task 3): use metadata service uri for constructing registration client\n\nDescriptions of the changes in this PR:\n\n- Deprecated `getRegistrationClientClass` and changed bookkeeper client to use metadata service uri to construct metadata driver.\n- Add a test case for TestZKRegistrationClient and fixes issues caught by the test case.\n\nMaster Issue: #1123\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Jia Zhai <None>\n\nThis closes #1192 from sijie/use_metadata_service_uri_in_registration\n","Date":"Wed Feb 28 15:34:49 CET 2018"},{"Commit-ID":"commit aada2c649d78101ee455ad5b15b60c2abd97929e 1519831115 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Feb 28 16:18:35 2018 +0100]","Body":"Shade bookkeeper in distributedlog-core-shaded and allow using shaded bookkeeper client to resolve ledger manager factory class\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\n1. when `distributedlog-core-shaded` is co-used with other bookkeeper jars, it would cause class conflicts because `distributedlog-core-shaded` shades\nmost of its dependencies except bookkeeper. so it is better to also shade bookkeeper to avoid such conflicts.\n\n2. if we shade bookkeeper, it would cause a problem on resolving ledger manager factory class stored on layout metadata.\n\n```\njava.io.IOException: Failed to instantiate ledger manager factory org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory\n\tat dlshade.org.apache.bookkeeper.meta.AbstractZkLedgerManagerFactory.attemptToResolveShadedLedgerManagerFactory(AbstractZkLedgerManagerFactory.java:256) ~[distributedlog-core-shaded-4.7.0-SNAPSHOT.jar:4.7.0-SNAPSHOT]\n\tat dlshade.org.apache.bookkeeper.meta.AbstractZkLedgerManagerFactory.newLedgerManagerFactory(AbstractZkLedgerManagerFactory.java:203) ~[distributedlog-core-shaded-4.7.0-SNAPSHOT.jar:4.7.0-SNAPSHOT]\n```\n\n*Solution*\n\n- shade bookkeeper dependencies in `distributedlog-core-shaded`\n- add flags to allow using shaded bookkeeper jar to resolve ledger manager factory\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Jia Zhai <None>\n\nThis closes #1217 from sijie/fix_builds\n","Date":"Wed Feb 28 16:18:35 CET 2018"},{"Commit-ID":"commit 45c5cf5ec0f2560c8858a7167f8c1fc066bf0431 1519842873 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Feb 28 10:34:33 2018 -0800]","Body":"Pull as many reviewers as possible when merging\n\nGithub uses pagination on some apis. This means that if there are a\nlot of comments on a issue, it may not pick up approvals by\ndefault. This patch increases the number of review comments to pull,\nfrom a default of 30 to 100. A proper fix would be to enable\npagination using the Link header, but that's a much bigger change, for\nlittle return.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1220 from ivankelly/page_comments\n","Date":"Wed Feb 28 19:34:33 CET 2018"},{"Commit-ID":"commit 70ff9fc6f831288a51af6b6ce7006a50a12f3902 1519854014 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Feb 28 13:40:14 2018 -0800]","Body":"Website fails to build due to a missing field at the yaml file\n\nDescriptions of the changes in this PR:\n\nThe problem was introduced at apache/bookkeeper#898\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Luc Perkins <lucperkins@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1222 from sijie/fix_website\n","Date":"Wed Feb 28 22:40:14 CET 2018"},{"Commit-ID":"commit 8b8c5515e041347e0fdd791534fa0a694c96c6ae 1519854134 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Feb 28 13:42:14 2018 -0800]","Body":"Support LacPiggyback, LongPoll and ExplicitLac in db ledger storage\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nDbLedgerStorage was developed in yahoo and just merged recently to master. This implementation only works for v2 protocol.\nIt doesn't work with v3 protocol. When using v3 protocol clients (e.g. dlog library) to talk to bookies use DbLedgerStorage,\nthe clients hang on waiting responses. because a few methods in DbLedgerStorage throw UnsupportedException\n\n*Solution*\n\nThis change focuses on adding the implementations for those methods, in order to support LacPiggyback, LongPoll and ExplicitLac\nfor v3 protocol. The implementation follows what we had in FileInfoCache but did it in a much simpler way, since all the persistence\ninformation has been managed by db ledger storage itself. All the information required by `LacPiggyback`, `LongPoll` and `ExplicitLac`\nare transient.\n\nThis change doesn't introduce any new test cases. It reuses existing test cases to test those features using DbLedgerStorage. These\ntests are:\n\n- ExplicitLacTest: for testing explicit lac\n- TestPiggybackLAC: for testing piggback lac\n- TestReadLastConfirmedLongPoll: for testing long polling lac\n- TestReadLastConfirmedAndEntry: for testing entry piggyback\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1218 from sijie/support_long_polls\n","Date":"Wed Feb 28 22:42:14 CET 2018"},{"Commit-ID":"commit d79c7a77883de1e8bda668f6d16d1e80c3eed33d 1519926759 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Mar 1 09:52:39 2018 -0800]","Body":"Enable buiding website on travis job if a PR is modifying `site`\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1223 from sijie/run_tests_on_website_changes\n","Date":"Thu Mar 01 18:52:39 CET 2018"},{"Commit-ID":"commit 8d048abce486c63d428041f77ee9a506756f4d1e 1519981728 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Mar 2 10:08:48 2018 +0100]","Body":"Refactored ReadResponse ref count handling\n\nThis contains a number of changes.\n\n- V2 bookie protocol\n  - Add retain and release methods to all responses. For read response\n    it handles the data buffer.\n  - ReadResponses always have a buffer now, even if empty.\n\n- Server side\n  - In the v2 read handler, releasing of the buffer in the case of\n    error is left to the very end.\n\n- Client side\n  - Per channel bookie clients own the buffer for read responses.\n    If a ReadCallback want it to live past the lifetime of the call\n    it must call retain.\n\nThis change was originally e8643140 in the yahoo-4.3 branch.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1221 from ivankelly/yahoo-bp-11\n","Date":"Fri Mar 02 10:08:48 CET 2018"},{"Commit-ID":"commit bd798624bc6d65862c6d3b9abcdf5f492531d291 1520042117 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Mar 2 17:55:17 2018 -0800]","Body":"Improve Travis Build\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nThere are a couple of problem with current travis build\n\n- apache/bookkeeper#1223 introduce `set -e` on script section, which it cause some weird early-exiting problem.\n- we run two installs. one is the default install by travis, the other one is install with apache-rat/spotbug checks in script section, which make the build slow.\n- travis_retry and travis_wait spread across different commands in the script section\n\n*Solution*\n\n- move build logic into a bash script file and invoke the script\n- skip install section in travis\n\n*Result*\n\nThis reduces travis build time by 10+ mins and make it stable\n\nNOTES:\n\nThe changes under `site` and `stream/distributedlog` are used `empty commits` to trigger corresponding builds in travis.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1224 from sijie/travis_wait\n","Date":"Sat Mar 03 02:55:17 CET 2018"},{"Commit-ID":"commit 2d6c30472ccb43eb04b1934b4c0be30283c2864e 1520042308 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Mar 2 17:58:28 2018 -0800]","Body":"Fix TestBKSyncLogReader\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nThe test case `TestBKSyncLogReader` is waiting an entry beyond a control record, where the number of control records can\nvary depend on the timing of flush()/commit(). This introduces the flakiness of this test.\n\n*Solution*\n\nThis change changes to wait for readahead go beyond the last user record, which is more deterministic.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Yiming Zang <yzang2016@gmail.com>, Jia Zhai <None>,  Philip Su <psu@twitter.com>\n\nThis closes #1168 from sijie/fix_test_sync_log_reader\n","Date":"Sat Mar 03 02:58:28 CET 2018"},{"Commit-ID":"commit 8322482b8292f9326fb3b72c4b46dc05cc157811 1520156159 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Mar 4 01:35:59 2018 -0800]","Body":"Integrate table service in bookkeeper build\n\nDescriptions of the changes in this PR:\n\n- update the pom files to integrate table service with bookkeeper build\n- add 3 flags to control building/testing table service. by default the table service will be built and tested with existing maven commands.\n  It only builds and runs the tests on following conditions:\n    * `-Dstream`: enable building the table service\n    * `-DstreamTests`: run the unit tests of table service\n    * `-DstreamIntegrationTests`: run the integration tests of table service\n- update CI jobs\n    * Travis: compile table service for all builds, run unit tests if code modifications happen under `stream` directory\n    * Jenkins: compile table service on precommit jobs, compile and run unit tests for postcommit jobs\n\nMaster Issue: #1205\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <zhaijia@apache.org>\n\nThis closes #1216 from sijie/built_table_service\n","Date":"Sun Mar 04 10:35:59 CET 2018"},{"Commit-ID":"commit 18b1dabcebe9922878a5ed277ef0f8eaf8bcfc74 1520192476 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Mar 4 11:41:16 2018 -0800]","Body":"Make table service client includes table service related jars\n\nDescriptions of the changes in this PR:\n\nThis is a change for #1205\n\n*Motivation*\n\nin order to implify the other project to use table service, it would be good to make sure the client include table service related jars.\n\n*Solution*\n\nInclude table service related jars in the client-all jar.\n\nMaster Issue: #1205\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1226 from sijie/publish_table_service_jars\n","Date":"Sun Mar 04 20:41:16 CET 2018"},{"Commit-ID":"commit 3e51b8116c363604f93bdd0c6b6b71ef3387c8a8 1520225458 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Mar 4 20:50:58 2018 -0800]","Body":"Fix AbstractLedgerManagerFactory on handling both shaded class and original class co-exists case\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\n#1217 addresses the issue when using a shaded class accessing a bookkeeper cluster.  However the assumption was made when the classpath only has shaded classes. However, it didn't address the case when shaded class and original class can co-exist. because IOException is thrown instead of ClassNotFoundException at following code:\n\n```\n                Class<?> theCls = Class.forName(layout.getManagerFactoryClass());\n                if (!LedgerManagerFactory.class.isAssignableFrom(theCls)) {\n                    throw new IOException(\"Wrong ledger manager factory \" + layout.getManagerFactoryClass());\n                }\n```\n\n*Solution*\n\nThis change fixes the issue.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1227 from sijie/debug_issue\n","Date":"Mon Mar 05 05:50:58 CET 2018"},{"Commit-ID":"commit fbc06ef3139ca857c60a2edbc209c8b088e979df 1520305994 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Mar 5 19:13:14 2018 -0800]","Body":"ISSUE #1229: PendingAddOp can get recycled before it gets executed\n\nDescriptions of the changes in this PR:\n*Problem*\n\nThe PendingAddOp can be recycled when it is cancelled before it is executed. so it will hit NPE when it is actually executed. This is a bug introduced by #1091\n\n*Solution*\n\nOnly recycle PendingAddOp after it has been run.\n\nMaster Issue: #1229\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Andrey Yegorov <None>, Matteo Merli <mmerli@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1230 from sijie/fix_npe, closes #1229\n","Date":"Tue Mar 06 04:13:14 CET 2018"},{"Commit-ID":"commit bed1d6f03700838f0667fbab8f8d9032b8294792 1520328806 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Mar 6 01:33:26 2018 -0800]","Body":"Dont shade netty at distributedlog-core-shaded\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nJVM crashed on linux platforms, when`distributedlog-core-shaded` (where netty `4.1.12.Final` was shaded) is used in a project where a non-shaded netty `4.1.21.Final` is used and epoll is enabled.\n\n```\nEvent: 13.322 Thread 0x00007fef90013000 Exception <a 'java/lang/NoSuchMethodError': Method io.netty.channel.epoll.Native.epollWait0(IJII)I name or signature does not match>             (0x00000000e709c060) thrown at [/build/openjdk-8-8u141-b15/src/hotspot/src/share/vm/prims/jni.cpp, line 4011]\n```\n\nBecause Epoll is enabled on linux platforms. However because two different netty versions bring in two different jni bindings, when the netty epoll transport tries to resolve the jni library, it hit the signature mismatch issue.\n\n*Solution*\n\nDont shade netty at all. Let the application resolve which netty version to use.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1231 from sijie/dont_shade_netty\n","Date":"Tue Mar 06 10:33:26 CET 2018"},{"Commit-ID":"commit 19846b23de3be13e28082d4ba73e21bb8fa39ad2 1520383551 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Mar 6 16:45:51 2018 -0800]","Body":"Make shading rule consistent between bookkeeper-server-shaded and bookkeeper-server-tests-shaded\n\nDescriptions of the changes in this PR:\n\n`bookkeeper-server:test-jar` is working with `bookkeeper-server`. we should make `bookkeeper-server-tests-shaded` work with `bookkeeper-server-shaded`.  so this change is to make they have consistent shading rule.\n\n```\n<dependency>\n      <groupId>org.apache.bookkeeper<\/groupId>\n      <artifactId>bookkeeper-server-shaded<\/artifactId>\n      <version>${bookkeeper.version}<\/version>\n      <scope>test<\/scope>\n    <\/dependency>\n<dependency>\n      <groupId>org.apache.bookkeeper<\/groupId>\n      <artifactId>bookkeeper-server-tests-shaded<\/artifactId>\n      <version>${bookkeeper.version}<\/version>\n      <scope>test<\/scope>\n    <\/dependency>\n```\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1234 from sijie/sijie_improve_tests_shaded\n","Date":"Wed Mar 07 01:45:51 CET 2018"},{"Commit-ID":"commit e62415676f787c8db243a7bca7feec2dc7de565b 1520576206 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Thu Mar 8 22:16:46 2018 -0800]","Body":"Issue #570: getting rid of unnecessary synchronization in InterleavedLedgerStorage\n\nDescriptions of the changes in this PR:\n\nThis is < sub-task1 > of Issue #570.\n\nIn InterleavedLedgerStorage, since the initial version of it, addEntry and processEntry methods are synchronized, but they are not required to be synchronized.\n\nRemoval of unnecessary synchronization in InterleavedLedgerStorage methods, as described in http://mail-archives.apache.org/mod_mbox/bookkeeper-dev/201707.mbox/%3CCAO2yDyZ946fp2S_qR2iL178hPiXgrnFGb%3DpvkyK4ReSYAtNLBw%40mail.gmail.com%3E\n\nMaster Issue: #570\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1225 from reddycharan/nonsynchaddinterleavedstorage, closes #570\n","Date":"Fri Mar 09 07:16:46 CET 2018"},{"Commit-ID":"commit 7d932365eb942e0dde03d4bd73ee4500576afd0d 1520576379 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Mar 8 22:19:39 2018 -0800]","Body":"Reduce running time for testLedgerCreateAdvWithLedgerIdInLoop\n\nThis test has flaked in CI regularly mainly because it takes a long\ntime to run.\n\nThis changes reduces the running time by.\n1. Creating the ledgers with a ensemble size of 1\n2. Creating and writing to the ledgers in parallel\n3. Using async methods to write entries to the ledgers\n\nThis brought the test from ~60 seconds to ~7 seconds locally.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Charan Reddy Guttapalem <reddycharan18@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1233 from ivankelly/ledger-create-adv-timeout\n","Date":"Fri Mar 09 07:19:39 CET 2018"},{"Commit-ID":"commit 30261eae3fd8ab25239d57cfb86a200d5f7b6b7d 1520593392 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Fri Mar 9 12:03:12 2018 +0100]","Body":"Issue #570: Move logic of unpersistedbytes to bufferedchannel\n\nDescriptions of the changes in this PR:\n\nThis is < sub-task2 > of Issue #570.\n\nhttps://github.com/apache/bookkeeper/commit/26b09abb4202362ca37d6944ce75eb2a3309dc3c\nintroduced the flushEntrylogBytes factor. But it is structurally correct to have this\nlogic in BufferedChannel, rather than in EntryLogger, since it is paramter of BufferedChannel.\n\nMaster Issue: #570\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1228 from reddycharan/fixunpersistedbytes, closes #570\n","Date":"Fri Mar 09 12:03:12 CET 2018"},{"Commit-ID":"commit 532a43b4d7b2e43fb345983d987c1f7f09cfd38f 1520643795 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Mar 9 17:03:15 2018 -0800]","Body":"Move dependency version management to root pom file\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nTo have a clear dependency management at bookkeeper, avoid unnecessary version conflicts.\n\n*Changes*\n\n**Dependencies**\n\n- define versions at properties section at root pom file\n- move dependency definitions to `dependencyManagement` at root pom file\n- avoid specifying dependency version at sub modules unless it is really needed. comments were already / are added for those cases.\n\n**Plugin Dependencies**\n\n- define versions at properties section at root pom file\n- use property to specify version when using a new plugin\n- remove duplicated configurations on plugins\n\n*Other changes*\n\n- cleanup root pom files for module `stream` and `stream/distributedlog`\n- fix some checkstyle violations since we are changing some plugin inheritances.\n\nThis fixes #251\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Yiming Zang <yzang2016@gmail.com>, Jia Zhai <None>\n\nThis closes #1235 from sijie/cleanup_poms\n","Date":"Sat Mar 10 02:03:15 CET 2018"},{"Commit-ID":"commit e3d47ae14a0140b10a6303ecfddbcba66ce90933 1520643856 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri Mar 9 17:04:16 2018 -0800]","Body":"Removed ServerStats since it was not used anymore\n\nServerStats class was previously used to expose stats through JMX but it's\nnot being used anymore and it's just causing lock contention in Bookie IO threads\nwhen using v2 protocol.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1243 from merlimat/remove-server-stats\n","Date":"Sat Mar 10 02:04:16 CET 2018"},{"Commit-ID":"commit f0757e9ac643d6f36a11be4065d163437180cb7e 1520658378 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri Mar 9 21:06:18 2018 -0800]","Body":"Issue #1241: Fixed NPE in PerChannelBookieClient\n\nThe `CompletionValue` object from the map can be null in some cases and we need to protect for it.\n\nFixes #1241\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1242 from merlimat/fix-npe, closes #1241\n","Date":"Sat Mar 10 06:06:18 CET 2018"},{"Commit-ID":"commit 59e48a390c1caa12adb7cc89afd2f9d48790a674 1520669637 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Mar 10 00:13:57 2018 -0800]","Body":"Disable using v2 decoder to decode v3 response if usingV2WireProtocol is enabled and handle unknown op in v2 request decoder\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\n- response decoder should use whatever protocol that request is using to decode the response. otherwise it is making wrong assumption on response protocol.\n- v2 request decoder doesn't handle unknown op correctly, which will cause netty double-release bytebuf\n\n*Solution*\n\n- make sure response decoder respect the protocol that client is using for sending requests\n- v2 request decoder should throw exceptions when fail to decode unknown request\n\nRelated issues: #198\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1240 from sijie/bookkeeper_fix_bytebuf_issues\n","Date":"Sat Mar 10 09:13:57 CET 2018"},{"Commit-ID":"commit cefdeb6e3c6f4231ca8d09e93cc7f3dedd3a058f 1520904930 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon Mar 12 18:35:30 2018 -0700]","Body":"Fixed Journal static empty array list recycling\n\nWhen `journalSyncData=false`, we passing `EMPTY_ARRAY_LIST` to the `ForceWriteThread` when the journal is rolled over.\n\nI have seen this exception:\n\n```\n18:39:52.285 [ForceWriteThread] ERROR org.apache.bookkeeper.bookie.BookieCriticalThread - Uncaught exception in thread ForceWriteThread and is exiting!\njava.lang.NullPointerException: null\n\tat io.netty.util.Recycler$DefaultHandle.recycle(Recycler.java:219) ~[io.netty-netty-all-4.1.21.Final.jar:4.1.21.Final]\n\tat org.apache.bookkeeper.common.collections.RecyclableArrayList.recycle(RecyclableArrayList.java:55) ~[org.apache.bookkeeper-bookkeeper-server-shaded-4.7.0-SNAPSHOT.jar:4.7.0-SNAPSHOT]\n\tat org.apache.bookkeeper.bookie.Journal$ForceWriteRequest.recycle(Journal.java:402) ~[org.apache.bookkeeper-bookkeeper-server-shaded-4.7.0-SNAPSHOT.jar:4.7.0-SNAPSHOT]\n\tat org.apache.bookkeeper.bookie.Journal$ForceWriteRequest.access$1(Journal.java:399) ~[org.apache.bookkeeper-bookkeeper-server-shaded-4.7.0-SNAPSHOT.jar:4.7.0-SNAPSHOT]\n\tat org.apache.bookkeeper.bookie.Journal$ForceWriteThread.run(Journal.java:506) ~[org.apache.bookkeeper-bookkeeper-server-shaded-4.7.0-SNAPSHOT.jar:4.7.0-SNAPSHOT]\n```\n\nThis is due to calling `recycle()` twice on the same `EMPTY_ARRAY_LIST`  instance. The solution is that `EMPTY_ARRAY_LIST` should not be a pooled instance and we should check that before recycling.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1249 from merlimat/fix-journal-list-recycle\n","Date":"Tue Mar 13 02:35:30 CET 2018"},{"Commit-ID":"commit 88addff33a9a9474b069ac197d46d2d672ae988d 1520981502 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Tue Mar 13 15:51:42 2018 -0700]","Body":"Issue #570: make changes to SyncThread/checkpoint logic.\n\nDescriptions of the changes in this PR:\n\nmake changes to SyncThread/checkpoint logic, so that incase of\nentrylogperledger, checkpoint happens for every flushInterval\nbut not when active entrylog is created/rolled over.\n\nThis is < sub-task3  > of Issue #570\n\nMaster Issue: #570\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1236 from reddycharan/addcheckpointlogic, closes #570\n","Date":"Tue Mar 13 23:51:42 CET 2018"},{"Commit-ID":"commit 7e494a222d497aca2f56bacc57a79f022e5a078a 1520982200 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Mar 13 16:03:20 2018 -0700]","Body":"Make it possible to build site on ubuntu and debian\n\nXenial ships with ruby 2.3.1. Debian Stretch ships 2.3.3. The current\nGemfile asks for 2.4.1. This patch drops the requirement to >=2.3.1.\n\nIt also make it possible to test the site without sudo.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1253 from ivankelly/site-deb\n","Date":"Wed Mar 14 00:03:20 CET 2018"},{"Commit-ID":"commit e20bb40ddff4c5bd033625dc82788b545f8d66ee 1520982452 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Tue Mar 13 16:07:32 2018 -0700]","Body":"ISSUE #336: add DC/OS package update and instructions\n\nDescriptions of the changes in this PR:\n\nProvide instructions of updating DCOS package by using latest docker image when do new release.\n\nMaster Issue: #336\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1247 from jiazhai/issue_336, closes #336\n","Date":"Wed Mar 14 00:07:32 CET 2018"},{"Commit-ID":"commit 4578e6d65a304c870fcba013099badd6018c95de 1520984990 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Mar 13 16:49:50 2018 -0700]","Body":"Fixed Journal stats names\n\nIn `BOOKKEEPER-1009: Use multiple journals in bookie` 123eccd435a4a96a9147ed4a24efbe9025fe79ba there was a change in the metrics name that would be affecting also user not running with multiple journal.\n\nIt is a bit inconvenient to aggregate the stats in the metrics collector (how to aggregate 99pct latency for example).\n\nI think the best option is to have a single metric even when using multiple journal threads.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1250 from merlimat/journal-metric-names\n","Date":"Wed Mar 14 00:49:50 CET 2018"},{"Commit-ID":"commit 96ff1c0d44bf1ac6b0ce3ca21053ae10ab7e2294 1521037203 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Mar 14 15:20:03 2018 +0100]","Body":"Jenkins seed job for testing DSLs\n\nThe job allows you to specify a repo and a branch. It will look for\nall files named .test-infra/jenkins/jenkins_testing_job_*.groovy and\ntry to generate jobs for them. The seed job is in the folder\nbookkeeper-jenkins-testing/ and has lookupStrategy set to\n'SEED_JOB'. This means that any job generated by this seed will be\ncreated in the same folder, thus lowering the chance of breaking our\nexisting production jobs.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1248 from ivankelly/test-seed\n","Date":"Wed Mar 14 15:20:03 CET 2018"},{"Commit-ID":"commit 7e8980fff096a9111e9365d0dc959af0625a87db 1521050585 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Mar 14 11:03:05 2018 -0700]","Body":"ISSUE #1255: Bookie should not advance the journal marker before creating the index file\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nCurrently Bookie journal 'new ledger' entry if a ledger doesn't exist at ledger storage. This 'new ledger' entry is journaled before adding the entry to ledger storage. so this would cause a problem on checkpointing.\n\n- journal 'new ledger' entry\n\n```\n    /**\n     * Retrieve the ledger descriptor for the ledger which entry should be added to.\n     * The LedgerDescriptor returned from this method should be eventually freed with\n     * #putHandle().\n     *\n     * throws BookieException if masterKey does not match the master key of the ledger\n     */\n    private LedgerDescriptor getLedgerForEntry(ByteBuf entry, final byte[] masterKey)\n            throws IOException, BookieException {\n        final long ledgerId = entry.getLong(entry.readerIndex());\n\n        LedgerDescriptor l = handles.getHandle(ledgerId, masterKey);\n        if (masterKeyCache.get(ledgerId) == null) {\n            // Force the load into masterKey cache\n            byte[] oldValue = masterKeyCache.putIfAbsent(ledgerId, masterKey);\n            if (oldValue == null) {\n                // new handle, we should add the key to journal ensure we can rebuild\n                ByteBuffer bb = ByteBuffer.allocate(8 + 8 + 4 + masterKey.length);\n                bb.putLong(ledgerId);\n                bb.putLong(METAENTRY_ID_LEDGER_KEY);\n                bb.putInt(masterKey.length);\n                bb.put(masterKey);\n                bb.flip();\n\n                getJournal(ledgerId).logAddEntry(bb, false /* ackBeforeSync */, new NopWriteCallback(), null);\n            }\n        }\n\n        return l;\n    }\n```\n\n- add entry to ledger storage\n```\n    /**\n     * Add an entry to a ledger as specified by handle.\n     */\n    private void addEntryInternal(LedgerDescriptor handle, ByteBuf entry,\n                                  boolean ackBeforeSync, WriteCallback cb, Object ctx)\n            throws IOException, BookieException {\n        long ledgerId = handle.getLedgerId();\n        long entryId = handle.addEntry(entry);\n\n        writeBytes.add(entry.readableBytes());\n\n        if (LOG.isTraceEnabled()) {\n            LOG.trace(\"Adding {}{}\", entryId, ledgerId);\n        }\n        getJournal(ledgerId).logAddEntry(entry, ackBeforeSync, cb, ctx);\n    }\n\n```\n\nThe problematic sequence can be described as below:\n\n- thread t1 is adding the first entry of ledger L1\n- thread t2 is adding entries of ledger L2\n- t1 is adding a journal entry of 'new ledger L1'\n- t2 is adding entries after t1 adds the journal entry and before t1 adding the entry to ledger storage\n- after t2 added entries, checkpoint happens in the ledger storage. it would roll the journal mark, which will claim the 'new ledger L1' entry as persistent.\n- if the bookie restarts, it would fail with no such ledger exception.\n\nThe problem can be produced using a unit test: https://github.com/sijie/bookkeeper/commit/5053a717cd578aeb88236d373553d7494501b801\n\n*Solution*\n\nThe fix is simple - just make sure the 'new ledger' journal entry is added after an entry is added to ledger storage. so it make sure when checkpoint happen it will flush and create the ledger before moving the journal mark.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Charan Reddy Guttapalem <reddycharan18@gmail.com>, Jia Zhai <None>, Yiming Zang <yzang2016@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1256 from sijie/fix_db_ledger_storage_checkpoint, closes #1255\n","Date":"Wed Mar 14 19:03:05 CET 2018"},{"Commit-ID":"commit fc8097f33242d6b1a6cbcce10466fb5bfc663b5a 1521051354 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Wed Mar 14 11:15:54 2018 -0700]","Body":"ISSUE #762: copy codahale files to org.apache.bookkeeper.stats.codahale\n\nDescriptions of the changes in this PR:\nCodahale stats providers are sharing same package name with the stats library org.apache.bookkeeper.stats. We should consider moving them to their own package name.\n`org.apache.bookkeeper.stats => org.apache.bookkeeper.stats.codahale`\n\nFor BC concerns, we need to do this in two phases:\n- in 4.7, we copy the files but still have the old files for BC. but mark the old classes as deprecated.\n- in 4.8, we remove the old files.\nbecause the class names are used for reflection.\n\nMaster Issue: #762\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1257 from jiazhai/issue_762, closes #762\n","Date":"Wed Mar 14 19:15:54 CET 2018"},{"Commit-ID":"commit e60085286f48c73ec779e45c84b4a76b2dc2da38 1521054671 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Mar 14 12:11:11 2018 -0700]","Body":"Replaced synchronized with volatile read in BookieStatus\n\n`BookieStatus.isInReadOnlyMode()` is being called from IO threads at each write request.\n\nHaving `synchronized` method is a major source of contention between all these threads and caps the throughput and increases the latency.\n\nReplacing here with a `volatile` variable read. This will have the same exact behavior as today while removing the contention point.\n\nI think we could eventually even do a \"dirty\" read of that variable to further reduce the overhead of the volatile read.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1259 from merlimat/bookie-status-contention\n","Date":"Wed Mar 14 20:11:11 CET 2018"},{"Commit-ID":"commit 30b7bebff7c99ac2cf6c5b784b8a122b7b3b6022 1521063044 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Mar 14 14:30:44 2018 -0700]","Body":"Allow to send callbacks from journal thread\n\nIn BK 4.3 it was possible to configure 0 threads for the dispatching of journal callback threads.\n\nThere might be good reasons to not use a thread pool when dispatching the callback threads:\n * Avoiding one more context switch\n * Avoiding contention on the executor enqueuing\n * When using multiple journals, the journal thread is not a bottleneck anymore\n\nWe should allow the same convention (threads=0 means direct execution) that we have in other places.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1258 from merlimat/journal-callbacks\n","Date":"Wed Mar 14 22:30:44 CET 2018"},{"Commit-ID":"commit 70b2e4cf49d2fc4903c277d309dbe8c0bc5e4d7d 1521070356 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Mar 14 16:32:36 2018 -0700]","Body":"Fixed journal trimming after write cache flush in DbLedgerStorage\n\n`DbLedgerStorage` uses an in-memory write cache to accumulate entries before writing into the entry log.\n\nThe flush of the write cache is triggered by 2 factors:\n 1. `SyncThread` issuing a checkpoint (eg: every 10sec or 1min)\n 2. Write cache is full, so we need to force the flush\n\nIn case (1), the checkpoint is also communicated to the journal which can then move the `logMark` forward and eventually discard old unused journals.\n\nIn cae (2), we're not moving the `logMark`. This has few side effects:\n 1. When restarting the bookie it will replay a bigger portion of the journal\n 2. We are moving the `logMark` only every 1min, so we need to keep 1minute of journals on disk\n    - If the disk hosting the journal(s) has low capacity, it can fill it up\n    - This is evident when mounting the journal on a 60GB ram-disk and using 8 journals in the bookie. At a sufficient rate, the write cache keeps getting flushed, but the journals are only trimmed after 1 minute, thus accumulating 1min worth of writes in the journal device, filling up the space.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1261 from merlimat/db-storage-journal-trimming\n","Date":"Thu Mar 15 00:32:36 CET 2018"},{"Commit-ID":"commit 3bff19956e70e37c025a8e29aa8428937af77aa1 1521096512 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Mar 14 23:48:32 2018 -0700]","Body":"Collect Prometheus latency stats using DataSketches\n\nThe implementation for collecting and estimating the latency quantiles in the Prometheus Java client library is very slow and it is impacting the the bookie performance.\n\nI have added a micro-benchmark that tests our various stats providers. These tests are simulating 16 concurrent threads updating the stats.\n\n#### Counter increment\n```\nBenchmark                              (statsProvider)   Mode  Cnt    Score      Error   Units\nStatsLoggerBenchmark.counterIncrement       Prometheus  thrpt    3  391.882 ±  786.987  ops/us\nStatsLoggerBenchmark.counterIncrement         Codahale  thrpt    3  449.341 ± 1337.736  ops/us\nStatsLoggerBenchmark.counterIncrement          Twitter  thrpt    3   43.354 ±    9.331  ops/us\nStatsLoggerBenchmark.counterIncrement          Ostrich  thrpt    3   43.790 ±    1.332  ops/us\n```\n\nHere prometheus is fast, though not as fast as a simple `LongAdder` which can reach ~500M ops/sec.\n\n#### Latency quantiles\n\n```\nBenchmark                              (statsProvider)   Mode  Cnt    Score      Error   Units\nStatsLoggerBenchmark.recordLatency          Prometheus  thrpt    3    0.255 ±    0.667  ops/us\nStatsLoggerBenchmark.recordLatency            Codahale  thrpt    3    4.963 ±    1.671  ops/us\nStatsLoggerBenchmark.recordLatency             Twitter  thrpt    3    4.793 ±    0.766  ops/us\nStatsLoggerBenchmark.recordLatency             Ostrich  thrpt    3    2.473 ±    6.394  ops/us\n```\n\nHere is where Prometheus is super-slow: 250K ops/second max, mostly due to contention and GC pressure.\n\n## Modification\n\nI have re-adapted a stats collector I had done in the Yahoo branch:\nhttps://github.com/yahoo/bookkeeper/tree/yahoo-4.3/bookkeeper-stats-providers/datasketches-metrics-provider/src/main/java/org/apache/bokkeeper/stats/datasketches\n\nThis is based on the [DataSketches](https://datasketches.github.io/) library to have very fast and lightweight quantile estimates (along with a number of other operations), plus some tricks to avoid concurrency issues by using thread local collectors and aggregating when needed in background.\n\nAfter the change, the throughput is 150x the original prometheus collector.\n\n```\nBenchmark                              (statsProvider)   Mode  Cnt    Score     Error   Units\nStatsLoggerBenchmark.counterIncrement       Prometheus  thrpt    3  531.906 ± 129.602  ops/us\nStatsLoggerBenchmark.recordLatency          Prometheus  thrpt    3   27.538 ±   5.893  ops/us\n```\n\nIt is worth noting that the main bottle-neck in the `recordLatency` test is now the `System.nanoTime()`\ncall used to pass different samples to the stat logger.\n\n`System.nanoTime()` is not super fast:\n\n```\nBenchmark                               (statsProvider)   Mode  Cnt    Score     Error   Units\nStatsLoggerBenchmark.currentTimeMillis              N/A  thrpt    3  161.502 ± 267.238  ops/us\nStatsLoggerBenchmark.nanoTime                       N/A  thrpt    3   32.822 ±   2.256  ops/us\n```\n\nBy removing the `System.nanoTime()` call from the benchmark, the Prometheus+DataSketches collector results in:\n\n```\nBenchmark                               (statsProvider)   Mode  Cnt    Score     Error   Units\nStatsLoggerBenchmark.recordLatency           Prometheus  thrpt    3  108.542 ±  31.848  ops/us\n```\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1245 from merlimat/prometheus-datasketches\n","Date":"Thu Mar 15 07:48:32 CET 2018"},{"Commit-ID":"commit 8ae8e00bab15d2ec5d596547c106c9b39b8d5a40 1521177625 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Mar 15 22:20:25 2018 -0700]","Body":"Merge tests/jmh into microbenchmark\n\nDescriptions of the changes in this PR:\n\ntests/jmh was added a while ago, but it is got dropped out of root pom with mistakes.\nmircobenchmark was added later. it is making sense to merge tests/jmh into microbenchmark module since they are using jmh to do microbenchmarks\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1265 from sijie/move_jmh_to_benchmarks\n","Date":"Fri Mar 16 06:20:25 CET 2018"},{"Commit-ID":"commit fa4e9d7d8cc91c984383779e8bad2248b7951540 1521177845 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Thu Mar 15 22:24:05 2018 -0700]","Body":"ISSUE #881: use initialize insteadof format in docker image\n\nDescriptions of the changes in this PR:\n\nCurrently docker image uses format during startup to initialize the cluster. It would be good to separate initialize from format. The initialize command should only create znodes for brand new environment. It should not involve any logic on reformatting.\n\n- use initialize insteadof format in docker image.\n- make initialize an atomic operation.\n- add initialize and nuke command in makefile.\n- fix error for non root user running.\n\nThis PR tested by local build, since 4.7 is not released, will bump bk version in Dockerfile once 4.7 released.\n\nMaster Issue: #881\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1263 from jiazhai/issue_881, closes #881\n","Date":"Fri Mar 16 06:24:05 CET 2018"},{"Commit-ID":"commit b53c0c3370c42d753afb852824ea12d2dbce4f2e 1521178069 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Mar 15 22:27:49 2018 -0700]","Body":"BP-29 (task 4): use metadata service uri for constructing registration manager and ledger manager factory\n\nDescriptions of the changes in this PR:\n\nThe main changes are at two places:\n\n- Deprecating using ServerConfiguration#getRegistrationManagerClass(). Changed Bookie.java to use MetadataBookieDriver to getRegistrationManager().\n- Use MetadataBookieDriver/MetadataClientDriver to retrieve ledger manager factory in Bookie.java / BookKeeper.java\n\nThe other changes are in-place changes for replacing using registration manager to using metadata drivers.\n\n- provides a few util functions in `MetadataDrivers` to run `functions` with registration manager / ledger manager factory\n\nMaster Issue: #1123\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1251 from sijie/use_metadata_service_uri_in_registration_manager\n","Date":"Fri Mar 16 06:27:49 CET 2018"},{"Commit-ID":"commit 76ba8e294e151092abe1e195009314fdd6eaa64a 1521218302 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri Mar 16 09:38:22 2018 -0700]","Body":"Refactored LAC cache in DbLedgerStorage\n\nThe `TransientLedgerInfo` cache that holds the LAC (or explicit lac) for all ledgers has showed up in the profiler as a big contention point.\n\n### Modifications\n\n * Only add an item in `TransientLedgerInfo` is someone has asked for LAC or has set explicity LAC. This will save lot of memory if many ledger are not requiring the LAC info.\n * Use `ConcurrentLongHashMap` to store the `TransientLedgerInfo`. There are few advantages:\n   - Key in the map is `long` and doesn't need boxing\n   - The `get()` operation uses a stamped lock which is ideal in cases the number of `get()` is way bigger than `put()` operations, since it only needs a volatile variable read. In this case the map is only updated when new ledgers are added / removed, but we do a `get()` on each `addEntry()` operation.\n  - Schedule periodical cleanup of the map for stale ledger info entries\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1264 from merlimat/refactor-lac-cache-db-ledger-storage\n","Date":"Fri Mar 16 17:38:22 CET 2018"},{"Commit-ID":"commit 01fc8580204d726b62ecb4aac99eeda4f3662acb 1521218391 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri Mar 16 09:39:51 2018 -0700]","Body":"Fixed buffer release in v2 BookieProtocol\n\nThere was a buffers leak when using V2 bookie protocol. This was introduced with the refactoring and the merges from yahoo branch.\n\nNote: this was only happening when selecting  v2 protocol in client configuration.\n\nThe current code was missing a release in both the add and read entries path. I've been running it for some time and the ref-counting seems correct after the fix.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1266 from merlimat/fix-refcounting\n","Date":"Fri Mar 16 17:39:51 CET 2018"},{"Commit-ID":"commit adc906f60ff74cce33b150f53a3e2a203c0920d4 1521218474 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri Mar 16 09:41:14 2018 -0700]","Body":"Fixes for multiple journals recovery\n\nCurrently, the implementation of multiple journals in bookie is broken because all journal instances are using the same `logMark` file to store the journal marker, stepping into each others.\n\nAdding here a suffix for `logMark` to have unique files: `logMark.0`, `logMark.1` etc.\nIf there's 1 single journal, we'll keep using `logMark` so there's no compatibility issue.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1254 from merlimat/fix-multiple-journals and squashes the following commits:\n\n41c01af63 [Matteo Merli] Fixed LastMarkCommandTest\n15ea26806 [Matteo Merli] Merge remote-tracking branch 'apache/master' into fix-multiple-journals\n48346b856 [Matteo Merli] Fixes for multiple journals recovery\n","Date":"Fri Mar 16 17:41:14 CET 2018"},{"Commit-ID":"commit 9aececa466ed1bc2be731543bd549a51d7c8ed3c 1521224389 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Mar 16 11:19:49 2018 -0700]","Body":"Close bookkeeper client used in format\n\nOtherwise, the executors threads could keep the process calling it\nalive. This isn't a problem for BookieShell, since it does a System.exit,\nbut it currently is for pulsar metadata cluster format.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1269 from ivankelly/close-format-client\n","Date":"Fri Mar 16 19:19:49 CET 2018"},{"Commit-ID":"commit 1825dc06c419aca33dc27efe33f5571f1e280a4b 1521258023 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri Mar 16 20:40:23 2018 -0700]","Body":"Register jvm_memory_direct_bytes_used metric so that it's reported on Prometheus\n\nThe `jvm_memory_direct_bytes_used` metric is being registered on the default Prometheus static registry, though we're only exporting the stats that were added into the local registry instance.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1272 from merlimat/fix-mem-stats\n","Date":"Sat Mar 17 04:40:23 CET 2018"},{"Commit-ID":"commit 20fc51cfddc5e271385795d7b180cf5d35b75a3e 1521258063 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri Mar 16 20:41:03 2018 -0700]","Body":"Fixed journalQueueSize counter increment\n\nThe `journalQueueSize` counter was only decremented.\n\nMoved the increment in the common method that is called in every path when adding to journal.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1271 from merlimat/journal-stat\n","Date":"Sat Mar 17 04:41:03 CET 2018"},{"Commit-ID":"commit b92251379b1183fea3fe124637390ddc72d5a069 1521261084 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Mar 16 21:31:24 2018 -0700]","Body":"Improve `BookKeeperAdmin#format` to avoid constructing redundant resources\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nAfter metadata service uri change, all the metadata managers can be retrieved via metadata drivers.\nSo there is no need to construct another bookkeeper client to get ledger manager factory for formatting ledger metadata.\n\n*Solution*\n\n- remove constructing bookkeeper client and use the metadata driver to get ledger manager factory to format ledger metadata\n- expose layout manager in bookie driver as well\n- since we are adding `getLayoutManager` in bookie driver, we need to update `MetadataDriversTest`. cleanup the test drivers in `MetadataDriversTest`.\n\nRelated Issue: #1269\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1270 from sijie/improve_format\n","Date":"Sat Mar 17 05:31:24 CET 2018"},{"Commit-ID":"commit 0fdbb0622362849662b246a11b107c5f520060ad 1521359757 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sun Mar 18 15:55:57 2018 +0800]","Body":"Use final variables in BoundedScheduledExecutorService\n\nMake the fields final so that the optimizer can easily remove the `if (maxTasksInQueue > 0) {}` branch when the limit on the executor is disabled.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1273 from merlimat/final-bounded-executor\n","Date":"Sun Mar 18 08:55:57 CET 2018"},{"Commit-ID":"commit ec8b10ae848576654748ba93ac8a5e0533a901a8 1521359982 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sun Mar 18 15:59:42 2018 +0800]","Body":"Ensure we instantiate threads that extend Netty FastThreadLocalThread\n\nSince we make heavy use of `Recycler` and other `FastThreadLocal` objects from Netty, we should make sure that all (critical) threads that we instantiate are inheriting from `FastThreadLocalThread`.\n\n`FastThreadLocalThread` has an optimization that makes access to `FastThreadLocal` faster. It's a class that extends regular `Thread` and adds a field for the thread local access.\n\nThere are a couple of places where we're currently not using `FastThreadLocal`:\n * `OrderedScheduler` builder\n * `BookieThread` (which is used in `Journal`, `ForceSyncThread`, etc..)\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1274 from merlimat/fast-thread-local\n","Date":"Sun Mar 18 08:59:42 CET 2018"},{"Commit-ID":"commit c4c8c035df04d702d92b4e57b3fe1e5c1b554afc 1521426180 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Mar 19 10:23:00 2018 +0800]","Body":"Set `ENABLE_DIGEST_TYPE_AUTODETECTION` to true as default value\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nWe have recorded digest type in the ledger metadata since BK 4.5. it would be great to let client automatically detect the digest type\non opening ledger. So turn on the autodetection feature by default.\n\n*Result*\n\ndigest type autodetection is on by default.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1252 from sijie/flip_default_values\n","Date":"Mon Mar 19 03:23:00 CET 2018"},{"Commit-ID":"commit 6667955cd1fd973f9880831b4b59f525663d5ff8 1521482262 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Mar 19 10:57:42 2018 -0700]","Body":"Fix logging issue on PendingReadOp\n\nDescriptions of the changes in this PR:\n\n`EntryImpl` is recycled after callback is submitted for a given read op. However the object might be referenced after it is recycled, since read callback can come back after the read op is error-out.\n\nThis doesn't affect any operation or correctness. However it might introduce some confused logging.\n\nThis also got exposed by #1268\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1276 from sijie/fix_recycling_entries\n","Date":"Mon Mar 19 18:57:42 CET 2018"},{"Commit-ID":"commit 61ed8a697e9c1f6edbd8996819f602f6ca79920d 1521490417 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Mar 19 13:13:37 2018 -0700]","Body":"Fix ByteBuf leaking at Journal\n\nDescriptions of the changes in this PR:\n\nBufferLogChannel uses a pooled bytebuf for buffering writes. However Journal only closes the underlying log file channel, but it doesn't close buffer log channel, which can cause bytebuf leaking.\n\nThis problem get exposed at #1268\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1275 from sijie/fix_bytebuf_leaking_on_journal\n","Date":"Mon Mar 19 21:13:37 CET 2018"},{"Commit-ID":"commit c4a4318fcd308351b66c39599187c2e79fb0687a 1521557680 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Mar 20 22:54:40 2018 +0800]","Body":"Implement `toString` method for CheckpointList and BufferedLogChannel\n\nDescriptions of the changes in this PR:\n\n```\nFlushing entry logger 102 back to filesystem, pending for syncing entry loggers : [org.apache.bookkeeper.bookie.EntryLogger$BufferedLogChannel7d98c184].\n\norg.apache.bookkeeper.bookie.SortedLedgerStorage - Reached size org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointListd2c00ea5\n```\n\n`CheckpointList` and `BufferedLogChannel` is missing `toString` implementation.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1278 from sijie/fix_tostring_issue\n","Date":"Tue Mar 20 15:54:40 CET 2018"},{"Commit-ID":"commit 6edbdd905dbb1a20a7e9282047c6a255d1e9f527 1521590559 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Mar 20 17:02:39 2018 -0700]","Body":"Fixed DbStorage write cache segment index computation\n\nWhen the write cache was merged from `yahoo-4.3` branch into master, an improvement went in around computing the the write cache segment index (doing shift instead of division) and that introduced a problem.\n\nThe write cache is broken into multiple segments (since buffers in JVM can only be at most 2GB). By default we use 1GB segments (or smaller if the write cache is overall smaller).\n\nBecause the shift count was wrong, the entries in the first segment were being ovrridden by entries in the 2nd segment (entries in the other segments were all fine).\n\nThat would lead to write some garbage in the entry log and subsequent read failures.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1279 from merlimat/fix-write-cache-segment-index\n","Date":"Wed Mar 21 01:02:39 CET 2018"},{"Commit-ID":"commit 1496ebf8cd0753a92be384e019b7ed6ec03e1ad8 1521699468 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Mar 21 23:17:48 2018 -0700]","Body":"Improve write rejection in DbLedgerStorage\n\nThis PR contain 2 changes that are much related to each other.\n\n1. Changed DbLedgerStorage write cache read-write lock into a `StampedLock`\n   Main reason for using `StampedLock` is that this lock is always taken as a \"read\" lock, when putting entries in the the cache. It is protecting for the swapping of the write cache when the flush is triggered. Most of the time, we have many threads acquiring the read-lock. `StampedLock` is better in this scenario because there isn't any contention in the optimistic path (just a double volatile read).\n\n2. Have a configurable throttle timing when the write cache is really full.\n    If we try to write faster than we can put data in the storage device, eventually both write caches will get full and we have to throttle writes. Added here a setting to configure the amount of time to block the thread (who's calling `Bookie.addEntry()`, it could be IO thread or a addEntryWorker depending on configuration).\n   After the timeout, if we still weren't able to flush the write cache and insert the current entry, bookie will reject the write operation, without logging but rather using a counter to keep track of it.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1280 from merlimat/db-storage-stamped-lock\n","Date":"Thu Mar 22 07:17:48 CET 2018"},{"Commit-ID":"commit dffca1ab4c75f977e6cf96a632fda448b52c46b8 1521774893 -----sp","Author":"PersonIdent[dmsergeevp44, 32652957+dmsergeevp44@users.noreply.github.com, Thu Mar 22 20:14:53 2018 -0700]","Body":"Fixed typos in README.md\n\nAuthor: dmsergeevp44 <32652957+dmsergeevp44@users.noreply.github.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1285 from dmsergeevp44/patch-1\n","Date":"Fri Mar 23 04:14:53 CET 2018"},{"Commit-ID":"commit 1bd2c0eef3af8810e70116633b95c4133183d873 1521927702 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat Mar 24 14:41:42 2018 -0700]","Body":"Improve FileInfoBackingCache\n\nDescriptions of the changes in this PR:\n\nThere are a couple of issues noticed in FileInfoBackingCache:\n\n1) There is a race condition in loadFileInfo between get-check and put. If concurrent loading happens, there might be a FileInfo loaded into the map after get-check. This can cause incorrect reference count on FileInfo.\n\n2) FileLoader is doing I/O operation which happens under a giant write lock.\n\n3) assert is typically not recommended since it is disabled at production runtime typically.\n\n*Changes*\n\n- Check whether fileinfo exists or not after getting write lock and before put\n- Move any I/O operations out of write lock\n- release the new FileInfo if concurrent puts happen\n- remove the usage of assert\n\nBeside that, switch to use ConcurrentLongHashMap to avoid boxing and unboxing.\n\nRelated Issues:\n\n#913 #832\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>\n\nThis closes #1284 from sijie/improve_fileinfo_backing_cache\n","Date":"Sat Mar 24 22:41:42 CET 2018"},{"Commit-ID":"commit 4fe823ba19b86abecaf575b009c55b5d8da51b90 1521927748 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sat Mar 24 14:42:28 2018 -0700]","Body":"Refactored logAndConvertStatus() to avoid allocation when debug is off\n\nThe method `logAndConvertStatus(StatusCode status, int defaultStatus, Object... extraInfo)` is being called when processing the response for each write/read request in `PerChannelBookieClient`.\n\nThe logging is only done at debug level and the `extraInfo` is not used otherwise. By taking the `Object...` we're effectively taking a `Object[]` that is allocated each time, along with the boxing for ledgerId/entryId.\n\nRefactored the code separate the logging and the status code conversion, so that we can skip the allocation when debug is off.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1291 from merlimat/log-and-convert-status\n","Date":"Sat Mar 24 22:42:28 CET 2018"},{"Commit-ID":"commit a36f1ab88034d6b1bdfe75e725886c2e8cca1e85 1522057226 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Mon Mar 26 11:40:26 2018 +0200]","Body":"Implement directly ChannelOutboundHandlerAdapter in BookieProtoEncoding#ResponseEncoder\n\nThis change is mostly a clean up/refactor which drops intermediate MessageToMessageEncoder and MessageToMessageDecoder from BookieProtoEncoding\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\nAuthor: Enrico Olivelli <eolivelli@gmail.com>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Jia Zhai <None>\n\nThis closes #1286 from eolivelli/fix/java9-response-corrupted\n","Date":"Mon Mar 26 11:40:26 CEST 2018"},{"Commit-ID":"commit 52cefcfae654e317f341a58da0d0a07e902eefa3 1522171785 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Mar 27 19:29:45 2018 +0200]","Body":"Issue #1287: NPE at DNS.reverse\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nNull value can be returned on retrieving attributes.\n\n*Solution*\n\nIf null value is returned, throw NamingException so cached localhost name is used.\n\nMaster Issue: #1287\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1295 from sijie/fix_dns_reverse, closes #1287\n","Date":"Tue Mar 27 19:29:45 CEST 2018"},{"Commit-ID":"commit c1947c7b7d7c0a6736b2a35511b5f70072c12972 1522218300 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Mar 27 23:25:00 2018 -0700]","Body":"Add sync variants of all methods in handles\n\nAs discussed on the mailing list [1], this patch removes the\ninconsistency around the naming of the close call on the new handle\nAPIs, by creating sync versions of each async calls, and renaming the\nasync versions to have the suffix \"Async\".\n\nMost of the changes are very mechanical - just a copy of the old\nmethod and some small fixups the javadoc. One thing to note is that\nI've made a copy of the close and closeAsync methods in the\nWriteHandle interface, so that the ReadHandle and Handle javadoc for\nthese methods do not have to talk about what it means to close/seal a\nledger.\n\nAnother change is that I've removed the SneakyThrows from close, that\nwould have also been needed on the other sync methods. Instead, I pass a\nexception handler to FutureUtils which generates a BKException.\n\n[1] https://lists.apache.org/thread.html/c3784cffb949438510d21e5eac8c0351865c6748c42c380e673a60db%3Cdev.bookkeeper.apache.org%3E\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1288 from ivankelly/async-rename\n","Date":"Wed Mar 28 08:25:00 CEST 2018"},{"Commit-ID":"commit 837b94429d8aac3c00b4d7f846a3ba770965f6ab 1522218465 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Tue Mar 27 23:27:45 2018 -0700]","Body":"Create 4.6.2 documentation stub\n\nThis change prepares the directory structure for docs of 4.6.2. New pages are not linked from menu.\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1296 from eolivelli/fix/copy-website-462\n","Date":"Wed Mar 28 08:27:45 CEST 2018"},{"Commit-ID":"commit 31b7db6dffd1eb3169e4304c9864462f56866fc9 1522218781 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Mar 27 23:33:01 2018 -0700]","Body":"Added executeOrdered to complement submitOrdered\n\nIn many cases, we are not interested in the `ListenableFuture` returned by `submitOrdered()` call. In these cases we can avoid creating the future object which will be ignored by calling the `execute()` instead of `submit()` on the underlying executor.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1290 from merlimat/execute-ordered\n","Date":"Wed Mar 28 08:33:01 CEST 2018"},{"Commit-ID":"commit 7149789b03d392cd7aabc4bb2b07186d657f5986 1522300177 -----sp","Author":"PersonIdent[eolivelli, eolivelli@apache.org, Wed Mar 28 22:09:37 2018 -0700]","Body":"Remove references to md5 checksums in download page\n\nAccording to current ASF suggestions, it is better to stop signing release with MD5, so we need to drop the links in the download page.\n\nSee paragraph which states \"MD5 hashes are deprecated; please use SHA for new release\" at https://www.apache.org/dev/release-signing.html\n\nAuthor: eolivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1302 from eolivelli/dropmd5-download\n","Date":"Thu Mar 29 07:09:37 CEST 2018"},{"Commit-ID":"commit 23d1e61c5a7fdb41ffc8ada3618cd0f9cae21103 1522300231 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Wed Mar 28 22:10:31 2018 -0700]","Body":"Drop MD5 signatures from Release Guide and add a reference to git sha in VOTE email template\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1301 from eolivelli/drop-md5-release-guide\n","Date":"Thu Mar 29 07:10:31 CEST 2018"},{"Commit-ID":"commit c36cf2b8263ccea9e1c21ac36ff0d9aebd3a88a3 1522300328 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Mar 28 22:12:08 2018 -0700]","Body":"[DLOG] Fix TestZKLogStreamMetadataStore\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nAll test cases in `TestZKLogStreamMetadataStore` share same zookeeper cluster. so if the tests\nrun before `testGetMissingPathsRecursive` runs, they might create the missing path components\nfor `testGetMissingPathsRecursive`, which will fail the assertion in `testGetMissingPathsRecursive`\n\n*Solution*\n\nAdd unique suffix to \"/path\" for each test case to avoid conflicts\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Yiming Zang <yzang2016@gmail.com>, Jia Zhai <zhaijia@apache.org>, Philip Su <psu@twitter.com>\n\nThis closes #1300 from sijie/fix_zk_log_stream_metadata_store\n","Date":"Thu Mar 29 07:12:08 CEST 2018"},{"Commit-ID":"commit db713f32c24cc9345d8b813aeef9d079b254d16a 1522300620 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Mar 28 22:17:00 2018 -0700]","Body":"[DLOG] use Atomic***FieldUpdater and LongAdder if possible\n\nDescriptions of the changes in this PR:\n\nAtomicFieldUpdater + volatile provides similar guarantees as Atomic but use much fewer memory.\nIn dlog, when handling large number of streams, there can be a lot of Atomic fields with `LogHandler`, `SegmentWriter` and such.\nSwitching using Atomic to using AtomicFieldUpdater + volatile will save a lot of memory. See [details](http://normanmaurer.me/blog/2013/10/28/Lesser-known-concurrent-classes-Part-1/)\n\nLongAdder is less contended across threads, which is more preferable to AtomicLong when multiple threads update a common sum. E.g. SampledMovingAverageRate.\nSwitching to use LongAdder if AtomicLong is not needed. See [details](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/LongAdder.html)\n\nMaster Issue: #<master-issue-number>\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <zhaijia@apache.org>, Philip Su <psu@twitter.com>\n\nThis closes #1299 from sijie/use_atomic_field_updater\n","Date":"Thu Mar 29 07:17:00 CEST 2018"},{"Commit-ID":"commit 2bd24b7bbd531261bb5ca203b02575b1b1eb4890 1522300777 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Wed Mar 28 22:19:37 2018 -0700]","Body":"Issue #1282: call to appendLedgersMap in flushCompactionLog\n\nDescriptions of the changes in this PR:\n\nwith this change https://github.com/apache/bookkeeper/commit/3392beee5c70abe36d36604723e14d97b7764be9 compactionlog was introduced. But for compactionlog call to appendLedgersMap (// Append ledgers map at the end of entry log) isn't made.\n\nSo for these logs, getEntryLogMetadata call has to call extractEntryLogMetadataByScanning for getting the metadata of entrylog. Which is a perf hit.\n\nMaster Issue: #1282\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Yiming Zang <yzang2016@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1283 from reddycharan/compactionlogfix, closes #1282\n","Date":"Thu Mar 29 07:19:37 CEST 2018"},{"Commit-ID":"commit d8c95885136b46013ae942b3d32ae0ea66866dd2 1522329435 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Mar 29 21:17:15 2018 +0800]","Body":"Use reflection based CRC32 to pass direct memory pointer\n\nThe crc update with the bytebuffer is very expensive, especially in netty > 4.1.12.\n\n```java\ncrc.get().update(data.nioBuffer());\n```\n\nConverting a direct`ByteBuf` into a `ByteBuffer` with `data.nioBuffer()` is actually resorting to allocating an unpooled `DirectByteBuffer` which is actually killing the GC (since direct memory is freed when the `DirectByteBuffer` instances are GCed, but the pauses are > 1 second).\n\nThis is an adaptation of a change from Yahoo branch at https://github.com/yahoo/bookkeeper/commit/6c01ca2921a998f3bf2e85cacb27867773e7ea28\n\nInitially I though this change was not needed anymore in 4.7 codebase, and that is true for the CRC32c variant. For the regular CRC32, though, we need to avoid the bad behavior of unpooled direct buffers.\n\nAdditionally, as in #1306, the thread local variable was made static to avoid the leakage of instances per each ledger.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1307 from merlimat/crc32-bytebuffer and squashes the following commits:\n\n8b81245a0 [Matteo Merli] Made classed package private\na7ff1573f [Matteo Merli] Use reflection based CRC32 to pass direct memory pointer\n","Date":"Thu Mar 29 15:17:15 CEST 2018"},{"Commit-ID":"commit 9df8dac295c875ee3395d78a2bab3cda0c3c9ddd 1522364677 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Mar 29 16:04:37 2018 -0700]","Body":"Avoid acquiring closeLock.readLock() on every add/read operation\n\nIn the `BookieClient`, we are always acquiring a readlock when grabbing a connection to use for sending a write/read request.\n\nThe lock is the `closeLock` and it's only acquired in \"write\" mode when the `BookKeeper` instance is closed.\n\nThe problem with the read-lock is that it introduces contention between the threads that are acquiring it (even if all of them in read mode). Multiple threads can be be in read mode in the critical section, though they have contention when they're entering/exiting the section.\n\nAdditionally, the Java implementation of read/write lock is creating and destroying a lot of objects when that contention happens.\n\nMy understanding of the code is that we don't need to acquire the read lock in that point. The reason is that, we are already acquiring the lock in the `lookupClient()` method, although only if the pool is null. Additionally, when `Bookkeeper.close()` is invoked all PCBC will be set to closed as well, so it will not be possibile to create a new connection.\n\nAll the line changes in the patch are just removing the readLock acquire and try/finally, and reducing the indentation level.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1292 from merlimat/bookie-client-rw-lock and squashes the following commits:\n\n2104a3aa7 [Matteo Merli] Converted anonymous classes into lambdas\ncabad14e5 [Matteo Merli] Avoid acquiring closeLock.readLock() on every add/read operation\n","Date":"Fri Mar 30 01:04:37 CEST 2018"},{"Commit-ID":"commit f5b4b7866f34939b5cfa96bbdd3ff26a376c9677 1522632371 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sun Apr 1 18:26:11 2018 -0700]","Body":"Minimize number of thread local instances in CRC32CDigestManager\n\nCRC32CDigestManager uses thread local to store the current crc value (since the crc is computed on the headers and then on the payload).\n\nOne issue is that the thread local instances are per-ledger and are never cleaned up from the thread local storage. As new ledgers get used, we'd have more memory used there.\n\nFor digest we really need 1 single variable\n\nChanges:\n * Use Netty FastThreadLocal instead of JDK ThreadLocal\n * Made the thread local variable static, since one thread is computing the checksum for an entry of a given ledge, before moving to next entry.\n * Minimized thread local `.get()` access since it's more expensive than regular variable access.\n * Removed the usage of `isNewCrc` since initial value for crc32c (as well as crc32) is 0\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1306 from merlimat/impro-crc32c\n","Date":"Mon Apr 02 03:26:11 CEST 2018"},{"Commit-ID":"commit 678b88ca8e7fc313494b34167785b37102e809d0 1522632430 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sun Apr 1 18:27:10 2018 -0700]","Body":"Make CRC32C_HASH a final static variable and log when we cannot use native crc32c library\n\nFor CRC32c there is a marked performance difference when the JNI library is available versus when it's not, since the fallback involves creating many `ByteBuffer`s and copy payloads.\n\nAdditionally we should set the static variable to `final` so the optimizer can get rid of the `(CRC32C_HASH instanceof Sse42Crc32C)` checks.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1303 from merlimat/crc-final\n","Date":"Mon Apr 02 03:27:10 CEST 2018"},{"Commit-ID":"commit 46171e67e526702487641438144f28b7eb1aa07b 1522724592 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon Apr 2 20:03:12 2018 -0700]","Body":"Refactored OrderedSafeExecutor and OrderedScheduler\n\nAs outlined in https://lists.apache.org/thread.html/102383ea42f473f36720637e41af0ee83fc38d9f992736e0d1a7f985%3Cdev.bookkeeper.apache.org%3E\n\nright now `OrderedSafeExecutor` is implemented on top of `OrderedScheduler`.  There are few problems with this approach that are causing impact on performance:\n\n 1. `OrderedScheduler` is a `ScheduledExecutorService` which uses a priority queue for tasks. The priority queue has a single mutex for both publishers/consumers on the queue\n 2. There are many objects created for each task submission, due to listenable future decorators\n\nSince in all cases in critical write/read path we don't need delay task execution or futures, we should try to have a light weight execution for that.\n\n### Modifications\n\n * Inverted the hierarchy between `OrderedSafeExecutor` and `OrderedScheduler`. Now the base class is `OrderedSafeExecutor` and the other extends from it, since it provides additional methods.\n * Moved `OrderedSafeExecutor` in `bookkeeper-common` since `OrderedScheduler` was already there.\n * Moved `OrderedSafeGenericCallback` in its own file, since it needs to be in `bookkeeper-server` module at this point.\n * Changed some method names from `submitOrdered()` into `executeOrdered()` to be consistent with JDK name (`submit()` returns a future while `execute()` returns void).\n * Changed `BookKeeper` instance of `scheduler` into `OrderedScheduler` so that the few cases which were using the `mainWorkerPool` could be easily converted to use the scheduler instead.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Andrey Yegorov <None>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1309 from merlimat/refactor-ordered-executor and squashes the following commits:\n\n9af6eadc2 [Matteo Merli] Fixed findbugs configuration to ignore genereted JMH code\nc85ad21e5 [Matteo Merli] Use ImmutableMap\n22eba18c8 [Matteo Merli] Added microbenchmark\n2c67d0e56 [Matteo Merli] Fix for TestMaxSizeWorkersQueue\n54a72ba1b [Matteo Merli] Fix for TestReadAheadEntryReader\n019d5202d [Matteo Merli] More fixes for submitOrdered\nb8175f311 [Matteo Merli] Fixed array initialization type\n5d68d431d [Matteo Merli] Fixed class names in integration tests\n7c529dde7 [Matteo Merli] Fixed submitOrdered in DL code\nc91259b7d [Matteo Merli] Removed \"final\" modifier on checkQueue\nc5f70d5b4 [Matteo Merli] Merge remote-tracking branch 'apache/master' into refactor-ordered-executor\n957c98309 [Matteo Merli] Correctly handle number of tasks in queue check\ne45f78c09 [Matteo Merli] Renamed into OrderedExecutor and OrderedGenericCallback\n926868429 [Matteo Merli] Refactored OrderedSafeExecutor and OrderedScheduler\n","Date":"Tue Apr 03 05:03:12 CEST 2018"},{"Commit-ID":"commit 80a135f9e1235527f9112309cd3cbd0601757e98 1522788227 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Apr 3 13:43:47 2018 -0700]","Body":"BK configuration file updates\n\nDescriptions of the changes in this PR:\n\n- Change two default values: `fileInfoCacheInitialCapacity` to 1/4 of openFileLimit() and `journalRemoveFromPageCache` to true.\n- Fix default values in conf/bk_server.conf to make them consistent with `ServerConfiguration`\n- Organize the settings into sections for both `conf/bk_server.conf` and `site/_data/config/bk_server.yaml`\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1294 from sijie/update_default_values\n","Date":"Tue Apr 03 22:43:47 CEST 2018"},{"Commit-ID":"commit 980bf9d0a6073d5294c3a2c3c7a9b7fa12fa89fc 1522788348 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Tue Apr 3 13:45:48 2018 -0700]","Body":"Upgrade Maven Assembly Plugin to 3.1.0\n\n- upgrade Maven Assembly Plugin because 2.2.1 version has issues about file permissions\n- explicitly set tarLongFileMode to 'posix' in order to handle user ids with large values\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1313 from eolivelli/upgrade-assembly-master\n","Date":"Tue Apr 03 22:45:48 CEST 2018"},{"Commit-ID":"commit 15d583cb6162cf6beb10591ad3d0b6f436c81ea0 1522788503 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Tue Apr 3 13:48:23 2018 -0700]","Body":"Issue #1304: in listunderreplicated cmd provide option to print missing replicalist\n\nDescriptions of the changes in this PR:\n\nin listunderreplicated bookieshell command,\nprovide option to print missing replicalist\n\nMaster Issue: #1304\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1305 from reddycharan/urlbookies, closes #1304\n","Date":"Tue Apr 03 22:48:23 CEST 2018"},{"Commit-ID":"commit 6bb5bd09ab75b66c71827d07eb94c47ab8867c0f 1522800932 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Apr 3 17:15:32 2018 -0700]","Body":"longPollThreadPool can not be null\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nThe long polling logic is built with the assumption that there is a thread pool for scheduling deferred reads.\nSo if people happens to set `numLongPollWorkerThreads` to zero or negative, a null value is passed into long poll requests which causes NPE.\n\n*Solution*\n\nIf `numLongPollWorkerThreads` is set to zero or negative, fall back to use read thread pool. If there is no read thread pool, create a thread pool\naligned with num processors.\n\nWith this change, turn the default value of `long poll threads` to zero. so no additional threads are needed if long poll feature is not used (e.g. at pulsar).\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Yiming Zang <yzang2016@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1308 from sijie/validate_number_long_poll_threads\n","Date":"Wed Apr 04 02:15:32 CEST 2018"},{"Commit-ID":"commit 7ec5ff3372cde048fa4be464c14ba66bdf6622c7 1522911683 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Thu Apr 5 00:01:23 2018 -0700]","Body":"Issue #1310: Filter out body and masterKey from ProcessorV3s\n\nDescriptions of the changes in this PR:\n\nIn certain logs instances of ProcessorV3 (for eg WriteEntryProcessorV3) are logged.\n\nLogging entry data and credentials details is not appropriate. Filter out\nthose details\n\n(have to consider other ProcessorV3s as well and testcases to validate this change)\n\nMaster Issue: #1310\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1311 from reddycharan/filterlogs, closes #1310\n","Date":"Thu Apr 05 09:01:23 CEST 2018"},{"Commit-ID":"commit bf28ecade1b92204fd97a7cfd9ad3ff885382fbf 1522911726 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Apr 5 00:02:06 2018 -0700]","Body":"newOpenLedgerOp and ReadHandle implementation for MockBookKeeper\n\nThis will allow users of MockBookKeeper to use the new ReadHandle API.\n\nThere are two implementations of the ReadHandle interface. One pure,\nwhich isn't backed by any production code, and another on\nMockLedgerHandle which passes through to the pure implementation.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1298 from ivankelly/better-mock\n","Date":"Thu Apr 05 09:02:06 CEST 2018"},{"Commit-ID":"commit 08d3cf8f014451dbc1485c8fc4985b2ada30a55c 1522911779 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Apr 5 00:02:59 2018 -0700]","Body":"ISSUE #1314: Provide a mechanism to allow high priority writes to readonly bookies\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nCurrently we allow fence requests going through readonly bookies, since fence requests are special read requests. However a ledger can only be sealed after it is successfully recovered. If bookies are in readonly, those recovery writes won't go through.\n\nIf there is a bookie outage happened (e.g. all bookies are readonly), all ledgers are not able to be sealed. It might be good to have a similar setting like minUsableSizeForIndexFileCreation for recovery writes.\n\nThis can improve operability during outage.\n\n*Solution*\n\n- add a setting `minUsableSizeForHighPriorityWrites` to allow accepting high priority writes on readonly bookies.\n\nMaster Issue: #1314\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1315 from sijie/allow_high_priority_writes, closes #1314\n","Date":"Thu Apr 05 09:02:59 CEST 2018"},{"Commit-ID":"commit e6a3aa7e488b87a6d0d08c5bae8564a944815ad7 1522964455 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Apr 5 14:40:55 2018 -0700]","Body":"y\n\nPreviously it was not duplicating, so the underlying ByteBuf was being\nreturned to the client, and this was having its reader index modified,\nwhich meant that if it was read again, the data could not be read.\n\nBy calling duplicate() on the LedgerEntryImpl, the underlying ByteBuf\nis sliced and retained, so it has a new set of indices. The retention\ndoes nothing, as the buffer is unpooled.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1318 from ivankelly/dup-mock\n","Date":"Thu Apr 05 23:40:55 CEST 2018"},{"Commit-ID":"commit 956b37dad75a98b23cff34e8cfe0179e15e6d98a 1523041068 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri Apr 6 11:57:48 2018 -0700]","Body":"Avoid contention on netty channel promise\n\nWith profiler, I have seen there can be heavy contention between BK threads and Netty IO thread due the the checking for channel write condition that was recently added for monitoring purpose.\n\nThe problem relies in that there is one BK thread that is doing the `writeAndFlush()` on the PCBC and getting the `ChannelFuture`, adding a listener to the future.\n\nThe write operation, though, is completed in the Netty IO thread and the promise gets also triggered from that thread. So, there is contention between current thread adding the listener and the IO threads completing the promise.\n\nIf we add the listener before doing the write on channel, we can avoid the contention. Another option could be to do the write from the Netty IO thread as well.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1321 from merlimat/channel-promise-contention\n","Date":"Fri Apr 06 20:57:48 CEST 2018"},{"Commit-ID":"commit ea1a75c0622a93abbd16fd71820f3c0cb5fc3ab0 1523057968 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Apr 6 16:39:28 2018 -0700]","Body":"ISSUE #1316: A bookie with non-writable dirs should be able to start in readonly mode\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nBookie failed to start when it doesn't have non-writable dirs. Issue is reported at #1316\n\n*Solution*\n\n- Introduce a setting `minUsageSizeForEntryLogCreation` to allow creating entry logs even when there is no writable dirs. This setting is replacing `getIsForceGCAllowWhenNoSpace` for creating new log, since entry log files are created not only for gc/compaction. It can also happen on startup and also journal replays.\n\n- Defer creating entry log files until first write happens, when there is no writable ledger dirs.\n\n- add bunch of tests for EntryLog and Bookie initialization.\n\nMaster Issue: #1316\nRelated Issue: #190\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Charan Reddy Guttapalem <reddycharan18@gmail.com>\n\nThis closes #1319 from sijie/allow_bookie_to_start_with_no_writable_bookies, closes #1316\n","Date":"Sat Apr 07 01:39:28 CEST 2018"},{"Commit-ID":"commit 4939416c68f20c990d5c98ee19d59ba662f1b4a0 1523212277 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sun Apr 8 11:31:17 2018 -0700]","Body":"Allow multiple directories in DbLedgerStorage\n\nIn normal conditions, the max throughput that a bookie can sustain is mostly determined by how fast we can write entries on the journal.\n\nIf we assume a *very* fast journal, for example using multiple journal threads and setting `journalSyncData=false` or with the journal on a RAM disk (there are some cases in which it might make sense), then the LedgerStorage becomes the \"bottleneck\". We need to be able to flush data on disk faster than the incoming rate, otherwise the write cache will get full and then we have to apply backpressure.\n\nIn different testing scenario, the bottleneck has become the LedgerStoarge flush/checkpoint because it's done by a single thread.\n\nFor smaller entries (1KB) the limit is ~250 K write/s and the limitation is due to preparing a batch with the offsets to write into rocksdb. Each insertion in the batch needs to cross JNI boundaries and that is expensive.\n\nFor bigger entries (10KB), the limit is ~50K write/s (or 500MB /s). This mostly because the single flush thread cannot drive 100% IO utilization on the disks (since it's doing the rest of work). Raw disk writes in that test environment (12 HDDs) could reach 1.4GB/s.\n\nThis change is only relative to DbLedgerStorage and it's a simple refactoring that, when configured with multiple directories, it will hash a ledger into a certain directory. Each directory is flushed independently on its own thread.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1289 from merlimat/db-storage-multiple-dirs\n","Date":"Sun Apr 08 20:31:17 CEST 2018"},{"Commit-ID":"commit 4aec3cefe6d5e59b03d9f27d4a50ee6f4ddccb37 1523256649 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Mon Apr 9 08:50:49 2018 +0200]","Body":"Release notes for 4.6.2 version\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1297 from eolivelli/fix/releasenotes462\n","Date":"Mon Apr 09 08:50:49 CEST 2018"},{"Commit-ID":"commit c760c566e7ae98d1d4a7a5892c7414480f0c947a 1523259298 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Apr 9 00:34:58 2018 -0700]","Body":"Improve logging on ledger dirs monitor to avoid log flooding\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nWhen a bookie is in readonly mode, the ledger dirs monitor will keep check the disk usage and generate tons of logs if the disk usage is unchanged. This makes debugging much difficult.\n\n*Solution*\n\n- Improve the logging logic in ledger dirs monitor to only log changes when disk usage is changed.\n- Disable logging on checking threshold for high priority writes. Only log changes when high priority writes availability is changed.\n\n*Result*\n\nThis reduces the logging when a bookie is outage in readonly mode.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Yiming Zang <yzang2016@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1322 from sijie/improve_monitor_logging\n","Date":"Mon Apr 09 09:34:58 CEST 2018"},{"Commit-ID":"commit 71901bcd8bb27257b8ef574353d6a851ff6e56f7 1523314883 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Apr 9 16:01:23 2018 -0700]","Body":"Improve \"Failed to resolve network location\" logging\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nRackware/Region-Aware is using a script based DNS resolver for resolving network topology. If the network topology script is not configured, the DNS resolver will return `null` as network location. It results in using `default-rack` as the network location and log \"Failed to resolve network location\" for each resolution.\n\n*Solution*\n\nIf a script file is not provided, throw a runtime exception. So the rackaware/region-aware placement policy can fallback to use the default-rack resolver. It would avoid the logging flood.\n\n*Result*\n\nBefore this change, it will log following statement for each DNS resolution:\n\n\"Failed to resolve network location\".\n\nAfter this change, it will only log following statement during initialization:\n\n```\nINFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl313] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver.\njava.lang.RuntimeException: No network topology script is found when using script based DNS resolver.\n\tat org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.setConf(ScriptBasedMapping.java:150)\n\tat org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:122)\n\tat org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:306)\n\tat org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:75)\n\tat org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:598)\n\tat org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:490)\n```\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Yiming Zang <yzang2016@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1323 from sijie/improve_dns_resolver_logging\n","Date":"Tue Apr 10 01:01:23 CEST 2018"},{"Commit-ID":"commit 2536c91fde3eefe8f426e4e91e05ccfa26294f03 1523343816 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Apr 10 00:03:36 2018 -0700]","Body":"Remove WriteFlags from public API\n\nDescriptions of the changes in this PR:\n\n`DeferredSync` is not implemented at server side. So remove `withWriteFlags` from builder API.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1324 from sijie/remove_write_flag\n","Date":"Tue Apr 10 09:03:36 CEST 2018"},{"Commit-ID":"commit f5a7a2c3ade4a27255551748ded33f724a74d7ca 1523352266 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Apr 10 02:24:26 2018 -0700]","Body":"Update missing configuration settings & missing shell commands\n\nDescriptions of the changes in this PR:\n\nUpdate missing configuration settings & missing shell commands for preparing 4.7.0 release.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1325 from sijie/update_docs\n","Date":"Tue Apr 10 11:24:26 CEST 2018"},{"Commit-ID":"commit 2af991bceb273eb699b93020961ca26cd72d66af 1523359062 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Tue Apr 10 13:17:42 2018 +0200]","Body":"Update News after release of 4.6.2\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1327 from eolivelli/fix/update-news-462\n","Date":"Tue Apr 10 13:17:42 CEST 2018"},{"Commit-ID":"commit 61a227b797695fb8dad0d70fe6c2bb256addde29 1523381172 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Apr 10 10:26:12 2018 -0700]","Body":"Prepare 4.7.0 release\n\nDescriptions of the changes in this PR:\n\n- copy the current `docs/latest` as `docs/4.7.0`\n- bump latest development release to 4.8.0 SNAPSHOT release\n\nbeside that, also change stable version to 4.6.2 release\n\nNOTE: this change doesn't put 4.7.0 in the menu. will update menu and releases page after 4.7.0 is released\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1326 from sijie/prepare_release_4.7\n","Date":"Tue Apr 10 19:26:12 CEST 2018"},{"Commit-ID":"commit d719bb75dce951547f390a0de42d100fe5289387 1523388396 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Apr 10 12:26:36 2018 -0700]","Body":"[maven-release-plugin] prepare branch branch-4.7\n","Date":"Tue Apr 10 21:26:36 CEST 2018"},{"Commit-ID":"commit 49fda75662b85712d3eae77484cf38b40b74abe1 1523388407 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Apr 10 12:26:47 2018 -0700]","Body":"[maven-release-plugin] prepare for next development iteration\n","Date":"Tue Apr 10 21:26:47 CEST 2018"},{"Commit-ID":"commit 8cd9f91bd49b0453e2ee5e787d5a5729255b466c 1523425677 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Apr 10 22:47:57 2018 -0700]","Body":"Create CI jobs for branch-4.7\n\nDescriptions of the changes in this PR:\n\nWe need to CI jobs running for subsequent minor releases on branch-4.7.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1328 from sijie/create_ci_job_for_4.7\n","Date":"Wed Apr 11 07:47:57 CEST 2018"},{"Commit-ID":"commit ca4d4e0590a45cb377db348c08f90fb2ec0b0147 1523440351 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Apr 11 02:52:31 2018 -0700]","Body":"[maven-release-plugin] prepare for next development iteration (missing modules)\n","Date":"Wed Apr 11 11:52:31 CEST 2018"},{"Commit-ID":"commit 9921613829dba70a2903ee19ddfc4dc757fb39ab 1523517277 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Apr 12 00:14:37 2018 -0700]","Body":"Issue #1335: LocalBookKeeper doesn't work with metadata service uri\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\n`\"zk+hierarchical://localhost:2181/ledgers\"` is invalid because `\"` is an invalid character.\n\n*Solution*\n\nFix the invalid settings in `bk_server.conf`\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1337 from sijie/fix_invalid_settings, closes #1335\n","Date":"Thu Apr 12 09:14:37 CEST 2018"},{"Commit-ID":"commit 3d39435d316bc05e64c4247aeb8455bcd2a96989 1523575809 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Apr 12 16:30:09 2018 -0700]","Body":"Use metadata service uri rather than zkServers\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nMetadata service uri is introduced as part of BP-29. However most of the tests and tools are still assuming `zkServers`.\nThis causes a problem if people configures `metadataServiceUri`, some of the admin tools don't actually work.\n\n*Solution*\n\nThis change changes bookkeeper to use `metadataServiceUri` in all the possible places and provides methods to resolve zkServers\nand zkLedgersRootPath from metadata service uri. This ensures:\n\n1) if users configure `metadataServiceUri`, all the tools would work properly.\n2) if users doesn't configure `metadataServiceUri` and still use `zkServers` and `zkLedgersRootPath`, all the tools would still work.\n\n*Changes*\n\nThe main changes are:\n\n- deprecated direct usage of `getZkServers`, `setZkServers`, `getZkLedgersRootPath`, `setZkLedgersRootPath, `getZkAvailablePath` at AbstractConfiguration\n- provide util methods `resolveZkServers` and `resolverZkLedgersRootPath` in `ZkMetadataDriverBase` for resolving zookeeper specific settings from metadata service uri\n- change the tools to use `getMetadataServiceUri`\n- change the tests to use `getMetadataServiceUri` to ensure code coverage\n\n*NOTES*\n\nThere are a few places still using `getZkServers`, `setZkServers`. those are hard to change at this moment.\n\nRelated Issue:\n- #1335\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1336 from sijie/fix_local_bookkeeper\n","Date":"Fri Apr 13 01:30:09 CEST 2018"},{"Commit-ID":"commit c3e96a76be35a0adb6f700491dd0a8786d5b2957 1523637853 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Apr 13 09:44:13 2018 -0700]","Body":"Fallback to use `getZkServers` and `getZkLedgersPath` when resolving from metadata service uri\n\nDescriptions of the changes in this PR:\n\n*Problme*\n\nDlog tests are failing because dlog is using an external zookeeper client, where both `zkServers` and `metadataServiceUri`\nare not set on client configuration. It will throw NPE when trying to resolve `zkServers` and `zkLedgersRootPath` from metadata service uri.\n\n*Solution*\n\nFallback to use deprecated `getZkServers` and `getZkLedgersPath` when metadata service uri is null\n\nRelated Issues: #1336\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1338 from sijie/fix_dlog_tests\n","Date":"Fri Apr 13 18:44:13 CEST 2018"},{"Commit-ID":"commit 51c26dcf3446ef0bf2bc7c753e5d188e29123ae8 1523830058 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Apr 15 15:07:38 2018 -0700]","Body":"Only check ipv6 binding when /sbin/sysctl exists\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nIf bookkeeper is included in some slim docker images, sysctl might not exists at all.\nIt would fail bookie to start.\n\n*Solution*\n\nOnly check ipv6 binding when /sbin/sysctl exists\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1340 from sijie/disable_ipv6_binding\n","Date":"Mon Apr 16 00:07:38 CEST 2018"},{"Commit-ID":"commit 7f010d29cbef0cbdf75b472df28cd9ea85f5c419 1523830135 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Apr 15 15:08:55 2018 -0700]","Body":"Update release schedule for 4.8.0\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1341 from sijie/update_release_schedulea\n","Date":"Mon Apr 16 00:08:55 CEST 2018"},{"Commit-ID":"commit 1242e3757c3dffd3c846787756c49779aee31d13 1523948189 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Apr 16 23:56:29 2018 -0700]","Body":"Provide memory & gc options in bookkeeper script\n\nDescriptions of the changes in this PR:\n\nIt is convenient to provide `MEM_OPTS` and `GC_OPTS` in bookkeeper script and bkenv.sh to allow overriding jvm settings through.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1342 from sijie/gc_settings\n","Date":"Tue Apr 17 08:56:29 CEST 2018"},{"Commit-ID":"commit 8248a4d790607436c5709b1dca2d929115b47331 1523990464 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Apr 17 11:41:04 2018 -0700]","Body":"[RELEASE-4.7.0] update docker file\n\nDescriptions of the changes in this PR:\n\nupdate the release version from 4.6.0 to 4.7.0 and its corresponding gpg key\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1351 from sijie/update_docker_file\n","Date":"Tue Apr 17 20:41:04 CEST 2018"},{"Commit-ID":"commit 1f265385ea03e8ca15693d8547f0fa04062e32bc 1523995181 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Apr 17 12:59:41 2018 -0700]","Body":"[RELEASE-4.7.0] upgrade guide and release notes\n\n- add upgrade for 4.6.x to 4.7.0\n- backfill upgrade guide in old releases\n- add release notes for 4.7.0\n- add 4.7.0 to releases\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1330 from sijie/update_release_notes\n","Date":"Tue Apr 17 21:59:41 CEST 2018"},{"Commit-ID":"commit a71da1d1bae1790c913b773cdb14f61374687625 1524072616 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Wed Apr 18 10:30:16 2018 -0700]","Body":"Issue #570: Introducing EntryLogManager.\n\nDescriptions of the changes in this PR:\n\nIntroducing EntryLogManager interface, which abstracts out current activeLogChannel,\nrotatedLogChannels and corresponding lock for activeLogChannel. The current logic of\nhandling logs is moved to EntryLogManagerForSingleEntryLog class, in the\nnext sub-task EntryLogManagerForEntryLogPerLedger will be introduced. Also there\nare minor changes to createNewLog logic and leastUnflushedLogId logic.\n\nThis is < sub-task5  > of Issue #570\n\nMaster Issue: #570\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1281 from reddycharan/entrylogmanager, closes #570\n","Date":"Wed Apr 18 19:30:16 CEST 2018"},{"Commit-ID":"commit 325dd9308896cd924bf78f3437824622a91f125a 1524072757 -----sp","Author":"PersonIdent[Nicolas Michael, nmichael@salesforce.com, Wed Apr 18 10:32:37 2018 -0700]","Body":"ISSUE #1354: Spin-Wait for I/O completion wastes CPU time in BK Client\n\nIssue 1354: Spin-Wait for I/O completion wastes CPU time in BK Client (JDK8)\n\nThis bugfix for issue 1354 changes the call of CompletableFuture.get() in SyncCallbackUtils.waitForResult() to CompletableFuture.get(Long.MAX_VALUE, TimeUnit.NANOSECONDS), which leads to the same behavior, but avoids spinning (and thus reduces CPU consumption) in JDK8.\n\nAuthor: Nicolas Michael <nmichael@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1355 from nicmichael/FutureNoSpin, closes #1354\n","Date":"Wed Apr 18 19:32:37 CEST 2018"},{"Commit-ID":"commit c21c53bd7de8341d1e0b5c3c8d5d2e1c33857f93 1524121588 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Apr 19 00:06:28 2018 -0700]","Body":"[RELEASE-4.7.0] add integrationtests CI job for branch-4.7\n\nDescriptions of the changes in this PR:\n\nadd integrationtests CI job for branch-4.7\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1353 from sijie/make_it_test_as_postcommit_jobs\n","Date":"Thu Apr 19 09:06:28 CEST 2018"},{"Commit-ID":"commit 7fe8427bbd00603ef07f6846f27a6cc4f2fa1376 1524121752 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Apr 19 00:09:12 2018 -0700]","Body":"ISSUE #1246: Scripting the whole release procedure\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nReleasing bookkeeper becomes tricky after introducing `circe-checksum`, since we need to ensure linux jni library is shipped as part of `circe-checksum`.\n\n*Solution*\n\n- switch to use docker for generating bookkeeper release\n- scripting the whole release procedure as many as possible\n\nMaster Issue: #1246\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1329 from sijie/release_scripts, closes #1246\n","Date":"Thu Apr 19 09:09:12 CEST 2018"},{"Commit-ID":"commit a02b3f494331e830f7b34c9d833069af4db8e81c 1524212231 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Fri Apr 20 01:17:11 2018 -0700]","Body":"In EntryLogger.addEntry method, rollLog flag should not be ignored.\n\nIn EntryLogger.addEntry method, rollLog flag should not be ignored.\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1359 from reddycharan/fixrolllogcall\n","Date":"Fri Apr 20 10:17:11 CEST 2018"},{"Commit-ID":"commit f78ea8238b44c8ae52ea6cf9445228afdeffc7aa 1524531125 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Mon Apr 23 17:52:05 2018 -0700]","Body":"Add config BK_metadataServiceUri for docker\n\nDescriptions of the changes in this PR:\n\nWhile trying docker in 4.7.0 release, found that the new config parameter `metadataServiceUri` was changing leaked, and docker could not run success.\nThis change add the config `BK_metadataServiceUri` for docker config, and make docker 4.7.0 runs success.\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1362 from jiazhai/docker_conf\n","Date":"Tue Apr 24 02:52:05 CEST 2018"},{"Commit-ID":"commit e9aeddd89623bf1cd0c9ecb8ef200c7a3dd47f95 1524548297 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Apr 23 22:38:17 2018 -0700]","Body":"[RELEASE-4.7.0] update BC tests\n\nDescriptions of the changes in this PR:\n\nadd 4.6.2 and 4.7.0 to BC tests list\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1352 from sijie/update_bc_tests\n","Date":"Tue Apr 24 07:38:17 CEST 2018"},{"Commit-ID":"commit e021ac31cb1acb8de6d4161a618e76127d04d1c8 1524565052 -----sp","Author":"PersonIdent[Nicolas Michael, nmichael@salesforce.com, Tue Apr 24 12:17:32 2018 +0200]","Body":"Issue #791: Eliminate byte[] copies in AddEntry code path\n\nThe AddEntry code path in Bookkeeper Client performs several copies of the send buffer before sending it out to bookies, which not only costs CPU cycles for array copying, but also drives up object allocation rate and thus increases young GC frequency.\n\nCurrently, the send buffer is prepared by DigestManager.computeDigestAndPackageForSending(), which wraps the netty ByteBuf containing the data together with a (direct) header buffer into a ByteBufList. So far, we haven't yet allocated or copied any new buffers. But in order to send the buffer to the bookies, PendingAddOp.safeRun() will invoke sendWriteRequest() for each bookie in the write set, which will eventually invoke PerChannelBookieClient.addEntry() for each bookie. In here, we are now allocating two new byte[] and copying the buffer twice per bookie for V3 protocol with protobuf:\n    byte[] toSendArray = toSend.toArray();      // 1st byte[] allocation and copy\n    .setBody(ByteString.copyFrom(toSendArray)); // 2nd byte[] allocation and copy\nIf for example we're using a write set size of 3, then we allocate 6 byte arrays and copy the same buffer 6 times.\n\nAll 6 copies can be eliminated if DigestManager.computeDigestAndPackageForSending() would return a ByteBuf (or ByteBufList) that is backed by an array, which we can access and use without further copying it. PerChannelBookieClient.addEntry() could then wrap this array into a protobuf ByteString without performing any additional copies.\n\nThis change eliminates all byte[] allocations and copies in PCBC by:\n1. allocating a new (pooled) array-backed heap ByteBuf for header, digest, and data in DigestManager.computeDigestAndPackageForSending()\n2. copying the data payload into this newly allocated ByteBuf and returning it wrapped into a ByteBufList of size 1 (instead of header + body separately)\n3. enhancing ByteBufList to give access to the underlying array if it consists of only a single ByteBuf that's backed by an array\n4. extracting the underlying array in PerChannelBookieClient.addEntry() from ByteBufList and wrapping it into protobuf ByteString without copying it.\n\nWith this change, no more object allocations are required in this code path. DigestManager uses a pooled array (1). We're adding one arraycopy in (2) compared to the original code path, trading this against the allocations and copies we save later on.. Later steps, in particular step (4), is free of object allocation and array copies.\nAs a result, the object allocation rate in the AddEntry code path is reduced significantly. In case of a write set size of 3, it is reduced from 6 to 0. This translates into much less frequent young generation garbage collections (in my experiments with write-heavy workload by ~4x overall).\n\nAuthor: Nicolas Michael <nmichael@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1361 from nicmichael/AddEntryNoCopy, closes #791\n","Date":"Tue Apr 24 12:17:32 CEST 2018"},{"Commit-ID":"commit ed3b0105d0e1adbb118641cc39f886659d140361 1524647376 -----sp","Author":"PersonIdent[Nicolas Michael, nmichael@salesforce.com, Wed Apr 25 02:09:36 2018 -0700]","Body":"Issue #1363: Fast and Garbage-Free Codahale Statistics Timers\n\nThis change introduces a new Codahale-based metrics provider \"FastCodahaleMetricsProvider\" in the codahale-metrics-provider artifact, which can be activated through the \"statsProviderClass\" config parameter (no changes made to the existing \"CodahaleMetricsProvider\"). This new \"FastCodahaleMetricsProvider\" brings a new timer implementation \"FastTimer\", which extends Codahale's Timer class, provides an identical API, is registered in Codahale's timer registry, and can be queried through the existing JettyServices implementation. FastTimer provides similar functionality as Codahale's default timer, but is significantly faster and (nearly) garbage free.\n\nThe improvements of FastTimer over Codahale default Timer with ExponentiallyDecayingReservoirs are:\n* entirely garbage-free Timer updates (only snapshot creations when querying a timer allocate a small number of Java objects)\n* 3x faster Timer updates (i.e. 3x shorter code-path to update a timer)\n* half the memory footprint (in default configuration)\n\nFastTimer reduces GC pause times in our experiments as described in Issue 1363 by half (same as entirely deactivating all timers).\n\nThe primary functional differences between FastTimer and Codahale default Timer with ExponentiallyDecayingReservoirs are:\n* FastTimer keeps values for a fixed, configurable time period (default: 60 seconds) rather than exponentially decaying them\n* FastTimer bucketizes event times rather than storing discrete values. Percentile values depend on the bucket resolution.\n\nDesign Considerations\n---------------------\n\nThe design goals of this timer implementation are for it to be\n - fast (i.e. few instructions to update a timer)\n - scalable (i.e. little synchronization cost for concurrent timer updates)\n - garbage-free for timer updates (i.e. no object allocation for timer updates)\n - space-efficient (i.e. as little memory footprint as possible while achieving first three goals)\n - provide similar functionality as Codahale's default timers with ExponentiallyDecayingReservoirs\n\nThis implementation provides rate and response times over a configurable sliding time window. Data\nis stored in upfront allocated circular arrays, in which each array element holds data\nfor one second. Data is overwritten in a circular fashion without the allocation of new data\nstructures and is therefore garbage-free for all timer updates.\n\nThis implementation does not store individual response times, but instead allocates bucketized counters\nupfront, which are incremented for any event falling into a particular response time bucket. A\nfine-grained bucket definition (intended for capturing successsful events) and a coarse-grained\nbucket definition (intended to capture failure or timed-out events) are provided.\n\nTo improve scalability of concurrent timer updates, most data structures are replicated HASH_SIZE\ntimes, and calling threads updating a timer are hashed to individual instances. Performance tests\n(see below) have shown that this implementation is light-weight enough to achieve slightly better\nscalability than Codahale's default timers even without hashing, and can further improve scalability\nif hashing is used.\n\nTrading off performance and scalability vs. memory footprint, we need to be conservative in the hash\nsize we chose. Different flavors of this timer implementation have been evaluated using JMH\nmicro-benchmarks (see microbenchmarks/src/main/java/org/apache/bookkeeper/stats/TimerBenchmark.java),\ncomparing implementations of FastTimer with a time window of 60 seconds and\n- (DEV1)   a HASH_SIZE of 3 for all data structures (meters, counters, min/max, and response time buckets)\n- (DEV2)   a HASH_SIZE of 1 for all data structures (meters, counters, min/max, and response time buckets)\n- (FINAL)  a HASH_SIZE of 3 for meters, counters, min/max, and no hashing for response time buckets\nto the default timer implementation\n- (BASE-E) Codahale Timer with ExponentiallyDecayingReservoir (default as used by bookkeeper code)\n- (BASE-T) Codahale Timer with SlidingTimeWindowReservoir configured to 60 seconds\n- (BASE-S) Codahale Timer with SlidingWindowReservoir configured to hold 100,000 events.\n\nBased on results below, implementation (FINAL) was chosen as the final FastTimer implementation, as it\nachieves nearly the same throughput as (DEV1) at nearly the same memory footprint as (DEV2), and\nultimately achieves roughly 3x higher throughput and scalability that Codahale's default implementation\nat around half the memory footprint.\n\nThe following results have been collected on an eight core x86 server running at 3.2 GHz (updated\ntimers are shared across 4 threads):\n\n```\nConfig   Timer Impl             Timers   Threads      ops/ms   Alloc B/op   Kb/TimerPair\n----------------------------------------------------------------------------------------\n DEV1    FastTimer (Hash 3)          1         4   11487.904        0                253\n DEV1    FastTimer (Hash 3)         10         4   22621.702        0                253\n DEV1    FastTimer (Hash 3)        100         4   21781.319        0                253\n DEV2    FastTimer (Hash 1)          1         4    5138.143        0                 88\n DEV2    FastTimer (Hash 1)         10         4   22902.195        0                 88\n DEV2    FastTimer (Hash 1)        100         4   19173.085        0                 88\n FINAL   FastTimer (Hash 3/1)        1         4    9291.002        0                 99\n FINAL   FastTimer (Hash 3/1)       10         4   16379.940        0                 99\n FINAL   FastTimer (Hash 3/1)      100         4   16751.020        0                 99\n BASE-E  CodahaleTimer               1         4    3845.187       82.609            189\n BASE-E  CodahaleTimer              10         4    7262.445       35.035            189\n BASE-E  CodahaleTimer             100         4    7051.77        32.843            189\n BASE-T  CodahaleTimer/TimeWindow    1         4     102.479       90.851            174\n BASE-T  CodahaleTimer/TimeWindow   10         4      68.852       84.812            174\n BASE-T  CodahaleTimer/TimeWindow  100         4     153.444      136.436            174\n BASE-S  CodahaleTimer/SlidingWdw    1         4    4670.543        0               2103\n BASE-S  CodahaleTimer/SlidingWdw   10         4   13696.168        0               2103\n BASE-S  CodahaleTimer/SlidingWdw  100         4   12541.936        0               2103\n```\n\n- ops/ms is the number of timer updates per millisecond.\n- Alloc B/op is the number of bytes allocated per timer update\n- Kb/TimerPair is the heap footprint per pair of timers (one with fine-grained, one with coarse-grained buckets)\n\nThe following test results include snapshot creation every 109 timer updates (typically, we would assume\nsnapshot creation to be much less frequent), and show that also with snapshots in the mix, FastTimer outperforms\nCodahale default Timers both with respect to throughput and scalability as well as object allocation:\n\n```\nConfig   Timer Impl             Timers   Threads      ops/ms   Alloc B/op\n-------------------------------------------------------------------------\n FINAL   FastTimer (Hash 3/1)        1         4    1569.953       23.707\n FINAL   FastTimer (Hash 3/1)       10         4    7316.794       24.073\n FINAL   FastTimer (Hash 3/1)      100         4    6498.215       24.073\n BASE-E  CodahaleTimer               1         4     246.953      481.771\n BASE-E  CodahaleTimer              10         4    1989.134      476.807\n BASE-E  CodahaleTimer             100         4    1514.729      468.624\n BASE-T  CodahaleTimer/TimeWindow    1         4       6.063    43795.810\n BASE-T  CodahaleTimer/TimeWindow   10         4      44.651    33916.315\n BASE-T  CodahaleTimer/TimeWindow  100         4     180.431    12330.939\n BASE-S  CodahaleTimer/SlidingWdw    1         4      17.439    14683.756\n BASE-S  CodahaleTimer/SlidingWdw   10         4     107.257    14683.745\n BASE-S  CodahaleTimer/SlidingWdw  100         4     236.538     9767.106\n```\n\nUnfortunately Codahale does not have a Timer interface we can implement, and some Codahale\nbase classes are assuming instances of Timer (for example, our JettyServices instantiate a\nCodahale MetricsServlet, which instantiates a Codahale MetricsModule, which only serializes\ntimers that are instances of Timer class into the json output stream). Unless we wanted to\nreimplement or override all these base classes, we can't just implement Codahale's Metered and Sampling\ninterfaces. Instead we have to extend its Timer class, even though we're not using any of its\ninherited functionality or data structures. The inherited (unused) member variables of Codahale Timer\nconsume slightly less than 512 byte per FastTimer (measured around 425 byte in Codahale 3.1).\nAbove memory footprint results include ~ 1 kb of inherited (unused) data structures, which comprise\naround 1% of FastTimer's overall memory footprint.\n\nIn terms of functionality, FastTimer provides the same functionality as Codahale's timers\n(in default configuration with ExponentiallyDecayingReservoirs), with the following exceptions:\n- Statistics are kept for a fixed amount of time (rather than exponentially decayed), by\n  default 60 seconds. As a consequence, getMeanRate(), getOneMinuteRate(),  getFiveMinuteRate()\n  and getFifteenMinuteRate() all return the same value if FastTimer is configured to use a\n  60 second time window.\n- FastTimer and FastSnapshot only record bucketized instead of discrete response times. As a\n  consequence, the accuracy of percentiles depends on bucket granularity. FastSnapshot also\n  can't return discrete values: getValues() returns an empty array, and size returns 0.\n\nAuthor: Nicolas Michael <nmichael@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1364 from nicmichael/FastTimer, closes #1363\n","Date":"Wed Apr 25 11:09:36 CEST 2018"},{"Commit-ID":"commit 82ad464d3b40e0f69e55556ae15ad06f29ec5003 1524647506 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Wed Apr 25 02:11:46 2018 -0700]","Body":"Issue #1345: entrylogger.flush should flush currentlog first.\n\nDescriptions of the changes in this PR:\n\nIt is incorrect to call flushrotatedlogs first and\nthen flushcurrentlogs in the EntryLogger\n(EntryLogManager) flush method. It should be other way around.\n\nMaster Issue: #1345\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1360 from reddycharan/elmflushorder, closes #1345\n","Date":"Wed Apr 25 11:11:46 CEST 2018"},{"Commit-ID":"commit 2edcaa60303270152991307260846c201c57d9b5 1524647608 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Apr 25 02:13:28 2018 -0700]","Body":"[TABLE SERVICE] Dlog based checkpoint store\n\n*Motivation*\n\nCurrently the table range stores are using local filesystem as a checkpoint store. It is okay for running as standalone mode.\nBut it doesn't work to run in a distributed mode. This change is introducing a dlog based checkpoint store to make sure all\nthe sst files of table ranges are durably checkpointed into bookkeeper itself.\n\n*Solution*\n\nIntroduced a dlog based checkpoint store.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1366 from sijie/dlog_checkpoint_manager\n","Date":"Wed Apr 25 11:13:28 CEST 2018"},{"Commit-ID":"commit 9c3e8c9f835781507ac833473abc39e821bdbf36 1524798767 -----sp","Author":"PersonIdent[Andrey Yegorov, dlg99@users.noreply.github.com, Thu Apr 26 20:12:47 2018 -0700]","Body":"ISSUE #1086 (@bug W-4146427@) Client-side backpressure in netty (Fixes: io.netty.util.internal.OutOfDirectMemoryError under continuous heavy load) (#1088)\n\n* ISSUE #1086 (@bug W-4146427@) Client-side backpressure in netty (Fixes: io.netty.util.internal.OutOfDirectMemoryError under continuous heavy load)","Date":"Fri Apr 27 05:12:47 CEST 2018"},{"Commit-ID":"commit a3c141eee827c583828251756d4e52a70398b7af 1524872029 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Fri Apr 27 16:33:49 2018 -0700]","Body":"Issue #570: Introduce EntryMemTableWithParallelFlusher\n\nDescriptions of the changes in this PR:\n\nThis is < sub-task4  > of Issue #570\n\nWhen there is going to be entrylog per ledger, then for\nbetter utilizing the availability of multiple entrylogs,\nparallel flush of entrymemtable can be done. In this\nsub-task EntryMemTableWithParallelFlusher is introduced,\nwhich uses OrderedExecutor with \"numOfMemtableFlushThreads\"\nnumber of threads.\n\nMaster Issue: #570\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1358 from reddycharan/memtableparallel, closes #570\n","Date":"Sat Apr 28 01:33:49 CEST 2018"},{"Commit-ID":"commit 1f0f92c0c0cfc0cafe0cab976d8c5fbdf34c10d3 1525130948 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Apr 30 16:29:08 2018 -0700]","Body":"OrderedScheduler#chooseThread(key) handle null key\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nIt is more convenient if OrderedScheduler#chooseThread(key) can handle null key. so the applications who is using #chooseThread don't need to worry which method to choose - `chooseThread()` vs `chooseThread(key)`.\n\n*Solution*\n\nin `chooseThread(key)`, fallback to randomly pickup a thread if key is null.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1372 from sijie/order_scheduler_null_key\n","Date":"Tue May 01 01:29:08 CEST 2018"},{"Commit-ID":"commit c4af73427378312d9e7d50cc06a9523a78ecaf41 1525319944 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Wed May 2 20:59:04 2018 -0700]","Body":"BP-32: Advisory (optimistic) write close\n\nDescriptions of the changes in this PR:\n\ninitial proposal for Advisory (optimisitic) write close\n\nMaster Issue: #1343\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1374 from reddycharan/advwriteclosebp\n","Date":"Thu May 03 05:59:04 CEST 2018"},{"Commit-ID":"commit 843dd035b3ed8ff890bad176021319abf4871220 1525321182 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed May 2 21:19:42 2018 -0700]","Body":"[TABLE SERVICE] apply backoff policy to rpc requests if storage container is not found\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nA storage container can move between servers due to failures, or it can take time to start on a server. During that short period of time, it is \"unavailable\" and clients will receive `Status.NOT_FOUND` from grpc channels. The client should retry on this error and attempt to re-locate the storage container again.\n\n*Modification*\n\n- add backoff policy in client settings\n- apply the backoff policy at storage container channel. if it receives `NOT_FOUND` grpc exception, it will reset the server channel, so subsequent requests will re-attempt to relocate the storage container.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1379 from sijie/rpc_backoffs\n","Date":"Thu May 03 06:19:42 CEST 2018"},{"Commit-ID":"commit 7580ce9dd8449f777e35b580bb6786f12d7703bc 1525329490 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Wed May 2 23:38:10 2018 -0700]","Body":"ZKLedgerManager.writeLedgerMetadata should return appropriate error.\n\nDescriptions of the changes in this PR:\n\nZKLedgerManager.writeLedgerMetadata should return\nNoSuchLedgerExistsException error in the case it\ngets KeeperException.Code.NONODE rc value from ZK.\nZKLedgerManager.removeLedgerMetadata does that as well.\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1382 from reddycharan/abstractzkledgermanagerissue\n","Date":"Thu May 03 08:38:10 CEST 2018"},{"Commit-ID":"commit d47efa9fcc4601228d14219275b8d450256ccca8 1525375854 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu May 3 12:30:54 2018 -0700]","Body":"ISSUE #1384: Bump checkstyle version\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nmvn build fails on a centos/7 box. Exceptions are thrown as below:\n\n```\n[ERROR] Failed to execute goal org.apache.maven.plugins:maven-checkstyle-plugin:2.17:check (checkstyle) on project circe-checksum: Execution checkstyle of goal org.apache.maven.plugins:maven-checkstyle-plugin:2.17:check failed: An API incompatibility was encountered while executing org.apache.maven.plugins:maven-checkstyle-plugin:2.17:check: java.lang.NoSuchMethodError: org.slf4j.spi.LocationAwareLogger.log(Lorg/slf4j/Marker;Ljava/lang/String;ILjava/lang/String;Ljava/lang/Throwable;)V\n```\n\n*Solution*\n\nThe problem was addressed in https://issues.apache.org/jira/browse/MCHECKSTYLE-335. We need to bump the checkstyle plugin version to `3.0.0`\n\nMaster Issue: #1384\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1385 from sijie/vagrant_files, closes #1384\n","Date":"Thu May 03 21:30:54 CEST 2018"},{"Commit-ID":"commit 0b01c125df58dc85d5f965ce151a278d37ec6d3c 1525375894 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu May 3 12:31:34 2018 -0700]","Body":"Fix format problem of BP-32\n\nAlso mark BP-32 as accepted.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Charan Reddy Guttapalem <reddycharan18@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1383 from sijie/fix_typos\n","Date":"Thu May 03 21:31:34 CEST 2018"},{"Commit-ID":"commit 92525c2ae30f41badb3986e3bc69de3aceb67e2d 1525387666 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu May 3 15:47:46 2018 -0700]","Body":"Fix TestCompatUpgrade\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\n #1352 update the BC tests to include newer versions, however it removes the flags that used for 4.6.0 to handle badly shutdown.\n This change makes the BC tests become very flaky.\n\n*Solution*\n\n- apply `badlyshutdown` flag to both from 4.6.0 to 4.6.1 and from 4.6.1 to 4.6.2 upgrade\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nThis closes #1386 from sijie/vagrant_files\n","Date":"Fri May 04 00:47:46 CEST 2018"},{"Commit-ID":"commit cf7a72b011378ac5be8e04edd35dfb97e00cedab 1525387770 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Thu May 3 15:49:30 2018 -0700]","Body":"Refactor EntryLogger class\n\nDescriptions of the changes in this PR:\n\n- Split EntryLogger class into multiple classes.\n- create separate classes for EntryLogManager, EntryLoggerAllocator and EntryLogManagerForSingleEntryLog.\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1365 from reddycharan/refactorentrylogger\n","Date":"Fri May 04 00:49:30 CEST 2018"},{"Commit-ID":"commit 20e3f6c3e16e409b03d3d0fefad699c856ca3b49 1525399647 -----sp","Author":"PersonIdent[Andrey Yegorov, ayegorov@salesforce.com, Thu May 3 19:07:27 2018 -0700]","Body":"ISSUE #1387: added unit test for LedgerHandleAdv handling of attempts to use LedgerHandle's specific API calls (add without specifying entry id)\n\nDescriptions of the changes in this PR:\n\n- added unit test.\n\nMaster Issue: #1387\n\nAuthor: Andrey Yegorov <ayegorov@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1388 from dlg99/fix/ISSUE-1387_LedgerHandleAdv_with_nonAdv_usage, closes #1387\n","Date":"Fri May 04 04:07:27 CEST 2018"},{"Commit-ID":"commit 9134401954e860021a1a7314c55861eca0481ae6 1525399715 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu May 3 19:08:35 2018 -0700]","Body":"[TABLE SERVICE] [DLOG] Fix `ConcurrentModificationException` on accessing component configuration\n\nDescriptions of the changes in this PR:\n\n*Motiviation*\n\nCurrently when running table service in standalone mode, it occasionally throws `ConcurrentModificationException`. Because\nmultiple components are sharing same underlying composite configuration. It causes the contention between copying keys and retrieving keys.\n\n*Solution*\n\nChange the component configuration to use a concurrent hashmap based configuration. Also changed the `loadConf` behavior to copy the keys / sub-keys\ninto the component configuration. This prevents components sharing same underlying composite configuration.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1378 from sijie/fix_conf\n","Date":"Fri May 04 04:08:35 CEST 2018"},{"Commit-ID":"commit acb4e653428f38337af94bcb829956b44e39312d 1525399755 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu May 3 19:09:15 2018 -0700]","Body":"Make bookie state manager & registration manager reusable outside of bookie\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nSince 4.6.0, we have already abstracted a pretty good interfaces around registration service and state management. Most of the classes can actually be reused for use cases that have similar service discovery and writable/readonly state transition management.\n\n*Solution*\n\nThe change is try to cleanup `BookieStateManager` and `ZKRegistrationManager` to make them more generic and can be reused for other usage.\n\n*Result*\n\nRegistration Interfaces and StateManager can be used outside of bookie.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1373 from sijie/refactor_bookie_state_manager\n","Date":"Fri May 04 04:09:15 CEST 2018"},{"Commit-ID":"commit e77a80a74454f25ff315450bc50cf392ed3bc94f 1525608384 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun May 6 20:06:24 2018 +0800]","Body":"Add smoke tests for LedgerHandleAdv and TailingReads\n\nDescriptions of the changes in this PR:\n\nAdd two tests:\n\n- basic writes/reads with LedgerHandleAdv\n- tailing reads with LedgerHandle\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1389 from sijie/more_integration_tests\n","Date":"Sun May 06 14:06:24 CEST 2018"},{"Commit-ID":"commit 0ccde17214168ec1f87741d1053ef66ce2344fff 1525682790 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Mon May 7 16:46:30 2018 +0800]","Body":"Enable Prometheus stats provider to use custom http container\n\nThis change enable Prometheus stats provider to:\n- use an user supplied registry\n- do not start internal Jetty server\n\nThe context is to run the Bookie inside a process together with a servlet container (like Apache Tomcat) and use the existing web endpoint instead of opening another http (plain) port\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1394 from eolivelli/prom-use-servlet\n","Date":"Mon May 07 10:46:30 CEST 2018"},{"Commit-ID":"commit 8e7583b4c691dc44bb9057a2fe472a44184346a5 1525683029 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon May 7 16:50:29 2018 +0800]","Body":"[TABLE SERVICE] a zk based storage container controller\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nThe original storage container \"controller\" was written in helix. The helix controller's placement is kind of not assuming any properties of shared storage. however the table service is leverage bookkeeper's as its segment/log store. the table service is built in a more `stateless` way, where a storage container can be moved between servers in a much lightweight way.\n\nAlso helix codebase is a bit large, if we eventually going to eliminate zookeeper, the cost of switching it off helix will be much expensive. so this PR is introducing a simple zk based controller for assigning storage containers to servers.\n\n*Solution*\n\nIn this zk base solution, it is comprised of 3 parts: server registration, cluster & storage controller, storage container manager.\n\n**registration**\n\nthis solution leverages existing registration client/manager interfaces. so each storage server registers itself under `/stream/servers/available`.\n\n**cluster & storage controller**\n\nA storage server is elected as a the leader, which runs a ClusterController. The cluster controller reads cluster metadata from zookeeper (the cluster metadata includes like how many containers available in the cluster), and use a storage controller to compute an assignment plan as the ideal state for container assignment mapping, and then update the assignment mapping to zookeeper under `/stream/assignment`.\n\n**storage container manager**\n\nEach storage server runs a storage container manager, which watches the assignment plan in zookeeper. The cluster controller updates the assignment plan. Once it receives watches/updates from the assignment plan that computed by cluster controller, the storage container manager will align itself to the ideal assignment map by starting/stopping storage containers.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1392 from sijie/table_service_manager\n","Date":"Mon May 07 10:50:29 CEST 2018"},{"Commit-ID":"commit 3bd411910b3651e5dcb9df44d1f77cd6f6cd0ca6 1525771301 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Tue May 8 17:21:41 2018 +0800]","Body":"BP14 - forceLedger bookie side implementation\n\nThis is the bookie side implementation of the force() API as defined in BP-14, without the wire protocol handler.\nWe will introduce a new RPC which allows the client to ensure that all data sent for a  given ledger is persisted durably to the bookie, this is useful for DEFERRED_SYNC writers. In this case we are simulating a regular sync'd write to the journal choosen for the ledger.\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\nAuthor: eolivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>, JV Jujjuri <vjujjuri@salesforce.com>\n\nThis closes #1375 from eolivelli/bp14-simple-forceledger\n","Date":"Tue May 08 11:21:41 CEST 2018"},{"Commit-ID":"commit 175c8ded8417bb50467218edcce5fc2971f0752e 1526094809 -----sp","Author":"PersonIdent[arunlakshman, arunmuthuravi@gmail.com, Sat May 12 11:13:29 2018 +0800]","Body":"ISSUE #1339: Cleanup the directories created by DbLedgerStorageTest\n\nDescriptions of the changes in this PR:\n\n  Cleaned up the directories `dir1` and `dir2` left behind by the test `DbLedgerStorageTest`\n\nMaster Issue: #1339\n\nAuthor: arunlakshman <arunmuthuravi@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1398 from arunlakshman/issue1339, closes #1339\n","Date":"Sat May 12 05:13:29 CEST 2018"},{"Commit-ID":"commit eec48c4e21145c361dcbd749ab699922dfc0c68c 1526107525 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat May 12 14:45:25 2018 +0800]","Body":"Provide a vagrantfile to launch a linux vm for running integration tests\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nCurrently all bookkeeper's integration tests and bc tests are docker based and written\nusing arquillian framework. Due to the network issues in docker and the way how bookies\nadvertise themselves in the cluster, we can *ONLY* run integration tests in a linux\nenvironment. It is inconvinient to people who is using macOS as the development environment.\n\n*Solution*\n\nThis PR is providing a Vagrantfile to lanuch a dev vm that contains all the tools required\nfor running integration tests and bc tests. So people can actually debug and test integration\ntests locally using a linux vm.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1401 from sijie/vagrant_files\n","Date":"Sat May 12 08:45:25 CEST 2018"},{"Commit-ID":"commit cd71e0981dffa92edf51f9665117a30265b1cf4a 1526124777 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sat May 12 19:32:57 2018 +0800]","Body":"Fix TestSmoke#testTailingReads\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nTestSmoke#testTailingReads is testing the tailing behavior at bookkeeper. However the current testing logic is a bit\nproblematic on checking whether the reader has caught up with the expected last add confirmed. so the read logic break\nearlier before reading the expectedLastConfirmedEntry.\n\n*Solution*\n\nFix the checking logic on breaking the read loop.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1402 from sijie/fix_integration_tests\n","Date":"Sat May 12 13:32:57 CEST 2018"},{"Commit-ID":"commit 94c7ce0ba535181bc0fa78c4cb4cc612b1d6b773 1526278582 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Mon May 14 08:16:22 2018 +0200]","Body":"BP-14 forceLedger wire protocol server side implementation\n\nImplementation of the wire protocol for the BP-14 force ledger API on bookie side\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\nAuthor: eolivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>,  Venkateswararao Jujjuri (JV) <vjujjuri@salesforce.com>\n\nThis closes #1393 from eolivelli/bp14-simple-force-ledger-proto\n","Date":"Mon May 14 08:16:22 CEST 2018"},{"Commit-ID":"commit 6a48cd580814d71f931668fd78025f70aecf485c 1526328234 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon May 14 13:03:54 2018 -0700]","Body":"Issue #1396: Export metrics in same http server\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nCurrently metrics provider and http admin endpoint are isolated due to the way how things are modularized.\nThis requires two ports to be used, one is for metrics provider to expose metrics, while the other one is used by\nhttp admin endpoint for expose admin endpoints.\n\nWhen implementing a bookkeeper operator on k8s, it becomes confusing on managing those ports and do health checks.\nIt would be good to allow export metrics in same http admin endpoint if it is enabled.\n\n*Solution*\n\n- Introduce a method `writeAllMetrics` in stats provider to allow stats provider exporting metrics.\n- Add a `MetricsService` in bookie http service and export stats provider's metrics under `/metrics` endpoint.\n\nThis fixes #1396\n\nMaster Issue: #1396\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1399 from sijie/same_http_metrics_port, closes #1396\n","Date":"Mon May 14 22:03:54 CEST 2018"},{"Commit-ID":"commit 0d862fa42792301f26127addd5cc5a6a0114ce9b 1526385336 -----sp","Author":"PersonIdent[Ali Ahmed, alahmed.se@gmail.com, Tue May 15 13:55:36 2018 +0200]","Body":"Use isEmpty method instead of size check\n\nIn HTTP ListLedgerService use is Empty instead of size check.\n\nAuthor: Ali Ahmed <alahmed.se@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1371 from aahmed-se/minorRefactor\n","Date":"Tue May 15 13:55:36 CEST 2018"},{"Commit-ID":"commit 92591733c8b778f63cd71a00b2c7ed2c69c41312 1526407974 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue May 15 11:12:54 2018 -0700]","Body":"ISSUE #1403: ArrayIndexOutOfBoundsException is thrown on readLastAddConfirmedAndEntry\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nThere are two bugs in `ReadLastAddConfirmedAndEntry`:\n\n1) a regression was introduced by #657. the long poll read op is attempting to long-poll reading lac. since lac is stored across ensemble, so the retry logic assumes it will attempt over all the bookies in the ensemble. however #657 use a `write-quorum-size` write set for tracking those attempts. this leads to ArrayIndexOutOfBoundsException reported at #1403. The integrate tests added in this PR can easily reproduce this issue.\n\n2) there was a bug on retry logic when a ledger whose ensemble size is larger than write quorum size. when this happens, it will claim lac is not advanced prior to attempt the bookie in the ensemble. so the client will never know lac is advanced if using long poll reads on such ledgers. The integrate tests added in this PR can also catch this issue.\n\ndisclaim: twitter uses long poll reads but never uses `ensembleSize > writeQuorumSize`. so this is not a problem for dlog users.\n\n*Solution*\n\n- introduce a `getWriteSetForLongPoll` call that uses `ensembleSize` for building the write set. this would address problem 1)\n- fix the assignment of `numEmptyResponsesAllowed`, so the long poll reads can work with `ensembleSize > writeQuorumSize`\n- add integration tests for long polling reads\n\nat the same time, also add an integration test for normal tailing reads with\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1404 from sijie/longpoll_tests, closes #1403\n","Date":"Tue May 15 20:12:54 CEST 2018"},{"Commit-ID":"commit 7446d5c5d999c88de3cf2b9a36d793295c751a91 1526529642 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed May 16 21:00:42 2018 -0700]","Body":"Refactor bookkeeper bash scripts and move dlog script to root bin directory\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nSince 4.7, we have moved bash scripts and configuration to the root directory. However the scripts and configurations for dlog and table-service modules are still in their own modules. It is inconvenient and confusing. This change mainly refactor current bookkeeper script to make it reusable for other modules.\n\n*Code Change*\n\nThe main changes are:\n\n- abstract the common logic in `bin/bookkeeper` to `bin/common.sh`. These common logics include:\n   * common definitions on environment variables, such jvm settings, bk conf, log4j conf, classpath and such.\n   * common functions can be reusable, such as find jars, add maven dependencies.\n- simplify `bin/bookkeeper` and `bin/bookkeeper-cli` by reusing `bin/common.sh`\n- remove `stream/distributedlog/core/bin/dlog` to `bin/dlog` and simplify it by reusing `bin/common.sh`\n\n*Tests*\n\nMost of the changes in this PR are tests to ensure this script refactor is done correctly.\n\n- introduced a module `tests/scripts` for testing all the bash scripts in bookkeeper project. This module uses [shUnit2](https://github.com/kward/shunit2) for testing bash scripts. This gives a good test coverage on `bin/common.sh`.\n\n- add a few CLI smoketests under `tests/integration/smoke` to smoke test all CLI tools, including `bin/bookkeeper shell`, `bin/bookkeeper-cli` and `bin/dlog`. This makes sure all the CLI scripts work well after refactor.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1407 from sijie/include_dlog_library\n","Date":"Thu May 17 06:00:42 CEST 2018"},{"Commit-ID":"commit a26747890195549e21d48d3fee4f36251ee613d6 1526546248 -----sp","Author":"PersonIdent[JV Jujjuri, vjujjuri@salesforce.com, Thu May 17 01:37:28 2018 -0700]","Body":"ISSUE #1390 Ensemble change on delayed write error\n\nError on delayed writes are dropped if the addEntry\nis in complete state (ack quorum satisfied).\nThis change records the delayed write failure and forces\nensemble change onthe next write. This saves from having\nextended under replicated status on the ledger and also\navoids unnecessary build up at PCBC channel.\n\nSigned-off-by: Venkateswararao Jujjuri (JV) <vjujjurisalesforce.com>\n\nDescriptions of the changes in this PR:\n\n(PR description content here)...\n\nMaster Issue: #<master-issue-number>\n\nAuthor: JV Jujjuri <vjujjuri@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1395 from jvrao/bk-issue-1390-delayedWriteError, closes #1390\n","Date":"Thu May 17 10:37:28 CEST 2018"},{"Commit-ID":"commit 8c077a93e50ea844e0c39ca042ed2aa8cbd6d256 1526546300 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Thu May 17 01:38:20 2018 -0700]","Body":"Issue #1405: ReplicationWorker should back-off retrying.\n\nDescriptions of the changes in this PR:\n\nReplicationWorker should backoff replication\nafter threshold number of replication failures of a ledger.\n\nCurrently ReplicationWorker will do busy retrials if\nreplication is failed for a ledger, instead it should\nbackoff if replication had failed for threshold\nnumber of times. This can be done by deferring\nreleasing of underreplicated lock by\n'lockReleaseOfFailedLedgerGracePeriod' amount\nof time.\n\nMaster Issue: #1405\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1406 from reddycharan/fixreplicator, closes #1405\n","Date":"Thu May 17 10:38:20 CEST 2018"},{"Commit-ID":"commit 2414ce0526f64663d6ceab1b642862ff6f8eb1fa 1526546344 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu May 17 01:39:04 2018 -0700]","Body":"Add a test docker image for current version only\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nThe current test images don't use any scripts that shipped with official docker image.\nWe basically don't have any test coverage on the official docker image we shipped for each release.\n\n*Solution*\n\nIntroduce a `bookkeeper-current` image representing an image for latest master.\n\nUse `apachebookkeeper/all-versions-image` for BC tests, use `apachebookkeeper/bookkeeper-current` as tests only needs latest master image.\n\nAdd an integration test to test standalone mode using the `bookkeeper-current` image\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1408 from sijie/docker_dev\n","Date":"Thu May 17 10:39:04 CEST 2018"},{"Commit-ID":"commit 5bdfbf6a673b69a9027f85ad4e82c427d41646be 1526672971 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri May 18 12:49:31 2018 -0700]","Body":"Add a docker based `BookKeeperClusterTestBase` for failure related integration tests\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nCurrently we don't have any failure related testing for table service. Since we are using docker as the integration testing infrastructure,\nIt is better to use container for those failure testings, rather than going down the path as what we did before.\n\n*Solution*\n\nThis change provides the basic test base for bookkeeper cluster using dockers. `BookKeeperClusterTestBase` provides the similar functionalities\nto start/stop bookies as what we did in the unit test.\n\n`bookkeeper/tests/containers` in `integration-tests-topologies` provides all the basic containers used for testing.\n`tests/integration/cluster` and `tests/integration/topologies` provides the test base for writing tests using dockerized bookkeeper cluster.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1412 from sijie/docker_cluster_dev\n","Date":"Fri May 18 21:49:31 CEST 2018"},{"Commit-ID":"commit 9ba4c4e0d8be770e03110a958fb8b75a65ae0f59 1526939623 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Mon May 21 14:53:43 2018 -0700]","Body":"Bookies should be from different racks in a Writequorum.\n\nDescriptions of the changes in this PR:\n\nIdeally RackAwareEnsemblePlacementPolicy should try to select\nbookies from different racks for a write quorum. So in a\nWriteQuorum, bookies should be from WriteQuorum number of racks,\nprovided there are sufficient number of available racks and\nbookies.\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1397 from reddycharan/configracks\n","Date":"Mon May 21 23:53:43 CEST 2018"},{"Commit-ID":"commit 0fd1f4f81ff9acf3ab6776a8afc5f3673b786a2d 1526939692 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon May 21 14:54:52 2018 -0700]","Body":"Provide zookeeper startup script\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nZooKeeper is a dependency of bookkeeper shipped along with bookkeeper dist package. However we never provide any script to startup zookeeper in the bookkeeper binary package and never test the zookeeper version shipped along with bookkeeper\n\n*Solution*\n\n- add zookeeper in `bin/bookeeper` scripts to start zookeeper using bookkeeper scripts\n- refactor bookkeeper docker scripts to start bookie/zookeeper/standalone\n- use zk adminPort for health check, since 4letters commands are explicitly disabled at 3.5\n\n*Tests*\n\nExisting integration tests test the docker scripts and the bash script changes to start zookeeper.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1416 from sijie/package_zookeeper\n","Date":"Mon May 21 23:54:52 CEST 2018"},{"Commit-ID":"commit 916cd6655a70407e8c251c74814543ba1dbcf026 1526954555 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Mon May 21 19:02:35 2018 -0700]","Body":"Issue #570: EntryLogManagerForEntryLogPerLedger implementation\n\nDescriptions of the changes in this PR:\n\nThis is < sub-task6  > of Issue #570\n\nintroducing EntryLogManagerForEntryLogPerLedger, which is the\nimplementation of EntryLogManager for entrylog per ledger\nfeature.\n\nMaster Issue: #570\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Andrey Yegorov <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1391 from reddycharan/entrylogmanagerentrylogperledger, closes #570\n","Date":"Tue May 22 04:02:35 CEST 2018"},{"Commit-ID":"commit 44259ab273589c1ec5d04c7e8653d21d443da34e 1526967532 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon May 21 22:38:52 2018 -0700]","Body":"Fix dev/check-binary-license on macOS\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\n`dev/check-binary-license` is used for checking whether LICENSE files are updated to reflect the dependencies included in the distribution packages.\nHowever this script doesn't work on macOS, which makes the development on macOS inconvinient.\n\n*Solution*\n\nThe change removes `--wildcards` from tar command. The option only works on linux machines.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1418 from sijie/fix_check_license_script_master\n","Date":"Tue May 22 07:38:52 CEST 2018"},{"Commit-ID":"commit f6778ab7c1424bc5d71b6b52337649c0b06ae669 1526967580 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon May 21 22:39:40 2018 -0700]","Body":"Provide a util method to run functions with metadata client driver\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nCurrently `MetadataDrivers` provides util methods to run functions with metadata bookie driver.\nIt is convinient to provide a util method to run functions with metadata client driver as well.\n\n*Solution*\n\nProvide a util method `runFunctionWithMetadataClientDriver` to run functions with metadata client driver.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1421 from sijie/utils_to_run_client_driver\n","Date":"Tue May 22 07:39:40 CEST 2018"},{"Commit-ID":"commit 445347cdc82aef61104bb8afced6b333bfc041b9 1526974066 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue May 22 00:27:46 2018 -0700]","Body":"Build stream modules for integration tests\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\napache/bookkeeper#1422 adds table service as part of integration tests. so we need to build stream modules\nin order to run integration tests for apache/bookkeeper#1422\n\n*Solution*\n\nAdd \"-Dstream\" in the maven commands for `precommit-integrationtests` CI job.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1424 from sijie/compile_stream_module\n","Date":"Tue May 22 09:27:46 CEST 2018"},{"Commit-ID":"commit c8bcecc3fb38932a2e6444d5362ad1d82ee630af 1526978626 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue May 22 01:43:46 2018 -0700]","Body":"Allow bookie to start if failed to load extra server components\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\n`extraServerComponents` provides the flexibility to allow bookie to start with extra server components.\nIt acts as a plugin mechanism to extend the functionality of bookies. However it is okay to allow bookie\nstart up when failed to load extra server components.\n\nThis is a change for allowing starting table service as extra components in bookies.\n\n*Solution*\n\nCatch the exception and log it when failed to load extra server components.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1420 from sijie/allow_start_bookie\n","Date":"Tue May 22 10:43:46 CEST 2018"},{"Commit-ID":"commit 9655943e6be5ac86060134c16ec24d6f0c822f56 1526997907 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Tue May 22 16:05:07 2018 +0200]","Body":"BP-14 WriteFlag DEFERRED_SYNC Client Side Implementation\n\nIntroduce implementation of WriteFlag#DEFERRED_SYNC on LedgerHandle (purely client-side).\n\nTests are only on the client-side (with Mockito), there is no implementation on the bookie side. Most significant tests will come with the force() API, at this point we can only test that we have not broken the LAC advance mechanism.\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV)\n\nThis closes #853 from eolivelli/bp14-deferred-force-write-client-side\n","Date":"Tue May 22 16:05:07 CEST 2018"},{"Commit-ID":"commit f4e234439ef45bdedb244bc2375e2f9d0426c20c 1527014611 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue May 22 11:43:31 2018 -0700]","Body":"[TABLE SERVICE] start table service as an extra component of bookie\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\ntable service was built over bookkeeper ledgers. it is an extension to bookies' functionalities, so it is much convenient to start the service as one additional component with bookie, just like how we start `AutoRecovery` along with bookie.\n\n*Solution*\n\n- include `stream/server` module as part of bookkeeper server/all binary distributions\n- abstract `StorageServer` to allow controlling whether to start bookie or not\n- provide a ServerLifecycleComponent of `StorageServer`, so it can be used as an extra component of bookie\n\n*Tests*\n\n- improve the integration tests to start table service as part of bookie containers\n- move `LocationClientTest` to container based integration tests\n\nMaster Issue: #1205\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1422 from sijie/start_table_service\n","Date":"Tue May 22 20:43:31 CEST 2018"},{"Commit-ID":"commit 206443dff3fde2ca2eaa355b9799ecc6d5100988 1527041348 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Tue May 22 19:09:08 2018 -0700]","Body":"ISSUE #1415: [DLOG] org.apache.distributedlog.fs.TestDLFileSystem fails on CI\n\nUse a generated tempDir for DL FS tests instead of using an hard coded /tmp path\n\nFix for #1415\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1417 from eolivelli/fix/no-tmpdir-fsdl, closes #1415\n","Date":"Wed May 23 04:09:08 CEST 2018"},{"Commit-ID":"commit e34dd384c865a3494079ec9f38e4a0d87bd0ce51 1527041476 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue May 22 19:11:16 2018 -0700]","Body":"[TABLE SERVICE] Move integration tests under `stream/tests/integration` to `tests/integration/cluster`\n\nDescriptions of the changes in this PR:\n\nThe original integration tests were written based a non-dockerized standalone stream cluster. Moved them to use\nthe dockerized integration test framework. So all the integration tests are actually testing the table service run as part of bookies.\n\nThis change is based on #1422 .\na371ff2 is the change in this PR to be reviewed.\n\nMaster Issue: #1205\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1423 from sijie/move_more_stream_it_tests\n","Date":"Wed May 23 04:11:16 CEST 2018"},{"Commit-ID":"commit b0b69a337b4220752dfb512fdb99cfc5bdab564a 1527098164 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed May 23 10:56:04 2018 -0700]","Body":"Publish bookkeeper dev image to docker hub\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nWe built a `bookkeeper-current` image that reflects latest master for integration tests. However currently we don't publish this docker image to any docker registry. So it is inconvenient to test latest master in dockerized environments.\n\n*Solution*\n\n- Add a dev script to publish `bookkeeper-current` image to configured docker registry specified at `DOCKER_REGISTRY`\n- Update the nightly snapshot job to publish generated `bookkeeper-current` image to docker hub `apachebookkeeper`\n- Add `bin/standalone` script to use `docker-compose` to launch a 3-nodes bookkeeper cluster locally. The script generates docker-compose.yml and handles mounting local volumes and port forwarding. so developers can use that for quick development.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1427 from sijie/push_current_docker_image\n","Date":"Wed May 23 19:56:04 CEST 2018"},{"Commit-ID":"commit ea0b90cd9971b99be17b4e1ae9dbcd66c630daa6 1527098218 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed May 23 10:56:58 2018 -0700]","Body":"[TABLE SERVICE] Move grpc services from server module to storage module\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nCurrent almost every grpc requests are wrapped into `StorageContainerRequest` and their responses\nare wrapped into `StorageContainerResponse`. It makes things a bit complicated on adding new grpc\nservices.\n\nTo simplify things, we can use grpc ClientInterceptor to stamp container information (e.g. scId)\ninto the request metadata and write a grpc service registry to take the container information from\nrequest metadata and dispatch requests to containers.\n\nIn order to achieve it, we need to move the grpc services to storage container.\n\n*Solution*\n\nThis PR moves grpc services from server module to storage module, so we can simplify the wire protocols.\n\nMaster Issue: #1205\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1428 from sijie/move_grpc_service_to_storage\n","Date":"Wed May 23 19:56:58 CEST 2018"},{"Commit-ID":"commit e475ac3343f51b7ee0796eebecad829330baa92a 1527115322 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed May 23 15:42:02 2018 -0700]","Body":"Fix bookkeeper post commit CI\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\napache/bookkeeper#1422 includes stream storage integration tests in tests/integration.\nso we need to include `-Dstream` on building the tests.\n\n*Solution*\n\nUpdate the bookkeeper post commit CI jobs to include `-Dstream`\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1429 from sijie/fix_post_commit_ci\n","Date":"Thu May 24 00:42:02 CEST 2018"},{"Commit-ID":"commit 0c14137dd515c71e2d68da07c78cc5772a2ad25a 1527176133 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu May 24 08:35:33 2018 -0700]","Body":"Exclude `.vagrant` from apache-rat:check\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\napache/bookkeeper#1401 provides a `Vagrantfile` for running integration tests on linux vm.\nA `.vagrant` directory will be left under `dev` directory, which it will fail `apache-rat:check`.\n\n*Solution*\n\nExclude `.vagrant` directory from apache-rat check\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1431 from sijie/fix_apache_rat_check\n","Date":"Thu May 24 17:35:33 CEST 2018"},{"Commit-ID":"commit 8f48b0e305430d767f665c408450351ae067d19e 1527176171 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu May 24 08:36:11 2018 -0700]","Body":"Allow overriding `redirectTestOutputToFile` with environment settings\n\nDescriptions of the changes in this PR:\n\nSome modules (e.g. `tests/integration`) are allowed to override `redirectTestOutputToFile` behavior; while some are disallowed.\n\nThis PR is to make all modules are allowed to override that setting.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1432 from sijie/make_redirectTestOutputToFile_configurable\n","Date":"Thu May 24 17:36:11 CEST 2018"},{"Commit-ID":"commit 3aeda6fc98f379e4fa663807c3fd9d75e6092b2a 1527201947 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Thu May 24 15:45:47 2018 -0700]","Body":"ISSUE #1438: BookKeeperVerifierMain: fix typo for drain_timeout argument\n\n(bug W-5025785)\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1439 from athanatos/forupstream/wip-1438, closes #1438\n","Date":"Fri May 25 00:45:47 CEST 2018"},{"Commit-ID":"commit 78ccddfeeda9de0187fc379799507d27fa2aaeaf 1527202139 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu May 24 15:48:59 2018 -0700]","Body":"Use maven-exec-plugin to get the maven project version for CI jobs\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nThe current approach to get project version isn't reliable on CI environment. It might have garbage output (e.g. exceptions).\n\n*Solution*\n\nChanged to use `exec-maven-plugin` to echo `${project.vesion}`. It provides a more reliable approach to get version on CI environments.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1437 from sijie/fix_getversion_problem\n","Date":"Fri May 25 00:48:59 CEST 2018"},{"Commit-ID":"commit 6bfad08b4851406c219c1b5dc445c33453e7ecc4 1527235106 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri May 25 00:58:26 2018 -0700]","Body":"Issue #1434: Checkstyle is not executed at some modules\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nCheckstyle was supposed to run at `validate` phase for every modules. However checkstyle is not running at some modules.\nThis introduces inconsistency between modules.\n\n*Changes*\n\n- Fix Checkstyle warnings.\n- Remove `checkstyle` plugins from modules, only leave it at root pom file or modules that have overrides. This improves default build time.\n- Add `checkstyle:check` to CI jobs.\n\n*NOTES*\n\n`microbenchmarks` has too many checkstyle volations. so skip checkstyle for this PR.\n\nMaster Issue: #1434\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1435 from sijie/checkstyle_tests, closes #1434\n","Date":"Fri May 25 09:58:26 CEST 2018"},{"Commit-ID":"commit bff7106b307ee9a2cac041c1f1048478e03e6b24 1527235326 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri May 25 01:02:06 2018 -0700]","Body":"[TABLE SERVICE] client interceptor and storage container grpc proxy\n\nDescriptions of the changes in this PR:\n\nThis is a subsequent change after apache/bookkeeper#1428.\n\n*Motivation*\n\nCurrent almost every grpc requests are wrapped into `StorageContainerRequest` and their responses\nare wrapped into `StorageContainerResponse`. It makes things a bit complicated on adding new grpc\nservices.\n\n*Changes*\n\nTo simplify things, this PR introduces two functionalities for simplifying dispatching container requests/responses.\n\n1) *StorageContainerClientInterceptor*: A grpc `ClientInterceptor` that stamps container information (currently is `scId`) into the requests' metadata before sending the requests to the wire.\n\n2) A simple grpc reverse proxy to dispatch grpc requests to the channels provided by a `ChannelFinder`.\n\n*Tests*\n\n1. Existing unit tests covered client interceptor changes.\n2. Introduced a `stream-storage-tests-common` module to include common classes that would be used for testing.\n3. Introduced a `PingPongService` for testing reverse proxy : unary/client-streaming/server-streaming/bidi-streaming.\n\nMaster Issue: #1205\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1430 from sijie/interceptor_container_requests\n","Date":"Fri May 25 10:02:06 CEST 2018"},{"Commit-ID":"commit 059ebafd63fc7ca99e5e418d83c2b19b1275cade 1527270597 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri May 25 10:49:57 2018 -0700]","Body":"Fix checkstyle warnings\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nThere were two concurrent PRs merged at the same time.\n\napache/bookkeeper#1435 (checkstyle changes) was merged before apache/bookkeeper#1430. so checkstyle warnings\nintroduced by apache/bookkeeper#1430 were not caught by any CI jobs.\n\n*Solution*\n\nAddress the checkstyle warnings introduced by apache/bookkeeper#1430\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1444 from sijie/fix_checkstyle_issue\n","Date":"Fri May 25 19:49:57 CEST 2018"},{"Commit-ID":"commit 7075e364fcfe871441c3eef58d85d6f0484ca956 1527270733 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri May 25 10:52:13 2018 -0700]","Body":"ISSUE #1442: Assembly descriptor contains a filesystem-root relative reference '/'\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nWarnings on buidling bookkeeper dist packages. See #1442.\n\n*Solution*\n\nRemove \"/\" from the relative reference.\n\nSee https://lonelycoding.com/maven-assembly-plugin-warning-the-assembly-descriptor-contains-a-filesystem-root-relative-reference/ for details.\n\nMaster Issue: #1442\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1443 from sijie/address_assembly_warnings, closes #1442\n","Date":"Fri May 25 19:52:13 CEST 2018"},{"Commit-ID":"commit 5fb4112eee2a54232995e06f2a5f1acffe4a5929 1527271822 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri May 25 11:10:22 2018 -0700]","Body":"Provide the flag to allow ignoring startup failures on loading extra server components\n\nDescriptions of the changes in this PR:\n\nAddressed the comments in apache/bookkeeper#1420\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1426 from sijie/flag_to_allow_silent_failures\n","Date":"Fri May 25 20:10:22 CEST 2018"},{"Commit-ID":"commit 7ea615e1a2a0f661cadf89fea3c668c82969cbb7 1527285723 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri May 25 15:02:03 2018 -0700]","Body":"Update bookkeeper dependencies : netty/protobuf/grpc\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nThe netty version in bookkeeper is a bit dated than the version in pulsar.\nHence the grpc version is limited to the version that use same netty version.\nIt causes issues at pulsar using bookkeeper, because pulsar has been using\na newer version for longer time. This causes conflicts when pulsar client and\ngrpc are used together without proper shading.\n\n*Solution*\n\nUpgrade netty/protobuf/grpc dependencies.\n\n- update netty from `4.1.12` to `4.1.22`, which is the one grpc is using and closer to the one that pulsar is using.\n- update grpc from `1.5.0` to `1.12.0`, which is using netty `4.1.22` and protobuf `3.5.1`.\n- update protobuf from `3.4.0` to `3.5.1`\n\nRelated Issue: apache/pulsar#1844\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1441 from sijie/bump_grpc_version\n","Date":"Sat May 26 00:02:03 CEST 2018"},{"Commit-ID":"commit 1457825086a5a73cda2142e0984e7c858e185b8a 1527306770 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri May 25 20:52:50 2018 -0700]","Body":"[TABLE] mark TableClientTest & TableClientSimpleTest as FlakyTest\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nThese two integration tests are flaky on shutting down. Mark them as `FlakyTest` to make CI stable while investigating the issue.\n\n*Changes*\n\nMove `FlakyTest` annotation from bookkeeper-server test jar to bookkeeper-common test jar. So it can be used across multiple modules.\n\nAt the same time, remove redundant `FlakyTest` annotation at distributedlog-core module.\n\nRelated Issue: #1440\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1445 from sijie/mark_two_integration_tests_as_flaky\n","Date":"Sat May 26 05:52:50 CEST 2018"},{"Commit-ID":"commit 42aae8d8abe5ee13e5b76283adadd3456cf87558 1527486993 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Sun May 27 22:56:33 2018 -0700]","Body":"Add printreplicationworkerid option to ListUnderreplicatedCmd.\n\nDescriptions of the changes in this PR:\n\nAdd printreplicationworkerid option to ListUnderreplicatedCmd.\nThis helps in knowing who is holding lock on UnderReplicated ledger,\nand diagnosing that ReplicationWorker if we are seeing any issues in\nrereplication.\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1446 from reddycharan/printreplicationworkerid\n","Date":"Mon May 28 07:56:33 CEST 2018"},{"Commit-ID":"commit ed895a160444cb1866467d25148b16b6629991ce 1527487042 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun May 27 22:57:22 2018 -0700]","Body":"Include stream modules in bookkeeper distributions only when `-Dstream` is specified\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nstream modules are only built when `-Dstream` is specified. so if we want to include\nbinary distribution, `-Dstream` is needed. This updates those modules with profiles\nthat enabled when `-Dstream` is specified.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1447 from sijie/fix_stream_module\n","Date":"Mon May 28 07:57:22 CEST 2018"},{"Commit-ID":"commit 305e3fb327a4ef478b0c69a8a9389fd68c6cdd12 1527557349 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon May 28 18:29:09 2018 -0700]","Body":"[TABLE SERVICE] use grpc reverse proxy to serve storage container requests\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\n#1430 introduced client interceptor and grpc reverse proxy for storage container requests. This PR is the subsequent change to leverage client interceptor and reverse proxy for storage container requests.\n\n*Changes*\n\n**Client Changes**\n\nChanged `StorageContainerChannel` to add client interceptor to stamp storage container id into the the requests' metadata.\n\n**Server Changes**\n\n- moved the stream storage logic out of storage containers to a `service` package. the main logic will be kept in `RangeStoreService` and `RangeStoreServiceFactory`.\n- make the storage container logic for hosting `StorageContainerService`.\n- Each storage container will run an inprogress grpc server for serving the grpc services registered to the container and provide an `channel` for accessing those grpc service.\n- Changed the server to use reverse proxy for serving/proxying storage container requests.\n\n*NOTE*\n\nThis change doesn't directly remove `StorageContainerRequest` and `StorageContainerResponse`.  It would be done in a subsequent change.\n\nMaster Issue: #1205\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1448 from sijie/storage_container_channel\n","Date":"Tue May 29 03:29:09 CEST 2018"},{"Commit-ID":"commit 16ef25b64ef3f9a3bef00a382dc1ae2a58bdd108 1527666927 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed May 30 00:55:27 2018 -0700]","Body":"Allow CI to publish a snapshot version with gitsha information\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nCurrently bookkeeper publishes a snapshot release nightly to maven artifacts. It provides a convenient solution for people to try out new bookkeeper releases as soon as the changes land in master branch. However sometime it is also problematic when you reference this snapshot version in other projects, subsequent changes in bookkeeper might potentially break those projects.\n\n*Solution*\n\nUpdate the CI to provide a mechanism to publish a snapshot version with gitsha information. so it can publish a snapshot version that is pinned to the given gitsha. so the projects can safely use a snapshot version for development without worrying bookkeeper changes break it.\n\n*NOTES*\n\nThe mechanism is a manual operation. It should be used when it is needed.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1454 from sijie/publish_snapshot_with_gitsha\n","Date":"Wed May 30 09:55:27 CEST 2018"},{"Commit-ID":"commit 254b4464ca2a8775afb3b1ac2eba57ca920b36a4 1527667000 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed May 30 00:56:40 2018 -0700]","Body":"Update release procedure to use candidate tags for voting\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nWe used final release tag during release voting procedure. However there might be changes\nhappen between different candidate votes. So we ended up retagging the release tag for\ndifferent votes.\n\n*Solution*\n\nUse a candidate tag for voting. After a release is approved, create the final release tag.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1451 from sijie/update_release_guid\n","Date":"Wed May 30 09:56:40 CEST 2018"},{"Commit-ID":"commit 4bc021a438ca1e5acff23f7e3cb6cdb6984c1066 1527678872 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed May 30 13:14:32 2018 +0200]","Body":"Issue 1455: Unable to process suppressions file during checkstyle execution\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nFailed to run `mvn clean apache-rat:check checkstyle:check install -DskipTests`\n\n```\n[ERROR] Failed to execute goal org.apache.maven.plugins:maven-checkstyle-plugin:3.0.0:check (default-cli) on project bookkeeper-stats-api: Failed during checkstyle execution: Unable to process suppressions file location: bookkeeper/suppressions.xml: Cannot create file-based resource:invalid block type -> [Help 1]\n[ERROR]\n[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.\n[ERROR] Re-run Maven using the -X switch to enable full debug logging.\n[ERROR]\n[ERROR] For more information about the errors and possible solutions, please read the following articles:\n[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException\n[ERROR]\n[ERROR] After correcting the problems, you can resume the build with the command\n[ERROR]   mvn <goals> -rf :bookkeeper-stats-api\n```\n\n*Solution*\n\n- Make `buildtools` not inherit from bookkeeper root pom.\n- Make bookkeeper root pom includes `buildtools` as a `provided` dependency for each module.\n\nMaster Issue: #1455\nRelated Issues: #1435\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1456 from sijie/fix_ci_failure\n","Date":"Wed May 30 13:14:32 CEST 2018"},{"Commit-ID":"commit 27c13835d3facf4618706079ebd704c0d8f163e1 1527700695 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed May 30 10:18:15 2018 -0700]","Body":"[TABLE SERVICE] remove StorageContainerRequest and StorageContainerResponse\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\n #1448 uses reverse proxy for serving storage container requests and responses. so the `StorageContainerRequest` and `StorageContainerResponse`\n become redundant.\n\n*Solution*\n\nremoves `StorageContainerRequest` and `StorageContainerResponse`\n\nMaster Issue: #1205\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1452 from sijie/remove_storage_container_request_response\n","Date":"Wed May 30 19:18:15 CEST 2018"},{"Commit-ID":"commit f65d47f0e0df796ed4b4bd6e028994ad2592dfd1 1527747968 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed May 30 23:26:08 2018 -0700]","Body":"[TABLE SERVICE] cleanup : cleanup protobuf definitions\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nThere are some unused fields and some fields that were not renamed correctly from col to namespace.\n\n*Solution*\n\nThis is a cleanup PR to remove unused fields and rename \"col\" to \"ns\" or \"namespace\".\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1457 from sijie/cleanup_fields\n","Date":"Thu May 31 08:26:08 CEST 2018"},{"Commit-ID":"commit 5521a9f9109c59733323760fe54c4149635be633 1527756359 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Thu May 31 10:45:59 2018 +0200]","Body":"Make bookkeeper-server module buildable on jdk10\n\nUpgrade lombok and javadoc plugin to latest versions.\nThis way it is possible to work on most of the modules using JDK10.\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1453 from eolivelli/fix/build-jdk10\n","Date":"Thu May 31 10:45:59 CEST 2018"},{"Commit-ID":"commit 24e097f8d518d574db7aefd04d2d2cbaba8ea425 1527834242 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu May 31 23:24:02 2018 -0700]","Body":"[TABLE SERVICE] cleanup : provide unified service uri for resolving service endpoints\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nCurrently there are multiple settings in `StorageClientSettings` on configuring how to resolve\nservice endpoints to find the services. It is a bit inconvinient and confusing\n\n*Solution*\n\nProvide a class `ServiceURI` for parsing service uri to retrieve common informations including:\n\n- serviceName\n- serviceInfos\n- serviceUser\n- serviceHosts\n- servicePath\n\nIt extends the java.net.URI and does parsing and validation in the same place. Then it can be used\nby the grpc name resolver to resolve service endpoints.\n\nAlso update dlog to use it for resolving its namespace uri.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1459 from sijie/name_resolver\n","Date":"Fri Jun 01 08:24:02 CEST 2018"},{"Commit-ID":"commit a804faeafe40e1ffd74e85e8f7104811c02cd8c4 1527834364 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu May 31 23:26:04 2018 -0700]","Body":"BP-33: Move releasing official docker images out of main repo\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nCurrent bookkeeper docker images are auto-built by apache docker account. However it becomes problematic in the release process:\n\nDocker autobuild uses release tag for labeling the versions for docker images. But the Dockerfile can only be updated after a release is successfully made. So we have to retag a release after a release, in order to update Dockerfile to build the docker images.\n\nMaster Issue: #1449\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1450 from sijie/official_docker_images\n","Date":"Fri Jun 01 08:26:04 CEST 2018"},{"Commit-ID":"commit cf6d8b40da75e8f02ca3790763bc9c70d1d677ef 1527870649 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jun 1 09:30:49 2018 -0700]","Body":"ISSUE #1458: [CI] Fix bookkeeper-seed CI Job\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nIssue #1454 introduced a typo, which cause the seed job can not parse groovy DSL files.\n\n*Solution*\n\nFix the typo.\n\nMaster Issue: #1458\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1464 from sijie/fix_job_seed, closes #1458\n","Date":"Fri Jun 01 18:30:49 CEST 2018"},{"Commit-ID":"commit 1f4217609f9e77d6ec7158e6158e0683308abd09 1527870777 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jun 1 09:32:57 2018 -0700]","Body":"ISSUE #1455: Revert \": Unable to process suppressions file during checkstyle execution\"\n\nDescriptions of the changes in this PR:\n\nThis reverts commit 4bc021a438ca1e5acff23f7e3cb6cdb6984c1066 to address the issue we saw in #1461\n\nRelated Issue: #1456\n\nThis fixes #1461\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1462 from sijie/fix_maven_builds, closes #1455\n","Date":"Fri Jun 01 18:32:57 CEST 2018"},{"Commit-ID":"commit 9b1cffd1332e1748aed994e520daa1d04a1ee82f 1527871340 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jun 1 09:42:20 2018 -0700]","Body":"[CI] Run integration tests concurrently if possible\n\nDescriptions of the changes in this PR:\n\nExecute integration tests concurrently if necessary.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1463 from sijie/concurrent_builds\n","Date":"Fri Jun 01 18:42:20 CEST 2018"},{"Commit-ID":"commit 319f761ca1769d0b35aa70c99b3a1ea8795acaf8 1527895697 -----sp","Author":"PersonIdent[Andrey Yegorov, dlg99@users.noreply.github.com, Fri Jun 1 16:28:17 2018 -0700]","Body":"Issue #1409: Added server side backpressure (@bug W-3651831@) (#1410)\n\n(@bug W-3651831@) backpressure: server-side backpressure","Date":"Sat Jun 02 01:28:17 CEST 2018"},{"Commit-ID":"commit 9472596792932cb785ac842544b45cc45bcf6578 1527916126 -----sp","Author":"PersonIdent[Andrey Yegorov, dlg99@users.noreply.github.com, Fri Jun 1 22:08:46 2018 -0700]","Body":"Issue #1467: build failing with MavenReportException: Error while generating Javadoc. (#1468)\n\n","Date":"Sat Jun 02 07:08:46 CEST 2018"},{"Commit-ID":"commit 0cb9de02c3734f7811c0b36e32e612542533791a 1528099029 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jun 4 00:57:09 2018 -0700]","Body":"ISSUE #1472: [TABLE SERVICE] TestStorageClientBuilder.testBuildClientInvalidNamespaceName failed\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\n #1457 changed the validation of namespace/stream name. so \"-\" is a valid character.\n\n*Solution*\n\nFix the test.\n\nMaster Issue: #1472\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1473 from sijie/fix_storage_client_builder, closes #1472\n","Date":"Mon Jun 04 09:57:09 CEST 2018"},{"Commit-ID":"commit 4582050a8d51139dc4302a010a7bbd837d849cf8 1528119993 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Mon Jun 4 15:46:33 2018 +0200]","Body":"Support build on JDK10\n\n- switch to \"javac -h\" in circe-checksum instead of 'javah' because in JDK10 javah has been dropped (see http://openjdk.java.net/jeps/313)\n- add openjdk10 to Travis-CI\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1470 from eolivelli/nar-jdk10\n","Date":"Mon Jun 04 15:46:33 CEST 2018"},{"Commit-ID":"commit 7a2612076eba9fbfd32aa177c66e4a1d0b58edf6 1528142404 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jun 4 13:00:04 2018 -0700]","Body":"Improve merge script to merge PRs based on branches\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nMerge script doesn't handle well on handling PRs based on branches. So committers ended up\nusing merge button to merge PRs. so we lose a lot of informations such as descriptions, reviewers\nin the commit message.\n\n*Solution*\n\nThis PR fixes the problems on handling merging PRs based on branches.\n\nThis allows us merging #1469 using merge script.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1477 from sijie/merge_pull_request_from_branch\n","Date":"Mon Jun 04 22:00:04 CEST 2018"},{"Commit-ID":"commit 9e937cfc9da15521fff1946ad3470d1f35b3b016 1528142862 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jun 4 13:07:42 2018 -0700]","Body":"Improve precommit CI jobs on handling PRs made to branches\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nCurrent precommit CI jobs uses `master` as target branch for applying the pull requests.\nHowever pull requests might be made against branches. e.g. #1469, precommit jobs can't run properly on those pull requests. This PR tends to address the problem.\n\n*Solution*\n\nUse `ghprbTargetBranch` as the build branch for precommit jobs.\n\nBesides that, split the validation goals (e.g. checkstyle, apache-rat) from build/test goals (package, spotbugs), this reduces build time for different jdk versions and address problem when running checkstyle:check with other goals (e.g. deploy).\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1475 from sijie/run_precommit_jobs_over_target_branches\n","Date":"Mon Jun 04 22:07:42 CEST 2018"},{"Commit-ID":"commit 879253176ac3df556242d0dacd7440b6e501af19 1528144243 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jun 4 13:30:43 2018 -0700]","Body":"Abstract the tools framework to allow merging multiple CLI tools together\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nThere are multiple CLI tools spreading across multiple places, e.g. new bookkeeper cli, stream storage cli and dlog. There have similar implementations. It would be better to consolidate all these tools in one place `bookkeeper-tools`.\n\nThis is a PR to prepare moving `stream/cli` to be part of bookkeeper-tools.\n\n*Solution*\n\n- Abstract the CLI logic in bookkeeper-tools into a simple tools framework that can be reused in a extensible way to unify multiple tools together.\n- organize the tools module into tools/framework and tools/all\n\n*Result*\n\nExample output of the tool using this framework is listed as below:\n\n```\n$ bin/bkctl\nbkctl interacts and operates Apache BookKeeper clusters\n\nUsage:  bkctl [flags] [command group] [commands]\n\nCommands:\n\n    bookie          Commands on operating a single bookie\n    bookies         Commands on operating a cluster of bookies\n    cluster         Commands on administrating bookkeeper clusters\n    ledger          Commands on interacting with ledgers\n    namespace       Commands on operating namespaces\n    table           Commands on interacting with tables\n    tables          Commands on operating tables\n\n    help            Display help information about it\n\nFlags:\n\n    -c, --conf\n        Configuration file\n\n    -n, --namespace\n        Namespace scope to run commands (only valid for table service for now)\n\n    -u, --service-uri\n        Service Uri\n\n    -h, --help\n        Display help information\n\nUse \"bkctl [command] --help\" or \"bkctl help [command]\" for more information\nabout a command\n```\n\n*result from help sub-command*\n\n```\n$ bin/bkctl help table\nCommands on interacting with tables\n\nUsage:  bkctl table [command] [command options]\n\nCommands:\n\n    get         Get key/value pair from a table\n    inc         Increment the amount of a key in a table\n    put         Put key/value pair to a table\n\n    help        Display help information about it\n\nUse \"bkctl table [command] --help\" or \"bkctl table help [command]\" for more\ninformation about a command\n```\n\n*result from help sub-sub-command*\n\n```\n$ bin/bkctl table help inc\nIncrement the amount of a key in a table\n\nUsage:  bkctl table inc [flags] <table> <key> <amount>\n\nFlags:\n\n    -h, --help\n        Display help information\n```\n\nMaster Issue: #1000\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1471 from sijie/tools_framework\n","Date":"Mon Jun 04 22:30:43 CEST 2018"},{"Commit-ID":"commit ecf5de6af7f90a3bf5a8a65177bff6078995112c 1528181596 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jun 4 23:53:16 2018 -0700]","Body":"Throttle integration tests to run 1 build per host\n\nDescriptions of the changes in this PR:\n\nIf running multiple integration tests build on same host, they will be conflicting on installing docker images. So throttle integration tests to run max 1 build per host.\n\nSee discussions at : http://mail-archives.apache.org/mod_mbox/pulsar-dev/201806.mbox/%3CCAJdLeK0nj9n-TKC4t43Nyc8bO9UUW17wM%2By_fF68EgFL6Fpo8w%40mail.gmail.com%3E\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1480 from sijie/disable_concurrent_builds\n","Date":"Tue Jun 05 08:53:16 CEST 2018"},{"Commit-ID":"commit 9ca77faf2ab2d175a7bdefec94f5d9a47b08d4f8 1528221557 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jun 5 10:59:17 2018 -0700]","Body":"Improve precommit build time\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nThe build/test time of `bookkeeper-server` is almost close to or more than 1 hr.\n\n*Solution*\n\nSplit the precommit jobs into multiple jobs:\n\n- *PR Validation* : run `apache-rat:check`, `checkstyle:check`, to ensure codestyle and license headers\n- *Build (Java x)* : run `package` `spotbugs:check`, to ensure PR can be compiled and tested on different java environments. No spotbugs errors. `bookkeeper-server` tests are skipped.\n- *Integration Tests* : run integration tests with docker environment\n- *bookkeeper-server Tests* : tests `bookkeeper-server` on certain packages:\n  - bookie: `org.apache.bookkeeper.bookie`\n  - client: `org.apache.bookkeeper.client`\n  - replication: `org.apache.bookkeeper.replication`\n  - tls: `org.apache.bookkeeper.tls`\n  - all others: all other tests in `bookkeeper-server` module\n\nEach job can be triggered and skipped individually.\n\n- *PR Validation* : \"(re)run pr validation\" | \"\" (unskippable)\n- *Build (Java x)* : \"(re)build java(8|9)\" | \"skip build java(8|9)\"\n  - \"(re)build\" to build on both java8 and java9\n  - \"skip build\" to skip building jobs on both java8 and java9\n- *Integration Tests* : \"(re)run integration tests\" | \"skip integration tests\"\n- *bookkeeper-server tests* : \"(re)run (bookie|client|replication|tls|remaining) tests\" | \"skip (bookie|client|replication|tls|remaining) tests\"\n  - \"(re)run tests\" to run all bookkeeper-server test jobs\n  - \"skip tests\" to skip all bookkeeper-server test jobs\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1481 from sijie/improve_build_time\n","Date":"Tue Jun 05 19:59:17 CEST 2018"},{"Commit-ID":"commit 1b5aba204e0e8b3ae85d467abd42e0478bea99df 1528229078 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Tue Jun 5 13:04:38 2018 -0700]","Body":"Append ledgersMap when entrylog is removed from cache.\n\nDescriptions of the changes in this PR:\n\nIn EntryLogManagerForEntryLogPerLedger when ledger-entrylog\nentry is removed from cache, it will be moved to\nrotatedEntryLogs list. Before moving it to rotatedEntryLogs,\nledgersMap should be appended.\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1465 from reddycharan/fixappendledgersmap\n","Date":"Tue Jun 05 22:04:38 CEST 2018"},{"Commit-ID":"commit b9b46172c4f7ac1aa2a42ff8b0fceb24ef03ed68 1528234792 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jun 5 14:39:52 2018 -0700]","Body":"Update the new bookkeeper tools to use the new framework\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\n#1471  introduces a new tools framework based on jcommander. This PR is changing the new bookkeeper-tools to leverage that framework.\n\n*Solution*\n\n- Changed the related classes to use the new framework.\n- Rename `BookKeeperCLI` to `BKCtl` and `bookkeeper-cli` to `bkctl`\n- Use service loader to load command groups to allow better extensibility\n- Rename command group `cluster` to `bookies`\n\n*Results*\n\nExample output of this change:\n\n```\n$ bin/bkctl\nbkctl interacts and operates Apache BookKeeper clusters\n\nUsage:  bkctl [flags] [command group] [commands]\n\nCommands:\n\n    bookie      Commands on operating a single bookie\n    bookies     Commands on operating a cluster of bookies\n    ledger      Commands on interacting with ledgers\n\n    help        Display help information about it\n\nFlags:\n\n    -c, --conf\n        Configuration file\n\n    -u, --service-uri\n        Service Uri\n\n    -h, --help\n        Display help information\n\nUse \"bkctl [command] --help\" or \"bkctl help [command]\" for more information\nabout a command\n```\n\n*sub command*\n```\n$ bin/bkctl help bookie\nCommands on operating a single bookie\n\nUsage:  bkctl bookie [command] [command options]\n\nCommands:\n\n    lastmark        Print last log marker\n\n    help            Display help information about it\n\nUse \"bkctl bookie [command] --help\" or \"bkctl bookie help [command]\" for more\ninformation about a command\n```\n\n*sub-sub command*\n\n```\n$ bin/bkctl bookie help lastmark\nPrint last log marker\n\nUsage:  bkctl bookie lastmark [flags]\n\nFlags:\n\n    -h, --help\n        Display help information\n```\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1478 from sijie/bkctl_tools\n","Date":"Tue Jun 05 23:39:52 CEST 2018"},{"Commit-ID":"commit bfa4f9d5f10897ea854865d260248af9de6e10be 1528235133 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Tue Jun 5 14:45:33 2018 -0700]","Body":"Metrics for EntryLogManagerForEntryLogPerLedger.\n\nDescriptions of the changes in this PR:\n\nAdd counters/statsloggers for EntryLogManagerForEntryLogPerLedger.\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1460 from reddycharan/elmmetrics\n","Date":"Tue Jun 05 23:45:33 CEST 2018"},{"Commit-ID":"commit 7bbd3dee4e060046fcdf06294bb9d18bb22b41b9 1528268007 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Jun 5 23:53:27 2018 -0700]","Body":"Upgrade RocksDB to 5.13.1\n\nUpgrade RocksDB version to include a fix for empty SSTs written by flushing with deleteRange() operations that cause assertion failures on DB open.\n\nDescription can be found at : facebook/rocksdb#2717\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1466 from merlimat/upgrade-rocksdb\n","Date":"Wed Jun 06 08:53:27 CEST 2018"},{"Commit-ID":"commit 9a0bf5a0d9fc6606a57ff87bdb484386e4caab49 1528268134 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jun 5 23:55:34 2018 -0700]","Body":"Fix checkstyle in EntryLogTest\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nPR #1465 introduces a checkstyle error, but somehow it wasn't caught by CI jobs.\n\n*Solution*\n\nFix the checkstyle error and bring master back to normal.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Charan Reddy Guttapalem <reddycharan18@gmail.com>, Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1483 from sijie/fix_checkstyle_complains_entrylogtest\n","Date":"Wed Jun 06 08:55:34 CEST 2018"},{"Commit-ID":"commit 08c115568b1ef63bcbfd885f5ef252b4f3db0720 1528268258 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jun 5 23:57:38 2018 -0700]","Body":"Remove phrase trigger on post commit jobs\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nAfter enabling phrase trigger on precommit jobs to allow rerun individual precommit jobs, \"retest this please\" will run all the jobs including postcommit jobs.\n\n*Solution*\n\nRunning postcommit jobs on pull requests doesn't make sense. This PR removes all the phrase trigger from postcommit jobs.\n\nAdditionally, fixes typos and also increases the timeout for integration tests.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1482 from sijie/fix_typoes\n","Date":"Wed Jun 06 08:57:38 CEST 2018"},{"Commit-ID":"commit 204341825d616ee8e31317a2a0230049b2f4d03f 1528349559 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jun 6 22:32:39 2018 -0700]","Body":"Improve merge script on checking the statuses of github checks\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nSometimes Jenkins CI job might already succeed, however they failed on publishing the build status\nto Github due to timeout (one example is attached below). In this case, we don't need to rerun the jenkins check again.\n\n```\nSetting status of 55c1d54f3293e5166c59f238afd3fb3d98c7eb67 to SUCCESS with url https://builds.apache.org/job/bookkeeper_precommit_client_tests/21/ and message: 'SUCCESS\n '\nUsing context: Jenkins: Client Tests\nCould not update commit status of the Pull Request on GitHub.\norg.kohsuke.github.HttpException: Server returned HTTP response code: -1, message: 'null' for URL: https://api.github.com/repos/apache/bookkeeper/statuses/55c1d54f3293e5166c59f238afd3fb3d98c7eb67\n\tat org.kohsuke.github.Requester.parse(Requester.java:633)\n\tat org.kohsuke.github.Requester.parse(Requester.java:631)\n\tat org.kohsuke.github.Requester.parse(Requester.java:631)\n\tat org.kohsuke.github.Requester.parse(Requester.java:594)\n\tat org.kohsuke.github.Requester._to(Requester.java:272)\n\tat org.kohsuke.github.Requester.to(Requester.java:234)\n\tat org.kohsuke.github.GHRepository.createCommitStatus(GHRepository.java:1075)\n\tat org.jenkinsci.plugins.ghprb.extensions.status.GhprbSimpleStatus.createCommitStatus(GhprbSimpleStatus.java:281)\n\tat org.jenkinsci.plugins.ghprb.extensions.status.GhprbSimpleStatus.onBuildComplete(GhprbSimpleStatus.java:239)\n\tat org.jenkinsci.plugins.ghprb.GhprbBuilds.onCompleted(GhprbBuilds.java:205)\n\tat org.jenkinsci.plugins.ghprb.GhprbBuildListener.onCompleted(GhprbBuildListener.java:28)\n\tat hudson.model.listeners.RunListener.fireCompleted(RunListener.java:211)\n\tat hudson.model.Run.execute(Run.java:1769)\n\tat hudson.model.FreeStyleBuild.run(FreeStyleBuild.java:43)\n\tat hudson.model.ResourceController.execute(ResourceController.java:97)\n\tat hudson.model.Executor.run(Executor.java:429)\nCaused by: java.net.SocketTimeoutException: Read timed out\n\tat sun.reflect.GeneratedConstructorAccessor10056.newInstance(Unknown Source)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n\tat sun.net.www.protocol.http.HttpURLConnection$10.run(HttpURLConnection.java:1944)\n\tat sun.net.www.protocol.http.HttpURLConnection$10.run(HttpURLConnection.java:1939)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat sun.net.www.protocol.http.HttpURLConnection.getChainedException(HttpURLConnection.java:1938)\n\tat sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1508)\n\tat sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1492)\n\tat java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:480)\n\tat sun.net.www.protocol.https.HttpsURLConnectionImpl.getResponseCode(HttpsURLConnectionImpl.java:347)\n\tat org.kohsuke.github.Requester.parse(Requester.java:602)\n\t... 15 more\nCaused by: java.net.SocketTimeoutException: Read timed out\n\tat java.net.SocketInputStream.socketRead0(Native Method)\n\tat java.net.SocketInputStream.socketRead(SocketInputStream.java:116)\n\tat java.net.SocketInputStream.read(SocketInputStream.java:171)\n\tat java.net.SocketInputStream.read(SocketInputStream.java:141)\n\tat sun.security.ssl.InputRecord.readFully(InputRecord.java:465)\n\tat sun.security.ssl.InputRecord.read(InputRecord.java:503)\n\tat sun.security.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:983)\n\tat sun.security.ssl.SSLSocketImpl.readDataRecord(SSLSocketImpl.java:940)\n\tat sun.security.ssl.AppInputStream.read(AppInputStream.java:105)\n\tat java.io.BufferedInputStream.fill(BufferedInputStream.java:246)\n\tat java.io.BufferedInputStream.read1(BufferedInputStream.java:286)\n\tat java.io.BufferedInputStream.read(BufferedInputStream.java:345)\n\tat sun.net.www.http.HttpClient.parseHTTPHeader(HttpClient.java:735)\n\tat sun.net.www.http.HttpClient.parseHTTP(HttpClient.java:678)\n\tat sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1587)\n\tat sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1492)\n\tat java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:480)\n\tat sun.net.www.protocol.https.HttpsURLConnectionImpl.getResponseCode(HttpsURLConnectionImpl.java:347)\n\tat org.kohsuke.github.Requester.parse(Requester.java:602)\n\t... 13 more\nFinished: SUCCESS\n```\n\n*Changes*\n\nImprove the merge script to check jenkins status before treating the checks as failed.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1497 from sijie/improve_merge_script\n","Date":"Thu Jun 07 07:32:39 CEST 2018"},{"Commit-ID":"commit acec56f4928acbefbe3670ee0fdbf2c5d65f15d4 1528351153 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jun 6 22:40:33 2018 -0700]","Body":"Improve merge script on checking the statuses of github checks (missing commit)\n\n    Descriptions of the changes in this PR:\n\n    *Motivation*\n\n    Sometimes Jenkins CI job might already succeed, however they failed on publishing the build status\n    to Github due to timeout (one example is attached below). In this case, we don't need to rerun the jenkins check again.\n\n    ```\n    Setting status of 55c1d54f3293e5166c59f238afd3fb3d98c7eb67 to SUCCESS with url https://builds.apache.org/job/bookkeeper_precommit_client_tests/21/ and message: 'SUCCESS\n     '\n    Using context: Jenkins: Client Tests\n    Could not update commit status of the Pull Request on GitHub.\n    org.kohsuke.github.HttpException: Server returned HTTP response code: -1, message: 'null' for URL: https://api.github.com/repos/apache/bookkeeper/statuses/55c1d54f3293e5166c59f238afd3fb3d98c7eb67\n            at org.kohsuke.github.Requester.parse(Requester.java:633)\n            at org.kohsuke.github.Requester.parse(Requester.java:631)\n            at org.kohsuke.github.Requester.parse(Requester.java:631)\n            at org.kohsuke.github.Requester.parse(Requester.java:594)\n            at org.kohsuke.github.Requester._to(Requester.java:272)\n            at org.kohsuke.github.Requester.to(Requester.java:234)\n            at org.kohsuke.github.GHRepository.createCommitStatus(GHRepository.java:1075)\n            at org.jenkinsci.plugins.ghprb.extensions.status.GhprbSimpleStatus.createCommitStatus(GhprbSimpleStatus.java:281)\n            at org.jenkinsci.plugins.ghprb.extensions.status.GhprbSimpleStatus.onBuildComplete(GhprbSimpleStatus.java:239)\n            at org.jenkinsci.plugins.ghprb.GhprbBuilds.onCompleted(GhprbBuilds.java:205)\n            at org.jenkinsci.plugins.ghprb.GhprbBuildListener.onCompleted(GhprbBuildListener.java:28)\n            at hudson.model.listeners.RunListener.fireCompleted(RunListener.java:211)\n            at hudson.model.Run.execute(Run.java:1769)\n            at hudson.model.FreeStyleBuild.run(FreeStyleBuild.java:43)\n            at hudson.model.ResourceController.execute(ResourceController.java:97)\n            at hudson.model.Executor.run(Executor.java:429)\n    Caused by: java.net.SocketTimeoutException: Read timed out\n            at sun.reflect.GeneratedConstructorAccessor10056.newInstance(Unknown Source)\n            at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n            at java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n            at sun.net.www.protocol.http.HttpURLConnection$10.run(HttpURLConnection.java:1944)\n            at sun.net.www.protocol.http.HttpURLConnection$10.run(HttpURLConnection.java:1939)\n            at java.security.AccessController.doPrivileged(Native Method)\n            at sun.net.www.protocol.http.HttpURLConnection.getChainedException(HttpURLConnection.java:1938)\n            at sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1508)\n            at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1492)\n            at java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:480)\n            at sun.net.www.protocol.https.HttpsURLConnectionImpl.getResponseCode(HttpsURLConnectionImpl.java:347)\n            at org.kohsuke.github.Requester.parse(Requester.java:602)\n            ... 15 more\n    Caused by: java.net.SocketTimeoutException: Read timed out\n            at java.net.SocketInputStream.socketRead0(Native Method)\n            at java.net.SocketInputStream.socketRead(SocketInputStream.java:116)\n            at java.net.SocketInputStream.read(SocketInputStream.java:171)\n            at java.net.SocketInputStream.read(SocketInputStream.java:141)\n            at sun.security.ssl.InputRecord.readFully(InputRecord.java:465)\n            at sun.security.ssl.InputRecord.read(InputRecord.java:503)\n            at sun.security.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:983)\n            at sun.security.ssl.SSLSocketImpl.readDataRecord(SSLSocketImpl.java:940)\n            at sun.security.ssl.AppInputStream.read(AppInputStream.java:105)\n            at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)\n            at java.io.BufferedInputStream.read1(BufferedInputStream.java:286)\n            at java.io.BufferedInputStream.read(BufferedInputStream.java:345)\n            at sun.net.www.http.HttpClient.parseHTTPHeader(HttpClient.java:735)\n            at sun.net.www.http.HttpClient.parseHTTP(HttpClient.java:678)\n            at sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1587)\n            at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1492)\n            at java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:480)\n            at sun.net.www.protocol.https.HttpsURLConnectionImpl.getResponseCode(HttpsURLConnectionImpl.java:347)\n            at org.kohsuke.github.Requester.parse(Requester.java:602)\n            ... 13 more\n    Finished: SUCCESS\n    ```\n\n    *Changes*\n\n    Improve the merge script to check jenkins status before treating the checks as failed.\n\n    Author: Sijie Guo <sijie@apache.org>\n\n    Reviewers: Enrico Olivelli <eolivelli@gmail.com>\n\n    This closes #1497 from sijie/improve_merge_script\n","Date":"Thu Jun 07 07:40:33 CEST 2018"},{"Commit-ID":"commit 798e6b8f3f26d55eef7ee50e8a4abe12db477e57 1528351372 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jun 6 23:02:52 2018 -0700]","Body":"[TABLE SERVICE] Improve logging message on initializing table range stores.\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nExceptions might be throwing on starting/stopping table ranges. It would be good to have logging messages about the state transition for debugging purpose.\n\n*Build*\n\nOnly touch following stream modules, skip bookkeeper-server related tests:\n\n[skip tests]\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1493 from sijie/improve_logging\n","Date":"Thu Jun 07 08:02:52 CEST 2018"},{"Commit-ID":"commit 3a663e491e92c4f329dfde091f937f41dbb2cace 1528351428 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jun 6 23:03:48 2018 -0700]","Body":"[TABLE SERVICE] dlog configuration settings are not propagated\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nWhen stream storage server starts the bookie watcher service, it waits for at least `ensembleSize` bookies\navailable before starting other components. However the dlog settings are not propagated correctly. so when\nusing this component in an environment that only has 1 bookie (e.g. pulsar standalone). Startup will be hanging\non waiting 3 bookies.\n\n*Solution*\n\nload the dlog settings from the base configuration.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1486 from sijie/fix_loading_dlog_configuration\n","Date":"Thu Jun 07 08:03:48 CEST 2018"},{"Commit-ID":"commit b8a5289a968e4afca2b7ef557fd978234c162b2f 1528351507 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Wed Jun 6 23:05:07 2018 -0700]","Body":"RegionAwareEnsemblePlacementPolicy class should use super class's minNumRacksPerWriteQuorum variable\n\nDescriptions of the changes in this PR:\n\nRegionAwareEnsemblePlacementPolicy class should use minNumRacksPerWriteQuorum\nvariable which is declared in its super class - RackawareEnsemblePlacementPolicyImpl,\nsince it is related to its super class.\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1484 from reddycharan/fixregpp\n","Date":"Thu Jun 07 08:05:07 CEST 2018"},{"Commit-ID":"commit dc30f4938664cbfe07f061e35007c37871ad6b28 1528351624 -----sp","Author":"PersonIdent[Ethan Li, ethanopensource@gmail.com, Wed Jun 6 23:06:23 2018 -0700]","Body":"ISSUE #1491: fix GLIBC_2.14 dep issue for protoc-3.5.1-linux-x86_64\n\nDescriptions of the changes in this PR:\n\nI tried to build the bookkeeper branch-4.7 on RHEL6 and ran into:\n\n```\n /lib64/libc.so.6: version `GLIBC_2.14' not found (required by bookkeeper-proto/target/protoc-plugins/protoc-3.5.1-linux-x86_64.exe)\n```\nThis is similar to google/protobuf#4109 and it's related to google/protobuf#4138\n\nWe can take advantage of pulsar's fix apache/incubator-pulsar#1914 here\n\nMaster Issue:  https://github.com/apache/bookkeeper/issues/1491\n\nAuthor: Ethan Li <ethanopensource@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1492 from Ethanlm/ISSUE-1491, closes #1491\n","Date":"Thu Jun 07 08:06:23 CEST 2018"},{"Commit-ID":"commit 2aad54347870bddc03aa071c67eac18a23beadff 1528351818 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jun 6 23:10:18 2018 -0700]","Body":"[TABLE SERVICE] Move table service cli to bookkeeper-tools\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nThis PR follows #1478  to move table service cli to bookkeeper-tools.\nSo different service components are now available in one cli tool.\n\n*Changes*\n\n- move stream/cli module to tools/stream module\n- organize the table service commands as groups:\n\n* cluster\n* namespace\n* table\n* tables\n\n*Output*\n\nExample output:\n\n```\n$ bin/bkctl\nbkctl interacts and operates Apache BookKeeper clusters\n\nUsage:  bkctl [flags] [command group] [commands]\n\nCommands:\n\n    bookie          Commands on operating a single bookie\n    bookies         Commands on operating a cluster of bookies\n    cluster         Commands on administrating bookkeeper clusters\n    ledger          Commands on interacting with ledgers\n    namespace       Commands on operating namespaces\n    table           Commands on interacting with tables\n    tables          Commands on operating tables\n\n    help            Display help information about it\n\nFlags:\n\n    -c, --conf\n        Configuration file\n\n    -n, --namespace\n        Namespace scope to run commands (only valid for table service for now)\n\n    -u, --service-uri\n        Service Uri\n\n    -h, --help\n        Display help information\n\nUse \"bkctl [command] --help\" or \"bkctl help [command]\" for more information\nabout a command\n```\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1485 from sijie/stream_cli\n","Date":"Thu Jun 07 08:10:18 CEST 2018"},{"Commit-ID":"commit 2b66cb16d6f6a16c556ac304d3337a74f99a95df 1528352220 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jun 6 23:17:00 2018 -0700]","Body":"[CI] Allow selecting a list of precommit checks to skip in the pull request description.\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nprecommit checks are good. however sometime it takes a long time to wait for precommit checks to complete,\nfor trivial changes (e.g. documentation, ci jenkins files, scripts, proposals).\n\n*Changes*\n\nThis PR updates the PULL_REQUEST_TEMPLATE.md to provide a list of precommit checks to be allowed to skip.\nSo people can choose skip some precommit checks when filing a pull request.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1494 from sijie/skip_tests_is_too_general\n","Date":"Thu Jun 07 08:17:00 CEST 2018"},{"Commit-ID":"commit 4764c7637ecdcadfaddac74244d5c78449589c07 1528352438 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jun 6 23:20:38 2018 -0700]","Body":"[BOOKIE] [DBLEDGERSTORAGE] fix illegal reference count exception on filling read cache\n\nDescriptions of the changes in this PR:\n\n*Problem*\n\nByteBuf is released at a finally block. DbLedgerStorage doesn't have to release it on return. If it does so, that will cause\ndouble-release and it will throw IllegalReferenceCountException.\n\n*Solution*\n\nRemove `ByteBuf.release` at return.\n\nRelated Issue: #1487\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1488 from sijie/fix_double_release_on_db_ledgerstorage\n","Date":"Thu Jun 07 08:20:38 CEST 2018"},{"Commit-ID":"commit 5b8614f088d470f2eb7d8fc96ef92e42a8e01cce 1528422187 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jun 7 18:43:07 2018 -0700]","Body":"[WEBSITE] Include trademark attribution in footer\n\nDescriptions of the changes in this PR:\n\nAccording to http://www.apache.org/foundation/marks/pmcs#attributions, include trademark attribution in the footer.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1502 from sijie/update_trademarks\n","Date":"Fri Jun 08 03:43:07 CEST 2018"},{"Commit-ID":"commit 852367f053a3268885718257cbac55b696117670 1528422330 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jun 7 18:45:30 2018 -0700]","Body":"[DEVTOOLS] Use ASF Jenkins API properly\n\nDescriptions of the changes in this PR:\n\nAccording to https://cwiki.apache.org/confluence/display/INFRA/Using+the+ASF+Jenkins+API,\nwe need to include 'tree' or 'depth' when using ASF jenkins API.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1503 from sijie/access_jenkins_apis_should_include_depth\n","Date":"Fri Jun 08 03:45:30 CEST 2018"},{"Commit-ID":"commit 6d13b8e90fa89b46cb847b0928c0a24dcd3ef2ea 1528424411 -----sp","Author":"PersonIdent[Andrey Yegorov, ayegorov@salesforce.com, Thu Jun 7 19:20:11 2018 -0700]","Body":"Issue #1498: Log messages/exception text in DiskChecker shows 'used <threshold' in 'used > threshold' situations\n\n(bug W-3812505)\n\nDescriptions of the changes in this PR:\n\nFixed log/exception text.\n\n### Motivation\n\nReduced confusion when debugging an issue/going through the logs.\n\n### Changes\n\nreplaced '<' with '>'\n\nMaster Issue: #1498\n\nAuthor: Andrey Yegorov <ayegorov@salesforce.com>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1499 from dlg99/fix/diskchecker-log, closes #1498\n","Date":"Fri Jun 08 04:20:11 CEST 2018"},{"Commit-ID":"commit bacd4c12debdeeeeb30eec7666fcadee037cfc08 1528658030 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Jun 10 12:13:50 2018 -0700]","Body":"[TABLE SERVICE] Fix ZkClusterMetadataStoreTest\n\nDescriptions of the changes in this PR:\n\n### Motivation\n\ninitialize signature was changed. but the test was not changed.\n\n### Changes\n\nFix the test case.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1506 from sijie/fix_zk_cluster_initialize\n","Date":"Sun Jun 10 21:13:50 CEST 2018"},{"Commit-ID":"commit fa58c9ac7b6efd95424319238993e8eb62fa6aa3 1528736883 -----sp","Author":"PersonIdent[Andrey Yegorov, ayegorov@salesforce.com, Mon Jun 11 10:08:03 2018 -0700]","Body":"Issue #1500: PendingReadOp.logErrorAndReattemptRead logs errors with debug level, some of them useful for troubleshooting at info/warn level\n\n(bug W-3976846)\n\nDescriptions of the changes in this PR:\n\nChanged log level of one line from debug to info\n\n### Motivation\n\nUseful for troubleshooting of prod issue, don't want to have debug log enabled in prod all the time.\n\n### Changes\n\nChanged log level of one line from debug to info\n\nMaster Issue: #1500\n\nAuthor: Andrey Yegorov <ayegorov@salesforce.com>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1501 from dlg99/fix/pendingreadop-log, closes #1500\n","Date":"Mon Jun 11 19:08:03 CEST 2018"},{"Commit-ID":"commit 42f6ea63ce6cd00cc699ff54272437aebbb985ca 1528738891 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jun 11 10:41:31 2018 -0700]","Body":"[TABLE SERVICE] Fix StringUtf8Coder and add VarIntCoder\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nThe getSerializeLen() returned by StringUtf8Coder is different from the serialized buffer size.\n\n*Changes*\n\n- Fix StringUtf8Coder\n- Add tests to coders\n- Add a VarIntCoder\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1507 from sijie/fix_string_coder\n","Date":"Mon Jun 11 19:41:31 CEST 2018"},{"Commit-ID":"commit b65fa438d6212eb4a89a848b4f2642ba2ad573da 1528778882 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jun 11 21:48:02 2018 -0700]","Body":"[TABLE SERVICE] replaying TxnRequest is not implemented\n\n*Motivation*\n\nwhen enabling table service for pulsar at apache/incubator-pulsar#1922, I noticed that replaying TxnRequest is missed somehow.\n\n*Solution*\n\nThis PR implements the replaying TxnRequest logic in the command process.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1505 from sijie/replay_txn_request\n","Date":"Tue Jun 12 06:48:02 CEST 2018"},{"Commit-ID":"commit 7b04ce80fd56250afa37efcb60b61a1bf235256a 1528856955 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jun 12 19:29:15 2018 -0700]","Body":"ISSUE #1490: BookieJournalForceTest is flaky\n\nDescriptions of the changes in this PR:\n\n### Motivation\n\nThe test cases in BookieJournalForceTest check if the forceWriteQueue is empty after everything is flushed.\nHowever if `adaptiveGroupWrites` is enabled, the forceWrite thread will insert a marker entry into force write queue,\nthis will fail the forceWriteQueue length checking.\n\n### Changes\n\nDisable `adaptiveGroupWrites` in BookieJournalForceTest\n\nMaster Issue: #1490\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1512 from sijie/fix_journalforcetest, closes #1490\n","Date":"Wed Jun 13 04:29:15 CEST 2018"},{"Commit-ID":"commit 53792ec1c3593a00f7b549fb6146182f8b74f10b 1528879366 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Jun 13 10:42:46 2018 +0200]","Body":"Issue #1511: Upgrade nokogiri to version 1.8.2\n\nVersion <1.8.2 contain a security vulnerability.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1515 from ivankelly/nokogiri, closes #1511\n","Date":"Wed Jun 13 10:42:46 CEST 2018"},{"Commit-ID":"commit 9f55f78815c80d6b335d8e1cf6fd91196aeb8cff 1528936534 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jun 13 17:35:34 2018 -0700]","Body":"Allow to configure read-only mode in ZooKeeperClient\n\nUnderlying `Zookeeper` instance has an option to specify the client is fine to remain connected when the ZK quorum is lost, just in read-only mode.\n\nWe should expose the \"allow read-only mode\" option in `ZooKeeperClient`.\n\nOne example of use case for this flag is when connecting to a ZK ensemble that is just used for configuration/metadata store, in which no ephemeral nodes are used. It's therefore better to keep the connection with ZK and be able to keep reading (possibly stale) data from ZK rather than no read at all. Concrete use case is for ZK session for Pulsar global ZK ensemble, where we read configuration data and we don't really need to have a valid session when brokers are trying to read.\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1344 from merlimat/zk-client-read-only\n","Date":"Thu Jun 14 02:35:34 CEST 2018"},{"Commit-ID":"commit 134a6c25a846731dc2ad0dc6c3e848170557b7b9 1528936862 -----sp","Author":"PersonIdent[Nicolas Michael, nmichael@salesforce.com, Wed Jun 13 17:41:02 2018 -0700]","Body":"Issue #1489: Better Prevent Read Outliers during short-term Bookie Slow-Down\n\n### Motivation\n\nBookies can temporarily be slow for a large number of reasons, often for just a brief time of few milliseconds to seconds such as during Java Garbage Collection or EntryLog compaction. For writes, latencies of individual bookies are masked by acknowledging the client after a quorum of bookies have replied. However for reads, we don't have any equivalent feature to mask short-term latencies of individual bookies yet (in case of SequenceReadRequests). This PR implements such a feature by reordering reads to prefer bookies with a high probability of being fast over bookies that are potentially slow.\n\n### Changes\nThis change implements a configurable reordering of read requests in Bokkeeper client based on the number of pending requests to each bookie that could service the request. The intention is to mask the latency of one bookie by directing a read request to another bookie that could potentially service the request faster. This should help prevent read time outliers due to bookies that temporarily are responsing slow, for example due to Java garbage collection, compaction, or any other kind of hickup. Unlike the implementation for Issue #709, this algorithm quickly reacts to both an or decrease increase in queue length of a bookie relative to others, and allows to redirect requests long before they would hit the speculativeReadTimeout. Once the problem is resolved (e.g. Java GC finished), it will quickly direct requests to the previously \"slow\" bookie as its queue length decreases.\n\nReordering of reads is based on a threshold of relative queue length to other bookies. Setting the threshold very low will more frequently reorder the read set and potentially result in better latency, but will also reduce data affinity of reads. Reads send to other than the preferred bookie have a low chance to be served from file system cache on that bookie, and will likely result in a physical read. Small thresholds therefore shuffle read requests more among bookies and may lead to reduced file system cache reach and increased physical reads on disks. A larger timeout will maintain data affinity and avoid above problems, but only kick in once a bookie has built-up a considerable queue of requests. It therefore masks only slightly larger outliers, and leads to overall better efficiency.\n\nMaster Issue: #1489\n\nAuthor: Nicolas Michael <nmichael@salesforce.com>\n\nReviewers: Yiming Zang <yzang2016@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1504 from nicmichael/ReadReordering, closes #1489\n","Date":"Thu Jun 14 02:41:02 CEST 2018"},{"Commit-ID":"commit 6476fc323fffd328ed9620d9aa39c4c232f8d2be 1528967602 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jun 14 02:13:22 2018 -0700]","Body":"ISSUE #1476: LedgerEntry is recycled twice at ReadLastConfirmedAndEntryOp\n\nDescriptions of the changes in this PR:\n\nThe issue #1476 is caused by peculative reads with object recycling, same request object will be added to the CompletionObjects multiple times with different txnid.  In fact the logic of process the request already take this into account, only on place inside `ReadLastConfirmedAndEntryOp.requestComplete` forget to check requestComplete before calling `submitCallback` which in turn call request.close.\n\n### Motivation\n\nto fix #1476\n\n### Changes\n\ncheck `requestComplete` before `submitCallback` in `ReadLastConfirmedAndEntryOp.requestComplete`\n\nMaster Issue: #1476\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: infodog <infodog@hotmail.com>\nAuthor: zhengxiangyang <zxy@xinshi.net>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1509 from infodog/issue1476, closes #1476\n","Date":"Thu Jun 14 11:13:22 CEST 2018"},{"Commit-ID":"commit c5a36219bbb7cfce343137bf3c361f7eb80bd64e 1528988253 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jun 14 16:57:33 2018 +0200]","Body":"Move TimedOutTestsListener from dlog to bookkeeper-common\n\nDescriptions of the changes in this PR:\n\nThis PR is to debug CI problems observed at #1516\n\n### Motivation\n\ndlog uses a `TimedOutTestsListener` to dump the jvm stack when a junit test timed out.\nmove this class to bookkeeper-common and built with `test-jar`, so it can be used across the project.\n\n### Changes\n\nrelocate `TimedOutTestsListener` and its related classes from distributedlog-common to bookkeeper-common.\n\nRelated Issue: #1516\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1517 from sijie/add_test_timedout_listener\n","Date":"Thu Jun 14 16:57:33 CEST 2018"},{"Commit-ID":"commit f7dce110fdca47c93664d1d9c71cda8cb08c9cc2 1529305511 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Mon Jun 18 09:05:11 2018 +0200]","Body":"BP-14 force() API - client side implementation\n\n- Introduce the client side force() API\n- Implementation on the client side wire protocol for FORCE_LEDGER RPC\n- Disable ensemble changes for DEFERRED_SYNC writers\n- Prevent v2 client from using force() API.\n\nThe force() API enables the client (usually with DEFERRED_SYNC write flags) to require a point of synchronization with all the bookies in the ensemble, to have guarantees about durability of previously written entries (and ackknowledgerd), this way LastAddConfirmed is able to advance.\n\nFor DEFERRED_SYNC writers LastAddConfirmed will advance only using this API\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Jia Zhai <None>, Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1436 from eolivelli/bp14-force-client-api\n","Date":"Mon Jun 18 09:05:11 CEST 2018"},{"Commit-ID":"commit c7aa989865d6a67c7377237e89e7cd7878b58645 1529345775 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Jun 18 11:16:15 2018 -0700]","Body":"Fix typo in bk_server.conf\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1520 from ivankelly/ivankelly-patch-1\n","Date":"Mon Jun 18 20:16:15 CEST 2018"},{"Commit-ID":"commit 7204d3762fca005e3fcffa625cd15ef83576f120 1529432017 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jun 19 11:13:37 2018 -0700]","Body":"[RELEASE] Release Notes for Release 4.7.1\n\nDescriptions of the changes in this PR:\n\nRelease Notes for release 4.7.1\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1518 from sijie/release_notes_471\n","Date":"Tue Jun 19 20:13:37 CEST 2018"},{"Commit-ID":"commit 880294f512102f6d841517f827ce2740a0eeeac4 1529432153 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jun 19 11:15:53 2018 -0700]","Body":"ISSUE #705: add site/scripts/release_minor.sh for minor releases\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nCurrently `site/scripts/release.sh` only supports major releases.\n\n*Changes*\n\nAdded a similar `release_minor.sh` to support minor releases.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1524 from sijie/provide_script_release_minor, closes #705\n","Date":"Tue Jun 19 20:15:53 CEST 2018"},{"Commit-ID":"commit bdfe2291d93f2a5c9baf68a4e2ee0b8648e73062 1529442614 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jun 19 14:10:14 2018 -0700]","Body":"[RELEASE] update website with 4.7.1 documentation\n\nDescriptions of the changes in this PR:\n\nSigned-off-by: Sijie Guo <sijieapache.org>\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1522 from sijie/update_website\n","Date":"Tue Jun 19 23:10:14 CEST 2018"},{"Commit-ID":"commit 10c510333d904debf54eb832524f6e09dcc0685d 1529456906 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Tue Jun 19 18:08:26 2018 -0700]","Body":"ISSUE #1495: Option to enforce minNumRacksPerWriteQuorum\n\nDescriptions of the changes in this PR:\n\nProvide an option to enforce the guarantee of minNumRacksPerWriteQuorum\nif it is enabled. If it cann't find a bookie to enforce the guarantee\nthen the API in RackawareEnsemblePlacementPolicy should throw\nBKNotEnoughBookiesException.\n\nMaster Issue: #1495\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1496 from reddycharan/enforceminracks, closes #1495\n","Date":"Wed Jun 20 03:08:26 CEST 2018"},{"Commit-ID":"commit cf89f25677877abb172a95cd2c40bfd760b225a8 1529457189 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jun 19 18:13:09 2018 -0700]","Body":"[WEBSITE] update release guide to reflect current release process\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1525 from sijie/fix_release_guide\n","Date":"Wed Jun 20 03:13:09 CEST 2018"},{"Commit-ID":"commit 28dee8464764b0edceeb31ce24424f0947b5789b 1529509011 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Wed Jun 20 08:36:51 2018 -0700]","Body":"LedgerManagerIteratorTest: avoid ledger collision\n\nFor the non-LHLM managers, the ledger space seems to be small enough to\nallow collisions to occasionally cause a test failure.  Remember\ncreated ledgers to avoid collisions.\n\n(bug W-5104859)\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Charan Reddy Guttapalem <reddycharan18@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1526 from athanatos/forupstream/wip-ledger-manager-iterator-test\n","Date":"Wed Jun 20 17:36:51 CEST 2018"},{"Commit-ID":"commit e3884801569725283963385a35f63c5d1d8b3880 1530048223 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jun 26 14:23:43 2018 -0700]","Body":"[RELEASE] Bump bk version to 4.7.1 in docker file\n\nDescriptions of the changes in this PR:\n\nBump bk version to 4.7.1 to build docker image for `4.7.1`\n\nAuthor: Sijie Guo <sijieapache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1523 from sijie/bump_docker_version\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1529 from sijie/cherry-pick_docker_change\n","Date":"Tue Jun 26 23:23:43 CEST 2018"},{"Commit-ID":"commit 30175bf0b924a7da16cbd5ed8cb7e870dff76d73 1531287134 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Tue Jul 10 22:32:14 2018 -0700]","Body":"Website - Add other usecases to the overview page\n\nAdd Twitter Manhattan and Herddb.org Distributed Databases usecases for BookKeeper as Write-Ahead-Log\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1539 from eolivelli/fix/websiteusacase\n","Date":"Wed Jul 11 07:32:14 CEST 2018"},{"Commit-ID":"commit b1d23b483a06f987efab8b794a9e754dc4552542 1531812747 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jul 17 00:32:27 2018 -0700]","Body":"ISSUE #1542: Unable to run 'bookkeeper' shell script from /bookkeeper/bin folder\n\nDescriptions of the changes in this PR:\n\n*Bug*\n\n```\nGetting NoClassDefFoundError while trying to run 'bookkeeper' shell script from 'bin' folder. Issue seems to be related with classpath (cached classpath file - cached_classpath.txt)\n\n~/Workspace/Community/bookkeeper/bin$ ./bookkeeper shell\nJAVA_HOME not set, using java from PATH. (/usr/bin/java)\ncat: bookkeeper-server/target/cached_classpath.txt: No such file or directory\nError: A JNI error has occurred, please check your installation and try again\nException in thread \"main\" java.lang.NoClassDefFoundError: org/apache/commons/configuration/Configuration\nat java.lang.Class.getDeclaredMethods0(Native Method)\nat java.lang.Class.privateGetDeclaredMethods(Class.java:2701)\nat java.lang.Class.privateGetMethodRecursive(Class.java:3048)\nat java.lang.Class.getMethod0(Class.java:3018)\nat java.lang.Class.getMethod(Class.java:1784)\nat sun.launcher.LauncherHelper.validateMainClass(LauncherHelper.java:544)\nat sun.launcher.LauncherHelper.checkAndLoadMain(LauncherHelper.java:526)\nCaused by: java.lang.ClassNotFoundException: org.apache.commons.configuration.Configuration\nat java.net.URLClassLoader.findClass(URLClassLoader.java:381)\nat java.lang.ClassLoader.loadClass(ClassLoader.java:424)\nat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:349)\nat java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n... 7 more\n```\n\n*Motivation*\n\nFixes #1542\n\n*Problem*\n\n`bin/common.sh` uses a relative path for caching classpath and locating the pom file.\n\n*Changes*\n\n- change to use full path for cached classpath file and the module pom file\n- add a test case to cover this problem\n\nMaster Issue: #1542\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Charan Reddy Guttapalem <reddycharan18@gmail.com>\n\nThis closes #1548 from sijie/fix_issue_1542, closes #1542\n","Date":"Tue Jul 17 09:32:27 CEST 2018"},{"Commit-ID":"commit 1760c0590b6ed775ca55911f4e2a177234c59cc7 1531812867 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Tue Jul 17 00:34:27 2018 -0700]","Body":"ISSUE #1537: fix distributedlog incubator link\n\nDescriptions of the changes in this PR:\n### Motivation\n\nIn bookkeeper website, we are still using incubator locations for dlog references. we should change it to http://bookkeeper.apache.org/distributedlog\n\n### Changes\nchange links from\n`https://distributedlog.incubator.apache.org`\nto\n`https://bookkeeper.apache.org/distributedlog`\n\nMaster Issue: #1537\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1545 from jiazhai/issue_1537, closes #1537\n","Date":"Tue Jul 17 09:34:27 CEST 2018"},{"Commit-ID":"commit 7a2e73177d3147221a0992455a9b73049d9a5447 1531812990 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Tue Jul 17 00:36:30 2018 -0700]","Body":"ISSUE #1534: LedgerCache should be flushed\n\nDescriptions of the changes in this PR:\n\n### Motivation\n\nEntryLogComparator.CompactionScannerFactory.flush just calls \"ledgerStorage.updateEntriesLocations(offsets);\" but not \"ledgerStorage.flushEntriesLocationsIndex()\".\n\nBecause of this, EntryLogCompactor.compact method would remove compacted entryLog without updated offsets/locations getting flushed/persisted/fsynced to LedgerCache (Index/FileInfo files). This could lead to data corruption/loss if Bookie is broughtdown/killed before those updated offsets/locations are flushed/persisted/fsynced.\n### Changes\n\nIn EntryLogComparator, before removing compacted entryLog, LedgerCache (IndexInMemPageMgr and Index files) should be flushed, just like EntryLogger.\n\nMaster Issue: #1534\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Matteo Merli <mmerli@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1536 from reddycharan/compactfix, closes #1534\n","Date":"Tue Jul 17 09:36:30 CEST 2018"},{"Commit-ID":"commit 3a52ce74a92ac84f61a5834ef7ee701a7e6f7988 1531898059 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jul 18 00:14:19 2018 -0700]","Body":"[TABLE SERVICE] Support getStreamById in root range store.\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nStream readers need to fetch metadata information by quering its metadata using stream id.\n\n*Changes*\n\nAdd support in root range to get stream properties using stream id.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1550 from sijie/add_get_stream_by_id\n","Date":"Wed Jul 18 09:14:19 CEST 2018"},{"Commit-ID":"commit f4ef21fb05f9f5826413bedb04cf00da85d56416 1531898105 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Jul 18 00:15:05 2018 -0700]","Body":"[TABLE SERVICE] Fix Journal replay issue on range deletion\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nWe use `\\000` as an indicator for null key in the protobuf delete operation.\nHowever when we convert the protobuf delete request to an delete operation,\nwe didn't take `\\000` into account.\n\n*Changes*\n\n- Fix ProtoDeleteOpImpl and ProtoRangeOpImpl to handle '\\000'\n\n(have a separated PR for an integration test to ensure this work)\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1554 from sijie/fix_journal_replay\n","Date":"Wed Jul 18 09:15:05 CEST 2018"},{"Commit-ID":"commit e5b144cf45dd176d0369e7dc0ada2bb53e34d912 1532087508 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Jul 20 13:51:48 2018 +0200]","Body":"Disable testConcurrentWriteAndReadCalls in EntryLogTest\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nThose tests passed locally. However they are taking very long time to complete and cause all CI jobs become very flaky.\nIn order to unblock all PRs, disable these tests in EntryLogTest.\n\n*Changes*\n\nMarked 4 tests in EntryLogTest as `FlakyTest`.\n\nRelate Issue: #1516\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1561 from sijie/disable_some_entrylog_test\n","Date":"Fri Jul 20 13:51:48 CEST 2018"},{"Commit-ID":"commit 89f8ee91ff768664b5da2c52fcac1d1b7f0614f0 1532325218 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jul 23 13:53:38 2018 +0800]","Body":"[CI] Cleanup workspace before build\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nA lot of CI jobs failed due to gitlock file left in the workspace\n\n*Changes*\n\nCleanup workspace before build\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1566 from sijie/cleanup_workspace\n","Date":"Mon Jul 23 07:53:38 CEST 2018"},{"Commit-ID":"commit 4d5353bb7ea6c7f6cf2cb62992d122b265687b05 1532356502 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Mon Jul 23 16:35:02 2018 +0200]","Body":"ISSUE #1541: Fix ReadOnlyBookie constructor\n\nDescriptions of the changes in this PR:\n\n### Motivation\n\nReadOnlyBookie doesn't sets shutdownHandler to its statemanager.\n\nThere are couple of issues with how 'stateManager' is handled in ReadOnlyBookie,\n\n- ReadOnlyBookie creates its own stateManager in its constructor but it does not sets shutdownHandler.\n- Also, it is not correct to create stateManager instance in Bookie constructor and then again in ReadOnlyBookie constructor and override the instance created in super constructor.\n\n### Changes\n\n- move initializeStateManager logic to a method and override it in ReadOnlyBookie.\n\nMaster Issue: #1541\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1557 from reddycharan/readonlybookiefix, closes #1541\n","Date":"Mon Jul 23 16:35:02 CEST 2018"},{"Commit-ID":"commit 1d8366a0a2468856d3a5671d36b17f542cb0c75c 1532356580 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jul 23 16:36:20 2018 +0200]","Body":"[TABLE SERVICE] Improve bin/bookkeeper standalone to start all available service components\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nCurrently `bin/bookkeeper standalone` simply starts local bookies. It is not very useful when using\nstandalone for local development for other service components.\n\n*Changes*\n\n- change `bin/bookkeeper standalone` to start a cluster of zookeeper, bookkeeper and table service containers\n- add `bin/standalone.process` to start a cluster of zookeeper, bookkeeper and table service containers in one process\n- change `bin/standalone` to support both process and docker-compose\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1553 from sijie/improve_bk_standalone\n","Date":"Mon Jul 23 16:36:20 CEST 2018"},{"Commit-ID":"commit 424204ebecb8ba2e4856cb2f570f3a8bf1589da8 1532356786 -----sp","Author":"PersonIdent[Ivan Kelly, ivan@ivankelly.net, Mon Jul 23 16:39:46 2018 +0200]","Body":"Allow concurrent write requests for same entry in V2 protocol\n\nWith the V2 protocol we have previously allowed a single client to\nissue concurrent read requests for the same entry. We didn't allow the\nsame for write requests, as we always assume single writer. This\nassumption isn't absolutely correct though. When opening a ledger, the\nrecovery process will rewrite entries after the LAC. To\nPerChannelBookieClient these look no different to normal writes.\n\nIf a client tries to open a ledger multiple times concurrently,\ncurrently some of the attempts can hang forever since there is no\nsupport for concurrent writes.\n\nThis patch adds support for concurrent writes, so multiple concurrent\nledger open attempts will always complete (though some may fail for\nunrelated reasons).\n\nAuthor: Ivan Kelly <ivan@ivankelly.net>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1547 from ivankelly/conc-open\n","Date":"Mon Jul 23 16:39:46 CEST 2018"},{"Commit-ID":"commit 50f29ed9425095e2115b7c18518b8e9a81c204e9 1532368956 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jul 23 11:02:36 2018 -0700]","Body":"ISSUE #1540: Bookie/BookieServer components shutdown will fail to end exit the BookieProcess\n\nDescriptions of the changes in this PR:\n\n ### Motivation\n\nFixes the issue at #1540.\n\nIf Bookie/BookieServer components are shutdown internally because of any fatal errors\n(ExitCode - INVALID_CONF, SERVER_EXCEPTION, ZK_EXPIRED, ZK_REG_FAIL, BOOKIE_EXCEPTION) then\nit will go through shutdown method logic and shutdowns components internal to Bookie/BookieServer\nbut it will not succeed in bringing down the bookie process.\n\nThis is because in BookieServer.main / server.Main.doMain it would wait for the startComponent\nfuture to complete\nhttp://github.com/apache/bookkeeper/blob/master/bookkeeper-server/src/main/java/org/apache/bookkeeper/server/Main.java#L227 .\nThe startComponent future will be market complete only in runtime shutdownhook -\nhttps://github.com/apache/bookkeeper/blob/master/bookkeeper-common/src/main/java/org/apache/bookkeeper/common/component/ComponentStarter.java#L66.\n\nBut the problem is nowhere in Bookie/BookieProcess shutdown we are calling System.exit() and hence\nthe runtime shutdownhook is not executed to mark the startComponent future to complete. Hence\nMain.doMain will wait forever on this future though Bookie/BookieServer components are shutdown\nbecause of known fatal errors.\n\n ### Regression\n\nIssue #508 introduced this regression. Before this change, the main thread is blocking using `BookieServer#join()`.\nWhen bookie is dead for any reason, the DeathWatchThread will kill the bookie and bookie server. so the main thread will quite.\nHowever after #508 is introduced, the lifecycle management is disconnected from the bookie and bookie server. so when they are dead,\nlifecycle management is unaware of the situation and the main thread doesn't quite.\n\n ### Changes\n\n- Add `UncaughtExceptionHandler` to lifecycle components\n- When a lifecycle component hits an error, it can use `UncaughtExceptionHandler` to notify lifecycle component stack to shutdown the whole stack\n\nMaster Issue: #1540\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Andrey Yegorov <None>, Charan Reddy Guttapalem <reddycharan18@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1543 from sijie/fix_lifcycle_components, closes #1540\n","Date":"Mon Jul 23 20:02:36 CEST 2018"},{"Commit-ID":"commit ec7fb62f025a3b03b42fd92b38bc836515310fad 1532369073 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jul 23 11:04:33 2018 -0700]","Body":"ISSUE #1544: [DLOG] ConcurrentModificationException with nonblocking logReader.readNext(true)\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nFixes #1544. ConcurrentModificationException is thrown when trying to access a non-thread-safe hashmap from different threads.\n\n*Changes*\n\nMake sure accessing to this non-thread-safe hashmap is under synchronized block.\n\n*Tests*\n\nIt is a bit tricky to reproduce this race condition in a unit test or an integration test. so not going to attempt adding any tests.\n\nMaster Issue: #1544\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1558 from sijie/issue_1544, closes #1544\n","Date":"Mon Jul 23 20:04:33 CEST 2018"},{"Commit-ID":"commit 573e86b6c13a106d748c01778dcaeee9d45c39c4 1532369478 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Mon Jul 23 11:11:18 2018 -0700]","Body":"ISSUE #1563: Spammy logs on Bookie in ReadEntryProcessorV3 in case of tailing reader on empty ledger\n\nDescriptions of the changes in this PR:\n### Motivation\n\nIn case of an empty ledger the bookie floods the disk with an useless message.\n\n### Changes\n\nMake that line \"No ledger found while reading entry\" to be logged at 'debug' level.\n\nMaster issue #1563\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1564 from eolivelli/fix/1563-logs, closes #1563 and squashes the following commits:\n\nf66a9b8c0 [Enrico Olivelli] only skip logging for LastAddConfirmed Entry\n83f6217a0 [Enrico Olivelli] Issue-1563 Spammy logs on Bookie in ReadEntryProcessorV3 in case of tailing reader on empty ledger\n","Date":"Mon Jul 23 20:11:18 CEST 2018"},{"Commit-ID":"commit 43bf7a40da1ff5fe6f784accc2bd3f9194490186 1532376932 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Mon Jul 23 13:15:32 2018 -0700]","Body":"Provide utils to dump component configuration as json string (#1552)\n\n\r\n\r\n*Motivation*\r\n\r\nIt is useful to dump configuration during service components started.\r\nBookie server already did that.\r\n\r\n*Changes*\r\n\r\n- Move JsonUtil to bookkeeper-common module to make it available to other modules.\r\n- Add toJson method to ComponentConfiguration\r\n\r\n","Date":"Mon Jul 23 22:15:32 CEST 2018"},{"Commit-ID":"commit 21f125d76870d7c244b87ad32a2f6f52421778eb 1532380884 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Mon Jul 23 14:21:24 2018 -0700]","Body":"ISSUE #1527: Make ExplicitLAC persistent\n\nDescriptions of the changes in this PR:\n\nFor persisting explicitLAC, we can follow the\nsame approach as followed in persisting\nfencing information / stateBits (d69986c)\nin FileInfo file and special marker entry\nin Journal.\n\n### Motivation\n\nExplicitLAC is kept in the memory and it can be lost in bookie reboot.\nThough it is an extreme corner case scenario, it can break one of the BK guarantees.\n\" If you read once you can always read it\".\nIf all the bookies of the Write stripe were rebooted, it can loose its explicitLAC value and the client\nwhich was able to read the entry before the reboot, can't read it anymore.\n\nMaster Issue: #1527\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1532 from reddycharan/storeexplicitlac, closes #1527\n","Date":"Mon Jul 23 23:21:24 CEST 2018"},{"Commit-ID":"commit 3ddbaace58a2b95304d7b05e5c86afb9f509c067 1532430604 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Tue Jul 24 13:10:04 2018 +0200]","Body":"Provide BookieId option for listledgers command\n\nDescriptions of the changes in this PR:\n\n### Motivation\n\nWhile diagnosing/analyzing/debugging cluster, sometimes it would be helpful to know the list of the ledgers residing in a particular bookie. Currently there is no simple way (BookieShell command) to find out that.\n\n### Changes\n\nFor listledgers BookieShell command, provide bookieid option, which helps us in knowing list of ledgers residing in this particular Bookie.\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1555 from reddycharan/printledgersofbookie\n","Date":"Tue Jul 24 13:10:04 CEST 2018"},{"Commit-ID":"commit d3e9d56c18df337fa22da47aa8458bde5b74d141 1532430699 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Jul 24 13:11:39 2018 +0200]","Body":"[TABLE SERVICE] Set storage type on creating tables\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nWe are using same metadata objects for both streams and tables. and we are\nusing a storage model to distinguish them. We need to make sure we setting the storage\nmodel when creating tables.\n\n*Changes*\n\nSet storage type on creating tables.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1551 from sijie/set_storage_type\n","Date":"Tue Jul 24 13:11:39 CEST 2018"},{"Commit-ID":"commit 16553057b0ddba53ac169c4fef81336e2bd26116 1532433968 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Tue Jul 24 14:06:08 2018 +0200]","Body":"ISSUE #1538: Expose MetricsServer in http server\n\nDescriptions of the changes in this PR:\n\nExpose MetricsServer in  http server under `/metrics`\n\nAuthor: Jia Zhai <zhaijia@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1546 from jiazhai/issue_1538, closes #1538\n","Date":"Tue Jul 24 14:06:08 CEST 2018"},{"Commit-ID":"commit 3ec8231c58a2ebe50c0c6a082e2feab231540116 1532679367 -----sp","Author":"PersonIdent[Ivan Kelly, ivan@ivankelly.net, Fri Jul 27 10:16:07 2018 +0200]","Body":"Replace guava multimap in PCBC with custom impl\n\nFor a long time PerChannelBookieClient has used guava\nLinkedListMultiMap to store conflicting V2 completion keys and\nvalues. This is problematic though. Completion keys are pooled\nobjects. When a key-value pair is stored in a LinkedListMultiMap, if\nit is the first value for that key, a collection is created for the\nvalues, and added to a top-level map using the key, and then the key\nand the value are added to the collection. When a second value is\nadded for the same key, the key and value are simply added to the\ncollection. The problem occurs when the first key is removed. PBCB\nwill recycle the key object, but this object is still being used in\nthe multimap in the top-level map. This causes all sorts of fun like\nNullPointerException and IllegalStateException.\n\nBecause of this, this patch introduces a very simple multimap\nimplementation that only stores the key one time (in the collection)\nand uses the hashCode of the key to separate the collections into\nbuckets. It's pretty inefficient, but this code it only hit in the\nrare case where a client is trying to read or write the same entry\nfrom the same ledger more than once at the same time.\n\nAuthor: Ivan Kelly <ivan@ivankelly.net>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1569 from ivankelly/conc-test-flake\n","Date":"Fri Jul 27 10:16:07 CEST 2018"},{"Commit-ID":"commit f265f6e5c05ece3db8d1e2f9322f8d68ddeefa74 1532681947 -----sp","Author":"PersonIdent[Ivan Kelly, ivan@ivankelly.net, Fri Jul 27 10:59:07 2018 +0200]","Body":"Flag to disable test reruns from the commandline\n\nUseful when trying to hunt down flakes.\n\nAuthor: Ivan Kelly <ivan@ivankelly.net>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1570 from ivankelly/retryFlag\n","Date":"Fri Jul 27 10:59:07 CEST 2018"},{"Commit-ID":"commit f40a29ddef3586c53fad4b9098a85342390a498b 1532932172 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Mon Jul 30 08:29:32 2018 +0200]","Body":"Write DEFERRED_SYNC docs\n\nWrite a little documentation about DEFERRED_SYNC WriteFlag and force() API\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1571 from eolivelli/fix/bp14-docs\n","Date":"Mon Jul 30 08:29:32 CEST 2018"},{"Commit-ID":"commit fe266906c83b38d25a575fd8f745556e132e4349 1532933066 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Mon Jul 30 08:44:26 2018 +0200]","Body":"ISSUE #1565: Update 'upgrade' doc for 4.8 release\n\nDescriptions of the changes in this PR:\n\nUpdate 'upgrade' doc by adding an entry\n\"4.7.x to 4.8.0 upgrade\" for ExplicitLac persistence\n\nMaster Issue: #1565\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1568 from reddycharan/upgradenote, closes #1565\n","Date":"Mon Jul 30 08:44:26 CEST 2018"},{"Commit-ID":"commit e0d82804cefb97e8eaada19c10bc0e0fae70f002 1532933121 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Mon Jul 30 08:45:21 2018 +0200]","Body":"ISSUE #1559: Fix for moveLedgerIndexFile logic in relocateIndexFileAndFlushHeader\n\nDescriptions of the changes in this PR:\n\n- In IndexPersistenceMgr.relocateIndexFileAndFlushHeader, if the\ncurrentDir is full and if it is the only indexDir which is\neligible for newIndexFile creation then instead of failing with\nNoWritableLedgerDirException it should flushHeader without trying\nto move LedgerIndexFile.\n\nMaster Issue: #1559\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1560 from reddycharan/fixfileinfomove, closes #1559\n","Date":"Mon Jul 30 08:45:21 CEST 2018"},{"Commit-ID":"commit 130cccba2b218e965660ddd3266af30aeed56d0f 1533034250 -----sp","Author":"PersonIdent[Ivan Kelly, ivan@ivankelly.net, Tue Jul 31 12:50:50 2018 +0200]","Body":"LedgerManager should return the metadata just written\n\nFirst part of changes to make ledger metadata immutable. The client\nshould only act on metadata which has been written to zookeeper. To\nthis end, we need to be able to get back from the ledger manager what\nhas been written to zookeeper (with the version number updated).\n\nMaster issue: #281\n\nAuthor: Ivan Kelly <ivan@ivankelly.net>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1573 from ivankelly/ledger-manager-returns-ledgermeta\n","Date":"Tue Jul 31 12:50:50 CEST 2018"},{"Commit-ID":"commit 7ec196624f0cd0cd1d57b47d24d35788adfcbcde 1533057959 -----sp","Author":"PersonIdent[Ivan Kelly, ivan@ivankelly.net, Tue Jul 31 19:25:59 2018 +0200]","Body":"Disallow direct access to LedgerHandle#metadata\n\nThis object has been accessed and mutated all over the client, which\nmakes it hard to do anything with the object. This patch removes the\ndirect accesses, so the object can only be accessed through an\naccessor.\n\nMaster issue: #281\n\nAuthor: Ivan Kelly <ivan@ivankelly.net>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1574 from ivankelly/onlyaccessmdthroughaccessor\n","Date":"Tue Jul 31 19:25:59 CEST 2018"},{"Commit-ID":"commit 2b14458d966f80d991cec35ed7460639db52997b 1533115781 -----sp","Author":"PersonIdent[Ivan Kelly, ivan@ivankelly.net, Wed Aug 1 11:29:41 2018 +0200]","Body":"Make each ensemble in ensemble list immutable\n\nPreviously, the ensemble list was a Map<Long, ArrayList<BookieSocketAddress>>.\nArrayList is by definition mutable, so ensemble passed to metadata users are\nalways mutable.\n\nThis patch changes in ensembles in the list to be immutable. We were also leaking\nthe implementation of ledger metadata to the placement policy, so this has been\nmodified to use List<BookieSocketAddress> also.\n\nMaster issue: #281\n\nAuthor: Ivan Kelly <ivan@ivankelly.net>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1575 from ivankelly/ledger-fragment-immutable-metadata and squashes the following commits:\n\n14977a242 [Ivan Kelly] fix dlog\nbdaef31e8 [Ivan Kelly] checkstyle\n6e3431118 [Ivan Kelly] Make each ensemble in ensemble list immutable\n","Date":"Wed Aug 01 11:29:41 CEST 2018"},{"Commit-ID":"commit afa1c2008ddf2eff7cec3fd9c055157f41e0fdd3 1533594843 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Mon Aug 6 15:34:03 2018 -0700]","Body":"Enhancing DecommissionBookieCmd\n\nDescriptions of the changes in this PR:\n\n- adding bookieid option to DecommissionBookieCmd, to enable decommissioning remote\nbookie. This might be needed because, in an extreme scenario Bookie node might not\nbe completely accessible and hence we might need to decommission a Bookie remotely.\n- also DecommissionBookieCmd should delete the cookie of the decommissioned Bookie.\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1582 from reddycharan/decomfix\n","Date":"Tue Aug 07 00:34:03 CEST 2018"},{"Commit-ID":"commit 123ceabe0a3de46fab6eb61bff9d530b7e212100 1533655989 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Aug 7 17:33:09 2018 +0200]","Body":"Metadata Update mechanism\n\nThis patch introduces a metadata update mechanism for the client which\nwill be used in all places where metadata is updated.\n\nThe mechanism takes a bunch of predicates and functions, and runs a\nloop again the ledger manager, attempting to apply the mutation\nrequired as specified.\n\nIt assumes that the ledger metadata objects on the client side are\nimmutable and that any metadata object read reflects state that exists\non the metadata store. This isn't the case right now, but as the\ncurrent metadata updates are changed to use this, it will be the case.\n\nThis patch also introduces a limited LedgerMetadataBuilder, though\nonly the fields required for testing at mutable.\n\nMaster Issue: #281\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1577 from ivankelly/ledger-fragment-immutable-metadata\n","Date":"Tue Aug 07 17:33:09 CEST 2018"},{"Commit-ID":"commit f4094c4992d5b22630fa633085a00a9152b87ffe 1533751483 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Wed Aug 8 11:04:43 2018 -0700]","Body":"Record ctime for underreplicated ledger mark time.\n\nDescriptions of the changes in this PR:\n\nEnable the Auditor to use system time as underreplicated ledger mark time.\nIf this is enabled, Auditor will write a ctime field into the\nunderreplicated ledger znode. This would be useful in knowing when the\nledger is marked underreplicated, using BookieShell commands and also later\nwe can add alerts/metrics on under replicated ledgers which remained under\nreplicated for more than acceptable duration.\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1576 from reddycharan/urlctime\n","Date":"Wed Aug 08 20:04:43 CEST 2018"},{"Commit-ID":"commit 5f3d28228ac984ded435d932b05cb1d348694dfc 1533894534 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Fri Aug 10 11:48:54 2018 +0200]","Body":"[maven-release-plugin] prepare branch branch-4.8\n","Date":"Fri Aug 10 11:48:54 CEST 2018"},{"Commit-ID":"commit 9cd10484f527c8f2fc144c94fe92588a3f30904e 1533894541 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Fri Aug 10 11:49:01 2018 +0200]","Body":"[maven-release-plugin] prepare for next development iteration\n","Date":"Fri Aug 10 11:49:01 CEST 2018"},{"Commit-ID":"commit dd5b938fd48bfa1164b94fa083b1b39e6094c7a4 1534086587 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Sun Aug 12 17:09:47 2018 +0200]","Body":"Fix master versions (4.8.0-SNAPSHOT->4.9.0-SNAPSHOT)\n\nSome pom versions and the versions in bk_test_bin_common.sh were\nmissed when the version was bumped to 4.9.0-SNAPSHOT, which is killing\nall builds.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1599 from ivankelly/broken-master\n","Date":"Sun Aug 12 17:09:47 CEST 2018"},{"Commit-ID":"commit 9a2efacd08e2360868b79efe10296aade8e2e5b1 1534106583 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Sun Aug 12 13:43:03 2018 -0700]","Body":"Move MockLedgerManager out of MetadataUpdateLoopTest\n\nThis mock is useful for other tests, so move it out.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1596 from ivankelly/mocklm-common\n","Date":"Sun Aug 12 22:43:03 CEST 2018"},{"Commit-ID":"commit 269f609f6573ed2b529f20eb8e2e0182baa9db12 1534149454 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Aug 13 10:37:34 2018 +0200]","Body":"Move GenericCallbackFuture so it can be used in production code\n\nIt's a useful utility to have when dealing with callbacks.\n\nAuthor: Ivan Kelly <ivank@apache.org>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1597 from ivankelly/gen-cb-future\n","Date":"Mon Aug 13 10:37:34 CEST 2018"},{"Commit-ID":"commit 6b9cbf2052b27f331553f2738483ae21bf12b49c 1534149576 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Aug 13 10:39:36 2018 +0200]","Body":"Avoid releasing sent buffer to early in BookieClient mock\n\nIf the buffer was sent to more than one bookie with the mock, it would\nbe released after being sent to the first one. Each write should\nretain a refCount themselves, and then release when done.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1598 from ivankelly/double-rel-mock\n","Date":"Mon Aug 13 10:39:36 CEST 2018"},{"Commit-ID":"commit 3ab6e9253555d013a8c6eb3b90cddffa090fcaee 1534165202 -----sp","Author":"PersonIdent[JV Jujjuri, vjujjuri@salesforce.com, Mon Aug 13 15:00:02 2018 +0200]","Body":"Delayed write ensemble change may cause dataloss\n\nDescriptions of the changes in this PR:\n\nThe Original intent of this change is to do a best-effort ensemble change.\nBut this is not possible until the local metadata is completely immutable.\nUntil the feature \"Make LedgerMetadata Immutable #610\" Is complete we will use\nhandleBookieFailure() to handle delayed writes as regular bookie failures.\n\nSigned-off-by: Venkateswararao Jujjuri (JV) <vjujjurisalesforce.com>\n\nMaster Issue: #1591\nRelate Issue: #1395\n\nAuthor: JV Jujjuri <vjujjuri@salesforce.com>\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1592 from jvrao/datalossbug\n","Date":"Mon Aug 13 15:00:02 CEST 2018"},{"Commit-ID":"commit 83f78c3b8187f7f0e4a93c50055e2e08b0bdd4e3 1534183896 -----sp","Author":"PersonIdent[Khurrum Nasimm, khurrumnasimm@gmail.com, Mon Aug 13 11:11:36 2018 -0700]","Body":"Add a deployment method using docker-compose\n\nDescriptions of the changes in this PR:\n\n### Motivation\n\nProvide a deployment method using docker-compose.\n\n### Changes\n\n- Use helm as the template engine to generate docker compose file\n- Deploy zookeeper in cluster mode in docker-compose\n- Manages port mapping to make it able to access out side of the docker-composed cluster.\n\nAuthor: Khurrum Nasimm <khurrumnasimm@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1530 from khurrumnasimm/docker_compose\n","Date":"Mon Aug 13 20:11:36 CEST 2018"},{"Commit-ID":"commit 046debbb1a315dfe3ee46064391cb8882ce3d9cc 1534191523 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Aug 13 13:18:43 2018 -0700]","Body":"Create CI jobs for branch-4.8\n\nIn order to ensure quality on branh-4.8 we need to create CI jobs which run periodically QA tests\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1593 from eolivelli/ci_jobs_for_48\n","Date":"Mon Aug 13 22:18:43 CEST 2018"},{"Commit-ID":"commit 511fc810d753dbdf147a2e2eabb9065192cdf7e5 1534193467 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Aug 13 22:51:07 2018 +0200]","Body":"Make bookie watcher an interface\n\nSo that it can be mocked out easily for testing.\nThis patch also contains a simple mock.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1594 from ivankelly/bookie-watcher-iface\n","Date":"Mon Aug 13 22:51:07 CEST 2018"},{"Commit-ID":"commit 36d8590e42f8f34f79568dad7494c38c28adecb4 1534240575 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Aug 14 11:56:15 2018 +0200]","Body":"Make bookie client an interface\n\nSo that it can be mocked easily for testing.\nThis patch also contains a simple mock.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1595 from ivankelly/bookie-client-iface\n","Date":"Tue Aug 14 11:56:15 CEST 2018"},{"Commit-ID":"commit b0c04dffdf0c6f243ef9f17326c9e5ad83d20544 1534318583 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Wed Aug 15 00:36:23 2018 -0700]","Body":"Provide consistent locking mechanism in EntryLogManagerForEntryLogPerLedger\n\nDescriptions of the changes in this PR:\n\nAssumption: The lock stored alongside the EntryLog in this map is meant\nto be used to ensure that no two threads can be writing to the same\nledger at the same time.\n\nThe above invariant can be violated if the EntryLogAndLockTuple\nobject is evicted from the cache while in a critical section nominally\nprotected by the contained lock.\n\nThe conditions required for this to happen would be pretty odd --\nthere needs to be a huge amount of cache churn during one of\nthe protected operations.\n\nThe fix for this issue is to allocate in the constructor a fixed array of locks and select\nfor each EntryLogAndLockTuple a lock from that array\ndeterministically by ledgerId such that the same ledgerId\nwill always get the same lock.\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1600 from reddycharan/elmlock\n","Date":"Wed Aug 15 09:36:23 CEST 2018"},{"Commit-ID":"commit a7e66e1dd84ff17c918dbbf54e5baa18ff9c9c9b 1534438437 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Aug 16 09:53:57 2018 -0700]","Body":"ISSUE #1606: Fixed race condition during expansion of concurrent open hash maps\n\n### Motivation\n\nAs reported in #1606, there is a race condition in the concurrent open hash maps implementation. The race happens when the maps gets re-hashed after the expansion and the new arrays are substituting the old ones.\n\nThe race itself is that a thread doing a `get()` on the map is first checking the current `capacity` of the map, uses that to get the bucket and then tries to do optimistic read of the value in that bucket.\n\nThis assumes `capacity` update is visible only after the `values` array is already swapped, but that is not always the case in current code.\n\n### Changes\n * Use `volatile` qualifier for `capacity` and `values` arrays to ensure ordering of memory read is respected by compiler\n * In rehashing, update `capacity` after `values`\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1607 from merlimat/fix-concurrent-maps, closes #1606\n","Date":"Thu Aug 16 18:53:57 CEST 2018"},{"Commit-ID":"commit d57cc6679b4181e514d04e8f3f1d7e598308d78f 1534470018 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Aug 16 18:40:18 2018 -0700]","Body":"ISSUE #1528: logging \"No network topology script is found when using script based DNS resolver\" can be noisy and misleading.\n\nDescriptions of the changes in this PR:\n\n ### Motivation\n\n\"No network topology script is found when using script based DNS resolver\" is misleading and noisy.\n\n ### Changes\n\nOnly log the error message but not the stack trace.\n\nMaster Issue: #1528\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1605 from sijie/fix_log_message, closes #1528\n","Date":"Fri Aug 17 03:40:18 CEST 2018"},{"Commit-ID":"commit 987f8046d9f253354c512bd2aa32307ff9ed1019 1534470130 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Aug 16 18:42:10 2018 -0700]","Body":"Typo in bookie request processor read handling\n\nThe response in the case of overload should take the ledgerId and\nentryId from the read request.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1590 from ivankelly/request-processor-typo\n","Date":"Fri Aug 17 03:42:10 CEST 2018"},{"Commit-ID":"commit 0459d673891c911ba8ed8e83a90f083b71a9d413 1534521193 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Aug 17 08:53:13 2018 -0700]","Body":"[BOOKIE] Avoid throwing exceptions if a loopback address is returned from the possible ip check\n\nDescriptions of the changes in this PR:\n\n ### Motivation\n\nAt some network environment, a loopback address might be returned by default. However when you\nwant to specify `advertisedAddress` to avoid the loopback address, it still throws exception as\nfollowing:\n\n```\n17:23:35.696 [main] ERROR org.apache.bookkeeper.server.Main - Failed to build bookie server\norg.apache.bookkeeper.bookie.BookieException$UnknownBookieIdException: java.net.UnknownHostException: Trying to listen on loopback address, 127.0.0.1:3181 but this is forbidden by default (see ServerConfiguration#getAllowLoopback())\n\tat org.apache.bookkeeper.bookie.Bookie.possibleBookieIds(Bookie.java:325) ~[org.apache.bookkeeper-bookkeeper-server-4.7.1.jar:4.7.1]\n\tat org.apache.bookkeeper.bookie.Bookie.checkEnvironmentWithStorageExpansion(Bookie.java:415) ~[org.apache.bookkeeper-bookkeeper-server-4.7.1.jar:4.7.1]\n\tat org.apache.bookkeeper.bookie.Bookie.checkEnvironment(Bookie.java:256) ~[org.apache.bookkeeper-bookkeeper-server-4.7.1.jar:4.7.1]\n\tat org.apache.bookkeeper.bookie.Bookie.<init>(Bookie.java:627) ~[org.apache.bookkeeper-bookkeeper-server-4.7.1.jar:4.7.1]\n\tat org.apache.bookkeeper.proto.BookieServer.newBookie(BookieServer.java:115) ~[org.apache.bookkeeper-bookkeeper-server-4.7.1.jar:4.7.1]\n\tat org.apache.bookkeeper.proto.BookieServer.<init>(BookieServer.java:96) ~[org.apache.bookkeeper-bookkeeper-server-4.7.1.jar:4.7.1]\n\tat org.apache.bookkeeper.server.service.BookieService.<init>(BookieService.java:42) ~[org.apache.bookkeeper-bookkeeper-server-4.7.1.jar:4.7.1]\n\tat org.apache.bookkeeper.server.Main.buildBookieServer(Main.java:299) ~[org.apache.bookkeeper-bookkeeper-server-4.7.1.jar:4.7.1]\n\tat org.apache.bookkeeper.server.Main.doMain(Main.java:219) [org.apache.bookkeeper-bookkeeper-server-4.7.1.jar:4.7.1]\n\tat org.apache.bookkeeper.server.Main.main(Main.java:201) [org.apache.bookkeeper-bookkeeper-server-4.7.1.jar:4.7.1]\n\tat org.apache.bookkeeper.proto.BookieServer.main(BookieServer.java:252) [org.apache.bookkeeper-bookkeeper-server-4.7.1.jar:4.7.1]\nCaused by: java.net.UnknownHostException: Trying to listen on loopback address, 127.0.0.1:3181 but this is forbidden by default (see ServerConfiguration#getAllowLoopback())\n\tat org.apache.bookkeeper.bookie.Bookie.getBookieAddress(Bookie.java:564) ~[org.apache.bookkeeper-bookkeeper-server-4.7.1.jar:4.7.1]\n\tat org.apache.bookkeeper.bookie.Bookie.possibleBookieIds(Bookie.java:315) ~[org.apache.bookkeeper-bookkeeper-server-4.7.1.jar:4.7.1]\n\t... 10 more\n```\n\nThe exception is thrown on `possibleBookieIds` check. However we don't need to throw exception on `possibleBookieIds` check\nif it is a loopback address. We can defer the exception until bookie attempts to listen on the loopback address.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1609 from sijie/avoid_exceptions_on_possible_ips\n","Date":"Fri Aug 17 17:53:13 CEST 2018"},{"Commit-ID":"commit bf7e15e04f8f040abb0fe346faa762f95d42e447 1534521438 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Fri Aug 17 08:57:18 2018 -0700]","Body":"BP-34: Cluster metadata checker\n\nDescriptions of the changes in this PR:\n\n- BP for cluster metadata checker\n\nMaster Issue: #1602\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1603 from reddycharan/checkerbp\n","Date":"Fri Aug 17 17:57:18 CEST 2018"},{"Commit-ID":"commit f5474b1380b73819ba9f85b42d006f9ad7e45aa5 1534536262 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri Aug 17 13:04:22 2018 -0700]","Body":"Downgraded ZK version to 3.4.13\n\n### Motivation\n\nBK 4.7 has shipped with newer ZooKeeper client 3.5.3-beta. In many cases, there has been concerns regarding having a dependency on a \"beta\" release. Irrespective of the seriousness of these concerns for the specific case of ZK which has been in alpha/beta for a very long time, we should not have dependency on versions of software for which the team itself has marked as \"not yet stable\".\n\nAdding to that, there is no clear roadmap or ETA for when final 3.5.x stable release will be available.\n\n### Changes\n\n * Downgraded ZK to latest stable version 3.4.13\n * Adjusted few usages of new client APIs that were introduced in 3.5.x\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1601 from merlimat/downgrade-zk\n","Date":"Fri Aug 17 22:04:22 CEST 2018"},{"Commit-ID":"commit 299fb58deed3dc284342716d52b7f918cc6cefc4 1534833052 -----sp","Author":"PersonIdent[Andrey Yegorov, ayegorov@salesforce.com, Mon Aug 20 23:30:52 2018 -0700]","Body":"Issue #1584: LedgerHandleAdv should expose asyncAddEntry variant that takes ByteBuf (LedgerHandle exposes it as public)\n\nDescriptions of the changes in this PR:\n\n- exposed asyncAddEntry as public, similarly to other variants.\n- fixed ByteBuf retention\n\n### Motivation\n\nIt's useful to have this exposed as public for clients to make use of netty's allocator and pass ByteBuf directly.\n\n### Changes\n\nexposed asyncAddEntry as public, similarly to other variants.\n\nMaster Issue: #1584\n\nAuthor: Andrey Yegorov <ayegorov@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1585 from dlg99/feature/issue-1584-LedgerHandleAdv-public-addEntry-bytebuff, closes #1584\n","Date":"Tue Aug 21 08:30:52 CEST 2018"},{"Commit-ID":"commit 8e103282de68102ecb1cf4cbafae690ef0914f6f 1534850592 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Aug 21 13:23:12 2018 +0200]","Body":"Make LedgerHandle injectable\n\nThis patch removes the hard dependency of LedgerHandle on BookKeeper.\nThis allows us to create an instance of LedgerHandle independently,\nwith a fully mocked BookieClient or LedgerManager and be clear on\nwhere the objects used by the LedgerHandle are coming from.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1589 from ivankelly/injectable-lh\n","Date":"Tue Aug 21 13:23:12 CEST 2018"},{"Commit-ID":"commit dd964d6388987d2431b9fc5afa87d6e2e993feb8 1534875314 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Aug 21 11:15:14 2018 -0700]","Body":"Ensure BufferedChannel instance is properly closed\n\nWhenever the the `EntryLogger` is closing the `BufferedChannel` instance (the channel used for writing) it is closing the file descriptor but it's not calling `close()` on the object itself.\n\nThis causes a small mem leak for each log file, because the `writeBuffer` from `BufferedChannel` is never released.\n\nI think this should be considered for a 4.7.1 release.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Charan Reddy Guttapalem <reddycharan18@gmail.com>, Matteo Merli <mmerli@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1414 from merlimat/fix-entry-log-leak\n","Date":"Tue Aug 21 20:15:14 CEST 2018"},{"Commit-ID":"commit f782a9d818a12479d08c580a68b2566715da4c89 1534876934 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Aug 21 11:42:14 2018 -0700]","Body":"ISSUE #1578: Fixed deadlock in auditor blocking ZK thread\n\n### Motivation\n\nFixes #1578\n\nAfter getting ZK callback from ZK event thread, we need to jump to a background thread before doing synchronous call to `admin.openLedgerNoRecovery(ledgerId);` which will try to make a ZK request a wait for a response (which would be coming through same ZK event thread currently blocked..)\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1608 from merlimat/fix-auditor-deadlock, closes #1578\n","Date":"Tue Aug 21 20:42:14 CEST 2018"},{"Commit-ID":"commit 5f2d45c8fa0619d50423f1672303fea2d1a59238 1534885694 -----sp","Author":"PersonIdent[Andrey Yegorov, ayegorov@salesforce.com, Tue Aug 21 14:08:14 2018 -0700]","Body":"Issue #1610: netty leak detector logs 'LEAK: HashedWheelTimer.release() was not called before it's garbage-collected.' in unit tests\n\nDescriptions of the changes in this PR:\n\nEnabled netty's paranoid leak detection for tests.\nFixed most of the 'LEAK: HashedWheelTimer.release() was not called before it's garbage-collected.' issues. Did not fix ones produced by AuditorElector. In long term we should fix these, ByteBuf leaks in BufferedChannel and whatever else we find and make tests fail if netty logs a leak.\n\n### Motivation\n\nI used to have random test timeouts/failures caused by delayed bookie shutdown when I built repo with OpenJDK 8 but ran tests after switching to Oracle JDK 8 (or vice versa). After these changes tests did not fail in these runs.\n\n### Changes\n\nMade bk/bkadmin/auditor close resources properly in the tests and shutdown calls.\nChanged order of initialization in Bookkeeper so it creates HashedWheelTimer after bookie client, in case bookie client creation fails due to misconfiguration.\n\nMaster Issue: #1610\n\nAuthor: Andrey Yegorov <ayegorov@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1613 from dlg99/fix/issue_1610_hashedwheeltimer, closes #1610\n","Date":"Tue Aug 21 23:08:14 CEST 2018"},{"Commit-ID":"commit 4eec3ce0f3dcd16b5ff84f14a95f9acc1d78e552 1534889470 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Tue Aug 21 15:11:10 2018 -0700]","Body":"Index for lockarray should be non-negative\n\nDescriptions of the changes in this PR:\n\nMake sure lockIndex is non-negative.\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1616 from reddycharan/modfix\n","Date":"Wed Aug 22 00:11:10 CEST 2018"},{"Commit-ID":"commit b9916d3d87208af36be6a7b061a594a33c897271 1534889541 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Aug 21 15:12:21 2018 -0700]","Body":"Allow to configure num of Netty IO threads in client and bookie\n\n### Motivation\n\nCurrently the number of IO threads for client and bookie are set to `2 *  Runtime.getRuntime().availableProcessors()`. Added configuration options to tune it.\n\nAuthor: Matteo Merli <mmerli@apache.org>\nAuthor: Sijie Guo <guosijie@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1612 from merlimat/configure-io-threads\n","Date":"Wed Aug 22 00:12:21 CEST 2018"},{"Commit-ID":"commit 77b7fb870ef0fc2743dbe444c768c6c63bbe6875 1534940069 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Aug 22 14:14:29 2018 +0200]","Body":"Get currentEnsemble from ledger rather than directly from metadata\n\nThis will allow us to override the currentEnsemble being used during\nrecovery without modifying the metadata itself.\n\nMaster issue: #281\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1586 from ivankelly/current-ensemble\n","Date":"Wed Aug 22 14:14:29 CEST 2018"},{"Commit-ID":"commit a5b4b93d76d69caed5800a4d4a56bd3e8add92ec 1535010705 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Aug 23 09:51:45 2018 +0200]","Body":"UpdateLedgerOp uses MetadataUpdateLoop\n\nAlso refactored a lot of things around the operation that didn't make\nsense, like the executor.\n\nMaster issue: #281\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1587 from ivankelly/update-ledger-op\n","Date":"Thu Aug 23 09:51:45 CEST 2018"},{"Commit-ID":"commit dca471dfddbdbdea3dac029ddd76958340fa6629 1535044742 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Aug 23 10:19:02 2018 -0700]","Body":"Avoid usage of RocksDB deleteRange() in DbLedgerStorage\n\n### Motivation\n\nThere are few issues that are reconducible to a performance degradation in RocksDB when using deleteRange() feature (eg: https://github.com/apache/incubator-pulsar/issues/1737 and others).\n\nThere is some discussion going on RocksDB to address this issue: https://github.com/facebook/rocksdb/issues/3959\n\nIn the meantime, we should rollback the change and don't use deleteRange until these issues are resolved.\n\n### Changes\n\nThis PR is essentially reverting back the commit https://github.com/yahoo/bookkeeper/commit/4b849904bcd65b49cf963e6508dc7fb745f56294 from Yahoo branch (which was squashed when merging back to apache).\nThe only addition here is to use `DELETE_ENTRIES_BATCH_SIZE` to amortize the cost of `batch.flush()` when there are many ledgers with few entries.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1620 from merlimat/rollback-delete-range\n","Date":"Thu Aug 23 19:19:02 CEST 2018"},{"Commit-ID":"commit 3672a280e9b1f776514cba7066e5100aa7a32d08 1535114191 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Aug 24 14:36:31 2018 +0200]","Body":"Add mock registration client\n\nFor testing the client without having to boot zookeeper.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1622 from ivankelly/mock-reg-client\n","Date":"Fri Aug 24 14:36:31 CEST 2018"},{"Commit-ID":"commit 73b428c7975c975f25956815670493a7093441ec 1535338268 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Aug 26 19:51:08 2018 -0700]","Body":"Provide async version of markLedgerUnderreplicated for LedgerUnderreplicationManager\n\nDescriptions of the changes in this PR:\n\n ### Motivation\n\nAuditor has multiple places calling sync methods in async callbacks.\nThis raises the possibility hitting deadlock. Issue #1578 is one of the examples.\n\nAfter looking into the `LedgerUnderreplicationManager`, `markLedgerUnderreplicated`\nis the only interface that will be called in async callbacks. This change is\nto provide an async version of `markLedgerUnderreplicated`.\n\n ### Changes\n\n- add `markLedgerUnderreplicatedAsync` interface in `LedgerUnderreplicationManager`.\n- implement the logic of `markLedgerUnderreplicated` using async callbacks\n- use `markLedgerUnderreplicatedAsync` in the Auditor\n\nRelated Issues: #1578\nMaster Issue: #1617\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Charan Reddy Guttapalem <reddycharan18@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1619 from sijie/async_sync_autorecovery\n","Date":"Mon Aug 27 04:51:08 CEST 2018"},{"Commit-ID":"commit 9279dcc13b95406dbcb7a333fcb8a8961f52bf16 1535434827 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Mon Aug 27 22:40:27 2018 -0700]","Body":"ISSUE #1623: ReadOnlyLedgerHandle: don't schedule monitorPendingAddOps()\n\nThe LedgerHandle constructor schedules an addEntryQuorumTimeout check\nwith the bk client scheduler. However, the only place this callback is\ncanceled is in the closeAsync (the one which returns a future, not to be\nconfused with asyncClose) method. asyncClose and close() both leak this\ncallback. Moreover, ReadOnlyLedgerHandle invokes the LedgerHandle\nconstructor and so also creates this callback, but it overrides close()\nand asyncClose() without passing them through.\n\nReadOnlyLedgerHandle already overrides\ninitializeExplicitLacFlushPolicy() to avoid write specific state.  This\npatch generalizes that hack to initializeWriteHandleState() and the\ncleanup to tearDownWriteHandleState().  tearDownWriteHandleState() is\nmoved into doAsyncClose(), which appears to be called for closes in\ngeneral.\n\n(rev cguttapalem)\n(bug W-5362724)\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1624 from athanatos/forupstream/wip-1623, closes #1623\n","Date":"Tue Aug 28 07:40:27 CEST 2018"},{"Commit-ID":"commit dca54b531e90cb0a0d91628efedd30959ee62ecc 1535463774 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Aug 28 15:42:54 2018 +0200]","Body":"Allow construction of mock client context from scratch\n\nSo that ledger handle functionality can be tested without\ninstantiating a BookKeeper client.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1625 from ivankelly/mock-client-context\n","Date":"Tue Aug 28 15:42:54 CEST 2018"},{"Commit-ID":"commit 4f70973aef55813ffccb6eb312e3fc6cb089207f 1535564250 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Aug 29 10:37:30 2018 -0700]","Body":"[RELEASE] update release script to generate sha512 instead of sha1\n\n*Motivation*\n\nAccording to [checksums requirements](http://www.apache.org/dev/release-distribution#sigs-and-sums),\nthe project should supply a sha256 and/or sha512 checksum file, and should not supply a MD5 and sha1 checksum file.\n\n*Changes*\n\nUpdate the release script to generate sha512 files\n\nDescriptions of the changes in this PR:\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1631 from sijie/sha512_files\n","Date":"Wed Aug 29 19:37:30 CEST 2018"},{"Commit-ID":"commit 18ce02ccd30607a70b694373fa4bca1719bd1d34 1535653494 -----sp","Author":"PersonIdent[Qi Wang, codingwangqi@gmail.com, Thu Aug 30 11:24:54 2018 -0700]","Body":"Update testcontainers to latest version\n\nDescriptions of the changes in this PR:\n\n### Motivation\n\nthe latest version of testcontainers provides a `doStart` method to allow adding logic before `doStart`.\n\nAuthor: Qi Wang <codingwangqi@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1636 from codingwangqi/update_testcontainers\n","Date":"Thu Aug 30 20:24:54 CEST 2018"},{"Commit-ID":"commit fa498fc110480adf6ce77da1f03216e3ff4eb198 1535697062 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Aug 30 23:31:02 2018 -0700]","Body":"[RELEASE] [WEBSITE] Create documentation for release 4.7.2\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1634 from sijie/website_472\n","Date":"Fri Aug 31 08:31:02 CEST 2018"},{"Commit-ID":"commit 04ce76aac703b4ad5c2e809edba03b3dbb6a80e1 1535730218 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Fri Aug 31 08:43:38 2018 -0700]","Body":"[RELEASE] Release Notes for 4.7.2\n\nDescriptions of the changes in this PR:\n\nAdd the release notes for 4.7.2 release\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Andrey Yegorov <None>, Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1628 from sijie/release_notes_472\n","Date":"Fri Aug 31 17:43:38 CEST 2018"},{"Commit-ID":"commit af9d4c312ef1640fbbfb6765943c9a83242a4f37 1536089391 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Tue Sep 4 12:29:51 2018 -0700]","Body":"Fix EntryLoggerAllocator.stop\n\nDescriptions of the changes in this PR:\n\n- make sure EntryLoggerAllocator.stop terminates pending allocatorExecutor's task.\nOtherwise tests would flap, since even after EntryLoggerAllocator.stop, there is\npossibility of new entrylog creation, which is not expected.\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Andrey Yegorov <None>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1627 from reddycharan/entryalocshut\n","Date":"Tue Sep 04 21:29:51 CEST 2018"},{"Commit-ID":"commit c766575c7b36c2692fe403c996a3fd3516e5708a 1536089475 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Sep 4 12:31:15 2018 -0700]","Body":"Recovery uses immutable metadata\n\nAnd MetadataUpdateLoop to update it.\n\nMaster issue: #281\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1621 from ivankelly/recovery-immutable\n","Date":"Tue Sep 04 21:31:15 CEST 2018"},{"Commit-ID":"commit 8326b3033390d649261aae2f3576bb7f922f1f3e 1536093605 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Sep 4 13:40:05 2018 -0700]","Body":"[DOCKER] update package to 4.7.2 in dockerfile\n\nDescriptions of the changes in this PR:\n\n### Motivation\n\nWe need to generate 4.7.2 docker image.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1644 from sijie/update_docker_image_47\n","Date":"Tue Sep 04 22:40:05 CEST 2018"},{"Commit-ID":"commit 1db41acf1503e38694dba60adb478b2bfb4d41f9 1536098045 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Tue Sep 4 14:54:05 2018 -0700]","Body":"[WEBSITE] 4.7.2 only has sha512 file not sha1 file\n\nDescriptions of the changes in this PR:\n\n*Motivation*\n\nSince 4.7.2 bookkeeper releases only provide sha512 file, not sha1 file.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nThis closes #1647 from sijie/update_website_472\n","Date":"Tue Sep 04 23:54:05 CEST 2018"},{"Commit-ID":"commit 18a40787930df990e9e3ac3aad58011dc65b1b9f 1536174449 -----sp","Author":"PersonIdent[Qi Wang, codingwangqi@gmail.com, Wed Sep 5 12:07:29 2018 -0700]","Body":"ISSUE #1630: TestHttpService#testWhoIsAuditorService is flaky\n\nDescriptions of the changes in this PR:\n\n ### Motivation\n\nFixes #1630. The problem is auditor elector was started async, the test itself doesn't wait until election completed.\nso the test can be running before auditor runs elector.\n\n ### Changes\n\nThe fix is simple, just wait until auditor completes election.\n\nMaster Issue: #1630\n\nAuthor: Qi Wang <codingwangqi@gmail.com>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1649 from codingwangqi/issue_1630, closes #1630\n","Date":"Wed Sep 05 21:07:29 CEST 2018"},{"Commit-ID":"commit 5d0d0569f0f394f709e66371643d80d5bb79a2d7 1536174718 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Wed Sep 5 12:11:58 2018 -0700]","Body":"[WEBSITE] fix download link to allow user choosing mirror site\n\nAddress the download link according to https://www.apache.org/dev/release-distribution#download-links\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1650 from sijie/fix_download_links\n","Date":"Wed Sep 05 21:11:58 CEST 2018"},{"Commit-ID":"commit a031e0ede1767960d191d70a6cda21990d1f541e 1536219263 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Sep 6 09:34:23 2018 +0200]","Body":"Make LedgerFragmentReplicator use MetadataUpdateLoop\n\nMaster Issue: #281\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1645 from ivankelly/ledger-fragment-immutable-metadata2\n","Date":"Thu Sep 06 09:34:23 CEST 2018"},{"Commit-ID":"commit d7c99f86dd60534739c9eec1c826b4736c38c162 1536221438 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Thu Sep 6 10:10:38 2018 +0200]","Body":"ISSUE #1658: License file: typo \"Google Protocal Buffers\" instead of \"Google Protocol Buffers\"\n\nFix a typo in LICENSE files for binary distributions.\n\nMaster issue #1658\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1659 from eolivelli/fix/protocal-typo, closes #1658\n","Date":"Thu Sep 06 10:10:38 CEST 2018"},{"Commit-ID":"commit 83aae3357ceaa40f2ae70c186da951b8f52f57db 1536257769 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Sep 6 11:16:09 2018 -0700]","Body":"[WEBSITE] Issue #1652: fix anchor links at download page\n\nDescriptions of the changes in this PR:\n\nAs reported in #1652, the anchor links at download page are broken.\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1656 from sijie/fix_download_links_2, closes #1652\n","Date":"Thu Sep 06 20:16:09 CEST 2018"},{"Commit-ID":"commit 40185e1f39fafd0c796cec38d463ebd55edaa250 1536268453 -----sp","Author":"PersonIdent[Qi Wang, codingwangqi@gmail.com, Thu Sep 6 14:14:13 2018 -0700]","Body":"Open ledger returns no ledger exception if ledger id is negative\n\nDescriptions of the changes in this PR:\n\n### Motivation\n\nif I open a ledger with negative value, bookkeeper client responds 'NoSuchLedgerException'. But I think it should return `IllegalOpException`, because it is an illegal exception.\n\nAuthor: Qi Wang <codingwangqi@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1638 from codingwangqi/fix_return_code\n","Date":"Thu Sep 06 23:14:13 CEST 2018"},{"Commit-ID":"commit 318893399b8040a7d291b8094f0d218a3b4e4f1e 1536295210 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Sep 6 21:40:10 2018 -0700]","Body":"Utility to rebuild interleaved storage index files\n\nWe came across a case where the a ledger had been deleted from\nzookeeper accidently. It was possible to recover the ledger metadata\nfrom the zookeeper journal and old snapshots, but the bookies had\ndeleted the indices by this time. However, even if the index is\ndeleted, the data still exists in the entrylog.\n\nThis utility scans the entrylog to rebuild the index, thereby making\nthe ledger available again.\n\nAuthor: Ivan Kelly <ivank@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1642 from ivankelly/regen-from-entrylogger\n","Date":"Fri Sep 07 06:40:10 CEST 2018"},{"Commit-ID":"commit 992db732f42e5d4425ec2f986fb42e29515a182b 1536296524 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Thu Sep 6 22:02:04 2018 -0700]","Body":"BP-35: 128 bits support\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nBookKeeper coordinates with a metadata store to generate a cluster wide `ledgerId`.\r\nCurrently this is a signed `64 bit` number (effectively 63 bits). This method works\r\ngreat because we have a centralized metadata store for coordinating the id generation.\r\nHowever this method may not scale as the cluster size and number of ledgers grow.\r\n\r\n[Universally unique identifier - Wikipedia](https://en.wikipedia.org/wiki/Globally_unique_identifier)\r\nis a preferred way to generate decentralized globally unique IDs and it takes `128 bits`.\r\nThis method can scale well as it doesn't need a centralized coordination.\r\n\r\nThis BP proposes the changes for increasing ledger id from `63 bits` to `128 bits`.\r\n\r\nMaster Issue: #603\r\n\r\n\r\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Andrey Yegorov <None>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1611 from sijie/bp_35_128bits","Date":"Fri Sep 07 07:02:04 CEST 2018"},{"Commit-ID":"commit f1f5dfe6d42fae4006bd16f284db211ff441c876 1536345731 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Fri Sep 7 11:42:11 2018 -0700]","Body":"[DEV] clean up merge script\n\nDescriptions of the changes in this PR:\r\n\r\n ### Motivation\r\n\r\nThe development of bookkeeper has been moved from JIRA to Github.\r\nSo we can clean up the merge script to remove those instructions\r\nassuming we are still on apache mirror and JIRA.\r\n\r\n ### Changes\r\n\r\nThis change follows the changes that I have adjusted at apache/incubator-pulsar#2526\r\n\r\n- remove related logic about JIRA from merge script\r\n- change merge script to use github merge api\r\n\r\n\r\n\nAuthor: \n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1663 from sijie/improve_merge_script_2","Date":"Fri Sep 07 20:42:11 CEST 2018"},{"Commit-ID":"commit 8711c3b911beb79c20ca87e47077a8ab4ccf5025 1536358038 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Fri Sep 7 15:07:18 2018 -0700]","Body":"ISSUE #1653: Clients with zk:// uri's should read layout from store\n\nzk+null:// will cause the layout to be read from the store.  This patch\r\nupdates zk:// to do the same.  This matches past behavior with an\r\nunspecified ledgerManagerFactoryClass.\r\n\r\nSome tests needed to be updated with the new behavior.\r\n\r\n(bug W-5415120)\r\n(rev cguttapalem)\r\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1668 from athanatos/forupstream/wip-1653, closes #1653","Date":"Sat Sep 08 00:07:18 CEST 2018"},{"Commit-ID":"commit 74bd92605bc4986705031aea8943905dbc9f9f85 1536358137 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Fri Sep 7 15:08:57 2018 -0700]","Body":"ISSUE #1662: LocalBookKeeper use layout manager and ledger path configs\n\nThe URI patch had a side effect of causing LocalBookKeeper to always\r\nuse a URI string of the form zk:// which defaults to HLM.  This\r\npatch updates LocalBookKeeper to generate zk+<layout>:// based on\r\nthe legacy LEDGER_MANAGER_FACTORY_CLASS config when present.  +null\r\nwill be used otherwise and defaults to HLM.  Further, use the\r\n(admittedly deprecated) zkLedgerRootPath config to determine the\r\nledger path (defaults to /ledger, so the behavior will be unchanged\r\nif unspecified).\r\n\r\n(bug W-5415276)\r\n(rev cguttapalem)\r\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1669 from athanatos/forupstream/wip-1662, closes #1662","Date":"Sat Sep 08 00:08:57 CEST 2018"},{"Commit-ID":"commit cdd659471e1fb75aaf7738302dbf0dfaf44a9127 1536609527 -----sp","Author":"PersonIdent[JV Jujjuri, vjujjuri@salesforce.com, Mon Sep 10 12:58:47 2018 -0700]","Body":"Issue #1664 Cancel Scheduled SpeculativeReads\n\nIf configured every read request schedules a Future task\nto send speculative reads on speculativeReadTimeout.\nWhen the read is completed successfully, this task must be\ncanceled otherwise it leads to memory consumption and under\nheavy load the tasks get accumulated which forces lengthy\nGC cycles. These lengthy GC cycles may cause ZK lease expiry\nand all other sorts of problems eventually resulting in application\nerrors.\n\nThis fix makes sure that the scheduled Futures are cancelled\nat the end of read task.\n\nSigned-off-by: Venkateswararao Jujjuri (JV) <vjujjurisalesforce.com>\n(ref Andrey)\n\nDescriptions of the changes in this PR:\n\n### Motivation\n\n(Explain: why you're making that change, what is the problem you're trying to solve)\n\n### Changes\n\n(Describe: what changes you have made)\n\nMaster Issue: #<master-issue-number>\n\nAuthor: JV Jujjuri <vjujjuri@salesforce.com>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Andrey Yegorov <None>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1665 from jvrao/ups_speculative_cancel, closes #1664\n","Date":"Mon Sep 10 21:58:47 CEST 2018"},{"Commit-ID":"commit 0446c823e36c762479cde9f69883175f8b140074 1536610448 -----sp","Author":"PersonIdent[Qi Wang, codingwangqi@gmail.com, Mon Sep 10 13:14:08 2018 -0700]","Body":"BookieWatcherImpl doesn't initCause when throwing MetaStoreException\n\nDescriptions of the changes in this PR:\n\n### Motivation\n\nwhen BookieWatcherImpl throws MetaStoreException, it doesn't provide the cause. so when the exception is logged, we can't tell the actual failure cause.\n\nAuthor: Qi Wang <codingwangqi@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1637 from codingwangqi/fill_cause_in_exception\n","Date":"Mon Sep 10 22:14:08 CEST 2018"},{"Commit-ID":"commit 052908ef30818d9f1e6be56bf3a3e3083c5bd6fb 1536610845 -----sp","Author":"PersonIdent[cguttapalem, cguttapalem@salesforce.com, Mon Sep 10 13:20:45 2018 -0700]","Body":"Remove unnecessary log statement in LedgerDirsManager.getWritableLedgerDirs\n\nDescriptions of the changes in this PR:\n\n### Motivation\n\n- when Bookie reaches diskusage threshold, LedgerDirsMonitor for every diskCheckInterval it logs NoWritableLedgerDirException call stack and message \"All ledger directories are non writable\".\n\n### Changes\n\nSo remove unneccessary log statement in LedgerDirsManager.getWritableLedgerDirs and let the caller deal with the thrown exception.\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Andrey Yegorov <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1670 from reddycharan/fixdirsmonitorlog\n","Date":"Mon Sep 10 22:20:45 CEST 2018"},{"Commit-ID":"commit c420b39a3dab4e9f8896c59d92cbfe4e9a7a0d30 1536679523 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Tue Sep 11 17:25:23 2018 +0200]","Body":"Use useradd -l option for docker scripts\n\nThis is a workaround for the Docker issue https://github.com/moby/moby/issues/5419\n\nIf you run the scripts with an very large uid the script hangs and it fills up the disk which contains /var/lib/docker\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1673 from eolivelli/fix/docker-large-uid\n","Date":"Tue Sep 11 17:25:23 CEST 2018"},{"Commit-ID":"commit d8f2cd1b88a144b6a00c5b8d68c8071d014f5ece 1536688646 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Tue Sep 11 19:57:26 2018 +0200]","Body":"Release script: Use realpath() to map to current user home\n\nThis change enables to run the release scripts on linux boxes in which the user's home is not at /home/username\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1674 from eolivelli/fix/better-userland-mapping\n","Date":"Tue Sep 11 19:57:26 CEST 2018"},{"Commit-ID":"commit 5a818b226bf2c3e3d9d649ffe1e690af5ec2f794 1536739253 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Wed Sep 12 10:00:53 2018 +0200]","Body":"Release script: swap mapping of directories\n\nThe script assumed that the layout of /home on the host machine is the same as in the container.\nThis change makes the script work even on machines in which the HOME is /home/xxxx/username and not simply /home/username\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1675 from eolivelli/fix/invert-mapping\n","Date":"Wed Sep 12 10:00:53 CEST 2018"},{"Commit-ID":"commit b2439d67073c880d350f93c1939bbede5e00ec49 1536907646 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Sep 14 08:47:26 2018 +0200]","Body":"Utility to dump/restore ledger metadata to/from file\n\nDumping will dump the serialized metadata to a file. Restoring will\r\nparse the metadata from the file and write it to the metadata store.\r\n\r\nAlso changes the LedgerIdFormatter to default to long formatter (it\r\nwas UUID before, and we don't even currently support UUID ledger ids).\r\n\r\nThis fixes #1604\r\n\n\nAuthor: Ivan Kelly <ivank@apache.org>\nAuthor: Enrico Olivelli <eolivelli@apache.org>\nAuthor: cguttapalem <cguttapalem@salesforce.com>\nAuthor: Qi Wang <codingwangqi@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>, Jia Zhai <None>\n\nThis closes #1667 from ivankelly/dump-metadata-to-from-file","Date":"Fri Sep 14 08:47:26 CEST 2018"},{"Commit-ID":"commit e04c791499e51f2d5b4f288c5f349777103c555d 1536946397 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Fri Sep 14 10:33:17 2018 -0700]","Body":"[DEV] make merge script work with python 3\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nmake sure the script works for python 3 as well.\r\n\r\n### Changes\r\n\r\nsince python2 and python3 have different syntax and library, make a copy of the merge script for python3.\r\n\r\n\r\n\n\nAuthor: \n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1677 from sijie/make_merge_script_works_for_37","Date":"Fri Sep 14 19:33:17 CEST 2018"},{"Commit-ID":"commit c9dc301feb48ca170c3d6205a36fca63a4950c5a 1537171605 -----sp","Author":"PersonIdent[Andrey Yegorov, dlg99@users.noreply.github.com, Mon Sep 17 01:06:45 2018 -0700]","Body":"Issue #850: Added request context across client and bookies.\n\nDescriptions of the changes in this PR:\r\n\r\n - MDC context is passed to runnables, callables etc.\r\n - protocol extended, context is sent to bookie servers, restored there and back on client with the response.\r\n   Hopefully did not miss some nuance on the server side, largely rely on changes in ordered executors to do all the magic.\r\n - did microbenchmarking of the protocol changes (strings added to protobuf, MDC context preserved/restored). Looks ok.\r\n - added unit tests.\r\n\r\n(bug W-5291641) \r\n(bug W-5291648)\r\n\r\n\r\n### Motivation\r\n\r\nTroubleshooting of request-level failures/errors can be simplified if request id was passed through all the stages of the request, from threadpools on the client to bookies to the response back on the client. \r\nLog4j/Slf4j allows logging of MDC data so it makes sense to use this functionality for logging.\r\n\r\n### Changes\r\n\r\n - MDC context is passed to runnables, callables etc.\r\n - protocol extended, context is sent to bookie servers, restored there and back on client with the response.\r\n   Hopefully did not miss some nuance on the server side, largely rely on changes in ordered executors to do all the magic.\r\n - did microbenchmarking of the protocol changes (strings added to protobuf, MDC context preserved/restored). Looks ok.\r\n - added unit tests.\r\n\r\nMaster Issue: #850 \r\n\r\n\r\n\n\nAuthor: Andrey Yegorov <ayegorov@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Venkateswararao Jujjuri (JV) <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1672 from dlg99/feature/correlation_id, closes #850","Date":"Mon Sep 17 10:06:45 CEST 2018"},{"Commit-ID":"commit 0ab6864e51524ed02e7eae29cbcdfc94a0c6d073 1537262703 -----sp","Author":"PersonIdent[SongWang, aCoder2013@users.noreply.github.com, Tue Sep 18 17:25:03 2018 +0800]","Body":"Issue #1679 : Fix build failure due to javadoc\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\nFix build failure due to javadoc, additionalOptions' type is  an array .\r\n### Changes\r\n\r\ncorrect assignment strategy of additionalOptions to avoid type mismatch\r\n\r\nMaster Issue: #1679 \r\n\n\nAuthor: songsong <songsong@taovip.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1681 from aCoder2013/fix-javadoc-build, closes #1679","Date":"Tue Sep 18 11:25:03 CEST 2018"},{"Commit-ID":"commit a9665f8494ae7e6fb6066ebfb652e72228fb677b 1537292572 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Sep 18 19:42:52 2018 +0200]","Body":"Fix license issues in master\n\nThe only blocking error is that the GRPC NOTICE had not been bubbled\r\nup to our notice.\r\n\r\nThe links for common-lang 3.6 and jackson 1.9.11 were also wrong, and\r\nwhile these aren't required in license files, bad links makes it\r\nharder to check if a dependency has been correct noted in the LICENSE\r\nand NOTICE.\r\n\n\nAuthor: Andrey Yegorov <dlg99@users.noreply.github.com>\nAuthor: Ivan Kelly <ivank@apache.org>\nAuthor: SongWang <aCoder2013@users.noreply.github.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1684 from ivankelly/v48-license","Date":"Tue Sep 18 19:42:52 CEST 2018"},{"Commit-ID":"commit 0284c147d5a81578b7005af6f8ee5bd28c6cae15 1537430913 -----sp","Author":"PersonIdent[Mate Varga, m@matevarga.net, Thu Sep 20 10:08:33 2018 +0200]","Body":"ISSUE #1687: Using eval instead of exec to handle quotes in healtcheck.sh\n\nDescriptions of the changes in this PR:\r\n\r\nFixes https://github.com/apache/bookkeeper/issues/1687\r\n\r\n\r\n### Motivation\r\n\r\nhttps://github.com/apache/bookkeeper/issues/1687\r\n\r\n### Changes\r\nUsing eval instead of exec to run the health check script.\r\n\r\nMaster Issue: #1687 \r\n\r\n\r\n\n\nAuthor: matevarga <mate@monadic.hu>\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1688 from matevarga/master, closes #1687","Date":"Thu Sep 20 10:08:33 CEST 2018"},{"Commit-ID":"commit 04edde0668c30b79391f9d00ded0494bbc9aca08 1537463091 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Thu Sep 20 10:04:51 2018 -0700]","Body":"Shutdown appropriate EntryLogger instance.\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n- EntryLogger's instance shutdown method should be called\r\n- Otherwise test would flap, since in tearDown method, FileUtils.deleteDirectory can fail because of EntryLogFile PreAllocation task.\r\n\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1686 from reddycharan/entrylogtest","Date":"Thu Sep 20 19:04:51 CEST 2018"},{"Commit-ID":"commit 45321ba7981fdcdcd3194b14a055487b1a5a227a 1537463370 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Thu Sep 20 10:09:30 2018 -0700]","Body":"[TABLE SERVICE] remove build warnings \"Import xxx.proto but not used\"\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nThere are build warnings about `Import xyz.proto but not used`. for example:\r\n\r\n```\r\ncluster.proto: warning: Import common.proto but not used.\r\nkv_store.proto: warning: Import kv.proto but not used.\r\n```\r\n\r\n*Changes*\r\n\r\nRemove unused imports\r\n\r\n\r\n\r\n\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1685 from sijie/remove_warnings","Date":"Thu Sep 20 19:09:30 CEST 2018"},{"Commit-ID":"commit 72331e21cc84430a8f77f757557c8d2fbddf3554 1537543731 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Fri Sep 21 08:28:51 2018 -0700]","Body":"Bump journal and fileinfo version.\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n\r\n- As part of ISSUE #1527, new versions of 'journalFormatVersionToWrite'\r\nand 'fileInfoFormatVersionToWrite' are introduced. Since 4.8 release version\r\nis created, default values of these versions should be bumped.\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1689 from reddycharan/bumpjournalversion","Date":"Fri Sep 21 17:28:51 CEST 2018"},{"Commit-ID":"commit c7f1e70f437423ed70f6feb02ef14d2d032abb9e 1537745878 -----sp","Author":"PersonIdent[Qi Wang, 42832902+codingwangqi@users.noreply.github.com, Sun Sep 23 16:37:58 2018 -0700]","Body":"Issue #1639: Etcd based metadata driver implementation\n\nDescriptions of the changes in this PR:\r\n\r\nProvide a metadata driver based on Etcd. The changes were based on sijie's prototype at #1114 \r\n\r\nMaster Issue: #1639 \r\n\r\n\r\n\nAuthor: Qi Wang <codingwangqi@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1640 from codingwangqi/etcd_metadata_driver, closes #1639","Date":"Mon Sep 24 01:37:58 CEST 2018"},{"Commit-ID":"commit 4deb4d15390f4b633021539b3c92806291411f57 1537769322 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Sun Sep 23 23:08:42 2018 -0700]","Body":"[TABLE SERVICE] [PYTHON] introduce a python client for table service\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nWe need a python client for accessing table service.\r\n\r\n*Changes*\r\n\r\nThis is the first change for introducing a python client for table service.\r\n\r\n- setup the directory structure for the python client\r\n- setup build, lint, test for the client\r\n- implement the admin client for creating/deleting/getting namespaces/streams\r\n- add examples for admin client\r\n\r\nMaster Issue: #1690\r\n\r\n\r\n\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1691 from sijie/stream_python_client","Date":"Mon Sep 24 08:08:42 CEST 2018"},{"Commit-ID":"commit 4f0d2a195bd9be3788876b47813cee1440cf005c 1537769377 -----sp","Author":"PersonIdent[Qi Wang, 42832902+codingwangqi@users.noreply.github.com, Sun Sep 23 23:09:37 2018 -0700]","Body":"autorecovery-use-metadata-driver (part 1) : move AutoRecoveryMain to use MetadataBookieDriver\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nWe are introducing Etcd as the metadata storage. However AutoRecovery currently is still tied to zookeeper. In order to use Etcd as the metadata storage, we have to move AutoRecovery related classes to use metadata driver API.\r\n\r\n### Changes\r\n\r\nThis is the first change for changing AutoRecovery to use metadata driver. It changed AutoRecoveryMain to use metadata driver api and also removed the shutdown logic on session expired, which doesn't make any sense for current retryable zookeeper.\r\n\r\n\r\n\r\n\r\n\nAuthor: Qi Wang <codingwangqi@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1693 from codingwangqi/autorecovery_metadata","Date":"Mon Sep 24 08:09:37 CEST 2018"},{"Commit-ID":"commit af246529b0728087b1c65a50b919abe7d4b5103f 1537773501 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Mon Sep 24 00:18:21 2018 -0700]","Body":"Enable storeSystemTimeAsLedgerUnderreplicatedMarkTime\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n- Enable the Auditor to use system time as underreplicated ledger mark time.\r\nIf this is enabled, Auditor will write a ctime field into the\r\nunderreplicated ledger znode.\r\n\r\nhttps://github.com/apache/bookkeeper/commit/f4094c4992d5b22630fa633085a00a9152b87ffe introduced feature to Record ctime for underreplicated ledger mark time.\n\nAuthor: Sijie Guo <guosijie@gmail.com>\nAuthor: Qi Wang <42832902+codingwangqi@users.noreply.github.com>\nAuthor: cguttapalem <cguttapalem@salesforce.com>\nAuthor: Charan Reddy Guttapalem <reddycharan18@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1692 from reddycharan/enablectime","Date":"Mon Sep 24 09:18:21 CEST 2018"},{"Commit-ID":"commit cd85888086a819b20325d997680abe91ac3e786e 1537841733 -----sp","Author":"PersonIdent[Qi Wang, 42832902+codingwangqi@users.noreply.github.com, Mon Sep 24 19:15:33 2018 -0700]","Body":"autorecovery-use-metadata-driver (part 2) : remove ZooKeeper from ReplicationWorker\n\nDescriptions of the changes in this PR:\r\n\r\n*Changes*\r\n\r\nThis is the second part of changing AutoRecovery to use metadata driver. It removes\r\nthe zookeeper reference from ReplicationWorker, because the zookeeper instance is not\r\nused anyway\r\n\r\nThis change is based on #1693 \r\n\r\n\r\n\nAuthor: Qi Wang <42832902+codingwangqi@users.noreply.github.com>\nAuthor: Qi Wang <codingwangqi@gmail.com>\nAuthor: Sijie Guo <guosijie@gmail.com>\nAuthor: Charan Reddy Guttapalem <reddycharan18@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1694 from codingwangqi/autorecovery_metadata_part2","Date":"Tue Sep 25 04:15:33 CEST 2018"},{"Commit-ID":"commit bb818f2c5cf1a92cb45b2e69a9be452708785cad 1537895437 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Tue Sep 25 10:10:37 2018 -0700]","Body":"[TABLE SERVICE] [PYTHON] add hash router for computing the hash routing value for a given key\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nAs part of implementing python client for #1690, we need a hash router to compute the hash routing value\r\nfor a given key.\r\n\r\n*Changes*\r\n\r\n- Murmur2 is not well supported in python 3. so standarized hash computation in using Murmur3.\r\n- Change java hash router to use Murmur3\r\n- Add python hash router\r\n- Add unit tests to cover the hash value computation and make sure it is consistent across java and python\r\n\r\nMaster Issue: #1690 \r\n\r\n\r\n\n\nAuthor: \n\nReviewers: Jia Zhai <None>\n\nThis closes #1698 from sijie/message_router","Date":"Tue Sep 25 19:10:37 CEST 2018"},{"Commit-ID":"commit c02e0fbd2a0618b9a4e40c995a186f003ab9070b 1537897092 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Tue Sep 25 10:38:12 2018 -0700]","Body":"[TOOLS] Add a perf tool for benchmarking bookkeeper\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nwhen investigating performance on scanning entries in bookkeeper, it is hard to know what is the expectation of what kind of throughput that application can get. we need a perf tool to understand the baseline of performance that bookkeeper can provide.\r\n\r\n### Changes\r\n\r\nthis tool is following what pulsar perf tool is doing and using dlog library for evaluating the write and read throughput on bookkeeper using one (or a few) dlog streams.\r\n\r\n\r\n\n\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Qi Wang <42832902+codingwangqi@users.noreply.github.com>\nAuthor: Charan Reddy Guttapalem <reddycharan18@gmail.com>\nAuthor: Sijie Guo <guosijie@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1697 from sijie/bkperf","Date":"Tue Sep 25 19:38:12 CEST 2018"},{"Commit-ID":"commit e4f1d848714fddb86d5ebf9832a8605074e63ec4 1537954772 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Wed Sep 26 02:39:32 2018 -0700]","Body":"[BUILD] Ignore pid files\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n\r\n*Motivation*\r\n\r\nwhen running bookkeeper servers using `bin/bookkeeper-daemon`, `pid` files\r\nwill be added in current directory.\r\n\r\n*Changes*\r\n\r\nAdd `.pid` in `.gitignore`, so those pid files will be ignored.\r\n\r\n\r\n\n\nAuthor: Sijie Guo <guosijie@gmail.com>\nAuthor: Qi Wang <42832902+codingwangqi@users.noreply.github.com>\nAuthor: Charan Reddy Guttapalem <reddycharan18@gmail.com>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1706 from sijie/ignore_pid_files","Date":"Wed Sep 26 11:39:32 CEST 2018"},{"Commit-ID":"commit d8e0a9aa6097eacd13afc2898f89627a15e59e02 1537954902 -----sp","Author":"PersonIdent[Andrey Yegorov, dlg99@users.noreply.github.com, Wed Sep 26 02:41:42 2018 -0700]","Body":"Issue #1700: fixed: TimedRunnable does not anticipate exception from wrapped runnable\n\nDescriptions of the changes in this PR:\r\n\r\nadded try/finally around runnable.run()\r\n\r\n### Motivation\r\n\r\nTo correctly track (metrics/log) runnable that throw unexpected exception.\r\n\r\n### Changes\r\n\r\nadded try/finally around runnable.run()\r\n\r\nMaster Issue: #1700 \r\n\r\n\r\n\n\nAuthor: Qi Wang <42832902+codingwangqi@users.noreply.github.com>\nAuthor: Charan Reddy Guttapalem <reddycharan18@gmail.com>\nAuthor: Sijie Guo <guosijie@gmail.com>\nAuthor: Andrey Yegorov <ayegorov@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1702 from dlg99/fix/issue_1700_timedrunnable, closes #1700","Date":"Wed Sep 26 11:41:42 CEST 2018"},{"Commit-ID":"commit 2837f6257baf15dc9dd9eb4bcac34596b442be33 1537954971 -----sp","Author":"PersonIdent[Qi Wang, 42832902+codingwangqi@users.noreply.github.com, Wed Sep 26 02:42:51 2018 -0700]","Body":"autorecovery-use-metadata-driver (part 3) : remove zookeeper from Auditor class\n\nDescriptions of the changes in this PR:\r\n\r\nThis is the 3rd change to remove zookeeper from Auditor. It also changes how\r\nwe construct metadata driver from AutoRecoveryMain. Since we are using bookkeeper client\r\nand admin across auditor and replication. So change the AutoRecoveryMain to construct\r\nthe bookkeeper client from client configuration and pass bookkeeper client down to\r\nreplication worker and auditor.\r\n\r\n\r\n\n\nAuthor: Qi Wang <codingwangqi@gmail.com>\nAuthor: Qi Wang <42832902+codingwangqi@users.noreply.github.com>\nAuthor: Sijie Guo <guosijie@gmail.com>\nAuthor: Charan Reddy Guttapalem <reddycharan18@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1695 from codingwangqi/autorecovery_metadata_part3","Date":"Wed Sep 26 11:42:51 CEST 2018"},{"Commit-ID":"commit fa2f19d076cde5514a5f24613045b14a491871d4 1537955037 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Wed Sep 26 02:43:57 2018 -0700]","Body":"[TABLE SERVICE] [LOGGING] improve logging at zk storage container manager\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nthe storage container manager probes containers to ensure containers are started and stopped to reflect to topology change.\r\nhowever the logging can be very annoying if there is no topology changed.\r\n\r\n*Changes*\r\n\r\nImprove the logic to only log the message when topology is changed.\r\n\r\n\r\n\n\nAuthor: Sijie Guo <guosijie@gmail.com>\nAuthor: Qi Wang <42832902+codingwangqi@users.noreply.github.com>\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Charan Reddy Guttapalem <reddycharan18@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1704 from sijie/reducing_logging_storage_containers","Date":"Wed Sep 26 11:43:57 CEST 2018"},{"Commit-ID":"commit a04642bb2baede4fe6c2dbfe8eb89abf120f2f28 1537955082 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Wed Sep 26 02:44:42 2018 -0700]","Body":"[TABLE SERVICE] improve the bookkeeper script to better detect whether table service is enabled or not\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n*motivation*\r\n\r\nCurrently `bin/bookkeeper` automatically choose modules based on the command.\r\nHowever it would be much better to detect which module to use by checking the bookkeeper configuration settings.\r\n\r\n*changes*\r\n\r\nImprove `bin/bookkeeper` to better detect which module to use based on bookkeeper server configuration.\r\nAdditionally adding dlog related settings in the server configuration file.\r\n\r\n\r\n\r\n\n\nAuthor: Sijie Guo <guosijie@gmail.com>\nAuthor: Qi Wang <42832902+codingwangqi@users.noreply.github.com>\nAuthor: Charan Reddy Guttapalem <reddycharan18@gmail.com>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1705 from sijie/improve_bookkeeper_scripts","Date":"Wed Sep 26 11:44:42 CEST 2018"},{"Commit-ID":"commit 79709a48dcf8b56a0f7e83e5c4fcf8aa23cab628 1537960821 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Wed Sep 26 13:20:21 2018 +0200]","Body":"Release notes for Apache BookKeeper 4.8.0\n\nUpdate the website with the releases notes for Apache BookKeeper 4.8.0\r\n\r\n\r\n\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1676 from eolivelli/fix/release-notes-480","Date":"Wed Sep 26 13:20:21 CEST 2018"},{"Commit-ID":"commit 890808a765e2869289104cc9c332eb6d2f539fb4 1537960952 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Wed Sep 26 13:22:32 2018 +0200]","Body":"Update Docker File to use 4.8.0 and signature from eolivelli@apache.org\n\nDescriptions of the changes in this PR:\r\n\r\nUpdate docker image to latest and greatest BookKeeper version\r\n\r\n\r\n\r\n\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1707 from eolivelli/fix/update-docker-480","Date":"Wed Sep 26 13:22:32 CEST 2018"},{"Commit-ID":"commit 7d7c88e46baf17c2893585c6d7d958df6e92f0c0 1537986340 -----sp","Author":"PersonIdent[Andrey Yegorov, dlg99@users.noreply.github.com, Wed Sep 26 11:25:40 2018 -0700]","Body":"Issue #1696: fixed potential ConcurrentModificationException in mock in MdcContextTest\n\nDescriptions of the changes in this PR:\r\n\r\nChanged LinkedList to ConcurrentLinkedQueue to avoid potential ConcurrentModificationException in callbacks.\r\n\r\n### Motivation\r\n\r\nTest flapped.\r\n\r\n### Changes\r\n\r\n(Describe: what changes you have made)\r\n\r\nMaster Issue: #1696 \r\n\r\n\r\n\n\nAuthor: Charan Reddy Guttapalem <reddycharan18@gmail.com>\nAuthor: Qi Wang <42832902+codingwangqi@users.noreply.github.com>\nAuthor: Sijie Guo <guosijie@gmail.com>\nAuthor: Andrey Yegorov <ayegorov@salesforce.com>\n\nReviewers: Venkateswararao Jujjuri (JV) <None>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1699 from dlg99/fix/issue_1696_MdcContextTest, closes #1696","Date":"Wed Sep 26 20:25:40 CEST 2018"},{"Commit-ID":"commit ea334eab4a95654ec6a15b7c23aaf4c8c79ba11c 1537986426 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Wed Sep 26 11:27:06 2018 -0700]","Body":"[TABLE SERVICE] introduce a client interceptor to attach routing information for table service rpc calls\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nCurrently java client deals with request routing and attach routing information before sending the request.\r\nIf we try to apply same mechanism for non-java language clients, it requires implementing this complex\r\nrouting logic for every non-java language client, which is not a desirable solution.\r\n\r\nSo we should move the request routing to the server side, which can simplify the implementation of non-java\r\nlanguage client.\r\n\r\n*Changes*\r\n\r\nIntroduce a client interceptor which intercepts table service rpc calls and mutating the rpc request with\r\ncorrect routing information. This interceptor can be used at server side for proxying grpc requests.\r\n\r\n\r\n\n\nAuthor: Qi Wang <42832902+codingwangqi@users.noreply.github.com>\nAuthor: Sijie Guo <guosijie@gmail.com>\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Charan Reddy Guttapalem <reddycharan18@gmail.com>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1708 from sijie/proxy_requests","Date":"Wed Sep 26 20:27:06 CEST 2018"},{"Commit-ID":"commit 1f0bc8cabd7fd25af142f4963310b5205b146ceb 1538038618 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Thu Sep 27 10:56:58 2018 +0200]","Body":"Upgrade Mockito to 2.22.0 in order to support build on JDK11\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\nRunning tests on JDK11 requires a new version of Mockito, because in JDK11 they dropped Unsafe.defineClass.\r\n\r\n### Changes\r\n\r\nUpgrade Mockito\r\n\r\nMaster Issue: #1710\r\n\r\n\r\n\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1711 from eolivelli/fix/upgrade-mockito","Date":"Thu Sep 27 10:56:58 CEST 2018"},{"Commit-ID":"commit 33e9d27beb857834e4dc7b5ca3b69bff9d89bb9f 1538070365 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Thu Sep 27 10:46:05 2018 -0700]","Body":"[LOGGING] PendingReadOp should log the error code when failing requests\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nCurrently when a request is failed, bookkeeper client logs the error message. However the log\r\nmessage doesn't include error code. It makes debugging hard.\r\n\r\n*Changes*\r\n\r\nImprove the log message to include error code\r\n\r\n\r\n\r\n\n\nAuthor: \n\nReviewers: Andrey Yegorov <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1709 from sijie/improve_error_logging","Date":"Thu Sep 27 19:46:05 CEST 2018"},{"Commit-ID":"commit e2e3912dac624c9e892b6775dbe267b603f1887b 1538161538 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Fri Sep 28 21:05:38 2018 +0200]","Body":"Fix release notes for 4.8.0\n\nDescriptions of the changes in this PR:\r\n\r\n- Fix a bunch of typos and indentation issues on 4.8.0 release page\r\n- Fix releases.md\r\n\r\n\r\n\r\n\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1714 from eolivelli/fix/release-notes-480-2","Date":"Fri Sep 28 21:05:38 CEST 2018"},{"Commit-ID":"commit 7f2564c49d6ad7795908886433d3afcc4155c9d9 1538269827 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Sat Sep 29 18:10:27 2018 -0700]","Body":"[TOOLS] [PERF] Add a `segread` perf command to read distributedlog streams in segment splits\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nFind what is the bottleneck/throughput limit of reading a single ledger.\r\n\r\n*Changes*\r\n\r\nProvide a `segread` perf command to split a stream into a list of segments and split segments into splits,\r\nand test reading segment splits in parallel.\r\n\r\n\r\n\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1713 from sijie/segment_readers","Date":"Sun Sep 30 03:10:27 CEST 2018"},{"Commit-ID":"commit 0c4accbce977fbc6191689bcb5792e2a3563eb78 1538279614 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Sat Sep 29 20:53:34 2018 -0700]","Body":"[TABLE SERVICE] [CLIENT] Provide a timeout mechanism on closing the client\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nClosing the storage client sometime takes long time. And closing the client typically happens at the last step. So we don't necessarily to be blocking at waiting it to complete.\r\n\r\n### Changes\r\n\r\nProvide a timeout version of sync close. And timeout the closing operation if it doesn't complete within 1 second.\r\n\r\n\r\n\n\nAuthor: \n\nReviewers: Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1717 from sijie/close_storage_client","Date":"Sun Sep 30 05:53:34 CEST 2018"},{"Commit-ID":"commit dd1c8e0794786ea2e87918df451f912d84098a67 1538332661 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Sun Sep 30 11:37:41 2018 -0700]","Body":"[INTEGRATION TESTS] Dump container logs before stopping tests\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nFor debugging purpose, it would be great to dump container logs before\r\nstopping tests.\r\n\r\n*Changes*\r\n\r\nCopying container and bookkeeper logs before stopping the tests.\r\n\r\n\r\n\r\n\n\nAuthor: Sijie Guo <guosijie@gmail.com>\nAuthor: Enrico Olivelli <eolivelli@gmail.com>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1718 from sijie/dump_container_logs","Date":"Sun Sep 30 20:37:41 CEST 2018"},{"Commit-ID":"commit 443b24a630500cd248041de4583f09dbce90c398 1538332748 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Sun Sep 30 11:39:08 2018 -0700]","Body":"[TABLE SERVICE] [COMMON] add BytesHashRouter\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nCurrently the hash router takes `ByteBuf`. At some cases,\r\nwe need to compute the hash of bytes array directly.\r\n\r\n*Changes*\r\n\r\nAdd `BytesHashRouter` to compute hash value of bytes array directly,\r\navoiding wrapping bytes into `ByteBuf`\r\n\r\n\r\n\n\nAuthor: Sijie Guo <guosijie@gmail.com>\nAuthor: Enrico Olivelli <eolivelli@gmail.com>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1719 from sijie/bytes_hash_router","Date":"Sun Sep 30 20:39:08 CEST 2018"},{"Commit-ID":"commit 580d29e47052fad058456c5028debe75701ea3a8 1538407056 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Mon Oct 1 08:17:36 2018 -0700]","Body":"[TABLE SERVICE] Intercepted storage server channel should shutdown the underlying managed channel\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nWhen a storage server channel is intercepted, the underlying channel will not be `ManagedChannel`\r\nany more. so closing storage server channel will never close the underlying managed channel.\r\n\r\n*Changes*\r\n\r\nStorageServerChannel#intercept should keep reference to the original storage server channel.\r\nso when closing the intercepted channel, it can close the original channel.\r\n\r\n\r\n\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1720 from sijie/close_intercepted_channel","Date":"Mon Oct 01 17:17:36 CEST 2018"},{"Commit-ID":"commit 3446c2cdb9c49ab5f547657a5d12e92022b56721 1538417525 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Mon Oct 1 11:12:05 2018 -0700]","Body":"[TABLE SERVICE] [STORAGE] add routing table for proxying table service requests\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nIn order to implement non-java clients and avoid the complexity in the client implementation.\r\nWe need to proxy a routing table in the server side for proxying table service requests.\r\n\r\n*Changes*\r\n\r\nAdd routing table in the service side to proxy grpc requests to the right storage containers.\r\n\r\n\r\n\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1721 from sijie/add_routing_table","Date":"Mon Oct 01 20:12:05 CEST 2018"},{"Commit-ID":"commit 7da429ea0e4f29b11da532f269196047162053ef 1538479739 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Tue Oct 2 13:28:59 2018 +0200]","Body":"Add optional compile time only annotations-api dependency dropped in JDK11\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nJava Annotations API has been dropped from JRE since JDK11. We should add it explicitly at compile time.\r\nAs we are using only the 'Generated' annotation, which has \"source\" retention when can add the dependency as 'optional'.\r\nWe are not re-distributing the JAR in binary packages.\r\n\r\n### Changes\r\n\r\nAdd 'optional' dependency wherever it is needed (all GRPC artifacts for instance)\r\n\r\nMaster Issue: #1710\r\n\r\n\r\n\n\nAuthor: Sijie Guo <guosijie@gmail.com>\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>\n\nThis closes #1725 from eolivelli/fix/jdk11-add-annotations-api","Date":"Tue Oct 02 13:28:59 CEST 2018"},{"Commit-ID":"commit 337b4c04aee608ff3fb5efb74c52d2445b6b6b81 1538494438 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Tue Oct 2 08:33:58 2018 -0700]","Body":"[TABLE SERVICE] [CLIENT] Provide a simple version of storage clients\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nThe PR #1721 provides a routing service for proxying grpc requests\r\nto the correct storage container. That means that the storage client\r\ncan be implemented using simple grpc calls since all containers can\r\nserve same grpc requests.\r\n\r\n*Changes*\r\n\r\nImplement a simple version of storage clients by using server-side\r\nrouting to route grpc requests to the correct storage containers.\r\n\r\n\r\n\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1722 from sijie/proxy_table_requests2","Date":"Tue Oct 02 17:33:58 CEST 2018"},{"Commit-ID":"commit bbddabcb0b77316558c3cd12fbaf7d6559b6974d 1538505347 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Tue Oct 2 11:35:47 2018 -0700]","Body":"[TABLE SERVICE] [CLIENT] Implement the python client to access tables\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nProviding a python client to access tables\r\n\r\nFixes #1690\r\n\r\n*Changes*\r\n\r\nImplement the python client to access tables using the table grpc requests\r\n\r\n\r\n\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1723 from sijie/python_client","Date":"Tue Oct 02 20:35:47 CEST 2018"},{"Commit-ID":"commit 0ee2c042a6c0430624fb6db8393dab5a7128a176 1538506338 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Oct 2 20:52:18 2018 +0200]","Body":"Decorate OrderedExecutor threads rather than runnables\n\nActually, decorate the runnables too, but apply the decoration in a\r\ndecorator on the thread so that if a runnable/callable is passed to\r\nthe thread, the decoration will be applied.\r\n\r\nThis allows users of OrderedExecutor/Scheduler to use\r\nexecutor.chooseThread() for CompletableFuture async handlers and still\r\nget things like the MDC context.\r\n\n\nAuthor: \n\nReviewers: Andrey Yegorov <None>, Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1729 from ivankelly/decorate-exec","Date":"Tue Oct 02 20:52:18 CEST 2018"},{"Commit-ID":"commit c5cd2aac5430382767f54fd8c3f62c86f6322ab2 1538517619 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Tue Oct 2 15:00:19 2018 -0700]","Body":"[TABLE SERVICES] [PERF] Provides a simple perf tool for testing put and inc performance\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nNeed to know what is the performance of table service.\r\n\r\n*Changes*\r\n\r\nProvide a simple perf tool following what RocksDB is doing. Currently support simple testing for put and inc operations.\r\n\r\n\r\n\r\n\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1727 from sijie/async_benchmark","Date":"Wed Oct 03 00:00:19 CEST 2018"},{"Commit-ID":"commit 4dac14b7ff3844b1d7e41515162c44f0e1ab9a1f 1538543008 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Tue Oct 2 22:03:28 2018 -0700]","Body":"Enhance Auditor\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n- store last checkAllLedgers executed time in metadataserver.\r\n- use that value for determining the initialDelay of checkAllLedgers call\r\n- add dedicated metric for bookieCheck\r\n- add more log lines in Auditor\r\n\r\n\r\n### Motivation\r\n\r\nIn Auditor checkAllLedgers is scheduled to run for every \u2018auditorPeriodicCheckInterval\u2019 and with initial delay of \u2018auditorPeriodicCheckInterval\u2019. But the problem is if Auditor role keeps transforming to another AR process, it might not get chance to do \u2018checkAllLedgers\u2019 task. Considering default value for 'auditorPeriodicCheckInterval' is 1 week, it is not uncommon situation.\r\n\r\n### Changes\r\n\r\nThats why I'm planning to persist last successful checkAllLedgers execution ctime in ZK, so that next time when a new AR becomes Auditor, it would use that as reference to decide the initial delay value.\r\n\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1683 from reddycharan/auditormetricslogs","Date":"Wed Oct 03 07:03:28 CEST 2018"},{"Commit-ID":"commit b6db915f7b787b100a4feeb5999bf288cf8737ed 1538547335 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Wed Oct 3 08:15:35 2018 +0200]","Body":"Fix Kerberos tests on JDK11:\n\n\r\nDescriptions of the changes in this PR:\r\n- move to Kerby (MiniKDC code copied from Apache ZooKeeper repository)\r\n- adapt tests to run with new KDC\r\n- force TCP on krb5.conf for tests (this is needed for Kerby, which opens only TCP by default config)\r\n\r\n\r\nMaster Issue: #1710 \r\n\r\n\r\n\n\nAuthor: Enrico Olivelli <eolivelli@apache.org>\n\nReviewers: Ivan Kelly <ivank@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1716 from eolivelli/fix/kerby-11","Date":"Wed Oct 03 08:15:35 CEST 2018"},{"Commit-ID":"commit 897c643e4248fc9fd716c3124b007aa8c540b6ff 1538555518 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Wed Oct 3 01:31:58 2018 -0700]","Body":"[TABLE SERVICE] [STORAGE] improve the logic on creating the meta range for a table\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nCurrently the creation of meta range for table is deferred until we first try to use it.\r\nThe propagation of stream properties is carried by the client.\r\n\r\n*Changes*\r\n\r\nImprove the creation logic to fetch stream properties from the root range.\r\n\r\n\r\n\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1730 from sijie/cache_stream_props","Date":"Wed Oct 03 10:31:58 CEST 2018"},{"Commit-ID":"commit 9b00ef3760a96ddce7e49e6cfdf2f7740554aaa9 1538555684 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Wed Oct 3 10:34:44 2018 +0200]","Body":"Add Oracle JDK11 to Travis CI build\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nStart testing builds on JDK11, as it is the latest available version of Java \r\n\r\n### Changes\r\n\r\nAdd Oracle JDK 11 to Travis configuration file\r\n\r\nMaster Issue: #1710\r\n\r\n\r\n\n\nAuthor: \n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1732 from eolivelli/fix/travis-jdk11","Date":"Wed Oct 03 10:34:44 CEST 2018"},{"Commit-ID":"commit cb7b0916978725e4f42814c9ba5824b5dd1b0209 1538580592 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Wed Oct 3 08:29:52 2018 -0700]","Body":"[TABLE SERVICE] [CLI] improve table service related cli commands\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nAdd missing commands for table service related operations.\r\n\r\n*Changes*\r\n\r\n- Add missing commands such as get/delete\r\n- Fill the default service uri if it is not provided\r\n- Define the command ops in `Commands` util class\r\n\r\n\r\n\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <None>\n\nThis closes #1724 from sijie/improve_console","Date":"Wed Oct 03 17:29:52 CEST 2018"},{"Commit-ID":"commit 97c6656a9600d20763202ee6a7946383da1bd712 1538580642 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Wed Oct 3 08:30:42 2018 -0700]","Body":"[TABLE SERVICE] [STATS] enable stats for grpc calls on both client and server\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nWe need visibility on both client and server on table service.\r\n\r\n*Changes*\r\n\r\n- introduce grpc monitoring interceptors for both client and server\r\n- enable monitoring interceptors on both client and server\r\n\r\n\r\n\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1731 from sijie/grpc_stats","Date":"Wed Oct 03 17:30:42 CEST 2018"},{"Commit-ID":"commit 3c3416669d750b70d4f9c0e3ac1c704b77b45023 1538644607 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Thu Oct 4 02:16:47 2018 -0700]","Body":"Introduce lifecycle components for managing components in AutoRecovery\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n\r\n- lifecycle components for managing components in AutoRecovery\r\n- expose metrics of AR in the same http admin endpoint\r\n\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1726 from reddycharan/stackar","Date":"Thu Oct 04 11:16:47 CEST 2018"},{"Commit-ID":"commit ece38f5994fd30d1f132e6f45ae15a406cc926bf 1538644858 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Thu Oct 4 02:20:58 2018 -0700]","Body":"[TABLE SERVICE] [CLIENT] provide scripts for uploading python clients to pypi\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nmake the python client available for usage\r\n\r\n*Changes*\r\n\r\n- update README and setup.py\r\n- set the client version to `4.9.0-alpha-0`\r\n- scripts to build python client and upload it to pypi\r\n\r\n*Result*\r\n\r\nhttps://pypi.org/project/apache-bookkeeper-client/4.9.0a0/\r\n\r\n\r\n\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1734 from sijie/upload_python_client","Date":"Thu Oct 04 11:20:58 CEST 2018"},{"Commit-ID":"commit 117ba4d7e2965f520d98a96a6ada7af54d9947ce 1538778688 -----sp","Author":"PersonIdent[Andrey Yegorov, dlg99@users.noreply.github.com, Fri Oct 5 15:31:28 2018 -0700]","Body":"Issue #1740: IOUtils.close() only accepts Closeable as a vararg which results in unnecessary Object[] created if only one Closeable passed there\n\nDescriptions of the changes in this PR:\r\n\r\nadded close() variant that takes one Closeable.\r\n\r\n### Motivation\r\n\r\n100% of close() usage is with one Closeable.\r\n\r\n### Changes\r\n\r\nlight refactoring.\r\n\r\nMaster Issue: #1740 \r\n\r\n\r\n\n\nAuthor: Andrey Yegorov <ayegorov@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1741 from dlg99/nit/ioutils, closes #1740","Date":"Sat Oct 06 00:31:28 CEST 2018"},{"Commit-ID":"commit 125fdb9761ffaaf5551d5e192d82b23fe555165f 1538778872 -----sp","Author":"PersonIdent[Andrey Yegorov, dlg99@users.noreply.github.com, Fri Oct 5 15:34:32 2018 -0700]","Body":"Issue #1738: Journal: add a metric for the time ForceWriteRequest spent in the queue\n\n### Motivation\r\n\r\nInvestigated latency spike in one of the bookie clusters.\r\nAt some point the question at hands was \"how much time ForceWriteRequests spend in the queue in this case\".\r\nThere is no metric to answer this question.\r\n\r\n### Changes\r\n\r\nAdded new metric.\r\n\r\nMaster Issue: #1738 \r\n\r\n\r\n\n\nAuthor: Andrey Yegorov <ayegorov@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1739 from dlg99/fix/forcewrite-metric, closes #1738","Date":"Sat Oct 06 00:34:32 CEST 2018"},{"Commit-ID":"commit ba6d3ee3d0005c809d926f952b1c1b4d33215dd5 1538778960 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Fri Oct 5 15:36:00 2018 -0700]","Body":"ISSUE #1703: IllegalReferenceCountException at closing EntryLogManagerForSingleEntryLog\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nFixes #1703.\r\n\r\nThe active entry log channel in EntryLogManagerForSingleEntryLog is closed twice during shutdown.\r\nOne is by EntryLogManagerForSingleEntryLog#close and the other one is EntryLogManagerForSingleEntryLog#forceClose().\r\n\r\n*Changes*\r\n\r\nThis change is adding logic in BufferedChannel to make sure BufferedChannel can be closed multiple times.\r\n\r\n\r\n\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Charan Reddy Guttapalem <reddycharan18@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>, Andrey Yegorov <None>\n\nThis closes #1735 from sijie/issue_1703, closes #1703","Date":"Sat Oct 06 00:36:00 CEST 2018"},{"Commit-ID":"commit c5c5795fc737bbfa52f130d83a2fa2ede9bd581a 1538779133 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Fri Oct 5 15:38:53 2018 -0700]","Body":"[TABLE SERVICE] [TESTS] add integration tests for python clients\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nWe need have test coverage for python clients.\r\n\r\n*Changes*\r\n\r\n- add scripts to run python client tests for different python versions\r\n- make sure the client can be built on both python2 and python3\r\n- add a postcommit job to run python tests\r\n\r\n\r\n\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1742 from sijie/python_integration_tests","Date":"Sat Oct 06 00:38:53 CEST 2018"},{"Commit-ID":"commit df6595804cb1d78f5b531ae2db3a7c751439eb1c 1539020125 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Mon Oct 8 10:35:25 2018 -0700]","Body":"ISSUE #1737: EntryMemTable.newEntry: always make a copy\n\nRetaining a reference to that array assumes that the caller\r\nwon't reuse the array for something else -- an assumption\r\nviolated by Journal.scanJournal and probably other callers.\r\n\r\n(bug W-5499346)\r\n(rev cguttapalem)\r\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nAuthor: \n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1744 from athanatos/forupstream/wip-1737, closes #1737","Date":"Mon Oct 08 19:35:25 CEST 2018"},{"Commit-ID":"commit 5fe5a6277ccb2dd63b7ac84c03c6c3042a9c2c1c 1539046470 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Mon Oct 8 17:54:30 2018 -0700]","Body":"ReadEntryCallback in ReadLedgerEntriesCmd shouldn't release buffer.\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n- ReadEntryCallback in ReadLedgerEntriesCmd shouldn't release buffer,\r\nwhich is not owned by the callback.\r\n\r\n### Motivation\r\n\r\nwith the following change, Per channel bookie clients owns the buffer for read responses. So it is not correct for ReadEntryCallback in ReadLedgerEntriesCmd to release buffer\r\nhttps://github.com/apache/bookkeeper/commit/8d048abce486c63d428041f77ee9a506756f4d1e#diff-e50ee2c1aec1539ea185a94605b0e550R1611\r\n\r\nbecause of this issue I'm seeing following error with ReadLedgerEntriesCmd\r\n```\r\n/Workspace/SFStorage/bookkeeper/bookkeeper-server/bin$ ./bookkeeper shell -localbookie readledger -bookie ****  -ledgerid 00000000-0000-0000-0000-000000000003 -firstentryid 1 -lastentryid 3\r\nJAVA_HOME not set, using java from PATH. (/usr/bin/java)\r\n\r\n--------- Lid=00000000-0000-0000-0000-000000000003, Eid=1 ---------\r\n18:32:03,724 ERROR Unexpected throwable caught \r\nio.netty.util.IllegalReferenceCountException: refCnt: 0, increment: 1\r\n\tat io.netty.buffer.AbstractReferenceCountedByteBuf.release0(AbstractReferenceCountedByteBuf.java:100) ~[netty-all-4.1.22.Final.jar:4.1.22.Final]\r\n\tat io.netty.buffer.AbstractReferenceCountedByteBuf.release(AbstractReferenceCountedByteBuf.java:84) ~[netty-all-4.1.22.Final.jar:4.1.22.Final]\r\n\tat org.apache.bookkeeper.proto.PerChannelBookieClient$ReadCompletion.handleV3Response(PerChannelBookieClient.java:1699) ~[bookkeeper-server-4.7.0-SNAPSHOT.jar:4.7.0-SNAPSHOT]\r\n\tat org.apache.bookkeeper.proto.PerChannelBookieClient$3.safeRun(PerChannelBookieClient.java:1286) ~[bookkeeper-server-4.7.0-SNAPSHOT.jar:4.7.0-SNAPSHOT]\r\n\tat org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [bookkeeper-common-4.7.0-SNAPSHOT.jar:4.7.0-SNAPSHOT]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_172]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_172]\r\n\tat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-all-4.1.22.Final.jar:4.1.22.Final]\r\n\tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_172]\r\n\r\n--------- Lid=00000000-0000-0000-0000-000000000003, Eid=2 ---------\r\n\r\n18:32:03,733 ERROR Unexpected throwable caught \r\nio.netty.util.IllegalReferenceCountException: refCnt: 0, increment: 1\r\n\tat io.netty.buffer.AbstractReferenceCountedByteBuf.release0(AbstractReferenceCountedByteBuf.java:100) ~[netty-all-4.1.22.Final.jar:4.1.22.Final]\r\n\tat io.netty.buffer.AbstractReferenceCountedByteBuf.release(AbstractReferenceCountedByteBuf.java:84) ~[netty-all-4.1.22.Final.jar:4.1.22.Final]\r\n\tat org.apache.bookkeeper.proto.PerChannelBookieClient$ReadCompletion.handleV3Response(PerChannelBookieClient.java:1699) ~[bookkeeper-server-4.7.0-SNAPSHOT.jar:4.7.0-SNAPSHOT]\r\n\tat org.apache.bookkeeper.proto.PerChannelBookieClient$3.safeRun(PerChannelBookieClient.java:1286) ~[bookkeeper-server-4.7.0-SNAPSHOT.jar:4.7.0-SNAPSHOT]\r\n\tat org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [bookkeeper-common-4.7.0-SNAPSHOT.jar:4.7.0-SNAPSHOT]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_172]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_172]\r\n\tat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-all-4.1.22.Final.jar:4.1.22.Final]\r\n\tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_172]\r\n```\n\nAuthor: cguttapalem <cguttapalem@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Andrey Yegorov <None>\n\nThis closes #1736 from reddycharan/readledgerfix","Date":"Tue Oct 09 02:54:30 CEST 2018"},{"Commit-ID":"commit 26c77d24f848a42c8e339820dbea869233f9475e 1539046955 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Mon Oct 8 18:02:35 2018 -0700]","Body":"[TABLE SERVICE] [CLIENT] storage client can open tables on a different namespace\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n*Motivation*\r\n\r\nIn some cases, we are using same storage client for opening tables under different namespaces.\r\nIt would be good that a client instance can do that.\r\n\r\n*Changes*\r\n\r\n- Add methods to `StorageClient` to open tables under different namespaces\r\n- Add `asClient` to `StorageAdminClient` to convert admin client to storage client\r\n\r\n\r\n\r\n\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1733 from sijie/improve_client_interface","Date":"Tue Oct 09 03:02:35 CEST 2018"},{"Commit-ID":"commit 345ee95ff5c1431c382ecd4ba8cae3bfed457d6d 1539773801 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Wed Oct 17 03:56:41 2018 -0700]","Body":"Set ConnectionExpired Listener to MetadataClientDriver in AR\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n- add setConnectionExpiredListener method to MetadataClientDriver interface.\r\n- add listener to shutdown AR in the case of metadata connection expiry\r\n\r\n\r\n### Motivation\r\n\r\nThis commit - 4f0d2a195bd9be3788876b47813cee1440cf005c, has removed the shutdown logic in AutoRecoveryMain incase of ZK client session expiry, with the following reason \"which doesn't make any sense for current retryable zookeeper\". But if the ZK session has expired then it is not completely correct to let AutoRecoveryMain to continue to run in that state.\n\nAuthor: Sijie Guo <guosijie@gmail.com>\nAuthor: Andrey Yegorov <dlg99@users.noreply.github.com>\nAuthor: cguttapalem <cguttapalem@salesforce.com>\nAuthor: Charan Reddy Guttapalem <reddycharan18@gmail.com>\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1747 from reddycharan/conexpirylisten","Date":"Wed Oct 17 12:56:41 CEST 2018"},{"Commit-ID":"commit 7016d0af6850ae565cc674a6d286782bbb5ba33a 1539909210 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Fri Oct 19 08:33:30 2018 +0800]","Body":"[BUILD] Fix build & bash script error when not using `stream` profile\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nThere are two issues in current master when building without stream\r\n\r\n- build `bkperf` failed\r\n- bin/bookkeeper is using the wrong module\r\n\r\n*Changes*\r\n\r\n- build `bkperf` module as part of `stream` profile\r\n- fix the problem in `bin/bookkeeper` locating the right module\r\n- add two tests in travis to test builds without `stream` profile\r\n\r\n\r\n\r\n\r\n\r\n\n\nAuthor: Sijie Guo <guosijie@gmail.com>\nAuthor: Sijie Guo <sijie@apache.org>\nAuthor: Charan Reddy Guttapalem <reddycharan18@gmail.com>\nAuthor: Andrey Yegorov <dlg99@users.noreply.github.com>\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Charan Reddy Guttapalem <reddycharan18@gmail.com>\n\nThis closes #1749 from sijie/fix_build_without_stream_profile","Date":"Fri Oct 19 02:33:30 CEST 2018"},{"Commit-ID":"commit 379d2ba8570eed1f92f8a468158f1a2d0861aaa6 1540469218 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Oct 25 05:06:58 2018 -0700]","Body":"Netty allocator wrapper\n\n### Motivation\r\n\r\nConfiguring the correct JVM memory settings and cache sizes for a BookKeeper cluster should be simplified.\r\n\r\nThere are currently many knobs in Netty or JVM flags for different components and while with a good setup the systems is very stable, it's easy to setup non-optimal configurations which might result in OutOfMemory errors under load.\r\n\r\nIdeally, there should be very minimal configuration required to bring up a BookKeeper cluster that can work under a wide set of traffic loads. In any case, we should prefer to automatically fallback to slower alternatives, when possible, instead of throwing OOM exceptions.\r\n\r\n * Provide a wrapper to have a single unified configuration point for Netty allocator configuration.\r\n * Provide fallback policy when dealing with direct memory OOM errors\r\n\r\n### Changes\r\n\r\n * This is the first PR. It only contains the allocator wrapper implementation. Subsequent PR will add the changes to use it.\r\n * Added `bookkeeper-common-allocator` module to have a no-dependencues module that can be used directly from Pulsar client library too (which doesn't depend on BK).\r\n\n\nAuthor: Sijie Guo <guosijie@gmail.com>\nAuthor: Charan Reddy Guttapalem <reddycharan18@gmail.com>\nAuthor: Matteo Merli <mmerli@apache.org>\nAuthor: Andrey Yegorov <dlg99@users.noreply.github.com>\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Qi Wang <None>, Sijie Guo <sijie@apache.org>, Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1754 from merlimat/allocator","Date":"Thu Oct 25 14:06:58 CEST 2018"},{"Commit-ID":"commit afb62329a85ef8c28c013a9f8a195dc22cbd3ad9 1540469547 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Thu Oct 25 05:12:27 2018 -0700]","Body":"Adding multi-node ZKCluster test util class\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n- adding multi-node ZKCluster util class\r\n- adding new interface for ZKCluster util and having separate implementaions for\r\nsingle node ZKCluster and multi-node ZKCluster\r\n\r\n### Motivation\r\n\r\nThis helps in adding more test coverage to Zookeeper aspects.\n\nAuthor: Sijie Guo <guosijie@gmail.com>\nAuthor: Charan Reddy Guttapalem <reddycharan18@gmail.com>\nAuthor: cguttapalem <cguttapalem@salesforce.com>\nAuthor: Andrey Yegorov <dlg99@users.noreply.github.com>\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1753 from reddycharan/multinodezkcluster","Date":"Thu Oct 25 14:12:27 CEST 2018"},{"Commit-ID":"commit 2f73da607714b622ef5aafbf073d46b55dea89a4 1540469718 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Oct 25 05:15:18 2018 -0700]","Body":"Modules dependencies do not need to be included in checksum Jar\n\nThe current assembly configuration is including the jars of the modules dependency inside its own jar.\r\n\r\nThese jars are completely ignored, but they take up non trivial space.\r\n\r\nWith this change the size of `circe-checksum.jar` goes from 2.8 MB to 62 KB.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1751 from merlimat/master","Date":"Thu Oct 25 14:15:18 CEST 2018"},{"Commit-ID":"commit 6bf69714ed2e336499bec7d3513773bf8a4f2a02 1540470537 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Oct 25 14:28:57 2018 +0200]","Body":"Use immutable metadata in LedgerHandle\n\nWhich means that for the two LedgerHandle operations that mutate the\r\nmetadata, ensemble change and closing, ensure that metadata is written\r\nto the metadata store before the client ever uses it.\r\n\r\nMaster issue: #281\n\nAuthor: Ivan Kelly <ivank@apache.org>\nAuthor: Sijie Guo <guosijie@gmail.com>\nAuthor: Charan Reddy Guttapalem <reddycharan18@gmail.com>\nAuthor: Andrey Yegorov <dlg99@users.noreply.github.com>\nAuthor: Samuel Just <sjust@salesforce.com>\n\nReviewers: Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>, Samuel Just <sjust@salesforce.com>\n\nThis closes #1646 from ivankelly/immutable-handle-failures","Date":"Thu Oct 25 14:28:57 CEST 2018"},{"Commit-ID":"commit f52d5dd11bb1e6059fbc841e41b242a828a8b768 1540731293 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Sun Oct 28 13:54:53 2018 +0100]","Body":"Remove LedgerMetadata#getEnsembles in favour of #getAllEnsembles\n\nThey do the same thing except that #getEnsembles returns a TreeMap\r\nwhile #getAllEnsembles returns a NavigableMap.\r\n\r\nLedgerMetadata#getAllEnsembles is part of the api interface.\r\n\r\nMaster issue: #281\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1759 from ivankelly/remove-get-ensembles","Date":"Sun Oct 28 13:54:53 CET 2018"},{"Commit-ID":"commit 3d8bad44a40ce5cb173df5dfd7cb06d81bed26e1 1540731407 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sun Oct 28 05:56:47 2018 -0700]","Body":"Don't cache Bookie hostname DNS resolution forever\n\n### Motivation\r\n\r\n`BookieSocketAddress` is resolving the bookie DNS name in its constructor and then using the already resolved `InetSocketAddress` instance.\r\n\r\nIf the IP of a bookie changes, the BK client will continue to use the old IP address.\r\n\r\n### Changes\r\n\r\nConstruct a new `InetSocketAddress` each time `getSocketAddress()` gets called (eg: each time we attempt to make a new connection) so that we're making sure to get the right IP.\r\n\r\nI cannot think of a good way to add unit test for this at this point, suggestions are welcome. \r\n\r\nI think this should be included in a patch release as well 4.7.3 or 4.8.1\n\nReviewers: Andrey Yegorov <None>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>, Ivan Kelly <ivank@apache.org>\n\nThis closes #1762 from merlimat/fix-dns","Date":"Sun Oct 28 13:56:47 CET 2018"},{"Commit-ID":"commit 86fd29525266dbdb8fcb7950321d99c1b565bebf 1540731928 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Sun Oct 28 21:05:28 2018 +0800]","Body":"[MERGE SCRIPT] remove authors section\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nWe are using github api to merge pull requests now.\r\nSo the authors section is not correct, remove that section and rely on github merge api.\r\n\r\n*Changes*\r\n\r\nremove authors section in the commit log.\r\n\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1758 from sijie/fix_merge_scripts","Date":"Sun Oct 28 14:05:28 CET 2018"},{"Commit-ID":"commit fcd63f9a78a59aa48c693b4491fc5241ed350ff6 1540731978 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Sun Oct 28 14:06:18 2018 +0100]","Body":"Kill LedgerMetadata#isConflictWith\n\nIt doesn't make sense anymore, as local copies of the metadata are\r\nnever modified, only updated with the latest version from the metadata\r\nstore.\r\n\r\nIn effect, this logic has been broken out to the places where we try\r\nto update the metadata store copy. Each time we try to update the\r\nmetadata store, we ensure that the update we are applying still makes\r\nsense with regard to the copy of the metadata we are updating.\r\n\r\nMaster issue: #281\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1760 from ivankelly/kill-is-conflict-with","Date":"Sun Oct 28 14:06:18 CET 2018"},{"Commit-ID":"commit d9444ba143c9cdba4af427afdd9f0b696c1d7683 1540733423 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sun Oct 28 06:30:23 2018 -0700]","Body":"[WEBSITE] Fix broken link to ledger-api#example-application\n\nLink should be to a section in same page\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1764 from merlimat/fix-docs-link","Date":"Sun Oct 28 14:30:23 CET 2018"},{"Commit-ID":"commit 6c2d58ef059ad64d36c71b205061c2d6aefaab35 1540864399 -----sp","Author":"PersonIdent[Qi Wang, 42832902+codingwangqi@users.noreply.github.com, Tue Oct 30 09:53:19 2018 +0800]","Body":"Issue #1752: Etcd docker based tests are running on wrong jobs on CI\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nFixes #1752 \r\n\r\nEtcd metadata driver is using testcontainer to run Etcd in containers for integration tests.\r\nHowever this job is running as part normal build, which can cause container image being deleted\r\ndue to concurrent builds.\r\n\r\n*Changes*\r\n\r\nMove etcd metadata driver tests to be as part of `integrationTests`\r\n\r\nMaster Issue: #1752 \r\n\r\n\r\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1766 from codingwangqi/move_etcd_to_integration_tests, closes #1752","Date":"Tue Oct 30 02:53:19 CET 2018"},{"Commit-ID":"commit 41e4bccb9694e1f373e919f6891b8e88b2232c5e 1540924010 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Tue Oct 30 11:26:50 2018 -0700]","Body":"ISSUE #1757: prevent race between flush and delete from recreating index\n\nIndexPersistencManager.flushLedgerHandle can race with delete by\r\nobtaining a FileInfo just prior to delete and then proceeding to rewrite\r\nthe file info resurrecting it.  FileInfo provides a convenient point of\r\nsynchronization for avoinding this race.  FileInfo.moveLedgerIndexFile,\r\nFileInfo.flushHeader, and FileInfo.delete() are synchronized already, so\r\nthis patch simply adds a deleted flag to the FileInfo object to indicate\r\nthat the FileInfo has become invalid.  checkOpen is called in every\r\nmethod and will now throw FileInfoDeleted if delete has been called.\r\nIndexPersistenceManager can catch it and deal with it appropriately in\r\nflush (which generally means moving onto the next ledger).\r\n\r\nThis patch also eliminates ledgersToFlush and ledgersFlushing.  Their\r\npurpose appears to be to allow delete to avoid flushing a ledger which\r\nhas been selected for flushing but not flushed yet avoiding the above\r\nrace.  It's not sufficient, however, because IndexInMemPageMgr calls\r\nIndexPersistenceManager.flushLedgerHeader, which can obtain a FileInfo\r\nfor the ledger prior to the deletion and then call\r\nrelocateIndexFileAndFlushHeader afterwards.\r\n\r\nAlso, if the purpose was to avoid concurrent calls into\r\nflushSpecificLedger on the same ledger, it's wrong because of the\r\nfollowing sequence:\r\n\r\nt0: thread 0 calls flushOneOrMoreLedgers\r\nt1: thread 0 place ledger 10 into ledgersFlushing and completes\r\nflushSpecificLedger\r\nt2: thread 2 performs a write to ledger 10\r\nt3: thread 1 calls flushOneOrMoreLedgers skipping ledger 10\r\nt4: thread 0 releases ledger 10 from ledgersFlushing\r\nt5: thread 1 completes flushOneOrMoreLedgers\r\n\r\nAlthough thread 1 begins to flush after the write to ledger 10, it won't\r\ncapture the write rendering the flush incorrect.  I don't think it's\r\nactually worth avoiding overlapping flushes here because both FileInfo\r\nand LedgerEntryPage track dirty state.  As such, it seems simpler to\r\njust get rid of them.\r\n\r\nThis patch also adds a more agressive version of testFlushDeleteRace to\r\ntest the new behavior.  Testing with multiple flushers turned up a bug\r\nwith LedgerEntryPage.getPageToWrite where didn't return a buffer with\r\nindependent read pointers, so this patch addresses that as well.\r\n\r\n(bug W-5549455)\r\n(rev cguttapalem)\r\nSigned-off-by: Samuel Just <sjustsalesforce.com>\r\n(cherry picked from commit 7b5ac3d5e76ac4df618764cafe80aef2994703ec)\r\n\n\nAuthor: \n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1769 from athanatos/forupstream/wip-1757, closes #1757","Date":"Tue Oct 30 19:26:50 CET 2018"},{"Commit-ID":"commit 676dc825efefe7222d8da11d9a7bcf15247f18eb 1540925191 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Tue Oct 30 11:46:31 2018 -0700]","Body":"[TESTS] Fix integration test TestCompatUpgradeYahooCustom.testUpgradeYahooCustom\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\napache/bookkeeper#1749 fixes bash script issue but it introduced `set -e` which\r\nwill fail `bin/bookkeeper` if grepping configuration file failed.\r\n\r\n*Changes*\r\n\r\n`set -e` is useful to fail fast if anything fails in the bash script. This change\r\nis to mask exit code of `grep` operation, since the bash script already handle\r\nthe grep result.\r\n\r\n*Tests*\r\n\r\nManually verified the change works. And the existing TestCompatUpgradeYahooCustom.testUpgradeYahooCustom\r\nintegration tests would also verify if the change fixes the problem or not.\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Ivan Kelly <ivank@apache.org>\n\nThis closes #1772 from sijie/fix_common_scripts","Date":"Tue Oct 30 19:46:31 CET 2018"},{"Commit-ID":"commit f3b8c6a78f149e442e40a1e3d1d0583ebe306e36 1540925274 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Tue Oct 30 11:47:54 2018 -0700]","Body":"[TABLE SERVICE] Fix python client can't read keys written by java clients\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nPython client is a thin table service client. So it relies on storage container\r\nintercepting the requests to attach routing header. It attaches the routing header\r\nif the requests are needed to route to remote containers; however for the local containers\r\nit doesn't attach the right routing header.\r\n\r\n*Changes*\r\n\r\nFix `StorageContainerImpl` to use proxy routing interceptor to intercept requests to attach routing header.\r\n\r\n*Tests*\r\n\r\nAdd integration tests in python client & add test for python clients reading key/value pairs written by java clients.\r\n\r\n\r\n\n\nReviewers: Jia Zhai <None>\n\nThis closes #1771 from sijie/remove_python23_incompatible_changes","Date":"Tue Oct 30 19:47:54 CET 2018"},{"Commit-ID":"commit b17b1657e938aa41d747fd49537559c4f29860de 1540973937 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Oct 31 01:18:57 2018 -0700]","Body":"Reduce stack traces in logs for common cases\n\n### Motivation\r\n\r\nFor common \"error\" conditions the exception message is the only important bit while the stack traces are just adding clutter the logs files. \r\n\r\n\n\nReviewers: Andrey Yegorov <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #1776 from merlimat/master","Date":"Wed Oct 31 09:18:57 CET 2018"},{"Commit-ID":"commit 49924130d083015b788c43f057d66c993d343c82 1541177978 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Fri Nov 2 09:59:38 2018 -0700]","Body":"[TESTS] Issue #1752: disable etcd tests in normal builds\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\napache/bookkeeper#1766 attempts to disable etcd tests in normal builds.\r\nhowever it only added the `integrationTests` profile but didn't disable tests\r\nin normal builds.\r\n\r\n*Changes*\r\n\r\nDisable etcd tests in normal builds\r\n\r\nMaster Issue: #1752 \r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1779 from sijie/run_etcd_tests_on_integrationtests, closes #1752","Date":"Fri Nov 02 17:59:38 CET 2018"},{"Commit-ID":"commit d13bffc0a2853b8d2876c3314f6732eaf576534a 1541194869 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Fri Nov 2 14:41:09 2018 -0700]","Body":"[TABLE SERVICE] add default port to service hosts\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nCurrently we have to add `4181` in the service uri in order to make it work.\r\nIdeally it would be great that the system can fill the default port if port is missing.\r\n\r\n*Changes*\r\n\r\nadd default port when parsing `ServiceURI`\r\n\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1778 from sijie/add_default_port","Date":"Fri Nov 02 22:41:09 CET 2018"},{"Commit-ID":"commit 911a08f7a3bcb82688f9d1a5b6ef7b86a615a2f9 1541206057 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Fri Nov 2 17:47:37 2018 -0700]","Body":"[TABLE SERVICE] [PYTHON] add default port to service hosts\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nSimilar as #1778, add default port to service hosts if port is missing.\r\n\r\n*Changes*\r\n\r\nadd default port to service hosts if they miss ports\r\n\r\nRelated Issue: #1778\r\n\r\n\r\n\n\nReviewers: Jia Zhai <None>\n\nThis closes #1780 from sijie/fix_python_service_uri","Date":"Sat Nov 03 01:47:37 CET 2018"},{"Commit-ID":"commit 40b0bd101dccd3cd9aefc8c3e915b34071ae1229 1541266879 -----sp","Author":"PersonIdent[Manjiri Tapaswi, mptapasw@ncsu.edu, Sat Nov 3 10:41:19 2018 -0700]","Body":"ISSUE #1767: security vulnerabilities in 3rd party dependencies\n\nDescriptions of the changes in this PR:\r\n\r\nUpgraded jline and jackson to remove security vulnerabilities mentioned in #1767 \r\n\r\n### Motivation\r\n\r\nRemove security vulnerabilities mentioned in #1767 \r\n\r\n### Changes\r\n\r\nUpgraded jline and jackson 3rd party dependencies\r\n\r\nMaster Issue: #1767 \r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1777 from mptap/fix-1767-remove-vulnerabilities, closes #1767","Date":"Sat Nov 03 18:41:19 CET 2018"},{"Commit-ID":"commit 108747149e9ebc2380b0f92905edbe93034c075a 1541266969 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sat Nov 3 10:42:49 2018 -0700]","Body":"Use default metric registry in Prometheus exporter\n\n### Motivation\r\n\r\nCurrently the Prometheus exporter is using a private metrics register. This doesn't work well for BK client where we want to expose in the same registry of application, or when we want to interact with other tools that use the default static registry (eg: log4j, jetty integrations for prometheus).\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1765 from merlimat/prometheus","Date":"Sat Nov 03 18:42:49 CET 2018"},{"Commit-ID":"commit da3bd81ef8849589d63d6051c4f1dc86981c7436 1541535743 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Nov 6 12:22:23 2018 -0800]","Body":"Upgrade to Netty 4.1.31 and use individual dependencies\n\n### Motivation\r\n\r\n * Upgrade to latest Netty version which brings in perf improvements and some new features (eg: https://github.com/netty/netty/pull/8267) \r\n\r\n * Broke down the dependencies from `netty-all` into individual components, as discussed at https://github.com/apache/bookkeeper/pull/1755#discussion_r228449352\r\n\r\n\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1784 from merlimat/netty-4.1.31","Date":"Tue Nov 06 21:22:23 CET 2018"},{"Commit-ID":"commit 102475a954eb0c00c1cc2ccf022db4b7c0bb9eea 1541695772 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Thu Nov 8 08:49:32 2018 -0800]","Body":"Cache InetSocketAddress if hostname is IPAddress\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n- in BookieSocketAddress if IPAddress is hostname then it is okay\r\nto cache InetSocketAddress, since the canonicalhostname of the node\r\ndont change.\r\n\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>, Andrey Yegorov <None>\n\nThis closes #1789 from reddycharan/bookieaddressonlywhenhostname","Date":"Thu Nov 08 17:49:32 CET 2018"},{"Commit-ID":"commit 6b99ff73278d4e655509f61ea44284e54716f5a8 1541695870 -----sp","Author":"PersonIdent[Nicolas Michael, git@nmichael.de, Thu Nov 8 08:51:10 2018 -0800]","Body":"Issue #1791: Read Submission should bypass OSE Threads\n\n### Motivation\r\n\r\nProfiling of our Bookkeeper Client code for read requests shows that client threads spend half of their time in dispatching requests to OrderedExecutors (just the dispatch itself, not the execution inside OSE): 54% of their CPU time is spent in OrderedExecutor.executeOrdered() (called by LedgerHandle.readEntriesInternalAsync()). The high time spend in request submission to OSE is largely caused by Linux scheduling cost, that is the cost of dispatching the OSE thread to CPU: 42% of total time (3/4th of executeOrdered() time), threads spend in Unsafe.unpark(), which is essentially Linux scheduling/dispatching of another thread.\r\n\r\n### Changes\r\n\r\nThis change executes read submissions (PendingReadOp) on read-only ledger handles directly inside the client thread instead of submitting them to Ordered Executors.\r\n\r\nTests with a prototype have shown significant improvements in both overall CPU consumption as well as read latency. The additional work client threads have to do (the dispatch of the read requests to netty) is roughly the same as the (saved) dispatch cost to OSE, so the change turns out to be neutral for CPU consumption of client threads. In some experiments, the savings even exceed the additional work, and client threads consume less cpu even though they \"do more\". It also frees up lots of resources in OSE threads. Since it eliminates one context-switch in read submission and also avoids serialization of reads to the same ledger (or ledgers hashing to the same OSE), it also reduces read latency. For a mixed read-write workload (14,000 reads/sec on read-only ledgers, 4,000 writes/sec on another set of ledgers), this change has reduced CPU consumption of OSE threads by 25%, kept CPU consumption of client (and Netty) threads the same, and yielded a 6% improvement of read latency (as measured by BK Client).\r\n\r\nMaster Issue: #1791: Read Submission should bypass OSE Threads\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Andrey Yegorov <None>, Sijie Guo <sijie@apache.org>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1792 from nicmichael/DirectRead, closes #1791","Date":"Thu Nov 08 17:51:10 CET 2018"},{"Commit-ID":"commit e31e844505c59a9c119c6896a7f789db8f432dc2 1541742432 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Thu Nov 8 21:47:12 2018 -0800]","Body":"[TOOLS] add cookie related commands\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nIn some use cases, you need cookie related tools to create/delete/update/get cookie when handling production issues.\r\nCurrently bookkeeper doesn't provide such commands.\r\n\r\n*Changes*\r\n\r\nAdd cookie related commands\r\n\r\n- create\r\n- delete\r\n- get\r\n- update\r\n- generate\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1794 from sijie/add_cookie_commands","Date":"Fri Nov 09 06:47:12 CET 2018"},{"Commit-ID":"commit 843c0cc2fe73fc59d743e41dde81178608a29b8e 1541809957 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Fri Nov 9 16:32:37 2018 -0800]","Body":"[TOOLS] improve bkctl help message\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nCurrently `bin/bktcl help` will output all command groups all together.\r\nIt is a bit hard to tell what command groups to use, especially some\r\ncommands are used for table service.\r\n\r\n*Changes*\r\n\r\nIntroduce `category` in the cli spec to define which category that a\r\ncommand group belongs to. So when it prints out the help message, it\r\ncan use that information to categorize the command groups together\r\nto provide better user experience.\r\n\r\n*Results*\r\n\r\n```\r\n$ bin/bkctl help\r\nbkctl interacts and operates Apache BookKeeper clusters\r\n\r\nUsage:  bkctl [flags] [command group] [commands]\r\n\r\nInfrastructure commands :\r\n\r\n    bookie          Commands on operating a single bookie\r\n    bookies         Commands on operating a cluster of bookies\r\n    cluster         Commands on administrating bookkeeper clusters\r\n\r\nLedger service commands :\r\n\r\n    ledger          Commands on interacting with ledgers\r\n\r\nTable service commands :\r\n\r\n    namespace       Commands on operating namespaces\r\n    table           Commands on interacting with tables\r\n    tables          Commands on operating tables\r\n\r\nOther commands :\r\n\r\n    help            Display help information about it\r\n```\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1793 from sijie/add_groups","Date":"Sat Nov 10 01:32:37 CET 2018"},{"Commit-ID":"commit 86dda9a3872028d7d06fe43a148d0e7547e9b26f 1541842497 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Sat Nov 10 01:34:57 2018 -0800]","Body":"[BUILD] Ignore `versionsBackup` file generated by `mvn versions:set`\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\n`mvn versions:set` will generate files suffixed with `.versionsBackup`\r\n\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1801 from sijie/exclude_versionsbackup","Date":"Sat Nov 10 10:34:57 CET 2018"},{"Commit-ID":"commit dc2aaaa070d9a8d393409b69c80ad668b70f6d2b 1541961752 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sun Nov 11 10:42:32 2018 -0800]","Body":"Fixed Auth with v2 protocol\n\n### Motivation\r\n\r\nBK auth framework is currently broken when using v2 protocol.\r\n\r\n### Changes\r\n\r\n * Fixed auth when using V2 protocol\r\n * Made sure a client with authentication enabled can talk to a bookie without authentication. This is required in any case when enabling/disabling authentication on a live cluster.\r\n * Run all auth tests against both v2 and v3 protocol.\r\n\r\nThis should be included in 4.7.2 to give a path to upgrade.\r\n\r\ncc/ rdhabalia \n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1805 from merlimat/fix-v2-auth","Date":"Sun Nov 11 19:42:32 CET 2018"},{"Commit-ID":"commit 3cc261a6ad819613026da6b856f1a1719b35d9bb 1541971738 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Sun Nov 11 13:28:58 2018 -0800]","Body":"Fix indentation in BP-34 doc\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n- just indentation fix\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1803 from reddycharan/bp34fix","Date":"Sun Nov 11 22:28:58 CET 2018"},{"Commit-ID":"commit 398aa4cdc4b168f76d453fd74eda66182e24b21f 1541971815 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Sun Nov 11 13:30:15 2018 -0800]","Body":"Fix bugs in DefaultEnsemblePlacementPolicy\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n- bookieInfoMap is not initialized and newEnsemble will throws BKNotEnoughBookiesException if\r\ndiskWeightBasedPlacement is enabled\r\n- add test coverage for DefaultEnsemblePlacementPolicy with diskWeightBasedPlacement enabled\r\n\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>, Andrey Yegorov <None>\n\nThis closes #1788 from reddycharan/defaultplacementfix","Date":"Sun Nov 11 22:30:15 CET 2018"},{"Commit-ID":"commit faeb9bb89c40045bd63681ecab662b838cdeec32 1542026579 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Mon Nov 12 04:42:59 2018 -0800]","Body":"ISSUE #1799: bkctl is broken with default build options\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\n`bkctl` is designed in a modularized way for extensibility.\r\nit loads command groups via ServiceLoader. However current build\r\nprofile doesn't leverage this extensibility. Instead it hardcodes\r\nall the commands in one service load file. So if `bkctl` is built\r\nwithout `-Dstream`, it will broke.\r\n\r\n*Changes*\r\n\r\n- move `ledger` related commands to `tools/ledger`\r\n- generate the service load file by concating `commands` files from each module's resources directory.\r\n\r\n*Results*\r\n\r\nbkctl works for all build profiles.\r\n\r\n- without `-Dstream`\r\n\r\n```\r\n$ bin/bkctl\r\n\r\nbkctl interacts and operates Apache BookKeeper clusters\r\n\r\nUsage:  bkctl [flags] [command group] [commands]\r\n\r\nCommands:\r\n\r\n    bookie      Commands on operating a single bookie\r\n    bookies     Commands on operating a cluster of bookies\r\n    cookie      Commands on operating cookies\r\n    ledger      Commands on interacting with ledgers\r\n\r\n    help        Display help information about it\r\n\r\nFlags:\r\n\r\n    -c, --conf\r\n        Configuration file\r\n\r\n    -n, --namespace\r\n        Namespace scope to run commands (only valid for table service for now)\r\n\r\n    -u, --service-uri\r\n        Service Uri\r\n\r\n    -h, --help\r\n        Display help information\r\n\r\nUse \"bkctl [command] --help\" or \"bkctl help [command]\" for more information\r\nabout a command\r\n```\r\n\r\n- with `-Dstream`\r\n\r\n```\r\n$ bin/bkctl\r\n\r\nbkctl interacts and operates Apache BookKeeper clusters\r\n\r\nUsage:  bkctl [flags] [command group] [commands]\r\n\r\nCommands:\r\n\r\n    bookie          Commands on operating a single bookie\r\n    bookies         Commands on operating a cluster of bookies\r\n    cluster         Commands on administrating bookkeeper clusters\r\n    cookie          Commands on operating cookies\r\n    ledger          Commands on interacting with ledgers\r\n    namespace       Commands on operating namespaces\r\n    table           Commands on interacting with tables\r\n    tables          Commands on operating tables\r\n\r\n    help            Display help information about it\r\n\r\nFlags:\r\n\r\n    -c, --conf\r\n        Configuration file\r\n\r\n    -n, --namespace\r\n        Namespace scope to run commands (only valid for table service for now)\r\n\r\n    -u, --service-uri\r\n        Service Uri\r\n\r\n    -h, --help\r\n        Display help information\r\n\r\nUse \"bkctl [command] --help\" or \"bkctl help [command]\" for more information\r\nabout a command\r\n```\r\n\r\nMaster Issue: #1799 \r\n\r\n\r\n\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1800 from sijie/refactor_bkctl, closes #1799","Date":"Mon Nov 12 13:42:59 CET 2018"},{"Commit-ID":"commit 8ad1e9031eca426324583d29b50d6c70046310d5 1542027274 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Mon Nov 12 04:54:34 2018 -0800]","Body":"[tools] package bookkeeper tools into a separated distribution\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nServer distribution contains a lot of stuffs that doesn\u2019t need to run bkctl and bookkeeper shell, such as stats providers, http servers and many other dependencies.\r\n\r\nAt many environments, you want to deliver a set of tools to your customers to interact with or operate bookkeeper clusters. They don\u2019t care about server side stuffs and ask them to use a server package to run a tool makes things confused.\r\n\r\n*changes*\r\n\r\nCreate a new \u2018bkctl\u2019 package that only contains bookkeeper shell and new cli.\r\n\r\n\r\n\r\n\n\nReviewers: Charan Reddy Guttapalem <reddycharan18@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1798 from sijie/package_bookkeeper_tool","Date":"Mon Nov 12 13:54:34 CET 2018"},{"Commit-ID":"commit 9fd28d0cef37b0c69fb015a864c3629652e2aa38 1542053519 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Nov 12 21:11:59 2018 +0100]","Body":"Move version out of LedgerMetadata\n\nThe version is a property of the metadata store and not of the\r\nLedgerMetadata object itself. Putting it in the LedgerMetadata forces\r\nthat LedgerMetadata to be mutable, as it needs to be updated before\r\nbeing sent to the LedgerManager.\r\n\r\nThis change moves version out of LedgerMetadata and modifies the\r\nLedgerManager to use Versioned<LedgerMetadata>.\r\n\r\nThis is a large change, but almost purely mechanical.\r\n\r\nTestHttpService has been modified to remove a preexisting flake in a\r\ntest which had to be modified for this change.\r\n\r\nMaster issue: #281\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1797 from ivankelly/kill-set-version","Date":"Mon Nov 12 21:11:59 CET 2018"},{"Commit-ID":"commit 1590ca3c7056f878cf1d0c6298f277d4cd04315c 1542099213 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Tue Nov 13 00:53:33 2018 -0800]","Body":"BP-36: Stats documentation annotation\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nA common ask from people using bookkeeper is how they can monitor bookies and bookkeeper clients, what kind of metrics that bookkeeper exposes\r\nand what are the important metrics. Currently bookkeeper doesn't provide any metrics page for guiding people on monitoring bookkeeper services.\r\n\r\nIn order to help people on this, we need to provide a few documentation pages about metrics. However if we just write such pages, those pages\r\ncan quickly get out-of-dated when code is changed. The proposal here is to seek a programming way for generating metrics related pages.\r\n\r\nMaster Issue: #1785\r\n\r\n\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>, Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>, Andrey Yegorov <None>\n\nThis closes #1786 from sijie/bp_stats_generator","Date":"Tue Nov 13 09:53:33 CET 2018"},{"Commit-ID":"commit 450f27ce3c80f78151bdd962c9deb31e92df6620 1542099296 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Tue Nov 13 00:54:56 2018 -0800]","Body":"[STATS] introduce `StatsDoc` annotation for better documenting metrics exposed by bookkeeper\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\nA common ask from people using bookkeeper is how they can monitor bookies and bookkeeper clients, what kind of metrics that bookkeeper exposes\r\nand what are the important metrics. Currently bookkeeper doesn't provide any metrics page for guiding people on monitoring bookkeeper services.\r\n\r\nIn order to help people on this, we need to provide a few documentation pages about metrics. However if we just write such pages, those pages\r\ncan quickly get out-of-dated when code is changed.\r\n\r\n### Changes\r\n\r\n- Introduce an annotation `StatsDoc` for annotating the counters/gauges/opstats in the source code.\r\n- Provide a tool to generate the stats and their documentation into a yaml file.\r\n\r\nThe yaml file will be used by the website for rendering a metrics reference page.\r\n\r\n### Results\r\n\r\n```\r\n\"server\":\r\n  \"bookie_BOOKIE_READ_ENTRY_BYTES\":\r\n    \"description\": |-\r\n      bytes stats of ReadEntry on a bookie\r\n    \"type\": |-\r\n      OPSTATS\r\n  \"bookie_WRITE_BYTES\":\r\n    \"description\": |-\r\n      total bytes written to a bookie\r\n    \"type\": |-\r\n      COUNTER\r\n  \"bookie_BOOKIE_ADD_ENTRY\":\r\n    \"description\": |-\r\n      operations stats of AddEntry on a bookie\r\n    \"type\": |-\r\n      OPSTATS\r\n  \"bookie_BOOKIE_RECOVERY_ADD_ENTRY\":\r\n    \"description\": |-\r\n      operation stats of RecoveryAddEntry on a bookie\r\n    \"type\": |-\r\n      OPSTATS\r\n  \"bookie_BOOKIE_ADD_ENTRY_BYTES\":\r\n    \"description\": |-\r\n      bytes stats of AddEntry on a bookie\r\n    \"type\": |-\r\n      OPSTATS\r\n  \"bookie_BOOKIE_FORCE_LEDGER\":\r\n    \"description\": |-\r\n      total force operations occurred on a bookie\r\n    \"type\": |-\r\n      COUNTER\r\n  \"bookie_READ_BYTES\":\r\n    \"description\": |-\r\n      total bytes read from a bookie\r\n    \"type\": |-\r\n      COUNTER\r\n  \"bookie_BOOKIE_READ_ENTRY\":\r\n    \"description\": |-\r\n      operation stats of ReadEntry on a bookie\r\n    \"type\": |-\r\n      OPSTATS\r\n```\r\n\r\nMaster Issue: #1786\r\n\r\n\r\n\n\nReviewers: Ivan Kelly <ivank@apache.org>, Jia Zhai <None>\n\nThis closes #1787 from sijie/stats_generator","Date":"Tue Nov 13 09:54:56 CET 2018"},{"Commit-ID":"commit dab8310f09c963112bb7a3efede5763ac35ee185 1542134124 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Nov 13 10:35:24 2018 -0800]","Body":"Added module to enable CPU affinity\n\n### Motivation\r\n\r\nThis is part of a set of changes aimed at reducing latency in BK at the expense of other aspects (eg: max throughput). While not intended to be used as default settings, they might be good to have whenever the latency becomes critical. \r\n\r\nPinning a thread to a particular CPU will ensure no other process will execute on that CPU reducing all scheduler induced context switches that will cause latency jittery.\r\n\r\nA given thread that wants to get pinned to a CPU just needs to call: \r\n\r\n```java\r\nCpuAffinity.acquireCore();\r\n```\r\n\r\nIt's called `acquireCore()` because it will also disable hyper-threading on the pinned cpu.\r\n\r\nSubsequent PRs will use this module to have the option to pin critical threads to available CPUs.\r\n\r\n### Changes\r\n * Added JNI module to call `sched_setaffinity()` to pin a thread to a particular CPU\r\n * Automatically discover available isolated CPUs\r\n * Acquire file-based locks to allow multiple processes on same machine to acquire CPUs independently.\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1641 from merlimat/cpu-affinity","Date":"Tue Nov 13 19:35:24 CET 2018"},{"Commit-ID":"commit 5997963d5b68d6fc6d341352fb40562eb92dab2b 1542237177 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Nov 14 15:12:57 2018 -0800]","Body":"Added BlockingQueue implementation based on JCtools\n\n### Motivation\r\n\r\nAdd a `BlockingQueue` implementation that is suitable for low latency and low contention. \r\n\r\nKey points:\r\n * Optimized for multiple producers and single consumer\r\n * When waiting for entries, the thread is blocked with busy wait to avoid context switch.\r\n\r\n(This will be used in subsequent PRs to optionally enable it)\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1682 from merlimat/blocking-queue","Date":"Thu Nov 15 00:12:57 CET 2018"},{"Commit-ID":"commit 0c623d54ed15102667d2d1ac389998a1ffdcf11c 1542406171 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Fri Nov 16 23:09:31 2018 +0100]","Body":"Fix cpu-affinity module build on jdk10+\n\nPort tricks from circe-checksum to cpu-affinity module in order to make the build pass on JDK11\n\nReviewers: Sijie Guo <sijie@apache.org>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1816 from eolivelli/fix/jdk11-cpu-affinity-build","Date":"Fri Nov 16 23:09:31 CET 2018"},{"Commit-ID":"commit deebe6db0c2fbd89cd7558e3a7ce76ec076aac5b 1542406226 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Fri Nov 16 14:10:26 2018 -0800]","Body":"[BOOKIE] Fix sorted ledger storage rotating entry log files too frequent\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nA strong behavior was observed when using sorted ledger storage with single entry log manager on production:\r\n\r\n\"the entry log files are rotated very frequently and small entry log files are produced\".\r\n\r\nThe problem was introduced due to #1410.\r\n\r\nAt current entry logger, when a new entry log file is created, EntryLogger will notify its listeners\r\nthat a new entry log file is rotated via [`onRotateEntryLog`](https://github.com/apache/bookkeeper/blob/master/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerBase.java#L152).\r\n\r\nBefore the change in #1410, `SortedLedgerStorage` inherits from `InterleavedLedgerStorage`.\r\nSo when a new entry log file is rotated, `SortedLedgerStorage` is notified.\r\n\r\nHowever after the change in #1410, `SortedLedgerStorage` doesn't inherits `InterleavedLedgerStorage` anymore.\r\nInstead, the relationship is changed to composition. `SortedLedgerStorage` is composed using an interleaved ledger\r\nstorage. So the entrylog listener contract was broken. `SortedLedgerStorage` will not receive any `onRotateEntryLog`\r\nnotification any more.\r\n\r\n*Changes*\r\n\r\nWhen `SortedLedgerStorage` initializes, it passes its own entry log listener down to the interleaved ledger storage.\r\nSo entry logger can notify the right person for entry log rotations.\r\n\r\n*Tests*\r\n\r\nExisting tests should cover most of the case. Looking for how to add new test cases.\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Charan Reddy Guttapalem <reddycharan18@gmail.com>, Andrey Yegorov <None>\n\nThis closes #1807 from sijie/fix_rotation_behavior","Date":"Fri Nov 16 23:10:26 CET 2018"},{"Commit-ID":"commit fe50b8c975acce46a2ed680c82de62cba36b058e 1542474691 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Sat Nov 17 09:11:31 2018 -0800]","Body":"Introduce condensed encoding format for availabilityOfEntriesOfLedger\n\nDescriptions of the changes in this PR:\r\n\r\n- this condensed encoding format will take fewer bytes than initially\r\nproposed bit vector.\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1814 from reddycharan/updatebpdoc","Date":"Sat Nov 17 18:11:31 CET 2018"},{"Commit-ID":"commit 1a030239d6c3c221b140a02e3ef8ba137f709985 1542623199 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Nov 19 11:26:39 2018 +0100]","Body":"Rollback snakeyaml version (Fixes IT tests)\n\nThe stats gen (#1787) change introduced a version of snakeyaml which\r\nis incompatible with arquillian-cube (between 1.19 and 1.23 they\r\nremove some methods).\r\n\r\nThis was picked up by the integration tests, but overriden to submit.\r\n\r\nThis change pins the snakeyaml version at 1.19, thereby allowing the\r\nintegration tests to run again.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1817 from ivankelly/fix-it","Date":"Mon Nov 19 11:26:39 CET 2018"},{"Commit-ID":"commit 2260cb4d99990cdd3edbaa3591ea26c3643502de 1542637416 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Nov 19 15:23:36 2018 +0100]","Body":"Change LedgerManager to use CompletableFuture\n\nAll new uses of LedgerManager are creating GenericCallbackFutures to\r\npass in as the callback. This patch cuts out the middleman, and makes\r\nLedgerManager return CompletableFutures itself.\r\n\r\nThe patch only touches the CRUD operations, and not\r\nLedgerManager#asyncProcessLedgers, which I may tackle in a later PR.\r\n\r\nMaster issue: #281\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1809 from ivankelly/metastore-futures","Date":"Mon Nov 19 15:23:36 CET 2018"},{"Commit-ID":"commit 79bb0b1c8570359b2ac9b1e4a5c84ac3eca93496 1542821099 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Nov 21 18:24:59 2018 +0100]","Body":"AbstractZkLedgerManager should catch all exceptions from parseConfig\n\nAnd always complete the request if an exception does occur, rather\r\nthan throwing it out to the higher level, and hanging the request\r\nforever.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1824 from ivankelly/catch-all-exception-zk","Date":"Wed Nov 21 18:24:59 CET 2018"},{"Commit-ID":"commit f49bd035db01f5b50df88c6c43329f7824984181 1542850965 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Nov 22 02:42:45 2018 +0100]","Body":"LedgerMetadata#parseConfig uses Metadata Builder\n\nparseConfig is one of the main places that mutates member fields of\r\nLedgerMetadata. This change removes these mutates to make it use\r\nLedgerMetadataBuilder instead.\r\n\r\nMaster issue: #281\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1825 from ivankelly/parse-builder","Date":"Thu Nov 22 02:42:45 CET 2018"},{"Commit-ID":"commit ac7c567f81376dcf277467f2097a90c101de447b 1542885335 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Nov 22 11:15:35 2018 +0000]","Body":"Fix flake in AuditorPeriodicBookieCheckTest\n\nThe flake was occurring because the bookie checker was trying to\r\nconnect to a TCP endpoint that didn't respond (1.1.1.1) and was\r\nwaiting for the whole tcp connect timeout (10sec), while the test was\r\nwaiting 10 seconds for the success condition to occur. The success\r\ncondition often occurred just after the test fails.\r\n\r\nThe solution was to bring the connect timeout for the client down to\r\n500ms, giving the auditor plenty of time to register the\r\nunderreplicated ledger.\r\n\r\nI guess this used to pass in the past because maybe 1.1.1.1 was\r\nactually rejecting packets instead of dropping them, and these changed\r\nwhen cloudflare took over the address. I changed the endpoint to\r\n192.0.2.0/24 range (TEST-NET) to avoid a similar scenario in the\r\nfuture.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1826 from ivankelly/auditor-bookie-flake","Date":"Thu Nov 22 12:15:35 CET 2018"},{"Commit-ID":"commit c6031e0bdc8002b9cae1e1a90d27a32d9e315d5b 1542900210 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Nov 22 15:23:30 2018 +0000]","Body":"Remove LedgerMetadata constructors except one for builder\n\nLedgerMetadata shouldn't generally be created outside the client,\r\nexcept for testing. In the case where it is, the builder should be\r\nused to construct it.\r\n\r\nI've left the copy constructor for now, as I don't feel comfortable\r\nremoving it until all fields are final, which will occur soon.\r\n\r\nMaster issue: #281\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1827 from ivankelly/kill-constructors","Date":"Thu Nov 22 16:23:30 CET 2018"},{"Commit-ID":"commit 10df5e7f0f5b6554844f378757edd24e1f3b2fab 1542908748 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Nov 22 17:45:48 2018 +0000]","Body":"Make most LedgerMetadata fields final\n\nMake most fields in LedgerMetadata final. The ones which I have not\r\nchanged in this patch require a more involved change, so they'll come\r\nin separate PRs.\r\n\r\nMaster issue: #281\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1828 from ivankelly/mostly-final","Date":"Thu Nov 22 18:45:48 CET 2018"},{"Commit-ID":"commit 8c65088dcd019fa9fe17d39745ca1400ccf7bbbb 1542914322 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Thu Nov 22 11:18:42 2018 -0800]","Body":"Remove duplication logic for 'minNumRacksPerWriteQuorum' handling in RackawareEnsemblePlacementPolicyImpl\n\nDescriptions of the changes in this PR:\r\n\r\nWith this change\r\nhttps://github.com/apache/bookkeeper/commit/9ba4c4e0d8be770e03110a958fb8b75a65ae0f59\r\nwe introduced 'minNumRacksPerWriteQuorum' config option. To handle that, logic is added in\r\nRackawareEnsemblePlacementPolicyImpl.newEnsembleInternal and RackQuorumCoverageSet. But in\r\nretrospect, this is kind of duplicate logic and changes made in RackawareEnsemblePlacementPolicyImpl.newEnsembleInternal\r\nis not really needed, because anyhow 'apply' of predicate (RRTopologyAwareCoverageEnsemble) is called, which calls\r\n'apply' method on all the concerned RackQuorumCoverageSet.\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1810 from reddycharan/revertrackawarechanges","Date":"Thu Nov 22 20:18:42 CET 2018"},{"Commit-ID":"commit b52869bfff2caf8d2fd525a25828e95a3014a2e9 1542914442 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Nov 22 19:20:42 2018 +0000]","Body":"Move utility method from LedgerMetadata to test\n\nThe method is only used in the test, so it should live there.\r\n\r\nMaster issue: #281\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1829 from ivankelly/move-junk","Date":"Thu Nov 22 20:20:42 CET 2018"},{"Commit-ID":"commit 2a5e37c186387998aa0d7cf36766777d7e194151 1542931395 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Thu Nov 22 16:03:15 2018 -0800]","Body":"[SCRIPTS] improve bookkeeper script to better handle standalone command\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n*Motivation*\r\n\r\n`bin/bookkeeper standalone` is broken when a release package is built without including `stream` profile.\r\n\r\n*Changes*\r\n\r\n`standalone` is a service component including everything. so fail the command if it can't locate corresponding components.\r\n\r\nRelated Issues: #1822\r\n\r\n\r\n\r\n\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1823 from sijie/refactor_bookkeeper_scripts","Date":"Fri Nov 23 01:03:15 CET 2018"},{"Commit-ID":"commit 32ae78311c1a284551e2a6b6941d11d05fec097e 1542931484 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Nov 23 00:04:44 2018 +0000]","Body":"Remove LedgerMetadata methods modifying ensembles\n\nRemove any methods in LedgerMetadata that modify the ensemble. With\r\nthis change the ensembles are 100% immutable.\r\n\r\nMaster issue: #281\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1830 from ivankelly/no-mod-ensemble","Date":"Fri Nov 23 01:04:44 CET 2018"},{"Commit-ID":"commit 9b3c6b73d8f667d52eb78025f07d3aedec6e9de0 1542983551 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Nov 23 14:32:31 2018 +0000]","Body":"Make LedgerMetadata fields for closing immutable\n\nMaster issue: #281\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1831 from ivankelly/close-immut","Date":"Fri Nov 23 15:32:31 CET 2018"},{"Commit-ID":"commit d02cf45f11b25fbdfdf3206790994a720688ceb3 1542985055 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Fri Nov 23 15:57:35 2018 +0100]","Body":"Prepare website structure for 4.8.1 release\n\nSigned-off-by: eolivelli <eolivelliapache.org>\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\nPrepare the wesite for 4.8.1 release\r\n\r\n### Changes\r\n\r\nCreate the structure for docs for 4.8.1\r\n\r\n\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1790 from eolivelli/fix/site-481-structure","Date":"Fri Nov 23 15:57:35 CET 2018"},{"Commit-ID":"commit 4d3ffae69e96a0ed9b1fe68c43c5192565f56f1b 1542991475 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Nov 23 16:44:35 2018 +0000]","Body":"Remove LedgerMetadata copy constructor\n\nA copy constructor makes no sense when it's not possible to mutate the object.\r\n\r\nMaster issue: #281\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1832 from ivankelly/kill-copy","Date":"Fri Nov 23 17:44:35 CET 2018"},{"Commit-ID":"commit 4019f75536d99d4af85269221811f2e41d4f8fae 1542999047 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Nov 23 18:50:47 2018 +0000]","Body":"Make custom metadata final\n\nMaster issue: #281\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1833 from ivankelly/immut-cust","Date":"Fri Nov 23 19:50:47 CET 2018"},{"Commit-ID":"commit a32e29d66162b76a8dd6f58d3eacb7b62dd07ba2 1543123752 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Sat Nov 24 21:29:12 2018 -0800]","Body":"Remove MathUtils.now()\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\n`MathUtils.now()` using System.nanoTime doesn't provide accurate time. It is used\r\nfor measuring pupose. However since `nanoTime` can have numeric overflow, so when\r\nit is used for converting into milliseconds, it is misleading and error-prone. A\r\nlot of places using `MathUtis.now` can all replaced with `System.currentTimeMillis()`.\r\n\r\nIt leads to unknown behavior on compactions. examples is shown in the following figure.\r\n\r\n<img width=\"1157\" alt=\"wechatimg180\" src=\"https://user-images.githubusercontent.com/1217863/48965961-d860b600-ef7c-11e8-9394-1d51cef5c68c.png\">\r\n\r\nexample: this graph shows the major_compaction_count. major compaction is supposed to run every day. but in the graph, there is no major compaction occuring in 4 days.\r\n\r\n*Changes*\r\n\r\nRemove `MathUtils.now()` and replace it with `System.currentTimeMillis()`.\r\n\r\n\r\n\r\n\n\nReviewers: Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1837 from sijie/remove_mathutils_now","Date":"Sun Nov 25 06:29:12 CET 2018"},{"Commit-ID":"commit 1a44de7c26f81e4e9070906853aab172cf2bee18 1543222298 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Mon Nov 26 09:51:38 2018 +0100]","Body":"Release notes for 4.8.1\n\nRelease notes for 4.8.1\r\n\r\nThe commit to review is d09296c589b8a188937833ca51a4b24ea337a901\r\n\r\n\r\n\n\nReviewers: Jia Zhai <None>, Matteo Merli <mmerli@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1795 from eolivelli/fix/481-release-notes","Date":"Mon Nov 26 09:51:38 CET 2018"},{"Commit-ID":"commit 641db3b4ff29d8e04216fee84625546707631e8e 1543313779 -----sp","Author":"PersonIdent[Jia Zhai, jiazhai@users.noreply.github.com, Tue Nov 27 18:16:19 2018 +0800]","Body":"Add rest endpoint trigger_gc to trigger GC on Bookie\n\nDescriptions of the changes in this PR:\r\n\r\nAdd rest endpoint trigger_gc to trigger GC on Bookie\r\n\r\n### Motivation\r\n\r\nSome times user would like to trigger GC manually instead of waiting to the timeout or disk full. \r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1838 from jiazhai/rest_force_gc","Date":"Tue Nov 27 11:16:19 CET 2018"},{"Commit-ID":"commit 5602c51192483075686746afb84c3449a470a98d 1543388292 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Tue Nov 27 22:58:12 2018 -0800]","Body":"[UTILS] Move ReflectionUtils to bookkeeper-common module\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nRefelectionUtils contains helpers for loading classes from relections.\r\nIt is useful across the project. However the class is in `bookkeeper-server` module only.\r\n\r\n*Changes*\r\n\r\nMove this class to `bookkeeper-common` module\r\n\r\n\r\n\n\nReviewers: Jia Zhai <None>\n\nThis closes #1841 from sijie/move_reflection_utils","Date":"Wed Nov 28 07:58:12 CET 2018"},{"Commit-ID":"commit 6d4e5c806ebcb593815ce23e21762cd0672de9cc 1543393192 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Wed Nov 28 09:19:52 2018 +0100]","Body":"Use ${sha1} instead of ${ghprbActualCommit} for Pre-commit Jobs\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nAccording to  the documentation of the GitHub Pull Request plugin:\r\n- ${sha1} means a commit which is the result of merging the PR branch with the target branch\r\n- ${ghprbActualCommit} is directly the PR branch\r\n\r\nSo currently we are not testing the PR branch against the target branch, but only the branch \"as it is\"\r\n\r\nsee:\r\nhttps://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=4&ved=2ahUKEwje0PjpnuDeAhUF2SwKHXN4BgYQFjADegQIAxAB&url=https%3A%2F%2Fwiki.jenkins.io%2Fdisplay%2FJENKINS%2FGitHub%2Bpull%2Brequest%2Bbuilder%2Bplugin&usg=AOvVaw2XvPL5ynRYnqVEWqpe9cs1\r\n\r\n### Changes\r\n\r\nUse ${sha1} instead of ${ghprbActualCommit} for Pre-commit Jobs\r\n\r\n\r\n\n\nReviewers: Ivan Kelly <ivank@apache.org>, Sijie Guo\n\nThis closes #1818 from eolivelli/fix/jenskin-use-sha1","Date":"Wed Nov 28 09:19:52 CET 2018"},{"Commit-ID":"commit dfbfa8d22844956be599c62f12ed13d8abe52696 1543419073 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Nov 28 16:31:13 2018 +0100]","Body":"Only publish suspect ledgers if they have missing fragments\n\nThis is a fix for a flake in\r\nAuditorPeriodicCheckTest#testIndexCorruption. Auditor#checkAllLedgers()\r\nruns a check on all ledgers, passing ProcessLostFragmentsCb as a\r\ncallback to LedgerChecker#checkLedger for each one.\r\n\r\nLedgerChecker#checkLedger triggers the callback on completion,\r\nregardless of whether there are fragments missing on not. Previously,\r\nProcessLostFragments was not checking if there were lost fragments\r\nbefore publishing the ledger as suspected in zookeeper.\r\n\r\nThe flake triggered as there were always two ledgers that existed when\r\nthe check occurred, both would be reported as suspected, and it was\r\nrandom which would be returned while polling for underreplicated\r\nledgers.\r\n\r\nThe fix is to check that something is actually underreplicated before\r\npublishing.\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1834 from ivankelly/auditor-periodic-flake","Date":"Wed Nov 28 16:31:13 CET 2018"},{"Commit-ID":"commit d7fffac47f013a6902f9b61e8f8ffcb3ed29abff 1543435649 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Wed Nov 28 12:07:29 2018 -0800]","Body":"[LEDGER STORAGE] DbLedgerStorage should do periodical flush\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nDbLedgerStorage doesn't drive checkpoint itself. so currently DbLedgerStorage flush only\r\nhappens either when write-cache is full or entry log file rotated. The correctness is still\r\nmaintained. However the behavior is different from original yahoo behavior.\r\n\r\n*Changes*\r\n\r\nRevert the behavior back to original periodical flush\r\n\r\n\r\n\n\nReviewers: Matteo Merli <mmerli@apache.org>, Jia Zhai <None>\n\nThis closes #1843 from sijie/dbledgerstorage_sync","Date":"Wed Nov 28 21:07:29 CET 2018"},{"Commit-ID":"commit b0708b58f9d6490ed4e47ec688067bebdeb121aa 1543457438 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Wed Nov 28 18:10:38 2018 -0800]","Body":"[RELEASE] fix docker mount volume issue\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n* Motivation\r\n\r\n #1674 introduced a regression for running release scripts on mac.\r\n the destination should be \"/home/${USER}\" rather than ${LOCAL_HOME}.\r\n because the docker os is linux. Otherwise the gpg keys can not propagated\r\n correctly from host machine to docker.\r\n\r\n* Changes\r\n\r\n Use `/home/${USER}` as the destination path\r\n\r\n\r\n\r\n\n\nReviewers: Jia Zhai <None>\n\nThis closes #1845 from sijie/fix_release_scripts","Date":"Thu Nov 29 03:10:38 CET 2018"},{"Commit-ID":"commit 8979e9e0dc7f1c7e6bae2636c508ca529593e17a 1543459294 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Wed Nov 28 18:41:34 2018 -0800]","Body":"[STATS] Add @StatsDoc annotation for bookie server request stats\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nAs part of [BP-36](https://github.com/apache/bookkeeper/issues/1785), this PR is to document the request stats\r\nfor bookkeeper server.\r\n\r\n*Changes*\r\n\r\n- add `parent` and `happensAfter` in StatsDoc\r\n- convert bookie request stats to use StatsDoc for documenting metrics\r\n\r\nMaster Issue: #1785 \r\n\r\n\r\n\n\nReviewers: Jia Zhai <None>\n\nThis closes #1839 from sijie/bp36_add_parent_and_happensafter","Date":"Thu Nov 29 03:41:34 CET 2018"},{"Commit-ID":"commit 079013e6637ed3c3ea543cb2a094dbd5c8ee0e00 1543482420 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Nov 29 10:07:00 2018 +0100]","Body":"Rename LedgerMetadataBuilder#closingAt to  parameter order (#1835)\n\n* Rename LedgerMetadataBuilder#closingAt to clarify parameter order\r\n\r\nThe two parameters are long, which can be confusing.\r\n\r\nMaster issue: #281\r\n","Date":"Thu Nov 29 10:07:00 CET 2018"},{"Commit-ID":"commit ce81fe85d55561b6569230b7fcb6b043c5d2615c 1543560665 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Thu Nov 29 22:51:05 2018 -0800]","Body":"[CI] increase timeout of website build to 120 mins\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nSince we have more releases, the build time for website is increasing to beyond 30 min.\r\nIncrease it to 120 mins for now\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1844 from sijie/change_website_buildtime","Date":"Fri Nov 30 07:51:05 CET 2018"},{"Commit-ID":"commit 1285d20f5200a1a1e4e5ed7de4c712559c6123b4 1543566443 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri Nov 30 00:27:23 2018 -0800]","Body":"Set default sizes of DbLedgerStorage read and write cache to be proportional to JVM direct memory\n\n\r\n### Motivation\r\n\r\nTo simplify Bookie configuration when using `DbLedgerStorage`, set the memory size defaults for WriteCache, ReadCache and RocksDB block cache to be pegged to the available direct memory configured in the JVM.\r\n\r\nUser can always configure specific values and override this behavior.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1813 from merlimat/auto-conf-db-storage-mem","Date":"Fri Nov 30 09:27:23 CET 2018"},{"Commit-ID":"commit d6007edc419751378e5f7efb2a944693c1956401 1543573540 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Nov 30 11:25:40 2018 +0100]","Body":"Move serialization code out of LedgerMetadata\n\nThis PR moves the serialization code out of LedgerMetadata so that it\r\ncan later be adapted to run different serialization code depending on\r\nthe environment.\r\n\r\nNotable non-refactor changes:\r\n- LedgerMetadata#toString no longer uses #serialize because it's no\r\n  longer available. Instead it uses the ToString helper from guava.\r\n  byte[] fields are now base64 encoded.\r\n- There's a new state enum and getter in api.LedgerMetadata. This is\r\n  so that LedgerMetadataFormat can be removed from\r\n  client.LedgerMetadata.\r\n\r\nMaster issue: #723\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1848 from ivankelly/refactor-md-serde","Date":"Fri Nov 30 11:25:40 CET 2018"},{"Commit-ID":"commit b39564183eb8cab5ab21752843fe65a949fc96ff 1543622789 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Sat Dec 1 01:06:29 2018 +0100]","Body":"Let OS choose port for vertx test\n\nThe previous implementation was searching for a open port by\r\nrepeatedly trying to startServer on ports starting at 8080. However,\r\nafter the first attempt fails, the Vertx instance in VertxHttpServer\r\nis broken and the test hangs. 8080 is a very common port to have stuff\r\nrunning on, so these hangs have happened to be repeatedly.\r\n\r\nThis fix is to allow the OS to choose the port, by specifying 0 as the\r\nlistening port and querying afterwards.\r\n\r\nIssue: #1821\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1853 from ivankelly/vertx-8080","Date":"Sat Dec 01 01:06:29 CET 2018"},{"Commit-ID":"commit 02f706f18c6a76083bac4e0002f428d27bb8cbdb 1543624141 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Fri Nov 30 16:29:01 2018 -0800]","Body":"[TABLE SERVICE] add a bookie registration based grpc name resolver\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nTable service is using grpc name resolver to figure out the alive servers serving table service.\r\nCurrently it is using default dns name resolver. In the context of Pulsar, since brokers talk\r\nto bookies via zookeeper service discovery, it is making sense for brokers talk to table service\r\nvia zookeeper service discovery. So this PR is to add a bookie registration based grpc name resolver.\r\n\r\n*Changes*\r\n\r\nImplement a bookie-registration library based grpc name resolver.\r\n\r\n\r\n\n\nReviewers: Jia Zhai <None>\n\nThis closes #1842 from sijie/add_zookeeper_resolver","Date":"Sat Dec 01 01:29:01 CET 2018"},{"Commit-ID":"commit 4f8fae51802c0f51daaa6410fa929d671b58fbf5 1543624193 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Sat Dec 1 01:29:53 2018 +0100]","Body":"LedgerMetadata should require digest and password together\n\nThere's never a case when setting the digest and password where you\r\nonly have one, but not the other.\r\n\r\nThe patch adds validation in LedgerMetadata that if you provide one, you\r\nprovide the other. The only case where you don't provide these is when \r\nusing pre-4.1.0 (i think) metadata.\r\n\r\nMaster issue: #281\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1836 from ivankelly/builder-pw","Date":"Sat Dec 01 01:29:53 CET 2018"},{"Commit-ID":"commit 8e0e9fb0fd2792bcce5ce9466ab5d2e1423f756f 1543840623 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Dec 3 13:37:03 2018 +0100]","Body":"Users of LedgerMetadata should use the api interface\n\nAll users to LedgerMetadata should use api.LedgerMetadata rather than\r\nclient.LedgerMetadata.\r\n\r\nSome methods have been promoted to the interface to allow this.\r\n\r\nOther methods have been moved out to a utility class that acts purely\r\non api.LedgerMetadata.\r\n\r\nclient.LedgerMetadata has been renamed to LedgerMetadataImpl.\r\n\r\nMaster issue: #723\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1852 from ivankelly/kill-store-ctime","Date":"Mon Dec 03 13:37:03 CET 2018"},{"Commit-ID":"commit 80a12e74276c455775e87e6fea3df4ed530c3850 1543849636 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Mon Dec 3 16:07:16 2018 +0100]","Body":"Mark 4.8.1 as latest release\n\nDescriptions of the changes in this PR:\r\n\r\nChange website configuration so that the downloads make suggest 4.8.1 and 4.8.0\r\n\r\n\r\n\r\n\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1855 from eolivelli/fix/mark-481-latest","Date":"Mon Dec 03 16:07:16 CET 2018"},{"Commit-ID":"commit e9699918d9ce0e5f8983387928ba14f64986e231 1543866061 -----sp","Author":"PersonIdent[snow4young, 1723262513@qq.com, Tue Dec 4 03:41:01 2018 +0800]","Body":"[TABLE SERVICE] remove extra code\n\nDescriptions of the changes in this PR:\r\nreview code and found extra code.\r\n\r\n\r\n### Motivation\r\nclean code\r\n\r\n### Changes\r\n\r\nclean extra code\r\n\r\nMaster Issue: #<master-issue-number>\r\n\r\n\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1856 from xujianhai/master","Date":"Mon Dec 03 20:41:01 CET 2018"},{"Commit-ID":"commit dce4fd4c16e5423a76a4be7aa76b23a52335c7fa 1543921394 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Dec 4 12:03:14 2018 +0100]","Body":"Add max ledger metadata format version to layout\n\nThe max ledger metadata format version is the maximum format version\r\nthat will be used to write ledger metadata. By setting it in the\r\nledger layout it becomes a cluster-wide configuration which is\r\ninitialized along with the cluster. Any cluster initialized with the\r\ncurrent code will end up with version 2. For this cluster serde will\r\nonly ever serialize with up to version 2 of the ledger metadata\r\nformat, so all clients that understand version 2 will continue to\r\nwork, even as the software version increases and new metadata formats\r\nbecome available (such as the binary metadata format coming soon).\r\n\r\nCurrently there is no handling in LedgerMetadataSerDe, because we\r\ndon't have a new version, but when there is, it will use\r\n```\r\nMath.min(maxLedgerMetadataFormatVersion,\r\n         metadata.getMetadataFormatVersion())\r\n```\r\nto decide which serialization method to use.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1858 from ivankelly/format-version","Date":"Tue Dec 04 12:03:14 CET 2018"},{"Commit-ID":"commit b959f8f4d9363a11d27a28150b1fad54123d83cc 1543949621 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Tue Dec 4 10:53:41 2018 -0800]","Body":"remove misleading comment\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nParallelRead is actually used internally at ledger recovery. It is used at production.\r\n\r\n*Changes*\r\n\r\nRemoved misleading comment.\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1671 from sijie/remove_misleading_comment","Date":"Tue Dec 04 19:53:41 CET 2018"},{"Commit-ID":"commit 41837e680e25ad80a802a2c4123bb0110e30155a 1543949715 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Tue Dec 4 10:55:15 2018 -0800]","Body":"[RELEASE NOTES] Release Notes for 4.7.3\n\n\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1850 from sijie/release_notes_473","Date":"Tue Dec 04 19:55:15 CET 2018"},{"Commit-ID":"commit bfd77268a00787cbbc0dc43d665d94ca195c4652 1543951733 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Tue Dec 4 20:28:53 2018 +0100]","Body":"Update BookKeeper version in Docker file for 4.8.1 release\n\nDescriptions of the changes in this PR:\r\nChange version from 4.8.0 in 4.8.1 on Dockerfile in branch-4.8\r\n\r\n\r\n### Motivation\r\n\r\nDistribute new Docker images for 4.8.1 release\r\n\r\n\r\n\r\n\r\n\r\nReviewers: Sijie Guo <sijieapache.org>\r\n\r\nThis closes #1851 from eolivelli/fix/docker-4.8.1\r\n\r\n\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1854 from eolivelli/fix/pick-481-docker","Date":"Tue Dec 04 20:28:53 CET 2018"},{"Commit-ID":"commit 97dda46fec47e8e8e2e75bcfd35284adf00cf7ff 1544042118 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Wed Dec 5 12:35:18 2018 -0800]","Body":"[RELEASE] [WEBSITE] Add documentation for release 4.7.3\n\n*Motivation*\r\n\r\nAdd documentation for release 4.7.3\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nThis closes #1859 from sijie/website_473","Date":"Wed Dec 05 21:35:18 CET 2018"},{"Commit-ID":"commit df857dd678810e396ba44531e4c4546e67a0eb7a 1544102210 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Thu Dec 6 05:16:50 2018 -0800]","Body":"Fix selectFromNetworkLocation in RackawareEnsemblePlacementPolicyImpl\n\n\r\nDescriptions of the changes in this PR:\r\n\r\nSince beginning, selectFromNetworkLocation(excludeRacks, excludeBookies,..)\r\nmethod kind of ignores predicate/ensemble passed to that method\r\nhttps://github.com/apache/bookkeeper/blob/branch-4.7/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java#L694.\r\n\r\nThis was kind of ok, because so far effectively this method is called from only\r\none place - https://github.com/apache/bookkeeper/blob/master/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java#L612,\r\nwhich passes TruePredicate.INSTANCE and EnsembleForReplacementWithNoConstraints.INSTANCE.\r\n\r\nBut it is not ideal to ignore those parameters in selectFromNetworkLocation(excludeRacks, excludeBookies,..),\r\nfrom future usage perspective. So passing the received predicate and ensemble to the underlying calls.\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>, Samuel Just <sjust@salesforce.com>\n\nThis closes #1862 from reddycharan/fixrackaware","Date":"Thu Dec 06 14:16:50 CET 2018"},{"Commit-ID":"commit 4c64b3c78d1120d3421a9f50abb9ec9ca97e8864 1544102422 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Dec 6 14:20:22 2018 +0100]","Body":"changingEnsemble should be negated before calling unset success\n\nIf the first pending add op is completed, but does not have the\r\nreplaced bookie in its write set, callbacks are triggered straight\r\naway.\r\n\r\nPreviously this would then hang forever, as the changingEnsemble would\r\nbe true. This patch sets changingEnsemble to false before calling\r\nunsetSuccessAndSendWriteRequest so that if callbacks are triggered\r\nstraight away, they can actually complete. It also moves the call to\r\nunsetSuccessAndSendWriteRequest outside of the metadataLock so that\r\nthe callbacks don't run inside the lock.\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1857 from ivankelly/block-order","Date":"Thu Dec 06 14:20:22 CET 2018"},{"Commit-ID":"commit dd684b30c734642dc1347cd931cb483de2ef4888 1544126561 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Dec 6 21:02:41 2018 +0100]","Body":"Ledger manager factories initialized with max metadata version\n\nIn dce4fd4 the max metadata format version was put in the\r\nconfiguration which was then used to create ledger managers. This is\r\nnot safe though, as it there are multiple paths which through which\r\nledger manager factories are created and some may not see this\r\nconfiguration modification. For example, on a new cluster where there\r\nis no preexisting layout, the layout isn't written until after the\r\nledger manager factory has been created.\r\n\r\nThis patch changes LedgerManagerFactory#initialize to explicitly\r\nrequire that the max ledger metadata format is specified in the call.\r\n\r\nMaster issue: #723\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1865 from ivankelly/explicit-max","Date":"Thu Dec 06 21:02:41 CET 2018"},{"Commit-ID":"commit 9a0da5c5a667704afbb120c029cf1bb309ac985f 1544561005 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Tue Dec 11 12:43:25 2018 -0800]","Body":"ISSUE #1770: Add local checker for Sorted/InterleavedLedgerStorage\n\nThe main goal of this patch is the ScrubberService LifecycleComponent\r\nwhich runs in the background periodically verifying the internal\r\nconsistency of the LedgerStorage. To get that to work:\r\n\r\n- LedgerStorage now has a localConsistencyCheck call with\r\nimplementations in Interleaved and Sorted.\r\n\r\n- In service of that implementation, LedgerCache gains an interface for\r\niterating safely over the entries of a ledger with a way of handling\r\nconcurrently modified or deleted ledgers with corresponding\r\nmodifications to LedgerEntryPage for detecting deletion.\r\n\r\n- EntryLogger has been refactored to permit checking the correctness\r\n(and throwing a descriptive exception in case of a problem) of an entry\r\nwithout actually reading it for use within localConsistencyCheck.\r\n\r\n- The two mechanisms for iterating over a ledger's entries in\r\nBookieShell have both been replaced with the new single implementation\r\n(InterleavedLedgerStorageTest now has a test checking the output of the\r\naffected command.)\r\n\r\n- Misc changes to *LogCompactor to support tests in\r\nInterleavedLedgerStorageTest.\r\n\r\nBecause the consistency check needs to run in the background and hold\r\nLEP instances potentially for a relatively long time, a delete may\r\noverlap with the scan of an LEP page. As part of this patch,\r\nIndexInMemPageMgr and LedgerEntryPage now permit an LEP to be marked\r\ndeleted and not added back to the set of free pages until released.\r\n\r\nThis patch also adds an option to run the checker on startup (defaults\r\nto false).\r\n\r\n(bug W-5188823)\r\n(bug W-5153309)\r\n(rev cguttapalem)\r\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1819 from athanatos/forupstream/wip-1770, closes #1770","Date":"Tue Dec 11 21:43:25 CET 2018"},{"Commit-ID":"commit 2c590322fdf27de008aae9fc98c405eaf2f27b1c 1544577199 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Wed Dec 12 09:13:19 2018 +0800]","Body":"[CI] Update precommit job captions with trigger phrase\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nSometime people don't know how to retrigger a bookkeeper precommit job.\r\n\r\n*Changes*\r\n\r\nThis PR is adding the trigger phrase to the job caption. so people will know\r\nhow to retrigger the jobs in the PR itself.\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1881 from sijie/update_jenkins_for_self_instructions","Date":"Wed Dec 12 02:13:19 CET 2018"},{"Commit-ID":"commit e5cf9d4fe575bbb24fbd08d142a820362763b327 1544577294 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Wed Dec 12 09:14:54 2018 +0800]","Body":"[STATS] [DOC] Add @StatsDoc annotation for entrylogger stats\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nAs part of [BP-36](https://github.com/apache/bookkeeper/issues/1785),\r\nthis PR is to document the entrylogger stats.\r\n\r\n*Changes*\r\n\r\n- convert entrylogger stats to use StatsDoc for documenting metrics\r\n\r\nMaster Issue: #1785\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1871 from sijie/document_ledgerstorage_stats","Date":"Wed Dec 12 02:14:54 CET 2018"},{"Commit-ID":"commit d82163f6315bcd59bbb77deae59aa26e84763f37 1544577569 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Wed Dec 12 09:19:29 2018 +0800]","Body":"[STATS] [DOC] Add @StatsDoc annotation for bookie state manager stats\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nAs part of [BP-36](https://github.com/apache/bookkeeper/issues/1785), this PR is to document bookie state manager stats.\r\n\r\n*Changes*\r\n\r\n- convert bookie state manager stats to use StatsDoc for documenting metrics\r\n\r\nMaster Issue: #1785\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1876 from sijie/bookie_state_stats","Date":"Wed Dec 12 02:19:29 CET 2018"},{"Commit-ID":"commit 132ecd74906d2336c31eaaa9ceb529c5cf26efdc 1544577652 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Wed Dec 12 09:20:52 2018 +0800]","Body":"[STATS] [DOC] Add @StatsDoc annotation for interleaved ledger storage stats\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nAs part of [BP-36](https://github.com/apache/bookkeeper/issues/1785), this PR is to document interleaved ledger storage stats.\r\n\r\n*Changes*\r\n\r\n- convert interleaved ledger storage stats to use StatsDoc for documenting metrics\r\n\r\nMaster Issue: #1785\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1877 from sijie/interleaved_stats","Date":"Wed Dec 12 02:20:52 CET 2018"},{"Commit-ID":"commit f4bbc21d39a8af5947fafecb2a52febf8b478b9e 1544577787 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Wed Dec 12 09:23:07 2018 +0800]","Body":"[STATS] [DOC] Add @StatsDoc annotation for bookkeeper client stats\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nAs part of [BP-36](https://github.com/apache/bookkeeper/issues/1785), this PR is to document bookkeeper client stats.\r\n\r\n*Changes*\r\n\r\n- convert bookkeeper client stats to use StatsDoc for documenting metrics\r\n\r\nMaster Issue: #1785\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1878 from sijie/client_stats","Date":"Wed Dec 12 02:23:07 CET 2018"},{"Commit-ID":"commit 6b7c2efc249783033965c6d79e0a5180a4083bef 1544712094 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Thu Dec 13 22:41:34 2018 +0800]","Body":"[STATS] [DOC] Add @StatsDoc annotation for memtable stats\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nAs part of [BP-36](https://github.com/apache/bookkeeper/issues/1785), this PR is to document the memtable stats.\r\n\r\n*Changes*\r\n\r\n- convert memtable stats to use StatsDoc for documenting metrics\r\n\r\nMaster Issue: #1785\r\n\r\n\r\n\n\nReviewers: Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1873 from sijie/memtable_stats","Date":"Thu Dec 13 15:41:34 CET 2018"},{"Commit-ID":"commit e05850aad6d0cff0dcb143e90bbbedcc88b2caef 1544712309 -----sp","Author":"PersonIdent[Jia Zhai, jiazhai@users.noreply.github.com, Thu Dec 13 22:45:09 2018 +0800]","Body":"Add get method for rest endpoint gc\n\nDescriptions of the changes in this PR:\r\n\r\nAdd get method for rest endpoint gc to get force triggered GC running status on Bookie.\r\ntrue -- force triggered GC is running on Bookie. false -- not running.\r\n\r\n### Motivation\r\n\r\nThis is base on PR #1838, and in the review comments sijie is suggested to add get methods.\r\n\r\n### Changes\r\n\r\nAdd get method for rest endpoint gc and unit test.\r\n\r\n\r\n\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1840 from jiazhai/rest_gc_get","Date":"Thu Dec 13 15:45:09 CET 2018"},{"Commit-ID":"commit fe7bed386af725e44621b534a6c516b743a15716 1544712542 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Thu Dec 13 22:49:02 2018 +0800]","Body":"[STATS] [DOC] Add @StatsDoc annotation for db ledger storage stats\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nAs part of [BP-36](https://github.com/apache/bookkeeper/issues/1785), this PR is to document the db ledger storage stats.\r\n\r\n*Changes*\r\n\r\n- convert db ledger storage stats to use StatsDoc for documenting metrics\r\n\r\nMaster Issue: #1785\r\n\r\n\r\n\r\n\n\nReviewers: Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1874 from sijie/ldb_stats","Date":"Thu Dec 13 15:49:02 CET 2018"},{"Commit-ID":"commit c0138f3758333877739f256303722dd892663979 1544712644 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Thu Dec 13 22:50:44 2018 +0800]","Body":"[STATS] [DOC] Add @StatsDoc annotation for bookkeeper autorecovery stats\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nAs part of [BP-36](https://github.com/apache/bookkeeper/issues/1785), this PR is to document bookkeeper autorecovery stats.\r\n\r\n*Changes*\r\n\r\n- convert bookkeeper autorecovery stats to use StatsDoc for documenting metrics\r\n\r\nMaster Issue: #1785\r\n\r\n\r\n\n\nReviewers: Jia Zhai <None>\n\nThis closes #1879 from sijie/replication_stats","Date":"Thu Dec 13 15:50:44 CET 2018"},{"Commit-ID":"commit 7e047d93fc9b4407667c7a5d858dcd88a046598f 1544750906 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Fri Dec 14 09:28:26 2018 +0800]","Body":"[STATS] [DOC] Add @StatsDoc annotation for journal stats\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nAs part of [BP-36](https://github.com/apache/bookkeeper/issues/1785),\r\nthis PR is to document the journal stats.\r\n\r\n*Changes*\r\n\r\n- convert journal stats to use StatsDoc for documenting metrics\r\n\r\nMaster Issue: #1785\r\n\r\n\r\n\n\nReviewers: Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1870 from sijie/statsdoc_journal","Date":"Fri Dec 14 02:28:26 CET 2018"},{"Commit-ID":"commit 616d4c15bf85fcbe3fdfa039c8da875cc94e81f7 1544751813 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Fri Dec 14 09:43:33 2018 +0800]","Body":"BP-37: Improve configuration management for better documentation\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nOne common task in developing bookkeeper is to make sure all the configuration\r\nsettings are well documented, and the configuration file we ship in each release\r\nis in-sync with the code itself.\r\n\r\nHowever maintaining things in-sync is non-trivial. This proposal is exploring\r\na new way to manage configuration settings for better documentation.\r\n\r\nMaster Issue: #1867\r\n\r\n\r\n\r\n\n\nReviewers: Matteo Merli <mmerli@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1868 from sijie/bp37_conf_documentation","Date":"Fri Dec 14 02:43:33 CET 2018"},{"Commit-ID":"commit 1b2138fd4ecdbc4dfec00709b51e1367dfd49654 1544751911 -----sp","Author":"PersonIdent[Pasha Kuznetsov, pasha@tydbits.com, Thu Dec 13 17:45:11 2018 -0800]","Body":"Issue #1884: (@W-5697664@) dir_*_usage stats are reported as 0 ...\n\nfor read-only bookies after a restart\r\n\r\n### Motivation\r\n\r\nFixing the Issue #1884:\r\n\r\nWhen a read-only bookie is restarted it keeps reporting `dir_*_usage`\r\nstats as `0` until it becomes writable again.\r\n\r\nThis is caused by the `LedgerDirsMonitor.check` only updating\r\n`diskUsages` if there are any writable dirs, or if the total usage\r\ngoes below the low water mark, otherwise relying on previously filled\r\nvalues which are `0` after a bookie is restarted.\r\n\r\n### Changes\r\n\r\n* Change the `LedgerDirsMonitor.check` to update `diskUsages`\r\n  even when there are no writable dirs.\r\n* Add new `testLedgerDirsMonitorStartReadOnly` testing this scenario.\r\n* Simplify previous tests checking read-only since `diskUsages`\r\n  are now updated regardless if a bookie is in read-only mode.\r\n\r\njvrao reddycharan \r\n\r\n\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>, Charan Reddy Guttapalem <reddycharan18@gmail.com>\n\nThis closes #1885 from pasha-kuznetsov/issue-1884-dir-usage-ro-restart, closes #1884","Date":"Fri Dec 14 02:45:11 CET 2018"},{"Commit-ID":"commit b2e099bbc7b13f13825fe78ab009ca132cb3a9ba 1544948435 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Sun Dec 16 16:20:35 2018 +0800]","Body":"[STATS] [DOC] Add @StatsDoc annotation for garbage collector stats\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nAs part of [BP-36](https://github.com/apache/bookkeeper/issues/1785), this PR is to document gc stats.\r\n\r\n*Changes*\r\n\r\n- convert gc stats to use StatsDoc for documenting metrics\r\n\r\nMaster Issue: #1785\r\n\r\n\r\n\n\nReviewers: Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1875 from sijie/gc_stats","Date":"Sun Dec 16 09:20:35 CET 2018"},{"Commit-ID":"commit 6fa8fc3825044e05f06f4408cf5eb410a0bee163 1545052729 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Mon Dec 17 21:18:49 2018 +0800]","Body":"[STATS] [DOC] Add @StatsDoc annotation for ledger cache stats\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nAs part of [BP-36](https://github.com/apache/bookkeeper/issues/1785), this PR is to document the ledger cache stats.\r\n\r\n*Changes*\r\n\r\n- convert ledger cache stats to use StatsDoc for documenting metrics\r\n\r\nMaster Issue: #1785\r\n\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <None>\n\nThis closes #1872 from sijie/ledgercache_stats","Date":"Mon Dec 17 14:18:49 CET 2018"},{"Commit-ID":"commit bd2b16e880d172d4761461fdbf85c1bd19b24e36 1545220032 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Wed Dec 19 03:47:12 2018 -0800]","Body":"Bring back statslogger to BookKeeper client in ReplicationWorker process.\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n- https://github.com/apache/bookkeeper/commit/2837f6257baf15dc9dd9eb4bcac34596b442be33\r\nhad inadvertently removed StatsLogger to BookKeeper client instance in ReplicationWorker process.\r\nSo restore StatsLogger in BookKeeper client object.\r\n- Also introduce new config called - 'limitStatsLogging', which would be used to limit statslogging\r\nas and when needed.\r\n- currently this config is used to limit the stats from PCBC. Because if AR process is running in\r\neach Bookie node, then for each AR there will be n number of PCBCs and totally it comes out to\r\nn^2 PCBCs in the cluster. Which is unmanageable from stats collector perspective. So this config\r\nvalue can be set to true in AR config.\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1888 from reddycharan/bringbackmetricsforarprocess","Date":"Wed Dec 19 12:47:12 CET 2018"},{"Commit-ID":"commit 21d71fb9e576d95e2ff2adf7a961a2847b96a9f9 1545435611 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Sat Dec 22 07:40:11 2018 +0800]","Body":"Introduce a configuration framework for better organizing and documentating configuration settings\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nOne common task in developing bookkeeper is to make sure all the configuration\r\nsettings are well documented, and the configuration file we ship in each release\r\nis in-sync with the code itself.\r\n\r\nHowever maintaining things in-sync is non-trivial. This proposal is exploring\r\na new way to manage configuration settings for better documentation.\r\n\r\n### Changes\r\n\r\n- Introduce `ConfigKey` for defining a configuration setting key in a configuration\r\n- Introduce `ConfigKeyGroup` for grouping configuration settings together\r\n- Introduce `ConfigDef` for generating the configuration definition for a given configuration\r\n- Add a `save` method for saving a configuration definition into a configuration file\r\n\r\nMaster Issue: #1867 \r\n\r\n\r\n\n\nReviewers: Jia Zhai <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1869 from sijie/config_defs","Date":"Sat Dec 22 00:40:11 CET 2018"},{"Commit-ID":"commit 52d195700381bb3782a86e983f1a8c62d12bad2a 1545435682 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Sat Dec 22 00:41:22 2018 +0100]","Body":"Multiple calls to LedgerHandle#close should wait on actual close\n\nThe previous behaviour was to complete successfully immediately if\r\nclose had already been called on the handle. This allowed for\r\npotential consistency violations, as the caller could believe that the\r\nledger was closed, when in fact the close operation was still in\r\nprogress and could still potentially fail.\r\n\r\nIssue: #1712\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1889 from ivankelly/double-close-anomoly","Date":"Sat Dec 22 00:41:22 CET 2018"},{"Commit-ID":"commit e921193b464bc86b24fa63bb71ba85ebb2d523c6 1545435876 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Sat Dec 22 00:44:36 2018 +0100]","Body":"Revert maxLedgerMetadataFormatVersion changes in layout\n\nThere is ongoing discussions about how to do this, so I'm reverting this\r\nchange for now to allow 4.9 release to proceed. The change modifies the\r\ncontents of the layout znode, so once they're in an official release they\r\ncannot be removed without breaking BC.\r\n\r\nThe reverted changes are:\r\n\r\ndd684b Ledger manager factories initialized with max metadata version\r\ndce4fd Add max ledger metadata format version to layout\r\n\r\nMaster issue: #723\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1890 from ivankelly/revert-max-format","Date":"Sat Dec 22 00:44:36 CET 2018"},{"Commit-ID":"commit ed7ca37e96639b8d7105653e971c1bd1b4533f8a 1546562497 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Thu Jan 3 16:41:37 2019 -0800]","Body":"ISSUE #1892: ILS: reset retry in consistency check loop\n\nThis patch additionally:\r\n- modifies InterleavedLedgerStorageTest.java to test with and without\r\n  entryLogPerLedger\r\n- refactors the test a bit to ensure that the gc calls really do race\r\n  with the right part of the checker\r\n- addresses a few other more cosmetic errors\r\n\r\n(bug W-5721713)\r\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1894 from athanatos/forupstream/wip-1892, closes #1892","Date":"Fri Jan 04 01:41:37 CET 2019"},{"Commit-ID":"commit e4265470881431fb7a78c8ab714c237239169e12 1546904512 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon Jan 7 15:41:52 2019 -0800]","Body":"Allow to configure BK for low latency busy-wait settings\n\n### Motivation\r\n\r\nAdded `enableBusyWait` configuration option to turn on CPU Affinity and busy wait on sockets and queues.\r\n\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1812 from merlimat/configure-busy-poll","Date":"Tue Jan 08 00:41:52 CET 2019"},{"Commit-ID":"commit 1a66de0f1841309390261e90d8d0d0af7aa2ede6 1546978569 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Jan 8 12:16:09 2019 -0800]","Body":"Configure Netty allocator in bookie and client\n\n### Motivation\r\n\r\nThis is based on #1754. Adding the code to configure and use the allocator wrapper in bookie and client.\r\n\r\n(I'll rebase once the first PR is merged)\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1755 from merlimat/use-allocator","Date":"Tue Jan 08 21:16:09 CET 2019"},{"Commit-ID":"commit 4c8587715104cde6dbd70d1e7de0fc1853122eda 1546992768 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Jan 8 16:12:48 2019 -0800]","Body":"Allow to configure sticky reads\n\n### Motivation\r\n\r\nCurrently the BK client is issuing the read requests in round-robin fashion across all the bookies in the write set.\r\n\r\nOne issue with this approach is that it's not taking full advantage of the read-ahead cache, either explicit (like in `DbLedgerStorage`) or implicit (by reading data through Linux page cache which will do some prefetching).\r\n\r\nWith `e=2`, `w=2`, when we read `e-0` from `bookie-1` and `e-1` from `bookie-2`, we fail to take advantage of the fact that `bookie-1` will have already `e-1` in memory.\r\n\r\nEffectively with `e-2`, `w-2` the disk read IO will be doubled, compared to the amount of data served to BK clients. The larger the quorum, the bigger will be overhead (eg: `e=5`, `w=5` will lead to 5x reads from disk).\r\n\r\n### Changes\r\n\r\nAdded a BK client flag for \"sticky reads\". When reading from a ledger that has `E=W` (every bookie has all the entries), the sticky reads will direct all read request to 1 single bookie in the ensemble.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1808 from merlimat/single-bookie-per-ledger-read-master","Date":"Wed Jan 09 01:12:48 CET 2019"},{"Commit-ID":"commit 42fe1506afe04b8068b897c530c7ca7188da503e 1547345075 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Sat Jan 12 18:04:35 2019 -0800]","Body":"Enhance EnsemblePlacementPolicy and DNSResolverDecorator to log relevant metrics.\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n\r\nMake changes to EnsemblePlacementPolicy so that it would return boolean value indicating\r\nif the return value of newEnsemble and replaceBookie are strictly adhering to corresponding\r\nPlacementPolicy or it fell back to random.\r\n\r\nSimilarly DNSResolverDecorator should log a metric when it was unable to resolve rack info and\r\nit is using default rack.\r\n\r\n\n\nReviewers: Samuel Just <sjust@salesforce.com>, Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1883 from reddycharan/enhanceplacementpolicy","Date":"Sun Jan 13 03:04:35 CET 2019"},{"Commit-ID":"commit d00491bc103dd85fb60307257bc2ad6d44f3118f 1547641452 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Wed Jan 16 13:24:12 2019 +0100]","Body":"Make Spotbugs pass on JDK11\n\nDescriptions of the changes in this PR:\r\n- upgrade spotbugs to 3.1.8\r\n- disable spotbugs on JDK11 (due to for https://github.com/spotbugs/spotbugs/issues/756)\r\n\r\n### Motivation\r\n\r\nThis change is on the way to give full \"official\" support do JDK11\r\n\r\n### Changes\r\n\r\n- upgrade spotbugs to 3.1.8\r\n- fix new spotbugs issues\r\n- disable spotbugs on JDK11 (due to for https://github.com/spotbugs/spotbugs/issues/756)\r\n\r\n\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1849 from eolivelli/fix/ci-java11","Date":"Wed Jan 16 13:24:12 CET 2019"},{"Commit-ID":"commit 55c6a66bf06b1b29cb9e76c82d150d0f0412422f 1547684613 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Thu Jan 17 01:23:33 2019 +0100]","Body":"Move Jobs from Obsolete JDK9 to JDK11\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n- create new jobs for JDK 11\r\n- disable spotbugs on JDK 11 on CI\r\n- drop jdk9 and jdk10 from Travis\r\n\r\n\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1903 from eolivelli/fix/ci-jdk11-part1","Date":"Thu Jan 17 01:23:33 CET 2019"},{"Commit-ID":"commit 534366536ea8180b405ad430604389a8948cf42f 1547684804 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Jan 16 16:26:44 2019 -0800]","Body":"Binary metadata format\n\nThis patch adds a binary metadata format and bumps the metadata format\r\nversion to 3. The contents of the binary metadata is the same as the\r\ncontents of the text format for now. The difference is that the binary\r\nis more compact, and the fields can be added to the metadata when\r\nusing the binary format, which isn't possible with the text\r\nformat. With the text format, parsing with a client that didn't\r\nrecognise the new field would fail.\r\n\r\nFor now, the text format (version 2) is still used by default. We will\r\nprovide a tool to allow administrators to bump to version 3.\r\n\r\nSome tests have been modified to provide digest and password to the\r\nbuilder. All protobuf metadata in released versions has had digest and\r\npassword (first protobuf metadata was in release-4.2.0). So if new\r\nmetadata is created or read with version 2, it will have this two\r\nfields set.\r\n\r\nMaster issue: #723\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1866 from ivankelly/binary-metadata","Date":"Thu Jan 17 01:26:44 CET 2019"},{"Commit-ID":"commit 58b9d284dbe8bd67d67e62d3be412db88a4d1a85 1547724866 -----sp","Author":"PersonIdent[Hervé Boutemy, herve.boutemy@free.fr, Thu Jan 17 12:34:26 2019 +0100]","Body":"replace default source-release-assembly by bookkeeper-dist\n\nfix for #1895\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1904 from hboutemy/master","Date":"Thu Jan 17 12:34:26 CET 2019"},{"Commit-ID":"commit dcdd1e887ef01f7515053f7eb06f8479de8700ff 1548060899 -----sp","Author":"PersonIdent[Huang,Dongfa, huangdongfa01@gmail.com, Mon Jan 21 16:54:59 2019 +0800]","Body":"Small fix wrong nodesUninitialized count when checkCovered\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nSince count `nodesUninitialized` is always 0,\r\nthere is no wait if we haven't seen any OK responses and there are still nodes not heard from\r\n\r\n### Changes\r\n\r\nCorrect  nodesUninitialized count and add a related testcase\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1900 from huangdongfa/fix-error-nodesUninitialized","Date":"Mon Jan 21 09:54:59 CET 2019"},{"Commit-ID":"commit 19a598eb8273cf197bb7ebf373b070c03977d5f6 1548060982 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Jan 21 00:56:22 2019 -0800]","Body":"HTTP GetMetaService returns JSON rather than calling #serialize\n\nOnce the binary ledger metadata serializing is available, the output\r\nof GetMetaService would no longer be understandable. In preparation\r\nfor this, make GetMetaService use output JSON, rather than directly\r\ncalling #serialize.\r\n\r\nMaster issue: #723\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1864 from ivankelly/get-to-string","Date":"Mon Jan 21 09:56:22 CET 2019"},{"Commit-ID":"commit 2a2f77527628b060f7eca107f9a1a4c885cd3081 1548061349 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jan 21 01:02:29 2019 -0800]","Body":"[maven-release-plugin] prepare branch branch-4.9\n","Date":"Mon Jan 21 10:02:29 CET 2019"},{"Commit-ID":"commit 8c24f94e171d20c65c21887131c32862c9e5af29 1548061359 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jan 21 01:02:39 2019 -0800]","Body":"[maven-release-plugin] prepare for next development iteration\n","Date":"Mon Jan 21 10:02:39 CET 2019"},{"Commit-ID":"commit ff8147fabe6a10563849c753e97037698e37aee9 1548124297 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Mon Jan 21 18:31:37 2019 -0800]","Body":"[BUILD] Fix master build after release 4.9.0\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nwhen creating branch-4.9, maven release plugin doesn't bump the version for stream modules.\r\n\r\n*Modifications*\r\n\r\nrun `mvn versions:set` to manually fix the version for all modules\r\n\r\n\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>\n\nThis closes #1909 from sijie/fix_master_build","Date":"Tue Jan 22 03:31:37 CET 2019"},{"Commit-ID":"commit b1f840e5d35d64d29bedbd0f6c6a9c39f08c040a 1548124751 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Mon Jan 21 18:39:11 2019 -0800]","Body":"[RELEASE] Release table service python client\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nUpdate the table service python client version to release version\r\n\r\n*Modifications*\r\n\r\nBump the version to 4.9.0\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1906 from sijie/release_python_client","Date":"Tue Jan 22 03:39:11 CET 2019"},{"Commit-ID":"commit 5b737b037e2c771a2e8c9f2de3bbcc6812b80b2b 1548125278 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Mon Jan 21 18:47:58 2019 -0800]","Body":"[RELEASE] add bkctl package to release scripts\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n\r\n*Motivation*\r\n\r\nstarting from bookkeeper 4.9.0, a separate tool package `bkctl` is released.\r\n\r\n*Modifications*\r\n\r\nadd bkctl into release scripts\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1907 from sijie/include_bkctl_package","Date":"Tue Jan 22 03:47:58 CET 2019"},{"Commit-ID":"commit 615f96701a461160d6d246e5387668b0e3406609 1548190869 -----sp","Author":"PersonIdent[eolivelli, eolivelli@apache.org, Tue Jan 22 22:01:09 2019 +0100]","Body":"fix/pair\n","Date":"Tue Jan 22 22:01:09 CET 2019"},{"Commit-ID":"commit 3d2a1d9f6cf1de158054e8af242823a29b92e4e8 1548190919 -----sp","Author":"PersonIdent[eolivelli, eolivelli@apache.org, Tue Jan 22 22:01:59 2019 +0100]","Body":"Revert \"fix/pair\"\n\nThis reverts commit 615f96701a461160d6d246e5387668b0e3406609.\n","Date":"Tue Jan 22 22:01:59 CET 2019"},{"Commit-ID":"commit 03e7d6e48822e656d6b652359f780f0cb1513bc1 1548389256 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Thu Jan 24 20:07:36 2019 -0800]","Body":"[TABLE SERVICE] bump python client version to 4.10.0-SNAPSHOT\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Modifications*\r\n\r\nBump the development of python client to 4.10.0-SNAPSHOT\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1911 from sijie/bump_python_client_development","Date":"Fri Jan 25 05:07:36 CET 2019"},{"Commit-ID":"commit 737f92b2782fc0d027c51ea6bf88cb6b802398db 1548389350 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Jan 25 05:09:10 2019 +0100]","Body":"Add semantically meaningful return values to placement policy\n\nCurrently newEnsemble and replaceBookie in EnsemblePlacementPolicy\r\nreturn a apache commons Pair<> with the second argument being a\r\nboolean to denote whether the placement conforms strictly to the\r\npolicy. From calling code, the meaning of this second value is\r\nunclear.\r\n\r\nThis patch replaces Pair<> with an PlacementResult object, in which\r\nthe strict conformity argument is clearly labels. This will also allow\r\nextension in the future to return more metadata about particular\r\nplacements.\r\n\r\nAlso, we shouldn't put third party library classes in interfaces.\r\n\r\nIssue:  #1914\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Charan Reddy Guttapalem <reddycharan18@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1916 from ivankelly/meaningful-placement-res","Date":"Fri Jan 25 05:09:10 CET 2019"},{"Commit-ID":"commit d8b894f3a1a60e6df2071e8d8ca89e3e02ba222a 1548929829 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Thu Jan 31 02:17:09 2019 -0800]","Body":"Ignore usage of localNode in PlacementPolicy.\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n'ignoreLocalNodeInPlacementPolicy' specifies whether to ignore localnode\r\nin the internal logic of placement policy. If it is not possible or useful\r\nto use Bookkeeper client node's (or AutoReplicator) rack/region info. for\r\nplacement policy then it is better to ignore localnode instead of false\r\nalarming with error/warn log lines and metrics.\r\n\r\nIt is not valid to expect rack mapping information to be available for Bookkeeper\r\nclient and ReplicationWorker nodes. So if rackmapping info. is not available\r\nthen it is better to ignore creation of BookieNode by resolving rack information\r\nfor the client localnode. Otherwise it would log unnecessary warn/error log lines\r\nand rack resolution failure metrics.\n\nReviewers: Sijie Guo <sijie@apache.org>, Jia Zhai <zhaijia@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1917 from reddycharan/ignorelocalnodeinplacementpolicy","Date":"Thu Jan 31 11:17:09 CET 2019"},{"Commit-ID":"commit 2755784bac9af0a48b3c8a0af0cee63d730640aa 1549036332 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Fri Feb 1 23:52:12 2019 +0800]","Body":"[RELEASE] Update website to include documentation for 4.9.0\n\n\r\n\r\n\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>\n\nThis closes #1928 from sijie/update_website_490","Date":"Fri Feb 01 16:52:12 CET 2019"},{"Commit-ID":"commit 1da10f8cfaa7ad2bd132f7136291e20ce2d97d5c 1549036399 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Fri Feb 1 23:53:19 2019 +0800]","Body":"[RELEASE] Update Dockerfile to 4.9.0\n\n\r\n\r\n\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>\n\nThis closes #1929 from sijie/update_docker_file","Date":"Fri Feb 01 16:53:19 CET 2019"},{"Commit-ID":"commit a79cd081114ed45d2e0121d524ea1b710d7d2452 1549050184 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Fri Feb 1 11:43:04 2019 -0800]","Body":"PlacementPolicy checker validating EnsemblePlacementpolicy\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n- As described in BP-34,\r\nhttps://github.com/apache/bookkeeper/blob/master/site/bps/BP-34-cluster-metadata-checker.md,\r\nthis change introduces new checker - cluster-metadata-checker with initial responsibility\r\nof validating the EnsemblePlacementpolicy of segments of ledgers (which are writeclosed/fenced).\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1902 from reddycharan/placementpolicyscrutiny","Date":"Fri Feb 01 20:43:04 CET 2019"},{"Commit-ID":"commit 4868b55e6fcfcbf4a5a4aa52a4e1ea7ce74f9562 1549063713 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Sat Feb 2 07:28:33 2019 +0800]","Body":"[RELEASE] Release Notes for 4.9.0\n\n\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <zhaijia@apache.org>\n\nThis closes #1910 from sijie/bk490_release_notes","Date":"Sat Feb 02 00:28:33 CET 2019"},{"Commit-ID":"commit a08defd82d412a0c7ebcec8b4eca5d5020fe7988 1549377731 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Tue Feb 5 22:42:11 2019 +0800]","Body":"[DEV] Break current ISSUE_TEMPLATE into multiple single templates\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nFollowing the Github community recommendations (https://github.com/apache/bookkeeper/community)\r\nto break down current ISSUE_TEMPLATE to multiple single templates\r\n\r\n*Modifications*\r\n\r\n- break down the `ISSUE_TEMPLATE.md` into multiple files in `ISSUE_TEMPLATE`\r\n- fix the skip phrase in PULL_REQUEST_TEMPLATE\r\n\r\n\r\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1933 from sijie/fix_pull_request_templates","Date":"Tue Feb 05 15:42:11 CET 2019"},{"Commit-ID":"commit 9132659d5c0fa17d04109fad0841ffe637fc40f7 1549676036 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Sat Feb 9 09:33:56 2019 +0800]","Body":"Bump Netty and GRPC version\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nWhen we bumped Netty's version, we didn't bump the gRPC version.\r\nSo the gRPC version has become very old.\r\n\r\n*Modifications*\r\n\r\nBump both gRPC and Netty version to make them aligned with each other.\r\n\r\n\r\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1934 from sijie/bump_grpc_version","Date":"Sat Feb 09 02:33:56 CET 2019"},{"Commit-ID":"commit ec6ba500163b9f0b10d4597365d27e162281193b 1549676190 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Fri Feb 8 17:36:30 2019 -0800]","Body":"fix invalid formatter xml\n\n### Motivation\r\n\r\n`formatter.xml` is an invalid xml and eclipse fails to load it.\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1939 from rdhabalia/format_xml","Date":"Sat Feb 09 02:36:30 CET 2019"},{"Commit-ID":"commit 8c7c377d4ee726ad932dbe6463f5c7c993832536 1549676306 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Sat Feb 9 09:38:26 2019 +0800]","Body":"[WEBSITE] Update release schedule for 4.10.0\n\n\r\n\r\n\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>\n\nThis closes #1932 from sijie/update_release_schedule","Date":"Sat Feb 09 02:38:26 CET 2019"},{"Commit-ID":"commit 0f8322181a0e83bc9bb3b1821736865359ac93ab 1550025111 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Wed Feb 13 10:31:51 2019 +0800]","Body":"[DOC] Add python client release instructions to release guide\n\n\r\n\r\n\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1942 from sijie/update_instructions_on_publish_pythonclient","Date":"Wed Feb 13 03:31:51 CET 2019"},{"Commit-ID":"commit d511f590c15dd86345719ba842bd373411c6da49 1550329194 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Sat Feb 16 06:59:54 2019 -0800]","Body":"[BK-GC] Fix GC thread gets blocked\n\n### Motivation\r\n\r\nIt addresses below thread-stuck while performing gc in bookie.\r\n\r\n```\r\nThread 3363: (state = BLOCKED)\r\n - java.lang.Object.wait(long) bci=0 (Compiled frame; information may be imprecise)\r\n - java.lang.Object.wait() bci=2, line=502 (Compiled frame)\r\n - org.apache.bookkeeper.util.ZkUtils.getChildrenInSingleNode(org.apache.zookeeper.ZooKeeper, java.lang.String) bci=34, line=243 (Compiled frame)\r\n - org.apache.bookkeeper.meta.LongHierarchicalLedgerManager$LongHierarchicalLedgerRangeIterator.getChildrenAt(java.lang.String) bci=8, line=165 (Compiled fr\r\name)\r\n - org.apache.bookkeeper.meta.LongHierarchicalLedgerManager$LongHierarchicalLedgerRangeIterator$LeafIterator.<init>(org.apache.bookkeeper.meta.LongHierarchic\r\nalLedgerManager$LongHierarchicalLedgerRangeIterator, java.lang.String) bci=11, line=187 (Compiled frame)\r\n - org.apache.bookkeeper.meta.LongHierarchicalLedgerManager$LongHierarchicalLedgerRangeIterator$InnerIterator.advance() bci=137, line=261 (Compiled frame)\r\n - org.apache.bookkeeper.meta.LongHierarchicalLedgerManager$LongHierarchicalLedgerRangeIterator$InnerIterator.next() bci=28, line=281 (Compiled frame)\r\n - org.apache.bookkeeper.meta.LongHierarchicalLedgerManager$LongHierarchicalLedgerRangeIterator$InnerIterator.next() bci=4, line=278 (Compiled frame)\r\n - org.apache.bookkeeper.meta.LongHierarchicalLedgerManager$LongHierarchicalLedgerRangeIterator$InnerIterator.next() bci=4, line=278 (Compiled frame)\r\n - org.apache.bookkeeper.meta.LongHierarchicalLedgerManager$LongHierarchicalLedgerRangeIterator$InnerIterator.next() bci=4, line=278 (Compiled frame)\r\n - org.apache.bookkeeper.meta.LongHierarchicalLedgerManager$LongHierarchicalLedgerRangeIterator.next() bci=8, line=304 (Compiled frame)\r\n - org.apache.bookkeeper.meta.HierarchicalLedgerManager$HierarchicalLedgerRangeIterator.next() bci=26, line=117 (Compiled frame)\r\n - org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector.gc(org.apache.bookkeeper.bookie.GarbageCollector$GarbageCleaner) bci=195, line=168 (Compiled frame)\r\n - org.apache.bookkeeper.bookie.GarbageCollectorThread.doGcLedgers() bci=8, line=393 (Compiled frame)\r\n - org.apache.bookkeeper.bookie.GarbageCollectorThread.runWithFlags(boolean, boolean, boolean) bci=39, line=355 (Compiled frame)\r\n - org.apache.bookkeeper.bookie.GarbageCollectorThread.safeRun() bci=28, line=333 (Compiled frame)\r\n - org.apache.bookkeeper.common.util.SafeRunnable.run() bci=1, line=36 (Compiled frame)\r\n - java.util.concurrent.Executors$RunnableAdapter.call() bci=4, line=511 (Compiled frame)\r\n - java.util.concurrent.FutureTask.runAndReset() bci=47, line=308 (Compiled frame)\r\n - java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask) bci=1, line=180 (Compiled frame)\r\n - java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run() bci=37, line=294 (Compiled frame)\r\n - java.util.concurrent.ThreadPoolExecutor.runWorker(java.util.concurrent.ThreadPoolExecutor$Worker) bci=95, line=1142 (Compiled frame)\r\n - java.util.concurrent.ThreadPoolExecutor$Worker.run() bci=5, line=617 (Interpreted frame)\r\n - io.netty.util.concurrent.FastThreadLocalRunnable.run() bci=4, line=30 (Interpreted frame)\r\n - java.lang.Thread.run() bci=11, line=748 (Interpreted frame)\r\n```\r\n\r\n### Changes\r\n\r\nadd time-out to zk operation to avoid GC thread blocking.\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1937 from rdhabalia/gc_dead","Date":"Sat Feb 16 15:59:54 CET 2019"},{"Commit-ID":"commit 166be82390ff18c402647838895ba07e3372e51d 1550658243 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Wed Feb 20 02:24:03 2019 -0800]","Body":"Filter empty string for networkTopologyScriptFileName\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n- filter empty string for networkTopologyScriptFileName.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1952 from reddycharan/ignoreemptystring","Date":"Wed Feb 20 11:24:03 CET 2019"},{"Commit-ID":"commit 10272ead9d9b446aeee3d8acd5df9febfd5705c7 1550659409 -----sp","Author":"PersonIdent[Samuel Just, sjust@salesforce.com, Wed Feb 20 02:43:29 2019 -0800]","Body":"BOOKKEEPER-1919: putEntryOffset translate FileInfoDeletedException\n\nIndexInMemPageMgr should translate FileInfoDeletedException into\r\nNoLedgerException as expected by users like\r\nInterleavedLedgerStorage.updateEntriesLocations and\r\nEntryMemTable.flushSnapshot.\r\n\r\nSigned-off-by: Samuel Just <sjustsalesforce.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1950 from athanatos/forupstream/wip-1919","Date":"Wed Feb 20 11:43:29 CET 2019"},{"Commit-ID":"commit 31901ffd1041fa4cd8374aa4a32ef0ef372a8b8f 1550664660 -----sp","Author":"PersonIdent[Like, like_0903@163.com, Wed Feb 20 20:11:00 2019 +0800]","Body":"[DOC] Fix command path in documents\n\nCloses #1556\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1948 from liketic/fix-cmd-dir","Date":"Wed Feb 20 13:11:00 CET 2019"},{"Commit-ID":"commit 49135b6b48a45a5fbc1fd8696dd595e4dc832da8 1550781674 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Thu Feb 21 12:41:14 2019 -0800]","Body":"Exclude defaultrack bookies when enforceMinNumRacksPerWriteQuorum is enabled\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n- enforceMinNumRacksPerWriteQuorum is meant to be used for strict placement policy. So when\r\nit is enabled, bookies which belong to default faultzone/rack (because of failure in resolving\r\nnetwork location) should be excluded from bookie selection.\r\n- add gauge for number of bookies in default faultzone/rack. It will be helpful to create alerts\r\nbased on this gauge.\r\n- add gauge for number of ledgers found not adhering to strict placement policy in Auditor's\r\nplacement policy check. This gauge will be more helpful in creating alert instead of using\r\nmonotonously increasing alert.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Pasha Kuznetsov <None>, Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #1941 from reddycharan/ignoredefaultzoneandfixmetrics","Date":"Thu Feb 21 21:41:14 CET 2019"},{"Commit-ID":"commit 35c9640bfdc232fb961574299981d5f85895d425 1551072900 -----sp","Author":"PersonIdent[Like, like_0903@163.com, Mon Feb 25 13:35:00 2019 +0800]","Body":"Fix obsoleted proposals document link\n\nCloses #1531 \n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1959 from liketic/fix-link","Date":"Mon Feb 25 06:35:00 CET 2019"},{"Commit-ID":"commit b829eb2e11d211cefb283c0919f2b893d30d2f35 1551072976 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Sun Feb 24 21:36:16 2019 -0800]","Body":"Log error (if any) in Shell.runCommand\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n- Log error (if any) in Shell.runCommand even in the case of successful execution\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1956 from reddycharan/printshellerror","Date":"Mon Feb 25 06:36:16 CET 2019"},{"Commit-ID":"commit 9c14476422ee865769152917405607bd330046fa 1551073219 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Sun Feb 24 21:40:19 2019 -0800]","Body":"[BOOKIE-HTTP-SERVER] Fix: broken vertx rest endpoints\n\n### Motivation\r\nRight now, vertx-http-server is not serving any rest endpoint except get because vertx server doesn't add put/post/delete http-methods into routing rules.\r\n\r\n### Modification\r\nAdd put/post/delete http-methods into routing rules.\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1953 from rdhabalia/http_ep","Date":"Mon Feb 25 06:40:19 CET 2019"},{"Commit-ID":"commit 9ad191ca0fc0bf2eaeabdc5dc796c8c53fe390a8 1551086434 -----sp","Author":"PersonIdent[Kieran Gorman, kierangorman@monzo.com, Mon Feb 25 09:20:34 2019 +0000]","Body":"[DOC] popover for 'striped' as well as 'striping'\n\nAdds a popover term for 'striped' to match 'striping'.\r\n\r\n### Motivation\r\n\r\n<img width=\"817\" alt=\"screen shot 2019-02-19 at 14 08 07\" src=\"https://user-images.githubusercontent.com/1994486/53020896-ddd07e00-344f-11e9-9327-7beb380515d7.png\">\r\n\r\nThe first \"link\" text has no pop-over, but the second does. \r\n\r\n### Changes\r\n\r\nJust copies the pop-over for striping. It seems inelegant vs. allowing multiple pop-over terms to refer to the same HTML fragment rather than being 1-1, but also is a straightforward and unobtrusive change.\r\n\r\nMaster Issue: (no issue)\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1951 from kjgorman/striped-popover","Date":"Mon Feb 25 10:20:34 CET 2019"},{"Commit-ID":"commit b689d8313654de21759b2e2d47210b75434038c3 1551252109 -----sp","Author":"PersonIdent[yong.zhang, zhangyong1025.zy@gmail.com, Wed Feb 27 15:21:49 2019 +0800]","Body":"Fix unable download twitter dependencies\n\n---\r\n\r\nFixes #1962\r\n\r\n*Motivation*\r\n\r\nThere are some twitter dependencies can't download from repo\r\n\r\n*Modifications*\r\n\r\n- remove some using in StatsLoggerBenchmark.java\r\n- update some config in pom.xml\r\n\r\nDescriptions of the changes in this PR:\r\n\r\nYou can add -Dtwitter to choose add twitter dependencies.\r\n\r\n### Motivation\r\n\r\n(Explain: why you're making that change, what is the problem you're trying to solve)\r\n\r\n### Changes\r\n\r\n(Describe: what changes you have made)\r\n\r\nMaster Issue: #1962\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <zhaijia@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1966 from zymap/master","Date":"Wed Feb 27 08:21:49 CET 2019"},{"Commit-ID":"commit 4e32ef618fd3b6a60d9ff7f78ea40c8d11464d96 1551253066 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Tue Feb 26 23:37:46 2019 -0800]","Body":"Add http method test for vertx-http server\n\n### Motivation\r\n\r\nAs discussed at #1953, adding test to verify all http-method works for vertx-http-server.\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1963 from rdhabalia/gc_test","Date":"Wed Feb 27 08:37:46 CET 2019"},{"Commit-ID":"commit 756cae7462919f03c7eea9dcf2985a1a6fdc64cd 1551253845 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Tue Feb 26 23:50:45 2019 -0800]","Body":"Use conf value in RackawareEnsemblePlacementPolicyImpl.initialize method\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n- Use conf value in RackawareEnsemblePlacementPolicyImpl.initialize method,\r\ninstead of uninitialized enforceMinNumRacksPerWriteQuorum variable\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1964 from reddycharan/fixexceptioncondition","Date":"Wed Feb 27 08:50:45 CET 2019"},{"Commit-ID":"commit b67e8b262e3dbf77a7ef5f13c2e22bd191c85d00 1551366801 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Thu Feb 28 23:13:21 2019 +0800]","Body":"[PYTHON] Fix python client version\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\npip doesn't work with '-SNAPSHOT'. Use `-alpha-0` instead of `-SNAPSHOT` for python.\r\n\r\n*Modifications*\r\n\r\n- update setup.py file\r\n- update release guide\r\n\r\n\r\n\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>\n\nThis closes #1954 from sijie/fix_python_version","Date":"Thu Feb 28 16:13:21 CET 2019"},{"Commit-ID":"commit 73f36a2272ef061444fcb871976ef89c5ca9ded8 1551540053 -----sp","Author":"PersonIdent[Like, like_0903@163.com, Sat Mar 2 23:20:53 2019 +0800]","Body":"Use automatic resource management to close streams\n\nWe can use automatic resource management introduced in java 7, which makes code shorter.\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1958 from liketic/use-resource","Date":"Sat Mar 02 16:20:53 CET 2019"},{"Commit-ID":"commit 629230cb13a7ccb1211343dbb0a8bfe7a674ed96 1551626099 -----sp","Author":"PersonIdent[Like, like_0903@163.com, Sun Mar 3 23:14:59 2019 +0800]","Body":"Use the same thread to monitor ledger and index directories\n\nCloses #1655 \n\nReviewers: Charan Reddy Guttapalem <reddycharan18@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1957 from liketic/reduce-monitor-threads","Date":"Sun Mar 03 16:14:59 CET 2019"},{"Commit-ID":"commit db5d7e7cf30d58c9c463ce29c7d7900115717206 1551772163 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Mar 5 08:49:23 2019 +0100]","Body":"[DLOG] Avoid double read in readahead\n\nThere was a bug in the ReadAheadReader whereby, if it was in a paused\r\nstate and the last segment it had read had been closed, then when a\r\nwriter started writing new segments, the ReadAheadReader would issue a\r\ndouble read. This would end up triggering an error when it got to the\r\nend of the segment as the issued one of the issued reads would then be\r\ncancelled when the segment was closed.\r\n\r\nThis fix adds an explicit state machine to the reader and moves all\r\nstate transitions to run on the ordered executor, so only one read can\r\never be issued at a time.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1973 from ivankelly/dlog-reader-crash-master","Date":"Tue Mar 05 08:49:23 CET 2019"},{"Commit-ID":"commit 2576afdbe460e76047999725bd5988486ccf378e 1551810424 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Tue Mar 5 10:27:04 2019 -0800]","Body":"Add validateConf to AbstractDNSToSwitchMapping\n\nDescriptions of the changes in this PR:\r\n\r\n- when setConf of AbstractDNSToSwitchMapping  is called it\r\nshould do sanity checking of the conf/env. and throw\r\nRuntimeException if things are not valid.\r\n- For RawScriptBasedMapping.validateConf, try executing\r\nthe script with no arguments for sanity check purpose.\r\nHere it is expected that running script with no arguments\r\nwould do sanity check of the script and the env.\r\n\r\n(there are 2 commits in this PR, but this PR is meant for the second commit and there is other PR for the first commit)\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1965 from reddycharan/sanitycheckmappingconf","Date":"Tue Mar 05 19:27:04 CET 2019"},{"Commit-ID":"commit 6b602f77883ceaf926e8246ba622c54d048b55a3 1552213947 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Sun Mar 10 18:32:27 2019 +0800]","Body":"Migrate command `bookieinfo` to bkctl\n\n### Motivation\r\n\r\nMigrate command `bookieinfo` to bkctl.\r\n\r\n### Changes\r\n\r\nYou can execute as `bin/bkctl bookie  info`.\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1972 from zymap/yongzhang/command_info","Date":"Sun Mar 10 11:32:27 CET 2019"},{"Commit-ID":"commit 5a3448860be585972aa328aa1602b63ead177269 1552269455 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Mon Mar 11 09:57:35 2019 +0800]","Body":"Migrate command `bookieformat`\n\nDescriptions of the changes in this PR:\r\n\r\nMigrate command `bookieformat`.\r\n\r\n### Motivation\r\n\r\n#1974 \r\n\r\n### Changes\r\n\r\n- Add command `bookieformat` to bkctl\r\n- Replace command in shell\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1975 from zymap/command-bookieformat and squashes the following commits:\n\n90e8a1dde [Yong Zhang] Add doc\ne079383ac [Yong Zhang] Fix the way deal with exception\neb78fe74f [Yong Zhang] Add unit test for `commandformat`\na3bafe6d9 [Yong Zhang] Migrate command `bookieformate` to bkctl","Date":"Mon Mar 11 02:57:35 CET 2019"},{"Commit-ID":"commit 009eb5d5ba5c4269235aa6727a9e50fe87afbdfe 1552408243 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Wed Mar 13 00:30:43 2019 +0800]","Body":"Issue #1977: Migrate command 'bookieinit'\n\nDescriptions of the changes in this PR:\r\n\r\nMigrate command `bookieinit` from shell to bkctl\r\n\r\n### Motivation\r\n\r\n Issue #1977 \r\n\r\n### Changes\r\n\r\n- Replace command `bookieinit` in shell\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1978 from zymap/command-bookieinit, closes #1977","Date":"Tue Mar 12 17:30:43 CET 2019"},{"Commit-ID":"commit f4cbf8a395150e4ea360ef2c8b1cfa95d6d0625f 1552540763 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Mar 14 06:19:23 2019 +0100]","Body":"Tool to search and replace bookie ids in ledger metadata\n\nTo use:\r\n```\r\nbin/bkctl bookieid searchreplace --from <from> --to <to>\r\n```\r\n\r\nTo be used in cases where the DNS name of the bookie has to change, and you don't want all the data to have to be moved by autorecovery.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <zhaijia@apache.org>\n\nThis closes #1968 from ivankelly/bk-replace-bookieid","Date":"Thu Mar 14 06:19:23 CET 2019"},{"Commit-ID":"commit fa90f0185c51e8f842148945e4958cbc02cbe023 1552632993 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Fri Mar 15 14:56:33 2019 +0800]","Body":"Issue #1980: Migrate command `ledger` from shell to bkctl\n\nDescriptions of the changes in this PR:\r\n\r\nMigrate command `ledger` from shell to bkctl\r\n\r\n### Motivation\r\n\r\n#1980 \r\n\r\n### Changes\r\n\r\n- Add new implement for `ledger`\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1981 from zymap/command-ledger, closes #1980","Date":"Fri Mar 15 07:56:33 CET 2019"},{"Commit-ID":"commit 8cc7239ac95ea1673b188d57a89aa39d4ecd3c8f 1552896687 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Mon Mar 18 16:11:27 2019 +0800]","Body":"Issue #1982: Migrate command `bookiesanity`\n\nDescriptions of the changes in this PR:\r\n\r\n- migrate command `bookiesanity`\r\n\r\n### Changes\r\n\r\n- use command by `bkctl bookie sanity`\r\n\r\nMaster Issue: #1982 \r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1983 from zymap/command-bookiesanity, closes #1982","Date":"Mon Mar 18 09:11:27 CET 2019"},{"Commit-ID":"commit ec2636cd2e3285eefc1eabc2634e5b5576fe81b8 1553009920 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Tue Mar 19 23:38:40 2019 +0800]","Body":"Issue #1985: Migrate command `convert-to-db-storage`\n\n*Motivation*\r\n\r\n- Use bkctl to run command `convert-to-db-storage`\r\n\r\n*Modifications*\r\n\r\n- #1985 \r\n- Add command in `bookieGroup`\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1986 from zymap/command-ctdb, closes #1985","Date":"Tue Mar 19 16:38:40 CET 2019"},{"Commit-ID":"commit f26a4cae0e9205ad391c6d4d79f2937871864c28 1553073562 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Mar 20 10:19:22 2019 +0100]","Body":"Release notes for v4.8.2\n\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <zhaijia@apache.org>\n\nThis closes #1976 from ivankelly/v4.8.2-relnotes","Date":"Wed Mar 20 10:19:22 CET 2019"},{"Commit-ID":"commit 468743e7e45ce5a862ddef41de0e4b87d988402a 1553481807 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sun Mar 24 19:43:27 2019 -0700]","Body":"In DbLedgerStorage use default values when config key is present but empty\n\n### Motivation\r\n\r\nCurrently setting the `dbStorage_writeCacheMaxSizeMb=` with empty value is making the\r\nDbLedgerStorage initialize to fail since the empty string is being parsed as long. \r\n\r\nInstead, we should just apply the default value as in the case where the config key is not there.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <zhaijia@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1996 from merlimat/db-storage-config","Date":"Mon Mar 25 03:43:27 CET 2019"},{"Commit-ID":"commit 4de5983793707e764c8dc604cfb6308748664677 1553482213 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Mon Mar 25 10:50:13 2019 +0800]","Body":"Issue #1987: Migrate command `convert-to-interleaved-storage`\n\nDescriptions of the changes in this PR:\r\n\r\n- Migrate command `convert-to-interleaved-storage`\r\n\r\n### Motivation\r\n\r\n- #1987 \r\n- Use `bkctl` to run command `convert-to-interleaved-storage`\r\n\r\n### Changes\r\n\r\n- Add command in `bookiegroup`\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1988 from zymap/command-ctis, closes #1987","Date":"Mon Mar 25 03:50:13 CET 2019"},{"Commit-ID":"commit 1448d12aa6399b64d272b9d3f820fbf128cb371e 1553483656 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Mon Mar 25 11:14:16 2019 +0800]","Body":"Migrate command `listfilesondisk`\n\nDescriptions of the changes in this PR:\r\n\r\n- Replace command `listfilesondisk` \r\n\r\n### Motivation\r\n\r\n- Use `bkctl` to run command `listfilesondisk`\r\n- #1989 \r\n### Changes\r\n\r\n- Add command in `bkctl`\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1990 from zymap/command-listfilesondisc and squashes the following commits:\n\n922e2b70a [Sijie Guo] Merge branch 'master' into command-listfilesondisc\n8d72a00bd [Yong Zhang] Migrate command `listfilesondisk`","Date":"Mon Mar 25 04:14:16 CET 2019"},{"Commit-ID":"commit 6aa73ce050feb247f491a489a42f6e3db09961cf 1553610443 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Tue Mar 26 15:27:23 2019 +0100]","Body":"[RELEASE] Update website to include documentation for 4.8.2\n\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #1993 from ivankelly/482site","Date":"Tue Mar 26 15:27:23 CET 2019"},{"Commit-ID":"commit 5902ee27be2fb7eeade53f5e8e4afd3fe573ad5c 1553610834 -----sp","Author":"PersonIdent[Boyang Jerry Peng, jerry.boyang.peng@gmail.com, Tue Mar 26 09:33:54 2019 -0500]","Body":"fix potential NPE when releasing entry that is null\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\nA interrupt exception can occur during the poll operation of the blocking and cause a NPE to be thrown\r\n\r\n### Changes\r\nCheck if entry is null before trying to release it\r\n\n\nReviewers: Ivan Kelly <ivank@apache.org>, Sijie Guo <sijie@apache.org>, Matteo Merli <mmerli@apache.org>\n\nThis closes #1998 from jerrypeng/fix_NPE","Date":"Tue Mar 26 15:33:54 CET 2019"},{"Commit-ID":"commit e35a108c7a47d746d5010ee5178712496741cc18 1553663477 -----sp","Author":"PersonIdent[Like, like_0903@163.com, Wed Mar 27 13:11:17 2019 +0800]","Body":"Fix error message for unrecognized number-of-bookies\n\nCloses #1925 \n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1997 from liketic/fix-issue-1925","Date":"Wed Mar 27 06:11:17 CET 2019"},{"Commit-ID":"commit 6c3f33f55fc3754925323b1d077108331d027aaf 1553700948 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Wed Mar 27 23:35:48 2019 +0800]","Body":"Fix when met unexpect entry id crashed\n\n\r\nFixes #2001\r\n\r\n*Motivation*\r\n\r\nWhen met a unexpect entry id, db indexes failed cleanup.\r\n\r\n*Modifications*\r\n\r\nCatch the exception and ignore it.\r\n\r\nMaster Issue: #2001 \r\n\r\n\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Matteo Merli <mmerli@apache.org>\n\nThis closes #2002 from zymap/fixnoentryexception","Date":"Wed Mar 27 16:35:48 CET 2019"},{"Commit-ID":"commit 9524a9f4a82dd990aa437a2931bf2e5541ea0a37 1553834664 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Fri Mar 29 12:44:24 2019 +0800]","Body":"Migrate command `readjournal`\n\nDescriptions of the changes in this PR:\r\n\r\n- Use `bkctl` execute `readjournal` command\r\n\r\n### Motivation\r\n\r\n- Migrate from bookieshelll\r\n\r\n\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #2000 from zymap/command-readjournal","Date":"Fri Mar 29 05:44:24 CET 2019"},{"Commit-ID":"commit e3d807a32a0a9b69d0ac8db3ca17398373dbee28 1553834733 -----sp","Author":"PersonIdent[Like, like_0903@163.com, Fri Mar 29 12:45:33 2019 +0800]","Body":"Fix IDE complain as there are multi choices for error code\n\nThere are two ```Code``` in ```org.apache.bookkeeper.client. BKException```:\r\n\r\nThe first is https://github.com/apache/bookkeeper/blob/f26a4cae0e9205ad391c6d4d79f2937871864c28/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BKException.java#L136\r\n\r\nThe second is https://github.com/apache/bookkeeper/blob/f26a4cae0e9205ad391c6d4d79f2937871864c28/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/api/BKException.java#L180\r\n\r\nBKException's subclasses cannot auto choice which ```Code```. \r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1999 from liketic/fix-code","Date":"Fri Mar 29 05:45:33 CET 2019"},{"Commit-ID":"commit 4573285db9e027416bf33ab9b959b952d2b0e8d5 1554121189 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Mon Apr 1 14:19:49 2019 +0200]","Body":"Docker autobuild hook\n\nThis hook will allow docker autobuild to build from the offical tag\r\nand removes the need to update the dockerfile after the release has\r\nbeen made.\r\n\r\nIt also adds a build arg, DISTRO_URL which can be used for testing\r\nrelease candidates.\r\n\r\n```\r\ndocker build --build-arg BK_VERSION=4.9.1\r\n    --build-arg DISTRO_URL=<rc-tarball-url> .\r\n```\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2017 from ivankelly/docker-tag2","Date":"Mon Apr 01 14:19:49 CEST 2019"},{"Commit-ID":"commit b043d1694569a934d9f27347ec2d15180f7a95c0 1554135039 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Tue Apr 2 00:10:39 2019 +0800]","Body":"Migrate command `listledgers`\n\nDescriptions of the changes in this PR:\r\n\r\nUsing `bkctl` run command `listledgers`\r\n\r\n### Motivation\r\n\r\n#2004 \r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #2005 from zymap/command-listledgers","Date":"Mon Apr 01 18:10:39 CEST 2019"},{"Commit-ID":"commit 138a7ae8569fa36b70e03ba61c57104d6ab94f18 1554135522 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Tue Apr 2 00:18:42 2019 +0800]","Body":"Migrate command `metadataformat`\n\nDescriptions of the changes in this PR:\r\n\r\n#2031 \r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #2032 from zymap/command-metaformat","Date":"Mon Apr 01 18:18:42 CEST 2019"},{"Commit-ID":"commit 751e55fa433172422fb82556ff748c5f6f2bfc41 1554136062 -----sp","Author":"PersonIdent[Arvin, arvindevel@gmail.com, Tue Apr 2 00:27:42 2019 +0800]","Body":"ISSUE #2020: close db properly to avoid open RocksDB failure at the second time\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nIf not releasing resources of failed/closed asyncStore, new creating of the same store identifier will fail, mainly caused by RocksDBException, like #2020 shows.\r\n\r\n### Changes\r\n\r\nadd scStores to factory's instance variable at the `addstore` method of `MVCCStoreFactoryImpl` class;\r\nrelease store when open fail;\r\n\r\nDescriptions of the changes in this PR:\r\n\r\nMaster Issue: #2020 \r\n\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #2022 from ArvinDevel/issue2020, closes #2020","Date":"Mon Apr 01 18:27:42 CEST 2019"},{"Commit-ID":"commit bf66235e5bfa2aa094d17b7e555d0dd5661a6f4d 1554193943 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Tue Apr 2 16:32:23 2019 +0800]","Body":"Migrate command `deleteledger`\n\nDescriptions of the changes in this PR:\r\n\r\n#2025 \r\n\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #2026 from zymap/command-deleteledger","Date":"Tue Apr 02 10:32:23 CEST 2019"},{"Commit-ID":"commit 120d67737f894c8c9ce5d7954c697015f8e7b1e2 1554194343 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Tue Apr 2 16:39:03 2019 +0800]","Body":"Migrate command `lostbookierecoverydelay`\n\nDescriptions of the changes in this PR:\r\n\r\n- Using `bkctl` run command `lostbookierecoverydelay`\r\n\r\n### Motivation\r\n\r\n#2015 \n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #2016 from zymap/command-lostbookierecoverydelay","Date":"Tue Apr 02 10:39:03 CEST 2019"},{"Commit-ID":"commit c391fe58dfdb283e54d809a8d24200c9a34d5dfc 1554229274 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Wed Apr 3 02:21:14 2019 +0800]","Body":"Migrate command `readlogmetadata`\n\nDescriptions of the changes in this PR:\r\n\r\n#2038 \n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #2039 from zymap/command-readlogmetadata","Date":"Tue Apr 02 20:21:14 CEST 2019"},{"Commit-ID":"commit 6a6d7bbd995acd55389ec209e42e099647c988fd 1554229996 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Wed Apr 3 02:33:16 2019 +0800]","Body":"Migrate command `initnewcluster`\n\nDescriptions of the changes in this PR:\r\n\r\n#2046 \n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #2047 from zymap/command-initnewcluster","Date":"Tue Apr 02 20:33:16 CEST 2019"},{"Commit-ID":"commit 0988e12c7a12e1ffae2cdbe932ba414ec06f40cc 1554230123 -----sp","Author":"PersonIdent[bd2019us, 47727869+bd2019us@users.noreply.github.com, Tue Apr 2 13:35:23 2019 -0500]","Body":"ISSUE #2023: change cached thread pool to fixed thread pool\n\nDescriptions of the changes in this PR:\r\n\r\nchange newCachedThreadPool() to newFixedThreadPool(int)\r\n\r\n### Motivation\r\n\r\nnewFixedThreadPool(int) can be freely configured with the total number of threads, while cached thread pool may cause OutOfMemoryError when there are too many threads need to created.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2024 from bd2019us/patch, closes #2023","Date":"Tue Apr 02 20:35:23 CEST 2019"},{"Commit-ID":"commit e2b1dc7f3197891a437f689c35bff93e4e0c9a5d 1554272123 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Wed Apr 3 14:15:23 2019 +0800]","Body":"Migrate command `listunderreplicated`\n\nDescriptions of the changes in this PR:\r\n\r\n- Using `bkctl` run command `listunderreplicated`\r\n\r\n### Motivation\r\n\r\n#2013 \r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #2014 from zymap/command-listunderreplicated","Date":"Wed Apr 03 08:15:23 CEST 2019"},{"Commit-ID":"commit 95d145a15f5410e207ce610b6b4af8758851ab97 1554272183 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Wed Apr 3 14:16:23 2019 +0800]","Body":"Migrate command `nukeexistingcluster`\n\nDescriptions of the changes in this PR:\r\n\r\n#2029 \r\n\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #2030 from zymap/command-nukeexistingcluster","Date":"Wed Apr 03 08:16:23 CEST 2019"},{"Commit-ID":"commit d40b8b69f1b25f4ad3cd9992db616b847fed54d8 1554272265 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Wed Apr 3 14:17:45 2019 +0800]","Body":"Migrate command `readlog`\n\nDescriptions of the changes in this PR:\r\n\r\n#2044 \n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #2045 from zymap/command-readlog","Date":"Wed Apr 03 08:17:45 CEST 2019"},{"Commit-ID":"commit bfbd6b023b68ca0c23bf976274279ac8338181f5 1554272332 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Wed Apr 3 14:18:52 2019 +0800]","Body":"Migrate command `decommission`\n\nDescriptions of the changes in this PR:\r\n\r\n#2049 \n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #2050 from zymap/command-decommissionbookie","Date":"Wed Apr 03 08:18:52 CEST 2019"},{"Commit-ID":"commit 67f83620eb8ed93bf73322293deb1a1bde8d09c7 1554298216 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Wed Apr 3 21:30:16 2019 +0800]","Body":"Migrate command `readledger`\n\nDescriptions of the changes in this PR:\r\n\r\n#2040 \r\n\r\n- Using `bkctl` run `readledger`\r\n\r\n```\r\nRead a range of entries from a ledger.\r\n\r\nUsage:  bkctl bookie readledger [flags]\r\n\r\nFlags:\r\n\r\n    -b, --bookie\r\n        Only read from a specific bookie\r\n\r\n    -ef, --entryformatter\r\n        Set entry formatter\r\n\r\n    -fe, --firstentryid\r\n        First Entry ID\r\n\r\n    -r, --force-recovery\r\n        Ensure the ledger is properly closed before reading\r\n\r\n    -le, --lastentryid\r\n        Last Entry ID\r\n\r\n    -l, --ledgerid\r\n        Ledger ID\r\n\r\n    -lf, --ledgeridformatter\r\n        Set ledger id formatter\r\n\r\n    -m, --msg\r\n        Print message body\r\n\r\n\r\n    -h, --help\r\n        Display help information\r\n```\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #2041 from zymap/command-readledger and squashes the following commits:\n\n56b0a4581 [Yong Zhang] Remove unused import\n30dafa85f [Yong Zhang] Merge branch 'master' into command-readledger\nbfbd6b023 [Yong Zhang] Migrate command `decommission`\nd40b8b69f [Yong Zhang] Migrate command `readlog`\n95d145a15 [Yong Zhang] Migrate command `nukeexistingcluster`\ne2b1dc7f3 [Yong Zhang] Migrate command `listunderreplicated`\nc465c4761 [Yong Zhang] Remove unused import\n0988e12c7 [bd2019us] ISSUE #2023: change cached thread pool to fixed thread pool\n6a6d7bbd9 [Yong Zhang] Migrate command `initnewcluster`\n931df8c2c [Sijie Guo] Merge branch 'master' into command-readledger\nc391fe58d [Yong Zhang] Migrate command `readlogmetadata`\n120d67737 [Yong Zhang] Migrate command `lostbookierecoverydelay`\nbf66235e5 [Yong Zhang] Migrate command `deleteledger`\n87e6644f2 [Yong Zhang] Fix some conflict\n5ae05f0d2 [Yong Zhang] Migrate command `readledger`\n751e55fa4 [Arvin] ISSUE #2020: close db properly to avoid open RocksDB failure at the second time\n138a7ae85 [Yong Zhang] Migrate command `metadataformat`\nb043d1694 [Yong Zhang] Migrate command `listledgers`\n4573285db [Ivan Kelly] Docker autobuild hook\ne3d807a32 [Like] Fix IDE complain as there are multi choices for error code\n9524a9f4a [Yong Zhang] Migrate command `readjournal`\n6c3f33f55 [Yong Zhang] Fix when met unexpect entry id crashed\ne35a108c7 [Like] Fix error message for unrecognized number-of-bookies\n5902ee27b [Boyang Jerry Peng] fix potential NPE when releasing entry that is null\n6aa73ce05 [Ivan Kelly] [RELEASE] Update website to include documentation for 4.8.2\n1448d12aa [Yong Zhang] Migrate command `listfilesondisk`\n4de598379 [Yong Zhang] Issue #1987: Migrate command `convert-to-interleaved-storage`\n468743e7e [Matteo Merli] In DbLedgerStorage use default values when config key is present but empty\nf26a4cae0 [Ivan Kelly] Release notes for v4.8.2\nec2636cd2 [Yong Zhang] Issue #1985: Migrate command `convert-to-db-storage`\n8cc7239ac [Yong Zhang] Issue #1982: Migrate command `bookiesanity`\nfa90f0185 [Yong Zhang] Issue #1980: Migrate command `ledger` from shell to bkctl","Date":"Wed Apr 03 15:30:16 CEST 2019"},{"Commit-ID":"commit 1d4cc71fd77ab803a3ebec5a8e7f1b8f51de92c9 1554298806 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Wed Apr 3 21:40:06 2019 +0800]","Body":"Migrate command `localconsistencycheck`\n\nDescriptions of the changes in this PR:\r\n\r\n#2042 \r\n\r\nUsing bkctl run command localconsistencycheck\r\n\r\n```\r\nValidate Ledger Storage internal metadata\r\nUsage:  bkctl bookie localconsistencycheck [flags]\r\nFlags:\r\n\r\n    -h, --help\r\n        Display help information\r\n```\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #2043 from zymap/command-localconsistencycheck and squashes the following commits:\n\nc31f07a00 [Sijie Guo] Merge branch 'master' into command-localconsistencycheck\nc391fe58d [Yong Zhang] Migrate command `readlogmetadata`\n120d67737 [Yong Zhang] Migrate command `lostbookierecoverydelay`\nbf66235e5 [Yong Zhang] Migrate command `deleteledger`\nc9bb4a42c [Yong Zhang] Migrate command `localconsistencycheck`\n751e55fa4 [Arvin] ISSUE #2020: close db properly to avoid open RocksDB failure at the second time\n138a7ae85 [Yong Zhang] Migrate command `metadataformat`\nb043d1694 [Yong Zhang] Migrate command `listledgers`\n4573285db [Ivan Kelly] Docker autobuild hook\ne3d807a32 [Like] Fix IDE complain as there are multi choices for error code\n9524a9f4a [Yong Zhang] Migrate command `readjournal`\n6c3f33f55 [Yong Zhang] Fix when met unexpect entry id crashed\ne35a108c7 [Like] Fix error message for unrecognized number-of-bookies\n5902ee27b [Boyang Jerry Peng] fix potential NPE when releasing entry that is null\n6aa73ce05 [Ivan Kelly] [RELEASE] Update website to include documentation for 4.8.2\n1448d12aa [Yong Zhang] Migrate command `listfilesondisk`\n4de598379 [Yong Zhang] Issue #1987: Migrate command `convert-to-interleaved-storage`\n468743e7e [Matteo Merli] In DbLedgerStorage use default values when config key is present but empty\nf26a4cae0 [Ivan Kelly] Release notes for v4.8.2\nec2636cd2 [Yong Zhang] Issue #1985: Migrate command `convert-to-db-storage`\n8cc7239ac [Yong Zhang] Issue #1982: Migrate command `bookiesanity`\nfa90f0185 [Yong Zhang] Issue #1980: Migrate command `ledger` from shell to bkctl","Date":"Wed Apr 03 15:40:06 CEST 2019"},{"Commit-ID":"commit 1246826ba749f57d3d428deb7606dd582836ca69 1554697788 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Mon Apr 8 12:29:48 2019 +0800]","Body":"Migrate command `recover`\n\nDescriptions of the changes in this PR:\r\n\r\n#2055 \n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #2056 from zymap/command-recover","Date":"Mon Apr 08 06:29:48 CEST 2019"},{"Commit-ID":"commit 5c150f28339d7b32f351f34ee8a7469d265b8613 1554754535 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Mon Apr 8 22:15:35 2019 +0200]","Body":"Release notes for 4.9.1\n\nDescriptions of the changes in this PR:\r\n- Release notes for Apache BookKeeper 4.9.1\r\n- Add Apache BookKeeper docs for 4.9.1 to the website\r\n\r\n\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #1992 from eolivelli/fix/releasenotest491","Date":"Mon Apr 08 22:15:35 CEST 2019"},{"Commit-ID":"commit d4dbb6bfb6cd7a56a8baf95472a7f6fc680d0ca2 1554797804 -----sp","Author":"PersonIdent[Dongfa,Huang, huangdongfa01@gmail.com, Tue Apr 9 16:16:44 2019 +0800]","Body":"Avoid useless verify if LedgerEntryRequest completed\n\nAvoid useless verify if LedgerEntryRequest completed\r\n\r\nChange-Id: Ifda2a6e218c49105a5627be69566ea2ce4a57699\r\n\r\nDescriptions of the changes in this PR:\r\nPrint misleading logs when the SpeculativeRequestExecutionPolicy is turned on：\r\n2019-04-03 18:30:49,839 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: -1 , actual: 602\r\n2019-04-03 18:30:49,839 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: -1 , actual: 606\r\n2019-04-03 18:30:49,839 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: -1 , actual: 610\r\n2019-04-03 18:30:49,839 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: -1 , actual: 614\r\n2019-04-03 18:30:49,843 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 644 , actual: 622\r\n2019-04-03 18:30:49,843 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 640 , actual: 626\r\n2019-04-03 18:30:49,843 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 656 , actual: 630\r\n2019-04-03 18:30:49,843 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 652 , actual: 634\r\n2019-04-03 18:30:49,843 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 648 , actual: 638\r\n2019-04-03 18:30:49,846 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 660 , actual: 642\r\n2019-04-03 18:30:49,846 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 675 , actual: 646\r\n2019-04-03 18:30:49,846 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 671 , actual: 650\r\n2019-04-03 18:30:49,846 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 667 , actual: 654\r\n2019-04-03 18:30:49,846 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 663 , actual: 658\r\n2019-04-03 18:30:49,848 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: -1 , actual: 670\r\n2019-04-03 18:30:49,849 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 692 , actual: 662\r\n\r\n\r\n\r\n### Motivation\r\nAvoid useless verify and redundant logging(caused by the use of recycled `entryImpl`) if LedgerEntryRequest completed\r\n\r\n### Changes\r\nReturn immediately if completed\r\n\r\nMaster Issue: #<master-issue-number>\r\n\r\n\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #2061 from huangdongfa/master","Date":"Tue Apr 09 10:16:44 CEST 2019"},{"Commit-ID":"commit 7ad5849b1b0d9dbf2274a6fd00ad26f7286f7cff 1554811226 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Tue Apr 9 20:00:26 2019 +0800]","Body":"Migrate command `regenerate-interleaved-storage-index-file`\n\nDescriptions of the changes in this PR:\r\n\r\n#2033 \r\n\r\n```\r\nRegenerate an interleaved storage index file, from available entrylogger files.\r\n\r\nUsage:  bkctl bookie regenerate-interleaved-storage-index-file [flags]\r\n\r\nFlags:\r\n\r\n    -b, --b64password\r\n        The password in base64 encoding, for cases where the password is not\r\n        UTF-8.\r\n\r\n    -d, --dryrun\r\n        Process the entryLogger, but don't write anthing.\r\n\r\n    -l, --ledgerids\r\n        Ledger(s) whose index needs to be regenerated. Multiple can be\r\n        specified, comma separated.\r\n\r\n    -p, --password\r\n        The bookie stores the password in the index file, so we need it to\r\n        regenerate.This must match the value in the ledger metadata.\r\n\r\n\r\n    -h, --help\r\n        Display help information\r\n```\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #2035 from zymap/command-RISIF","Date":"Tue Apr 09 14:00:26 CEST 2019"},{"Commit-ID":"commit 06f2b6f50ca2c6c1ccc630aa9d9fd761abf1becc 1554860524 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Wed Apr 10 09:42:04 2019 +0800]","Body":"Migrate command `updateledgers`\n\nDescriptions of the changes in this PR:\r\n\r\n#2057 \r\n\r\n```\r\nUpdate bookie id in ledgers (this may take a long time).\r\n\r\nUsage:  bkctl ledger update [flags]\r\n\r\nFlags:\r\n\r\n    -host, --hostname\r\n        Expects configuration useHostNameAsBookieID=true as the optin value\r\n\r\n    -l, --limit\r\n        Maximum number of ledgers of ledgers to update (default: no limit)\r\n\r\n    -p, --printprogress\r\n        Print messages on every configured seconds if verbose turned on\r\n        (default: 10 secs)\r\n\r\n    -v, --verbose\r\n        Print status of the ledger updation (default: false)\r\n\r\n    -s, updatepersec\r\n        Number of ledgers updating per second (default: 5 per sec)\r\n\r\n\r\n    -h, --help\r\n        Display help information\r\n```\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #2058 from zymap/command-updateledgers","Date":"Wed Apr 10 03:42:04 CEST 2019"},{"Commit-ID":"commit 848f8527f9d4745753b2f1e22ac1b8e981ea0d1d 1554860692 -----sp","Author":"PersonIdent[Nicolas Michael, git@nmichael.de, Tue Apr 9 18:44:52 2019 -0700]","Body":"ISSUE #2053: Bugfix for Percentile Calculation in FastCodahale Timer Implementation\n\nThis bugfix for the FastCodahale timer implementation ensures that percentiles provided by a FastSnapshot are calculated correctly even if the total count of events (provided by FastTimer) is out of sync with the recorded events in the percentile buckets.\r\n\r\n### Motivation\r\n\r\nFastCodahale Timer implementation may miscalculate percentiles if snapshots of values are slightly out of sync, and if only few events have been recorded.\r\n\r\nFastCodahale Timers use fine-grained locking and are meant to tolerate that (some) values change while being recorded or while snapshots are created. Currently, the total count of requests is not synchronized with the number of requests recorded in percentile buckets. If a snapshot is created while the total count of the timer has been incremented beyond the sum of values in the percentile buckets, the percentile calculation may produce wrong values.\r\n\r\nFor example, if 3 percentile values have been recorded, but the overall count is 4, then the percentile calculation would be based on 4 values. This becomes most obvious if a percentile > .75 (e.g. p95) is being calculated. For this, the implementation will try to find 0.95 * 4 values, which is more than the 3 values recorded in the buckets. Since no bucket fulfills the criteria, the bound of the last (overflow) bucket will be returned, i.e. Long.MAX_VALUE.\r\n\r\n### Changes\r\n\r\nFastSnapshots now bases the percentile calculation on the sum of values in the percentile buckets rather than a count provided by the caller (i.e. FastTimer). This ensures that percentiles are calculated correctly without the need of having all counters fully synchronized.\r\n\r\nMaster Issue: #2053 \r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #2054 from nicmichael/fast-codahale-bugfix, closes #2053","Date":"Wed Apr 10 03:44:52 CEST 2019"},{"Commit-ID":"commit 90c79444d6211cd66f4259c04c4e246097821b75 1554895097 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Wed Apr 10 19:18:17 2019 +0800]","Body":"Migrate command `rebuild-db-ledger-locations-index`\n\nDescriptions of the changes in this PR:\r\n\r\n#2036 \r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #2034 from zymap/command-RDBLLI","Date":"Wed Apr 10 13:18:17 CEST 2019"},{"Commit-ID":"commit 5b8e0971a35f0c0ee3e237b612a52c12a8c4c923 1554949187 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Thu Apr 11 10:19:47 2019 +0800]","Body":"Migrate command `Whatisinstanceid`\n\nDescriptions of the changes in this PR:\r\n\r\n#2027 \r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2028 from zymap/whatisinstanceid","Date":"Thu Apr 11 04:19:47 CEST 2019"},{"Commit-ID":"commit ed008f27807a75ba384246fc7fae6ca3a5a6971f 1555308056 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Mon Apr 15 14:00:56 2019 +0800]","Body":"Migrate command `whoisauditor`\n\nDescriptions of the changes in this PR:\r\n\r\n- Using `bkctl` run command `whoisauditor`\r\n\r\n### Motivation\r\n\r\n#2007 \r\n\n\nReviewers: Sijie Guo <sijie@apache.org>, Jia Zhai <zhaijia@apache.org>\n\nThis closes #2008 from zymap/command-whoisauditor","Date":"Mon Apr 15 08:00:56 CEST 2019"},{"Commit-ID":"commit 60d993edf50417ace9777d2f40cc2bbc97510125 1555404512 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Tue Apr 16 16:48:32 2019 +0800]","Body":"Migrate command `autorecovery`\n\nDescriptions of the changes in this PR:\r\n\r\n- Using `bkctl` run command `autorecovery`\r\n\r\n### Motivation\r\n\r\n#2009 \n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #2010 from zymap/command-autorecovery and squashes the following commits:\n\n6fcd96904 [Yong Zhang] Fix validation\ncd383f372 [Yong Zhang] Rename package\nefb573221 [Yong Zhang] Rename command\n89da2852e [Yong Zhang] Fix error in bookieshell\na037501ee [Yong Zhang] Rename args\n4bb36b0b3 [Yong Zhang] Fix imports postion\ne41a742d3 [Yong Zhang] Add unit test for command `autorecovery`\nb0c91f704 [Yong Zhang] Rename file\ncb06f66de [Yong Zhang] Migrate command `autorecovery`\ned008f278 [Yong Zhang] Migrate command `whoisauditor`\n5b8e0971a [Yong Zhang] Migrate command `Whatisinstanceid`\n90c79444d [Yong Zhang] Migrate command `rebuild-db-ledger-locations-index`\n848f8527f [Nicolas Michael] ISSUE #2053: Bugfix for Percentile Calculation in FastCodahale Timer Implementation\n06f2b6f50 [Yong Zhang] Migrate command `updateledgers`\n7ad5849b1 [Yong Zhang] Migrate command `regenerate-interleaved-storage-index-file`\nd4dbb6bfb [Dongfa,Huang] Avoid useless verify if LedgerEntryRequest completed\n5c150f283 [Enrico Olivelli] Release notes for 4.9.1\n1246826ba [Yong Zhang] Migrate command `recover`\n1d4cc71fd [Yong Zhang] Migrate command `localconsistencycheck`\n67f83620e [Yong Zhang] Migrate command `readledger`\nbfbd6b023 [Yong Zhang] Migrate command `decommission`\nd40b8b69f [Yong Zhang] Migrate command `readlog`\n95d145a15 [Yong Zhang] Migrate command `nukeexistingcluster`\ne2b1dc7f3 [Yong Zhang] Migrate command `listunderreplicated`\n0988e12c7 [bd2019us] ISSUE #2023: change cached thread pool to fixed thread pool\n6a6d7bbd9 [Yong Zhang] Migrate command `initnewcluster`\nc391fe58d [Yong Zhang] Migrate command `readlogmetadata`\n120d67737 [Yong Zhang] Migrate command `lostbookierecoverydelay`\nbf66235e5 [Yong Zhang] Migrate command `deleteledger`\n751e55fa4 [Arvin] ISSUE #2020: close db properly to avoid open RocksDB failure at the second time\n138a7ae85 [Yong Zhang] Migrate command `metadataformat`\nb043d1694 [Yong Zhang] Migrate command `listledgers`\n4573285db [Ivan Kelly] Docker autobuild hook\ne3d807a32 [Like] Fix IDE complain as there are multi choices for error code\n9524a9f4a [Yong Zhang] Migrate command `readjournal`\n6c3f33f55 [Yong Zhang] Fix when met unexpect entry id crashed\ne35a108c7 [Like] Fix error message for unrecognized number-of-bookies\n5902ee27b [Boyang Jerry Peng] fix potential NPE when releasing entry that is null\n6aa73ce05 [Ivan Kelly] [RELEASE] Update website to include documentation for 4.8.2\n1448d12aa [Yong Zhang] Migrate command `listfilesondisk`\n4de598379 [Yong Zhang] Issue #1987: Migrate command `convert-to-interleaved-storage`\n468743e7e [Matteo Merli] In DbLedgerStorage use default values when config key is present but empty\nf26a4cae0 [Ivan Kelly] Release notes for v4.8.2\nec2636cd2 [Yong Zhang] Issue #1985: Migrate command `convert-to-db-storage`\n8cc7239ac [Yong Zhang] Issue #1982: Migrate command `bookiesanity`\nfa90f0185 [Yong Zhang] Issue #1980: Migrate command `ledger` from shell to bkctl","Date":"Tue Apr 16 10:48:32 CEST 2019"},{"Commit-ID":"commit 6f33968019c3452cefc2d78e0258bb3206d78e8a 1555482744 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Wed Apr 17 14:32:24 2019 +0800]","Body":"Migrate command `triggeraudit`\n\nDescriptions of the changes in this PR:\r\n\r\n- Using `bkctl` run command `triggeraudit`\r\n\r\n### Motivation\r\n\r\n#2011 \n\nReviewers: Sijie Guo <sijie@apache.org>, Jia Zhai <zhaijia@apache.org>\n\nThis closes #2012 from zymap/command-triggeraudit and squashes the following commits:\n\n5a4b496ec [Yong Zhang] Fix conflict ---\n236b7d6e5 [Yong Zhang] Fix validation\nb039b637e [Yong Zhang] Rename file\n8bea52522 [Yong Zhang] Remove unused imports\nd39d1e886 [Yong Zhang] Migrate command `triggeraudit`\n60d993edf [Yong Zhang] Migrate command `autorecovery`\ned008f278 [Yong Zhang] Migrate command `whoisauditor`\n5b8e0971a [Yong Zhang] Migrate command `Whatisinstanceid`\n90c79444d [Yong Zhang] Migrate command `rebuild-db-ledger-locations-index`\n848f8527f [Nicolas Michael] ISSUE #2053: Bugfix for Percentile Calculation in FastCodahale Timer Implementation\n06f2b6f50 [Yong Zhang] Migrate command `updateledgers`\n7ad5849b1 [Yong Zhang] Migrate command `regenerate-interleaved-storage-index-file`\nd4dbb6bfb [Dongfa,Huang] Avoid useless verify if LedgerEntryRequest completed\n5c150f283 [Enrico Olivelli] Release notes for 4.9.1\n1246826ba [Yong Zhang] Migrate command `recover`\n1d4cc71fd [Yong Zhang] Migrate command `localconsistencycheck`\n67f83620e [Yong Zhang] Migrate command `readledger`\nbfbd6b023 [Yong Zhang] Migrate command `decommission`\nd40b8b69f [Yong Zhang] Migrate command `readlog`\n95d145a15 [Yong Zhang] Migrate command `nukeexistingcluster`\ne2b1dc7f3 [Yong Zhang] Migrate command `listunderreplicated`\n0988e12c7 [bd2019us] ISSUE #2023: change cached thread pool to fixed thread pool\n6a6d7bbd9 [Yong Zhang] Migrate command `initnewcluster`\nc391fe58d [Yong Zhang] Migrate command `readlogmetadata`\n120d67737 [Yong Zhang] Migrate command `lostbookierecoverydelay`\nbf66235e5 [Yong Zhang] Migrate command `deleteledger`\n751e55fa4 [Arvin] ISSUE #2020: close db properly to avoid open RocksDB failure at the second time\n138a7ae85 [Yong Zhang] Migrate command `metadataformat`\nb043d1694 [Yong Zhang] Migrate command `listledgers`\n4573285db [Ivan Kelly] Docker autobuild hook\ne3d807a32 [Like] Fix IDE complain as there are multi choices for error code\n9524a9f4a [Yong Zhang] Migrate command `readjournal`\n6c3f33f55 [Yong Zhang] Fix when met unexpect entry id crashed\ne35a108c7 [Like] Fix error message for unrecognized number-of-bookies\n5902ee27b [Boyang Jerry Peng] fix potential NPE when releasing entry that is null\n6aa73ce05 [Ivan Kelly] [RELEASE] Update website to include documentation for 4.8.2\n1448d12aa [Yong Zhang] Migrate command `listfilesondisk`\n4de598379 [Yong Zhang] Issue #1987: Migrate command `convert-to-interleaved-storage`\n468743e7e [Matteo Merli] In DbLedgerStorage use default values when config key is present but empty\nf26a4cae0 [Ivan Kelly] Release notes for v4.8.2\nec2636cd2 [Yong Zhang] Issue #1985: Migrate command `convert-to-db-storage`\n8cc7239ac [Yong Zhang] Issue #1982: Migrate command `bookiesanity`\nfa90f0185 [Yong Zhang] Issue #1980: Migrate command `ledger` from shell to bkctl","Date":"Wed Apr 17 08:32:24 CEST 2019"},{"Commit-ID":"commit 066621507f2d40ea67aa7d7ddadbb9304db17993 1555633826 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Fri Apr 19 08:30:26 2019 +0800]","Body":"Migrate command `updatecookie`\n\nDescriptions of the changes in this PR:\r\n\r\n#2059 \r\n\r\n### Description\r\n\r\nProvide some admin operation about cookie\r\n\r\n```\r\nCommand to update cookie\r\n\r\nUsage:  bkctl cookie admin [flags]\r\n\r\nFlags:\r\n\r\n    -d, --delete\r\n        Delete cookie both locally and in zooKeeper\r\n\r\n    -e, --expandstorage\r\n        Add new empty ledger/index directories\r\n\r\n    -f, --force\r\n        Force delete cookie\r\n\r\n    -host, --hostname\r\n        Expects config useHostNameAsBookieID=true as the option value\r\n\r\n    -l, --list\r\n        List paths of all the cookies present locally and on zooKeeper\r\n\r\n\r\n    -h, --help\r\n        Display help information\r\n```\r\n\r\n### Changes\r\n\r\nUpdate command `updatecookie` to `admin`\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>\n\nThis closes #2060 from zymap/command-updatecookie","Date":"Fri Apr 19 02:30:26 CEST 2019"},{"Commit-ID":"commit 316b71923e841c9fdb61159067c4bcf6075d1f21 1555633922 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Apr 19 02:32:02 2019 +0200]","Body":"Wait for LAC update even if ledger fenced\n\nPrevious behaviour was to return straight away. However, LAC can\r\nchange when the ledger is fenced and there is no guarantee that a\r\nfenced ledger will turn into a closed ledger (fencing client may\r\ncrash), which would cause the client tailing with longpoll LAC to go\r\ninto a tight loop.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <zhaijia@apache.org>, Matteo Merli <mmerli@apache.org>, Venkateswararao Jujjuri (JV) <None>, Sijie Guo <sijie@apache.org>\n\nThis closes #2052 from ivankelly/wait-on-fenced","Date":"Fri Apr 19 02:32:02 CEST 2019"},{"Commit-ID":"commit 44ee320b64ee1d47ee8b278a843bd033660b7aa0 1555634407 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Apr 19 02:40:07 2019 +0200]","Body":"k\n\nOtherwise the watch objects will accumulate and eventually cause an\r\nOOM on the bookie, if LAC doesn't progress.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #2051 from ivankelly/tme-oom","Date":"Fri Apr 19 02:40:07 CEST 2019"},{"Commit-ID":"commit d23b45ec840b75307ebf4a108053d8539c8b349a 1555634585 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Apr 19 02:43:05 2019 +0200]","Body":"Fix typo in overview page for 4.8.2\n\nThe release notes link text was saying the latest version rather than\r\n4.8.2.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2048 from ivankelly/doc-typo-relnotes","Date":"Fri Apr 19 02:43:05 CEST 2019"},{"Commit-ID":"commit eaa6014049e6bc8253f5b0282e4ace8a3aff92e2 1555634694 -----sp","Author":"PersonIdent[Like, like_0903@163.com, Fri Apr 19 08:44:54 2019 +0800]","Body":"Support asynchronous fence request for V2 ReadEntryProcessor\n\nCurrently, the ```ReadEntryProcessor``` v2 does not support asynchronous fence request, which wait for 1000 milliseconds to wait it done if it's a fencing request. This pull request attempt to support asynchronous response if a thread pool is provided. \r\n\r\nCloses #283\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2021 from liketic/refactor","Date":"Fri Apr 19 02:44:54 CEST 2019"},{"Commit-ID":"commit 407cb35e594e2334ae687f7c884651c7642349fa 1555693868 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Fri Apr 19 10:11:08 2019 -0700]","Body":"ISSUE #1967: make ledger creation and removal robust to zk connectionloss\n\n\r\nDescriptions of the changes in this PR:\r\n\r\nThe bookkeeper project ZooKeeperClient wrapper for the ZooKeeper client\r\nwill resend zk node creations and removals upon reconnect after a\r\nConnectionLoss event. In the event that the original succeeded, the\r\nresent operation will erroneously return LedgerExistException or\r\nNoSuchLedgerExistsException for creation and removal respectively.\r\n\r\nFor removal, this patch limits the operation by allowing it to always\r\nsucceed if the ledger does not exist in order to make it idempotent.\r\nThis is appears to be the simplest solution as exclusive removal isn't\r\nimportant.\r\n\r\n**Note, the above is an actual change to the bk client semantics**\r\n\r\nFor creation, exclusive creation is cleary important for correctness,\r\nso this patch adds a creator token field to the LedgerMetdata to\r\ndisambiguate the above race from a real race. For\r\nAbstractZkLedgerManager, this is simply a random long value.\r\n\r\nThere's an oportunity for optimization with the above if exclusive\r\nledger creation failures are expected to be common.  You only actually\r\nneed to perform this check if the operation was really resent.  I chose\r\nnot to go this route yet because it would require messing with the\r\nZooKeeperClient interface to surface that information without burdening\r\nother callers.\r\n\r\nIf the client is set to version 2 or older, this field will be ignored\r\nand the old behavior will be retained.  If the client is version 3 or\r\nnewer but creation races with an older client, the new client will\r\ninterpret the nonce to be BLANK and thereby detect the race correctly.\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2006 from reddycharan/zkretrialrobust, closes #1967","Date":"Fri Apr 19 19:11:08 CEST 2019"},{"Commit-ID":"commit 86bce12b58f997430f87771abb95854ee41a7248 1556101024 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Wed Apr 24 18:17:04 2019 +0800]","Body":"Migrate command `ledgermetadata`\n\nDescriptions of the changes in this PR:\r\n\r\nUsing `bkctl` run command `ledgermetadata`\r\n\r\n### Motivation\r\n\r\n#2018 \r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #2019 from zymap/command-ledgermetadata","Date":"Wed Apr 24 12:17:04 CEST 2019"},{"Commit-ID":"commit 42e77802c025964d826c3b57e8f18c4bc464c481 1556417184 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Sun Apr 28 04:06:24 2019 +0200]","Body":"DLog Namespace#openLog should declare LogNotFoundException\n\nOther methods such as delete do, so openLog should declare it to be\r\nconsistent and to give users a hint that it can be caught.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2072 from ivankelly/dl-openlog-ex","Date":"Sun Apr 28 04:06:24 CEST 2019"},{"Commit-ID":"commit 7c62e1232cf8063d3b0f0dc59978da69710602b5 1556591315 -----sp","Author":"PersonIdent[karanmehta93, karanmehta93@gmail.com, Mon Apr 29 19:28:35 2019 -0700]","Body":"ISSUE #2073: ReadOnlyBookieTest#testBookieContinueWritingIfMulti\u2026\n\n\u2026pleLedgersPresent is flaky\r\n\r\nDescriptions of the changes in this PR:\r\n\r\nUpdated the test to use random port number for bookie startup instead of predefined one.\r\n\r\n### Motivation\r\n\r\nReadOnlyBookieTest#testBookieContinueWritingIfMultipleLedgersPresent test is flaky due to this reason.\r\n\r\n### Changes\r\n\r\n(Describe: what changes you have made)\r\n\r\nMaster Issue: #2073 \r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2074 from karanmehta93/master, closes #2073","Date":"Tue Apr 30 04:28:35 CEST 2019"},{"Commit-ID":"commit bd699e61d729f327b5de302089d11bc3dcadfeb8 1556591464 -----sp","Author":"PersonIdent[mtang01, 49574764+mtang01@users.noreply.github.com, Mon Apr 29 19:31:04 2019 -0700]","Body":"ISSUE #2067: reduce byte[] allocation in add entry\n\nDescriptions of the changes in this PR:\r\nThis change removes a byte[] copy in DigestManager digest calculation\r\n(computeDigestAndPackageForSending)\r\nthat puts crc header and payload in a continuous buffer. Instead,\r\nit uses protobuf ByteString.concat to concatenate header and payload\r\nwithout copy when building protobuf message.\r\n\r\n\r\n\r\n\r\n### Motivation\r\n\r\nIn add entry code path, I see lots of byte[] allocated to do digest calculation.  It's possible to not allocate byte[]. \r\n\r\n### Changes\r\n\r\nDon't allocate a ByteBuf to copy data. Keep header and data separate, but use ByteString.concat when construct protobuf message.\r\n\r\nMaster Issue: #2067 \r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2068 from mtang01/add_entry_mem, closes #2067","Date":"Tue Apr 30 04:31:04 CEST 2019"},{"Commit-ID":"commit 9bb7e4b8245507ce1aefc9ff9a316c1407016240 1556680832 -----sp","Author":"PersonIdent[Venkateswararao Jujjuri (JV), jujjuri@gmail.com, Tue Apr 30 20:20:32 2019 -0700]","Body":"Explicit error message if extent is not present on ZK (#2066)\n\n* Explicit error message if extent is not present on ZK\r\n\r\nClient can get no extent error in the following two scenarios.\r\n1. When client attempted to read/open an extent that\r\n   is not on ZK (metadata server)\r\n2. When client attempted to read a Ledger which is on metadata\r\n   server, but somehow missing on bookies (Data server)\r\n\r\nIt is quite confusing to get the same error, NoSuchLedgerExists\r\nfor both these cases. This checkin introduced a new error at the\r\nBookKeeper client level, NoSuchLedgerExistsOnMetadataServer if\r\nit is not available on ZK.\r\n\r\nFor errors related to Ledger is not available on bookie,\r\nI left NoSuchLedgerExists as-is(instead of changing it to\r\nNoSuchLedgerExistsOnDataServer) to minimize code changes.\r\n\r\nThis change alone provides enough distinction between these\r\ntwo types of errors.\r\n\r\nSigned-off-by: Venkateswararao Jujjuri (JV) <vjujjuri@salesforce.com>\r\n\r\n* Checkstyle fixes\r\n\r\n* Some more fixes\r\n\r\n* Fixing DL test fixes\r\n","Date":"Wed May 01 05:20:32 CEST 2019"},{"Commit-ID":"commit 973d2ab0da91e5a24b1d30990ca6bb1484f07f7e 1556822234 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu May 2 11:37:14 2019 -0700]","Body":"Use pure python implementation of MurmurHash\n\n### Motivation\r\n\r\nBK table python client is depending on `mmh3` library for MurmurHash. This library wraps a C based function but there are no binaries published on PyPI. Therefore users need to have a GCC installed in order to install the BK client lib, since it compiles it at install time. GCC is typically not available in Docker containers.\r\n\r\n### Modifications\r\n\r\nInclude a pure python implementation of MurmurHash to use if the C based is not found. \r\n\r\nNotes:\r\n * I couldn't find any published pure-python MurmurHash implementations on PyPI\r\n * Importing public-domain code is permitted by ASF\r\n\r\n\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2069 from merlimat/mmh3","Date":"Thu May 02 20:37:14 CEST 2019"},{"Commit-ID":"commit 41b39c6eff249729a698838e880ad77cc0c18c67 1556822569 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Thu May 2 11:42:49 2019 -0700]","Body":"ISSUE #1967: make ledger creation and removal robust to zk connectionloss\n\n\r\n- fix test failures in TestLedgerMetadataSerDe\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2070 from reddycharan/fixzktestfailures, closes #1967","Date":"Thu May 02 20:42:49 CEST 2019"},{"Commit-ID":"commit 707ae5c8536f967c0369f951d6178670c5dd031d 1556825911 -----sp","Author":"PersonIdent[karanmehta93, k.mehta@salesforce.com, Thu May 2 12:38:31 2019 -0700]","Body":"ISSUE #2075: Bookieshell lastmark command isn't functional, always returning 0-0\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\n`lastmark` shell command is to be used while debugging however currently it cannot be used since it returns incorrect value.\r\n\r\n### Changes\r\n\r\nUpdated `LedgerDirsManager` object initialization to use correct `ledgerDirs`.\r\nMaster Issue: #2075\r\n\r\n\r\n\n\nReviewers: Charan Reddy Guttapalem <reddycharan18@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2076 from karanmehta93/ISSUE-2075, closes #2075","Date":"Thu May 02 21:38:31 CEST 2019"},{"Commit-ID":"commit 10859afb7e8f2ee095e70f4e5482959bb5a3067a 1556900964 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri May 3 09:29:24 2019 -0700]","Body":"Added HTTP handler to expose bookie state\n\n### Motivation\r\n\r\nAllow to check the state of the bookie through HTTP.\r\n\r\nThe main reason is to allow light-weight probes that can be run frequently to establish whether the bookie is running and meets a minimum readiness criteria. One example is to automatically wait until the bookie has completed the startup sequence.\r\n\r\n### Changes\r\n\r\nAdded new HTTP handler that exposes the values from the bookie `StateManager`. \n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <zhaijia@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #1995 from merlimat/bookie-state","Date":"Fri May 03 18:29:24 CEST 2019"},{"Commit-ID":"commit aa84c7fdd24a925f57f087670b205a35fb8ef237 1557008881 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Sat May 4 15:28:01 2019 -0700]","Body":"GetListOfEntriesOfLedger implementation\n\n\r\nDescriptions of the changes in this PR:\r\n\r\nAs described in this BP - https://github.com/apache/bookkeeper/blob/master/site/bps/BP-34-cluster-metadata-checker.md, this request returns list of entries bookie contains for the given ledger in an encoded format. The returned list provides weakly consistent state, of the entries of the ledger.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #1931 from reddycharan/getlistofentries and squashes the following commits:\n\n467bb8b73 [Charan Reddy Guttapalem] GetListOfEntriesOfLedger implementation\n757f99156 [Charan Reddy Guttapalem] GetListOfEntriesOfLedger implementation\n4e84bcba0 [Charan Reddy Guttapalem] GetListOfEntriesOfLedger implementation\nf5655bb29 [Charan Reddy Guttapalem] GetListOfEntriesOfLedger implementation","Date":"Sun May 05 00:28:01 CEST 2019"},{"Commit-ID":"commit b4ca4537b62e75f71e3329186652f982025175a2 1557507557 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Fri May 10 09:59:17 2019 -0700]","Body":"Move common placementpolicy components to TopologyAwareEnsemblePlacementPolicy.\n\nDescriptions of the changes in this PR:\r\n\r\n- Moving components/methods which are common in nature with respect to\r\nplacementpolicy from RackawareEnsemblePlacementPolicyImpl to\r\nTopologyAwareEnsemblePlacementPolicy, so that any new placementpolicy\r\nimplementation can extend TopologyAwareEnsemblePlacementPolicy and reuse\r\nthose common components/generic.\r\n- This change has no functionality change, it is just reorganizing code.\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2089 from reddycharan/3azplacement","Date":"Fri May 10 18:59:17 CEST 2019"},{"Commit-ID":"commit d35aa22ade87969a4f8e932d925c5d134feb764b 1557788801 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Mon May 13 16:06:41 2019 -0700]","Body":"Move common placementpolicy components to TopologyAwareEnsemblePlacementPolicy.\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n- Moving components/methods which are common in nature with respect to\r\nplacementpolicy from RackawareEnsemblePlacementPolicyImpl to\r\nTopologyAwareEnsemblePlacementPolicy, so that any new placementpolicy\r\nimplementation can extend TopologyAwareEnsemblePlacementPolicy and reuse\r\nthose common components/generic.\r\n- Change signature of methods of RackChangeNotifier interface.\r\n- Delete duplicate methods in RackawareEnsemblePlacementPolicyImpl and\r\nTopologyAwareEnsemblePlacementPolicy (missed removing them in #2089)\r\n- Created separate class for BookieNode\r\n- This change has no functionality change, it is just reorganizing code.\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #2092 from reddycharan/placementpolicyrefactoring","Date":"Tue May 14 01:06:41 CEST 2019"},{"Commit-ID":"commit f5ddc36cc30c5bab5d2e8ebc5fa552c2ad0d6eea 1557902118 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Tue May 14 23:35:18 2019 -0700]","Body":"[BK-GC] avoid blocking call in gc-thread\n\n### Motivation\r\n\r\nRight now, we have below 3 issues because of which gc thread gets blocked forever and it can't perform gc-task further. Below issues are mainly related to blocking call while doing zk-operation without timeout. \r\n\r\nbug-fixes:\r\n1. right now, [GC - ScanAndCompareGarbageCollector](https://github.com/apache/bookkeeper/blob/master/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/ScanAndCompareGarbageCollector.java#L142) passes timeout in millisecond to [LedgerManager](https://github.com/apache/bookkeeper/blob/master/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LongHierarchicalLedgerManager.java#L166) but it \r\ntakes it as second and again try to convert it in millis so, 30Kms timeout becomes [30M ms timeout](https://github.com/apache/bookkeeper/blob/master/bookkeeper-server/src/main/java/org/apache/bookkeeper/util/ZkUtils.java#L245). Sp, fix timeout unit during gc.\r\n\r\n2. Right now, GC makes blocking call to get list of children on ledger znode and sometime zk-call back doesn't comeback which blocks the gc-thread forever. However, recently we added the timeout on the [object-waiting-lock](https://github.com/apache/bookkeeper/blob/master/bookkeeper-server/src/main/java/org/apache/bookkeeper/util/ZkUtils.java#L243-L248) which doesn't work because it's in while loop and `object.wait(timeout)` completes without any exception and GC threads keep running in while loop.\r\n\r\n3. add zk-timeout during delete ledgers in bookie else it can also block the GC thread.\r\n\r\n\r\n\r\n\r\n\r\n### Changes\r\n\r\nadd timeout while bk-gc makes zk-call to verify deleted ledgers.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>, Rajan Dhabalia <rdhabalia@apache.org>\n\nThis closes #1940 from rdhabalia/verify_gc","Date":"Wed May 15 08:35:18 CEST 2019"},{"Commit-ID":"commit 2ff26d69e400d16f533f424c6e95f2f30189e183 1558028108 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu May 16 10:35:08 2019 -0700]","Body":"Added release notes for release 4.9.2\n\n### Motivation\r\n\r\nRelease notes for patch release \n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2088 from merlimat/relnotes-4.9.2","Date":"Thu May 16 19:35:08 CEST 2019"},{"Commit-ID":"commit 335c2aba9bfd24eff224f1afae393026c17a2d5a 1558078752 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Fri May 17 00:39:12 2019 -0700]","Body":"[BK-CLIENT] Check empty ledger-parent node while deleting ledger\n\n### Motivation\r\n\r\nAs discussed at [#4276](https://github.com/apache/pulsar/issues/4276), while deleting ledger, bk-client should check parent node is empty before issuing delete request for parent znode.\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Charan Reddy Guttapalem <reddycharan18@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #2097 from rdhabalia/led_del and squashes the following commits:\n\nf5c0ca36c [rdhabalia] return callback with ok\nede5e9403 [rdhabalia] [Bk-Client] Check empty ledger-parent node while deleting ledger\nd35aa22ad [Charan Reddy Guttapalem] Move common placementpolicy components to TopologyAwareEnsemblePlacementPolicy.\nb4ca4537b [Charan Reddy Guttapalem] Move common placementpolicy components to TopologyAwareEnsemblePlacementPolicy.\naa84c7fdd [Charan Reddy Guttapalem] GetListOfEntriesOfLedger implementation\n10859afb7 [Matteo Merli] Added HTTP handler to expose bookie state\n707ae5c85 [karanmehta93] ISSUE #2075: Bookieshell lastmark command isn't functional, always returning 0-0\n41b39c6ef [Charan Reddy Guttapalem] ISSUE #1967: make ledger creation and removal robust to zk connectionloss\n973d2ab0d [Matteo Merli] Use pure python implementation of MurmurHash\n9bb7e4b82 [Venkateswararao Jujjuri (JV)] Explicit error message if extent is not present on ZK (#2066)\nbd699e61d [mtang01] ISSUE #2067: reduce byte[] allocation in add entry\n7c62e1232 [karanmehta93] ISSUE #2073: ReadOnlyBookieTest#testBookieContinueWritingIfMulti\u2026\n42e77802c [Ivan Kelly] DLog Namespace#openLog should declare LogNotFoundException\n86bce12b5 [Yong Zhang] Migrate command `ledgermetadata`\n407cb35e5 [Charan Reddy Guttapalem] ISSUE #1967: make ledger creation and removal robust to zk connectionloss\neaa601404 [Like] Support asynchronous fence request for V2 ReadEntryProcessor\nd23b45ec8 [Ivan Kelly] Fix typo in overview page for 4.8.2\n44ee320b6 [Ivan Kelly] k\n316b71923 [Ivan Kelly] Wait for LAC update even if ledger fenced\n066621507 [Yong Zhang] Migrate command `updatecookie`\n6f3396801 [Yong Zhang] Migrate command `triggeraudit`\n60d993edf [Yong Zhang] Migrate command `autorecovery`\ned008f278 [Yong Zhang] Migrate command `whoisauditor`\n5b8e0971a [Yong Zhang] Migrate command `Whatisinstanceid`\n90c79444d [Yong Zhang] Migrate command `rebuild-db-ledger-locations-index`\n848f8527f [Nicolas Michael] ISSUE #2053: Bugfix for Percentile Calculation in FastCodahale Timer Implementation\n06f2b6f50 [Yong Zhang] Migrate command `updateledgers`\n7ad5849b1 [Yong Zhang] Migrate command `regenerate-interleaved-storage-index-file`\nd4dbb6bfb [Dongfa,Huang] Avoid useless verify if LedgerEntryRequest completed\n5c150f283 [Enrico Olivelli] Release notes for 4.9.1\n1246826ba [Yong Zhang] Migrate command `recover`\n1d4cc71fd [Yong Zhang] Migrate command `localconsistencycheck`\n67f83620e [Yong Zhang] Migrate command `readledger`\nbfbd6b023 [Yong Zhang] Migrate command `decommission`\nd40b8b69f [Yong Zhang] Migrate command `readlog`\n95d145a15 [Yong Zhang] Migrate command `nukeexistingcluster`\ne2b1dc7f3 [Yong Zhang] Migrate command `listunderreplicated`\n0988e12c7 [bd2019us] ISSUE #2023: change cached thread pool to fixed thread pool\n6a6d7bbd9 [Yong Zhang] Migrate command `initnewcluster`\nc391fe58d [Yong Zhang] Migrate command `readlogmetadata`\n120d67737 [Yong Zhang] Migrate command `lostbookierecoverydelay`\nbf66235e5 [Yong Zhang] Migrate command `deleteledger`\n751e55fa4 [Arvin] ISSUE #2020: close db properly to avoid open RocksDB failure at the second time\n138a7ae85 [Yong Zhang] Migrate command `metadataformat`\nb043d1694 [Yong Zhang] Migrate command `listledgers`\n4573285db [Ivan Kelly] Docker autobuild hook\ne3d807a32 [Like] Fix IDE complain as there are multi choices for error code\n9524a9f4a [Yong Zhang] Migrate command `readjournal`\n6c3f33f55 [Yong Zhang] Fix when met unexpect entry id crashed\ne35a108c7 [Like] Fix error message for unrecognized number-of-bookies\n5902ee27b [Boyang Jerry Peng] fix potential NPE when releasing entry that is null\n6aa73ce05 [Ivan Kelly] [RELEASE] Update website to include documentation for 4.8.2\n1448d12aa [Yong Zhang] Migrate command `listfilesondisk`\n4de598379 [Yong Zhang] Issue #1987: Migrate command `convert-to-interleaved-storage`\n468743e7e [Matteo Merli] In DbLedgerStorage use default values when config key is present but empty\nf26a4cae0 [Ivan Kelly] Release notes for v4.8.2\nec2636cd2 [Yong Zhang] Issue #1985: Migrate command `convert-to-db-storage`\n8cc7239ac [Yong Zhang] Issue #1982: Migrate command `bookiesanity`\nfa90f0185 [Yong Zhang] Issue #1980: Migrate command `ledger` from shell to bkctl","Date":"Fri May 17 09:39:12 CEST 2019"},{"Commit-ID":"commit 36be8362399341022c8de64f9319270726df2cb3 1558114723 -----sp","Author":"PersonIdent[karanmehta93, k.mehta@salesforce.com, Fri May 17 10:38:43 2019 -0700]","Body":"Update and flush lastLogMark when replaying journal\n\nDescriptions of the changes in this PR:\r\n\r\nUpdate `lastLogMark` in memory after replaying each journal\r\nCheck for writable ledger dirs with `minUsableSizeForEntryLogCreation` to flush the `lastMark` file for bookies in ReadOnlyMode\r\nLog line changes\r\n\r\n### Motivation\r\n\r\nMaster Issue: #2087 \r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Charan Reddy Guttapalem <reddycharan18@gmail.com>, Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #2090 from karanmehta93/master and squashes the following commits:\n\nf802cf6da [Karan Mehta] Fixed small issue in constuctor chaining in BookKeeperClusterTestCase\n407e9f1ff [Karan Mehta] Moved lastLogMark updation logic to Journal.java\n585313196 [Karan Mehta] Fix checkstyle errors\nc3d47014a [Karan Mehta] Fix testJournalLogAddEntryCalledCorrectly test\nc72b7b55e [Karan Mehta] Addressed nit\n5d238f2b7 [Karan Mehta] Refactored code to update lastLogMark only when replaying journal and addressed nits\nb5515697f [Karan Mehta] Issue #2087 Update and flush lastLogMark when replaying journal\nd35aa22ad [Charan Reddy Guttapalem] Move common placementpolicy components to TopologyAwareEnsemblePlacementPolicy.","Date":"Fri May 17 19:38:43 CEST 2019"},{"Commit-ID":"commit 7fbd3620a09852e5ac7a4c206bcf2d070151db03 1558320334 -----sp","Author":"PersonIdent[hello zepp, jingtianyy@qq.com, Mon May 20 10:45:35 2019 +0800]","Body":"[SITE] modify nettyMaxFrameSizeBytes Description\n\nDescriptions of the changes in this PR:\r\n\r\nFixes #2079\r\n\r\n### Motivation\r\nwhen the client-side attempt to send more than the default size bytes, it should set up the corresponding parameter `setNettyMaxFrameSizeBytes(int maxSize)`\r\n\r\n(Explain: why you're making that change, what is the problem you're trying to solve)\r\n\r\nMaster Issue: #2079 \r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2086 from hellozepp/issue-2079","Date":"Mon May 20 04:45:35 CEST 2019"},{"Commit-ID":"commit dba831375ad0f10821c04258fb08f70cce3f4b67 1558320718 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Mon May 20 10:51:58 2019 +0800]","Body":"Fallback to use v3 protocol for some types of requests if they are not implemented in v2\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\n#2071 \r\n\r\n### Changes\r\n\r\n- Add a client pool use v3 wire protocol\r\n- Obtain client by version\r\n- Currently only support `writeLac` and `readLac`\r\n\r\nMaster Issue: #2071 \n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2085 from zymap/compatible_protocol","Date":"Mon May 20 04:51:58 CEST 2019"},{"Commit-ID":"commit 26e8004e6b93f5acaff7f69dba14511a7cf44d58 1558320816 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Sun May 19 19:53:36 2019 -0700]","Body":"Fix flaky testIOVertexHTTPServerEndpointForARWithPrometheusProvider test\n\nDescriptions of the changes in this PR:\r\n\r\n- in testIOVertexHTTPServerEndpointForARWithPrometheusProvider test\r\nit is not correct to assume that Auditor would have been created and\r\nstarted completely when we complete AutoRecoveryMain.start and see it\r\nstatus as started. It would make sure AuditorElector.submitElectionTask\r\nhas submitted election task but not the completion of Auditor.start.\r\nSo instead of relying on Auditor metric (NUM_UNDER_REPLICATED_LEDGERS),\r\nuse ReplicationWorker metric - NUM_FULL_OR_PARTIAL_LEDGERS_REPLICATED.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2093 from reddycharan/fixflakytest","Date":"Mon May 20 04:53:36 CEST 2019"},{"Commit-ID":"commit f89e3fbb751fbef7012e695ed5873eade13ba4f5 1559314153 -----sp","Author":"PersonIdent[karanmehta93, k.mehta@salesforce.com, Fri May 31 09:49:13 2019 -0500]","Body":"Update lastLogMark to EOF when replaying journal\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n \r\nThe [commit](https://github.com/apache/bookkeeper/commit/36be8362399341022c8de64f9319270726df2cb3) caused integration test failure `test101_RegenerateIndex`, with the exception\r\n```\r\n```java.io.IOException: Invalid argument\r\n    at sun.nio.ch.FileDispatcherImpl.read0(Native Method)\r\n    at sun.nio.ch.FileDispatcherImpl.read(FileDispatcherImpl.java:46)\r\n    at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)\r\n    at sun.nio.ch.IOUtil.read(IOUtil.java:197)\r\n    at sun.nio.ch.FileChannelImpl.read(FileChannelImpl.java:159)\r\n    at org.apache.bookkeeper.bookie.JournalChannel.read(JournalChannel.java:257)\r\n    at org.apache.bookkeeper.bookie.Journal.fullRead(Journal.java:1171)\r\n    at org.apache.bookkeeper.bookie.Journal.scanJournal(Journal.java:792)\r\n    at org.apache.bookkeeper.bookie.Bookie.replay(Bookie.java:924)\r\n    at org.apache.bookkeeper.bookie.Bookie.readJournal(Bookie.java:886)\r\n    at org.apache.bookkeeper.bookie.Bookie.start(Bookie.java:943)\r\n    at org.apache.bookkeeper.proto.BookieServer.start(BookieServer.java:141)\r\n    at org.apache.bookkeeper.server.service.BookieService.doStart(BookieService.java:58)\r\n    at org.apache.bookkeeper.common.component.AbstractLifecycleComponent.start(AbstractLifecycleComponent.java:78)\r\n    at org.apache.bookkeeper.common.component.LifecycleComponentStack.lambda$start$2(LifecycleComponentStack.java:113)\r\n    at com.google.common.collect.ImmutableList.forEach(ImmutableList.java:408)\r\n    at org.apache.bookkeeper.common.component.LifecycleComponentStack.start(LifecycleComponentStack.java:113)\r\n    at org.apache.bookkeeper.common.component.ComponentStarter.startComponent(ComponentStarter.java:80)\r\n    at org.apache.bookkeeper.server.Main.doMain(Main.java:229)\r\n    at org.apache.bookkeeper.server.Main.main(Main.java:203)\r\n```\r\n\r\nAs discussed on slack, it is hard to figure out an exact reason as to why the native JNI call fails with an invalid argument. Hence this PR proposes that the `lastLogMark` is updated to journal EOF instead of an arbitrary LONG.MAX_VALUE. The FileChannel interface defines that the implementors can pass in any long offset and the file handler should return EOF immediately when trying to read it. However it doesn't seem to be working as expected.\r\n\r\n### Changes\r\n\r\nUpdated `Journal#setLastLogMark()` method to accept an `scanOffset` instead of constant `LONG.MAX_VALUE`.\r\n\r\nivankelly eolivelli \n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2105 from karanmehta93/master","Date":"Fri May 31 16:49:13 CEST 2019"},{"Commit-ID":"commit b88f4b813f5ee5846b4879972e2c8359ac0eb4f2 1559348695 -----sp","Author":"PersonIdent[Ankit Jain, ankit.mcs@gmail.com, Fri May 31 17:24:55 2019 -0700]","Body":"Entries must be acknowledged by bookies in multiple fault domains before being acknowledged to client\n\nDescriptions of the changes in this PR:\r\n\r\nBookkeeper write logic makes sure that there are at least ackQuorumSize\r\nnumber of successful writes before sending ack back to the client. In\r\nmany cases these may fall into the same fault domain. A mechanism to\r\nforce bookkeeper to make sure that there are acks from at least\r\nminNumRacksPerWriteQuorum number of fault domains and a configuration\r\nto enforce this.\r\n\r\nSigned-off-by: Ankit Jain <jain.asalesforce.com>\r\n\r\nMaster Issue: #2095 \n\nReviewers: Charan Reddy Guttapalem <reddycharan18@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2096 from ankit-j/ankit-j/enforceFragmentMultipleFaultDomainWrite and squashes the following commits:\n\nc90fd5a3d [Ankit Jain] Addressing review comments\n07deae673 [Ankit Jain] Addressing @reddycharan's review comments\n14164e291 [Ankit Jain] Fixed spacing error in bk_server.yaml\n22c8b3c03 [Ankit Jain] Updated testing.\n917ed1c45 [Ankit Jain] Move readLock.unlock to finally block\n78e0cd501 [Ankit Jain] Modify test to not use default rack for bookies\nca0bc3b8b [Ankit Jain] Entries must be acknowledged by bookies in multiple fault domains before being acknowledged to client\nd35aa22ad [Charan Reddy Guttapalem] Move common placementpolicy components to TopologyAwareEnsemblePlacementPolicy.","Date":"Sat Jun 01 02:24:55 CEST 2019"},{"Commit-ID":"commit 4fe353425ef6e6df1a04cd1be541139881abae9b 1559806287 -----sp","Author":"PersonIdent[zhaohaidao, zhaohaidao2008@hotmail.com, Thu Jun 6 15:31:27 2019 +0800]","Body":"ISSUE #1927: fix NoNodeException in LocalBookeeper\n\n### Motivation\r\nIt addresses #1927 where it provides a conf check at the beginning of startLocalBookiesInternal function.\r\n### Changes\r\n\r\n- Add a conf check at the beginning of startLocalBookiesInternal function where non-default zkLedgersRootPath is not allowed.\r\n\r\ncc sijie \n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2082 from zhaohaidao/master, closes #1927","Date":"Thu Jun 06 09:31:27 CEST 2019"},{"Commit-ID":"commit fb8b58e9dff3fcdb30cf8faabff442d683922232 1559811523 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Thu Jun 6 01:58:43 2019 -0700]","Body":"Update distributedlog library to use NoSuchLedgerExistsOnMetadataServer\n\n*Motivation*\r\n\r\nIssue #2066 introduced `NoSuchLedgerExistsOnMetadataServer`. But the distributedlog\r\nlibrary is not updated to reflect to this change.\r\n\r\n*Modifications*\r\n\r\nChange to use `NoSuchLedgerExistsOnMetadataServer` in the right place.\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2102 from sijie/fix_failure_test","Date":"Thu Jun 06 10:58:43 CEST 2019"},{"Commit-ID":"commit 839cf3c09add5ed0c33980adbdfced3bb83bba4d 1559921158 -----sp","Author":"PersonIdent[karanmehta93, k.mehta@salesforce.com, Fri Jun 7 10:25:58 2019 -0500]","Body":"Display filesystem and docker info for all jenkins runs\n\nDescriptions of the changes in this PR:\r\n\r\nChanges to shell commands in few scripts\r\n\r\n### Motivation\r\n\r\nIt was difficult to reproduce jenkins test failures locally and the cause might be due to differences in underlying file system. These commands will output more information to spot the exact differences.\r\n\r\n### Changes\r\n\r\nRunning `df` command with an additional `-T` parameter to output filesystem information\r\nAdded `docker info` command to print docker details before every test run\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2107 from karanmehta93/master","Date":"Fri Jun 07 17:25:58 CEST 2019"},{"Commit-ID":"commit be3bdd0fa20f818158c25f6b59fcfc89d82c4734 1559921224 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Fri Jun 7 08:27:04 2019 -0700]","Body":"Bring back statslogger to BookKeeper client in ReplicationWorker process.\n\n\r\nDescriptions of the changes in this PR:\r\n\r\nbd2b16e880d172d4761461fdbf85c1bd19b24e36 is supposed to fix this issue,\r\nbut it missed passing statsLogger to createBookKeeperClient method.\r\n\r\nFor more info. check desc. of bd2b16e880d172d4761461fdbf85c1bd19b24e36.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2108 from reddycharan/enablebookieclientlogger","Date":"Fri Jun 07 17:27:04 CEST 2019"},{"Commit-ID":"commit 6820f890343e51a6b2b1c9544b90dc1c6ca40dea 1560203831 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Mon Jun 10 14:57:11 2019 -0700]","Body":"Testcase for limitStatsLogging.\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\nbd2b16e880d172d4761461fdbf85c1bd19b24e36 had introduced\r\n'limitStatsLogging' feature, which would be used to limit statslogging,\r\nwhere it is needed. eg - we would like to suppress logs from PCBC\r\nin Auditor/ReplicationWorker process.\r\n\r\nIn this commit I'm adding testcases for this feature.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2109 from reddycharan/testlimitstatslogging","Date":"Mon Jun 10 23:57:11 CEST 2019"},{"Commit-ID":"commit f719fb002b6f4f1d73c944e7d3a39d39f79b581c 1560417729 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Jun 13 02:22:09 2019 -0700]","Body":"Use https for Twitter maven repo\n\n### Motivation\r\n\r\nFetch the maven dependencies through HTTPs \n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2100 from merlimat/merlimat-patch-1","Date":"Thu Jun 13 11:22:09 CEST 2019"},{"Commit-ID":"commit 533dd5d6e9d3ac9b24d2462f6ae4d4240a4bffdf 1561034171 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Thu Jun 20 14:36:11 2019 +0200]","Body":"[DLOG] Delete empty inprogress segment on recovery\n\nThis addresses an issue, whereby if a user is using getLastTxId() to\r\nfind the first txnid when starting to write, they will continue to be\r\nable to write if the last segment written by the previous writer was\r\nempty. If the last segment was empty, then the maxTxId would be higher\r\nthan the result of getLastTxId(). maxTxId is read from a znode, while\r\ngetLastTxId() reads the txid of the last persisted record. In the case\r\nof an empty inprogress segment, the maxTxId znode was being updated\r\nwith the expected first transaction id of the segment.\r\n\r\nThis patch addresses the issue with the following changes:\r\n1. The maxTxId znode is only updated when inprogress segment is\r\n   completed, so it's value always refers to a transaction that\r\n   exists.\r\n2. On recovery, if the inprogress segment is empty, delete it. There\r\n   was a TODO comment to do this already there.\r\n3. When generating the sequence number, allow a potential sequence\r\n   number which is equal to the current max sequence number, as this\r\n   can be the case where recovery deleted an inprogress empty segment.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2099 from ivankelly/txnid-issue","Date":"Thu Jun 20 14:36:11 CEST 2019"},{"Commit-ID":"commit 96fc2e2aac4d026fe336ae8347521d9910165dd5 1561087193 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Thu Jun 20 20:19:53 2019 -0700]","Body":"Issue #1970: Ensure getStickyReadBookieIndex returns valid bookie index\n\nDescriptions of the changes in this PR:\r\n\r\nMaster Issue: #1970\r\nRelated Issues: apache/pulsar#3715 apache/pulsar#4526\r\n\r\n*Motivation*\r\n\r\nFixes #1970\r\n\r\nBy default bookie uses a random generator to generate a bookie index as the sticky\r\nread bookie index. However the random generator will generate negative numbers. Hence\r\nit will generate negative bookie indexes in write set and cause ArrayIndexOutOfBoundException\r\nwhen bookkeeper attempts to read entries.\r\n\r\n*Modifications*\r\n\r\nMake sure getStickyReadBookieIndex not return negative number.\r\n\r\n*Verify this change*\r\n\r\nThis problem introduced by a random generator. It is very hard to write a unit test to reproduce this issue.\r\nExisting StickyRead tests are good to cover this code change.\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <zhaijia@apache.org>, Yong Zhang <zhangyong1025.zy@gmail.com>\n\nThis closes #2111 from sijie/fix_sticky_read, closes #1970","Date":"Fri Jun 21 05:19:53 CEST 2019"},{"Commit-ID":"commit 54ce17312f53c9b2a1ac3ea83303a7bebebc0a31 1561087353 -----sp","Author":"PersonIdent[Hugo Abreu, 6619758+hugomiguelabreu@users.noreply.github.com, Fri Jun 21 04:22:33 2019 +0100]","Body":"Added zookeeper host configuration. Closes #1960\n\nDescriptions of the changes in this PR:\r\nAdded host IP binding to sandbox.\r\n\r\n### Motivation\r\nAllowing running the sandbox inside guest machines and be accessible by all system (including other guest machines). When binding 127.0.0.1 other guest machines will experience an error. By allowing to bind the correct IP the namespace will be available and correctly configured for other hosts.\r\n\r\n### Changes\r\nAdded a new argument to the _dlog_ tool allowing to define the host IP to bind ZooKeeper and DistributedLog namespace.\r\n\r\nMaster Issue: #1960\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2081 from hugomiguelabreu/master, closes #1960","Date":"Fri Jun 21 05:22:33 CEST 2019"},{"Commit-ID":"commit b34162a932b93a7e65451dce3f6e10bfda707997 1561443472 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Mon Jun 24 23:17:52 2019 -0700]","Body":"Implementation of ZoneawareEnsemblePlacementPolicy\n\n\r\nDescriptions of the changes in this PR:\r\n\r\nImplementation of ZoneawareEnsemblePlacementPolicy\r\n\r\n- This is meant to be used in public cloud infrastructure in which\r\nAvailability zones (AZs) are isolated locations within data center\r\nregions from which public cloud services originate and operate.\r\n- ZoneawareEnsemblePlacementPolicy is a placement policy implementation\r\nwhich uses zone information for placing ensembles.\r\n- In this PlacementPolicy, it is assumed the networktopology/networklocation\r\n is going to be two level tree, where first part indicates zoneid\r\nand the second part indicates upgradedomainid.\r\n- Here upgrade domain is a set of bookies in an AZ that can be brought\r\ndown together for short term maintenance with no impact to the service.\r\nThis would help in enabling parallel patching.\r\n- Upgrade domain is a logic concept/division and it may be mapped to\r\ncloud provider native cluster/grouping like Placement Groups in AWS.\r\n\r\nIntroduce soft PlacementPolicyAdherence\r\n\r\n- for ZoneawarePlacementPolicy if in a writeset the number\r\nof zones are in between minnumofzones and desirednumofzones\r\nthen it is considered MEETS_SOFT.\r\n- if all of the writesets have zones >= desirednumofzones\r\nthen it is considered MEETS_STRICT\r\n- if a writeset contains < minnumofzones then it is considered\r\nFAIL\r\n- add corresponding metric for PlacementPolicyAdherence.MEETS_SOFT\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #2113 from reddycharan/zoneawareplacementpolicycommunitybranch","Date":"Tue Jun 25 08:17:52 CEST 2019"},{"Commit-ID":"commit 762a61365408d81a20193ef4ae1d44394746c105 1562918515 -----sp","Author":"PersonIdent[Matteo Minardi, minardi.matteo@hotmail.it, Fri Jul 12 10:01:55 2019 +0200]","Body":"Implement a method to get all the Bookies\n\nIn this PR I'm adding a `BokKeeperAdmin#getAllBookies` to retrive all the bookies (cookie) retriving them from the `RegistrationClient`\r\n\r\nThis is still a work in progress, I'm adding some tests in the next commit.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2117 from mino181295/allbookies","Date":"Fri Jul 12 10:01:55 CEST 2019"},{"Commit-ID":"commit 6b892a45f02a6d8d0b1d33235d4134d91e3ea111 1562918590 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Fri Jul 12 01:03:10 2019 -0700]","Body":"[BK-SERVER] Clean up over-replicated ledgers owned by different bookies\n\n### Motivation\r\nAs described at: https://github.com/apache/pulsar/issues/4632\r\n- Sometimes due to overreplication, bookie contains ledgers which are not owned by that bookie anymore and that bookie is not part of the ensemble-list of those ledgers. In this case, GC finds out those overreplicated ledgers and \r\n- deletes their index from dbStorage (rocksDB) and \r\n- tries to delete them from entrylog files.\r\n\r\nHowever, bookie doesn't delete them from entry-log files due to change made in [#870](https://github.com/apache/bookkeeper/issues/870) where bookie avoids deleting ledger if znode of that ledger exists.\r\n\r\nBecause of that bookie ends up storing large number entrylog files with ledgers which are owned by different bookies. It also cause OOM when GC tries to deal with large number of entry log files.\r\n\r\n### Modification\r\n\r\nDelete the ledgers if bookie is not part of ensemble list of over-replicated ledgers\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2119 from rdhabalia/overRepl","Date":"Fri Jul 12 10:03:10 CEST 2019"},{"Commit-ID":"commit 1adc93f05954fdb06d7e8b548d606e281831924a 1562918686 -----sp","Author":"PersonIdent[massakam, massakam@yahoo-corp.jp, Fri Jul 12 17:04:46 2019 +0900]","Body":"Issue #2103: Avoid stop of entry log compaction\n\n### Motivation\r\n\r\nAs mentioned in #2103, if an exception occurs during compaction of a specific entry log, `GarbageCollectorThread` does not perform compaction of other entry logs until the bookie server is restarted. As a result, the number of entry logs continues to increase and eventually it will run out of disk space.\r\n\r\n### Changes\r\n\r\nThe cause of the compaction stop is that the `compacting` flag remains true if `compactor.compact(entryLogMeta)` throws some exception.\r\nhttps://github.com/apache/bookkeeper/blob/b2e099bbc7b13f13825fe78ab009ca132cb3a9ba/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollectorThread.java#L504-L519\r\n\r\nTherefore, fixed `GarbageCollectorThread` so that it set the compaction flag to false even if compaction of a specific entry log fails.\r\n\r\nMaster Issue: #2103\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2121 from massakam/entry-log-compaction, closes #2103","Date":"Fri Jul 12 10:04:46 CEST 2019"},{"Commit-ID":"commit ecf1c715f88feb8bcaf08b9063f774b0443f7ead 1563349299 -----sp","Author":"PersonIdent[Hugo Abreu, 6619758+hugomiguelabreu@users.noreply.github.com, Wed Jul 17 08:41:39 2019 +0100]","Body":"Issue #1961: Included ZooKeeper client AclId.\n\nDescriptions of the changes in this PR:\r\nIncluded ZooKeeper Acl to the builder.\r\n\r\n### Changes\r\n\r\nIt is now possible to unbind DistributedLog namesapaces.\r\n\r\nMaster Issue: #1961\r\n\r\n\nReviewers: Ivan Kelly <ivank@apache.org>, Sijie Guo <None>\n\nThis closes #2118 from hugomiguelabreu/master, closes #1961","Date":"Wed Jul 17 09:41:39 CEST 2019"},{"Commit-ID":"commit eecb259de2ac2d2995aab0aa29263529a69a698d 1563349565 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Jul 17 00:46:05 2019 -0700]","Body":"Website update for 4.9.2 release\n\nAdded 4.9.2 release to website\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <None>\n\nThis closes #2098 from merlimat/master","Date":"Wed Jul 17 09:46:05 CEST 2019"},{"Commit-ID":"commit b182b7478687328126a6aced27d5359fdf280e5c 1563551320 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Fri Jul 19 16:48:40 2019 +0100]","Body":"[CI] Prune networks older than 12h\n\nPreviously we were using a filter which matched on the network name of\r\nthe networks we create. However, docker seems to have removed this\r\nfunctionality, so now we just prune all unused networks which are more\r\nthan 12h old (no CI job should be taking more than 12h).\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2126 from ivankelly/ci-failure","Date":"Fri Jul 19 17:48:40 CEST 2019"},{"Commit-ID":"commit 2a1cfe249830f8dee0570031c8d0c132c32fe24e 1563585266 -----sp","Author":"PersonIdent[vzhikserg, vzhikserg@users.noreply.github.com, Sat Jul 20 03:14:26 2019 +0200]","Body":"Fix log statements with incorrect placeholders\n\n### Changes\r\n\r\nThe following changes were made:\r\n\r\n- remove unused placeholders in the log statements\r\n- add missing placeholders to the log strings to show the complete information\r\n- remove unnecessary initialization of object arrays in the log statements \n\nReviewers: Sijie Guo <None>\n\nThis closes #2123 from vzhikserg/fix-log-statements","Date":"Sat Jul 20 03:14:26 CEST 2019"},{"Commit-ID":"commit df24f672ae7d0f9503980cd0a8f782470f6e663b 1563585330 -----sp","Author":"PersonIdent[vzhikserg, vzhikserg@users.noreply.github.com, Sat Jul 20 03:15:30 2019 +0200]","Body":"Use bulk operation instead of iteration\n\n### Changes\r\n\r\n* Use the `addAll` method instead of iteration\n\nReviewers: Sijie Guo <None>\n\nThis closes #2122 from vzhikserg/bulk-call-instead-of-iteration","Date":"Sat Jul 20 03:15:30 CEST 2019"},{"Commit-ID":"commit 5a3fa848f1817d447446f8250de559d631b81487 1563689692 -----sp","Author":"PersonIdent[Matteo Minardi, minardi.matteo@hotmail.it, Sun Jul 21 08:14:52 2019 +0200]","Body":"Issue #2124: Test 'ListBookiesCommand ' is failing\n\nIntroduced and fixed the tests involving the ListBookiesCommand\r\n\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <None>\n\nThis closes #2125 from mino181295/fix/test-cmd-list, closes #2124","Date":"Sun Jul 21 08:14:52 CEST 2019"},{"Commit-ID":"commit 86e8a72c7fcfb38b76bcbf434df586f3dc00a2af 1563740935 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Sun Jul 21 13:28:55 2019 -0700]","Body":"Implementation of new scrutiny - replicas check (Part-1)\n\nDescriptions of the changes in this PR:\r\n\r\n- this is implementation of scrutiny mentioned in\r\nhttps://github.com/apache/bookkeeper/blob/master/site/bps/BP-34-cluster-metadata-checker.md\r\n- In this commit, urLedgersElapsedRecoveryGracePeriod check is added to placementPolicyCheck.\r\n- new scrutiny is added replicasCheck and it is disabled by default.\r\n- this is first part of replicas check, in this part currently metrics are not added and\r\nalso delayed replicas check for potentially faulty ledgers (failure in trying to get\r\ninfo. from Bookie of the ensembles of the ledger) is not added.\r\n- have to add more failure test scenarios for replicas check logic.\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2120 from reddycharan/replicascheck and squashes the following commits:\n\nd4dc81e15 [Sijie Guo] Merge remote-tracking branch 'apache/master' into replicascheck\n5a3fa848f [Matteo Minardi] Issue #2124: Test 'ListBookiesCommand ' is failing\ndf24f672a [vzhikserg] Use bulk operation instead of iteration\n2a1cfe249 [vzhikserg] Fix log statements with incorrect placeholders","Date":"Sun Jul 21 22:28:55 CEST 2019"},{"Commit-ID":"commit 5311e00f399ae3b5cb39fe03d8b5dd8c0547de14 1564231627 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Sat Jul 27 14:47:07 2019 +0200]","Body":"Make build pass on JDK11, fix javadoc configuration\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nBuild fails on recent JDK11 versions and on JDK11, see #2133, this is because javadoc has problems with references to core Java API when source version is set to 8.\r\n\r\n### Changes\r\nUpgrade Java doc plugin to latest 3.1.1 and disable auto linking to core Java classes with\r\n`<detectJavaApiLink>false<\/detectJavaApiLink>\r\n`\r\nCloses #2133\r\n\r\n\r\n\n\nReviewers: Sijie Guo <None>\n\nThis closes #2134 from eolivelli/fix/javadoc-jdk11","Date":"Sat Jul 27 14:47:07 CEST 2019"},{"Commit-ID":"commit 38e0c2d3ccc1a3f31c6c1f47c5ab059962eb1a8b 1564231736 -----sp","Author":"PersonIdent[Pavan Kumar Chaitanya L, pavan.kumar.chaitanya@gmail.com, Sat Jul 27 05:48:56 2019 -0700]","Body":"Issue #2130 : Fix for broken URLs\n\nFixed broken URLs in README for Programmer Guide, Tutorial and Java API.\r\n\r\nDescriptions of the changes in this PR:\r\n\r\nUpdated the URLs.\r\n\r\n### Motivation\r\nWanted to go through the tutorial when I came to the repo and found the links were broken in the README.\r\n### Changes\r\n\r\n\r\nMaster Issue: #2130\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2131 from pavankumarchaitanya/master, closes #2130","Date":"Sat Jul 27 14:48:56 CEST 2019"},{"Commit-ID":"commit 832853d7c156e3ea76add272627082a4eb653ef0 1564380524 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Mon Jul 29 08:08:44 2019 +0200]","Body":"Upgrade to latest Maven version 3.6.1\n\n### Motivation\r\n- ASF CI does not support Maven 3.5.0\r\n- Maven 3.5.0 is a very old version\r\n\r\n### Changes\r\n\r\n- update Jenkins DSL files to \"Maven (latest)\"\r\n- update release procedure to Maven 3.6.1\r\n- update docker based dev environment to use Maven 3.6.1 + jdk11 (it was 3.5.0 + legacy jdk9)\r\n\r\n\r\n\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #2135 from eolivelli/fix/upgrade-maven","Date":"Mon Jul 29 08:08:44 CEST 2019"},{"Commit-ID":"commit 60ff4ec791f94362eee9aecc67670cbdbf2b2ee6 1564380674 -----sp","Author":"PersonIdent[BINLEI XUE, kongpo0412@gmail.com, Mon Jul 29 14:11:14 2019 +0800]","Body":"Issue #2127: Allow user override default SASL service name bookkeeper\n\nDescriptions of the changes in this PR:\r\ndefault SASL service name \"bookkeeper\" can be override by JVM property \"bookkeeper.sasl.servicename\"\r\n\r\n### Motivation\r\n\r\n\r\n\r\n### Changes\r\n\r\nInstead of use a constant value, it would read from JVM property first, if it doesn't exists, then use default value from constant variable SaslConstants.SASL_BOOKKEEPER_PROTOCOL\r\n\r\nMaster Issue: #2127\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <zhaijia@apache.org>, Sijie Guo\n\nThis closes #2128 from 29x10/master, closes #2127","Date":"Mon Jul 29 08:11:14 CEST 2019"},{"Commit-ID":"commit 1ff4438858df888141a31e4049ba8ad845c9cc10 1564400940 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Mon Jul 29 13:49:00 2019 +0200]","Body":"Make default Bookie scripts work on JDK11+\n\n- detect new Java versions in bin/common.sh\r\n- use different defaults on JDK8 vs JDK11+\r\n\r\nDescriptions of the changes in this PR:\r\nChange distribution scripts in order to detect a JDK newer then JDK8 and set default JVM options accordingly.\r\n\r\n### Motivation\r\n\r\nBecause I want that BookKeeper tools run out of the box with JDK11\r\n\r\n### Changes\r\n1) detect a JDK newer then JDK8, but checking if exists $JAVA_HOME/bin/jshell (this is quite robust, better then parsing some Java version string)\r\n2) use new defaults for JDK11, in particular do not enable experimental and deprecated options, use the new [Java Unified Logging](https://openjdk.java.net/jeps/158) log system for GC\r\n\r\nPlease note the output of \"Java Unified Logging\" is very different from the old pre-Java9 one and \r\noptions are different, there is no simple port.\r\n\r\nMaster Issue: #1912\r\n\r\n\r\n\n\nReviewers: Sijie Guo <None>\n\nThis closes #2132 from eolivelli/fix/run-jdk11","Date":"Mon Jul 29 13:49:00 CEST 2019"},{"Commit-ID":"commit 1df8ae9abd2069d7db7f5551ec7cb1de1b9e3bae 1564401140 -----sp","Author":"PersonIdent[vzhikserg, vzhikserg@users.noreply.github.com, Mon Jul 29 13:52:20 2019 +0200]","Body":"Remove redundant array creation\n\n### Changes\r\n\r\nRemove redundant array creation in log statements to simplify the code.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2129 from vzhikserg/remove-redundant-array-creation","Date":"Mon Jul 29 13:52:20 CEST 2019"},{"Commit-ID":"commit 0034fe684136e318d1a7e8b384968d703d2dd8c4 1565015297 -----sp","Author":"PersonIdent[Sergii Zhevzhyk, vzhikserg@users.noreply.github.com, Mon Aug 5 16:28:17 2019 +0200]","Body":"Replace C style array declaration with Java style\n\n### Motivation\r\n\r\nThe C style array definitions look weird for a Java developer.\r\n\r\n### Changes\r\n\r\nAll C style array declarations were updated with the Java array declarations and the stylechecker rule was added to enforce the Java way. \n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2139 from vzhikserg/replace-c-style-array-declaration-with-java-style","Date":"Mon Aug 05 16:28:17 CEST 2019"},{"Commit-ID":"commit 9540d8473ebbe49425ece1088047cd544e8427f9 1565718819 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Tue Aug 13 10:53:39 2019 -0700]","Body":"Replicascheck comprehensive testcases.\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n- adding comprehensive testcases for newly added\r\nscrutiny - replicasCheck.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2141 from reddycharan/replicaschecktest","Date":"Tue Aug 13 19:53:39 CEST 2019"},{"Commit-ID":"commit 9e34c9a7e75b87441c2455139a715e39ff985f43 1566558959 -----sp","Author":"PersonIdent[Sergii Zhevzhyk, vzhikserg@users.noreply.github.com, Fri Aug 23 13:15:59 2019 +0200]","Body":"Simplify if statements\n\n### Changes\r\n\r\n* Simplify `if` statements where it is possible (mainly for `if` statements returning boolean values)\r\n* Remove redundant semicolons\r\n* Remove the `close` method where the resource is used withing the try-with-resources block\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2137 from vzhikserg/simplify-if-statements","Date":"Fri Aug 23 13:15:59 CEST 2019"},{"Commit-ID":"commit f1df81f6590e048b93ec21776f931a28f0468a45 1566843315 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Mon Aug 26 11:15:15 2019 -0700]","Body":"Journal should respect to `flushWhenQueueEmpty` setting\n\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nCurrently journal doesn't respect to `flushWhenQueueEmpty` setting.\r\nEven `flushWhenQueueEmpty` is set to false, we can still see flushes\r\ntriggered due to queue empty.\r\n\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <zhaijia@apache.org>\n\nThis closes #2147 from sijie/fix_flush_when_empty","Date":"Mon Aug 26 20:15:15 CEST 2019"},{"Commit-ID":"commit 171e2f914c05357d9e81c7e951f5c86a0f463a75 1566843368 -----sp","Author":"PersonIdent[Sijie Guo, guosijie@gmail.com, Mon Aug 26 11:16:08 2019 -0700]","Body":"Improve journal throughput when journalSyncData is disabled.\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nThere was a weird behavior observed: when `journalSyncData` is disabled, the journal throughput decreased with multiple journal dirs on same journal disk.\r\n\r\nThe problem is when `journalSyncData` is disabled, we still sync data to disk when rolling the journal file. The sync time increases to multiple seconds, because it has to flush all the files to disk and wait the whole sync operation to be completed.\r\n\r\n### Changes\r\n\r\nwhen `journalSyncData` is disabled, we trigger callbacks when the data is flushed to filesystem but still enqueue a fsync request to force write queue to make sure we still fsync data frequently.\r\n\r\nAlso added a journal perf tool to do performance testing on journal.\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <zhaijia@apache.org>, Matteo Merli <mmerli@apache.org>\n\nThis closes #2150 from sijie/journal_perf","Date":"Mon Aug 26 20:16:08 CEST 2019"},{"Commit-ID":"commit 4487cee4f14bd495a9b02071e0bdd0fc7df0dbf6 1566884867 -----sp","Author":"PersonIdent[Fangbin Sun, sunfangbin@gmail.com, Tue Aug 27 13:47:47 2019 +0800]","Body":"Issue #2152: Amend disk usage warn log\n\n### Motivation\r\n\r\nFixes #2152\r\n\r\n### Changes\r\n\r\nReplace `diskUsageThreshold` by `diskUsageWarnThreshold` when disk usage threshold doesn't trigger first.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2153 from murong00/branch-2153, closes #2152","Date":"Tue Aug 27 07:47:47 CEST 2019"},{"Commit-ID":"commit 4c6cf097d9b823c8e839e176a06266a58bcb7bf5 1567101945 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Thu Aug 29 11:05:45 2019 -0700]","Body":"[BOOKIE] auto refresh tls cert at bookie-server\n\n### Motivation\r\n\r\nRight now, if certs are rotated then bookie doesn't pick up refresh cert and we have to restart the bookie. So, we need a way to auto refresh certs into bookie.\r\n\r\n### Modification\r\n\r\n- add configuration `tlsCertFilesRefreshDurationSeconds` to auto refresh cert\r\n- bookie checks last modified date of the cert after auto-refresh duration and refresh certs if requires\r\n\r\n### Result\r\n\r\n- Bookie can refresh certs without restart.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2154 from rdhabalia/auto_mtls","Date":"Thu Aug 29 20:05:45 CEST 2019"},{"Commit-ID":"commit afd8dbadd8a205fe4de4daa9d0c09680effab49d 1569481604 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Thu Sep 26 09:06:44 2019 +0200]","Body":"Make the project buildable with JDK12 and JDK13\n\nUpgrade Lombok to 1.18.10\r\nUpgrade Groovy and Groovy Compiler and Maven Compiler plugin\r\nFix an inverted if that prevented **bkctl** to work with JDK11+ and it made GC LOGGING opts not applied with JDK8 (in bkctl command), a regression introduced by #2132\n\nReviewers: Ivan Kelly <ivank@apache.org>\n\nThis closes #2160 from eolivelli/fix/build-jdk12","Date":"Thu Sep 26 09:06:44 CEST 2019"},{"Commit-ID":"commit cc9d66aa1826f8d583a9b939a9840657877ed275 1569592786 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Fri Sep 27 15:59:46 2019 +0200]","Body":"Fix tests and upgrade libs to make tests pass on JDK13\n\n- Upgrade Mockito and PowerMock with a version that support JDK12+\r\n- Fix bash script tests\n\nReviewers: Ivan Kelly <ivank@apache.org>\n\nThis closes #2169 from eolivelli/fix/make-tests-pass-jdk13","Date":"Fri Sep 27 15:59:46 CEST 2019"},{"Commit-ID":"commit 7071dac225cb2e4924e4c1e75225e572270a7135 1569592855 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Fri Sep 27 16:00:55 2019 +0200]","Body":"Change Python client version to 4.10.0\n\nAccording to the release guide, before cutting a release we have to remove the 'alpha' qualifier from Python client version\n\nReviewers: Ivan Kelly <ivank@apache.org>\n\nThis closes #2163 from eolivelli/fix/python-client","Date":"Fri Sep 27 16:00:55 CEST 2019"},{"Commit-ID":"commit 6acb63f91136b5c93bc5a30baf4d06cfaf5eacbf 1570003374 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Wed Oct 2 10:02:54 2019 +0200]","Body":"Update bc tests to include versions up to 4.9.x\n\n### Motivation\r\n\r\nWith backward compatibility tests we should cover the compatibility of current version against old versions, current we are only test current version against ancient releases.\r\n\r\nThis change supersedes #1648 from sijie \r\n\r\n### Changes\r\n\r\nChange the list of versions to test clients and bookie upgrade\r\n\r\n\r\n\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nThis closes #2171 from eolivelli/update_bc_tests","Date":"Wed Oct 02 10:02:54 CEST 2019"},{"Commit-ID":"commit 1e63d3c83e89d152cb603955e303b5377d8ab8e6 1570003542 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Oct 2 01:05:42 2019 -0700]","Body":"Avoid throwing exception when doing EntryLogger.internalReadEntry\n\n### Motivation\r\n\r\nIn the refactoring part of #1819, the `internalReadEntry()` behavior was changed into throwing an exception when reading an entry from a different ledger. \r\n\r\nThis is causing a big performance issue when doing read-head from the ledger storage, because we keep reading from the current entry log until we find an entry from a different ledger. \n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2172 from merlimat/read-internal","Date":"Wed Oct 02 10:05:42 CEST 2019"},{"Commit-ID":"commit 2f996dcf0159f945f7ec97ce7402e5d293009444 1570039816 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Wed Oct 2 11:10:16 2019 -0700]","Body":"Enhance deferLedgerLockReleaseOfFailedLedger in ReplicationWorker\n\nDescriptions of the changes in this PR:\r\n\r\n**Issue:** In the past, ReplicationWorker (RW) retrial logic is enhanced to backoff\r\nreplication after threshold number of replication failures of a ledger. This is\r\nto help in a pathological situation where data (ledger/entry) is unavailable.\r\nBut this is sub-optimal solution, since there is possibility that each RW can\r\ntry recovering a ledger threshold number of times, before a RW defers\r\nledgerLockRelease. Also each time a RW tries to recover it would read entry/fragment\r\nsequentially and writes to new bookies until it finds a missing entry (completely\r\nunavailable) before failing on replication of that ledger. This is done for\r\neach retrial and it bloats the storage and overreplication need to detect and\r\ndelete it, which runs once a day by default. So because of this cluster can\r\nrun out of storage space and may become RO cluster. Also this puts quite a bit of\r\nload on cluster in vain.\r\n\r\n**So the new proposal is to**\r\n- On each RW. remember the state in addition to the counter. State must include the entries which RW failed to read.\r\n- Counter and state must kept around in each RW node. And exponential backup should be used for deferLedgerLockReleaseOfFailedLedger\r\n- During next attempt by RW, try to read the failed entries which is noted in the state. Read must be successful before proceeding replicating.\r\n- With this model we avoid duplicate copies on each attempt. At the most each RW will create only one copy\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Venkateswararao Jujjuri (JV) <None>\n\nThis closes #2166 from reddycharan/enhancereplication","Date":"Wed Oct 02 20:10:16 CEST 2019"},{"Commit-ID":"commit 14c9979047bb4ecd30619a9184e446c2e87fec26 1570721468 -----sp","Author":"PersonIdent[karanmehta93, k.mehta@salesforce.com, Thu Oct 10 08:31:08 2019 -0700]","Body":"Add documentation for ByteBuffer lifecycle when adding entries\n\nDescriptions of the changes in this PR:\r\n\r\nAdding documentation for the issue [here](https://github.com/apache/bookkeeper/issues/2138) as discussed [here](https://github.com/apache/bookkeeper/issues/2138#issuecomment-522099668).\r\n\r\nMaster Issue: #2138 \r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2175 from karanmehta93/master","Date":"Thu Oct 10 17:31:08 CEST 2019"},{"Commit-ID":"commit 114de135f402d2f8de045fb9413e804247841def 1570807374 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Fri Oct 11 08:22:54 2019 -0700]","Body":"Call exceptionHandler if Bookie.start fails with exception.\n\n\r\nDescriptions of the changes in this PR:\r\n\r\nWhen main thread of Bookie/BookieServer has exited with exception while starting Bookie,\r\nBookie process shouldn't be alive because of any non-daemon thread that has already\r\nstarted.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Karan Mehta <k.mehta@salesforce.com>\n\nThis closes #2173 from reddycharan/fixbookiestartup","Date":"Fri Oct 11 17:22:54 CEST 2019"},{"Commit-ID":"commit 7c24301856fcc502ae2c595195cf48ac62ffe47d 1571348317 -----sp","Author":"PersonIdent[karanmehta93, k.mehta@salesforce.com, Thu Oct 17 14:38:37 2019 -0700]","Body":"Update maven version to 3.6.2 for Jenkins\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nUpdate maven version to 3.6.2 for Jenkins build environments, since maven 3.6.0 is no longer available in the environment.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Charan Reddy Guttapalem <reddycharan18@gmail.com>\n\nThis closes #2181 from karanmehta93/updateMavenVersion","Date":"Thu Oct 17 23:38:37 CEST 2019"},{"Commit-ID":"commit 4f56edf012de8fbf1e33657b390f01fc823aa2c4 1571820540 -----sp","Author":"PersonIdent[Ivan Kelly, ivank@apache.org, Wed Oct 23 10:49:00 2019 +0200]","Body":"[DLOG] LogReader shouldn't be added to pending if not locking\n\nThe pendingReaders set in BKDistributedLogManager exists so that if\r\nthe manager is closed which the lock is being acquired for a reader,\r\nthat reader will be closed (even though it hasn't been returned to the\r\nclient).\r\n\r\nIn the case that the reader is opened without a lock, there\r\nis not async action being performed. Previously we were also adding\r\nthese readers to the pendingReaders, but they were never being removed\r\nfrom the pendingReaders, causing a memory leak. This change avoids\r\nadding no-locking readers to pendingReaders.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2185 from ivankelly/orphan-reader","Date":"Wed Oct 23 10:49:00 CEST 2019"},{"Commit-ID":"commit 4872b1f2bbdb0cdde72ed7922b8de25dc17f58de 1571952679 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, reddycharan18@gmail.com, Thu Oct 24 14:31:19 2019 -0700]","Body":"Fix logic of areEntriesOfLedgerStoredInTheBookie\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n- in BookKeeperAdmin.areEntriesOfLedgerStoredInTheBookie method, segmentNum\r\nis not correctly incremented while iterating over the segments of\r\nthe ledger. Fixing the logic of it.\r\n- this issue caused decombookie bookieshell command to wait forever.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2186 from reddycharan/fixareledgersstoredcom","Date":"Thu Oct 24 23:31:19 CEST 2019"},{"Commit-ID":"commit 14c445dae3976ec314ec7d1bac0e2d30a9d0e4c0 1571953141 -----sp","Author":"PersonIdent[karanmehta93, k.mehta@salesforce.com, Thu Oct 24 14:39:01 2019 -0700]","Body":"Journal scan should throw IOException when it reads negative length\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nDuring journal replay, we can encounter negative length value if there is journal corruption. Currently, due to this bug, we pass negative length to limit a buffer, which throws IllegalArgumentException.\r\n\r\n### Changes\r\n\r\nUpdated the Journal class to throw `IOException` with a clear message, instead of unclear `IllegalArgumentException`.\r\n\r\nMaster Issue: #2176\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Charan Reddy Guttapalem <reddycharan18@gmail.com>\n\nThis closes #2177 from karanmehta93/master","Date":"Thu Oct 24 23:39:01 CEST 2019"},{"Commit-ID":"commit 798a97eb14da3c00bf73eac14553ab0c06ccca14 1571988021 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Fri Oct 25 09:20:21 2019 +0200]","Body":"Upgrade Apache Parent Pom to 19\n\nDescriptions of the changes in this PR:\r\nUpdate the reference to the common Apache Parent POM, version 19\r\n\r\n\r\n### Motivation\r\nBe up to date with ASF-wide configurations\r\n\r\n### Changes\r\nChange the version\r\n\r\n\r\n\n\nReviewers: Sijie Guo <None>\n\nThis closes #2184 from eolivelli/fix/update-apache-parent","Date":"Fri Oct 25 09:20:21 CEST 2019"},{"Commit-ID":"commit 029e8e0e02d8e384e7d08ca548b593368574cf36 1572062012 -----sp","Author":"PersonIdent[Dapeng, 42792537+SunDapengcmss@users.noreply.github.com, Sat Oct 26 11:53:32 2019 +0800]","Body":"[DOC] Improve the Manual deployment document.\n\n### Motivation\r\nFollowing the [Manual deployment](https://bookkeeper.apache.org/docs/latest/deployment/manual/), startup bookie may have failure since there is no znode(e.g. /ledger) about bookie in zookeeper. \r\n\r\n### Changes\r\n\r\nModify the site/docs/latest/deployment/manual.md, set up cluster metadata before startup of bookie.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2183 from SunDapengcmss/branch-2183","Date":"Sat Oct 26 05:53:32 CEST 2019"},{"Commit-ID":"commit 8559126a3ec00f2b1912d40d37b8bf8a000b0c4b 1572353402 -----sp","Author":"PersonIdent[Anup Ghatage, ghatageanup@gmail.com, Tue Oct 29 05:50:02 2019 -0700]","Body":"Issue #2145: Make ledgerDirs in Cookie consistent across generating a\u2026\n\n\u2026nd setting\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nIn PR #1794 we brought in a way to generate a cookie from command line.\r\nHowever during generation, we have to also encode the ledger dirs by default.\r\n\r\n### Changes\r\n\r\nAdded encoding of ledger dir paths while setting the ledger dirs in a generated cookie in `GenerateCookieCommand.java`.\r\nTweaked existing test to include more than one ledger path for test coverage.\r\n\r\nMaster Issue: #2145 \n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2146 from Ghatage/community/2145, closes #2145 and squashes the following commits:\n\n2de21f854 [Anup Ghatage] Fix checkstyle\n4695675ff [Anup Ghatage] Revert to handling encoding like in generateCookie(), Add another test\n90d02136a [Anup Ghatage] Change GenerateCookieCommandTest's to encodeDirPaths while creating cookies\nd8da5153a [Anup Ghatage] Issue #2145: Make ledgerDirs in Cookie consistent across generating and setting","Date":"Tue Oct 29 13:50:02 CET 2019"},{"Commit-ID":"commit f8a5974a56cd18a613e16a181c76ab538b0e7ec5 1572356046 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Tue Oct 29 06:34:06 2019 -0700]","Body":"Fix firstStoredEntryId logic in LedgerFragment\n\nDescriptions of the changes in this PR:\r\n\r\n- firstStoredEntryId logic in LedgerFragment should return '-1'\r\nonly if no bookie contains any entry of that LedgerFragment.\r\n\r\nThis is a serious issue, in our cluster we observed for a particular ledger, which is marked under replicated, it is returning -1 for firstStoredEntryId and 10 for lastStoredEntryId. Because of that the ReplicationWorker, tries to replicate entryId \u2018-1\u2019 and as expected it keeps failing while reading it. So ledger remains under replicated for ever.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2180 from reddycharan/fixfirststoredentryidcom and squashes the following commits:\n\n3cb8ae443 [Charan Reddy Guttapalem] change Long to long\n9d9db66dd [Charan Reddy Guttapalem] minor log changes\n37b025ccb [Charan Reddy Guttapalem] review comments\n6e63fbb1e [Charan Reddy Guttapalem] review comments\ndbf836b32 [Charan Reddy Guttapalem] Fix firstStoredEntryId logic in LedgerFragment\n2978a1a39 [Charan Reddy Guttapalem] Fix firstStoredEntryId logic in LedgerFragment","Date":"Tue Oct 29 14:34:06 CET 2019"},{"Commit-ID":"commit 5a4213bb0810427ac09d7b47671a42f88b0af97a 1572436604 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Wed Oct 30 11:56:44 2019 +0000]","Body":"[maven-release-plugin] prepare branch branch-4.10\n","Date":"Wed Oct 30 12:56:44 CET 2019"},{"Commit-ID":"commit d49b46f4e80f7e62456ed252dcfb9d7c2c957bb7 1572436626 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Wed Oct 30 11:57:06 2019 +0000]","Body":"[maven-release-plugin] prepare for next development iteration\n","Date":"Wed Oct 30 12:57:06 CET 2019"},{"Commit-ID":"commit 7efa8e89e3ac6fb96fdad277ab65d02e924cd7b8 1572437774 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Wed Oct 30 12:16:14 2019 +0000]","Body":"Fix version in modules that are not active by default\n","Date":"Wed Oct 30 13:16:14 CET 2019"},{"Commit-ID":"commit f5d2e5931a86a436068d40dede2c537f4a619ee5 1572444593 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Wed Oct 30 15:09:53 2019 +0100]","Body":"Add -Dtwitter to release scripts in order to build Twitter stats providers\n\n### Motivation\r\n\r\nWith this commit we disable Twitter providers from default build\r\nhttps://github.com/apache/bookkeeper/commit/b689d8313654de21759b2e2d47210b75434038c3\r\n\r\nThis leads to inconsistences during the release process\r\n\r\n### Changes\r\n\r\nAdd -Dtwitter to every release script\r\n\r\n\r\n\r\n\n\nReviewers: Sijie Guo <None>\n\nThis closes #2192 from eolivelli/fix/fix-release-scripts","Date":"Wed Oct 30 15:09:53 CET 2019"},{"Commit-ID":"commit f57962bcc5029512a30f7f89a8d1878df6ac4a36 1572517078 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Oct 31 03:17:58 2019 -0700]","Body":"Removed mutex contention on BufferedChannel\n\n### Motivation\r\n\r\nContention on `BufferedChannel` between the journal thread and the ForceWriteThread was introduced in #1228.\r\n\r\n`unpersistentBytes` is only used if `unpersistedBytesBound > 0`, which is not true by default. We shouldn't be paying the penalty if not needed.\r\n\r\nAlso `position` doesn't need to be `AtomicLong` since it's only updated while the mutex is taken. Using a volatile will have the same effect with less overhead.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <zhaijia@apache.org>\n\nThis closes #2187 from merlimat/buffered-channel-contention","Date":"Thu Oct 31 11:17:58 CET 2019"},{"Commit-ID":"commit 43f8cd74fea3e97de11f4bd90532e884df375332 1572777708 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Sun Nov 3 11:41:48 2019 +0100]","Body":"Add -Dtwitter to fix auto-build\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\nMake bin/bookkeeper standalone work again\r\n\r\n### Changes\r\n\r\n\r\nAdd -Dtwitter in order to activate \"Twitter\" profile and build Twitter stats providers.\r\n\r\n\r\n\r\n\n\nReviewers: Sijie Guo <None>\n\nThis closes #2195 from eolivelli/fix/add-twitter-common","Date":"Sun Nov 03 11:41:48 CET 2019"},{"Commit-ID":"commit 557dfe90f20fbced7459aafd22e7687de07f934a 1573020259 -----sp","Author":"PersonIdent[Jennifer Huang, 47805623+Jennifer88huang@users.noreply.github.com, Wed Nov 6 14:04:19 2019 +0800]","Body":"[DOCS] Update coding_guide.md\n\n### Motivation\r\nThe link to `OrderedSafeExecutor` does not work.\r\n\r\n### Changes\r\nCorrect the link to `OrderedExecutor`.\n\nReviewers: Sijie Guo <None>\n\nThis closes #2196 from Jennifer88huang/patch-1","Date":"Wed Nov 06 07:04:19 CET 2019"},{"Commit-ID":"commit 9f4b1359e58fcd9872e895bc8d8ef14b409f86ac 1573125941 -----sp","Author":"PersonIdent[冉小龙, ranxiaolong716@gmail.com, Thu Nov 7 19:25:41 2019 +0800]","Body":"Fix the log level of not support Sse42Crc32C\n\nSigned-off-by: xiaolong.ran <ranxiaolong716gmail.com>\r\n\r\n### Motivation\r\n\r\nWhen users are using Apache Pulsar, they will encounter the following error about `Sse42Crc32C`. But in fact it does not affect the correctness of Apache Pulsar use. But the error level log information will cause confusion for the user.\r\n```\r\n10:12:49.119 [pulsar-ordered-OrderedExecutor-0-0-EventThread] ERROR org.apache.bookkeeper.proto.checksum.CRC32CDigestManager - Sse42Crc32C is not supported, will use a slower CRC32C implementation.\r\n```\r\n\r\n\r\n\r\n### Changes\r\n\r\nReplace the log level of `not support Sse42Crc32C` from error to warn.\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2198 from wolfstudy/xiaolong/sse42Crc32C","Date":"Thu Nov 07 12:25:41 CET 2019"},{"Commit-ID":"commit b1991e6b395aabc41305981e32183709b2617cc2 1573463083 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Mon Nov 11 10:04:43 2019 +0100]","Body":"Release notes for 4.10\n\nPlease only consider this commit https://github.com/apache/bookkeeper/commit/0d91a95f306031d85c6a8195b0e6d73523cbfc0a as it contains the release notes.\r\nThe previous commit is only the preparation for the website.\n\nReviewers: Sijie Guo\n\nThis closes #2165 from eolivelli/fix/release-notes-410","Date":"Mon Nov 11 10:04:43 CET 2019"},{"Commit-ID":"commit 40f349ccff6840d53b6421fdcbf6c1ed1bb9ca1b 1573505242 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Mon Nov 11 21:47:22 2019 +0100]","Body":"Bump Python client version\n","Date":"Mon Nov 11 21:47:22 CET 2019"},{"Commit-ID":"commit 62e3b9b6f121c379754abdc76d727e3c53e13bda 1574126927 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Tue Nov 19 02:28:47 2019 +0100]","Body":"Make 4.9.2 as stable\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\n4.10.0 has been released, 4.9.2 has been running in production for a while on several known projects. We can mark 4.9.2 as current 'stable' \r\n\r\n### Changes\r\nUpdate website config.\r\nFix DLog version.\r\n\r\n\r\n\r\n\n\nReviewers: Matteo Merli <mmerli@apache.org>, Sijie Guo <None>\n\nThis closes #2200 from eolivelli/fix/change-stable-492","Date":"Tue Nov 19 02:28:47 CET 2019"},{"Commit-ID":"commit 2ca4025e4c699e49c39272a067d8ec6056ca4358 1574127053 -----sp","Author":"PersonIdent[Anup Ghatage, ghatageanup@gmail.com, Mon Nov 18 17:30:53 2019 -0800]","Body":"[DOCUMENTATION] Add doc for decommissioning bookie process\n\n### Motivation\r\nDocumentation on how to decommission a bookie safely.\r\n\r\n### Changes\r\nAdded `decommission.md`\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2199 from Ghatage/decomission-documentation","Date":"Tue Nov 19 02:30:53 CET 2019"},{"Commit-ID":"commit 9d61fb4fe4fa2c46a25c12f7fb070878b5bda22d 1575878905 -----sp","Author":"PersonIdent[Dapeng, 42792537+SunDapeng1@users.noreply.github.com, Mon Dec 9 16:08:25 2019 +0800]","Body":"[DOCS] Modify \u201cUsing Autoecovery\u201d,recover does not support the specified target bookie\n\n### Motivation \r\n`bin/bookkeeper shell recover` only receives one parameter i.e. failed bookie. According to [recovery](https://bookkeeper.apache.org/docs/latest/admin/autorecovery/#manual-recovery) it is useless to specify ZooKeeper address and target bookie.\r\n![image](https://user-images.githubusercontent.com/42792537/68930100-a3babf80-07c8-11ea-90e1-320cfac1b77b.png)\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2207 from SunDapeng1/branch-2207","Date":"Mon Dec 09 09:08:25 CET 2019"},{"Commit-ID":"commit 2bbf58e0168df000db1712a84acaecf61d00c347 1577036842 -----sp","Author":"PersonIdent[Dapeng, 42792537+SunDapeng1@users.noreply.github.com, Mon Dec 23 01:47:22 2019 +0800]","Body":"Fixed bin/bookkeeper shell readjournal\n\n### Motivation\r\nAn error occurred while executing `bin/bookkeeper shell readjournal`,\r\n![image](https://user-images.githubusercontent.com/42792537/70305222-d80d2300-183e-11ea-8759-88dfcc90b5be.png)\r\n the journal file name is hexadecimal, but when readjournal is executed, the journal name is resolved in base 10\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo\n\nThis closes #2210 from SunDapeng1/branch-2208","Date":"Sun Dec 22 18:47:22 CET 2019"},{"Commit-ID":"commit 2ff7ca5af53f59f2ba11391292016554ace35720 1578143431 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Sat Jan 4 14:10:31 2020 +0100]","Body":"Account Apache Thrift and Http Client files in LICENSE files - Fix build on Travis\n\nfixes #2227\r\n\r\nDescriptions of the changes in this PR:\r\n- Account Thrift and Http client in LICENSE files.\r\n- Force using Maven 3.6.3 in MacOSx builds on Travis\r\n- Test only with -Dstream profile\r\n\r\n\r\n### Motivation\r\n\r\nThose files are inside the binary packages but they are not taken into account in LICENSE file.\r\nTravis started to report errors when Travis updated Maven version to 3.6.2 in Linux machines, MaxOSx machines are still with 3.3.9 and the build does not bundle all of the needed jars ! \r\n\r\nMaster Issue: #2227 \r\n\r\n\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <None>\n\nThis closes #2228 from eolivelli/fix/license-files","Date":"Sat Jan 04 14:10:31 CET 2020"},{"Commit-ID":"commit e7dd19bb52d0654006decb383cb35ffcde928990 1578294612 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Mon Jan 6 08:10:12 2020 +0100]","Body":"Remove Twitter Libraries\n\n- Twitter Stats Providers\r\n- Twitter Http Server\r\n\r\nDescriptions of the changes in this PR:\r\n- Drop all stats providers used only by Twitter and Twitter Http server \r\n- Fix BookKeeper Server packaging, it did not include Netty epoll transport Linux binding (no .so file)\r\n- Adapt license stuff accordingly  \r\n- Drop third party libs needed by Twitter stuff, most notably: Scala runtime and Netty 3.10\r\n\r\n\r\n### Motivation\r\n\r\nThose modules are apparently no more in use and especially they are no more mantained.\r\nIt is better to remove them, the code is still on git, but we won't be building it any more or bundling  useless third party libraries in our releases. \r\n\r\n### Changes\r\n- remove twitter stats providers\r\n- remove twitter http server\r\n- adjust LICENSE file for binary distribution (bookkeeper-all)\r\n- fix pom.xml files\r\n- remove -Dtwitter from release files\r\n- remove -Dtwitter from bin/common.sh\r\n- remove other links to Twitter stuff in current documentation \r\n\r\n\r\nMaster Issue: #<master-issue-number>\r\n\r\n\r\n\n\nReviewers: Dave Rusek <dave.rusek@gmail.com>, Jia Zhai <zhaijia@apache.org>, Sijie Guo\n\nThis closes #2232 from eolivelli/fix/drop-twitter-stuff","Date":"Mon Jan 06 08:10:12 CET 2020"},{"Commit-ID":"commit eba63dbfa8c646616b55280c700d8bf5114d3cbe 1578384928 -----sp","Author":"PersonIdent[Lei Zhang, coolbeevip@gmail.com, Tue Jan 7 16:15:28 2020 +0800]","Body":"ISSUE #2224: Config ServerConfiguration with setAllowLoopback(true) for Unit Tests\n\n### Motivation\r\n\r\nUnit test fails when build master branch\r\n\r\n### Changes\r\n\r\nConfig ServerConfiguration with setAllowLoopback(true) in the class GarbageCollectorThreadTest\r\n\r\nMaster Issue: #2224 \r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2226 from coolbeevip/ISSUE-2224, closes #2224 and squashes the following commits:\n\nfdba4fbce [Lei Zhang] ISSUE-2224 set allowLoopback is true\n2ff7ca5af [Enrico Olivelli] Account Apache Thrift and Http Client files in LICENSE files - Fix build on Travis\n2bbf58e01 [Dapeng] Fixed bin/bookkeeper shell readjournal\n9d61fb4fe [Dapeng] [DOCS] Modify \u201cUsing Autoecovery\u201d,recover does not support the specified target bookie\n2ca4025e4 [Anup Ghatage] [DOCUMENTATION] Add doc for decommissioning bookie process\n62e3b9b6f [Enrico Olivelli] Make 4.9.2 as stable\n40f349ccf [Enrico Olivelli] Bump Python client version\nb1991e6b3 [Enrico Olivelli] Release notes for 4.10\n9f4b1359e [冉小龙] Fix the log level of not support Sse42Crc32C\n557dfe90f [Jennifer Huang] [DOCS] Update coding_guide.md\n43f8cd74f [Enrico Olivelli] Add -Dtwitter to fix auto-build\nf57962bcc [Matteo Merli] Removed mutex contention on BufferedChannel\nf5d2e5931 [Enrico Olivelli] Add -Dtwitter to release scripts in order to build Twitter stats providers\n7efa8e89e [Enrico Olivelli] Fix version in modules that are not active by default\nd49b46f4e [Enrico Olivelli] [maven-release-plugin] prepare for next development iteration\n5a4213bb0 [Enrico Olivelli] [maven-release-plugin] prepare branch branch-4.10\nf8a5974a5 [Charan Reddy Guttapalem] Fix firstStoredEntryId logic in LedgerFragment\n8559126a3 [Anup Ghatage] Issue #2145: Make ledgerDirs in Cookie consistent across generating a\u2026","Date":"Tue Jan 07 09:15:28 CET 2020"},{"Commit-ID":"commit 0098999ebd9d6269770d9a9a2ddd1190e9c83cda 1579184806 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Thu Jan 16 06:26:46 2020 -0800]","Body":"[bookie-server] add support of client auto cert refresh\n\n### Motivation\r\nas described at: https://github.com/apache/pulsar/issues/6010\r\n\r\nBookkeeper-client caches the tls certificates when it first tries to create a cnx with a given bookie and after that it never reloads certs even when valid certs changes on the file-system or new bookie-connection is created. Because of that as soon as client certs expires and bk-client disconnects from bookie then bk-client is not able to reconnect to bookie until we restart the bk-client process. and we see below TLS exception at bk-client.\r\n\r\n```\r\n19:43:03.983 [bookkeeper-io-12-45] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Unexpected exception caught by bookie client channel handler\r\nio.netty.handler.codec.DecoderException: javax.net.ssl.SSLHandshakeException: General OpenSslEngine problem\r\n        at io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:472) ~[netty-codec-4.1.31.Final.jar:4.1.31.Final]\r\n        at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:278) ~[netty-codec-4.1.31.Final.jar:4.1.31.Final]\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362) [netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348) [netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340) [netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1434) [netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362) [netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348) [netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:965) [netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) [netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:433) [netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:330) [netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:909) [netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at java.lang.Thread.run(Thread.java:834) [?:?]\r\nCaused by: javax.net.ssl.SSLHandshakeException: General OpenSslEngine problem\r\n        at io.netty.handler.ssl.ReferenceCountedOpenSslClientContext$OpenSslClientCertificateCallback.handle(ReferenceCountedOpenSslClientContext.java:273) ~[netty-all-4.1.32.Final.jar\r\n:4.1.32.Final]\r\n        at io.netty.internal.tcnative.SSL.readFromSSL(Native Method) ~[netty-tcnative-boringssl-static-2.0.20.Final.jar:2.0.20.Final]\r\n        at io.netty.handler.ssl.ReferenceCountedOpenSslEngine.readPlaintextData(ReferenceCountedOpenSslEngine.java:575) ~[netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at io.netty.handler.ssl.ReferenceCountedOpenSslEngine.unwrap(ReferenceCountedOpenSslEngine.java:1124) ~[netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at io.netty.handler.ssl.ReferenceCountedOpenSslEngine.unwrap(ReferenceCountedOpenSslEngine.java:1236) ~[netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at io.netty.handler.ssl.ReferenceCountedOpenSslEngine.unwrap(ReferenceCountedOpenSslEngine.java:1279) ~[netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at io.netty.handler.ssl.SslHandler$SslEngineType$1.unwrap(SslHandler.java:217) ~[netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at io.netty.handler.ssl.SslHandler.unwrap(SslHandler.java:1301) ~[netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at io.netty.handler.ssl.SslHandler.decodeNonJdkCompatible(SslHandler.java:1215) ~[netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at io.netty.handler.ssl.SslHandler.decode(SslHandler.java:1249) ~[netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at io.netty.handler.codec.ByteToMessageDecoder.decodeRemovalReentryProtection(ByteToMessageDecoder.java:502) ~[netty-codec-4.1.31.Final.jar:4.1.31.Final]\r\n        at io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:441) ~[netty-codec-4.1.31.Final.jar:4.1.31.Final]\r\n        ... 14 more\r\n```\r\n\r\n### Modification\r\nAdd support at bk-client to reload certs once they have changed on file-system.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <zhaijia@apache.org>, Sijie Guo <None>\n\nThis closes #2235 from rdhabalia/bk_client_cert","Date":"Thu Jan 16 15:26:46 CET 2020"},{"Commit-ID":"commit 8889efa54e7d8997b79445b1541e8510915ec85b 1579687697 -----sp","Author":"PersonIdent[Dapeng, sundapeng@cmss.chinamobile.com, Wed Jan 22 18:08:17 2020 +0800]","Body":"Increase the 'segment store path' in the 'Initializing stream cluster' log\n\nIncrease the 'segment store path' in the 'Initializing stream cluster' log\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2238 from SunDapeng1/branch-2238","Date":"Wed Jan 22 11:08:17 CET 2020"},{"Commit-ID":"commit 004cfe36af8365c6a9bb198ccf74eab311f0249d 1579687781 -----sp","Author":"PersonIdent[Dapeng, sundapeng@cmss.chinamobile.com, Wed Jan 22 18:09:41 2020 +0800]","Body":"Create ledgersRootPath recursively for 'bin/bookkeeper shell metaformat'\n\nCreate ledgersRootPath recursively for `bin/bookkeeper shell metaformat`. The existence of any parent znodes is not an error condition\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2237 from SunDapeng1/branch-2236","Date":"Wed Jan 22 11:09:41 CET 2020"},{"Commit-ID":"commit 1f403f96582b292c2ea29c92ed22c859c2f9cffa 1579687965 -----sp","Author":"PersonIdent[Aloys, 18124766348@163.com, Wed Jan 22 18:12:45 2020 +0800]","Body":"[HOTFIX] fix the http endpoint component count error\n\nThis PR is a hotfix for \"BookKeeper Admin REST API\" document, the compoent of HTTP endpoints should be 5, but it's 4 in the doc.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2248 from aloyszhang/hotfix","Date":"Wed Jan 22 11:12:45 CET 2020"},{"Commit-ID":"commit 325d9c4b9c2b59c77d2db71129d138d0b2207d61 1579688027 -----sp","Author":"PersonIdent[Aloys, 18124766348@163.com, Wed Jan 22 18:13:47 2020 +0800]","Body":"[HOTFIX] [DOCS] remove redundant word in protocol documents\n\nThis PR removes redundant word  \"because\" in protocol documents.\r\n\n\nReviewers: Sijie Guo <None>\n\nThis closes #2249 from aloyszhang/hotfix-protocol","Date":"Wed Jan 22 11:13:47 CET 2020"},{"Commit-ID":"commit 41a468743dd1f0b004179ce406fae291c1b80abe 1579688119 -----sp","Author":"PersonIdent[Aloys, 18124766348@163.com, Wed Jan 22 18:15:19 2020 +0800]","Body":"[HOTFIX] [DOCS] fix error in leger api document\n\nThis PR :\r\n1. add missing comma and dot\r\n2. fix some layout error\r\nin ledger-api document\n\nReviewers: Sijie Guo <None>\n\nThis closes #2250 from aloyszhang/hotfix-ledger-api","Date":"Wed Jan 22 11:15:19 CET 2020"},{"Commit-ID":"commit 965c874d5ef7455de902dbcedc7471bb60ee886b 1579688194 -----sp","Author":"PersonIdent[Alessandro Luccaroni, alessandro.luccaroni@diennea.com, Wed Jan 22 11:16:34 2020 +0100]","Body":"Website: Update Release Management for new Time Based Release Plan\n\nAs discussed on the mailing list, I'm updating the BookKeeper website to reflect the new Time Based Release Plan.\r\n\r\nYou can find the staging website  https://aluccaroni.github.io/bookkeeper-staging-site/community/releases/\r\n\r\nPlease note that I've removed the calendar since it was empty\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2251 from aluccaroni/master","Date":"Wed Jan 22 11:16:34 CET 2020"},{"Commit-ID":"commit cfb28fe6ef1cb82f7e8e16f3859b02d607555656 1579688313 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Wed Jan 22 18:18:33 2020 +0800]","Body":"[CI] Migrate the Jenkins CI to Github Action\n\n---\r\n\r\nMaster Issue: #2242\r\n\r\n*Modifications*\r\n\r\nMigrate theJenkins CI to Github Action\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2246 from zymap/migrate-ci","Date":"Wed Jan 22 11:18:33 CET 2020"},{"Commit-ID":"commit 163db4496d50cae198b80c9d88c14579f6d2e9f3 1579688576 -----sp","Author":"PersonIdent[Dapeng, sundapeng@cmss.chinamobile.com, Wed Jan 22 18:22:56 2020 +0800]","Body":"bin/bookkeeper shell supports the -conf\n\n### Motivation\r\n`bin/bookkeeper shell ` support `-conf configuration`, but it doesn't work. bk_server.conf is loaded by default, even if the configuration is specified\r\n![image](https://user-images.githubusercontent.com/42792537/70309755-2a534180-1849-11ea-96b0-bd5b07a6b717.png)\r\nModify `bin/bookkeeper` to specify the configuration file as an absolute path\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2211 from SunDapeng1/branch-2211","Date":"Wed Jan 22 11:22:56 CET 2020"},{"Commit-ID":"commit a5eb8caaf52b04b24abce07b25f4c609675fbd06 1579967246 -----sp","Author":"PersonIdent[Alessandro Luccaroni, alessandro.luccaroni@diennea.com, Sat Jan 25 16:47:26 2020 +0100]","Body":"Website: add EOL tag to navbar\n\nAs discussed on the mailing list, I'm updating the BookKeeper website to reflect the EOLed version of BookKeeper\r\n\r\nYou can find the staging website  https://aluccaroni.github.io/bookkeeper-staging-site\r\n\r\nHere a screenshot of the new navbar:\r\n![image](https://user-images.githubusercontent.com/11058798/72979770-587ce880-3dd9-11ea-86bf-de4a9aa694d3.png)\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo\n\nThis closes #2253 from aluccaroni/master","Date":"Sat Jan 25 16:47:26 CET 2020"},{"Commit-ID":"commit 2836241fbdbe2c8b31718f2374f6fbe50645a2b7 1580142668 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Jan 27 08:31:08 2020 -0800]","Body":"Remove Jenkins precommit jobs and fix checkstyle errors\n\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2255 from sijie/remove_bookkeeper_tests","Date":"Mon Jan 27 17:31:08 CET 2020"},{"Commit-ID":"commit e37f3aa03ad4d1ad1e5ded2ffceac3e844e6f46e 1580443334 -----sp","Author":"PersonIdent[Alessandro Luccaroni, alessandro.luccaroni@diennea.com, Fri Jan 31 05:02:14 2020 +0100]","Body":"Website: update Gemfile dependencies\n\nUpdating Gemfile dependencies to try fix Travis (see https://github.com/apache/bookkeeper/issues/2252)\r\n\r\nAlso fixing https://www.cvedetails.com/cve/CVE-2018-17567/ in the meantime\r\n\r\nYou can find the staging website  https://aluccaroni.github.io/bookkeeper-staging-site\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2256 from aluccaroni/master","Date":"Fri Jan 31 05:02:14 CET 2020"},{"Commit-ID":"commit 6989954e05504c345ae9e50c9c906f8291a6dc02 1580473576 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Fri Jan 31 04:26:16 2020 -0800]","Body":"[CODE-STYLE] fix build failure for check-style\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\nPR Validation build is failing with below exception:\r\n```\r\n[ERROR] src/main/java/org/apache/bookkeeper/stream/storage/impl/cluster/ZkClusterInitializer.java:[35] (imports) ImportOrder: Import org.apache.bookkeeper.stream.storage.StorageConstants.getSegmentsRootPath appears after other imports that it should precede\r\n[ERROR] Failed to execute goal org.apache.maven.plugins:maven-checkstyle-plugin:3.0.0:check (default-cli) on project stream-storage-service-impl: You have 1 Checkstyle violation. -> [Help 1]\r\n```\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2258 from rdhabalia/checkZk","Date":"Fri Jan 31 13:26:16 CET 2020"},{"Commit-ID":"commit 9397d111408351bbe329588c026c226b03893f11 1581351215 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon Feb 10 08:13:35 2020 -0800]","Body":"Remove travis\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nThe CI is moved to github actions.\r\n\r\n\r\n### Changes\r\n\r\nDelete travis configuration.\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2259 from sijie/remove_travis_ci","Date":"Mon Feb 10 17:13:35 CET 2020"},{"Commit-ID":"commit 26e03dc8d410627d6a489cd5dd32ae837bc4cc0e 1581608439 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Thu Feb 13 16:40:39 2020 +0100]","Body":"BP-38 Publish Bookie Service Info on Metadata Service\n\nThis is the BP page for BP-38 Publish Bookie Service Info on Metadata Service\r\n\r\nMaster Issue: #2215 \r\n\r\n\r\n\n\nReviewers: [Ivan Kelly <ivank@apache.org>, Sijie Guo <sijie@apache.org>, Flavio Junqueira <fpj@apache.org>\n\nThis closes #2214 from eolivelli/fix/bp-disc","Date":"Thu Feb 13 16:40:39 CET 2020"},{"Commit-ID":"commit 018648b8cf7ca8e105c976aaa7e941561d2902e8 1581612240 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Thu Feb 13 17:44:00 2020 +0100]","Body":"Add BP-38 to list of approved releases\n","Date":"Thu Feb 13 17:44:00 CET 2020"},{"Commit-ID":"commit 3ae3ad445b9d22b0a6c8b82f8da383955f4d6a4d 1581844442 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Sun Feb 16 10:14:02 2020 +0100]","Body":"Revert \"bin/bookkeeper shell supports the -conf\"\n\nThis reverts commit 163db4496d50cae198b80c9d88c14579f6d2e9f3.\r\n\r\nDescriptions of the changes in this PR:\r\nCommit 163db4496d50cae198b80c9d88c14579f6d2e9f3 broke \"bookkeeper shell\" command and integration tests are no more able to work\r\n\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #2265 from eolivelli/fix/revert-bad-fix","Date":"Sun Feb 16 10:14:02 CET 2020"},{"Commit-ID":"commit 761e42c608689dc595f019a2ac6a92fa1e0d30c7 1581927157 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Mon Feb 17 09:12:37 2020 +0100]","Body":"Fix method order in order to make the execution of TestEntryLog predictable\n\n### Motivation\r\n\r\nTestEntyLog reuses the entryLogger variable across test methods execution, resulting in an unpredictable execution.\r\nWe can at least make the test work consistently across environments using JUnit built-in FixMethodOrder annotation\r\n\r\n### Changes\r\nFixMethodOrder(MethodSorters.NAME_ASCENDING)\r\n\r\nFixes #2260\r\n\n\nReviewers: Atri Sharma <atri@apache.org>\n\nThis closes #2266 from eolivelli/fix/flaky","Date":"Mon Feb 17 09:12:37 CET 2020"},{"Commit-ID":"commit b84178af53d631b268143f9b8b0a3c3f731bf68a 1581944595 -----sp","Author":"PersonIdent[dmercuriali, mercurialiden@gmail.com, Mon Feb 17 14:03:15 2020 +0100]","Body":"ISSUE #2218: Write customMetadata on ledgers created by DistributedLog\n\n### Changes\r\n\r\nEnable DistributedLog to attach custom metadata to underlying ledgers when writing logs.\r\n\r\nThe user can pass a LedgerMetadata object to DistributedLogManager#openLogWriter and DistributedLogManager#openAsyncLogWriter. The LedgerMetadata object is then used by the Allocator backing the BKLogWriteHandler every time it must allocate a new ledger.\r\n\r\nMaster Issue: #2218\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>, Sijie Guo <sijie@apache.org>\n\nThis closes #2254 from dmercuriali/2218-distributedlog-ledger-custom-metadata, closes #2218","Date":"Mon Feb 17 14:03:15 CET 2020"},{"Commit-ID":"commit b94d3fbb7540618e13781b3db14e2d2bcb2c823d 1582528103 -----sp","Author":"PersonIdent[Yijie Shen, henry.yijieshen@gmail.com, Mon Feb 24 15:08:23 2020 +0800]","Body":"Move checkout action to v2 (#2272)\n\n","Date":"Mon Feb 24 08:08:23 CET 2020"},{"Commit-ID":"commit 9d6f5db2da75da2050ec753b4a3e7784f90c7c37 1583478915 -----sp","Author":"PersonIdent[Atri Sharma, atri.jiit@gmail.com, Fri Mar 6 12:45:15 2020 +0530]","Body":"2178: IOException Should Be Thrown When Journal Is Corrupted\n\nFixes #2178 \n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>,  Sijie Guo <sijie@apache.org>\n\nThis closes #2257 from atris/2176","Date":"Fri Mar 06 08:15:15 CET 2020"},{"Commit-ID":"commit 407a0299af034423aca009fe353c10a9de15f490 1583479884 -----sp","Author":"PersonIdent[Dapeng, 1807643853@qq.com, Fri Mar 6 15:31:24 2020 +0800]","Body":"Move the result of the BKCTL to the console by default\n\n### Motivation \r\n\r\n\r\n### Changes\r\n\r\n  Move the result of the BKCTL to the console\r\n\r\nMaster Issue: #2236  \n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2268 from SunDapeng1/branch-2267","Date":"Fri Mar 06 08:31:24 CET 2020"},{"Commit-ID":"commit 21e0e2f9489be85542c882e5aa41a9a7c67ba827 1583588805 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Sat Mar 7 14:46:45 2020 +0100]","Body":"Drop Maven Profile -Dstream (#2233)\n\n### Motivation\r\n\r\nThe \"stream\" profile enables the build of all of the additional packages regarding the 'table service'.\r\nThis profile complicates a lot every script and the Maven project.\r\nAs the stream storage service is now stable and used in production, it is better to always include those modules.\r\nRegualar developers on bookkeeper-server module won't be affected by this change as it affects only the full build and the release process.\r\n\r\n### Changes\r\nModify every pom.xml in order to enable all of the parts of the pom.xml that would be enabled with '-Dstream'.\r\nModify release scripts by removing references to -Dstream\r\nModify bin/common.sh about the auto build feature\r\nModify Groovy scripts for Jenkins\r\nDo not \"shade\" libthrift inside Distributed Log Jar\r\n\r\nI did not modify the website because currently the precommit validation of the website is broken\r\n\r\n\r\n* Remove stream Maven Profile\r\n\r\n* Delete job_bookkeeper_precommit_java11.groovy\r\n\r\n* Delete job_bookkeeper_precommit_java8.groovy\r\n\r\n* Delete ticktoc.sh\r\n\r\n* Restore -DstreamTests profile\r\n\r\nCo-authored-by: Enrico Olivelli <eolivelli@apache.org>","Date":"Sat Mar 07 14:46:45 CET 2020"},{"Commit-ID":"commit 92f75da3f8711cb98eda2f435bbd57ffe67e87b7 1583753400 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Mon Mar 9 19:30:00 2020 +0800]","Body":"Fixes vertx can not receive the request body\n\n---\r\n\r\n*Motivation*\r\n\r\nVertx can not receive the request body so that the REST API\r\ncan not work well if you have a request with body.\r\n\r\n*Modifications*\r\n\r\n- Add body handler for the vertx http service\r\n\r\n*Verify this change*\r\n\r\n- Pass the test `testHttpMethodsWithBody`\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\n(Explain: why you're making that change, what is the problem you're trying to solve)\r\n\r\n### Changes\r\n\r\n(Describe: what changes you have made)\r\n\r\nMaster Issue: #<master-issue-number>\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2241 from zymap/fix-can-not-read-body","Date":"Mon Mar 09 12:30:00 CET 2020"},{"Commit-ID":"commit 025d99f5a2a4cc02f3780a11b58a9b9d6c9940c3 1583846273 -----sp","Author":"PersonIdent[hangc0276, hangc0276@163.com, Tue Mar 10 21:17:53 2020 +0800]","Body":"fix bookie decommission sleep timeout value is negative bug\n\nwhen decommission a bookie, and the ledger size of the bookie is big enough, the thread timeout will get negative, and the decommission operation will give up by throw exceptions as follow\r\n```\r\n14:12:56.982 [main] INFO  org.apache.bookkeeper.client.BookKeeperAdmin - Count of Ledgers which need to be rereplicated: 272752\r\n14:12:56.983 [main] ERROR org.apache.bookkeeper.bookie.BookieShell - Received exception in DecommissionBookieCmd \r\njava.lang.IllegalArgumentException: timeout value is negative\r\n\tat java.lang.Thread.sleep(Native Method) ~[?:?]\r\n\tat org.apache.bookkeeper.client.BookKeeperAdmin.waitForLedgersToBeReplicated(BookKeeperAdmin.java:1528) ~[org.apache.bookkeeper-bookkeeper-server-4.9.2.jar:4.9.2]\r\n\tat org.apache.bookkeeper.client.BookKeeperAdmin.decommissionBookie(BookKeeperAdmin.java:1500) ~[org.apache.bookkeeper-bookkeeper-server-4.9.2.jar:4.9.2]\r\n\tat org.apache.bookkeeper.bookie.BookieShell$DecommissionBookieCmd.runCmd(BookieShell.java:2664) [org.apache.bookkeeper-bookkeeper-server-4.9.2.jar:4.9.2]\r\n\tat org.apache.bookkeeper.bookie.BookieShell$MyCommand.runCmd(BookieShell.java:277) [org.apache.bookkeeper-bookkeeper-server-4.9.2.jar:4.9.2]\r\n\tat org.apache.bookkeeper.bookie.BookieShell.run(BookieShell.java:3081) [org.apache.bookkeeper-bookkeeper-server-4.9.2.jar:4.9.2]\r\n\tat org.apache.bookkeeper.bookie.BookieShell.main(BookieShell.java:3172) [org.apache.bookkeeper-bookkeeper-server-4.9.2.jar:4.9.2]\r\n14:12:57.013 [main] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x206189927840052 closed\r\n```\r\nThe exception code is \r\n```\r\nprivate void waitForLedgersToBeReplicated(Collection<Long> ledgers, BookieSocketAddress thisBookieAddress,\r\n            LedgerManager ledgerManager) throws InterruptedException, TimeoutException {\r\n        int maxSleepTimeInBetweenChecks = 10 * 60 * 1000; // 10 minutes\r\n        int sleepTimePerLedger = 10 * 1000; // 10 secs\r\n        Predicate<Long> validateBookieIsNotPartOfEnsemble = ledgerId -> !areEntriesOfLedgerStoredInTheBookie(ledgerId,\r\n                thisBookieAddress, ledgerManager);\r\n        while (!ledgers.isEmpty()) {\r\n            LOG.info(\"Count of Ledgers which need to be rereplicated: {}\", ledgers.size());\r\n            int sleepTimeForThisCheck = ledgers.size() * sleepTimePerLedger > maxSleepTimeInBetweenChecks\r\n                    ? maxSleepTimeInBetweenChecks : ledgers.size() * sleepTimePerLedger;\r\n            Thread.sleep(sleepTimeForThisCheck);\r\n            LOG.debug(\"Making sure following ledgers replication to be completed: {}\", ledgers);\r\n            ledgers.removeIf(validateBookieIsNotPartOfEnsemble);\r\n        }\r\n    }\r\n```\r\nthe ledger size is `272752`, when computing sleepTimeForThisCheck, \r\n`ledgers.size() * sleepTimePerLedger` is `272752 * 10 * 1000 = 2727520000`， \r\nthe value exceeds max int value `2147483647`, it will turn to `-1567447296`, then the sleepTimeForThisCheck will be `-1567447296`.\r\n Thread.sleep will throw `java.lang.IllegalArgumentException: timeout value is negative` exception\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <zhaijia@apache.org>\n\nThis closes #2284 from hangc0276/bug_fix","Date":"Tue Mar 10 14:17:53 CET 2020"},{"Commit-ID":"commit 13103341bcf36f5f939c2638830dd7c31bc8811c 1584569733 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Wed Mar 18 23:15:33 2020 +0100]","Body":"Update Prometheus library to 0.8.1\n\nDescriptions of the changes in this PR:\r\nUpdate Prometheus library to 0.8.1\r\n\r\n### Motivation\r\n\r\nWe have an obsolete version\r\n\r\n### Changes\r\n\r\nUpdate Prometheus library to latest version 0.8.1 and update NOTICE files\r\n\n\nReviewers: Sijie Guo <None>\n\nThis closes #2291 from eolivelli/fix/update-prom-081","Date":"Wed Mar 18 23:15:33 CET 2020"},{"Commit-ID":"commit fbfd49a1e0307e5d490a2cdf8cbb840ef88cf628 1584572704 -----sp","Author":"PersonIdent[hangc0276, hangc0276@163.com, Thu Mar 19 07:05:04 2020 +0800]","Body":"fix some stats monitor metrics\n\nDescriptions of the changes in this PR:\r\n\r\nThe journalStats.getJournalQueueSize increase once and decrease twice, so this stat metric will be negative.\r\n\r\nIt increases in `logAddEntry` function and decrease in `QueueEntry recall` methord and Journal main thread run methord.\r\n\r\nso we should delete the decrease in journal main thread run methord.\r\n\r\n```\r\nqueue.put(QueueEntry.create(\r\n                entry, ackBeforeSync,  ledgerId, entryId, cb, ctx, MathUtils.nowInNano(),\r\n                journalStats.getJournalAddEntryStats(),\r\n                journalStats.getJournalQueueSize()))\r\n```\n\nReviewers: Sijie Guo <None>\n\nThis closes #2290 from hangc0276/bugfix_metrics","Date":"Thu Mar 19 00:05:04 CET 2020"},{"Commit-ID":"commit 8201de86a6e04164efa4fabbf91d4c4a67bbd1fe 1584572905 -----sp","Author":"PersonIdent[hangc0276, hangc0276@163.com, Thu Mar 19 07:08:25 2020 +0800]","Body":"Add Journal PageCache flush interval control when journalSyncData is disabled\n\nDescriptions of the changes in this PR:\r\n### Motivation\r\nThere was a weird behavior observed: when journalSyncData is disabled, it will trigger callbacks when the data is flushed to filesystem(PageCache) but still enqueue a fsync request to force write queue to fsync PageCache data to disk frequently. Though the fsync thread dequeue fsync request and execute fsync operation asynchronously, it still cause disk io util increase when fsync frequency high enough. when disk io util increase, especially reach 100%, it will block new journal file creation and lead to journal sync time increases to mutiple seconds.\r\n\r\n### Changes\r\nwhen journalSyncData is disabled, we introduce `journalPageCacheFlushIntervalMSec` to control journal PageCache flush frequency to reduce disk io util, default value is 1000ms\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <zhaijia@apache.org>, Sijie Guo <None>\n\nThis closes #2287 from hangc0276/bugfix","Date":"Thu Mar 19 00:08:25 CET 2020"},{"Commit-ID":"commit 05fe83d6ca97d6bc415bb304e4f24537b7b06c0a 1584573018 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Thu Mar 19 00:10:18 2020 +0100]","Body":"Do not log WARNING about PlacementPolicy for tests and simple setups\n\n\r\nDescriptions of the changes in this PR:\r\nDo not log 'New ensemble: {} is not adhering to Placement Policy. quarantinedBookies' in case of ensembleSize = 1\r\n\r\n\r\n### Motivation\r\nIn tests cases and in simple demos it is very annoying to see that log line at \"WARNING\" level.\r\nIf we are requiring only 1 bookie it is not a big deal to WARN that the placement policy is not \"adhering\"\r\n\n\nReviewers: Matteo Minardi <minardi.matteo@hotmail.it>, Atri Sharma <None>, Sijie Guo <None>\n\nThis closes #2286 from eolivelli/fix/no-log-single-bookie","Date":"Thu Mar 19 00:10:18 CET 2020"},{"Commit-ID":"commit ec3ade0a255d94e8329e9eb3b69ec9c2ed59e6e4 1584574362 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Wed Mar 18 16:32:42 2020 -0700]","Body":"[BOOKIE-MTLS] add BouncyCastleProvider for security-provider to avoid InvalidKeyException\n\n### Motivation\r\nAs described at: https://github.com/apache/pulsar/issues/5047\r\n\r\n### Issue\r\n\r\nSometimes user  sees `Invalid TLS configuration` at bookie while loading PKCS8Key file and that can be fixed by using Bouncycastle provider.: https://stackoverflow.com/questions/6559272/algid-parse-error-not-a-sequence/18912362#18912362\r\n\r\n```\r\n2019-08-26 16:16:51,983 - ERROR - [BookKeeperClientWorker-OrderedExecutor-0-0:BookieClient179] - Security Exception in creating new default PCBC pool: \r\norg.apache.bookkeeper.tls.SecurityException: Invalid TLS configuration\r\n\tat org.apache.bookkeeper.tls.TLSContextFactory.init(TLSContextFactory.java:392)\r\n\tat org.apache.bookkeeper.proto.PerChannelBookieClient.<init>(PerChannelBookieClient.java:266)\r\n\tat org.apache.bookkeeper.proto.BookieClient.create(BookieClient.java:155)\r\n\tat org.apache.bookkeeper.proto.DefaultPerChannelBookieClientPool.<init>(DefaultPerChannelBookieClientPool.java:71)\r\n\tat org.apache.bookkeeper.proto.BookieClient.lookupClient(BookieClient.java:168)\r\n\tat org.apache.bookkeeper.proto.BookieClient.addEntry(BookieClient.java:245)\r\n\tat org.apache.bookkeeper.client.PendingAddOp.sendWriteRequest(PendingAddOp.java:131)\r\n\tat org.apache.bookkeeper.client.PendingAddOp.safeRun(PendingAddOp.java:240)\r\n\tat org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\r\n\tat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\r\n\tat java.lang.Thread.run(Thread.java:745)\r\nCaused by: java.lang.IllegalArgumentException: File does not contain valid private key: /my.key.pem\r\n\tat io.netty.handler.ssl.SslContextBuilder.keyManager(SslContextBuilder.java:267)\r\n\tat org.apache.bookkeeper.tls.TLSContextFactory.createClientContext(TLSContextFactory.java:244)\r\n\tat org.apache.bookkeeper.tls.TLSContextFactory.init(TLSContextFactory.java:363)\r\n\t... 12 more\r\nCaused by: java.security.spec.InvalidKeySpecException: Neither RSA, DSA nor EC worked\r\n\tat io.netty.handler.ssl.SslContext.getPrivateKeyFromByteBuffer(SslContext.java:1045)\r\n\tat io.netty.handler.ssl.SslContext.toPrivateKey(SslContext.java:1014)\r\n\tat io.netty.handler.ssl.SslContextBuilder.keyManager(SslContextBuilder.java:265)\r\n\t... 14 more\r\nCaused by: java.security.spec.InvalidKeySpecException: java.security.InvalidKeyException: IOException : algid parse error, not a sequence\r\n\tat sun.security.ec.ECKeyFactory.engineGeneratePrivate(ECKeyFactory.java:169)\r\n\tat java.security.KeyFactory.generatePrivate(KeyFactory.java:372)\r\n\tat io.netty.handler.ssl.SslContext.getPrivateKeyFromByteBuffer(SslContext.java:1043)\r\n\t... 16 more\r\nCaused by: java.security.InvalidKeyException: IOException : algid parse error, not a sequence\r\n\tat sun.security.pkcs.PKCS8Key.decode(PKCS8Key.java:351)\r\n\tat sun.security.pkcs.PKCS8Key.decode(PKCS8Key.java:356)\r\n\tat sun.security.ec.ECPrivateKeyImpl.<init>(ECPrivateKeyImpl.java:73)\r\n\tat sun.security.ec.ECKeyFactory.implGeneratePrivate(ECKeyFactory.java:237)\r\n\tat sun.security.ec.ECKeyFactory.engineGeneratePrivate(ECKeyFactory.java:165)\r\n\t... 18 more\r\n```\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2151 from rdhabalia/bc-mtls","Date":"Thu Mar 19 00:32:42 CET 2020"},{"Commit-ID":"commit bd3d3b5473f1b8d90d681d03a128c9332c80425d 1584575506 -----sp","Author":"PersonIdent[Aloys, 18124766348@163.com, Thu Mar 19 07:51:46 2020 +0800]","Body":"2279 fix NPE when exec readjournal command\n\nDescriptions of the changes in this PR:\r\nThis PR fix NullPointerException when exec readjournal command\r\nSee issue #2279 \r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2280 from aloyszhang/read-jounral","Date":"Thu Mar 19 00:51:46 CET 2020"},{"Commit-ID":"commit 064c364e7bc20033fa7d0beac6286bfce8fb52bd 1584962921 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Mon Mar 23 12:28:41 2020 +0100]","Body":"Remove old Jenkins stuff (#2293)\n\nRemove old Jenkins stuff for GitHub Create Pull Request template\r\nCo-authored-by: Enrico Olivelli <enrico.olivelli@diennea.com>","Date":"Mon Mar 23 12:28:41 CET 2020"},{"Commit-ID":"commit c69772b1ace050b166ef69e3bc72d5f2c19cd5af 1584962953 -----sp","Author":"PersonIdent[dmercuriali, mercurialiden@gmail.com, Mon Mar 23 12:29:13 2020 +0100]","Body":" #2288: add metadata to StreamStorage ledgers (#2296)\n\nDescriptions of the changes in this PR:\r\n\r\nAdded 'application' and 'component' metadata to StreamStorage ledgers.\r\napplication: bk-stream-storage-service\r\ncomponent: state-store / checkpoint-store\r\n\r\nMaster Issue: #2288\r\n\r\n* #2288 add metadata to StreamStorage ledgers\r\n\r\n* #2288 add metadata to StreamStorage ledgers\r\n\r\nCo-authored-by: Dennis Mercuriali <dennis.mercuriali@diennea.com>","Date":"Mon Mar 23 12:29:13 CET 2020"},{"Commit-ID":"commit 86f58e8a7269c8e51f246386968ceed051375b8f 1584979346 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Mon Mar 23 09:02:26 2020 -0700]","Body":"[BOOKIE-LEDGER-RECOVERY] Fix bookie recovery stuck even with enough ack-quorum response\n\n### Motivation\r\nAs discussed at https://github.com/apache/pulsar/issues/6505 \r\n\r\nBk-client was not able to recover ledger which has 2 write/ack quorum and one of the bookie went down and recovery was kept failing and bookkeeper client was not able to recover the ledger.\r\n\r\n**BK-Client log**\r\n\r\n```\r\n20:44:43.721 [BookKeeperClientWorker-OrderedExecutor-1-0] ERROR org.apache.bookkeeper.client.ReadLastConfirmedOp - While readLastConfirmed ledger: 1234567 did not hear success responses from all quorums\r\n20:44:43.721 [bookkeeper-io-12-27] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xb8b97441, L:/1.1.1.1:1234]/1.1.1.2:3181, current s\r\ntate CONNECTING : \r\nio.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: No route to host: /1.1.1.2:3181\r\n        at io.netty.channel.unix.Errors.throwConnectException(Errors.java:112) ~[netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at io.netty.channel.unix.Socket.finishConnect(Socket.java:269) ~[netty-all-4.1.32.Final.jar:4.1.32.Final]\r\n        at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:665) [netty-transport-native-epoll-4.1.31.Final.jar:4.1.31.Final]\r\n        at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:642) [netty-transport-native-epoll-4.1.31.Final.jar:4.1.31.Final]\r\n        at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:522) [netty-transport-native-epoll-4.1.31.Final.jar:4.1.31.Final]\r\n        at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:423) [netty-transport-native-epoll-4.1.31.Final.jar:4.1.31.Final]\r\n        at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:330) [netty-transport-native-epoll-4.1.31.Final.jar:4.1.31.Final]\r\n        at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897) [netty-common-4.1.31.Final.jar:4.1.31.Final]\r\n        at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.31.Final.jar:4.1.31.Final]\r\n        at java.lang.Thread.run(Thread.java:834) [?:?]\r\nCaused by: java.net.ConnectException: finishConnect(..) failed: No route to host\r\n```\r\n\r\n**Ledger metadata**\r\n\r\n```\r\nBookieMetadataFormatVersion 2\r\nquorumSize: 2\r\nensembleSize: 2\r\nlength: 0\r\nlastEntryId: -1\r\nstate: IN_RECOVERY\r\nsegment {\r\n  ensembleMember: \"1.1.1.1:3181\"\r\n  ensembleMember: \"1.1.1.2:3181\"\r\n  firstEntryId: 0\r\n}\r\ndigestType: CRC32\r\n```\r\n\r\n**Root cause:**\r\nBookie should be able to recover ledger once it receives the response from total N (`(Qw - Qa)+1`) bookies. But it was waiting for a successful response from both quorums.\r\nReference: https://bookkeeper.apache.org/docs/4.5.0/development/protocol/\r\n\r\n### Modification\r\nBookie should be able to recover ledger once it receives the response from total N (`(Qw - Qa)+1`) bookies.\r\n\n\nReviewers: Diego Salvi <diego.salvi@diennea.com>,  Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2281 from rdhabalia/recover_q","Date":"Mon Mar 23 17:02:26 CET 2020"},{"Commit-ID":"commit e482a125429d6b29382ea56b793daa5447927655 1585074161 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Tue Mar 24 19:22:41 2020 +0100]","Body":"Update Arquillian Cube to 1.18.2\n\n### Motivation\r\nUpdate Arquillian to latest version\n\nReviewers: Rajan Dhabalia <rdhabalia@apache.org>\n\nThis closes #2297 from eolivelli/fix/update-arquillian","Date":"Tue Mar 24 19:22:41 CET 2020"},{"Commit-ID":"commit 87981d420d0ae9d472d4e92b7abc145069e17e61 1585527245 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Sun Mar 29 17:14:05 2020 -0700]","Body":"Unable to enable TLS if using v2 protocol\n\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\nTLS is enabled using `startTLS` but the `startTLS`\r\nis a v3 protobuf request. So if the client is\r\nconfigured to use v2 protocol, the client is not\r\nable to decode `startTLSResponse`.\r\n\r\n*Modifications*\r\n\r\nThis change is to improve the v2 protocol response handling for\r\nhandling `startTLS` response.\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2300 from sijie/fix_tls_v2_protocol","Date":"Mon Mar 30 02:14:05 CEST 2020"},{"Commit-ID":"commit 665565e9802c3aec4b49df5dd53967b6d1981ca6 1585527400 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Mon Mar 30 02:16:40 2020 +0200]","Body":"Allow build on JDK14 - upgrade Groovy compiler\n\n### Motivation\r\n\r\nCurrent version of Groovy compiler for integration tests do not support JDK14\r\n\r\n### Changes\r\n\r\nUpdate Groovy Compiler\r\nUpdate dockerfile-maven-plugin as well\r\n\r\n\n\nReviewers: Sijie Guo <None>\n\nThis closes #2298 from eolivelli/fix/build-jdk14","Date":"Mon Mar 30 02:16:40 CEST 2020"},{"Commit-ID":"commit e7430ce25e3609bf77b028e4f0475dad2147c22d 1585681936 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Tue Mar 31 12:12:16 2020 -0700]","Body":"[bookie-server-config] Avoid considering empty journalDirectories\n\nAs discussed at : https://github.com/apache/pulsar/issues/6042\r\n\r\n### Issue\r\nWe have config management tool which manages bookie-server configuration and sets empty value of `journalDirectories` if bookie-server is still wants to use single journal dir: `journalDirectory`. In this case, bookie-server doesn't consider `journalDirectory` value and keeps empty list of `journalDirectories` which stats bookie with invalid configuration.\r\n\r\n### Expected behavior\r\nBookie-server should parse empty configuration `journalDirectories=` properly and avoid picking up empty value of `journalDirectories` and in that case, bookie-server should fallback to `journalDirectory` config.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2245 from rdhabalia/journal_dir","Date":"Tue Mar 31 21:12:16 CEST 2020"},{"Commit-ID":"commit 45871dccbb72a5aee30f7bbfaacfa0d6c2c202a5 1586762767 -----sp","Author":"PersonIdent[liudezhi, 33149602+liudezhi2098@users.noreply.github.com, Mon Apr 13 15:26:07 2020 +0800]","Body":"Fix batch read data in cache does not take effect\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\nFix batch read data in cache does not take effect\r\n\r\n### Changes\r\n\r\n(Describe: what changes you have made)\r\n\r\nMaster Issue: #2230 \r\nFixes: #2230 \r\n\r\n\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2231 from liudezhi2098/issue-branch-xxx","Date":"Mon Apr 13 09:26:07 CEST 2020"},{"Commit-ID":"commit f1077a6fa48553d7d8b1cf164e2e5a4f37125204 1587481234 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Tue Apr 21 17:00:34 2020 +0200]","Body":"Force to use Python grpcio less then 1.26.0\n\n- it looks like a newer version of grpcio has been published and we were using open version range\r\n- by forcing a closed ended range of version we workaround the error in integration tests\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Matteo Minardi <minardi.matteo@hotmail.it>\n\nThis closes #2317 from eolivelli/fix/integration-tests-python","Date":"Tue Apr 21 17:00:34 CEST 2020"},{"Commit-ID":"commit 76286bc5505e4ba1cfeb47ce30bbe627d53f4869 1587500488 -----sp","Author":"PersonIdent[Matteo Minardi, minardi.matteo@hotmail.it, Tue Apr 21 22:21:28 2020 +0200]","Body":"ISSUE #2274: The 'metaformat' command does not delete 'idgen' znode\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nAfter `metaformat`, ledgerId does not count from 0 because，the `metaformat` command does not delete `idgen` znode.\r\n\r\n### Changes\r\n\r\nIn the `AbstractZkLedgerManagerFactory` avoid skipping the igen and idgen-long nodes\r\n\r\nMaster Issue: #2274\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2315 from mino181295/leadger-metaformat, closes #2274","Date":"Tue Apr 21 22:21:28 CEST 2020"},{"Commit-ID":"commit e20a24a6aca44968fe6a597be31e08a552d38dec 1587500850 -----sp","Author":"PersonIdent[Anup Ghatage, ghatageanup@gmail.com, Tue Apr 21 13:27:30 2020 -0700]","Body":"Add forkCount option to parallelize build and tests\n\n### Motivation\r\nCurrent code forks a new JVM per module. (bookkeeper-server, bookkeeper-proto etc)\r\nThis means one fork per module for build and testing, no parallelism within the module where majority of the time goes.\r\nWe need parallelism within a module during the test execution so we can have the builds complete faster and have the artifacts shipped out quicker.\r\n\r\n### Changes\r\nWe use the maven surefire plugin but don't define the `forkCount` and hence set it to default of 1.\r\nThis means it executes each module with one thread.\r\nThis change sets `forkCount` to 5, enabling parallelism in testing and drastically reducing total turnaround time. (by about 2/3rds!)\r\n\r\n*Total build+test time without this change*\r\n```\r\n[INFO] BUILD SUCCESS\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] Total time:  01:06 h\r\n[INFO] Finished at: 2020-03-05T02:01:29-08:00\r\n[INFO] ------------------------------------------------------------------------\r\n```\r\n*Total build+test time with this change*\r\n```\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] BUILD SUCCESS\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] Total time:  18:23 min\r\n[INFO] Finished at: 2020-03-05T02:38:22-08:00\r\n[INFO] ------------------------------------------------------------------------\r\n```\r\n\r\n### Things to watch\r\nAdded parallelism may cause some flappers but with much trial and error I have come to the number `5`. The flappers are usually only from conflict in obtaining the same port number.\r\nIf needed, we can increase the retryCount, but as of now I consistently don't see any flappers at a `forkCount` of 5\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2278 from Ghatage/parallelizeBuildAndTests","Date":"Tue Apr 21 22:27:30 CEST 2020"},{"Commit-ID":"commit 380ed4ef79d0429f7d05d611b48915ac77638565 1587501133 -----sp","Author":"PersonIdent[John Pradeep, yehohanan7@gmail.com, Tue Apr 21 21:32:13 2020 +0100]","Body":"Fix mistakes in documentation\n\nFix minor mistakes in the sentences of the documentation\r\n\r\n\r\n\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>\n\nThis closes #2271 from yehohanan7/patch-1","Date":"Tue Apr 21 22:32:13 CEST 2020"},{"Commit-ID":"commit e4febdbf048afaf6bdcd8bede16ddd80db0cbc07 1587501424 -----sp","Author":"PersonIdent[dependabot[bot], 49699333+dependabot[bot]@users.noreply.github.com, Tue Apr 21 13:37:04 2020 -0700]","Body":"Bump libthrift from 0.9.3 to 0.12.0 (#2201)\n\nBumps [libthrift](https://github.com/apache/thrift) from 0.9.3 to 0.12.0.\r\n- [Release notes](https://github.com/apache/thrift/releases)\r\n- [Changelog](https://github.com/apache/thrift/blob/master/CHANGES.md)\r\n- [Commits](https://github.com/apache/thrift/compare/0.9.3...v0.12.0)\r\n\r\nSigned-off-by: dependabot[bot] <support@github.com>\r\n\r\nCo-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>","Date":"Tue Apr 21 22:37:04 CEST 2020"},{"Commit-ID":"commit a1b187e338fd5892df7816d48c153e61302483cc 1588405845 -----sp","Author":"PersonIdent[Yang Yang, yyang@streamnative.io, Sat May 2 15:50:45 2020 +0800]","Body":"ISSUE #2310: Adds the autorecovery status service.\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\nIt would be convenient to support enable, disable, or check the status of autorecovery with REST API, just like what does in the toggle command.\r\n\r\n### Changes\r\n\r\nAdds an API to enable, disable, and get the current status of autorecovery at `/api/v1/autorecovery/status`.\r\n\r\nMaster Issue: #2310 \r\n\r\n\n\nReviewers: Sijie Guo <None>, Enrico Olivelli <eolivelli@gmail.com>, Matteo Minardi <minardi.matteo@hotmail.it>\n\nThis closes #2313 from fantapsody/autorecovery_status, closes #2310","Date":"Sat May 02 09:50:45 CEST 2020"},{"Commit-ID":"commit 94912a9fdca68391866baf598c36708e406728f8 1588405909 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Sat May 2 15:51:49 2020 +0800]","Body":"[DOC] SSLContextFactory -> TLSContextFactory\n\n### Motivation\r\nFrom 4.6.0 SSLContextFactory has been changed into TLSContextFactory. but some of the doc not updated.\r\n\r\n### Changes\r\nUpdated related doc.\n\nReviewers: Sijie Guo <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2307 from jiazhai/doc_outdate_ssl","Date":"Sat May 02 09:51:49 CEST 2020"},{"Commit-ID":"commit 092ebf2a7ec596db0357a072caf123b18a7f29e6 1588587523 -----sp","Author":"PersonIdent[Ravi Sharda, ravi.sharda@emc.com, Mon May 4 15:48:43 2020 +0530]","Body":"Issue #2212: Fix issues in Bookkeeper Docker image that prevented containers from starting up\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nThis PR modifies the Apache Bookkeeper Docker image to fix issues that were causing errors upon container bootstrap. The containers would exit soon after they were launched. See issue #2212 for a description of such an error. \r\n\r\nNote that the problems that are fixed in this PR were observed:\r\n\r\n* when launching containers using both Docker Compose and Kubernetes.  \r\n* when we were trying to upgrade the image to: `4.9.2`. It is highly likely that the issue is observed in other versions (except for `4.7.3`) too.  \r\n* when launching both a standalone container as well as a cluster of three containers.\r\n\r\n### Changes\r\nThe major changes made in this PR are as follows: \r\n* Updates the `Dockerfile` to install `zk-shell`. \r\n* Update the `init_bookie.sh` file to:\r\n   * Use `zk-shell` instead of `/opt/bookkeeper/bin/bookkeeper org.apache.zookeeper.ZooKeeperMain` command that doesn't work. \r\n  * Use `opt/bookkeeper/bin/bookkeeper shell initnewcluster` for initializing the cluster instead of the previously used command that did not work. \r\n  * Increase the time a container waits for an in-flight `initnewcluster` operation. \r\n  * Make the comments more descriptive.\r\n* Modifies `bin/common.sh` to handle the condition when file `/proc/sys/net/ipv6/bindv6only` is missing in the system. This can prevent a container from starting up in some cases. We have seen this issue on some Kubernetes-based environments. \r\n* Fixes errors in `docker-compose.yml` file. \r\n\r\n*Note:* Some of the changes made in this PR are modeled after changes made by sijie for `v4.7.2` in PR #1666 .\r\n\r\n### Master Issue\r\n#2212 \r\n\r\n\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2219 from ravisharda/startup-failure-docker-image, closes #2212","Date":"Mon May 04 12:18:43 CEST 2020"},{"Commit-ID":"commit d2b350845fc93c46dfdadbc498a78a37f74e6199 1588587667 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Mon May 4 18:21:07 2020 +0800]","Body":"Rerun the failed tests by comments\n\n---\r\n\r\n*Motivation*\r\n\r\nCurrently, non-committers cannot rerun the failure tests, we need to\r\nprovide the ability to let non-committer to rerun the failed tests.\r\nI wrote a Github Actions that can rerun the failed test by comments\r\n`rerun failure tests` and add it to the bookkeeper ci process.\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2309 from zymap/rerun-failure-job","Date":"Mon May 04 12:21:07 CEST 2020"},{"Commit-ID":"commit 34d35f033e1ef099e60ac75a9d59aecc6c5a2001 1588703053 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Tue May 5 20:24:13 2020 +0200]","Body":"Do not download SNAPSHOT during GitHub actions checks\n\n### Motivation\r\n\r\nSometimes GitHub actions checks are stuck in downloading SNAPSHOTs, there is not need for it\r\n\r\n### Changes\r\n\r\nAdd \"-nsu\" option to every Maven invokations and remove \"-Dstream\" that is now useless.\r\nI am also adding \"-B\" that suppresses the \"Progress\" noise in logs\r\n\r\nThis fix relates to #2294\n\nReviewers: Anup Ghatage <None>, Matteo Minardi <minardi.matteo@hotmail.it>, Rajan Dhabalia <rdhabalia@apache.org>\n\nThis closes #2323 from eolivelli/fix/no-snapshot-updates and squashes the following commits:\n\n69b7817a4 [Enrico Olivelli] Add -B\n3fa4523b2 [Enrico Olivelli] GitHub Actions: do not look for SNAPSHOT updates","Date":"Tue May 05 20:24:13 CEST 2020"},{"Commit-ID":"commit fe25574edc80f7c53141a0bd610bcf26d6b9b8d8 1588836184 -----sp","Author":"PersonIdent[dmercuriali, mercurialiden@gmail.com, Thu May 7 09:23:04 2020 +0200]","Body":"Issue #2106: Update ZookKeeper dependency to 3.5.7\n\nDescriptions of the changes in this PR:\r\nUpdated ZooKeeper dependency from 3.4.13 to 3.5.7\r\nExcluded transitive dependency to netty-all.\r\nUpdated maven-shade-pluging configuration in 'distributedlog-core-shaded' project. Package 'org.apache.jute' was moved to a ZooKeeper dependency (org.apache.zookeeper:zookeeper-jute), so i added the artifact to the artifactSet.\r\n\r\nUpdated license files:\r\n- updated Zookeeper to 3.5.7\r\n- removed Jline 2.11\r\n- removed Netty 3.10.1\r\n- added Zookeeper-jute 3.5.7\r\n\r\nMaster Issue: #2106 \r\n\r\n\n\nReviewers: Matteo Minardi <minardi.matteo@hotmail.it>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <zhaijia@apache.org>\n\nThis closes #2112 from dmercuriali/fix/#2106-update-zookeeper, closes #2106","Date":"Thu May 07 09:23:04 CEST 2020"},{"Commit-ID":"commit 8918fb8d5a2d44048edce0f128f97c56a582ba87 1589716056 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Sun May 17 19:47:36 2020 +0800]","Body":"[CI] Using master action code for checking rerun commands\n\n The rerun checks CI can not use ref to get all failure test actions. So I change to use sha of the commits to get all failure test actions to rerun. https://github.com/zymap/bot/pull/3/files\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2332 from zymap/fix-bot","Date":"Sun May 17 13:47:36 CEST 2020"},{"Commit-ID":"commit 27c32fc3eb54e9fe8ec1155f97f2f0079f5f716a 1589716223 -----sp","Author":"PersonIdent[dependabot[bot], 49699333+dependabot[bot]@users.noreply.github.com, Sun May 17 13:50:23 2020 +0200]","Body":"Bump jackson.version from 2.9.7 to 2.11.0 (#2326)\n\n","Date":"Sun May 17 13:50:23 CEST 2020"},{"Commit-ID":"commit adf086d54f85fa5321574300360f7fd86d47fe8b 1589717676 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Sun May 17 05:14:36 2020 -0700]","Body":"[BOOKIE-MTLS] add support of hostname verification\n\n### Motivation\r\n\r\nRight now, bookkeeper-client is not able to perform [hostname-verification](https://tersesystems.com/blog/2014/03/23/fixing-hostname-verification/) when it connects to broker over tls. Hostname-verification feature is already implemented in almost all [http-client](https://github.com/apache/httpcomponents-client/blob/master/httpclient5/src/main/java/org/apache/hc/client5/http/ssl/DefaultHostnameVerifier.java) but it's not supported by [netty](https://stackoverflow.com/questions/13315623/netty-ssl-hostname-verification-support) yet. therefore, client should be able to perform hostname-verification as per [RFC-2181](https://tools.ietf.org/html/rfc2818#section-3.1)\r\n\r\n### Modifications\r\n\r\n- added client configuration to enable hostname-verification (default disable)\r\n- use [http-client](https://github.com/apache/httpcomponents-client/blob/master/httpclient5/src/main/java/org/apache/hc/client5/http/ssl/DefaultHostnameVerifier.java) but it's not supported by [netty](https://stackoverflow.com/questions/13315623/netty-ssl-hostname-verification-support) to perform hostname-validation rather adding custom logic.\r\n- add httpclient-apache dependency into LICENSE and NOTICE files.\r\n\r\n### Result\r\n\r\nBookkeeper client will be able to perform hostname verification while creating ssl session with bookie.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2156 from rdhabalia/hostname","Date":"Sun May 17 14:14:36 CEST 2020"},{"Commit-ID":"commit fca0a071c3be99326b9075c24ff17ce76faf7bda 1589867712 -----sp","Author":"PersonIdent[lamber-ken, lamberken@apache.org, Tue May 19 13:55:12 2020 +0800]","Body":"Fix wrong module artifactId\n\n### Motivation\r\n\r\nFix wrong maven artifactId, there are three module use the same artifactId.\r\n\r\n### Changes\r\n\r\n![image](https://user-images.githubusercontent.com/20113411/81897790-e4fe2180-95e9-11ea-9449-92941fe4c1bc.png)\r\n\r\n\n\nReviewers: Matteo Minardi <minardi.matteo@hotmail.it>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2329 from lamber-ken/bk-fix-wrong-artifactId","Date":"Tue May 19 07:55:12 CEST 2020"},{"Commit-ID":"commit f373cb5976ebca41ae036a26ba69f1c341897c08 1589867786 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Tue May 19 07:56:26 2020 +0200]","Body":"QuorumCoverage should only count unknown nodes\n\nThe original patch was contributed by ivankelly in PR #2303, I have only fixed checkstyle and removed two tests that were wrong.\r\n\r\nQuorum coverage checks if we have heard from enough nodes to know that\r\nthere is no entry that can have been written to enough nodes that we\r\nhaven't heard from to have formed an ack quorum.\r\n\r\nThe coverage algorithm was correct pre-5e399df.\r\n\r\n5e399df(BOOKKEEPER-759: Delay Ensemble Change & Disable Ensemble\r\nChange) broke this, but it still seems to have worked because they had\r\na broken else statement at the end. Why a change which is 100% about\r\nthe write-path changed something in the read-path is a mystery.\r\n\r\ndcdd1e(Small fix wrong nodesUninitialized count when checkCovered)\r\nwent on to fix the broken fix, so the whole thing ended up broke.\r\n\r\nThe change also modifies ReadLastConfirmedOp to make it testable.\n\nReviewers: Sijie Guo <None>, Rajan Dhabalia <rdhabalia@apache.org>\n\nThis closes #2333 from eolivelli/pr2303","Date":"Tue May 19 07:56:26 CEST 2020"},{"Commit-ID":"commit a7ca7cff615391d1267f3546735e18b3306eb1e4 1589867876 -----sp","Author":"PersonIdent[Anup Ghatage, ghatageanup@gmail.com, Mon May 18 22:57:56 2020 -0700]","Body":"Issue #2305: Bookies should not be allowed to come up without a cookie in metadata store.\n\n### Motivation\r\nCurrently we allow bookies to come up even if they don't have a cookie in the metadata store.\r\nThe cookie is an identity of a registered bookie and a bookie should not be allowed to come up without it.\r\n\r\n### Changes\r\nUpdate handling of bookie boot up. Add test.\r\nThis scenario is rarely expected but can happen in case of corruption or errant deletion of znodes for cookies\r\n\n\nReviewers: Matteo Minardi <minardi.matteo@hotmail.it>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2306 from Ghatage/disableBootup-Wo-Cookie, closes #2305","Date":"Tue May 19 07:57:56 CEST 2020"},{"Commit-ID":"commit a8eb2d64ef040983493e65ed2c55e3255e3ee3b4 1589867924 -----sp","Author":"PersonIdent[Fretiq Labs, 60456830+fretiq@users.noreply.github.com, Tue May 19 00:58:44 2020 -0500]","Body":"Add /api/v1/bookie/info REST API\n\nDescriptions of the changes in this PR:\r\n\r\nThis adds an additional HTTP REST endpoint to expose the bookie's info (only storage numbers for now).\r\n\r\n### Motivation\r\n\r\nI was looking for an HTTP endpoint that returned the info of only the current bookie, but couldn't find one. The only similar API I've found was `/api/v1/bookie/list_bookie_info`, however it connects to all bookies and may take a long time to respond (plus its response format is difficult to parse).\r\n\r\n### Changes\r\n\r\nI've added a new API at `/api/v1/bookie/info` that returns a response like:\r\n```json\r\n{\r\n  \"freeSpace\" : 0,\r\n  \"totalSpace\" : 0\r\n}\r\n```\r\n\n\nReviewers: Matteo Minardi <minardi.matteo@hotmail.it>, Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <zhaijia@apache.org>\n\nThis closes #2322 from fretiq/add-bookie-info-api","Date":"Tue May 19 07:58:44 CEST 2020"},{"Commit-ID":"commit 993148e5b292a5b5fcaf64c95231e84fd1697831 1589867978 -----sp","Author":"PersonIdent[Sijie Guo, sijie@apache.org, Mon May 18 22:59:38 2020 -0700]","Body":"Handle NPE when inet address is not able to resolve network address\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n*Motivation*\r\n\r\n```\r\n06:00:53.731 [BookKeeperClientScheduler-OrderedScheduler-0-0] ERROR org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy - Unexpected exception while handling joining bookie pulsar-tls-bookie-0.pulsar-tls-bookie.pulsar.svc.cluster.local:3181\r\njava.lang.NullPointerException: null\r\n\tat org.apache.bookkeeper.net.NetUtils.resolveNetworkLocation(NetUtils.java:77) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]\r\n```\r\n\r\n*TEST*\r\n\r\nThe `getAddress` is final method. It is hard to mock.\r\n\r\nThe method has been covered by other tests.\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2301 from sijie/fix_network_utils","Date":"Tue May 19 07:59:38 CEST 2020"},{"Commit-ID":"commit e9021a607d55ed1802c44fd503fbf7640ad3ae98 1589869355 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Mon May 18 23:22:35 2020 -0700]","Body":"[BOOKKEEPER-TOOL] Fix update rate-limiting for update-ledger command\n\n### Motivation\r\nRight now, `UpdateLedgerCmd` provides option `updatespersec` to throttle number of writes on zk. However, it throttles number of reads instead writes. Because of that it takes long time to complete this command as it slows down the read instead applying throttling while writing to zk.\r\n\r\n### Modification\r\n- Apply throttling while updating zk.\r\n- If writes are being throttled then we also want to avoid accumulating reads so, added `maxOutstandingReads` option to manage max concurrent reads.\r\n\r\n**Note:** We also need this change for #2321 .. so, I will rebase #2321 once this PR is merged.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2336 from rdhabalia/update_rate","Date":"Tue May 19 08:22:35 CEST 2020"},{"Commit-ID":"commit 14ae5c8a03a10e55f778ee542afb5ed9a632eb23 1590237597 -----sp","Author":"PersonIdent[lamber-ken, lamberken@apache.org, Sat May 23 20:39:57 2020 +0800]","Body":"[BUG] Fix wrong jdk version on install doc page\n\n### Motivation\r\n\r\nWe have adopted `lamada expression` and `stream api` in code base, it needs jdk1.8 at least.\r\n\r\ne.g org.apache.bookkeeper.meta.zk.ZKMetadataClientDriver\r\n```\r\nOverride\r\npublic void setSessionStateListener(SessionStateListener sessionStateListener) {\r\n    zk.register((event) -> {\r\n        // Check for expired connection.\r\n        if (event.getType().equals(EventType.None) && event.getState().equals(KeeperState.Expired)) {\r\n            sessionStateListener.onSessionExpired();\r\n        }\r\n    });\r\n}\r\n```\r\n\r\n![image](https://user-images.githubusercontent.com/20113411/82619119-a4b12b80-9c07-11ea-92e5-a1e3f5f9ff6b.png)\r\n\r\n### Changes\r\n\r\nUpdate `Java Development Kit 1.6` to `Java Development Kit 1.8`\r\n\n\nReviewers: Matteo Minardi <minardi.matteo@hotmail.it>\n\nThis closes #2343 from lamber-ken/clean-fix-install-doc","Date":"Sat May 23 14:39:57 CEST 2020"},{"Commit-ID":"commit f15b9bd15766d87d04258387a1164260056e088b 1590237719 -----sp","Author":"PersonIdent[lamber-ken, lamberken@apache.org, Sat May 23 20:41:59 2020 +0800]","Body":"[BUG] Fix flaky testLedgerOpenAfterBKCrashed\n\n### Motivation\r\n\r\n`BookieFailureTest#testLedgerOpenAfterBKCrashed` is a flaky test case, it cause some pr failed.\r\n\r\n```\r\norg.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger\r\n  at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83)\r\n  at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157)\r\n  at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232)\r\n  at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201)\r\n  at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193)\r\n  at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62)\r\n  at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189)\r\n  at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295)\r\n  at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:760)\r\n  at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:736)\r\n  at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:474)\r\n  at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1977)\r\n  at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136)\r\n  at org.apache.bookkeeper.client.LedgerRecoveryOp.onEntryComplete(LedgerRecoveryOp.java:202)\r\n  at org.apache.bookkeeper.client.ListenerBasedPendingReadOp.submitCallback(ListenerBasedPendingReadOp.java:67)\r\n  at org.apache.bookkeeper.client.PendingReadOp$LedgerEntryRequest.fail(PendingReadOp.java:170)\r\n  at org.apache.bookkeeper.client.PendingReadOp$SequenceReadRequest.sendNextRead(PendingReadOp.java:392)\r\n  at org.apache.bookkeeper.client.PendingReadOp$SequenceReadRequest.logErrorAndReattemptRead(PendingReadOp.java:435)\r\n  at org.apache.bookkeeper.client.PendingReadOp.readEntryComplete(PendingReadOp.java:581)\r\n  at org.apache.bookkeeper.proto.BookieClientImpl$2.safeRun(BookieClientImpl.java:369)\r\n  at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36)\r\n  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n  at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\r\n  at java.lang.Thread.run(Thread.java:748)\r\n```\r\n\r\n![image](https://user-images.githubusercontent.com/20113411/82434983-3add3880-9ac6-11ea-96a3-24fbd71d16d4.png)\r\n\r\n### Changes\r\n\r\nTest case should cover following situation, which shutdown any one of bookies, and try to open ledger with no bookie recovery. \r\n```\r\nBookies: 4\r\nensSize: 3\r\nwriteQuorumSize: 2\r\nackQuorumSize: 2\r\n```\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2337 from lamber-ken/bk-fix-wrong-test","Date":"Sat May 23 14:41:59 CEST 2020"},{"Commit-ID":"commit 637bfa756ddba08bf5f67fc2d45124afd5dbc0bc 1590560041 -----sp","Author":"PersonIdent[Matteo Minardi, minardi.matteo@hotmail.it, Wed May 27 08:14:01 2020 +0200]","Body":"BP-38: Publish Bookie Service Info on Metadata Service\n\nStarting from the implementation of the #2213 PR \r\n\r\n### Changes\r\n\r\n- Adding the ability for the Bookie to advertise on the Metadata Service (ZooKeeper) the exposed ports/services, like the HTTP service, Metrics\r\n- Implemented the Protobuf serialization of the BookieServiceInfo\r\n- Added the command EndpointInfoCommand to retrieve remote bookie endpoint information both for \"bkctl\" and \"bookkeeper shell\".\r\nUsage: `\r\nbin/bookkeeper shell endpointinfo -bookieid <bookieaddress>\r\n`\r\n\r\nMaster Issue: #2215 \r\nProposal Doc: https://bookkeeper.apache.org/bps/BP-38-bookie-endpoint-discovery\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2314 from mino181295/single/endpoint-discovery-impl","Date":"Wed May 27 08:14:01 CEST 2020"},{"Commit-ID":"commit 0fe624819b56951daf1a98a78651e981b7629042 1590560152 -----sp","Author":"PersonIdent[lamber-ken, lamberken@apache.org, Wed May 27 14:15:52 2020 +0800]","Body":"[CLEAN] remove duplicate property key in log4j.properties\n\n### Motivation\r\n\r\n1. Fix duplicate key in log4j.properties\r\n2. `http` to `https` in `README`\r\n\r\n### Changes\r\n\r\n![image](https://user-images.githubusercontent.com/20113411/82162451-369ef880-98d7-11ea-9217-777721bba545.png)\r\n\r\n![image](https://user-images.githubusercontent.com/20113411/82162816-d2c9ff00-98d9-11ea-967e-53646d351753.png)\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2334 from lamber-ken/clean-log","Date":"Wed May 27 08:15:52 CEST 2020"},{"Commit-ID":"commit 52330277565021c9d30d268cefee3e2bad1db5ae 1590560236 -----sp","Author":"PersonIdent[Yang Yang, yyang@streamnative.io, Wed May 27 14:17:16 2020 +0800]","Body":"ISSUE #2311: Adds support to decode metadata in the API that list ledgers\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nThe current list ledgers API output the metadata in a serialized binary format, which is not friendly to human operators and external tools, and is not consistent with the output of the [API that gets the metadata](https://bookkeeper.apache.org/docs/4.9.2/admin/http/#endpoint-apiv1ledgermetadataledger_idledger_id).\r\n\r\n### Changes\r\n\r\nThe PR adds a parameter called `decode_meta`, and output the ledger metadata in decoded format when the parameter presents and the value of it is 'true'.\r\n\r\nMaster Issue: https://github.com/apache/bookkeeper/issues/2311\r\n\r\n\n\nReviewers: Sijie Guo <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2312 from fantapsody/decode_metadata, closes #2311","Date":"Wed May 27 08:17:16 CEST 2020"},{"Commit-ID":"commit 08209f47495c75c6acfbdd96691557d581943a25 1590799198 -----sp","Author":"PersonIdent[lamber-ken, lamberken@apache.org, Sat May 30 08:39:58 2020 +0800]","Body":"[LOG] Change ERROR to INFO log level\n\n### Motivation\r\n\r\nWhen use shell command, it output nothing caused by `ERROR` level.\r\n\r\n**OLD** (output nothing)\r\n```\r\nbin/bookkeeper shell readlogmetadata 0\r\n```\r\n**FIX**\r\n```\r\nbin/bookkeeper shell readlogmetadata 0\r\n\r\n06:58:01,364 INFO  Print entryLogMetadata of entrylog 0 (0.log)\r\n06:58:01,467 INFO  Failed to get ledgers map index from: 0.log : No ledgers map index found on entryLogId0\r\n06:58:01,471 INFO  --------- Lid=0, TotalSizeOfEntriesOfLedger=59  ---------\r\n```\r\n\r\n### Changes\r\n\r\n- Remove duplicate definition `VERBOSECONSOLE `\r\n- Change `ERROR` to `INFO`\r\n\n\nReviewers: Sijie Guo <None>\n\nThis closes #2350 from lamber-ken/bk-improve-shell-log-level","Date":"Sat May 30 02:39:58 CEST 2020"},{"Commit-ID":"commit bcd4b67b6fea2c878f57729f617a175a0b1ace40 1590861391 -----sp","Author":"PersonIdent[Matteo Minardi, minardi.matteo@hotmail.it, Sat May 30 19:56:31 2020 +0200]","Body":"[CLEAN] Replace com.google.common.base.Optional with java.util.Optional\n\n### Motivation\r\n\r\n`com.google.common.base.Optional` and `java.util.Optional` exist in the code base at the same time.\r\n\r\n### Changes\r\nReplace `com.google.common.base.Optional` with `java.util.Optional`.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>, lamber-ken <None>\n\nThis closes #2346 from mino181295/merge-optional","Date":"Sat May 30 19:56:31 CEST 2020"},{"Commit-ID":"commit 859e7ee052ba812d713c497888d9e336ed5077ca 1590861615 -----sp","Author":"PersonIdent[lamber-ken, lamberken@apache.org, Sun May 31 02:00:15 2020 +0800]","Body":"[CLEAN] Replace google.charsets with java.charsets\n\n### Motivation\r\n\r\n`com.google.common.base.Charsets` and `java.nio.charset.StandardCharsets` exist in the code base at the same time, we can improve them.\r\n\r\n### Changes\r\n\r\nReplace `com.google.common.base.Charsets` with `java.nio.charset.StandardCharsets`.\r\n\n\nReviewers: Matteo Minardi <minardi.matteo@hotmail.it>, Sijie Guo <None>\n\nThis closes #2342 from lamber-ken/clean-charsets","Date":"Sat May 30 20:00:15 CEST 2020"},{"Commit-ID":"commit 0650d1ec0843931304abd7fd34fb600c0bac54d8 1590861687 -----sp","Author":"PersonIdent[lamber-ken, lamberken@apache.org, Sun May 31 02:01:27 2020 +0800]","Body":"[BUG] Fix bookie port conflict when using LocalBookKeeper\n\n### Motivation\r\n\r\nWhen using `bin/bookkeeper localbookie 10`, always output following exception, and run failed.\r\n\r\n```\r\njava.net.BindException: Address already in use\r\n  at sun.nio.ch.Net.bind0(Native Method)\r\n  at sun.nio.ch.Net.bind(Net.java:433)\r\n  at sun.nio.ch.Net.bind(Net.java:425)\r\n  at sun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:223)\r\n  at io.netty.channel.socket.nio.NioServerSocketChannel.doBind(NioServerSocketChannel.java:130)\r\n  at io.netty.channel.AbstractChannel$AbstractUnsafe.bind(AbstractChannel.java:562)\r\n  at io.netty.channel.DefaultChannelPipeline$HeadContext.bind(DefaultChannelPipeline.java:1358)\r\n  at io.netty.channel.AbstractChannelHandlerContext.invokeBind(AbstractChannelHandlerContext.java:501)\r\n  at io.netty.channel.AbstractChannelHandlerContext.bind(AbstractChannelHandlerContext.java:486)\r\n  at io.netty.channel.DefaultChannelPipeline.bind(DefaultChannelPipeline.java:1019)\r\n  at io.netty.channel.AbstractChannel.bind(AbstractChannel.java:258)\r\n  at io.netty.bootstrap.AbstractBootstrap$2.run(AbstractBootstrap.java:366)\r\n  at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:163)\r\n  at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)\r\n  at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:474)\r\n  at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:909)\r\n  at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\r\n  at java.lang.Thread.run(Thread.java:748)\r\n```\r\n\r\n\r\n### Changes\r\n\r\nUse `PortManager` to obtain available ports based on initialPort.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2338 from lamber-ken/fix-localbookeeper-error","Date":"Sat May 30 20:01:27 CEST 2020"},{"Commit-ID":"commit 26120e0436d0076bf7990b5cea1e41a3e287af04 1590861742 -----sp","Author":"PersonIdent[lamber-ken, lamberken@apache.org, Sun May 31 02:02:22 2020 +0800]","Body":"[CLEAN] Fix missing Override annotation\n\n### Motivation\r\n\r\n**Code clean**\r\n\r\n- An overridden method should be marked with Override annotation, once the method signature in the abstract class is changed, the implementation class will report a compile-time error immediately.\r\n\r\n- Exception class names must be ended with Exception\r\n\r\n- The negation operator is not easy to be quickly understood\r\n\r\n### Changes\r\n\r\n- Fix missing `Override` annotation\r\n- `NoIndexForLedger` to `NoIndexForLedgerException` \r\n- `!(n.doubleValue() > max.doubleValue())` to `(n.doubleValue() <= max.doubleValue())`\r\n\r\n\n\nReviewers: Matteo Minardi <minardi.matteo@hotmail.it>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2331 from lamber-ken/bb-clean","Date":"Sat May 30 20:02:22 CEST 2020"},{"Commit-ID":"commit a9e604525f4a784133d23666e94d16f101749197 1591017847 -----sp","Author":"PersonIdent[lamber-ken, lamberken@apache.org, Mon Jun 1 21:24:07 2020 +0800]","Body":"[BUG] Fix class not found compilation failure\n\n### Motivation\r\n\r\nFix compilation failure after merged https://github.com/apache/bookkeeper/pull/2338\r\n\r\n![image](https://user-images.githubusercontent.com/20113411/83361037-3a8f4800-a3b8-11ea-9691-ea2842a18cfd.png)\r\n\r\n### Changes\r\n\r\nFix wrong package location.\r\n\r\n\r\n\n\nReviewers: Matteo Minardi <minardi.matteo@hotmail.it>, Enrico Olivelli <eolivelli@apache.org>\n\nThis closes #2351 from lamber-ken/misscleass","Date":"Mon Jun 01 15:24:07 CEST 2020"},{"Commit-ID":"commit 2a24be666a861b1f6eece25a9cde42459b5b32a2 1591618681 -----sp","Author":"PersonIdent[lamber-ken, lamberken@apache.org, Mon Jun 8 20:18:01 2020 +0800]","Body":"[BUG] Fix avoid invoke init drivers repeatedly\n\n### Motivation\r\n\r\nstatic code blocks are always invoked when the class is initialized, when client connect to bookkeeper server, output repeat init log\r\n\r\n```\r\n2020-06-04 10:10:24,751 INFO  org.apache.bookkeeper.meta.MetadataDrivers                    - BookKeeper metadata driver manager initialized\r\n2020-06-04 10:10:24,753 INFO  org.apache.bookkeeper.meta.MetadataDrivers                    - BookKeeper metadata driver manager initialized\r\n2020-06-04 10:10:24,753 INFO  org.apache.bookkeeper.meta.MetadataDrivers                    - BookKeeper metadata driver manager initialized\r\n```\r\n\r\n### Changes\r\n\r\nRemove redundant initialization code.\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Matteo Minardi <minardi.matteo@hotmail.it>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2356 from lamber-ken/bk-init-repeat","Date":"Mon Jun 08 14:18:01 CEST 2020"},{"Commit-ID":"commit b1c7232b46ab33b20a9a44ef19a815be172e6c99 1591618917 -----sp","Author":"PersonIdent[lamber-ken, lamberken@apache.org, Mon Jun 8 20:21:57 2020 +0800]","Body":"[BOT] Implement ci bot using github-script\n\n### Motivation\r\n\r\n`GitHub Action` is deprecated! Implement ci bot using `actions/github-script`, instead.\r\n\r\nhttps://github.com/actions/github\r\n\r\nhttps://github.com/actions/github-script\r\n\r\n### Changes\r\n\r\nImplement ci using `actions/github-script`, based on https://github.com/zymap/bot/tree/v1.0.1\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Yong Zhang <zhangyong1025.zy@gmail.com>, Sijie Guo <None>\n\nThis closes #2352 from lamber-ken/bot-v2","Date":"Mon Jun 08 14:21:57 CEST 2020"},{"Commit-ID":"commit 62a5074044ce9d5571b133f4a0a29d77dc4f5163 1591619072 -----sp","Author":"PersonIdent[lamber-ken, lamberken@apache.org, Mon Jun 8 20:24:32 2020 +0800]","Body":"[BUG] Fix redundant statistics\n\n### Motivation\r\n\r\nFix redundant statistics, run 5 bookies `bin/bookkeeper localbookie 10`, then show bookieinfo\r\n\r\n```\r\n./bin/bookkeeper shell bookieinfo\r\n```\r\n\r\n**Wrong result**\r\n```\r\nFree disk space info:\r\n10.101.52.18(10.101.52.18):5004:        Free: 34930151424(34.93GB)      Total: 255850758144(255.85GB)\r\n10.101.52.18(10.101.52.18):5003:        Free: 34930151424(34.93GB)      Total: 255850758144(255.85GB)\r\n10.101.52.18(10.101.52.18):5002:        Free: 34930151424(34.93GB)      Total: 255850758144(255.85GB)\r\n10.101.52.18(10.101.52.18):5000:        Free: 34930151424(34.93GB)      Total: 255850758144(255.85GB)\r\n10.101.52.18(10.101.52.18):5005:        Free: 34930151424(34.93GB)      Total: 255850758144(255.85GB)\r\nTotal free disk space in the cluster:   174650757120(174.65GB)\r\nTotal disk capacity in the cluster:     1279253790720(1.279TB)\r\n```\r\n\r\n**Right result**\r\n```\r\nFree disk space info:\r\n10.101.52.18(10.101.52.18):5004:        Free: 33172185088(33.172GB)     Total: 255850758144(255.85GB)\r\n10.101.52.18(10.101.52.18):5003:        Free: 33172185088(33.172GB)     Total: 255850758144(255.85GB)\r\n10.101.52.18(10.101.52.18):5002:        Free: 33172185088(33.172GB)     Total: 255850758144(255.85GB)\r\n10.101.52.18(10.101.52.18):5006:        Free: 33172185088(33.172GB)     Total: 255850758144(255.85GB)\r\n10.101.52.18(10.101.52.18):5005:        Free: 33172185088(33.172GB)     Total: 255850758144(255.85GB)\r\nTotal free disk space in the cluster:   33172185088(33.172GB)\r\nTotal disk capacity in the cluster:     255850758144(255.85GB)\r\n```\r\n\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2348 from lamber-ken/bk-info-command","Date":"Mon Jun 08 14:24:32 CEST 2020"},{"Commit-ID":"commit 0bea124989d68376249826e35b179a755eda9025 1591974339 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Fri Jun 12 08:05:39 2020 -0700]","Body":"Remove lock from URManager\u2019s state only if lock znode deletion has succeeded\n\n\r\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n- in ZkLedgerUnderreplicationManager.releaseUnderreplicatedLedger remove \u2018lock\u2019\r\n from \u2018heldLocks\u2019 only if lock znode deletion has succeeded.\r\n- This is needed because, if RW.logBKExceptionAndReleaseLedger fails to delete\r\n the lock znode, then it needs to be tried once more in the finally block of\r\n 'rereplicate(long ledgerIdToReplicate)\u2019 before giving up and shutting down RW.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2206 from reddycharan/fixzklossissue","Date":"Fri Jun 12 17:05:39 CEST 2020"},{"Commit-ID":"commit b411dac67db385b033db875f5926465201ec3471 1591974391 -----sp","Author":"PersonIdent[Charan Reddy Guttapalem, cguttapalem@salesforce.com, Fri Jun 12 08:06:31 2020 -0700]","Body":"Ledger having a Empty segment is causing ReplicasCheck scrutiny to fail\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n- in Auditor.ReadLedgerMetadataCallbackForReplicasCheck, fixing logic for empty segments\r\n- added test for validating areEntriesOfLedgerStoredInTheBookie for empty middle segment\r\n- added testcase for ledger with more empty segments.\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2205 from reddycharan/fixreplicascheck","Date":"Fri Jun 12 17:06:31 CEST 2020"},{"Commit-ID":"commit 2650985413081580bc93c0cc88f8c9369238890e 1592463858 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Thu Jun 18 00:04:18 2020 -0700]","Body":"[BOOKIE-SHELL] Add cmd to change bookie-address into ledger metadata\n\n### Motivation\r\nIn a large bookie cluster environment, we frequently require a utility to change bookie-ip with a different bookie-ip in ledger's metadata in different scenarios such as:\r\n1. Host Re-IP: requires updating ledger metadata and reuse the host without losing/copying data\r\n2. Backup-restore usecase while doing cluster level data migration.\r\nTherefore, we frequently need a tool to update bookie-ip with a new bookie-ip in existing ledgers' ensemble metadata.\r\n\r\n### Modification\r\nAdd CLI command to update bookie-id in ledger metadata.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>, Jia Zhai <zhaijia@apache.org>\n\nThis closes #2321 from rdhabalia/reip","Date":"Thu Jun 18 09:04:18 CEST 2020"},{"Commit-ID":"commit b7e91423ddb1dfd9c4f00f580b2f9cbaaa26a2f8 1592673894 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Sat Jun 20 10:24:54 2020 -0700]","Body":"Change Python client version to 4.11.0\n\nAccording to the release guide, before cutting a release we have to remove the 'alpha' qualifier from Python client version\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2362 from rdhabalia/python_client","Date":"Sat Jun 20 19:24:54 CEST 2020"},{"Commit-ID":"commit 571a2419eec3408eec010e70a26d6b9cbb446594 1592679803 -----sp","Author":"PersonIdent[rdhabalia, rdhabalia@apache.org, Sat Jun 20 12:03:23 2020 -0700]","Body":"[maven-release-plugin] prepare branch branch-4.11\n","Date":"Sat Jun 20 21:03:23 CEST 2020"},{"Commit-ID":"commit 6483781d7d23b691a59c4057c13a439a344d50e0 1592679811 -----sp","Author":"PersonIdent[rdhabalia, rdhabalia@apache.org, Sat Jun 20 12:03:31 2020 -0700]","Body":"[maven-release-plugin] prepare for next development iteration\n","Date":"Sat Jun 20 21:03:31 CEST 2020"},{"Commit-ID":"commit a3ffbd278986edc5d5d05ebf25f1c010e7cc5dd9 1592980659 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Wed Jun 24 08:37:39 2020 +0200]","Body":"Fix distributedlog Maven reactor module\n\n- fix version\r\n- add explicitly distributedlog to the modules of Stream project\r\n- fix checkstyle on distributedlog, it wasn't executed\r\n\n\nReviewers: Rajan Dhabalia <rdhabalia@apache.org>\n\nThis closes #2364 from eolivelli/fix/fix-dlog-dep","Date":"Wed Jun 24 08:37:39 CEST 2020"},{"Commit-ID":"commit b6ed41f8ed151e7cecc5c94d8cb3451c6c1e2bd7 1594189291 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Tue Jul 7 23:21:31 2020 -0700]","Body":"Bump Python client version: 4.12.0-alpha-0\n\n### Motivation\r\nBump up python client version 4.12.0-alpha-0\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2370 from rdhabalia/py_412","Date":"Wed Jul 08 08:21:31 CEST 2020"},{"Commit-ID":"commit 20eb8d9897b1f41dbd42a10533751dbf5a8f2c24 1594189340 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Tue Jul 7 23:22:20 2020 -0700]","Body":"Release note 4.11 note\n\n### Motivation\r\nAdding Release-note for 4.11.0\r\n\r\nPlease review commit https://github.com/apache/bookkeeper/pull/2361/commits/98dbb911353b4fa2262ae8ee79210f7b81bbf7c8\r\n\r\n*Note:* This PR is based on #2360 . I will rebase this PR once #2360 is merged.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2361 from rdhabalia/release_note_4.11_note","Date":"Wed Jul 08 08:22:20 CEST 2020"},{"Commit-ID":"commit fbed0db2ad4a0a12eccdc67d92c2ed5dc3736216 1594189664 -----sp","Author":"PersonIdent[Anup Ghatage, ghatageanup@gmail.com, Tue Jul 7 23:27:44 2020 -0700]","Body":"Add slack-digest script which generates per channel digest emails to \u2026\n\n\u2026be emailed to the respective mailing lists.\r\n\r\nOriginal script by merlimat from his [private repo](https://github.com/merlimat/slack-email-digest).\r\nCopied to BK repo for use with the BookKeeper project.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2367 from Ghatage/slack-digest-jenkins","Date":"Wed Jul 08 08:27:44 CEST 2020"},{"Commit-ID":"commit e10af23985550b766a98bca1a35d0c9a56d8db4f 1594287450 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Thu Jul 9 02:37:30 2020 -0700]","Body":"Create CI jobs for branch-4.11\n\nCreate CI jobs for releases on branch-4.11.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2363 from rdhabalia/4.11-infra","Date":"Thu Jul 09 11:37:30 CEST 2020"},{"Commit-ID":"commit cd0970101306a2c031506ea9cea402803639e806 1594592791 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Sun Jul 12 15:26:31 2020 -0700]","Body":"[bookkeeper-site] fix latest version of bookkeeper website\n\n### Motivation\r\n\r\nAfter generating website using [script](http://bookkeeper.apache.org/community/release_guide/#update-website), it seems somhow it has updated site with incorrect version. I still have to find out where was the issue while generating the website. But fixing it for now to correct the version on website.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2372 from rdhabalia/fix_site","Date":"Mon Jul 13 00:26:31 CEST 2020"},{"Commit-ID":"commit 4376410a9299191388662b1131ad7452be47ee84 1595559236 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Fri Jul 24 04:53:56 2020 +0200]","Body":"Issue 2264: Bookie cannot perform Garbage Collection in case of corrupted EntryLogger file\n\n- in case of corrupted entry log file the bookie cannot perform GC\r\n- handle the case of an unexpected negative entrysize\r\n\r\n### Changes\r\n\r\nStop scanning the file\r\n\r\nMaster Issue: #2264\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Rajan Dhabalia <rdhabalia@apache.org>\n\nThis closes #2373 from eolivelli/fix/issue2264-corruptedfile","Date":"Fri Jul 24 04:53:56 CEST 2020"},{"Commit-ID":"commit 3748b9c554c6ba0d5b5c1780d4d35db2a83e89ef 1595832766 -----sp","Author":"PersonIdent[lamber-ken, 2217232293@qq.com, Mon Jul 27 14:52:46 2020 +0800]","Body":"[SITE] Improve the user experience of the site\n\n### Motivation\r\n\r\nImprove the user experience of the site.\r\n\r\n![image](https://user-images.githubusercontent.com/20113411/82639390-325a3e80-9c3b-11ea-8a27-6347c6f7178c.png)\r\n\r\n### Changes\r\n\r\n**Compare:**\r\nhttps://lamber-ken.github.io/docs/4.10.0/getting-started/installation/\r\nhttps://bookkeeper.apache.org/docs/4.10.0/getting-started/installation/\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Matteo Minardi <minardi.matteo@hotmail.it>\n\nThis closes #2344 from lamber-ken/improve-site","Date":"Mon Jul 27 08:52:46 CEST 2020"},{"Commit-ID":"commit 96f9c5a1b3a0b74d641a288544b6a3a0aa986574 1595833191 -----sp","Author":"PersonIdent[kennyjiang, 630862708@qq.com, Mon Jul 27 14:59:51 2020 +0800]","Body":"fix fillReadAheadCache stat bug\n\nThese code blocks will not be executed:\r\ndbLedgerStorageStats.getReadAheadBatchCountStats().registerSuccessfulValue(count);\r\ndbLedgerStorageStats.getReadAheadBatchSizeStats().registerSuccessfulValue(size);\r\n\r\n### Motivation\r\n\r\nfix fillReadAheadCache stat bug\r\n\r\n### Changes\r\n\r\nReplace return with break to exit the while loop\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Rajan Dhabalia <rdhabalia@apache.org>\n\nThis closes #2383 from holmes07/master","Date":"Mon Jul 27 08:59:51 CEST 2020"},{"Commit-ID":"commit b96a5a75403f3260b564ca8c5d5889af51fe9872 1595855189 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Mon Jul 27 15:06:29 2020 +0200]","Body":"Track ZooKeeper errors as causes of ZKException\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nEvery time a problem with ZK arises you don't see it in the exception chain of the BKException (in this case ZKException) and you end up with errors like:\r\n```\r\norg.apache.bookkeeper.client.BKException$ZKException: Error while using ZooKeeper\r\n        at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83)\r\n        at org.apache.bookkeeper.client.SyncCallbackUtils$SyncAddCallback.addComplete(SyncCallbackUtils.java:251)\r\n        at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91)\r\n        at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430)\r\n        at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784)\r\n        at org.apache.bookkeeper.client.LedgerHandle$5.safeRun(LedgerHandle.java:574)\r\n```\r\n\r\n### Changes\r\nAdd a \"cause\" to every ZKException.\r\n\r\n### Notes\r\nThere are very few places that cannot be fixed because they are still using the old callback based mechanism without CompletableFuture. Those points are not changed in order to make the patch simple but still useful.\r\n\r\n\r\n\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>\n\nThis closes #2384 from eolivelli/fix/zkexception-chain","Date":"Mon Jul 27 15:06:29 CEST 2020"},{"Commit-ID":"commit f61302268022f3eaef198b4a2d2a3673389ae874 1597289574 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Thu Aug 13 05:32:54 2020 +0200]","Body":"BP-41 Separate BookieId from Bookie Network Address (#2397)\n\nThis is the design document of \"BP-41 Separate BookieId from Bookie Network Address\"\r\n\r\nMaster Issue: #2396 \r\n","Date":"Thu Aug 13 05:32:54 CEST 2020"},{"Commit-ID":"commit b5dab76ca8dfbfe0a163662479eb27763c9354e7 1597307546 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Thu Aug 13 10:32:26 2020 +0200]","Body":"Issue #2385: NullPointerException in Zookeeper multiple operations execution with 3.6.1\n\nFix for #2385\r\n\r\nNow we avoid to send out multiple operations request to ZooKeeper when there are not operations to execute\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2390 from nicoloboschi/fix/2385/zk-npe, closes #2385","Date":"Thu Aug 13 10:32:26 CEST 2020"},{"Commit-ID":"commit 1df0833a948dc7158f6b839eb61d6c1b1bc3d866 1597307637 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Thu Aug 13 10:33:57 2020 +0200]","Body":"Issue #2197: bkctl binary distribution needs a 'logs' directory\n\nFix #2197\r\n\r\nCreate \"logs\" directory before run bkctl cli\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2389 from nicoloboschi/fix/2197/bkclt-logs, closes #2197","Date":"Thu Aug 13 10:33:57 CEST 2020"},{"Commit-ID":"commit 98c0fe706aa380448cfde3aa6b57f0554820f381 1597307764 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Thu Aug 13 10:36:04 2020 +0200]","Body":"Fix site 'responsbility' typo\n\n### Motivation\r\n\r\nFound 'responsbility' typo\n\nReviewers: Sijie Guo <None>\n\nThis closes #2392 from nicoloboschi/fix-doc-typo","Date":"Thu Aug 13 10:36:04 CEST 2020"},{"Commit-ID":"commit 43fab261c632a0f430579ecc05d6143763523168 1597307903 -----sp","Author":"PersonIdent[maoling, maoling199210191@sina.com, Thu Aug 13 16:38:23 2020 +0800]","Body":"The latency of BenchThroughputLatency may be wrong due to Integer overflow when we do a large scale benchmark test\n\n- When` latency.size` is  is more than `20,000,000`(e.g, `25000000`),\r\n`(size * percentile) / 100` will be a negative number due to Integer overflow and the latency will be wrong.\r\n- For example: `size `= 25000000, `percentile `= 99, `sampleSize `= -18199672\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2381 from maoling/BenchThroughputLatency-latency-wrong","Date":"Thu Aug 13 10:38:23 CEST 2020"},{"Commit-ID":"commit d1dac6b9f34ca7e27698914c1c336770d3743333 1597307984 -----sp","Author":"PersonIdent[Rudy Steiner, rudy_steiner@163.com, Thu Aug 13 16:39:44 2020 +0800]","Body":"NP check for print BookieSocketAddress and a better format\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\nNP check for print BookieSocketAddress and a better format to fix issues #2376 and #2371\r\n\r\n### Changes\r\n* NP check for print BookieSocketAddress on listbookies command\r\n* A better format mentioned on #2376 \r\n\r\nMaster Issue: #2376 #2371 \r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>, Rajan Dhabalia <rdhabalia@apache.org>\n\nThis closes #2380 from rudy2steiner/list_bookie","Date":"Thu Aug 13 10:39:44 CEST 2020"},{"Commit-ID":"commit 62f3cd0e60bb5f9e17442512914fa88447932d43 1597308137 -----sp","Author":"PersonIdent[Rudy Steiner, rudy_steiner@163.com, Thu Aug 13 16:42:17 2020 +0800]","Body":"Active ledgers on entry log file\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nFor troubleshooting bookkeeper disk usage issues, having a tool to list the ledgers that are still alive in the entry log file is super useful.\r\n\r\n### Changes\r\n  * Add ListActiveLedgerCommand on BookieShell\r\n\r\nMaster Issue: #2358 \r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2369 from rudy2steiner/active_ledger_command","Date":"Thu Aug 13 10:42:17 CEST 2020"},{"Commit-ID":"commit 7645cb839761b9dde6462c28a87a0d1c428bf5fa 1597308228 -----sp","Author":"PersonIdent[hangc0276, hangc0276@163.com, Thu Aug 13 16:43:48 2020 +0800]","Body":"Bookie Client add quarantine ratio when error count exceed threshold\n\n### Motivation\r\nWhen bookie client read/write data from/to bookie servers, it will check the health of each connected server in sepecific interval. Once the amount of errors reached the threshold, the bookie server will be quarantined for server miniutes (configurated by `bookieQuarantineTimeSeconds`) by the bookie client.\r\n\r\nIn most circumstance, there are large amount of bookie clients connected to one bookie server, like pulsar broker. Once the bookie server runs in heavy load, most of bookie clients will receive errors and trigger quarantine in the same time, and then quarantine the server for several miniutes. After a few miniutes passed by, the quarantined server will be put back in the same time for most bookie clients, which will lead to periodic oscillation of in/out throughput of the server. It is the obstacle of tunning the throughput of the bookkeeper cluster.\r\n\r\n### Changes\r\nI introduce a quarantine probability to determine whether to quarantine the server for the client, avoiding quaraninte the heavy load server in the same time for most of bookie client.\r\n\r\nI also expose the quarantine stats to prometheus.\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Sijie Guo <None>\n\nThis closes #2327 from hangc0276/bookieClient_Quarantine_ratio","Date":"Thu Aug 13 10:43:48 CEST 2020"},{"Commit-ID":"commit af13a89c9cc3a90e0da361c9488a1cceb19506f8 1597473258 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Sat Aug 15 08:34:18 2020 +0200]","Body":"Issue 2399 Move CI builds to ci-hadoop.apache.org\n- rename self job seed configuration in order to disable it temporary\n","Date":"Sat Aug 15 08:34:18 CEST 2020"},{"Commit-ID":"commit a0d49fcb65a40b2b49fbfb6c50f60c7a9f66f67f 1598485588 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Aug 26 16:46:28 2020 -0700]","Body":"Trigger flush if write cache is full while waiting (#2402)\n\nUnder heavy load, the write cache can fill up faster than it can be\r\nflushed. When this occurs, something needs to trigger the\r\nflush. Previously we've triggered the flush and then gone into a loop\r\nwaiting to be able to add to the write cache. However, if the\r\ncurrently active write cache fills while we are waiting for the\r\nflushing write cache to be flushed, we can end up in a situation where\r\nnothing is able to flush because all I/O threads are waiting for the\r\nwrite cache to empty.\r\n\r\nThe solution is to move the flush into the loop so that if we fail to\r\nadd to the cache, we flush the write cache if it is needed.\r\n\r\nCo-authored-by: Ivan Kelly <ikelly@splunk.com>","Date":"Thu Aug 27 01:46:28 CEST 2020"},{"Commit-ID":"commit 057f85ec1b977379938350f12d7ec99ff1162f29 1599462476 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Mon Sep 7 09:07:56 2020 +0200]","Body":"BP-41 BookieId - client side implementation (#2404)\n\n### Motivation\r\n\r\nThis is the client side implementation of BP-41, see the design doc here\r\nhttps://github.com/apache/bookkeeper/blob/master/site/bps/BP-41-bookieid.md\r\n\r\n### Changes\r\n\r\n- Introduce BookeId concept\r\n- Separated BookieId from BookieSocketAddress\r\n- in LedgerMetadata we use now BookieId and not BookieSocketAddress\r\n- a BookieId is basically a wrapper around a string\r\n- BookieId is compatible with BookieSocketAddress\r\n- In order to *resolve\" a BookieId to a BookieSocketAddress we use a BookieAddressResolver\r\n- the DefaultBookieAddressResolver implementation uses BookieServiceInfo metadata, read from ZooKeeper in order to discover the current network address of the Bookie (see BP-38)\r\n\r\nUnfortunately the patch is huge due to the changes in the client API and LedgerMetadata. This patch tries to be the smallest set of changes, see #2396 for the list of the follow up patches that will be contributed.\r\n\r\nNotes:\r\n- The new client and the bookie is 100% compatible with previous Bookies and Clients (and integration tests were not touched)\r\n- We are going to introduce, in a follow up patch, a flag to not use the metadata on ZooKeeper for the resolution of the BookieSocketAddress, in order to save resources\r\n- The ability to configure a custom BookieId, different from the network address will come in a separate patch\r\n\r\n\r\n\r\nMaster Issue: #2396 \r\n\r\nCo-authored-by: Enrico Olivelli <eolivelli@apache.org>\r\nCo-authored-by: Enrico Olivelli <enrico.olivelli@diennea.com>","Date":"Mon Sep 07 09:07:56 CEST 2020"},{"Commit-ID":"commit e827859b897cedbfeaaa167277e57614b399957e 1599760640 -----sp","Author":"PersonIdent[冉小龙, rxl@apache.org, Fri Sep 11 01:57:20 2020 +0800]","Body":"Upgrade the `vertx` version to 3.5.3\n\nSigned-off-by: xiaolong.ran <rxlapache.org>\r\n\r\n### Motivation\r\n\r\nAs the https://github.com/apache/pulsar/issues/7931 said, CVE-2018-12540 has been raised on vertx 3.4.1 which is found in the pulsar dependencies. \r\n\r\n### Changes\r\n\r\n- Upgrade the vertx version from 3.4.1 to 3.5.3\r\n- Update license files\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2410 from wolfstudy/xiaolong/upgrade-vertx-version","Date":"Thu Sep 10 19:57:20 CEST 2020"},{"Commit-ID":"commit fff74dbbc3132a9e854a128d3174371e5a6fd8b0 1599800362 -----sp","Author":"PersonIdent[WJL3333, wjl_is_213@163.com, Fri Sep 11 12:59:22 2020 +0800]","Body":"fix maven-javadoc-plugin configuration.\n\nDescriptions of the changes in this PR:\r\n\r\nchange the doclint configuration in pom.xml \r\n\r\n\r\n\r\n### Motivation\r\n\r\nwhen you clone the project there is always warning in IntelliJ IDEA\r\n\r\n### Changes\r\n\r\nchange the doclint configuration in pom.xml  according to https://stackoverflow.com/questions/52547306/maven-javadoc-plugin-not-accepting-additionalparam-xdoclintnone-additionalpa\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2409 from WJL3333/fix_maven_pom_doclint_config","Date":"Fri Sep 11 06:59:22 CEST 2020"},{"Commit-ID":"commit 7850554a8349cedf1d9236a242e2f7739b471bc9 1599800506 -----sp","Author":"PersonIdent[odidev, odidev@puresoftware.com, Fri Sep 11 10:31:46 2020 +0530]","Body":"Updated netty,netty-boringssl and rocksdb\n\n### Descriptions of the changes in this PR:\r\n\r\n-Updated netty,netty-boringssl and rocksdb to latest version for aarch64 support\r\n-Updated deprecated methods of rocksdb to remove compilation warning and resolve build failure of bookkeeper-server on amd64 and aarch64 platforms as Werror flag is enabled.\r\n\r\n### Motivation\r\nBuild of the bookkeeper-server package was failing on amd64 and aarch64 platforms.\r\n\r\n### Changes\r\nThere are many methods that are marked deprecated in rocksdb, but in use by bookkeeper package.\r\nSo updated those methods in bookkeeper package according to current rocksdb implementation.\r\nAlso updated netty,netty-boringssl and rocksdb to latest version as they are having aarch64 support.\r\n\r\nMaster Issue: #2378 \r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2379 from odidev/bookkeeper_aarch","Date":"Fri Sep 11 07:01:46 CEST 2020"},{"Commit-ID":"commit a432865dd6e9d5096b0ec0c1ac8cd5862068a366 1600515123 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Sat Sep 19 13:32:03 2020 +0200]","Body":"BP-41 make bookieId configurable (#2412)\n\n### Motivation\r\nThis is the bookie side implementation of BP-41\r\n\r\n### Changes\r\n- add new `bookieId` configuration option\r\n- implement Bookie#getBookieId\r\n- add test cases\r\n- make all BookKeeperClusterTestCase to use a random UUID as bookieId in order to increase code coverage\r\n- add useUUIDasBookieId flag to BookKeeperClusterTestCase for test cases that require using hostname:port\r\n- add a default BookieServiceInfo provider in tests\r\n- enable Auditor to use BookieId and not BookieSocketAddress.toBookieId()\r\n- use BookieId for LocalTransport addresses\r\n- in Cookie.java rename BookieHost to BookieId (only in Java code, no data format changes)\r\n\r\nMaster Issue: #2396\r\n\r\nCo-authored-by: Enrico Olivelli <enrico.olivelli@diennea.com>\r\n","Date":"Sat Sep 19 13:32:03 CEST 2020"},{"Commit-ID":"commit 8502c2e461f58162a3e498f093a49d4e2eb253f3 1600681498 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Mon Sep 21 11:44:58 2020 +0200]","Body":"Spammy log when one bookie of ensemble is down #2285\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\nResolves #2285\r\n\r\n### Changes\r\n\r\nWe write \"bookie server unavailable log\" every 30 seconds per bookie client\n\nReviewers: Enrico Olivelli <eolivelli@apache.org, Sijie Guo  <sijie@apache.org>\n\nThis closes #2393 from nicoloboschi/fix/2285/spammy-logs, closes #2285","Date":"Mon Sep 21 11:44:58 CEST 2020"},{"Commit-ID":"commit ddfeaf9a11fc82cb3b1225a5754285435f2f7fab 1600698868 -----sp","Author":"PersonIdent[gaoxinge, xg.gao@tianrang-inc.com, Mon Sep 21 22:34:28 2020 +0800]","Body":"Fix potential NullPointerException when local book keeper stop on exit\n\nDescriptions of the changes in this PR: \r\n\r\n- Fix potential NullPointerException when local book keeper stop on exit.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2414 from gaoxinge/fix","Date":"Mon Sep 21 16:34:28 CEST 2020"},{"Commit-ID":"commit 2c3d8f55895890e73b58a43e337f7ff9ac140675 1601102775 -----sp","Author":"PersonIdent[WJL3333, wjl_is_213@163.com, Sat Sep 26 14:46:15 2020 +0800]","Body":"fix doc (#2419)\n\nthe web site rendering error in section reference/cli/ updateBookieInLedger Options","Date":"Sat Sep 26 08:46:15 CEST 2020"},{"Commit-ID":"commit 67a02db73d62188fc8a143bd9a37038ae770e90a 1601974145 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Tue Oct 6 10:49:05 2020 +0200]","Body":"Update Copyright year to 2020 in NOTICE files\n\nChanges:\r\n- update Copyright reference year to 2020 in main NOTICE file and in templates for the binary distributions\n\nReviewers: Nicolò Boschi <boschi1997@gmail.com>, Flavio Junqueira <fpj@apache.org>, Alessandro Luccaroni <luccaronia@gmail.com>, Rajan Dhabalia <rdhabalia@apache.org>\n\nThis closes #2428 from eolivelli/fix/update-year-notice","Date":"Tue Oct 06 10:49:05 CEST 2020"},{"Commit-ID":"commit b7814804fc081c6ca72094c5659739f074cf8be9 1601974395 -----sp","Author":"PersonIdent[Anup Ghatage, ghatageanup@gmail.com, Tue Oct 6 01:53:15 2020 -0700]","Body":"New Bookkeeper docusaurus based website\n\nThe Apache Bookkeeper website is a custom built website. While that is cool, its also additional maintenance for the PMC/Committers.\r\nsijie suggested that we can follow the same path as the Pulsar project and have a docusaurus based website which  uses markdown heavily and is easier to manage and update.\r\n\r\nThis is a a WIP and this draft PR is to keep the PMC/Committers updated about the progress on the website.\r\n\r\nThe goal of this PR is to be able to create a basic skeleton of the website with the following pages (and their sub pages) fully fleshed out:\r\n* Project\r\n* Community\r\n* Blog\r\n* Landing page\r\n\r\nSo with this, the only thing that remains is the rest of the versioned documentation.\r\nThat work can be done in smaller modules as follow ups.\r\nThis PR will be opened for review and then can be merged once the above mentioned pages are declared to be complete.\r\n\r\ncc eolivelli \n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2426 from Ghatage/docusaurus-website-poc","Date":"Tue Oct 06 10:53:15 CEST 2020"},{"Commit-ID":"commit 1ab76145b82d4615592ee4bae1667d7676495a55 1602130540 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Thu Oct 8 06:15:40 2020 +0200]","Body":"Do not hide Maven log in github actions\n\nSet log level to INFO.\r\n\r\nfpj noticed that sometimes Maven build fails but the action completes successfully\n\nReviewers: Sijie Guo <None>\n\nThis closes #2430 from eolivelli/fix/info-github-actions","Date":"Thu Oct 08 06:15:40 CEST 2020"},{"Commit-ID":"commit 3a8f4b4d3e762ac24a0563eeaffd068efaab2b81 1602130944 -----sp","Author":"PersonIdent[Anup Ghatage, ghatageanup@gmail.com, Wed Oct 7 21:22:24 2020 -0700]","Body":"Certificate role based authorization in Apache Bookkeeper. (#2429)\n\nThis feature allows a predefined set of services to be 'whitelisted' to be able to access bookkeeper based on their client certificates. _This feature is disabled by default._\r\n\r\n\r\n**Motivation**\r\nAs BookKeeper and its supported services move to a cloud friendly service based architecture, it becomes of utmost importance to monitor and allow only certain qualified services to be able to access the data in BK.\r\nWe have TLS based authentication, however, any service with the rootCA can access Bookkeeper clusters which is not desirable.\r\n\r\n**Changes**\r\n\r\nTo enable if, we have to set 2 configuration options in server config.\r\n\r\n1. Set `bookieAuthProviderFactoryClass` config option to use BookieAuthZFactory\r\n`bookieAuthProviderFactoryClass=org.apache.bookkeeper.tls.BookieAuthZFactory`\r\n\r\n2. Set `authorizedRoles` to a comma separated list of roles present in client certificates' OU field.\r\n`authorizedRoles=pulsar-broker-1,pulsar-broker-2`\r\n\r\nRead further for details on how to implement these in your client certificates and how to wire it up.\r\n\r\nSo this feature can be broken down into two parts:\r\n\r\n    Certificate and roles\r\n    Server configuration for authorized roles\r\n\r\n**Details:**\r\n_Certificate and roles:_\r\nHere is an example of how the SUBJECT field of a final certificate for Apache Pulsar running in the cloud would look like:\r\n\r\n    CN=apache.bookkeeper.org\r\n    O=apache-pulsar\r\n    OU=0:pulsar-broker-role;1:cluster-1\r\n    L=San Francisco\r\n    S=CA\r\n    C=US\r\n\r\nThis shows that this bookkeeper client certificate is owned by the apache pulsar service has the role \u2018pulsar-broker-role\u2019 for entities in \u2018cluster-1\u2019.\r\nOnly those services with pulsar-broker-role should be able to access it.\r\nWe can add more fields separated by commas to increase the upstream application clusters to be able to access this bookkeeper cluster.\r\n\r\nFor example: `OU=0:herddb-readonlyNode,herddb-readwriteNode;1:herddb-cluster2`\r\n\r\nSuch separation of access based on services is paramount to keeping this secure as many upstream users of BookKeeper are financial institutions, databases and other services.\r\n\r\n_Server configuration for authorized roles_\r\nOnce we have a certificate whose SUBJECT field has the OU attribute with the roles we want to authorize, on the Bookie side, we need to specify which roles are allowed.\r\nWe make this happen by introducing a server configuration option called `authorizedRoles`.\r\nSince we have only static options, this will be set in stone as long as the bookie booted up with it.\r\nIf in case we need to change the allowed roles, we\u2019ll need to stop the bookie, update the configuration file and then restart the bookie.\r\nWe can have multiple roles which are authorized as the OU field can have multiple comma separated values for roles.\r\n\r\nThis is a redo of stale PR #2355 \r\n\r\nMaster Issue: #2354","Date":"Thu Oct 08 06:22:24 CEST 2020"},{"Commit-ID":"commit a68c3d661dbf9f7523939ecd4016209288bb5496 1602131260 -----sp","Author":"PersonIdent[张哈希, zhxhash@vip.sina.com, Thu Oct 8 04:27:40 2020 +0000]","Body":"fix #2416 bookie format redundant clean ledgerDirs and indexDirs (#2417)\n\nbookie format redundant clean ledgerDirs and indexDirs","Date":"Thu Oct 08 06:27:40 CEST 2020"},{"Commit-ID":"commit b316950080fee9590422907f9833f1d31427a5a2 1602131313 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Thu Oct 8 06:28:33 2020 +0200]","Body":"Create a Jenkinsfile to configure new ASF CI env\n\n- create a Jenkinsfile configuration\r\n- the file is copied from Andor Molnar's work on Apache ZooKeeper project\r\n\r\nThis will run the tests on JDK8 and JDK11 for every active branch on the repository\n\nReviewers: Sijie Guo <None>\n\nThis closes #2407 from eolivelli/fix/jenkinsfile","Date":"Thu Oct 08 06:28:33 CEST 2020"},{"Commit-ID":"commit 9427c8b8f89539e4098771f1367b6e8910fdb336 1602131385 -----sp","Author":"PersonIdent[Tboy, guo.jiwei@immomo.com, Thu Oct 8 12:29:45 2020 +0800]","Body":"ISSUE #2425: Typo for method name\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nRename the method name:\r\n```\r\nPerChannelBookieClientPool#initialize\r\nLedgerHandle#isWriteSetWritable\r\n```\r\nAnd some typos.\r\n\r\n\n\nReviewers: Matteo Minardi <minardi.matteo@hotmail.it>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2427 from Technoboy-/issue-2425, closes #2425","Date":"Thu Oct 08 06:29:45 CEST 2020"},{"Commit-ID":"commit 41412bc647f94d6e13d8dde6daa3081c010d0806 1602257864 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Fri Oct 9 17:37:44 2020 +0200]","Body":"BP-42: new api list ledgers\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\n\r\nThe new Client API (org.apache.bookkeeper.client.api.BookKeeper) aims to replace obsolete BookKeeper API but some features are not implemented yet, like the functionalities provided by BookKeeperAdmin.\r\nFor example, it does not expose a method to list available ledgers, comparable to BookKeeperAdmin#listLedgers().\r\nlow.\r\n\r\n### Changes\r\n\r\n- Ledgers listing\r\n- Simpler access to LedgerMetadata\r\n- Ledger id inside LedgerMetadata\r\n\r\nMaster Issue: #2422\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2423 from nicoloboschi/bp42-new-api-list-ledgers","Date":"Fri Oct 09 17:37:44 CEST 2020"},{"Commit-ID":"commit d3af27e202716815d2fc1fd8607853c902653788 1602686133 -----sp","Author":"PersonIdent[ca-simone-chiorazzo, 44833596+ca-simone-chiorazzo@users.noreply.github.com, Wed Oct 14 16:35:33 2020 +0200]","Body":"ISSUE #2377: Relax grpcio requirement for python client to support python3.8 on mac os\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\nRequire a grpcio version that is minor of 1.28. This allow to install the 1.27.2 that has a pre-compiled wheel for python 3.8 on mac os.\r\nAdd tests for python 3.8\r\n\r\n\r\n### Motivation\r\n\r\ngrpcio 1.25.0 does not allow the installation using python 3.8 on mac os x. This is due to the fact that the pre-compiled wheels have not been published before 1.26.0\r\n\r\n### Changes\r\n\r\n\r\nUpdated the setup.py to relax a bit the requirement for grpcio\r\nAdd python3.8 as tested version\r\nUpdated the setup.py to install the latest pymmh3 version. **Note**: master tests are broken, I've updated the library and removed the 'signed' parameter that does not exists not anymore.\r\n\r\nMaster Issue: #<master-issue-number>\r\n\r\ncc eolivelli \r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2432 from ca-simone-chiorazzo/bugfix/2377-relax-grpcio-python-dep-for-python-3.8-on-mac-os, closes #2377","Date":"Wed Oct 14 16:35:33 CEST 2020"},{"Commit-ID":"commit 83dec6e26e9b5ed249c613abc3d65c9e20c6e535 1602860374 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Fri Oct 16 16:59:34 2020 +0200]","Body":"Update to OpenJDK11 in Docker image\n\nDescriptions of the changes in this PR:\r\n- Update \"master\" docker image to BK 4.11.0\r\n- Update to OpenJDK11 the main Docker image and the Docker image used for integration tests\r\n- We are not using \"JRE\" because it does not bundle jshell and our script detects the presence of JDK11+ from the presence of file \"jshell\"\r\n\r\nMaster Issue: #2387\r\n\n\nReviewers: Ravi Sharda <None>, Jia Zhai <zhaijia@apache.org>\n\nThis closes #2433 from eolivelli/fix/test-jdk11-upgrade-docker","Date":"Fri Oct 16 16:59:34 CEST 2020"},{"Commit-ID":"commit b95c753a87a97114012e0af2b11972c3df01d48d 1602861352 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Fri Oct 16 17:15:52 2020 +0200]","Body":"Detect Java 11 JRE and not only JDK\n\n- Use 'lib/modules' in order to detect a modern JDK\r\n- With this change we can detect both JDK and JRE\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Anup Ghatage <None>, Nicolò Boschi <boschi1997@gmail.com>\n\nThis closes #2436 from eolivelli/fix/support-jdk11-jre","Date":"Fri Oct 16 17:15:52 CEST 2020"},{"Commit-ID":"commit b004bc3b1c012ec23381ec400aaa23136268eca7 1603109729 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Mon Oct 19 14:15:29 2020 +0200]","Body":"Issue 2445: Builds of Docker tag bookkeeper:latest are failing (#2446)\n\nFixes #2445 by not overriding BK_VERSION variable in case of \"latest\" tag\r\n\r\n\r\nCo-authored-by: Enrico Olivelli <enrico.olivelli@diennea.com>","Date":"Mon Oct 19 14:15:29 CEST 2020"},{"Commit-ID":"commit 01214aa6d02ce55e4d20f47179b5e53c32617e85 1603175675 -----sp","Author":"PersonIdent[Enrico Olivelli, enrico.olivelli@diennea.com, Tue Oct 20 08:34:35 2020 +0200]","Body":"Issue 2445: Builds of Docker tag bookkeeper:latest are failing (#2446)\n","Date":"Tue Oct 20 08:34:35 CEST 2020"},{"Commit-ID":"commit 6deb7f495a9111d5720e72dbc19a52ecbfd2557b 1603204591 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Tue Oct 20 16:36:31 2020 +0200]","Body":"BP-41 Bookie Address changes tracking\n\n- Allow the client to follow Bookie Address Changes\r\n- If a Bookie changes network address the clients will be able to connect to the new addresess\r\n- In order to leverage the most of this feature the Bookie must configure a fixed bookieId (see BP-41) \r\n- add flag enableBookieAddressTracking to enable/disable this feature, as it needs a ZK watch for every active bookie in the cluster and if you have a static cluster there is no need to invalidate the local cache and issue more ZK requests\r\n- handle ZK session expiration events, when the ZK client is not receiving watch notifications it could miss bookie address changes, so we have to eagerly flush the whole local cache of bookie addresses\r\n\r\n\r\nThis is part of BP-41\r\nMaster ticket #2396\r\n\n\nReviewers: Nicolò Boschi <boschi1997@gmail.com>, Anup Ghatage <ghatage@apache.org>\n\nThis closes #2435 from eolivelli/fix/bp41-client-discovery-cache","Date":"Tue Oct 20 16:36:31 CEST 2020"},{"Commit-ID":"commit d806c222235271ea381e2be9e19fba9df9257c5b 1603295279 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Wed Oct 21 17:47:59 2020 +0200]","Body":"Fix JAVA_HOME in Dockerimage and allow it to be overwritten\n\n- Fix Java 11 Path in Dockerfile\r\n- Allow to overwrite JAVA_HOME in entrypoint.sh and healthcheck.sh\n\nReviewers: Ravi Sharda <None>\n\nThis closes #2449 from eolivelli/fix/docker-image-jdk11-2","Date":"Wed Oct 21 17:47:59 CEST 2020"},{"Commit-ID":"commit ba42e6fe376d29b959eb002e76aa7b704ed47e4b 1603295945 -----sp","Author":"PersonIdent[Abhey Rana, abhey.mnnit@gmail.com, Wed Oct 21 21:29:05 2020 +0530]","Body":"ISSUE #2443: Complete community page in the new docusaurus website\n\nDescriptions of the changes in this PR:\r\n\r\nThis PR introduces changes to complete the community page of the new up-coming docusaurus based website.\r\n\r\n### Motivation\r\n\r\nThe #2426 Pull Request introduced the changes for new docuasurus based website, However few of the pages like community and project were incomplete. This PR introduces the changes to complete the community page.\r\n\r\n### Changes\r\n\r\nI have added the markdown files for the following web-pages - \r\n* bookkeeper-proposals\r\n* coding-guide\r\n* community-meetings\r\n* contributing\r\n* issue-report-guide\r\n* mailing-lists\r\n* papers-and-presentations\r\n* release-guide\r\n* release-management\r\n* testing-guide\r\n\r\nI have also updated the code in community.js to refactor the way tables for PMC and committers is getting generated, So that we get the best out of the react based framework.\r\n\r\n### Testing Details - \r\n\r\nI have build the changes locally and have verified that all the links are rendering properly or not. Here is the screenshot of the new community web-page.\r\n\r\n![Screenshot 2020-10-19 at 18 36 34](https://user-images.githubusercontent.com/17764661/96454852-11be0100-123a-11eb-8a8f-ca49ec663d7b.png)\r\n\r\n\r\nMaster Issue: #2443 \r\n\n\nReviewers: Anup Ghatage <ghatage@apache.org>\n\nThis closes #2447 from Abhey/Issue-2443, closes #2443","Date":"Wed Oct 21 17:59:05 CEST 2020"},{"Commit-ID":"commit 17baf76cb8ac61f1db0cfd36ce0b63787cbefaea 1603324031 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Thu Oct 22 01:47:11 2020 +0200]","Body":"Update website after 4.11.1 release:\n\n- fix BP page\r\n- fix versions list\r\n- fix download page and releases history\r\n- add script to publish the website manually\r\n- tagged as \"stable\" 4.10.0\r\n- tagged as EOL every release < 4.9.2\r\n- removed stale information about next releases (if we do not have a real plan it is better to not write stale information)\r\n- merge BK 4.11.1 release notes\r\n\r\nthe procedure to publish the new website manually is:\r\n- git clone https://github.com/apache/bookkeeper\r\n- cd bookkeeper/site\r\n- docker/ci.sh\r\n- scripts/publish-website-manually.sh\r\n\r\n\r\n\r\n\n\nReviewers: Anup Ghatage <ghatage@apache.org>, Nicolò Boschi <boschi1997@gmail.com>\n\nThis closes #2448 from eolivelli/fix/update-website-after-4.11.1-release","Date":"Thu Oct 22 01:47:11 CEST 2020"},{"Commit-ID":"commit 51bfd221f8e35c7a69a35286a8988e0dd01ac11b 1603432450 -----sp","Author":"PersonIdent[Anup Ghatage, ghatage@apache.org, Thu Oct 22 22:54:10 2020 -0700]","Body":"ISSUE #2170: Cleaned up error message for NoNodeException for lostBook\u2026\n\n\u2026ieRecoveryDelay when Auditor is not initialized.\r\n\r\n### Motivation\r\n\r\nIf Auditor has not been initialized, running `lostBookieRecoveryDelay` from bookie shell will result in a stack trace and `NoNodeException`.\r\n\r\n### Changes\r\n\r\nAdded a catch clause which:\r\n* Cleans up stack trace\r\n* Explains that the Auditor is not up yet, which means the znode for `lostbookierecoverydelay` has not been created yet.\r\n* Prints exception\r\n\r\nMaster Issue: #2170 \r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2452 from Ghatage/BOOKEEPER-2170, closes #2170","Date":"Fri Oct 23 07:54:10 CEST 2020"},{"Commit-ID":"commit b1e602afc93cfd6299c43f99d26c9a6b7bcd27a7 1603807121 -----sp","Author":"PersonIdent[Anup Ghatage, ghatage@apache.org, Tue Oct 27 06:58:41 2020 -0700]","Body":"BP-40: Convert all System.*.print statements to LOG.* statements\n\n### Motivation\r\n\r\nIn order to have an audit log of all user interactions, all print statements which come from such interactions need to be logged.\r\nWe have two user driven ways to mutate BookKeeper:\r\n* BookieShell\r\n* bkctl\r\nBoth internally use the same code from `tools/cli`\r\n\r\n### Changes\r\n\r\nThe logging in the code was inconsistent. At times we used `System.out.println` and at times we used `LOG.info`.\r\nAs a part of this work item we change these in the following way:\r\n\r\n* For every `cli` class, confirm if a Logger object is present, if not create one.\r\n* Convert all `System.out.println()` -> `LOG.info()`\r\n* Convert all `System.err.println()` -> `LOG.error()`\r\n\r\n### Ramifications\r\n\r\nBookieShell uses `log4j.shell.properties`\r\nbkctl uses `log4j.cli.properties`\r\n\r\nBoth log4j property files have `CONSOLE appenders`, so the like previous `System.out.println()`, the new `LOG` statements will also be printed to console.\r\nThis is mentioned explicitly as certain upstream consumers / scripts utilize BookieShell / bkctl to assess the state of the BK cluster.\r\n\r\nMaster Issue: #2209 \r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2455 from Ghatage/BP-40/auditLogging","Date":"Tue Oct 27 14:58:41 CET 2020"},{"Commit-ID":"commit 613af7c8568f7b56c36de8b67ff1ff8eadf492d3 1603814512 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Tue Oct 27 17:01:52 2020 +0100]","Body":"BP-41 Cleanup tools logs\n\n### Motivation\r\n\r\nBP-41 introduces the new bookieId concept, and tools have to be improvement in order to provide better user experience.\r\n\r\n### Changes\r\n\r\n- Fix NPE while shutting down the ZKRegistration client no function impact)\r\n- Clean up logs in general\r\n- Print \"bookieId\" instead of Bookie Address in \"bin/bkctl bookies list\" command\r\n- Print bookieId at Bookie startup (using standard scripts)\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Anup Ghatage <ghatage@apache.org>\n\nThis closes #2453 from eolivelli/fix/bp41-tools1","Date":"Tue Oct 27 17:01:52 CET 2020"},{"Commit-ID":"commit 651318aa3c057bc334b491a945f57f040799fd9c 1603917422 -----sp","Author":"PersonIdent[Lari Hotari, lhotari@users.noreply.github.com, Wed Oct 28 22:37:02 2020 +0200]","Body":"Make protoc-gen-grpc-java.version match grpc.version\n\n### Motivation\r\n\r\nprotoc-gen-grpc-java is part of grpc libraries.\r\nUsually it doesn't make sense to use a version other\r\nthan the current grpc version. Currently 2 different versions are used.\r\n\r\nIt seems that it has been forgotten to upgrade protoc-gen-grpc-java.version \r\nwhen grpc.version has been upgraded from 1.12.0 to 1.18.0\r\n\r\n### Changes\r\n\r\nMake protoc-gen-grpc-java.version match grpc.version by referencing it with ${grpc.version}\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2465 from lhotari/lh-protoc-gen-grpc-java-version","Date":"Wed Oct 28 21:37:02 CET 2020"},{"Commit-ID":"commit d8683b09d6452c08923941391a5926dca4080194 1603917752 -----sp","Author":"PersonIdent[Lari Hotari, lhotari@users.noreply.github.com, Wed Oct 28 22:42:32 2020 +0200]","Body":"[BUILD] Use Cancel workflow action to cancel outdated PR build jobs\n\n### Motivation\r\n\r\nCurrently a single user can cause the Github Actions / Workflows based CI to get overloaded when commits are pushed to a PR branch frequently, one by one. To mitigate this issue, cancel any previous Github Actions runs that are not completed for a given workflow,  for a particular branch / PR. This can be achieved by using the https://github.com/marketplace/actions/cancel-workflow-action .\r\n[There are multiple cancel actions available](https://github.community/t/github-actions-cancel-redundant-builds-not-solved/16025/22). This particular one was picked based on its popularity.\r\n\r\n### Modifications\r\n\r\nAppend each workflow with the cancel workflow action step.\r\n\r\nA similar change was made in Pulsar CI in PR https://github.com/apache/pulsar/pull/8393\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Anup Ghatage <ghatage@apache.org>\n\nThis closes #2464 from lhotari/lh-cancel-previous-build","Date":"Wed Oct 28 21:42:32 CET 2020"},{"Commit-ID":"commit 71f8e160b2e8cd16cb18bc186fcd67887150403e 1603937759 -----sp","Author":"PersonIdent[Tboy, guo.jiwei@immomo.com, Thu Oct 29 10:15:59 2020 +0800]","Body":"ISSUE #2454: Typo of naming LedgerStorage#setExplicitlac\n\nFix #2454 .\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2456 from Technoboy-/issue-2454, closes #2454","Date":"Thu Oct 29 03:15:59 CET 2020"},{"Commit-ID":"commit 0c841862b547374541815d9dd9dfb4488b49ab44 1603967316 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Thu Oct 29 11:28:36 2020 +0100]","Body":"BP-42: New Client API - list ledgers\n\nImplementation of BP-42\r\n\r\n### Motivation\r\nEnhance new client API, added methods for\r\n- listing ledgers\r\n- access to ledger metadata\r\n\r\n### Changes\r\n\r\n- Added new interfaces in \"api\" client package for ledgers listing\r\n- Added new method `getLedgerMetadata(long ledgerId)` to BookKeeper interface\r\n- Added `getLedgerId()` to LedgerMetadata type\r\n-- Ledger metadata ser/deser are not changed since ledgerId is not stored inside ZK data node \r\n\r\nUpdated all tests using `LedgerMetadataBuilder` because ledgerId is now required in order to call `build()` method\r\n\r\nMaster Issue: #2422 \n\nReviewers: Jia Zhai <zhaijia@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2457 from nicoloboschi/fix/2422/bp-42-list-ledgers","Date":"Thu Oct 29 11:28:36 CET 2020"},{"Commit-ID":"commit 66912fda5accae9174b6d0167982197a5094349e 1603967497 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Thu Oct 29 11:31:37 2020 +0100]","Body":"Read ExplicitLAC in asyncReadLastConfirmed - enable ExplicitLAC in new API (#1901)\n\n- Readers will handle explicit LAC transparently\r\n- V2 Readers stay with old PiggyBackLAC\r\n\r\nDescriptions of the changes in this PR:\r\nIn readLastAddConfirmed we are going to call readLac which is an RPC supported from BK 4.5 which returns both the Piggybacked LAC and the Explicit LAC.\r\nThis way readers will be able to advance their view of the LAC even in case of writers which are using ExplicitLAC.\r\n**This change enables users of the new API to leverage ExplicitLAC**\r\n\r\nClient which are using v2 protocol will fallback to Piggybacked LAC as readLAC is not available in v2 protocol.\r\n\r\n### Motivation\r\nThis way new API users will be able to use ExplicitLAC\r\n\r\n### Changes\r\n\r\nCall LedgerHandle#asyncReadExplicitLastConfirmed inside LedgerHandle#asyncReadLastConfirmed in case of non v2 protocol.\r\n\r\n* Read ExplicitLAC in asyncReadLastConfirmed\r\n- Readers will handle explicit LAC transparently\r\n- V2 Readers stay with old PiggyBackLAC\r\n\r\n* fix client mock tests\r\n\r\n* fix checkstyle\r\n\r\n* add test case\r\n\r\n* fix checkstyle\r\n\r\n* fix typo\r\n\r\nCo-authored-by: eolivelli <eolivelli@apache.org>","Date":"Thu Oct 29 11:31:37 CET 2020"},{"Commit-ID":"commit 417f0ea3a14c437a170042463d62d71e7db5e6a6 1604078833 -----sp","Author":"PersonIdent[Masahiro Sakamoto, massakam@yahoo-corp.jp, Sat Oct 31 02:27:13 2020 +0900]","Body":"Upgrade jetty to 9.4.33.v20201020\n\nJetty versions 9.4.32.v20200930 and earlier have a security vulnerability, so upgraded to the latest stable version.\r\nhttps://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-27216\n\nReviewers: Rajan Dhabalia <rdhabalia@apache.org>, Anup Ghatage <ghatage@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Nicolò Boschi <boschi1997@gmail.com>\n\nThis closes #2473 from massakam/upgrade-jetty","Date":"Fri Oct 30 18:27:13 CET 2020"},{"Commit-ID":"commit 4d4465031012a126afcc78dcd3041829fee173d9 1604286798 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Mon Nov 2 04:13:18 2020 +0100]","Body":"Issue 1533: DbLedgerStorage does not persist ExplicitLAC: Information (Header) of TransientLedgerInfo is not persisted (#2474)\n\nMotivation\r\nDbLedgerStorage does not persist \"ExplicitLAC\" on RocksDB, so when you restart a Bookie the information is lost.\r\nThis work can be considered a follow up of @reddycharan work at #1527\r\n\r\nChanges\r\npersist ExplicitLAC on DBLedgerStorage\r\nsave ExplicitLAC on RocksDB (it is an optional field, so this change is backward compatible)\r\nenable testExplicitLACIsPersisted test even for DBLedgerStorage\r\non TransientLedgerInfo rewind the ByteBuf in order to be able to use it again while writing to RocksDB\r\nuse computeIfAbsent in getOrAddLedgerInfo (code clean up, but code looked strange, probably subject to some possible race condition)\r\nMaster Issue: #1533\r\n\r\n\r\n* Issue 1533: DbLedgerStorage does not persist ExplicitLAC: Information (Header) of TransientLedgerInfo is not persisted\r\n\r\n* final fix and fix checkstyle\r\n\r\n* restore tests\r\n\r\nCo-authored-by: Enrico Olivelli <eolivelli@apache.org>","Date":"Mon Nov 02 04:13:18 CET 2020"},{"Commit-ID":"commit c1673bfc140b2a3c2636cfae91c26869e6cf9502 1604301802 -----sp","Author":"PersonIdent[karanmehta93, k.mehta@salesforce.com, Sun Nov 1 23:23:22 2020 -0800]","Body":"Autorecovery may hang indefinitely when zookeeper connection blips\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nIn certain circumstances, all AR processes were running but not performing any replication. Thus ledgers remain under-replicated for periods more than the threshold defined by our monitoring system. The reason is that the latch here gets countdown only under certain condition.\r\n\r\n### Changes\r\n\r\nEnsure that countdown latch is released for any ZK event. Also log the zk event.\r\n\r\nMaster Issue: #2302 \n\nReviewers: Enrico Olivelli <eolivelli@apache.org>, Anup Ghatage <gathage@apache.org>\n\nThis closes #2471 from karanmehta93/ar-zk-bug","Date":"Mon Nov 02 08:23:22 CET 2020"},{"Commit-ID":"commit bbb0113d61d3c4c47079f5924ad00bc433925b63 1604397824 -----sp","Author":"PersonIdent[karanmehta93, k.mehta@salesforce.com, Tue Nov 3 02:03:44 2020 -0800]","Body":"Introduce new retry policy for metadata operations (#2470)\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\nCurrent retry backoff policy is truly exponential, hence retries are spaced out at large intervals. There is maxBackOff time that limits it, but it doesn't have a concept of deadline. Hence, applications with shorter SLA's have issues dealing with ZK failures and recovering from it.\r\n\r\n### Changes\r\n\r\nThe new policy introduces an aggressive retry mechanism with the backoff constants as less exponential. The deadline ensures that we retry at least once at the deadline. The stack trace would indicate the operation at risk.\r\n\r\nThis doesn't update the product code, which is still in testing. I am splitting PR's for for sake of reviews.\r\n\r\n\r\n* Introduce new retry policy for metadata operations\r\n\r\n* Spotbugs error fix","Date":"Tue Nov 03 11:03:44 CET 2020"},{"Commit-ID":"commit 85cd302291784dc8502172303ad3a315a15566f3 1604397945 -----sp","Author":"PersonIdent[karanmehta93, k.mehta@salesforce.com, Tue Nov 3 02:05:45 2020 -0800]","Body":"ZookeeperClient should retry instantly on zk session expiry (#2450)\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nCurrently, we wait for `sessionTimeoutMs` before initiating a new zk cnxn. Session expiry is recevied only\r\nwhen zk quprum is in a healthy state and can acquire a quorum to expire a session.\r\nAll other connection loss retries happen at zk client library transparently.\r\n\r\nThere is not much benefit waiting at BK client level.\r\n\r\n### Changes\r\n\r\nUpdated the values for backoff and maxbackoff to 0 seconds.\r\n\r\n\r\n\r\n* ZookeeperClient should retry instantly on zk session expiry\r\n\r\nCurrently, we wait for `sessionTimeoutMs` before initiating a new zk cnxn. Session expiry is recevied only\r\nwhen zk quprum is in a healthy state and can acquire a quorum to expire a session.\r\nAll other connection loss retries happen at zk client library transparently.\r\n\r\n* Added comments","Date":"Tue Nov 03 11:05:45 CET 2020"},{"Commit-ID":"commit a659cf50fe46cfea801199df559663abad0eeaa5 1604399673 -----sp","Author":"PersonIdent[karanmehta93, k.mehta@salesforce.com, Tue Nov 3 02:34:33 2020 -0800]","Body":"Protobuf should be serialized to direct memory instead of heap memory (#2441)\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nProtobuf serialization is the last step of the netty pipeline. Currently, we allocate a heap buffer while serializing\r\nand pass it down to netty library. In `AbstractChannel#filterOutboundMessage()`, netty copies that data to a direct buffer if\r\nit is currently in heap (otherwise skips it and uses it directly).\r\nThis change helps in reducing unncessary CPU cycles for buffer copies and also helps alleviate pressure off the GC, since there is\r\nless churn of memory. In some stress tests, I see a reduction upto 33% in number of GC's with the same avg running duration in BK Client.\r\nThe workload does writes of different sizes, ranging from 1 KB to 512 KB.\r\nBookies aren't usually CPU bound. This change improves READ_ENTRY code paths by a small factor.\r\n\r\n\r\n### Changes\r\n\r\nUsed direct memory for buffer allocation versus heap memory\r\n\r\n\r\n* Added comments","Date":"Tue Nov 03 11:34:33 CET 2020"},{"Commit-ID":"commit 1c9839f1fb7c12c3d0f6e72c8397e4f404d8c7e0 1604474730 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Wed Nov 4 08:25:30 2020 +0100]","Body":"Fix Default Java Home in apachebookkeeper/bookkeeper-current image (#2476)\n\n### Motivation\r\n\r\nYou can easily build locally a docker image regarding the \"current\" version, that is the code that you have currently on your git repository using these commands:\r\n\r\n```\r\nmvn clean install -DskipTests\r\nmvn install -f tests/docker-images/current-version-image/pom.xml -DintegrationTests\r\n```\r\n\r\n```\r\n # start ZooKeeper server locally\r\ndocker run --network=host zookeeper:latest\r\n```\r\n\r\n```\r\n# start one Bookie\r\ndocker run --network=host --env BK_zkServers=localhost:2181 --env BK_bookieId=bk1 --env BK_allowLoopback=true --env BK_bookiePort=3181 apachebookkeeper/bookkeeper-current\r\n```\r\n\r\nbut in current master, after the first switch to JDK11 the Dockerfile of the \"apachebookkeeper/bookkeeper-current\" is broken and points to a broken path for the JAVA_HOME env entry.\r\n\r\n### Changes\r\nChange the default JAVA_HOME to the good path\r\n\r\nCo-authored-by: Enrico Olivelli <eolivelli@apache.org>","Date":"Wed Nov 04 08:25:30 CET 2020"},{"Commit-ID":"commit 775603ad19174b14eb7144cae15cd4be3956f702 1604474768 -----sp","Author":"PersonIdent[Lari Hotari, lhotari@users.noreply.github.com, Wed Nov 4 09:26:08 2020 +0200]","Body":"Limit maven http connection pool TTL in Github flows (#2460)\n\n### Motivation\r\n\r\nFixes \"Transfer failed for https://repo.maven.apache.org/...\r\n.jar: Connection reset\" type of failures in Github Flows environment such as\r\n```\r\nError:  Failed to execute goal on project bookkeeper-common: Could not resolve dependencies for project org.apache.bookkeeper:bookkeeper-common:jar:4.12.0-SNAPSHOT: Could not transfer artifact org.jctools:jctools-core:jar:2.1.2 from/to central (https://repo.maven.apache.org/maven2): Transfer failed for https://repo.maven.apache.org/maven2/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar: Connection reset -> [Help 1]\r\n```\r\n\r\n### Changes\r\n\r\nSet `maven.wagon.httpconnectionManager.ttlSeconds` to 25 seconds.\r\nBesides this, set `maven.wagon.http.retryHandler.count` to 3 retries.\r\n\r\nhttps://issues.apache.org/jira/browse/WAGON-545\r\ncontains a recommendation \"Azure users shall set the TTL to 240 seconds or less.\"\r\n\r\nThe reason for the 25 second TTL is to ensure that it's shorter than any common\r\nfirewall or NAT timeout. Some NATs have a 30 second idle timeout although\r\nthat is very rare. There shouldn't be harm in using the 25 second TTL since\r\nthe connection pool will be able to pool connections well with a 25 second TTL.\r\n\r\nThe documentation for `maven.wagon.httpconnectionManager.ttlSeconds` is\r\navailable in the source code:\r\nhttps://github.com/apache/maven-wagon/blob/wagon-3.4.1/wagon-providers/wagon-http-shared/src/main/java/org/apache/maven/wagon/shared/http/AbstractHttpClientWagon.java#L297-L305\r\n\r\nDocumentation for `maven.wagon.http.retryHandler.count` is in\r\nhttps://maven.apache.org/wagon/wagon-providers/wagon-http/\r\n\"Any retry handler can only react to exceptions when executing the request and\r\nreceiving the response head. It will not salvage in-flight failures of ongoing\r\nresponse body streams.\" Therefore the retry count setting is a bit\r\ndifferent than expected. WAGON-545 explains that ConnectionExceptions\r\naren't part of the retried exceptions by default. If such issues become\r\nproblems, it's possible to configure the retry handler in a more fine\r\ngrained way.\r\n\r\nThis is similar to the change made in Pulsar: https://github.com/apache/pulsar/pull/8386","Date":"Wed Nov 04 08:26:08 CET 2020"},{"Commit-ID":"commit 9f10dee2b170c12d7c700c2610617fe0cba14ee2 1604488267 -----sp","Author":"PersonIdent[Aloys, lofterzhang@gmail.com, Wed Nov 4 19:11:07 2020 +0800]","Body":"add channel information if catch exception in BookieRequestHandler\n\n### Motivation\r\nfix #2475 \r\nadd channel information if catch exception in BookieRequestHandler\r\n\r\n\r\n\n\nReviewers: Anup Ghatage <ghatage@apache.org>, Nicolò Boschi <boschi1997@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2479 from aloyszhang/add-channel-info","Date":"Wed Nov 04 12:11:07 CET 2020"},{"Commit-ID":"commit 7e76616ed6ff37891128f426b9794660ea42fff1 1604502827 -----sp","Author":"PersonIdent[Anup Ghatage, ghatage@apache.org, Wed Nov 4 07:13:47 2020 -0800]","Body":"ISSUE #1262: Remove Deprecated CodahaleMetricsProvider, CodahaleOpStatsLogger and \u2026\n\n\u2026CodahaleStatsLogger classes.\r\n\r\n### Motivation\r\n\r\nWe have deprecated these classes since 2018 and moved them to the codahale package.\r\n\r\n### Changes\r\n\r\nRemoved the deprecated files.\r\n\r\nMaster Issue: #1262, #762\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Nicolò Boschi <boschi1997@gmail.com>\n\nThis closes #2459 from Ghatage/BOOKKEEPER-1262/cleanupDeprecatedCode, closes #1262","Date":"Wed Nov 04 16:13:47 CET 2020"},{"Commit-ID":"commit 525a8842549a735f27a6f6c84bf26821863e3885 1604647322 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Fri Nov 6 08:22:02 2020 +0100]","Body":"Upgrade Guava to 30.0-jre\n\n- Upgrade Guava to 30.0.jre (see https://github.com/google/guava/releases)\r\n- adapt code, as Futures.addCallback(3-args) has been removed (see https://github.com/google/guava/commit/dfb00017144bf48c408bc4cfcebadc0a0498dc73)\n\nReviewers: Sijie Guo <sijie@apache.org>, Jia Zhai <zhaijia@apache.org>\n\nThis closes #2480 from eolivelli/fix/upgrade-guava","Date":"Fri Nov 06 08:22:02 CET 2020"},{"Commit-ID":"commit eef3d8dfe51579e1de52eff1ed2f18f1716254bf 1604647430 -----sp","Author":"PersonIdent[Rudy Steiner, rudy_steiner@163.com, Fri Nov 6 15:23:50 2020 +0800]","Body":"ISSUE #2388: Bookie Http Service Servlet for Embedded Bookie\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\nExpose bookie http service by servlet \r\n\r\n### Changes\r\n\r\n*  Introduce Servlet for bookie http service\r\n*  Jetty http server and test bookie http service servlet\r\n\r\nMaster Issue: #2388\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2403 from rudy2steiner/bookie_servlet, closes #2388","Date":"Fri Nov 06 08:23:50 CET 2020"},{"Commit-ID":"commit c4c6113c324d8e5d35c05bcfec1a7974b28acdc6 1604647527 -----sp","Author":"PersonIdent[sijia-w, 53718687+sijia-w@users.noreply.github.com, Fri Nov 6 08:25:27 2020 +0100]","Body":"ISSUE #1979 Metrics link missing\n\nFixes #1979 \r\n\r\nThe link for `Metrics` is broken. However, the `Metrics` file is empty. Therefore, I temporarily removed the link in all versions. The same problem happened to `configuration parameters`.\r\n\r\nI closed pr #2386 as it brought changes from the master instead of a new branch.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2400 from sijia-w/fix-1979, closes #1979","Date":"Fri Nov 06 08:25:27 CET 2020"},{"Commit-ID":"commit bbcb4515b68abac4524ca0aa6506cb6b2f4f59e3 1604653276 -----sp","Author":"PersonIdent[Tboy, guo.jiwei@immomo.com, Fri Nov 6 17:01:16 2020 +0800]","Body":"ISSUE #2467: Remove redundant synchronized\n\n1. Remove redundant synchronized\r\n2. rename fi.getSizeSinceLastwrite -> fi.getSizeSinceLastWrite\r\n3. fix typo\n\nReviewers: Sijie Guo <None>\n\nThis closes #2468 from Technoboy-/issue-2467, closes #2467","Date":"Fri Nov 06 10:01:16 CET 2020"},{"Commit-ID":"commit 22d7d0e40f25e52103f3f3b42c804f16a1826bb2 1604999608 -----sp","Author":"PersonIdent[WJL3333, wjl_is_213@163.com, Tue Nov 10 17:13:28 2020 +0800]","Body":"[Issue 2408] (#2413)\n\n1. fix documentation concept part about default ledger manager.\r\n2. fix documentation protocol part about  missing Qw value.","Date":"Tue Nov 10 10:13:28 CET 2020"},{"Commit-ID":"commit 154bbb9719aedfbc99eed85cde1834151a446a9c 1604999912 -----sp","Author":"PersonIdent[karanmehta93, k.mehta@salesforce.com, Tue Nov 10 01:18:32 2020 -0800]","Body":"Add Add ForceAuditChecksCmd to reset auditor checks last run time (#2472)\n\nMotivation\r\nReset the last run time for auditor checks. Reboot auditor leader immediately to trigger the checks. This is mostly used for testing infra and get the sanity check of a cluster on demand.\r\n\r\nChanges\r\nAdded a new shell command and tests","Date":"Tue Nov 10 10:18:32 CET 2020"},{"Commit-ID":"commit 68c3ccc7b7b364233f9a2a29f42d2bccca975231 1605001566 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Tue Nov 10 17:46:06 2020 +0800]","Body":"[maven-release-plugin] prepare branch branch-4.12\n","Date":"Tue Nov 10 10:46:06 CET 2020"},{"Commit-ID":"commit 8873473c9fa1339faadf078a6a418af44fc89bfe 1605001577 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Tue Nov 10 17:46:17 2020 +0800]","Body":"[maven-release-plugin] prepare for next development iteration\n","Date":"Tue Nov 10 10:46:17 CET 2020"},{"Commit-ID":"commit 51f0340bea06f235d1e31d497b05d32e4e227b26 1605060416 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Wed Nov 11 10:06:56 2020 +0800]","Body":"for 4.12 release, change python client verison to 4.12.0 from 4.12.0-alpha-0\n","Date":"Wed Nov 11 03:06:56 CET 2020"},{"Commit-ID":"commit cbf375ff2664327bdb2b6d1051d25855bb097581 1605573595 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Tue Nov 17 01:39:55 2020 +0100]","Body":"Apache BookKeeper 4.12.0 Release notes (#2478)\n\n* Prepare website structure for 4.12.0\r\n\r\n* Apache BookKeeper 4.12.0 release notes\r\n\r\n* fix release notes, add pr/issue links\r\n\r\nCo-authored-by: Enrico Olivelli <eolivelli@apache.org>\r\nCo-authored-by: Jia Zhai <zhaijia@apache.org>","Date":"Tue Nov 17 01:39:55 CET 2020"},{"Commit-ID":"commit 608288f21bb9999719ed04be7c0cd414baeb1853 1605601393 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Tue Nov 17 16:23:13 2020 +0800]","Body":"[RELEASE 4.12.0] fix version 4.12 after release\n\nthe link in site/releases.md is not updated, this is to fix the issue.\r\nupdate the version in [docker/Dockerfile](https://github.com/apache/bookkeeper/blob/master/docker/Dockerfile).\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2487 from jiazhai/add_412_link","Date":"Tue Nov 17 09:23:13 CET 2020"},{"Commit-ID":"commit 9db16b40ae15f026155cee37eca474195150a188 1605602034 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Tue Nov 17 09:33:54 2020 +0100]","Body":"Set BK 4.11.1 as stable, move 4.9.x to EOL (#2489)\n\nCo-authored-by: Enrico Olivelli <eolivelli@apache.org>","Date":"Tue Nov 17 09:33:54 CET 2020"},{"Commit-ID":"commit 514d962b4a62a1284b93c8aba0fb7afba39eeb8b 1605718271 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Wed Nov 18 17:51:11 2020 +0100]","Body":"Upgrade to Curator 5.1\n\nDescriptions of the changes in this PR:\r\n\r\nCurator 5.x support ZooKeeper 3.6.x.\r\nThis change is needed to able the upgrade of Pulsar to ZooKeeper 3.6.2 \r\n\r\n### Changes\r\n\r\nUpgrade Curator\r\n\n\nReviewers: Anup Ghatage <ghatage@apache.org>\n\nThis closes #2491 from eolivelli/fix/test-curator-5","Date":"Wed Nov 18 17:51:11 CET 2020"},{"Commit-ID":"commit 1d623b4c39a604a254dffcb8ef6bba8df4feb770 1605718432 -----sp","Author":"PersonIdent[Rudy Steiner, rudy_steiner@163.com, Thu Nov 19 00:53:52 2020 +0800]","Body":"[DOC] Issue #2442] New website Project Page\n\nDescriptions of the changes in this PR:\r\n\r\n Update our new website project Privacy policy page\r\n\r\n### Motivation\r\n \r\n   we decide to use new website framework and skeleton to renew our website\r\n\r\n### Changes\r\n\r\n  Add Privacy policy \r\n\r\nMaster Issue: #2442 \r\n\r\n\r\n\n\nReviewers: Anup Ghatage <ghatage@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Abhey Rana <abhey.mnnit@gmail.com>\n\nThis closes #2481 from rudy2steiner/site_project, closes #2442","Date":"Wed Nov 18 17:53:52 CET 2020"},{"Commit-ID":"commit 34074b722b60a4c13041f9c9cb6db4e88e2cec6d 1605980747 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Sat Nov 21 18:45:47 2020 +0100]","Body":"Opportunistic Striping\n\n### Motivation\r\nIf you have a very small cluster, 3 bookies, you must use **2-2-2** as replication parameters in order to guarantee durability and tolerate the failure of at least one bookie.\r\nWith this situation you cannot leverage the striping feature of BookKeeper, when **ensembleSize > writeQuorumSize**.\r\n\r\nWith striping you can distribute your data among all of the bookies, and use better the available disk space.\r\nYou can also exploit the ability to write to/read from more disks (bookies) in parallel, achieving better overall performances.\r\n\r\nWith this change we introduce a new client option \"opportunistic striping\", that basically tells to the BK client to use as much bookies as configured in the ensembleSize parameter in the best case scenario, and to use less and less bookies, up to the configured writeQuorumSize.\r\n\r\n### Changes\r\n- New ClientConfiguration option \"opportunisticStriping\"\r\n- in case of opportunisticStriping the client is allowed to use less bookies than the requested ensemble size, up to writeQuorumSize\r\n- add test cases\n\nReviewers: Nicolò Boschi <boschi1997@gmail.com>, Anup Ghatage <ghatage@apache.org>\n\nThis closes #2493 from eolivelli/fix/bp-43-impl-auto-striping","Date":"Sat Nov 21 18:45:47 CET 2020"},{"Commit-ID":"commit 047a6e927b29fcc62c71946c37b14e17166596ad 1606222997 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Tue Nov 24 14:03:17 2020 +0100]","Body":"Publish BP-38 BookieEndpointInfo for BookKeeper Standalone mode\n\n### Motivation\r\n\r\nWhen you run \"bin/bookkeeper standalone\" the server does not publish BP-38 endpoint info.\r\nThis way you cannot use bookieId (BP-41).\r\n\r\n### Changes\r\n\r\nFix BookieService in \"standalone\" package, that is very like to the BookieService in \"bookkeeper-server\".\r\nThe code cannot be reused, even if the name is similar the overall design of the class hierarchy is different.\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>\n\nThis closes #2484 from eolivelli/fix/standalone-bp38","Date":"Tue Nov 24 14:03:17 CET 2020"},{"Commit-ID":"commit 286362dba8a2c88ba0a6890dad461add1364657a 1606223206 -----sp","Author":"PersonIdent[Raphaël Dehousse, raphael@dehousse.name, Tue Nov 24 14:06:46 2020 +0100]","Body":"ISSUE #2437: Fix typo in ledgers data directory for Docker\n\nFix typo for `ledgers` directory\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\nTypo in the documentation that can leads to issue (data not persistent across docker restarts)\r\n\r\n### Changes\r\n\r\nFix typo (added the `s` to `ledgers`)\r\n\r\nMaster Issue: #2437 \r\n\r\n\n\nReviewers: Jia Zhai <zhaijia@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Matteo Minardi <minardi.matteo@hotmail.it>\n\nThis closes #2438 from rdehouss/patch-1, closes #2437","Date":"Tue Nov 24 14:06:46 CET 2020"},{"Commit-ID":"commit 8d3060e925e0fb06c7a1880155a809fe28ea052b 1606321998 -----sp","Author":"PersonIdent[dependabot[bot], 49699333+dependabot[bot]@users.noreply.github.com, Wed Nov 25 17:33:18 2020 +0100]","Body":"Bump nokogiri from 1.10.7 to 1.10.8 in /site (#2282)\n\nBumps [nokogiri](https://github.com/sparklemotion/nokogiri) from 1.10.7 to 1.10.8.\r\n- [Release notes](https://github.com/sparklemotion/nokogiri/releases)\r\n- [Changelog](https://github.com/sparklemotion/nokogiri/blob/master/CHANGELOG.md)\r\n- [Commits](https://github.com/sparklemotion/nokogiri/compare/v1.10.7...v1.10.8)\r\n\r\nSigned-off-by: dependabot[bot] <support@github.com>\r\n\r\nCo-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>","Date":"Wed Nov 25 17:33:18 CET 2020"},{"Commit-ID":"commit 495995caf690d63df69abaa3f338ad956912ef40 1607098279 -----sp","Author":"PersonIdent[Abhey Rana, abhey.mnnit@gmail.com, Fri Dec 4 21:41:19 2020 +0530]","Body":"ISSUE #2451: Add sidebar to the documentation page\n\nDescriptions of the changes in this PR:\r\n\r\nThis PR introduces changes for adding the sidebar to the new docusaurus based website.\r\n\r\n### Motivation\r\n\r\nThe #2426 Pull Request introduced the changes for new docuasurus based website, However the new website still do not have sidebar similar to our current website. This PR introduces changes for adding the missing sidebar.\r\n\r\n### Changes\r\n\r\nAdded link to the getting-started README in the _sidebars.json_.\r\n\r\nMaster Issue: #2451 \r\n\r\n### Testing Details - \r\n\r\nI have build the changes locally and have verified that the sidebar is getting rendered properly. Here is the screenshot of the new sidebar - \r\n\r\n<img width=\"1680\" alt=\"Screenshot 2020-11-28 at 12 23 28\" src=\"https://user-images.githubusercontent.com/17764661/100495736-8d359b00-3174-11eb-853a-3d67f15dc5a4.png\">\r\n\n\nReviewers: Nicolò Boschi <boschi1997@gmail.com>, Matteo Minardi <minardi.matteo@hotmail.it>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2501 from Abhey/Issue-2451, closes #2451","Date":"Fri Dec 04 17:11:19 CET 2020"},{"Commit-ID":"commit 79cbf19a449a2dc96745fc563a489375b0846a09 1607115527 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Fri Dec 4 21:58:47 2020 +0100]","Body":"Upgrade ZooKeeper to 3.6.2\n\n- upgrade ZooKeeper dependency\r\n- add explicit dependency on Snappy Java, needed by ZooKeeper Server\r\n\r\nPlease note that ZooKeeper server also needs Drop Wizard Metrics Core, but we are already bundling it\r\n\r\n\n\nReviewers: Matteo Merli <mmerli@apache.org>\n\nThis closes #2503 from eolivelli/fix/upgrade-zk-3.6.2 and squashes the following commits:\n\n4bf20168d [Enrico Olivelli] fix DLOG tests\nc71938008 [Enrico Olivelli] fix DLog tests\na410c5633 [Enrico Olivelli] fix benchmarks module\n0a008e73c [Enrico Olivelli] Add metrics core\nea8562271 [Enrico Olivelli] Upgrade ZooKeeper to 3.6.2 - upgrade dependency - add explicit dependency on Snappy Java, needed by ZooKeeper Server","Date":"Fri Dec 04 21:58:47 CET 2020"},{"Commit-ID":"commit 5741f052d4fd17690a21d2ca5071fe190e0cdaa0 1607309359 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Mon Dec 7 03:49:19 2020 +0100]","Body":"Start HTTP Server in Bookie Standlone Mode (#2496)\n\n### Motivation\r\n- when you launch \"bookkeeper standalone\" service the system does not take into account the HTTP Server configuration\r\n- the HTTP Server is important because it allows to use the HTTP API https://bookkeeper.apache.org/docs/latest/admin/http/\r\n- the standalone service is very useful when you are working on client applications (like BKVM)\r\n\r\n### Changes\r\n\r\n- consider HTTP server configuration in 'bin/bookkeeper standalone' command\r\n- add default example configuration\r\n- add VertxHttpServer to dependencies of Standalone Module\r\n- the change is basically a copy and paste of this part of Main.java, but applied to the Main class of the Standalone Starter, which is a separate code: https://github.com/apache/bookkeeper/blob/master/bookkeeper-server/src/main/java/org/apache/bookkeeper/server/Main.java#L327\r\n\r\n\r\n ## Verify this change\r\nAfter this change when you run \"bookkeeper standalone\" the HTTP API will be enabled\r\nFor instance you can check the Bookie API with\r\nhttp://localhost:8080/api/v1/bookie/info","Date":"Mon Dec 07 03:49:19 CET 2020"},{"Commit-ID":"commit 29b0a9ad3150a9de729d3586b374bc4ba17040b4 1607309436 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Mon Dec 7 03:50:36 2020 +0100]","Body":"getBookieInfo is stuck if no bookie is up (#2498)\n\n### Motivation\r\ngetBookieInfo is stuck if no bookie is up\r\n\r\n### Changes\r\nFix the problem, add a test case.\r\nAlso the getBookieInfoTimeout configuration was not  used, we were using the read entry timeout.\r\n","Date":"Mon Dec 07 03:50:36 CET 2020"},{"Commit-ID":"commit 63b3e5a0759f05fde752cc5ade07ea19a8f2b114 1607309505 -----sp","Author":"PersonIdent[Jennifer Huang, 47805623+Jennifer88huang@users.noreply.github.com, Mon Dec 7 10:51:45 2020 +0800]","Body":"[DOCS] Update dbStorage_writeCacheMaxSizeMb configuration description\n\nFixes #2500 \r\n\r\n### Motivation\r\n\r\nThe dbStorage_writeCacheMaxSizeMb configuration is not described clearly.\r\n\r\n### Changes\r\n\r\nRefine the description in the broker.conf file.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2502 from Jennifer88huang/master and squashes the following commits:\n\n505527085 [Jinfeng Huang] update\n0de963832 [Jinfeng Huang] update dbStorage_writeCacheMaxSizeMb","Date":"Mon Dec 07 03:51:45 CET 2020"},{"Commit-ID":"commit 00622bce6279ecf40fe044abe5bd7a29722b2535 1607309573 -----sp","Author":"PersonIdent[Michael Marshall, 47911938+michaeljmarshall@users.noreply.github.com, Sun Dec 6 19:52:53 2020 -0700]","Body":"Add Some Clarifications to the AutoRecovery Documentation\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nI recently started using Apache Bookkeeper as part of my Apache Pulsar cluster. In learning some of the operational tasks related to managing the bookies and autorecovery, I noticed a few places where the documentation could be improved.\r\n\r\n### Changes\r\n\r\nThe changes are all to the `AutoRecovery.md` file for version 4.12.0. They might apply to earlier versions, but I'm not sure how documentation updates are handled. My first change is to explicitly mention the way to turn off the AutoRecovery daemon on the bookie nodes. This configuration was not obvious to me as a new user of the project, and I accidentally had recovery workers running on all nodes. (Regarding that, I mention in the PR that it is possible to run the process on bookie and autorecovery nodes. Perhaps this isn't an intended use case though? If that is so, it should be mentioned in the documentation.) I also added a clarification to the `disable` auto recovery documentation because it wasn't obvious to me that running the script would stop autorecovery for the whole cluster.\r\n\r\nThanks!\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2507 from michaeljmarshall/document-autorecovery-more","Date":"Mon Dec 07 03:52:53 CET 2020"},{"Commit-ID":"commit e49331c57253314551f6d8281b514ef8fd382aac 1607495419 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Wed Dec 9 07:30:19 2020 +0100]","Body":"ISSUE #2463: java.lang.NullPointerException with metadataServiceUri = zk:///ledger\n\n\u2026s (Default on Docker image) #2463\r\n\r\nAvoid NPE and throw IllegalArgumentException in case of invalid service metadata URI\r\n\r\nMaster Issue: #2463 \n\nReviewers: Anup Ghatage <ghatage@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <None>\n\nThis closes #2469 from nicoloboschi/fix/2463/zk-errors, closes #2463","Date":"Wed Dec 09 07:30:19 CET 2020"},{"Commit-ID":"commit 2d216eb9c903c0d303f132f753f5def8ff9a9fd1 1607705692 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Fri Dec 11 17:54:52 2020 +0100]","Body":"BookKeeper Standalone does not work after ZK upgrade - missing third party deps\n\nWith the upgrade to ZooKeeper 3.6.2 the two dependencies \"snappy java\" and \"metrics-core\" are to be explicitly added at runtime in order to make the ZooKeeper server work.\r\n\r\nThis fix is for \"bin/bookkeeper standalone\", that is not working anymore\r\n\r\nRelated commit that broke \"standalone\" mode:\r\nhttps://github.com/apache/bookkeeper/commit/79cbf19a449a2dc96745fc563a489375b0846a09\r\n\r\nHow to verify this change:\r\n- on current master \"bin/bookkeeper standalone\" does not work\r\n- on this branch it works\n\nReviewers: Matteo Minardi <minardi.matteo@hotmail.it>, Anup Ghatage <ghatage@apache.org>, Diana Clementi <diana.clementi@gmail.com>\n\nThis closes #2517 from eolivelli/fix/standlone-zookeeper-362","Date":"Fri Dec 11 17:54:52 CET 2020"},{"Commit-ID":"commit a1af31e915ec74a5066b8f1dadb15fd8cfaf8d43 1607727690 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Sat Dec 12 00:01:30 2020 +0100]","Body":"Allow DNSToSwitchMapping to access BookieAddressResolver\n\nIn order to allow Pulsar to leverage BookieId with custom Bookie-To-Rack Mapping (ZkBookieRackAffinityMapping) we need to inject the BookieAddressResolver into it.\r\n\r\nThere is not way to do it currently because it is created by the BookKeeper client, and we have to inject the same BookieAddressResolver used by the client itself.\r\n\r\n*Changes*\r\n- add new setBookieAddressResolver method (use 'default' methods in order to preserve backward compatibility\r\n- call the new method in every point in which we instantiate a DNSToSwitchMapping and when we receive an instance at construction time\r\n\r\n*Compatibility*\r\n- this change is 100% compatible with previous versions\n\nReviewers: Rajan Dhabalia <rdhabalia@apache.org>, Anup Ghatage <ghatage@apache.org>\n\nThis closes #2519 from eolivelli/fix/dnsswitch-access-bookieaddress-resolver","Date":"Sat Dec 12 00:01:30 CET 2020"},{"Commit-ID":"commit c2618c148675224875af131ac2edd8c3b468390b 1608396031 -----sp","Author":"PersonIdent[Anup Ghatage, ghatage@apache.org, Sat Dec 19 08:40:31 2020 -0800]","Body":"Upgrade libraries Common Compress and Hadoop (only tests) to fix vulnerabilities\n\n### Motivation and Changes\r\nUpgraded libraries mentioned in #2509 #2510 #2511 #2512 #2513 \n\nReviewers: Sijie Guo <sijie@apache.org>, Enrico Olivelli <eolivelli@apache.org>\n\nThis closes #2515 from Ghatage/upgradeLibs","Date":"Sat Dec 19 17:40:31 CET 2020"},{"Commit-ID":"commit f2dcaff3a087737644a08e62ddd1062fd143e589 1608759159 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Wed Dec 23 22:32:39 2020 +0100]","Body":"Activate GitHub Actions on all PRs and on push\n\n### Motivation\r\n\r\nCurrently we are not running PR validation for Pull Requests against release branches (as branch-4.12).\r\nAlso we are not running tests on master branch and we do not have Jenkins anymore\r\n\r\n### Changes\r\n- Enable PR validation for pull requests against all release branches\r\n- Enable GitHub actions on \"push\"\r\n\n\nReviewers: Anup Ghatage <ghatage@apache.org>, Lari Hotari <None>\n\nThis closes #2525 from eolivelli/fix/activate-github-actions-all-branches","Date":"Wed Dec 23 22:32:39 CET 2020"},{"Commit-ID":"commit 6866b519001b79431a4fe8b4d5c4f6196632a661 1608765810 -----sp","Author":"PersonIdent[Ankur Jain, ankurjain.v@flipkart.com, Thu Dec 24 04:53:30 2020 +0530]","Body":"ISSUE #2522: Update jcommander from 1.48 to 1.78\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\nCertain bookkeeper shell commands when bookkeeper is bundled with pulsar because of conflicting jcommander versions\r\n\r\n### Changes\r\nUpdates jcommander to 1.78, same as pulsar.\r\n\r\nMaster Issue: #2522 \n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2523 from anvinjain/jcmd-1.78-update, closes #2522","Date":"Thu Dec 24 00:23:30 CET 2020"},{"Commit-ID":"commit 6dc628a4c3d346c70193d72c37598e9099db8e88 1609139519 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Mon Dec 28 07:50:39 2020 +0100]","Body":"Remove reference to thirdparty untrusted github actions\n- remove reference to untrusted styfle/cancel-workflow-action\n- add workflow_dispach event in order to be able to trigger the execution manually from release branches\n","Date":"Mon Dec 28 07:50:39 CET 2020"},{"Commit-ID":"commit c7f6066f33e86b9b3bf83a1a0cf365b51c7c222d 1610360704 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Mon Dec 28 11:37:57 2020 +0100]","Body":"Apache BookKeeper 4.12.1 release notes\n","Date":"Mon Dec 28 11:37:57 CET 2020"},{"Commit-ID":"commit 86a1912d2873355f26d4fbb63de36439a7da8bf2 1610361370 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Mon Jan 11 11:36:10 2021 +0100]","Body":"Move Dockerfile to 4.12.1\n","Date":"Mon Jan 11 11:36:10 CET 2021"},{"Commit-ID":"commit 775ffdd4c0f1d4ad89d107846d317f1033fccb16 1610578127 -----sp","Author":"PersonIdent[Diana Clementi, diana.clementi@gmail.com, Wed Jan 13 23:48:47 2021 +0100]","Body":"Issue 2531 - Fix noisy stacktrace at boot (#2532)\n\n### Motivation\r\nThe exception is managed with a fallback, printing the stacktrace would be misleading\r\n\r\n### Changes\r\n- Changed log level from info to debug for the log line\r\n- Removed the exception from the log line\r\n\r\nMaster Issue: #2531","Date":"Wed Jan 13 23:48:47 CET 2021"},{"Commit-ID":"commit 2ac577bd072f0115d6e6494e12088fb32d36535d 1611433246 -----sp","Author":"PersonIdent[Henry Saputra, hsaputra@apache.org, Sat Jan 23 12:20:46 2021 -0800]","Body":"Fix the broken links and links to archive pages. (#2548)\n\nThere are some broken and obsolete archive links in the README.\r\n\r\nUpdate them to point to latest Documentation site.\r\n\r\nCo-authored-by: Henry Saputra <hsapura@apache.org>","Date":"Sat Jan 23 21:20:46 CET 2021"},{"Commit-ID":"commit 2192caaf9738cf4efb799647cc5a5f68bf1823b2 1611732006 -----sp","Author":"PersonIdent[Michael Marshall, 47911938+michaeljmarshall@users.noreply.github.com, Wed Jan 27 00:20:06 2021 -0700]","Body":"Fix javadoc for LedgerMetadata's method getAllEnsembles (#2556)\n\n","Date":"Wed Jan 27 08:20:06 CET 2021"},{"Commit-ID":"commit e0e3e3442e09d56c6f33e87c31799a3876ea1c95 1611732404 -----sp","Author":"PersonIdent[Rudy Steiner, rudy_steiner@163.com, Wed Jan 27 15:26:44 2021 +0800]","Body":"Check np for LifecycleComponent close\n\nDescriptions of the changes in this PR:\r\n\r\n Check NP of  BookKeeper Stream Storage Server LifecycleComponents\r\n\r\n### Motivation\r\n\r\nFix issue #2505 \r\n \r\n### Changes\r\n\r\n(Describe: what changes you have made)\r\n\r\nMaster Issue: #2505 \r\n\r\n\n\nReviewers: Flavio Paiva Junqueira <fpj@apache.org>, Enrico Olivelli <eolivelli@apache.org>\n\nThis closes #2542 from rudy2steiner/Stream_npe_check","Date":"Wed Jan 27 08:26:44 CET 2021"},{"Commit-ID":"commit c5d7026cc38ce3fdfcac8f569327c1d4837813ad 1611733106 -----sp","Author":"PersonIdent[Shoothzj, shoothzj@gmail.com, Wed Jan 27 15:38:26 2021 +0800]","Body":"Allow to configure Prometheus HTTP Server bind address\n\nDescriptions of the changes in this PR:\r\n\r\nmake prometheus bind addr can cofigure\r\n\r\n### Motivation\r\n\r\nFor security, make prometheus bind addr can config.\r\nFor compatibility, make default value is 0.0.0.0\r\n\r\n### Changes\r\n\r\nmake prometheus bind addr can cofigure\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2543 from Shoothzj/promethes_addr","Date":"Wed Jan 27 08:38:26 CET 2021"},{"Commit-ID":"commit 1efdc1c0807fc7151595c1bb0414ea1dd255e48d 1611733262 -----sp","Author":"PersonIdent[hangc0276, hangc0276@163.com, Wed Jan 27 15:41:02 2021 +0800]","Body":"fix default value in bk_server.conf, sync with code default value\n\n### Motivation\r\nFix the default value in `bk_server.conf`, sync with the default value in code.\r\n\r\nFor `readAheadCacheBatchSize` in code default value.\r\n``` Java\r\nprivate static final int DEFAULT_READ_AHEAD_CACHE_BATCH_SIZE = 100;\r\nreadAheadCacheBatchSize = conf.getInt(READ_AHEAD_CACHE_BATCH_SIZE, DEFAULT_READ_AHEAD_CACHE_BATCH_SIZE);\r\n```\r\nSo, it should be 100 in `bk_server.conf` default configuration.\r\n\r\nFor `dbStorage_readAheadCacheMaxSizeMb` in code default value.\r\n```Java\r\npublic static final String READ_AHEAD_CACHE_MAX_SIZE_MB = \"dbStorage_readAheadCacheMaxSizeMb\";\r\nprivate static final long DEFAULT_READ_CACHE_MAX_SIZE_MB = (long) (0.25 * PlatformDependent.maxDirectMemory())\r\n            / MB;\r\nlong readCacheMaxSize = getLongVariableOrDefault(conf, READ_AHEAD_CACHE_MAX_SIZE_MB,\r\n                DEFAULT_READ_CACHE_MAX_SIZE_MB) * MB;\r\n```\r\nSo, it should be 25% of direct memory in `bk_server.conf` default configuration.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2533 from hangc0276/update_doc_default_value","Date":"Wed Jan 27 08:41:02 CET 2021"},{"Commit-ID":"commit 9160b94aa8fe9936faa21dae07030dcd1fc126f5 1611733329 -----sp","Author":"PersonIdent[Arvin, arvindevel@gmail.com, Wed Jan 27 15:42:09 2021 +0800]","Body":"[improve log info] fix typo (#2520)\n\n","Date":"Wed Jan 27 08:42:09 CET 2021"},{"Commit-ID":"commit 3f7da147c08cfc5071899bed640c4f3bfe331e1c 1611733403 -----sp","Author":"PersonIdent[Michael Marshall, 47911938+michaeljmarshall@users.noreply.github.com, Wed Jan 27 00:43:23 2021 -0700]","Body":"Sync 4.12.0 autorecovery doc to lastest\n\nDescriptions of the changes in this PR:\r\n\r\nCopying documentation updates for auto recovery from the `4.12.0` directory to the `latest` directory based on eolivelli's request in https://github.com/apache/bookkeeper/pull/2507.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2516 from michaeljmarshall/update-latest-documentation","Date":"Wed Jan 27 08:43:23 CET 2021"},{"Commit-ID":"commit 663000df507c54f3a6b3367ba074c85815f04b46 1611745845 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Wed Jan 27 12:10:45 2021 +0100]","Body":"Fix BookKeeper shell \"list bookies\" in case of downbookie and reduce noisy log during re-replication in case of down bookie\n\n### Motivation\r\n\r\nWhen a bookie is down you can see many error both on command line tools and during replicator work.\r\n\r\nAlso the CLI is not working at all\r\n\r\n```\r\n\r\nThis is the error on \"bookkeeper shell listbookies\" when a bookie is downb\r\norg.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available\r\n\tat org.apache.bookkeeper.discover.ZKRegistrationClient.getBookieServiceInfo(ZKRegistrationClient.java:248) ~[org.apache.bookkeeper-bookkeeper-server-4.12.0.jar:4.12.0]\r\n\tat org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:43) [org.apache.bookkeeper-bookkeeper-server-4.12.0.jar:4.12.0]\r\n\tat org.apache.bookkeeper.tools.cli.helpers.CommandHelpers.getBookieSocketAddrStringRepresentation(CommandHelpers.java:45) [org.apache.bookkeeper-bookkeeper-server-4.12.0.jar:4.12.0]\r\n\tat org.apache.bookkeeper.tools.cli.commands.bookies.ListBookiesCommand.printBookies(ListBookiesCommand.java:124) [org.apache.bookkeeper-bookkeeper-server-4.12.0.jar:4.12.0]\r\n\tat org.apache.bookkeeper.tools.cli.commands.bookies.ListBookiesCommand.run(ListBookiesCommand.java:113) [org.apache.bookkeeper-bookkeeper-server-4.12.0.jar:4.12.0]\r\n\tat org.apache.bookkeeper.tools.cli.commands.bookies.ListBookiesCommand.run(ListBookiesCommand.java:43) [org.apache.bookkeeper-bookkeeper-server-4.12.0.jar:4.12.0]\r\n\tat org.apache.bookkeeper.tools.cli.helpers.DiscoveryCommand.apply(DiscoveryCommand.java:57) [org.apache.bookkeeper-bookkeeper-server-4.12.0.jar:4.12.0]\r\n\tat org.apache.bookkeeper.tools.cli.helpers.ClientCommand.apply(ClientCommand.java:60) [org.apache.bookkeeper-bookkeeper-server-4.12.0.jar:4.12.0]\r\n\tat org.apache.bookkeeper.bookie.BookieShell$ListBookiesCmd.runCmd(BookieShell.java:1202) [org.apache.bookkeeper-bookkeeper-server-4.12.0.jar:4.12.0]\r\n\tat org.apache.bookkeeper.bookie.BookieShell$MyCommand.runCmd(BookieShell.java:236) [org.apache.bookkeeper-bookkeeper-server-4.12.0.jar:4.12.0]\r\n\tat org.apache.bookkeeper.bookie.BookieShell.run(BookieShell.java:2235) [org.apache.bookkeeper-bookkeeper-server-4.12.0.jar:4.12.0]\r\n\tat org.apache.bookkeeper.bookie.BookieShell.main(BookieShell.java:2326) [org.apache.bookkeeper-bookkeeper-server-4.12.0.jar:4.12.0]\r\n\r\n```\r\n\r\n### Changes\r\n\r\nReduce the log level, and save printing useless stacktraces:\r\n- CommandsHelpers -> prevent error on the CLI in case of down bookie (this is a blocker for the usage of the CLI)\r\n- PerChannelBookieClient -> any time you try to connect to a down bookie\r\n- DefaultBookieAddressResolver -> duplicate log line, the error already bubbles up on the caller\n\nReviewers: Flavio Junqueira <fpj@apache.org>\n\nThis closes #2538 from eolivelli/fix/reduce-logs","Date":"Wed Jan 27 12:10:45 CET 2021"},{"Commit-ID":"commit 0a4a5577de00aeaca7cafaf2bd8fee1abe0030d3 1611752192 -----sp","Author":"PersonIdent[Raúl Gracia, raulgraciatinedo@gmail.com, Wed Jan 27 13:56:32 2021 +0100]","Body":"ISSUE #2557: Bookkeeper docker image build fails because of deprecated Python version for pip\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nFix Docker image build for Bookkeeper.\r\n\r\n### Changes\r\n\r\nThis PR just makes sure that the `pip` version used in the Dockerfile is compatible with Python 2.7. We may need to consider cherry-picking this PR to branches of Bookkeeper that are not end-of-life. \r\n\r\nMaster Issue: #2557\r\n\r\nSigned-off-by: Raúl Gracia <raul.graciaemc.com>\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2558 from RaulGracia/issue-2557-fix-docker-image-build, closes #2557","Date":"Wed Jan 27 13:56:32 CET 2021"},{"Commit-ID":"commit 73b4cd417c0b5e841f5390acbf998ac22361fc84 1611818340 -----sp","Author":"PersonIdent[Andrey Yegorov, dlg99@users.noreply.github.com, Wed Jan 27 23:19:00 2021 -0800]","Body":"Fixed failing tests for /stream.\n\nDescriptions of the changes in this PR:\r\n\r\nFixed tests for /stream, RocksDB initialization.\r\nSame as https://github.com/apache/bookkeeper/pull/2551 but for master branch\r\n\r\n### Motivation\r\n\r\nTests were failing with \" \u201cjava.lang.UnsatisfiedLinkError: 'long org.rocksdb.LRUCache.newLRUCache(long, int, boolean, double)'\u201d\".\r\n\r\n### Changes\r\n\r\nFixed following suggestion form https://github.com/facebook/rocksdb/issues/6789\r\nAdded\r\n`    static {\r\n        RocksDB.loadLibrary();\r\n    }`\r\nto extract the native library from the jar file etc.\r\n\r\nMaster Issue: #2550\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2554 from dlg99/master-streams-tests","Date":"Thu Jan 28 08:19:00 CET 2021"},{"Commit-ID":"commit 6c3c9f7cf4bd4d6db5fcd4aee657c3a0f30fd2f4 1611818634 -----sp","Author":"PersonIdent[Andrey Yegorov, dlg99@users.noreply.github.com, Wed Jan 27 23:23:54 2021 -0800]","Body":"Allow stream storage to use hostname instead of IP address\n\nDescriptions of the changes in this PR:\r\n\r\nAllow stream storage to use hostname instead of IP address\r\n\r\n### Motivation\r\n\r\nissue #2559\r\n\r\n### Changes\r\n\r\nAllowed use of the host name for the endpoint.\r\nChanges by cdbartholomew\r\n\r\nMaster Issue: #2559\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Sijie Guo <sijie@apache.org>\n\nThis closes #2560 from dlg99/master-stream-hostname","Date":"Thu Jan 28 08:23:54 CET 2021"},{"Commit-ID":"commit bab5a003e84601469485cbcee4fc784171a1513d 1611821525 -----sp","Author":"PersonIdent[Andrey Yegorov, dlg99@users.noreply.github.com, Thu Jan 28 00:12:05 2021 -0800]","Body":"Fixed: DLCheckpointStore rethrows exceptions as FNFE but swallows the rootcause\n\nDLCheckpointStore rethrows exceptions as FNFE but swallows the rootcause\r\nSame as https://github.com/apache/bookkeeper/pull/2553 but for master branch\r\n\r\nDescriptions of the changes in this PR:\r\n\r\nadded .initCause for the new FNFE exception to preserver it\r\n\r\n### Motivation\r\n\r\ngot the\r\nERROR org.apache.bookkeeper.statelib.impl.rocksdb.checkpoint.RocksCheckpointer - Failed to restore rocksdb ...\r\njava.io.FileNotFoundException: ..../metadata\r\nwithout any additional info for the rootcause (other than stack pointing to the DLCheckpointStore)\r\n\r\nDLCheckpointStore appears to re-throw exceptions as FNFE without preserving the rootcause\r\n\r\n### Changes\r\n\r\nadded .initCause\r\n\r\nMaster Issue: #2552\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2555 from dlg99/master-fnfe","Date":"Thu Jan 28 09:12:05 CET 2021"},{"Commit-ID":"commit efaa993a6c0bde9e2773dc598a4812a4b678de7a 1611950609 -----sp","Author":"PersonIdent[Surinder Singh, sursingh@gmail.com, Fri Jan 29 12:03:29 2021 -0800]","Body":"ISSUE #2563: Fix SST file corruption.\n\nFix SST File corruption during checkpointing\r\n\r\n### Motivation\r\n\r\nSince the SST files are shared among checkpoints, this will not be resolved by future checkpoints. We will fail to restore all future checkpoints that depend on this file.\r\n\r\n### Changes\r\n\r\nThe record is sent asynchronously. We need to use a copy of the passed buffer\r\nin the record. The ownership is retained by the caller and will be potentially\r\nchanged by the caller. In case of corruption the later blocks were\r\noverwriting the previous blocks resulting in corruption\r\n\r\n\r\nMaster Issue: #2563 \r\n\r\n\n\nReviewers: Andrey Yegorov <None>, Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #2564 from sursingh/fix-sst-corruption, closes #2563","Date":"Fri Jan 29 21:03:29 CET 2021"},{"Commit-ID":"commit 86ea505b6d0ab51432c2820d7517f78b61c44ae4 1612172866 -----sp","Author":"PersonIdent[Henry Saputra, hsaputra@apache.org, Mon Feb 1 01:47:46 2021 -0800]","Body":"Fix the current site to allow click links in doc\n\nSince there will be some time before we get site2 up and running, sending\r\nthis fix to allow links in doc content ot be clickable.\r\n\r\nCurrently, if user go to https://bookkeeper.apache.org/docs/latest/ the links\r\nin the doc can not be click since the div overlay of navigator on left is\r\ncovering the content body.\r\n\r\nThe simple proposed fix is to set width of navigator container class to\r\ncertain width to not cover the body content.\r\n\r\nTo verify behavior and proposed fix difference:\r\n\r\n1. Go to https://bookkeeper.apache.org/docs/latest/ and try to click the `WAL` link. You will not see the cursor change to hand icon to click the link\r\n2. Now, visit the proposed fix at https://hsaputra.github.io/bookkeeper-staging-site/docs/latest/, then when  you hover on top of `WAL` link you should see the cursor change to hand point and allow you to click the link and navigate to the URL.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2570 from hsaputra/fix_anchor_doc","Date":"Mon Feb 01 10:47:46 CET 2021"},{"Commit-ID":"commit c5e4c8645bb08c4b0ba65d15c8b4d0084bd09c68 1612173126 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Mon Feb 1 01:52:06 2021 -0800]","Body":"Handling checkpoint corruption in case of bookie crash\n\nDescriptions of the changes in this PR:\r\n\r\nAllowed fallback to previous checkpoint, assuming that corrupt checkpoint means that checkpointing did not complete and the journal is intact.\r\n\r\n### Motivation\r\n\r\nReliability and resilience of teh table service.\r\n\r\n### Changes\r\n\r\nAllowed fallback to previous checkpoint, assuming that corrupt checkpoint means that checkpointing did not complete and the journal is intact.\r\n\r\nMaster Issue: #2565\r\n\r\n\n\nReviewers: Surinder Singh, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2566 from dlg99/master-checkpoint-corruption","Date":"Mon Feb 01 10:52:06 CET 2021"},{"Commit-ID":"commit a7f2a2eceaaeb4e101c6fd51a6868b48c8d1214f 1612173283 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Mon Feb 1 01:54:43 2021 -0800]","Body":"Limit log output to prevent in case of the large group of the log segments\n\nDescriptions of the changes in this PR:\r\n\r\nLimit logged data\r\n\r\n### Motivation\r\n\r\nOverly long log line at ReadAheadEntryReader\r\nFound a log with single log line of over 5 mil characters long\r\n\"org.apache.distributedlog.ReadAheadEntryReader - Starting the readahead entry reader for ...\" + the details of ~16000 segments.\r\n\r\n### Changes\r\n\r\nOutput details of up to 10 segments plus count of segments.\r\n\r\nMaster Issue: #2561\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Nicolo Boschi <boschi1997@gmail.com>\n\nThis closes #2562 from dlg99/master-log","Date":"Mon Feb 01 10:54:43 CET 2021"},{"Commit-ID":"commit cb284995fbfc23441be10b4465ed2985b64d5ae4 1612231035 -----sp","Author":"PersonIdent[Chris Bartholomew, chris.bartholomew@kafkaesque.io, Mon Feb 1 20:57:15 2021 -0500]","Body":"Stream storage endpoint from hostname to return fully-qualified name in Java 11+\n\nDescriptions of the changes in this PR:\r\n\r\nUpdate how hostname is retrieved when using hostname as identifier for stream storage to work consistenly between Java 8 and Java 11.\r\n\r\n### Motivation\r\n\r\nBetween Java 8 and Java 11, the value returned by `InetAddress.getLocalHost().getHostName()` changed from being the fully qualified name to just the short hostname. When running in a Kubernetes environment, it is necessary for the endpoint to be identied by its fully qualified name so that clients can connect. \r\n\r\nThis same change was made in Pulsar in https://github.com/apache/pulsar/pull/6235.\r\n\r\nI have tested this change in Kubernetes environment using Java 11.\r\n\r\n### Changes\r\n\r\nThis is a simple change from `getHostName` to `getCanonicalHostName()`.\r\n\r\nMaster Issue: #2559\r\n\r\n\n\nReviewers: Andrey Yegorov <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2571 from cdbartholomew/stream-storage-endpoint-java11","Date":"Tue Feb 02 02:57:15 CET 2021"},{"Commit-ID":"commit dc235fe75cb19e3077140927a6702dc934124738 1612257188 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Tue Feb 2 01:13:08 2021 -0800]","Body":"fix: TableStoreImplTest failed because of NPE in AbstractStateStoreWithJournal initialization (test/mock issue)\n\nDescriptions of the changes in this PR:\r\n\r\nfixed mock creation.\r\n\r\n### Motivation\r\n\r\ntests fail\r\n\r\n### Changes\r\n\r\nfixed mock creation\r\nMaster Issue: #2572\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2573 from dlg99/master-fix-tabletest-npe","Date":"Tue Feb 02 10:13:08 CET 2021"},{"Commit-ID":"commit 1ddeb9bfd4ad5a016e76254391fb88c53f566f63 1612257714 -----sp","Author":"PersonIdent[Surinder Singh, sursingh@gmail.com, Tue Feb 2 01:21:54 2021 -0800]","Body":"ISSUE #2567: Save last revision in rocksdb\n\n\r\nDescriptions of the changes in this PR:\r\n\r\nSave latest revision in rocksdb.\r\n\r\n### Motivation\r\nCurrently while restoring the complete transaction log is replayed. \r\nAs the transaction log builds up over time, it takes longer and longer to restore the storage containers on a new pod.\r\n\r\n### Changes\r\n\r\nInstead we will save the revision in the rocksdb. We will use the revision retrieved after\r\nrestoring the last checkpoint to skip ahead in the journal logs and only replay the entries\r\nthat are not included in the checkpoint\r\n\r\nMaster Issue: #2567 \r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Andrey Yegorov <andrea.yegorov@datastax.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #2568 from sursingh/save-last-version, closes #2567","Date":"Tue Feb 02 10:21:54 CET 2021"},{"Commit-ID":"commit 37e562225c83c227e5994e5a327181fca22d515b 1612337287 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Tue Feb 2 23:28:07 2021 -0800]","Body":"Fix: Multiple tests failing in /stream subproject\n\nDescriptions of the changes in this PR:\r\n\r\nFixed (some of) the test failures.\r\n\r\nOther tests need more work, some of them succeed on retry, some might fail but for different reasons.\r\nTo be continued.\r\n\r\n### Motivation\r\n\r\nthe tests shall pass\r\n\r\n### Changes\r\n\r\nFixed: missing dependencies for some subprojects\r\nFixed: mock setup for some tests\r\n\r\nMaster Issue: #2577\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Prashant Kumar\n\nThis closes #2578 from dlg99/master-test-fix","Date":"Wed Feb 03 08:28:07 CET 2021"},{"Commit-ID":"commit 2a6f718140eb01ae426856361dbbdcf80d4755b3 1612337411 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Tue Feb 2 23:30:11 2021 -0800]","Body":"fix: BKAsyncLogWriter swallows rootcause of the WriteException\n\nDescriptions of the changes in this PR:\r\n\r\nAdded first exception as a rootcause for the WriteException\r\n\r\n### Motivation\r\n\r\nsimplify troubleshooting\r\n\r\n### Changes\r\n\r\nAdded first exception as a rootcause for the WriteException\r\n\r\nMaster Issue: #2574\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2575 from dlg99/master-alw-exception","Date":"Wed Feb 03 08:30:11 CET 2021"},{"Commit-ID":"commit 333cb54b3ba0006ef79c6a5a3f52d11537d5459f 1612424407 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Wed Feb 3 23:40:07 2021 -0800]","Body":"Upgrade protobuf to 3.14.0 (latest)\n\nDescriptions of the changes in this PR:\r\n\r\nUpgraded protobuf dependency\r\n\r\n### Motivation\r\n\r\nunit tests log \"WARNING: Illegal reflective access by com.google.protobuf.UnsafeUtil\" on Java11\r\nThis has been fixed in protobuf since version 3.7\r\n\r\n### Changes\r\n\r\nUpgraded protobuf; \r\nupdated code to remove use of deprecated methods\r\n\r\nMaster Issue: #2579\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Nicolò Boschi <boschi1997@gmail.com>\n\nThis closes #2580 from dlg99/master-proto","Date":"Thu Feb 04 08:40:07 CET 2021"},{"Commit-ID":"commit 2737bb51c13150543a39851e9ef777574644a11d 1612562494 -----sp","Author":"PersonIdent[Yu Liu, 50226895+Anonymitaet@users.noreply.github.com, Sat Feb 6 06:01:34 2021 +0800]","Body":"[Doc] Add descriptions for BookKeeper metadata store (#2576)\n\n* add\r\n\r\n* update\r\n\r\nCo-authored-by: Anonymitaet <anonymitaet_hotmail.com>","Date":"Fri Feb 05 23:01:34 CET 2021"},{"Commit-ID":"commit fc0c1151908dd2c296ffb6d66e5c3f546558dd4d 1612856203 -----sp","Author":"PersonIdent[Michael Marshall, 47911938+michaeljmarshall@users.noreply.github.com, Tue Feb 9 00:36:43 2021 -0700]","Body":"Fix javadoc for getAllBookies in RegistrationClient interface\n\nDescriptions of the changes in this PR:\r\n\r\nBasic javadoc update from what looks to be an accidental copy from another javadoc.\r\n\r\nI opened https://github.com/apache/bookkeeper/issues/2588 to clarify what the meaning of \"all\" is. Either way, I'm sure we just need to update the javadoc as I did in this PR.\r\n\r\nIf https://github.com/apache/bookkeeper/issues/2588 reveals something interesting, it might be worth updating this javadoc to include that information.\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2589 from michaeljmarshall/fix-get-all-bookies-javadoc","Date":"Tue Feb 09 08:36:43 CET 2021"},{"Commit-ID":"commit 27e7625b3fd9c4caba4fa4ab35bf3d6e3d45cca8 1612860607 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Tue Feb 9 00:50:07 2021 -0800]","Body":"Upgrading GRPC version to 1.33, Netty to 4.1.50Final and ETCD client driver\n\nDescriptions of the changes in this PR:\r\n\r\nupgraded GRPC\r\nWill need to upgrade GRPC in pulsar as well\r\n\r\nUpgrading:\r\n- GRPC version to 1.33\r\n- Netty to 4.1.50Final\r\n- ETCD client driver\r\n- TestContainers\r\n\r\n### Motivation\r\n\r\nTableService stopped working under load.\r\njstack points to a problem with GRPC that is fixed in later versions\r\n\r\n### Changes\r\n\r\nupgraded GRPC\r\n\r\nMaster Issue: #2581\r\n\r\n\n\nReviewers: Nicolo Boschi <boschi1997@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>, Lari Hotari <lari.hotari@datastax.com>\n\nThis closes #2582 from dlg99/master-grpc-upgrade","Date":"Tue Feb 09 09:50:07 CET 2021"},{"Commit-ID":"commit 8b22a7b9d828c699a3fa62071ae4fecc62248201 1612871293 -----sp","Author":"PersonIdent[pkumar-singh, 65131575+pkumar-singh@users.noreply.github.com, Tue Feb 9 03:48:13 2021 -0800]","Body":"Fix hanging tests tests TestStorageServerClientManagerImpl\n\nDescriptions of the changes in this PR:\r\n\r\n**Motivation**\r\nFixing hanging tests TestStorageServerClientManagerImpl and other tests in the directory\r\n\r\nSome tests were not running because they were hanging waiting on future while storage container was being fetched.\r\nBut inproc grpc server was running on endpoint fake-server while client was connecting on fake-server:4181\r\n\r\n**Changes**\r\nMake GRPC inproc server run on fake-server:4181 and client connect on fake-server:4181\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Andrey Yegorov <andrey.yegorov@datastax.com>\n\nThis closes #2587 from pkumar-singh/fix_hanging_unit_tests","Date":"Tue Feb 09 12:48:13 CET 2021"},{"Commit-ID":"commit 93b3c781ceaae9d6ac633c68806ee5407e46d708 1612945675 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Wed Feb 10 00:27:55 2021 -0800]","Body":"Fix failing test in /stream\n\nDescriptions of the changes in this PR:\r\n\r\nGrpcChannelsTest and BKRegistrationNameResolverTest fail in /stream\r\n\r\n\r\n### Motivation\r\n\r\nfix tests\r\n\r\n### Changes\r\n\r\nBKRegistrationNameResolverTest failed because the bookieAddressResolver tried to use clientDriver before clientDriver's initialization. Fixed initialization order.\r\n\r\nGrpcChannelsTest failed because of the grpc.netty-shaded conflict with unshaded grpc.netty\r\n\r\nPicked up eolivelli 's changes to run stream tests on CI\r\n\r\nMaster Issue: #2594\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2595 from dlg99/master-stream-test-fix","Date":"Wed Feb 10 09:27:55 CET 2021"},{"Commit-ID":"commit 18dfb16cb129b6d5f953356e3a906fe7a7f2f7d7 1613212450 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Sat Feb 13 02:34:10 2021 -0800]","Body":"Upgrading dropwizard to 3.2.5\n\nDescriptions of the changes in this PR:\r\n\r\nUpgraded Dropwizard Metrics to 3.2.5, that is the same version used by ZooKeeper 3.6.2\r\n\r\n### Motivation\r\n\r\nUpgraded Dropwizard Metrics to the same version used by ZooKeeper 3.6.2 (and Pulsar 2.8)\r\n\r\n### Changes\r\n\r\npom + license files\r\n\r\nMaster Issue: #2599\r\n\r\n\n\nReviewers: Nicolo  Boschi <boschi1997@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2602 from dlg99/master-dw-update","Date":"Sat Feb 13 11:34:10 CET 2021"},{"Commit-ID":"commit 92bca066c9eca88313b9ef89ff6c567b8f511a63 1613374113 -----sp","Author":"PersonIdent[Diana Clementi, diana.clementi@diennea.com, Mon Feb 15 08:28:33 2021 +0100]","Body":"Fix for licenses problems\n\nFix problems found with check-binary-licence \r\nMaster Issue: #2592\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Andrey Yegorov <andrey.yegorov@datastax.com>\n\nThis closes #2603 from dianacle/2592-licence-check-fix","Date":"Mon Feb 15 08:28:33 CET 2021"},{"Commit-ID":"commit d4d0060bc38995777da5cc2363c7af897a908f27 1613474342 -----sp","Author":"PersonIdent[Michael Marshall, 47911938+michaeljmarshall@users.noreply.github.com, Tue Feb 16 04:19:02 2021 -0700]","Body":"ISSUE #2506: Skip unavailable bookies during verifyLedgerFragment\n\nDescriptions of the changes in this PR:\r\n\r\nThis PR improves the `verifyLedgerFragment` method in the `LedgerChecker` by skipping calls to bookies that are known to be unavailable. The \"bad bookies\" are calculated by using metadata available in ZK and accessed by the `BookKeeperAdmin`. Note that `verifyLedgerFragment` will still run checks on all other bookies that appear available.\r\n\r\n### Motivation\r\n\r\nThe motivation for this change is demonstrated in #2506. As this code currently works, there are a ton of calls made to unavailable bookies with the intent of calculating bad (unavailable) bookies. This proposed change would greatly decrease the number of calls that the auditor and the replicator need to make to calculate which ledgers need replicating.\r\n\r\n### Changes\r\n\r\n1. Added `getUnavailableBookies` method to the `BookKeeperAdmin`. This method could attempt to use caching, but it's not actually called that often, so I think caching might not add complexity without much value.\r\n2. Updated `verifyLedgerFragment` method signature to take a collection of `unavailableBookies`.\r\n\r\nMaster Issue: #2506\r\n\r\n### Testing\r\nIf these changes are acceptable, I'd like some help identifying the best way to test these changes. I already added some coverage for the `getUnavailableBookies` method, but I haven't explicitly tested the fundamental change this PR proposes. Thanks!\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Andrey Yegorov <andrey.yegorov@datastax.com>\n\nThis closes #2597 from michaeljmarshall/leverage-available-bookies, closes #2506","Date":"Tue Feb 16 12:19:02 CET 2021"},{"Commit-ID":"commit 3c4f7346416fcc4058e9c2b354867c456decb6c2 1613505207 -----sp","Author":"PersonIdent[Andrey Yegorov, andrey.yegorov@datastax.com, Tue Feb 16 11:53:27 2021 -0800]","Body":"[maven-release-plugin] prepare branch branch-4.13\n","Date":"Tue Feb 16 20:53:27 CET 2021"},{"Commit-ID":"commit 23b268906b9f99f5c20e77363322d501d61db1d3 1613505308 -----sp","Author":"PersonIdent[Andrey Yegorov, andrey.yegorov@datastax.com, Tue Feb 16 11:55:08 2021 -0800]","Body":"[maven-release-plugin] prepare for next development iteration\n","Date":"Tue Feb 16 20:55:08 CET 2021"},{"Commit-ID":"commit e0ddda48620f124deb26c16e165f5e7b84f6534d 1613592794 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Wed Feb 17 12:13:14 2021 -0800]","Body":"Release script does not work on MacOs Big Sur\n\nDescriptions of the changes in this PR:\r\n\r\nFixed the script/docker run command to mount to `/home/$USER` instead of mac-style `/Users/$USER`. \r\n\r\n### Motivation\r\n\r\n`dev/release/000-run-docker.sh` failed to mount source dir (got empty dir instead), printed permissions errors like\r\n```\r\nmkdir: cannot create directory '/root': Permission denied\r\nCan not write to /root/.m2/copy_reference_file.log. Wrong volume permissions? Carrying on ...\r\n```\r\n\r\n### Changes\r\n\r\nsee above\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2608 from dlg99/master-release-docker-mac","Date":"Wed Feb 17 21:13:14 CET 2021"},{"Commit-ID":"commit 503e0c29b5acd99f0ec52449f412cb3dbeb7ae90 1613603931 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Thu Feb 18 00:18:51 2021 +0100]","Body":"Fix docker image build - add python3\n\n### Motivation\r\nBuilding the docker image does not work anymore, see #2601 \r\n\r\n### Changes\r\nAdd python3 to the list of available packages\r\n\r\n## How to verify\r\ncd docker\r\ndocker build --build-arg BK_VERSION=4.12.1 -t testbk .\r\n\r\nFixes #2601 \n\nReviewers: Andrey Yegorov <None>\n\nThis closes #2609 from eolivelli/fix/docker-image-python3","Date":"Thu Feb 18 00:18:51 CET 2021"},{"Commit-ID":"commit 1d2e9719469180ce5a283bdd4f5207adc15cca73 1614153310 -----sp","Author":"PersonIdent[Henry Saputra, hsaputra@apache.org, Tue Feb 23 23:55:10 2021 -0800]","Body":"Update the NOTICE file to 2021 for copyright.\n\nVery simple fix to update the year in the NOTICE file to 2021.\r\n\r\nFixes #2624 \n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2621 from hsaputra/update_notice_year_2021","Date":"Wed Feb 24 08:55:10 CET 2021"},{"Commit-ID":"commit 7e9b393c7f16c9beca486971828931457b82eb9e 1614276762 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Thu Feb 25 10:12:42 2021 -0800]","Body":"Doc and release notes update for 4.13\n\nDescriptions of the changes in this PR:\r\n\r\nrelease 4.13\r\n\r\nRelease notes file is site/docs/4.13.0/overview/releaseNotes.md\r\n\r\n### Motivation and changes\r\n\r\nUpdating docs and release notes for 4.13\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2607 from dlg99/master-4.13-doc2 and squashes the following commits:\n\nb70b9c41e [Andrey Yegorov] Doc and release notes update for 4.13\n23b268906 [Andrey Yegorov] [maven-release-plugin] prepare for next development iteration","Date":"Thu Feb 25 19:12:42 CET 2021"},{"Commit-ID":"commit 54b219143c2e19fe8b4076a7396dc34d17a8e62c 1614277200 -----sp","Author":"PersonIdent[Andrey Yegorov, andrey.yegorov@datastax.com, Thu Feb 25 10:20:00 2021 -0800]","Body":"Release 4.13 update\n","Date":"Thu Feb 25 19:20:00 CET 2021"},{"Commit-ID":"commit 09b3105640bfe6d0ccd11aff9c6030f110c62295 1614847672 -----sp","Author":"PersonIdent[Anup Ghatage, ghatage@apache.org, Thu Mar 4 00:47:52 2021 -0800]","Body":"Make Bookkeeper FIPS compliant by default\n\nDescriptions of the changes in this PR:\r\nMailing list thread: [link](http://mail-archives.apache.org/mod_mbox/bookkeeper-dev/202102.mbox/browser)\r\n\r\n### Motivation\r\n\r\nFIPS is 'Federal Information Processing Standard'. Basically it's a set of guidelines for security functions such as encryption/decryption/RNG etc. Applications running in FIPS mode are said to be more secure as they adhere to more stringent standards.\r\n\r\nJava's security framework is extensible via the JCE (Java crypto extension) allows us to use libraries which implement these functions. In general we use BouncyCastle as it has an active, supportive community and also maintains the fips versions of their libraries.\r\n\r\nPulsar currently has FIPS support but it's not on by default, I had a chat with jiazhai about it and he mentioned that there is no specific reason as to why we run without it.\r\n\r\nThis is an attempt to get Apache BookKeeper FIPS compliant by default. If all tests pass and there are no performance regressions, we can merge this in.\r\n\r\n### Changes\r\n\r\n- Added dependency of FIPS approved BouncyCastle\r\n- Excluded the use of non FIPS BouncyCastle libraries.\r\n- Added flag to start up script which will make it fips compliant.\r\n\n\nReviewers: Henry Saputra <hsaputra@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2631 from Ghatage/fipsCompliance","Date":"Thu Mar 04 09:47:52 CET 2021"},{"Commit-ID":"commit 7327e3b1c636ed42bdbe231fc30bcb73e527fee8 1614847854 -----sp","Author":"PersonIdent[Michal Koziorowski, mkozioro@users.noreply.github.com, Thu Mar 4 09:50:54 2021 +0100]","Body":"Fix NetworkTopologyImpl#getLeaves returning set with null value in case of non existing scope\n\nDescriptions of the changes in this PR:\r\n\r\nNetworkTopologyImpl#getLeaves(String scope) was returning set with null value, when requested scope did not exist.\r\nI've added null check in NetworkTopologyImpl#doGetLeaves(String scope), used by NetworkTopologyImpl#getLeaves method to not have null node returned as leaf node.\r\n\r\nIt would be nice to have this merged also with non master branch of bookeeper so maintenance releases could have that fix.\r\n\r\n### Motivation\r\nI've found my Apache Pulsar cluster polluted with log:\r\n```\r\n 12:01:46.462 pulsar2-dev pulsar-broker {\"logLevel\":\"ERROR\",\"logThread\":\"pulsar-io-23-1\",\"logger\":\"org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl\",\"message\":\"found non-BookieNode: null as leaf of defaultrack: /default-rack\",\"stack_trace\":null}\r\n```\r\n\r\nAfter digging I've found that, because https://github.com/apache/bookkeeper/blob/master/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java#L324\r\nwas returning HashSet with null node, when no bookkeepers were in /default-rack.\r\n\r\n### Changes\r\n- Modified doGetLeaves() method to return empty HashSet instead of HashSet with null element when scope node can't be found.\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Andrey Yegorov <andrey.yegorov@datastax.com>\n\nThis closes #2632 from mkozioro/fix-do-get-leaves","Date":"Thu Mar 04 09:50:54 CET 2021"},{"Commit-ID":"commit c62eacf911d60e1121e506659a0864310dce4439 1614982012 -----sp","Author":"PersonIdent[pkumar-singh, 65131575+pkumar-singh@users.noreply.github.com, Fri Mar 5 14:06:52 2021 -0800]","Body":"BP-43 CI/CD migration to gradle (#2639)\n\nCo-authored-by: Prashant <prashantk@splunk.com>","Date":"Fri Mar 05 23:06:52 CET 2021"},{"Commit-ID":"commit 346e375f80322e5f328eafd4cb4040f177b6973b 1615166107 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Mon Mar 8 09:15:07 2021 +0800]","Body":"Allow DBLedgerStorage to force GC by disk listener (#2627)\n\n* Allow DBLedgerStorage to force GC by disk listener\r\n---\r\n\r\n(If this PR fixes a github issue, please add `Fixes #<xyz>`)\r\n\r\nFixes #2596\r\n\r\n*Motivation*\r\n\r\nThe isForceGCAllowWhenNoSpace does not work for the DBLedgerStorage.\r\nCurrently, the behavior of the isForceGCAllowWhenNoSpace is It is a\r\ndisk listener to decide whether to start the compaction task while\r\nthe disk of the Ledger almost full. It should be the same behavior\r\nwhen we call gc endpoint manually.\r\n\r\n*Modifications*\r\n\r\n- Add dir listener for the SignleDirectoryDbledgerStorage\r\n\r\n* Add listener number tests","Date":"Mon Mar 08 02:15:07 CET 2021"},{"Commit-ID":"commit 98df593ba432eb08b18d98331201099cc72879dc 1615201458 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Mon Mar 8 19:04:18 2021 +0800]","Body":"Allow force compact entry log when disabling entry log compaction\n\n---\r\n\r\nMaster Issue: #2596\r\n\r\n*Motivation*\r\n\r\nSometimes user will disable the entry log compaction to reduce the\r\nI/O load. But we should allow forcing compact the entry even if\r\nthe entry log compaction is disabled.\r\n\r\n*Modifications*\r\n\r\n- Add a configuration to allow force compaction\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Jia Zhai <zhaijia@apache.org>, lipenghui <penghui@apache.org>\n\nThis closes #2626 from zymap/allow-force-gc-without-interval","Date":"Mon Mar 08 12:04:18 CET 2021"},{"Commit-ID":"commit c11baba7dcedc227849021d0aee8303cfcc9765c 1615288001 -----sp","Author":"PersonIdent[Surinder Singh, sursingh@gmail.com, Tue Mar 9 03:06:41 2021 -0800]","Body":"Handle corrupted checkpoints\n\n### Motivation\r\n\r\nIf a checkpoint is corrupted, checkpoint restoration will fail. Currently we will keep\r\nretrying to restore the same checkpoint. The system will never recover from this.\r\nThe only way out is to manually remove the checkpoint from the zookeeper\r\n\r\n### Changes\r\n\r\nWhen a checkpoint is corrupted, we need to try and restore from previous checkpoint.\r\nThis  is done recursively till we hit a checkpoint that works. If none of the checkpoints\r\nwork, we will fallback to a `nullcheckpoint` which will initialize rocksdb from scratch\r\nand replay all state from journal.\r\n\r\nInstead of just dealing with the latest checkpoint, we now return a list of checkpoints\r\nordered by age. We then simply walk this list and stop as soon as a checkpoint is\r\nsuccessfully restored. We currently only keep a single checkpoint,  but with this change\r\nwe can potentially keep `N` checkpoints to provide more robustness. \r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Andrey Yegorov <andrey.yegorov@datastax.com>\n\nThis closes #2635 from sursingh/currupt-checkpoint","Date":"Tue Mar 09 12:06:41 CET 2021"},{"Commit-ID":"commit 017307bc67431a7616861ad09927c4e3327633d1 1615533631 -----sp","Author":"PersonIdent[Jack Vanlightly, vanlightly@gmail.com, Thu Mar 11 23:20:31 2021 -0800]","Body":"Add fencing to recovery reads to avoid data loss issue\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nAdding the fencing flag to recovery reads avoids a data loss scenario as described in [issue 2614](https://github.com/apache/bookkeeper/issues/2614)\r\n\r\n### Changes\r\n\r\nAdded the fencing flag to recovery reads. Refactored some mocking unit test code to introduce fencing and allow two writers to share the same bookie state. Added a new unit to verify the fix. You can recreate the initial problem by removing the fencing flag from recovery reads and running the new unit test.\r\n\r\nMaster Issue: #2614\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Andrey Yegorov <andrey.yegorov@datastax.com>\n\nThis closes #2616 from Vanlightly/fix-fencing","Date":"Fri Mar 12 08:20:31 CET 2021"},{"Commit-ID":"commit 21f7d6e11481f7bd524d8217b51746d3cc95651e 1616022766 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Mar 17 16:12:46 2021 -0700]","Body":"Fixed get-pip URL in Dockerfile (#2651)\n\n","Date":"Thu Mar 18 00:12:46 CET 2021"},{"Commit-ID":"commit 191adfc22c67285927d60da61b4a8f6567ebdb9f 1616091322 -----sp","Author":"PersonIdent[hangc0276, hangc0276@163.com, Fri Mar 19 02:15:22 2021 +0800]","Body":"adjust default rocksDbBlockCache size to 10%/numberOfLedgers of direct memory (#2643)\n\n* adjust default rocksDbBlockCache size to 10%/numberOfLedgers of direct memory instead of 10% of direct memory\r\n\r\n* update bk_server configuration doc\r\n\r\nCo-authored-by: Matteo Merli <mmerli@apache.org>","Date":"Thu Mar 18 19:15:22 CET 2021"},{"Commit-ID":"commit ec257fc9b2840e2dd18ec4d8068c7319c405c3a0 1616091376 -----sp","Author":"PersonIdent[Michael Marshall, 47911938+michaeljmarshall@users.noreply.github.com, Thu Mar 18 12:16:16 2021 -0600]","Body":"Issue 2622: Fix usage of JournalQueueSize and JournalCbQueueSize; JournalCbQueueSize should be bounded (#2623)\n\n* Fix usage of JournalQueueSize and JournalCBQueueSize; JournalCBQueueSize should be bounded\r\n\r\n* Fix capitalization","Date":"Thu Mar 18 19:16:16 CET 2021"},{"Commit-ID":"commit 3f1b73968d1b921646f5cfd2a249382da49a3392 1616091906 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Mar 18 11:25:06 2021 -0700]","Body":"Limit read-ahead bytes to the size of the read cache (#2647)\n\n* Limit read-ahead bytes to the size of the read cache\r\n\r\n* Update bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java\r\n\r\nCo-authored-by: lipenghui <penghui@apache.org>\r\n\r\nCo-authored-by: lipenghui <penghui@apache.org>","Date":"Thu Mar 18 19:25:06 CET 2021"},{"Commit-ID":"commit de0982970ea59cc16e3694db329f122b1330dc20 1616094133 -----sp","Author":"PersonIdent[Surinder Singh, sursingh@gmail.com, Thu Mar 18 12:02:13 2021 -0700]","Body":"Add checksum validation for SST files (#2641)\n\nNormally the SST file are immutable. A SST file from previous checkpoint can\r\nbe reused in subsequent checkpoints. This fact is used to avoid unnecessary\r\nupload of SST files.\r\n\r\nHowever there are scenarios in which just the name comparison doesn't work.\r\nIt is possible that the checkpoint process doesn't complete (due to\r\ncrash/restart). In such cases the stale SST files are left behind. When the\r\nstorage container is restarted, it will be correctly restored from previous\r\ncheckpoint. When we do a checkpoint on this new state, a new SST files\r\nare created. Since we only compare the SST file names, we assume that files is\r\nalready available in the checkpoint store.\r\n\r\nAt best the size of the new files will mismatch, and restore will fail. But if\r\nthe size of the files match, restore will succeed and we will have invalid\r\ndata in the state store.\r\n\r\nWith this change we are adding the checksum for the SST files. The checksum\r\nwill be appended to the name when the SST file is uploaded. This will ensure\r\nthat the correct files are always uploaded\r\n\r\nCo-authored-by: Surinder Singh <surinders@splunk.com>","Date":"Thu Mar 18 20:02:13 CET 2021"},{"Commit-ID":"commit 0285d7af7183f83e4dace6bdd16b7793b7e2a4c6 1616101716 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Mar 18 14:08:36 2021 -0700]","Body":"Auto-throttle read operations (#2646)\n\n* Auto-throttle read operations\r\n\r\n* Fixed checkstyle issues\r\n\r\n* More checkstyle fix\r\n\r\n* Renamed variable\r\n\r\n* Fix after var name changed","Date":"Thu Mar 18 22:08:36 CET 2021"},{"Commit-ID":"commit 1343a87854f2cd0e145569a7c9755d0fc194ab22 1616173310 -----sp","Author":"PersonIdent[Prashant Kumar, 65131575+pkumar-singh@users.noreply.github.com, Fri Mar 19 10:01:50 2021 -0700]","Body":"BP-43 CI/CD migration to gradle (#2636)\n\nGradle: Build bookkeeper-server with gradle and run unit tests\r\n\r\nCo-authored-by: Prashant <prashantk@splunk.com>","Date":"Fri Mar 19 18:01:50 CET 2021"},{"Commit-ID":"commit 79a9aff42a16512c9ad9d48609fbd973b4083965 1616533454 -----sp","Author":"PersonIdent[Prashant Kumar, 65131575+pkumar-singh@users.noreply.github.com, Tue Mar 23 14:04:14 2021 -0700]","Body":"ISSUE-2640: BP-43: Build :stream source with gradle (#2657)\n\nAdd maven publication with the group and artifact ids fixed up to what\r\nmaven was generating.\r\n\r\nCo-authored-by: Ivan Kelly <ikelly@splunk.com>","Date":"Tue Mar 23 22:04:14 CET 2021"},{"Commit-ID":"commit 3e1507eb862ab5b7d23c15107d36a10ebe14eadd 1616533560 -----sp","Author":"PersonIdent[Lari Hotari, lhotari@users.noreply.github.com, Tue Mar 23 23:06:00 2021 +0200]","Body":"Upgrade Lombok version (#2656)\n\n- 1.18.18 includes fixes for IDE compatibility (IntelliJ, Eclipse, Netbeans).\r\n  This is relevant while developing Bookkeeper.\r\n  - see https://projectlombok.org/changelog for more details","Date":"Tue Mar 23 22:06:00 CET 2021"},{"Commit-ID":"commit 5b90867c91abb95df6957ee79ffbb494db9321e8 1616611783 -----sp","Author":"PersonIdent[Prashant Kumar, 65131575+pkumar-singh@users.noreply.github.com, Wed Mar 24 11:49:43 2021 -0700]","Body":"ISSUE-2640: BP-43: Gradle: Run tests in :stream gradle (#2659)\n\n* Make gradle use os specific paths in build\r\n\r\n* ISSUE-2640: BP-43: make unit tests run with gradle.\r\n\r\nCo-authored-by: Ali Ahmed <alahmed.se@gmail.com>\r\nCo-authored-by: Prashant Kumar <prashantk@splunk.com>","Date":"Wed Mar 24 19:49:43 CET 2021"},{"Commit-ID":"commit 8128bdf48ff50878f78bd59af58ed8d9c39bd8b1 1616701728 -----sp","Author":"PersonIdent[Ali Ahmed, alahmed.se@gmail.com, Thu Mar 25 12:48:48 2021 -0700]","Body":"Fix settings.gradle formatting (#2661)\n\nCo-authored-by: Ali Ahmed <alia@splunk.com>","Date":"Thu Mar 25 20:48:48 CET 2021"},{"Commit-ID":"commit 1a4c47df705085a19921de3a96a684830ee2b701 1616786051 -----sp","Author":"PersonIdent[Surinder Singh, sursingh@gmail.com, Fri Mar 26 12:14:11 2021 -0700]","Body":"Migrate bookkeeper-benchmark and stats module to gradle (#2662)\n\nCo-authored-by: Surinder Singh <surinders@splunk.com>","Date":"Fri Mar 26 20:14:11 CET 2021"},{"Commit-ID":"commit 6f6b17e5da7fae874febe18fb1524a12f315d043 1616894470 -----sp","Author":"PersonIdent[Prashant Kumar, 65131575+pkumar-singh@users.noreply.github.com, Sat Mar 27 18:21:10 2021 -0700]","Body":"ISSUE-2640: BP-43: Run integration tests with current source code. Build BKCTL. (#2663)\n\nCo-authored-by: Prashant <prashantk@splunk.com>","Date":"Sun Mar 28 03:21:10 CEST 2021"},{"Commit-ID":"commit 840043031cfc6d7153b98aeab42dd3f1404f34fb 1616894486 -----sp","Author":"PersonIdent[Masahiro Sakamoto, massakam@yahoo-corp.jp, Sun Mar 28 10:21:26 2021 +0900]","Body":"Correct the argument of the recover command of bookie shell (#2653)\n\n","Date":"Sun Mar 28 03:21:26 CEST 2021"},{"Commit-ID":"commit c9541086de1a6e402a1aa437a2d57173edaf8132 1617085871 -----sp","Author":"PersonIdent[Surinder Singh, sursingh@gmail.com, Mon Mar 29 23:31:11 2021 -0700]","Body":"Fix a typo in bookkeeper script\n\n### Motivation\r\n\r\nBookkeeper script is failing to start. The variable is not being interpreted as a string. Instead we trying to run this as command and failing.\r\n\r\n```\r\n$ ./bin/bookkeeper localbookie 3\r\nJAVA_HOME not set, using java from PATH. (/usr/bin/java)\r\n./bin/bookkeeper: line 149: BOOKIE_EXTRA_OPTS: command not found\r\n./bin/bookkeeper: line 149: -Dorg.bouncycastle.fips.approved_only=true: command not found\r\n```\r\n\r\n### Changes\r\n\r\nAdd quotes around the variable definition.\r\n\r\n\n\nReviewers: Matteo Merli <mmerli@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2667 from sursingh/fix-bookkeeper-script","Date":"Tue Mar 30 08:31:11 CEST 2021"},{"Commit-ID":"commit 1ae510dcda369b7a744945ab9d61e242c7b0e941 1617210478 -----sp","Author":"PersonIdent[Surinder Singh, sursingh@gmail.com, Wed Mar 31 10:07:58 2021 -0700]","Body":"Build distributions with gradle (#2666)\n\nBuilding:\r\n```\r\n./gradlew :bookkeeper-dist-src:distTar :bookkeeper-dist-server:distTar :bookkeeper-dist-bkctl:distTar :bookkeeper-dist-all:distTar\r\n```\r\n\r\nThe package can be found under corresponding build/distributions\r\n```\r\n$ find bookkeeper-dist -name *.tar.gz -path *distributions*\r\nbookkeeper-dist/bkctl/build/distributions/bkctl-4.14.0-SNAPSHOT.tar.gz\r\nbookkeeper-dist/all/build/distributions/bookkeeper-all-4.14.0-SNAPSHOT.tar.gz\r\nbookkeeper-dist/server/build/distributions/bookkeeper-server-4.14.0-SNAPSHOT.tar.gz\r\nbookkeeper-dist/build/distributions/bookkeeper-4.14.0-SNAPSHOT-src.tar.gz\r\n```\r\n\r\nCo-authored-by: Surinder Singh <surinders@splunk.com>","Date":"Wed Mar 31 19:07:58 CEST 2021"},{"Commit-ID":"commit 2722c9bfed3396f7fa0785c5e8e412fd412f03c0 1617259364 -----sp","Author":"PersonIdent[Kevin Wilson, klwilson227@comcast.net, Thu Apr 1 00:42:44 2021 -0600]","Body":"Defect-Fix Compaction status report into correct buckets. (#2645)\n\nThe compaction status report is off by 1.\r\n\r\nWhen compaction is enabled, the 10% log is always empty. Setting the compaction threshold to .2 we were seeing the number of compacted entrylogs that were removed, match the sum of the 20% and 30% buckets. While the 10% bucket remained empty. Increasing the threshold to .3 we would see the sum of the first 4 buckets compacted (10%-40%). Also with the 10% bucket empty.\r\n\r\nUpon inspection of the code, the code is using the .ceil function to calculate the bucket index to be updated. This means that 10% bucket will never be used. However, there could be a rare 100% case in which the code runs into a index out of bounds exception when the entrylog is actually 100% used. The index calculation should be using floor and not the ceil call using the next index lower. So usage of .00 to .9 ends up in the 0 index instead of the current calculation which puts the .0 - .9 in the 1 index.\r\n\r\nThis will leave the 100% index empty most of the time, as rarely will the entry logs be 100% used.","Date":"Thu Apr 01 08:42:44 CEST 2021"},{"Commit-ID":"commit 6eadbaac1806cebcf658a740b6dd7277a24e4fdb 1617643324 -----sp","Author":"PersonIdent[Surinder Singh, sursingh@gmail.com, Mon Apr 5 10:22:04 2021 -0700]","Body":"sign published packages (#2674)\n\nAdd signing plugin to sign artifacts using PGP. For details see\r\nhttps://docs.gradle.org/current/userguide/signing_plugin.html\r\n\r\nThis was testing by publishing to local maven repository:\r\n```\r\n$ gradlew bookkeeper-server:publishMavenPublicationToMavenLocal\r\n\r\n$ ls -ln ~/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.14.0-SNAPSHOT/\r\ntotal 10568\r\n-rw-r--r--  1 501  20  1596624 Mar 31 13:07 bookkeeper-server-4.14.0-SNAPSHOT-tests.jar\r\n-rw-r--r--  1 501  20      650 Mar 31 13:07 bookkeeper-server-4.14.0-SNAPSHOT-tests.jar.asc\r\n-rw-r--r--  1 501  20  2254279 Mar 31 13:07 bookkeeper-server-4.14.0-SNAPSHOT.jar\r\n-rw-r--r--  1 501  20      650 Mar 31 13:07 bookkeeper-server-4.14.0-SNAPSHOT.jar.asc\r\n-rw-r--r--  1 501  20     6983 Mar 31 13:07 bookkeeper-server-4.14.0-SNAPSHOT.module\r\n-rw-r--r--  1 501  20      650 Mar 31 13:07 bookkeeper-server-4.14.0-SNAPSHOT.module.asc\r\n-rw-r--r--  1 501  20     6251 Mar 31 13:07 bookkeeper-server-4.14.0-SNAPSHOT.pom\r\n-rw-r--r--  1 501  20      650 Mar 31 13:07 bookkeeper-server-4.14.0-SNAPSHOT.pom.asc\r\n-rw-r--r--  1 501  20     1817 Mar 31 13:07 maven-metadata-local.xml\r\n\r\n```\r\n\r\nsigning can be disable using following using `ORG_GRADLE_PROJECT_skipSigning`:\r\n\r\n```\r\nORG_GRADLE_PROJECT_skipSigning=1 gradlew :bookkeeper-server:publishMavenPublicationToMavenLoca\r\n```\r\n\r\nCo-authored-by: Surinder Singh <surinders@splunk.com>","Date":"Mon Apr 05 19:22:04 CEST 2021"},{"Commit-ID":"commit ae023fd5fab1f015229e475de106df46144bd4d0 1617681763 -----sp","Author":"PersonIdent[Kevin Wilson, klwilson227@comcast.net, Mon Apr 5 22:02:43 2021 -0600]","Body":"Issue 2638: Compaction Limits (#2670)\n\nThis resolves issue 2638, by allowing a customer to set a limit on the duration of the major and minor compaction runs. This allows the customer to balance the needs for compaction against the need for normal garbage collection. Unbounded execution of compaction can starve the garbage collection process, and may lead to extended periods of high disk IO. By setting a upper bound on the execution duration for the garbage collection, we can ensure a balance is maintained between both GC and Compaction processes.\r\n\r\nLogging has been improved to allow a user to see the complete usage of the buckets, vs. those that were compacted, so that they can decide on any further tuning that may be required.\r\n\r\nTest cases have been added to ensure limits are enforced properly and that defaulting of the values is correctly implemented.\r\n\r\n* 2638-CompactionLimits\r\n\r\n* align config parameters\r\n\r\n* Refactor Limit to MaxTimeMs","Date":"Tue Apr 06 06:02:43 CEST 2021"},{"Commit-ID":"commit 25264f997ef22d9f456a9b88832dfa6634927b60 1617681777 -----sp","Author":"PersonIdent[Kevin Wilson, klwilson227@comcast.net, Mon Apr 5 22:02:57 2021 -0600]","Body":"Fix logic in Bookkeeper forceAllowCompaction to run only when force is set or configured interval (#2675)\n\nWithout the attached fix, when forceAllowCompaction and isForceGCAllowWhenNoSpace are set. The majorCompaction runs with every garbage collection. This results due to the fact that enableMajorCompaction which takes a negative interval into account to disable compaction always returns true since the difference in time will always be larger than -1. The time check must be \"and\" with the enableMajorCompaciton for the time check to be valid. And the force flag may also be valid when the isForce(Major/Minor)CompactionAllow is set to true which will validate the threshold in the force case is set.","Date":"Tue Apr 06 06:02:57 CEST 2021"},{"Commit-ID":"commit a7506e38a46532c1e6ba2ac43b209ddbdd4727de 1617830681 -----sp","Author":"PersonIdent[Prashant Kumar, 65131575+pkumar-singh@users.noreply.github.com, Wed Apr 7 14:24:41 2021 -0700]","Body":"ISSUE-2640: BP-43 Build microbenchmark with gradle and run microbenchmark (#2673)\n\nCo-authored-by: Prashant <prashantk@splunk.com>","Date":"Wed Apr 07 23:24:41 CEST 2021"},{"Commit-ID":"commit 59786c97f247cf177dafad74b3a1c7784781be32 1617919964 -----sp","Author":"PersonIdent[Prashant Kumar, 65131575+pkumar-singh@users.noreply.github.com, Thu Apr 8 15:12:44 2021 -0700]","Body":"ISSUE #2640: BP-43: Exclude smoke tests for now can be enabled when we move to gradle.\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\n**Migrate bookkeeper to gradle.**\r\nCurrent smoke tests in OSS do not run and do not do anything useful. \r\nThey are quite old and need to move to testcontainer and away from Arquallian. \r\nThat requires code change. Therefore punting running these tests with gradle too, \r\nuntil everything moved to gradle. \r\n### Changes\r\n\r\nExclude Smoke tests from run.\r\n\r\nMaster Issue: #2640\r\n\r\n\n\nReviewers: Andrey Yegorov, Matteo Merli <mmerli@apache.org>\n\nThis closes #2671 from pkumar-singh/merge_internal_gradle_4, closes #2640","Date":"Fri Apr 09 00:12:44 CEST 2021"},{"Commit-ID":"commit acbc20dacf3d13c91a872c24e45d0c4d69bb9733 1617925341 -----sp","Author":"PersonIdent[Prashant Kumar, 65131575+pkumar-singh@users.noreply.github.com, Thu Apr 8 16:42:21 2021 -0700]","Body":"ISSUE #2640: BP-43 Integrate checkstyle with gradle\n\n### Motivation\r\n\r\n**Migrate bookkeeper to gradle.**\r\nCheckstyle is gradle as well as maven plugin which checks for code formatting spacing etc. \r\n**How to run** \r\n `./gradlew checkstyleMain  `\r\n\r\n### Changes\r\nIntegrate gradle build with checkstyle plugin\r\n\r\n\r\nMaster Issue: #2640\r\n\r\n\n\nReviewers: Henry Saputra <hsaputra@apache.org>, Matteo Merli <mmerli@apache.org>\n\nThis closes #2680 from pkumar-singh/merge_internal_gradle_checkstyle, closes #2640","Date":"Fri Apr 09 01:42:21 CEST 2021"},{"Commit-ID":"commit 19c86f20500a7fd9b4ce5ca42caf42337863f2a8 1617989420 -----sp","Author":"PersonIdent[Prashant Kumar, 65131575+pkumar-singh@users.noreply.github.com, Fri Apr 9 10:30:20 2021 -0700]","Body":"ISSUE #2640: BP-43 create shaded jar for bookkeeper-server and distrib\u2026\n\n\u2026utedlog-core\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n\r\n### Motivation\r\n**Gradle migration** \r\nWith maven shaded Jar was created for bookkeeper-sever as well as distributedlog-core.\r\nThough shaded jar was not being used by anybody.\r\nThere has been some difference in layout of shaded jar produced by maven and gradles.\r\n\r\nMaven produced shaded jar just shades bookkeeper classes and leaves transitive dependency unshaded and as part of dependency in POM file. This behavior is not supported in gradle shadow plugin. Therefore gradle produced shaded jar shades not only bookkeer-server but also its transitive and direct dependencies and leaving nothing in pom file as dependency. \r\n\r\n### Changes\r\nCreate gradle build for shading bookkeeper-sever and distributedlog-core\r\n\r\nMaster Issue: #2640 \r\n\n\nReviewers: Henry Saputra <hsaputra@apache.org>, Matteo Merli <mmerli@apache.org>\n\nThis closes #2678 from pkumar-singh/merge_internal_gradle_6, closes #2640 and squashes the following commits:\n\n3f9cb7e9f [Matteo Merli] Merge branch 'master' into merge_internal_gradle_6\nacbc20dac [Prashant Kumar] ISSUE #2640: BP-43 Integrate checkstyle with gradle\nf46021c4c [Prashant] ISSUE-2640: BP-43 create shaded jar for bookkeeper-server and distributedlog-core\n59786c97f [Prashant Kumar] ISSUE #2640: BP-43: Exclude smoke tests for now can be enabled when we move to gradle.","Date":"Fri Apr 09 19:30:20 CEST 2021"},{"Commit-ID":"commit d70153f760411b73712662b12cd3c30898c7516d 1618063639 -----sp","Author":"PersonIdent[hangc0276, hangc0276@163.com, Sat Apr 10 22:07:19 2021 +0800]","Body":"Update documentation with default value for openLedgerRereplicationGracePeriod config option\n\n### Motivation\r\n`openLedgerRereplicationGracePeriod` default value doc doesn't consistent with the code\r\n\r\n### Changes\r\n1. update default value doc for bk_server.conf\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Michael Marshall <None>, lipenghui <penghui@apache.org>\n\nThis closes #2644 from hangc0276/chenhang/fix_openLedgerRereplicationGracePeriod_default_value_doc","Date":"Sat Apr 10 16:07:19 CEST 2021"},{"Commit-ID":"commit 646e59089bc1fd881eff4cc0fb4070220d23dc86 1618243722 -----sp","Author":"PersonIdent[Prashant Kumar, 65131575+pkumar-singh@users.noreply.github.com, Mon Apr 12 09:08:42 2021 -0700]","Body":"ISSUE #2640: BP-43 integrate gradle javadoc plugin\n\n### Motivation\r\n\r\n**Migrate bookkeeper to gradle javadoc plugin.**\r\n\r\n**How to run** \r\n `./gradlew javadoc`\r\n\r\n### Changes\r\n- Integrate gradle build with javadoc plugin\r\n**Few points to note**\r\n\r\n- This integration is same/similar to the maven javadoc plugin integration.\r\n\r\nMaster Issue: #2640\r\n\n\nReviewers: Henry Saputra <hsaputra@apache.org>\n\nThis closes #2684 from pkumar-singh/merge_internal_gradle_javadoc, closes #2640","Date":"Mon Apr 12 18:08:42 CEST 2021"},{"Commit-ID":"commit 79768fee1c28d42f4883eb80c5ab6dd88e38a4f5 1618250812 -----sp","Author":"PersonIdent[Jack Vanlightly, vanlightly@gmail.com, Mon Apr 12 11:06:52 2021 -0700]","Body":"ISSUE #2615: Fix for invalid ensemble issue during ledger recovery\n\nEnsures that only entries of the current ensemble are included in the ledger recovery process, thus avoiding a ledger recovery failure scenario where it tries to append an ensemble with a lower first entry id than the prior ensemble.\r\n\r\nDescriptions of the changes in this PR:\r\n\r\nThis PR includes a small change in the LedgerRecoveryOp that avoids a scenario where ledger recovery tries to create an invalid ensemble thereby failing. This could cause data unavailability for as long as trigger conditions last.\r\n\r\nDuring ledger recovery, only entries of the current ensemble can be included in the read and write back phase. Prior ensembles, if any, are immutable. But it is possible, in a multi-ensemble ledger, for the current ensemble to return an LAC of -1. This then causes the recovery to read entries from prior ensembles and write them back to the current ensemble. This does not cause any data loss, but it is wasteful of both space and time. The main issue is that if an ensemble change occurs when writing back entries, it will try and create a new ensemble with first entry id of 0. This causes an IllegalStateException as there is a check before the CAS metadata op to ensure that the ensemble does not have an entry id lower than an existing ensemble.\r\n\r\nIf a bookie of the current ensemble were to be down, then the ledger would be unrecoverable until it became available again. \r\n\r\nThe solution is that the lowest safe LAC for recovery is: first entry id of current ensemble - 1.\r\n\r\n### Changes\r\n\r\nChange to LedgerRecoveryOp as described above.\r\nNew unit test in LedgerRecoveryTest2.\r\n\r\nMaster Issue: #2615\r\n\n\nReviewers: Andrey Yegorov, Enrico Olivelli <eolivelli@gmail.com>, Flavio Junqueira\n\nThis closes #2654 from Vanlightly/fix-invalid-ensemble-change, closes #2615","Date":"Mon Apr 12 20:06:52 CEST 2021"},{"Commit-ID":"commit 2dd4afecdf0a518e417c4eea695dbf8a2e7c9a16 1618252614 -----sp","Author":"PersonIdent[Prashant Kumar, 65131575+pkumar-singh@users.noreply.github.com, Mon Apr 12 11:36:54 2021 -0700]","Body":"ISSUE-2640: BP-43: Gradle integration with RAT plugin (#2683)\n\nCo-authored-by: Prashant <prashantk@splunk.com>\r\nCo-authored-by: Matteo Merli <mmerli@apache.org>","Date":"Mon Apr 12 20:36:54 CEST 2021"},{"Commit-ID":"commit f1a1f12195d8538338d000dba71fb2e98de0afbb 1618256536 -----sp","Author":"PersonIdent[Surinder Singh, sursingh@gmail.com, Mon Apr 12 12:42:16 2021 -0700]","Body":"staging and setting up vote for release candidates (#2681)\n\nThis change automates staging of release candidate. The artifacts are staged\r\nto SVN and nexus repositories.\r\n\r\nThis change uses\r\nhttps://github.com/vlsi/vlsi-release-plugins/blob/master/plugins/stage-vote-release-plugin/README.md.\r\n\r\nPreparing release candidate:\r\n\r\n1. Checkout release branch: `git checkout -b branch-4.14 origin/branch-4.14`\r\n2. Update the version in version.gradle and commit the change\r\n3. Create and stage release candidate. This will build and upload all release\r\nartifacts to staging areas under nexus and SVN repos.  A template for Vote\r\nemail will also be generated. Link to the release notes will need to be\r\nupdated in the email template. A release candidate tag  will also be added.\r\n```\r\n./gradlew prepareVote -Pasf -Prc=1\r\n```\r\n4. If needed additional release candidates can be create by running the above\r\ncommand with appropriate `rc` value\r\n5. Once the voting is done, the release can be published using:\r\n```\r\n./gradlew publishDist -Pasf -Prc=1\r\n```\r\n6. Remove stale artifacts:\r\n```\r\n./gradlew removeStaleArtifacts -Pasf\r\n```\r\n\r\nConfiguration:\r\n\r\n* Following configuration can be added to $HOME/.gradle/gradle.properties.\r\n```\r\nsigning.gnupg.keyName=...\r\nasfCommitterId=...\r\nasfNexusUsername=...\r\nasfNexusPassword=...\r\nasfGitSourceUsername=...\r\nasfGitSourcePassword=...\r\nasfGitSitePreviewUsername=...\r\nasfGitSitePreviewPassword=...\r\nasfSvnUsername=...\r\nasfSvnPassword=...\r\n```\r\n* The above config can also be passed from commandline `-P<property>=<value>`\r\n\r\nTesting:\r\n\r\nThe change was testing useing a local setup based on\r\nhttps://github.com/vlsi/asflike-release-environment\r\n\r\nCo-authored-by: Surinder Singh <surinders@splunk.com>\r\nCo-authored-by: Matteo Merli <mmerli@apache.org>","Date":"Mon Apr 12 21:42:16 CEST 2021"},{"Commit-ID":"commit 9256dbab334dd1e8b60fc575fa22e0559f47f6f7 1618418975 -----sp","Author":"PersonIdent[Lari Hotari, lhotari@users.noreply.github.com, Wed Apr 14 19:49:35 2021 +0300]","Body":"Add current ip address, long hostname and short hostname to /etc/hosts (#2688)\n\n- Fixes reverse DNS lookup for current hostname","Date":"Wed Apr 14 18:49:35 CEST 2021"},{"Commit-ID":"commit f489a056d344e0d86d5082a4a9cb752ceaa98c74 1618520932 -----sp","Author":"PersonIdent[Surinder Singh, sursingh@gmail.com, Thu Apr 15 14:08:52 2021 -0700]","Body":"Fix test cases using gradle build (#2689)\n\nCo-authored-by: Surinder Singh <surinders@splunk.com>","Date":"Thu Apr 15 23:08:52 CEST 2021"},{"Commit-ID":"commit 44b1069e20ce6cc84302ed685936080f612bd8f0 1618605931 -----sp","Author":"PersonIdent[Prashant Kumar, 65131575+pkumar-singh@users.noreply.github.com, Fri Apr 16 13:45:31 2021 -0700]","Body":"ISSUE #2640: BP-43 Integrate spotbugs plugin with gradle\n\n### Motivation\r\n\r\n**Migrate bookkeeper to gradle spotbug plugin.**\r\nspotbugs is gradle as well as maven plugin which checks for obvious bugs in source code.\r\n**How to run** \r\n `./gradlew spotbugsMain `\r\n\r\n### Changes\r\n\r\n- Integrate gradle build with spotbugs plugin\r\n- Second commit is for fixing issues reported by spotbugs plugin \r\n\r\n### Test\r\nJust to validate it's working. \r\nI introduced following bug.\r\n ```\r\npublic void test() {\r\n+\r\n+        String[] field = {\"a\", \"b\", \"c\", \"s\", \"e\"};\r\n+\r\n+        //concatenates strings using + in a loop\r\n+        String ip = \"127.0.0.1\";\r\n+        String s = \"\";\r\n+        for (int i = 0; i < field.length; ++i) {\r\n+            s = s + field[i];\r\n+        }\r\n+\r\n+        System.out.println(ip);\r\n+\r\n+    }\r\n```\r\n\r\nspotbugs plugin reported following violation.\r\n```\r\n<BugInstance type=\"SBSC_USE_STRINGBUFFER_CONCATENATION\" priority=\"2\" rank=\"18\" abbrev=\"SBSC\" category=\"PERFORMANCE\" instanceHash=\"2aa8e4ebcc4cd86190fe3e7bd8a4913c\" instanceOccurrenceNum=\"0\" instanceOccurrenceMax=\"0\">\r\n    <ShortMessage>Method concatenates strings using + in a loop<\/ShortMessage>\r\n    <LongMessage>org.apache.bookkeeper.meta.LongZkLedgerIdGenerator.test() concatenates strings using + in a loop<\/LongMessage>\r\n    <Class classname=\"org.apache.bookkeeper.meta.LongZkLedgerIdGenerator\" primary=\"true\">\r\n      <SourceLine classname=\"org.apache.bookkeeper.meta.LongZkLedgerIdGenerator\" start=\"58\" end=\"350\" sourcefile=\"LongZkLedgerIdGenerator.java\" sourcepath=\"org/apache/bookkeeper/meta/LongZkLedgerIdGenerator.java\" relSourcepath=\"java/org/apache/bookkeeper/meta/LongZkLedgerIdGenerator.java\">\r\n        <Message>At LongZkLedgerIdGenerator.java:[lines 58-350]<\/Message>\r\n      <\/SourceLine>\r\n      <Message>In class org.apache.bookkeeper.meta.LongZkLedgerIdGenerator<\/Message>\r\n    <\/Class>\r\n```\r\nMaster Issue: #2640\r\n\r\n\n\nReviewers: Henry Saputra <hsaputra@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2682 from pkumar-singh/merge_internal_gradle_spotbugs, closes #2640 and squashes the following commits:\n\n588373241 [Prashant] Fix for gradle spotbug plugin found violation\n2bc79b067 [Prashant] ISSUE-2640: BP-43 Gradle migration integrating with spotbug gradle plugin\nf1a1f1219 [Surinder Singh] staging and setting up vote for release candidates (#2681)\n2dd4afecd [Prashant Kumar] ISSUE-2640: BP-43: Gradle integration with RAT plugin (#2683)\n79768fee1 [Jack Vanlightly] ISSUE #2615: Fix for invalid ensemble issue during ledger recovery\n646e59089 [Prashant Kumar] ISSUE #2640: BP-43 integrate gradle javadoc plugin\nd70153f76 [hangc0276] Update documentation with default value for openLedgerRereplicationGracePeriod config option","Date":"Fri Apr 16 22:45:31 CEST 2021"},{"Commit-ID":"commit 874a38b738773ff873f127a0e63fafd7a4ca4299 1618850542 -----sp","Author":"PersonIdent[mauricebarnum, maurice.barnum@gmail.com, Mon Apr 19 09:42:22 2021 -0700]","Body":"Rocksdb tombstones\n\n### Motivation\r\n\r\nAfter deleting many ledgers, seeking to the end of the RocksDB metadata can take a long time and trigger timeouts upstream. Address this by improving the seek logic as well as compacting out tombstones in situations where we've just deleted many entries.  This affects the entry location index and the ledger metadata index.\r\n\n\nReviewers: Andrey Yegorov, Prashant Kumar\n\nThis closes #2686 from mauricebarnum/rocksdb-tombstones and squashes the following commits:\n\nc02996853 [Maurice Barnum] Partially compact RocksDB after removing deleted ledgers\n0be68a1d0 [Maurice Barnum] KeyValueStorageRocksDB bounded key iterator: use RocksDB upper bound\n0c5ef8f53 [Maurice Barnum] KeyValueStorageRocksDB.getFloor() - reimplement to avoid two seeks\n114cc73b4 [Maurice Barnum] update rocksdb to 6.16.4\nf489a056d [Surinder Singh] Fix test cases using gradle build (#2689)\n9256dbab3 [Lari Hotari] Add current ip address, long hostname and short hostname to /etc/hosts (#2688)\nf1a1f1219 [Surinder Singh] staging and setting up vote for release candidates (#2681)\n2dd4afecd [Prashant Kumar] ISSUE-2640: BP-43: Gradle integration with RAT plugin (#2683)\n79768fee1 [Jack Vanlightly] ISSUE #2615: Fix for invalid ensemble issue during ledger recovery\n646e59089 [Prashant Kumar] ISSUE #2640: BP-43 integrate gradle javadoc plugin\nd70153f76 [hangc0276] Update documentation with default value for openLedgerRereplicationGracePeriod config option","Date":"Mon Apr 19 18:42:22 CEST 2021"},{"Commit-ID":"commit eb2443e5654e2e3ce174f3e767f56093f417f86f 1618959253 -----sp","Author":"PersonIdent[Prashant Kumar, 65131575+pkumar-singh@users.noreply.github.com, Tue Apr 20 15:54:13 2021 -0700]","Body":"ISSUE #2640: BP-43 Some clean up and making sure that all bookkeepr-se\u2026\n\n### Motivation\r\nConsolidate and ensure that at last all bookkeeper server test pass with gradle. \r\nThat essentially entails cleaning up direct dependencies.\r\n\r\n### Changes\r\n\r\n % ./gradlew cleanTest bookkeeper-server:test\r\n\r\n0\r\n<============-> 99% EXECUTING [2m 54s]\r\n<============-> 99% EXECUTING [9m 52s]\r\n<============-> 99% EXECUTING [36m 52s]\r\n<============-> 99% EXECUTING [54m 24s]\r\n<============-> 99% EXECUTING [54m 25s]ompleted, 16 skipped\r\n<============-> 99% EXECUTING [1h 3m 16s]\r\n<============-> 99% EXECUTING [1h 6m 39s]\r\n<============-> 99% EXECUTING [1h 14m 37s]\r\n<============-> 99% EXECUTING [1h 14m 38s]leted, 19 skipped\r\n<============-> 99% EXECUTING [1h 20m 59s]\r\n<============-> 99% EXECUTING [1h 21m 0s]\r\n\r\nI interrupted the tests after 777 tests after rebasing. But all the tests have passed before with same set of changes.\r\n\r\nMaster Issue: #2640\r\n\n\nReviewers: Henry Saputra <hsaputra@apache.org>, Matteo Merli <mmerli@apache.org>\n\nThis closes #2692 from pkumar-singh/build_tests, closes #2640","Date":"Wed Apr 21 00:54:13 CEST 2021"},{"Commit-ID":"commit a832ed5026fe5c556861a55a6f2a7768630fb36d 1619044709 -----sp","Author":"PersonIdent[Lari Hotari, lhotari@users.noreply.github.com, Thu Apr 22 01:38:29 2021 +0300]","Body":"[Build] Run PR builds for merge commit (#2690)\n\n- instead of running the build for PR branch HEAD commit,\r\n  run the commit for GitHub provided merge_commit_sha","Date":"Thu Apr 22 00:38:29 CEST 2021"},{"Commit-ID":"commit 3c9c7102538909fd3764ea7314e7618d6d9458fd 1619399761 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Sun Apr 25 18:16:01 2021 -0700]","Body":"Fixed unnecessary copy to heap, see https://github.com/apache/pulsar/pull/10330 (#2701)\n\nDescriptions of the changes in this PR:\r\n\r\nHandling CompositeByteBuf in a way that avoids unnecessary data copy.\r\n\r\n### Motivation\r\n\r\nhttps://github.com/apache/pulsar/pull/10330\r\n\r\nhttps://github.com/apache/pulsar/pull/10330#issuecomment-825619753\r\n\r\n### Changes\r\n\r\nHandling CompositeByteBuf in a way that avoids unnecessary data copy.","Date":"Mon Apr 26 03:16:01 CEST 2021"},{"Commit-ID":"commit c71cba795f2f000ae59097d017b4c10f5a4f0f03 1620023780 -----sp","Author":"PersonIdent[Lari Hotari, lhotari@users.noreply.github.com, Mon May 3 09:36:20 2021 +0300]","Body":"[SECURITY] Remove jackson-mapper-asl dependency to resolve multiple CVEs\n\n### Motivation\r\n\r\n- jackson-mapper-asl is not required since Zookeeper 3.6.x+ no more depends on jackson-mapper-asl library (ZOOKEEPER-3051)\r\n\r\n### Modifications\r\n\r\nRemove jackson-mapper-asl dependency\n\nReviewers: Matteo Merli <mmerli@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2694 from lhotari/lh-remove-jackson-mapper-asl","Date":"Mon May 03 08:36:20 CEST 2021"},{"Commit-ID":"commit e5e76667b0801fee42ccd0fe201fe72ce500a70d 1620067385 -----sp","Author":"PersonIdent[YANGLiiN, ielin@qq.com, Mon May 3 13:43:05 2021 -0500]","Body":"[DOC] fix the no striping occurs condition to Qw=E\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\nthe no striping occurs condition should Qw=E, not the Qw=Qa\r\n\r\n### Changes\r\n\r\nupdate the condition to Qw=E\r\n\r\n\n\nReviewers: Andrey Yegorov <None>\n\nThis closes #2630 from yangl/protocol-doc-fix","Date":"Mon May 03 20:43:05 CEST 2021"},{"Commit-ID":"commit 0f22d238c225ec667c58e1c5029644478d636128 1620067495 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Mon May 3 11:44:55 2021 -0700]","Body":"fix: Bookkeeper client throttling logic is based upon entryId instead of ledgerId\n\nDescriptions of the changes in this PR:\r\n\r\nFixes: #2660 \r\n\r\n### Changes\r\n\r\nisWriteSetWritable() to use ledgerId for the client selection\r\n\r\nMaster Issue: #2660 \n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Ivan Kelly <ivank@apache.org>\n\nThis closes #2664 from dlg99/fix/2660","Date":"Mon May 03 20:44:55 CEST 2021"},{"Commit-ID":"commit b606da7bc8dd1c6c8f610d5acf1403d798b6dcf1 1620109414 -----sp","Author":"PersonIdent[Lari Hotari, lhotari@users.noreply.github.com, Tue May 4 09:23:34 2021 +0300]","Body":"Upgrade Lombok to 1.18.20\n\n### Motivation\r\n\r\n- required for compilation on JDK 16\r\n- see https://projectlombok.org/changelog\r\n\r\n### Changes\r\n\r\nUpgrade Lombok version to `1.18.20` in `pom.xml` and `dependencies.gradle`.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Henry Saputra <hsaputra@apache.org>\n\nThis closes #2697 from lhotari/lh-upgrade-lombok_1.18.20","Date":"Tue May 04 08:23:34 CEST 2021"},{"Commit-ID":"commit 6ce96b8349678189c32dcaf6954da129fe093ef6 1620405530 -----sp","Author":"PersonIdent[Lari Hotari, lhotari@users.noreply.github.com, Fri May 7 19:38:50 2021 +0300]","Body":"[SECURITY] Upgrade Netty to 4.1.63.Final\n\n### Motivation\r\n\r\n- addresses several CVEs\r\n\r\n### Changes\r\n\r\n- Upgrade Netty to 4.1.63.Final\r\n- Upgrade netty-tcnative-boringssl-static to 2.0.36.Final\r\n- adapt API deprecation in PooledByteBufAllocator API\n\nReviewers: Lari Hotari <None>, Andrey Yegorov <None>, Enrico Olivelli <eolivelli@gmail.com>, Matteo Merli <mmerli@apache.org>\n\nThis closes #2696 from lhotari/lh-upgrade-Netty-4.1.63.Final and squashes the following commits:\n\n6003a374d [Lari Hotari] Experiment: exclude TLSv1.3 from testing\nfcbd707a6 [Lari Hotari] Handle TLS connection problems when TLSv1.3 is used\n86788ef35 [Lari Hotari] [Security] Upgrade Netty to 4.1.63.Final\nb606da7bc [Lari Hotari] Upgrade Lombok to 1.18.20\n0f22d238c [Andrey Yegorov] fix: Bookkeeper client throttling logic is based upon entryId instead of ledgerId\ne5e76667b [YANGLiiN] [DOC] fix the no striping occurs condition to Qw=E","Date":"Fri May 07 18:38:50 CEST 2021"},{"Commit-ID":"commit 87579b0a9f18833ee41fcae37582bb68606d68e7 1620435296 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri May 7 17:54:56 2021 -0700]","Body":"Read entry error should print lastAddConfirmed in the log (#2707)\n\n* Read entry error should print lastAddConfirmed in the log\r\n\r\n* Fixed test expectation of the log message","Date":"Sat May 08 02:54:56 CEST 2021"},{"Commit-ID":"commit 63867a99bac7df6e41b71e55af06ac514bd43113 1620454072 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri May 7 23:07:52 2021 -0700]","Body":"Impose a memory limit on the bookie journal (#2710)\n\n* Impose a memory limit on the bookie journal\r\n\r\n* Fixed checkstyle issues\r\n\r\n* Fixed more checkstyle issues\r\n\r\n* Added metrics for journal memory\r\n\r\n* More checkstyle..\r\n\r\n* Unused import","Date":"Sat May 08 08:07:52 CEST 2021"},{"Commit-ID":"commit 80910966388a9fa2ee4cd7fccbe07f7dee84ce44 1620480455 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sat May 8 06:27:35 2021 -0700]","Body":"Allow to bypass journal for writes (#2401)\n\n* Allow to bypass journal for writes\r\n\r\n* Added unit test to validate the new config\r\n\r\n* Fixed test variable names","Date":"Sat May 08 15:27:35 CEST 2021"},{"Commit-ID":"commit 683ad4592257ef79275e12112a769e6b750e6122 1620480485 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sat May 8 06:28:05 2021 -0700]","Body":"Allow to attach labels to metrics (#2650)\n\n* Allow to attach labels to metrics\r\n\r\n* Removed testCache since it's now invalid\r\n\r\n* Fixed checkstyle\r\n\r\n* Unused imports\r\n\r\n* Fixed test","Date":"Sat May 08 15:28:05 CEST 2021"},{"Commit-ID":"commit b824a602948efe09d3962772af98c08bf4e4c507 1620498130 -----sp","Author":"PersonIdent[hangc0276, hangc0276@163.com, Sun May 9 02:22:10 2021 +0800]","Body":"fix always select the same region set bug for RegionAwareEnsemblePlacementPolicy (#2658)\n\n* fix always select the same region bug for RegionAwareEnsemblePlacementPolicy\r\n\r\n* format code\r\n\r\n* add test for regionAwareEnsemblePlacementPolicy\r\n\r\n* update code\r\n\r\n* format code","Date":"Sat May 08 20:22:10 CEST 2021"},{"Commit-ID":"commit 034ef8566ad037937a4d58a28f70631175744f53 1620498931 -----sp","Author":"PersonIdent[Shoothzj, shoothzj@gmail.com, Sun May 9 02:35:31 2021 +0800]","Body":"Fix logger member not correct; (#2605)\n\nFix java doc problem\r\n\r\nCo-authored-by: shoothzj <shooothzj@gmail.com>","Date":"Sat May 08 20:35:31 CEST 2021"},{"Commit-ID":"commit 73e22cacf705e8462d80f477a0974db1d2bcf5b8 1620593922 -----sp","Author":"PersonIdent[Don Inghram, don.inghram@gmail.com, Sun May 9 14:58:42 2021 -0600]","Body":"ISSUE2620: RocksDB log path configurable\n\nRocksDB configuration now allows a new value \"dbStorage_rocksDB_logPath\"\r\nwhich allows the log files to be separated from the data storage. When\r\nnot set, Bookkeeper has no change in behavior.\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\n(Explain: why you're making that change, what is the problem you're trying to solve)\r\n\r\n### Changes\r\n\r\n(Describe: what changes you have made)\r\n\r\nMaster Issue: #<master-issue-number>\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, lipenghui <penghui@apache.org>, Matteo Merli <mmerli@apache.org>\n\nThis closes #2698 from dinghram/RocksDBLogPath and squashes the following commits:\n\nbd8e212e9 [Don Inghram] Issue2620-RocksDB log path configurable: conf\neeba05291 [Don Inghram] Issue2620-RocksDB log path configurable","Date":"Sun May 09 22:58:42 CEST 2021"},{"Commit-ID":"commit 8dc108b862db7aa11c557695ea4beffcf21cece4 1620594073 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sun May 9 14:01:13 2021 -0700]","Body":"y\n\n### Motivation\r\n\r\nIn case of corrupted entry log, this exception can show up during the compaction phase: \r\n\r\n```\r\n18:53:37.224 [GarbageCollectorThread-7-1] ERROR org.apache.bookkeeper.bookie.GarbageCollectorThread - Failed to compact entry log 16 due to unexpected error\r\njava.lang.IndexOutOfBoundsException: index: 8, length: 8 (expected: range(0, 0))\r\n\tat io.netty.buffer.AbstractByteBuf.checkRangeBounds(AbstractByteBuf.java:1425) ~[netty-buffer-4.1.51.Final.jar:4.1.51.Final]\r\n\tat io.netty.buffer.AbstractByteBuf.checkIndex0(AbstractByteBuf.java:1432) ~[netty-buffer-4.1.51.Final.jar:4.1.51.Final]\r\n\tat io.netty.buffer.AbstractByteBuf.checkIndex(AbstractByteBuf.java:1419) ~[netty-buffer-4.1.51.Final.jar:4.1.51.Final]\r\n\tat io.netty.buffer.UnpooledUnsafeDirectByteBuf.getLong(UnpooledUnsafeDirectByteBuf.java:144) ~[netty-buffer-4.1.51.Final.jar:4.1.51.Final]\r\n\tat org.apache.bookkeeper.bookie.EntryLogCompactor$CompactionScannerFactory$1.process(EntryLogCompactor.java:103) ~[bookkeeper-server-4.11.0.SPLK.8715995.jar:?]\r\n\tat org.apache.bookkeeper.bookie.EntryLogger.scanEntryLog(EntryLogger.java:1011) ~[bookkeeper-server-4.11.0.SPLK.8715995.jar:?]\r\n\tat org.apache.bookkeeper.bookie.EntryLogCompactor.compact(EntryLogCompactor.java:64) ~[bookkeeper-server-4.11.0.SPLK.8715995.jar:?]\r\n\tat org.apache.bookkeeper.bookie.GarbageCollectorThread.compactEntryLog(GarbageCollectorThread.java:528) [bookkeeper-server-4.11.0.SPLK.8715995.jar:?]\r\n\tat org.apache.bookkeeper.bookie.GarbageCollectorThread.doCompactEntryLogs(GarbageCollectorThread.java:462) [bookkeeper-server-4.11.0.SPLK.8715995.jar:?]\r\n\tat org.apache.bookkeeper.bookie.GarbageCollectorThread.runWithFlags(GarbageCollectorThread.java:367) [bookkeeper-server-4.11.0.SPLK.8715995.jar:?]\r\n\tat org.apache.bookkeeper.bookie.GarbageCollectorThread.safeRun(GarbageCollectorThread.java:316) [bookkeeper-server-4.11.0.SPLK.8715995.jar:?]\r\n\tat org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [bookkeeper-common-4.11.0.SPLK.8715995.jar:?]\r\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_232]\r\n\tat java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308) [?:1.8.0_232]\r\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_232]\r\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294) [?:1.8.0_232]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_232]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_232]\r\n\tat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.51.Final.jar:4.1.51.Final]\r\n\tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_232]\r\n```\n\nReviewers: Andrey Yegorov <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2649 from merlimat/compaction-exception and squashes the following commits:\n\n1360e2388 [Matteo Merli] Make sure to log warning when entrySize is 0\n42e0790d8 [Matteo Merli] Exception in BK GC with corrupted data files","Date":"Sun May 09 23:01:13 CEST 2021"},{"Commit-ID":"commit b0d9f10587f9662551b218523136c25df7c7c58f 1620610381 -----sp","Author":"PersonIdent[Andrey Yegorov, andrey.yegorov@datastax.com, Sun May 9 18:33:01 2021 -0700]","Body":"[maven-release-plugin] prepare branch branch-4.14\n","Date":"Mon May 10 03:33:01 CEST 2021"},{"Commit-ID":"commit 732b6cf2a6576c844a4b43176125e82d500a6ea8 1620610387 -----sp","Author":"PersonIdent[Andrey Yegorov, andrey.yegorov@datastax.com, Sun May 9 18:33:07 2021 -0700]","Body":"[maven-release-plugin] prepare for next development iteration\n","Date":"Mon May 10 03:33:07 CEST 2021"},{"Commit-ID":"commit bb8b1e0fee1585fcd166a27a3d91ec0e433dadcb 1620973375 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Thu May 13 23:22:55 2021 -0700]","Body":"Include gradle files into the source artifact for releases, exclude site2/**\n\n### Motivation\r\n\r\ngradle files weren't included into the source artifact of the release\r\nsite2/ was included.\r\n\r\n### Changes\r\n\r\nAdded gradle into the include pattern.\r\nAdded site2 into the exclude patterns.\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2714 from dlg99/gradle-release","Date":"Fri May 14 08:22:55 CEST 2021"},{"Commit-ID":"commit 61ddb9f3469cc307ab39ac5d2fb946eed59c003b 1621896389 -----sp","Author":"PersonIdent[hangc0276, hangc0276@163.com, Tue May 25 06:46:29 2021 +0800]","Body":"fix prometheus metric provider bug and add test to cover label scope \u2026\n\n### Motivation\r\nAfter add label for prometheus metric by https://github.com/apache/bookkeeper/pull/2650, it will cause prometheus metric format check failed when no label specified for a statsLogger. The metric list as follow.\r\n```\r\nreplication_bookkeeper_client_bookkeeper_client_bookie_watcher_NEW_ENSEMBLE_TIME{success=\"false\",quantile=\"0.9999\", } NaN\r\n```\r\n\r\n### Modification\r\n1. add label empty check for `PrometheusTextFormatUtil`\r\n2. add label scope check test cover\r\n3. add prometheus metric regex pattern check in test case\n\nReviewers: lipenghui <penghui@apache.org>, Andrey Yegorov <None>, Matteo Merli <mmerli@apache.org>, Jia Zhai <zhaijia@apache.org>, Addison Higham <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2718 from hangc0276/chenhang/fix_bookeeper_metric_bug and squashes the following commits:\n\n8590704db [hangc0276] format code\na6942d49f [chenhang] fix prometheus metric provider bug and add test to cover label scope and metric format check\nbb8b1e0fe [Andrey Yegorov] Include gradle files into the source artifact for releases, exclude site2/**\n732b6cf2a [Andrey Yegorov] [maven-release-plugin] prepare for next development iteration\nb0d9f1058 [Andrey Yegorov] [maven-release-plugin] prepare branch branch-4.14\n8dc108b86 [Matteo Merli] y\n73e22cacf [Don Inghram] ISSUE2620: RocksDB log path configurable\n034ef8566 [Shoothzj] Fix logger member not correct; (#2605)\nb824a6029 [hangc0276] fix always select the same region set bug for RegionAwareEnsemblePlacementPolicy (#2658)\n683ad4592 [Matteo Merli] Allow to attach labels to metrics (#2650)\n809109663 [Matteo Merli] Allow to bypass journal for writes (#2401)\n63867a99b [Matteo Merli] Impose a memory limit on the bookie journal (#2710)\n87579b0a9 [Matteo Merli] Read entry error should print lastAddConfirmed in the log (#2707)","Date":"Tue May 25 00:46:29 CEST 2021"},{"Commit-ID":"commit 76b80ba2f6522cfcbb29a4580719d4e71f0ac9b3 1621961776 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Tue May 25 09:56:16 2021 -0700]","Body":"Update bc tests to include versions up to 4.14.0\n\n### Motivation\r\n\r\n4.14.0 release \r\n\r\n### Changes\r\n\r\nfollowed https://bookkeeper.apache.org/community/release_guide/#verify-docker-image and used https://github.com/apache/bookkeeper/pull/2171 as example\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2719 from dlg99/bctests-4_14","Date":"Tue May 25 18:56:16 CEST 2021"},{"Commit-ID":"commit 64102086e3bf25e52c1e019cc7f6aa13bdad2ec5 1621961995 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Tue May 25 09:59:55 2021 -0700]","Body":"Docs and release notes update for BK 4.14.0 (#2712)\n\n* Docs and relese notes update for BK 4.1.4.0\r\n\r\n* Updated with recently merged PRs","Date":"Tue May 25 18:59:55 CEST 2021"},{"Commit-ID":"commit 9417b68ca072661efa0d3860e5b769338ba9d52c 1621965863 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Tue May 25 11:04:23 2021 -0700]","Body":"site update for release 4.14, this time actually updating the latest version in _config.yml (#2722)\n\nFinishing up the release","Date":"Tue May 25 20:04:23 CEST 2021"},{"Commit-ID":"commit c1847af5a6d75436aafd13501cb15973ea6b4995 1621979791 -----sp","Author":"PersonIdent[Prashant Kumar, 65131575+pkumar-singh@users.noreply.github.com, Tue May 25 14:56:31 2021 -0700]","Body":"Turn Bookie into an interface\n\n\r\n### Motivation\r\n\r\nBookie was previously a concrete class that was used and abused all\r\nover the place, especially in tests. A classic example of the God\r\nobject antipattern. The extensive use in tests, resulted in test cases\r\nwhich spin up many instances of the whole system, which is very heavy\r\nand very slow, especially when trying to unit tests a particular\r\nfeature.\r\n\r\nThis change is the first step to resolving this situation. Bookie is\r\nnow an interface, implemented by BookieImpl. Subsequent changes will\r\nbreak out parts of the interface, cleanup calls and add dependency\r\ninjection.\n\nReviewers: Matteo Merli <mmerli@apache.org>, Andrey Yegorov, Henry Saputra <hsaputra@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2717 from pkumar-singh/merge_back_to_oss and squashes the following commits:\n\n3edee4958 [Prashant] Replace SettableFuture  with CompletableFuture\ndb690262a [Ivan Kelly] Turn Bookie into an interface","Date":"Tue May 25 23:56:31 CEST 2021"},{"Commit-ID":"commit 9f06a4ce82f61a9dc4b086650a301734332f4246 1622158176 -----sp","Author":"PersonIdent[Prashant Kumar, 65131575+pkumar-singh@users.noreply.github.com, Thu May 27 16:29:36 2021 -0700]","Body":"Refactor book keeper cluster test case\n\n### Motivation\r\nBookKeeperClusterTestCase has historically exposed its members to all\r\nsubclasses, which would then manipulate them in many ways. There was\r\nan array of objects for configurations, bookieServers, autorecovery,\r\nwhich implicit linking between the objects based on maps and indices.\r\nIndividual subclasses manipulated these arrays.\r\n\r\nThis makes it hard to add any dependency injection on the objects\r\nmanaged by BookKeeperClusterTestCase as the objects. To add DI, we\r\nneed each object to have a bunch of other objects associated with\r\nit. For example, for each Bookie, we need to create the\r\nJournal. Maintaining these in separate arrays will lead to fragile\r\ntests.\r\n\r\nThis change encapsulates all the testing objects in a per bookie\r\nobject, and only allows manipulation through methods. This will allow\r\nus to group the objects needed for DI clearly.\r\n\r\nDisable testFollowBookieAddressChangeTrckingDisabled\n\nReviewers: Henry Saputra <hsaputra@apache.org>, Matteo Merli <mmerli@apache.org>\n\nThis closes #2723 from pkumar-singh/refactor_BookKeeperClusterTestCase and squashes the following commits:\n\n47fb8121f [Prashant] Addressed code review comments\n7f410ce96 [Ivan Kelly] Encapulate members of BookKeeperClusterTestCase\nc1847af5a [Prashant Kumar] Turn Bookie into an interface\n9417b68ca [Andrey Yegorov] site update for release 4.14, this time actually updating the latest version in _config.yml (#2722)","Date":"Fri May 28 01:29:36 CEST 2021"},{"Commit-ID":"commit 16e8ba772bb5cf4c7546fb559bd9d455d4e42625 1622505006 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon May 31 16:50:06 2021 -0700]","Body":"Site updates and release notes for 4.14.1 (#2724)\n\n* Site updates and release notes for 4.14.1\r\n\r\n* Site updates","Date":"Tue Jun 01 01:50:06 CEST 2021"},{"Commit-ID":"commit c0113ce69a80d35b89ba5dda2fd45512bca6b548 1623892704 -----sp","Author":"PersonIdent[Surinder Singh, sursingh@gmail.com, Wed Jun 16 18:18:24 2021 -0700]","Body":"[STATESTORE] Cleanup local storage for statestore storage container\n\n### Motivation\r\n\r\nWhile restoring a storage container, we fetch the checkpoint from the\r\ncheckpoint store. Currently this checkpoint will never get cleaned up. Every\r\ntime we restore the storage container on pod, a new checkpoint will get added.\r\nOver period of time the disk usage keeps going up and eventually we have to\r\nmanually delete these stale checkpoints.\r\n\r\n### Changes\r\n\r\nWith this change, we will cleanup the local storage for a storage container\r\nwhenever we close the KVStore. This will ensure that stale checkpoints are not\r\nleft behind. It is possible that POD may restart before the cleanup can be\r\ndone. To avoid these, we will also ensure that local storage for the storage\r\ncontainer is cleaned up before we restore the storage container.\r\n\n\nReviewers: Henry Saputra <hsaputra@apache.org>\n\nThis closes #2739 from sursingh/storage-cleanup and squashes the following commits:\n\n6bd477691 [Surinder Singh] Clean local storage for storage containers\nc74683695 [Surinder Singh] Add test case for local storage cleanup","Date":"Thu Jun 17 03:18:24 CEST 2021"},{"Commit-ID":"commit ac76a0867658ba87bb5a56b7bcd5655fc4d73096 1624506298 -----sp","Author":"PersonIdent[Yang Yang, yyang@streamnative.io, Thu Jun 24 11:44:58 2021 +0800]","Body":"Fix the typo in Auditor.java (#2744)\n\n### Motivation\r\n\r\n'conif' seems to be a typo of `conf`.\r\n\r\n### Changes\r\n\r\nFixed the typo.","Date":"Thu Jun 24 05:44:58 CEST 2021"},{"Commit-ID":"commit dcb2b95f50ad8177d9fb4a1c9b5c72b8be70aa1e 1624506369 -----sp","Author":"PersonIdent[Yang Yang, yyang@streamnative.io, Thu Jun 24 11:46:09 2021 +0800]","Body":"Print usage in autorecovery command if needed (#2743)\n\n### Motivation\r\n\r\nI was trying to read the code to see how auto-recovery service works, just noticed the method `printUsage` was never called and the program doesn't print the usage even when '-h' is specified.\r\n\r\n### Changes\r\n\r\nPrint the usage of auto-recovery if '-h' is specified or additional unexpected arguments are provided when running the auto-recovery command.","Date":"Thu Jun 24 05:46:09 CEST 2021"},{"Commit-ID":"commit 462188340c3b1d038adef6c0659b7d8b247e3963 1624506422 -----sp","Author":"PersonIdent[Lari Hotari, lhotari@users.noreply.github.com, Thu Jun 24 06:47:02 2021 +0300]","Body":"[Security] Exclude grpc-okhttp dependency (#2735)\n\nFixes #2733\r\n\r\n### Motivation\r\n\r\nThe okhttp dependency version 2.7.4 is old and vulnerable. This dependency isn't needed and it causes Bookkeeper to be flagged for security vulnerabilities.\r\n\r\n### Changes\r\n\r\n- exclude grpc-okhttp dependency which pulls in okhttp 2.7.4 \r\n- update license files","Date":"Thu Jun 24 05:47:02 CEST 2021"},{"Commit-ID":"commit c855fdd958665b494ac8c2fbd0d14cd2605fa867 1624506483 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Thu Jun 24 11:48:03 2021 +0800]","Body":"Add the `tlsCertificatePath` to the configuration file (#2720)\n\n---\r\n\r\nFixes #2699\r\n\r\n*Motivation*\r\n\r\nAdd missing configuration `tlsCertificatePath` in the configuration file\r\nand website description","Date":"Thu Jun 24 05:48:03 CEST 2021"},{"Commit-ID":"commit 9fce0c39eb19aff1876d2dcf490a6d8ecb32ed27 1624506524 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Wed Jun 23 21:48:44 2021 -0600]","Body":"BookKeeper-Client config to write ledger metadata with configured version (#2708)\n\n### Motivation\r\n\r\nWe need a way to use old bookie which doesn't support metadata-version-3 and upgrade bookkeeper-client with latest version. Right now, bk-4.12 writes ledger metadata with version-3 which will not be supported by bookie and replicator and replicator fails with below error\r\n```\r\n2021-05-07.00:43:53.115 [main-EventThread] ERROR\r\n                o.a.b.meta.AbstractZkLedgerManager   - Could not parse ledger metadata for ledger: 123456\r\njava.io.IOException: Metadata version not compatible. Expected between 0 and 2, but got 3\r\n        at org.apache.bookkeeper.client.LedgerMetadata.parseConfig(LedgerMetadata.java:465)\r\n        at org.apache.bookkeeper.meta.AbstractZkLedgerManager$3.processResult(AbstractZkLedgerManager.java:414)\r\n        at org.apache.bookkeeper.zookeeper.ZooKeeperClient$19$1.processResult(ZooKeeperClient.java:994)\r\n        at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:572)\r\n        at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:508)\r\n\r\n```\r\nSo, until one upgrades the bookie version, allow bk-client to use the appropriate metadata version.","Date":"Thu Jun 24 05:48:44 CEST 2021"},{"Commit-ID":"commit 6a19e0e3b8d76b5abb872a4cce81f99cbdf36a88 1624506587 -----sp","Author":"PersonIdent[Lari Hotari, lhotari@users.noreply.github.com, Thu Jun 24 06:49:47 2021 +0300]","Body":"[Security] Upgrade vertx to 3.9.8, addresses CVE-2018-12541 (#2693)\n\nFixes #2511\r\n\r\n### Motivation\r\n\r\nSee #2511\r\n\r\nThe current vertx version is 3.5.3 which has a vulnerability, CVE-2018-12541 .\r\n\r\n### Changes\r\n\r\n- Upgrade [vertx version to 3.9.8](https://github.com/eclipse-vertx/vert.x/releases/tag/3.9.8)\r\n- Fix issue with deprecated API usage\r\n\r\n","Date":"Thu Jun 24 05:49:47 CEST 2021"},{"Commit-ID":"commit a445728a2ab1f6b6805c6904126fb039d71d8faf 1624831119 -----sp","Author":"PersonIdent[Lari Hotari, lhotari@users.noreply.github.com, Mon Jun 28 00:58:39 2021 +0300]","Body":"[Build/Security] Upgrade Freebuilder version and fix the dependency\n\nFixes #2732\r\n\r\n### Motivation\r\n\r\n- Freebuilder 1.14.9 contains an outdate jquery js file which causes the library to be flagged as vulnerable with the highest threat level in Sonatype IQ vulnerability scanner. This also flags Bookkeeper and Pulsar as vulnerable with the highest threat level although it is a false positive and not an actual threat.\r\n\r\n- Freebuilder shouldn't be exposed as a transitive dependency\r\n  - it's an annotation processor which should be defined\r\n    - [optional in maven](https://github.com/inferred/FreeBuilder#maven)\r\n    - [compileOnly in gradle](https://github.com/inferred/FreeBuilder#gradle)\r\n\r\n### Changes\r\n\r\n- upgrade [Freebuilder](https://github.com/inferred/FreeBuilder) from 1.14.9 to 2.7.0\r\n- make dependency optional in maven pom.xml\r\n- use `compileOnly` instead of `implementation` in gradle build\n\nReviewers: Sijie Guo <None>\n\nThis closes #2734 from lhotari/lh-fix-freebuilder-dependency-issue","Date":"Sun Jun 27 23:58:39 CEST 2021"},{"Commit-ID":"commit d03b046c2526a3b89305da6460b601656ecd0700 1625469743 -----sp","Author":"PersonIdent[Jia Zhai, zhaijia@apache.org, Mon Jul 5 15:22:23 2021 +0800]","Body":"Fix Bouncy Castle fips incompatible issue (#2740)\n\n\r\n\r\n\r\n### Motivation\r\n\r\nMore details are provided in [Pulsar # 10937](https://github.com/apache/pulsar/issues/10937).\r\n\r\nIn #2631, the default BouncyCastle was changed from non-fips into fips version. But the default version of BouncyCastle in Pulsar is the [non-fips](https://github.com/apache/pulsar/blob/v2.8.0/pulsar-client/pom.xml#L56) one(aimed to make it compatible with the old version of Pulsar). \r\n\r\nBouncy Castle provides both FIPS and non-FIPS versions, but in a JVM, it can not include both of the 2 versions(non-Fips and Fips), and we have to exclude the current version before including the other. This makes the backward compatible a little hard, and that's why Pulsar has to involve an individual module for [Bouncy Castle](https://pulsar.apache.org/docs/en/security-bouncy-castle).\r\n\r\nAnd if we want to start BookKeeper with TLS enabled through Pulsar's binary, it will meet the following error:\r\n```\r\nException in thread \"main\" java.lang.NoClassDefFoundError: org/bouncycastle/jcajce/provider/BouncyCastleFipsProvider\r\n\tat java.base/java.lang.Class.forName0(Native Method)\r\n\tat java.base/java.lang.Class.forName(Class.java:315)\r\n\tat org.apache.bookkeeper.common.util.ReflectionUtils.forName(ReflectionUtils.java:49)\r\n\tat org.apache.bookkeeper.tls.SecurityProviderFactoryFactory.getSecurityProviderFactory(SecurityProviderFactoryFactory.java:39)\r\n\tat org.apache.bookkeeper.proto.BookieServer.<init>(BookieServer.java:129)\r\n\tat org.apache.bookkeeper.server.service.BookieService.<init>(BookieService.java:52)\r\n\tat org.apache.bookkeeper.server.Main.buildBookieServer(Main.java:304)\r\n\tat org.apache.bookkeeper.server.Main.doMain(Main.java:226)\r\n\tat org.apache.bookkeeper.server.Main.main(Main.java:208)\r\nCaused by: java.lang.ClassNotFoundException: org.bouncycastle.jcajce.provider.BouncyCastleFipsProvider\r\n\tat java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:581)\r\n\tat java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:178)\r\n\tat java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:522)\r\n\t... 9 more\r\n```\r\n\r\nThis fix is to use the reflection to get the loaded bc version to avoid the hard-coded bc version.\r\n\r\n### Changes\r\n\r\nUse the reflection to get the loaded bc version to avoid the hard-coded bc version\r\nAdd backward compatible test for bc-non-fips version","Date":"Mon Jul 05 09:22:23 CEST 2021"},{"Commit-ID":"commit 31e8d1b44ffafd867d0eb2774085e4b1141a7acb 1625845427 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Fri Jul 9 17:43:47 2021 +0200]","Body":"Log a warn before exiting when an illegal access not allowed is done on FileDescriptor#fd (#2749)\n\n","Date":"Fri Jul 09 17:43:47 CEST 2021"},{"Commit-ID":"commit d9cf767edd7b6714c222d6be9bfb863efa1ea2a5 1626214690 -----sp","Author":"PersonIdent[Jiabei Zhao, 41840745+Sunny-Island@users.noreply.github.com, Wed Jul 14 06:18:10 2021 +0800]","Body":"ISSUE #2726 Fix JAVA_HOME containing spaces\n\n### Motivation\r\n\r\nFix issue [#3726](https://github.com/apache/bookkeeper/issues/2726)\r\n\r\n\r\n### Changes\r\n\r\nAdd double quotation around `${JAVA}`  in `/bin/bookkeeper`.\r\n\n\nReviewers: Yong Zhang <zhangyong1025.zy@gmail.com>, Andrey Yegorov <None>, Sijie Guo <None>\n\nThis closes #2727 from Sunny-Island/fix-space-in-java-home, closes #2726","Date":"Wed Jul 14 00:18:10 CEST 2021"},{"Commit-ID":"commit 2346686c3b8621a585ad678926adf60206227367 1626402976 -----sp","Author":"PersonIdent[Yang Yang, yyang@streamnative.io, Fri Jul 16 10:36:16 2021 +0800]","Body":"[doc] Fix typo in bookkeeper config `tslProvider` (#2751)\n\nIt looks like an obvious typo that `tslProvider` should be `tlsProvider`, and the configuration item in the source code is also `tlsProvider`: https://github.com/apache/bookkeeper/blob/31e8d1b44ffafd867d0eb2774085e4b1141a7acb/bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java#L102","Date":"Fri Jul 16 04:36:16 CEST 2021"},{"Commit-ID":"commit c610d798ca8db997e3d573b104341b66a232f760 1628131671 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Thu Aug 5 10:47:51 2021 +0800]","Body":"Remove the `request` in the stream python client dependency (#2754)\n\n---\r\n\r\nMaster Issue: #2752\r\n\r\n*Motivation*\r\n\r\nAs discussed at length in https://issues.apache.org/jira/browse/LEGAL-572\r\nwe found out that the chardet library used by requests library was a\r\nmandatory dependency to requests and since it has LGPL licence, we\r\nshould not release any Apache Software with it.","Date":"Thu Aug 05 04:47:51 CEST 2021"},{"Commit-ID":"commit 67f934e5d1ccab5eab1053d808f65cd7cf1c70c4 1628824654 -----sp","Author":"PersonIdent[frankxieke, xieke89@gmail.com, Fri Aug 13 11:17:34 2021 +0800]","Body":"change log level from error to warn in getReadLacResponse (#2757)\n\n","Date":"Fri Aug 13 05:17:34 CEST 2021"},{"Commit-ID":"commit ea08e6d7b3a9c4803c42b739b43105df0fce0d3e 1628844803 -----sp","Author":"PersonIdent[Lari Hotari, lhotari@users.noreply.github.com, Fri Aug 13 11:53:23 2021 +0300]","Body":"[SECURITY] Upgrade libthrift to 0.14.2 to address multiple CVEs\n\nFixes #2512\r\n\r\n### Motivation\r\n\r\nSee #2512 \r\n\r\nThe current libthrift version 0.12.0 has multiple vulnerabilities:\r\n  - CVE-2019-0205 , CVE-2019-0210 , CVE-2020-13949\r\n\r\n### Motivation\r\n\r\n- Upgrade libthrift version to 0.14.1 and fix compilation errors\r\n- exclude new transitive dependencies org.apache.tomcat.embed:tomcat-embed-core and javax.annotation:javax.annotation-api\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Andrey Yegorov <None>\n\nThis closes #2695 from lhotari/lh-upgrade-libthrift","Date":"Fri Aug 13 10:53:23 CEST 2021"},{"Commit-ID":"commit 640bc993f3776fc416373e8ca6f9703bd9cd4b09 1629254745 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Wed Aug 18 10:45:45 2021 +0800]","Body":"Site updates and release note for 4.14.2 (#2763)\n\n---\r\n\r\n*Motivation*\r\n\r\nSite updates and release note for 4.14.2","Date":"Wed Aug 18 04:45:45 CEST 2021"},{"Commit-ID":"commit cde05029ffcc8492aab821f0350a43793e237f3e 1629304803 -----sp","Author":"PersonIdent[mauricebarnum, mbarnum@splunk.com, Wed Aug 18 09:40:03 2021 -0700]","Body":"state store: getStream: log stream info\n\nlog the the tuple (namespace id, stream id, stream name) in RootStorageService getRange request.\r\n\r\n### Motivation\r\n\r\nServer request metrics are labeled with the stream id, extracted from the routing header.  The stream name\r\n(aka \"table name\") is not available but more useful.  Rather than making a (cacheable) RPC request to fetch\r\nthe id -> name mapping in the metrics, logging the information allows one to find the name without requiring\r\nadmin access to the state store service.\r\n\r\n\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Henry Saputra <hsaputra@apache.org>\n\nThis closes #2758 from mauricebarnum/log-stream-name and squashes the following commits:\n\n4ef7ac070 [Maurice Barnum] cleanup: remove extraneous \"final\" declarations\n284b6430b [Maurice Barnum] state store: create and delete stream: log stream info","Date":"Wed Aug 18 18:40:03 CEST 2021"},{"Commit-ID":"commit 393834b6131423c0b7c5d7baa54b1bd867afe72a 1629772928 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Mon Aug 23 19:42:08 2021 -0700]","Body":"Preparing for the release 4.14 (#2713)\n\nDescriptions of the changes in this PR:\r\n\r\nUpdated py client's version to 4.14\r\n\r\n### Motivation\r\n\r\nPreparing for the release\r\nhttps://bookkeeper.apache.org/community/release_guide/#change-python-client-version\r\n\r\n","Date":"Tue Aug 24 04:42:08 CEST 2021"},{"Commit-ID":"commit c8d4086697f85c9093f4da2c907a13e17c198914 1629893134 -----sp","Author":"PersonIdent[Raúl Gracia, raul.gracia@emc.com, Wed Aug 25 14:05:34 2021 +0200]","Body":"ISSUE #2482: Added TCP_USER_TIMEOUT to Epoll channel config\n\n### Motivation\r\n\r\nAdded `TCP_USER_TIMEOUT` in Epoll channel config to limit the time a connection is left sending keepalives to a non-responding Bookie.\r\n\r\n### Changes\r\n\r\nThe original issue reported that in scenarios where Bookies may go down unexpectedly and change their IP (e.g., Kubernetes), the Bookkeeper client may be left for some time attempting to connect with the old IP of the restarted Bookie (see #2482 for details). To prevent this problem from happening (in Epoll channels), we introduce the following changes:\r\n- Epoll channels are now configured with `TCP_USER_TIMEOUT`. This parameter rules over the underlying TCP keepalive configuration (see https://datatracker.ietf.org/doc/html/rfc5482), which may be defaulted to retry for too long depending on the environment (e.g., 10-15 minutes in our experience).\r\n- To prevent adding more configuration parameters, the existing `clientConnectTimeoutMillis` value in `ClientConfiguration` is the one used to set `TCP_USER_TIMEOUT` due to its similarity.\r\n\r\n### Validation\r\n\r\nWe have reproduced the original testing environment in which this problem appears consistently:\r\n- Cluster with 4 Bookies and 3 Kubernetes nodes, in addition to https://pravega.io which uses the Bookkeeper client.\r\n- Deployed an application to do IO to Pravega (and therefore, to Bookkeeper).\r\n- Periodically shut down a Kubernetes node, so Bookkeeper pods on it are restarted as well.\r\n\r\nConsidering this test procedure, without the proposed PR we consistently observe Bookkeeper clients getting stuck trying to contact with old IPs from Bookies. With this change, we confirmed via logs that the configuration change takes place and we have not been able to reproduce the original problem so far after performing multiple node reboots.\r\n\r\nMaster Issue: #2482\r\n\n\nReviewers: Flavio Junqueira <fpj@apache.org>, Enrico Olivelli <eolivelli@apache.org>\n\nThis closes #2761 from RaulGracia/issue-2482-close-idle-bookie-connection, closes #2482","Date":"Wed Aug 25 14:05:34 CEST 2021"},{"Commit-ID":"commit 07158dabec8cc556f71d02789d989660c3804bbc 1630084181 -----sp","Author":"PersonIdent[Prashant Kumar, 65131575+pkumar-singh@users.noreply.github.com, Fri Aug 27 10:09:41 2021 -0700]","Body":"Unit test run with gradle failing\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\nBenchmark tests were failing due to \r\n\r\n- Missing runtime test dependency of MetricsCore\r\n- Lack of enough JVM memory.\r\n\r\n### Changes\r\n\r\n- Include metricsCore as testDependency\r\n- Increase heap size of 4 GB.\r\n\r\n\r\nMaster Issue: #2640\r\n\r\n\n\nReviewers: Henry Saputra <hsaputra@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2777 from pkumar-singh/build_with_gradle","Date":"Fri Aug 27 19:09:41 CEST 2021"},{"Commit-ID":"commit 000994cb90331f6e9f3cfaf389f2b2ab2ab5bfc9 1630084316 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Fri Aug 27 19:11:56 2021 +0200]","Body":"Use Pagination for GH Merge Script and remove Python2 script\n\nWe have more than 100 labels and the merge script is not able to download the list of labels, resulting in the impossibility to merge PRs.\r\n\r\nModifications:\r\n- download all the pages of labels\r\n- remove the Python2 script\n\nReviewers: Anup Ghatage <ghatage@apache.org>, Henry Saputra <hsaputra@apache.org>\n\nThis closes #2776 from eolivelli/fix/merge-script-pagination","Date":"Fri Aug 27 19:11:56 CEST 2021"},{"Commit-ID":"commit 938bb7f38551c6d3d9f94af43703b9d65785e973 1630087270 -----sp","Author":"PersonIdent[Surinder Singh, sursingh@gmail.com, Fri Aug 27 11:01:10 2021 -0700]","Body":"[STREAM STORAGE] Ensure progress while restoring from checkpoint.\n\n### Motivation\r\n\r\nSometimes the checkpoint restoration never completes. From the logs it looks\r\nlike it is stuck waiting for entries in distributedlog. But all the entries\r\nhave already been read. This looks like a race condition that causes the\r\nreader to believe that there are more entries.\r\n\r\nAlthough this can happen for any storage container, it is catastrophic when it\r\nhappens for root storage container. In that case all api calls start to fail.\r\n\r\n### Changes\r\n\r\nThis happens very rarely and is difficult to debug. Here we are adding a\r\nprotection around this deadlock. We will monitor the input stream to see we\r\nare getting new data. If new data is not received within specified amount of\r\ntime, we will fail the restore process. This will fail the starting of the\r\nstorage container. After failure we will restart the storage container again.\r\n\r\nI ran into this issue during my testing and was able confirm that we are able\r\nto recover from this.\r\n\r\n```\r\n2021-08-12T11:47:39.839+0000    org.apache.distributedlog.ReadAheadEntryReader  ReadAhead for 000000000000000000/000000000000000000/000000000000000000/checkpoints/cea4e286-5224-43ac-b6e0-7321d607f98e/MANIFEST-000004:<default> is caught up and no log segments to read now\r\n\r\n2021-08-12T11:47:39.834+0000    org.apache.distributedlog.logsegment.PerStreamLogSegmentCache   000000000000000000/000000000000000000/000000000000000000/checkpoints/cea4e286-5224-43ac-b6e0-7321d607f98e/MANIFEST-000004 added log segment (logrecs_000000000000000001 : [LogSegmentId:2534, firstTxId:99, lastTxId:99, version:VERSION_V5_SEQUENCE_ID, completionTime:1628793488256, recordCount:1, regionId:0, status:0, logSegmentSequenceNumber:1, lastEntryId:0, lastSlotId:0, inprogress:false, minActiveDLSN:DLSN{logSegmentSequenceNo=1, entryId=0, slotId=0}, startSequenceId:0]) to cache.\r\n2021-08-12T11:47:39.834+0000    org.apache.distributedlog.ReadAheadEntryReader  Starting the readahead entry reader for 000000000000000000/000000000000000000/000000000000000000/checkpoints/cea4e286-5224-43ac-b6e0-7321d607f98e/MANIFEST-000004:<default> : number of segments: 1, top 10 segments = [[LogSegmentId:2534, firstTxId:99, lastTxId:99, version:VERSION_V5_SEQUENCE_ID, completionTime:1628793488256, recordCount:1, regionId:0, status:0, logSegmentSequenceNumber:1, lastEntryId:0, lastSlotId:0, inprogress:false, minActiveDLSN:DLSN{logSegmentSequenceNo=1, entryId=0, slotId=0}, startSequenceId:0]]\r\n2021-08-12T11:47:39.834+0000    org.apache.distributedlog.logsegment.PerStreamLogSegmentCache   000000000000000000/000000000000000000/000000000000000000/checkpoints/cea4e286-5224-43ac-b6e0-7321d607f98e/MANIFEST-000004 added log segment (logrecs_000000000000000001 : [LogSegmentId:2534, firstTxId:99, lastTxId:99, version:VERSION_V5_SEQUENCE_ID, completionTime:1628793488256, recordCount:1, regionId:0, status:0, logSegmentSequenceNumber:1, lastEntryId:0, lastSlotId:0, inprogress:false, minActiveDLSN:DLSN{logSegmentSequenceNo=1, entryId=0, slotId=0}, startSequenceId:0]) to cache.\r\n\r\n2021-08-12T11:47:29.516+0000    org.apache.bookkeeper.stream.storage.impl.sc.ZkStorageContainerManager  Failed to start storage container (0)\r\n2021-08-12T11:47:29.513+0000    org.apache.bookkeeper.stream.storage.impl.sc.StorageContainerRegistryImpl       De-registered StorageContainer ('0') when failed to start\r\n\r\n2021-08-12T11:47:29.511+0000    org.apache.bookkeeper.statelib.impl.kv.RocksdbKVStore   Timeout waiting for checkpoint restore: Checkpoint{ID='cea4e286-5224-43ac-b6e0-7321d607f98e', createdAt: 1628793488360 files: \"CURRENT\"\\nfiles: \"MANIFEST-000004\"\\nfiles: \"OPTIONS-000008\"\\ntxid: \"\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\"\\ncreated_at: 1628793488360\\nfileInfos {\\n  name: \"CURRENT\"\\n  checksum: \"0861415cada612ea5834d56e2cf1055d3e63979b69eb71d32ae9ae394d8306cd\"\\n}\\nfileInfos {\\n  name: \"MANIFEST-000004\"\\n  checksum: \"7e4ff7d93941139236f69906d42a9e387dec565966b0017b6e8b16650c6c8be5\"\\n}\\nfileInfos {\\n  name: \"OPTIONS-000008\"\\n  checksum: \"41c8a054439d7798f88992a7a2dcb96f189cce0ed7ddb4c71af3594edc6a7a14\"\\n}\\n}\r\n\r\n2021-08-12T11:47:29.489+0000    org.apache.bookkeeper.statelib.impl.rocksdb.checkpoint.CheckpointFile   Timeout waiting for copy: 000000000000000000/000000000000000000/000000000000000000/checkpoints/cea4e286-5224-43ac-b6e0-7321d607f98e/MANIFEST-000004 last-read 0 current-read 0 runtime(ms) 300000\r\n\r\n2021-08-12T11:42:29.467+0000    org.apache.distributedlog.ReadAheadEntryReader  Starting the readahead entry reader for 000000000000000000/000000000000000000/000000000000000000/checkpoints/cea4e286-5224-43ac-b6e0-7321d607f98e/MANIFEST-000004:<default> : number of segments: 1, top 10 segments = [[LogSegmentId:2534, firstTxId:99, lastTxId:99, version:VERSION_V5_SEQUENCE_ID, completionTime:1628793488256, recordCount:1, regionId:0, status:0, logSegmentSequenceNumber:1, lastEntryId:0, lastSlotId:0, inprogress:false, minActiveDLSN:DLSN{logSegmentSequenceNo=1, entryId=0, slotId=0}, startSequenceId:0]]\r\n2021-08-12T11:42:29.466+0000    org.apache.distributedlog.logsegment.PerStreamLogSegmentCache   000000000000000000/000000000000000000/000000000000000000/checkpoints/cea4e286-5224-43ac-b6e0-7321d607f98e/MANIFEST-000004 added log segment (logrecs_000000000000000001 : [LogSegmentId:2534, firstTxId:99, lastTxId:99, version:VERSION_V5_SEQUENCE_ID, completionTime:1628793488256, recordCount:1, regionId:0, status:0, logSegmentSequenceNumber:1, lastEntryId:0, lastSlotId:0, inprogress:false, minActiveDLSN:DLSN{logSegmentSequenceNo=1, entryId=0, slotId=0}, startSequenceId:0]) to cache.\r\n2021-08-12T11:42:29.466+0000    org.apache.distributedlog.logsegment.PerStreamLogSegmentCache   000000000000000000/000000000000000000/000000000000000000/checkpoints/cea4e286-5224-43ac-b6e0-7321d607f98e/MANIFEST-000004 added log segment (logrecs_000000000000000001 : [LogSegmentId:2534, firstTxId:99, lastTxId:99, version:VERSION_V5_SEQUENCE_ID, completionTime:1628793488256, recordCount:1, regionId:0, status:0, logSegmentSequenceNumber:1, lastEntryId:0, lastSlotId:0, inprogress:false, minActiveDLSN:DLSN{logSegmentSequenceNo=1, entryId=0, slotId=0}, startSequenceId:0]) to cache.\r\n\r\n```\r\n\r\n\n\nReviewers: Ivan Kelly <ivank@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2764 from sursingh/statestore-restore-timeout and squashes the following commits:\n\n0b5cbeed4 [Surinder Singh] Change default timout to 1 Minute.\n38fe39f02 [Surinder Singh] Ensure progress while restoring from checkpoint.","Date":"Fri Aug 27 20:01:10 CEST 2021"},{"Commit-ID":"commit 5771321ef8d7689a3b88c0c9a9a42a458cebcd00 1630326676 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Mon Aug 30 20:31:16 2021 +0800]","Body":"Abstract the FileChannel in the JournalChannel\n\n### Motivation\r\n\r\nMake the FileChannel in the JournalChannel can use different implement.\r\nWe found we can use [pmemstore](https://github.com/pmem/pcj)\r\nas the JournalChannel read from. So abstract the FileChannel in the\r\nJournnalChannel to make us can have a different implementation.\r\n\r\n### Changes\r\n\r\n- Add interface for supporting implement different FileChannel\r\n\r\nThis PR doesn't introduce any new things in the code. So make sure it can pass the CI\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Hang Chen <chenhang@apache.org>, Nicolò Boschi <boschi1997@gmail.com>, Andrey Yegorov <None>\n\nThis closes #2742 from zymap/pmem-provider","Date":"Mon Aug 30 14:31:16 CEST 2021"},{"Commit-ID":"commit 7c74fbbd3614ba7042d55490332d0912c62d4bfc 1630890406 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Mon Sep 6 09:06:46 2021 +0800]","Body":"Release note for 4.14.2 (#2765)\n\n* Release note for 4.14.2\r\n---\r\n\r\n*Motivation*\r\n\r\nRlease note update for 4.14.2\r\n\r\n","Date":"Mon Sep 06 03:06:46 CEST 2021"},{"Commit-ID":"commit 97818f5123999396e66f5246420d3c7e3d25f53d 1630890467 -----sp","Author":"PersonIdent[frankxieke, kxie@streamnative.io, Mon Sep 6 09:07:47 2021 +0800]","Body":"Add metrics and internal command for QueryAutoRecoveryStatus, including underReplicatedSize metrics,read/write latency, internal command for querying recovering ledgersInfo (#2768)\n\nMotivation:\r\n\r\nCurrent AutoRecovery does not have enough metrics or stat command that would help to monitor and debug. So we need to add metrics and admin stat interface to monitor the process of AutoRecovery.  For example, current recovering ledgerInfo and under replicated size, read/write latency in recovering.\r\n\r\nChanges:\r\n\r\nAnd QueryAutoRecoveryStatus command and under replicated size metric , read/write latency metric in recovering\r\n\r\nDocumentation:\r\n\r\nNeed doc.\r\n","Date":"Mon Sep 06 03:07:47 CEST 2021"},{"Commit-ID":"commit c7236adc3cb659e65ae5ce53b7156569d7f50ebd 1631139933 -----sp","Author":"PersonIdent[mauricebarnum, mbarnum@splunk.com, Wed Sep 8 15:25:33 2021 -0700]","Body":"[STREAMSTORAGE] support an optional time to live (TTL) on a per table basis\n\n=== MOTIVIATION\r\n\r\nBookkeeper's state store is often used, especially through Pulsar\r\nfunctions, to store processing state in a streaming application which\r\nrequire persistent short term storage.  By allowing clients to set a\r\nTTL, this data will get cleaned up by the system automatically.\r\n\r\n=== CHANGES\r\n\r\nSpecify the TTL via stream.StreamConfiguration.ttlSeconds, default is an\r\ninfinite TTL.\r\n\r\nNote that changing the TTL on existing stream will have no effect until\r\nthe stream is next loaded by a storage container.\r\n\r\nUpdate RocksDB to 6.22.1.1 to address failures when using TtlDb.\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\n(Explain: why you're making that change, what is the problem you're trying to solve)\r\n\r\n### Changes\r\n\r\n(Describe: what changes you have made)\r\n\r\nMaster Issue: #<master-issue-number>\r\n\r\n\n\nReviewers: Henry Saputra <hsaputra@apache.org>, Enrico Olivelli <eolivelli@gmail.com>, Prashant Kumar <None>\n\nThis closes #2775 from mauricebarnum/stream-table-expiration and squashes the following commits:\n\n50471add7 [Maurice Barnum] update LICENSE files for rocksdb-6.22.1.1\ncaa8532d4 [Maurice Barnum] [STATESTORE] support an optional time to live (TTL) on a per table basis","Date":"Thu Sep 09 00:25:33 CEST 2021"},{"Commit-ID":"commit 0b93249d25419de9714f22c396d371940be448f9 1632444427 -----sp","Author":"PersonIdent[Jack Vanlightly, vanlightly@gmail.com, Fri Sep 24 02:47:07 2021 +0200]","Body":"ISSUE #2773: Add db ledgers index rebuild op\n\n### Motivation\r\n\r\nFile corruption of the ledgers index (DbLedgerStorage) has happened in production and we currently have no good way of resolving it. There exists a locations index rebuild command, this issue describes a new command targeted at the ledgers index.\r\n\r\nThis command should only be run when either the bookie is offline, or when in readonly mode to avoid data loss. Container based environments may not be able to make the bookie go offline while also allowing the shell or bkctl to perform the operation.\r\n\r\nThe db ledgers index rebuild op does the following:\r\n\r\n- scans all journal and entry log files to discover all ledger ids currently stored.\r\n- builds a new index where each ledger is fenced and has an empty master key set.\r\n- If all went well, replaces the original index with the new one\r\n\r\nThe bookie should then be restarted again (in normal mode) to load the rebuilt index. \r\n\r\nNotable stuff:\r\n\r\nThe reason for setting fencing each ledger is that there is no safe way of setting the fenced status based on metadata while the bookie is running. If the command is run when the bookie is in readonly mode, it can still serve fence requests and any fencing that occurs while the rebuild is occurring will be lost, which breaks the data safety guarantees of the BookKeeper protocol. Given also that the bookie should at least be in readonly mode (else offline), it is likely a member of the current ensemble of few ledgers so the impact should be minimal.\r\nThe reason for setting an empty master key is that firstly, an empty master key simply gets overwritten, so cannot cause an IllegalOpException. Secondly, if we use the password stored in metadata, then we need to be sure to use exactly the same digest algorithm as the client when it creates the ledgerKey, else the bookie will start failing all writes. This could potentially cause a problem in the future if the way the ledgerKey is generated changes (old clients would be incompatible after a ledgers index rebuild).\r\n\r\n### Changes\r\n\r\nAdds two new commands. \"rebuild-db-ledgers-index\" rebuilds the db ledgers index by scanning the journal and entry log files. \"check-db-ledgers-index\" performs a read scan of the db ledgers index, this can be used when corruption is suspected.\r\n\r\nAdditionally:\r\n- a test of the new rebuild op\r\n- makes the Journal. listJournalIds() method public so that the command can iterate over the journal files.\r\n- rewords some printed statements in the LocationsIndexRebuildOp to make it clear which index it is rebuilding (given that there are two indexes in the DbLedgerStorage).\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2774 from Vanlightly/rebuild-ledgers-index-op, closes #2773 and squashes the following commits:\n\n93bcf2e78 [Jack Vanlightly] Fix checkstyle\n5d679c8ef [Jack Vanlightly] Improved logging of ledgers index check and rebuild ops\na9789870f [Jack Vanlightly] Add db ledgers index rebuild op","Date":"Fri Sep 24 02:47:07 CEST 2021"},{"Commit-ID":"commit 76783f6c6a6a9ffd37a835f59bb56e7968bdc665 1632774717 -----sp","Author":"PersonIdent[Prashant Kumar, 65131575+pkumar-singh@users.noreply.github.com, Mon Sep 27 13:31:57 2021 -0700]","Body":"ISSUE #2640: BP-43 Migrate bookkeeper client tests to gradle\n\n### Motivation\r\nSometimes ago gradle was introduced to Bookkeeper, \r\nand with that build and release capabilities were built in Bookkeeper with gradle. But we never migrated bookkeeper to gradle.\r\n\r\nTaking a first step towards gradle migration; This PR migrate all client unit tests of bookkeepr-server module to gradle \r\n### Changes\r\nReplace maven test target with gradle\r\n\r\nMaster Issue: #2640\r\n\r\nThis is copy of the approved PR https://github.com/apache/bookkeeper/pull/2800\r\n\r\nAs github somehow is giving 404 with https://github.com/apache/bookkeeper/pull/2800 while merging it.\n\nReviewers: Boyang Jerry Peng <None>, Henry Saputra <hsaputra@apache.org>, Matteo Merli <mmerli@apache.org>, Andrey Yegorov <None>\n\nThis closes #2807 from pkumar-singh/merge_bookie_interface_injection_1, closes #2640","Date":"Mon Sep 27 22:31:57 CEST 2021"},{"Commit-ID":"commit 3b53b6f671d08a4545249933e442475e142cca11 1632774908 -----sp","Author":"PersonIdent[Wenjun Ruan, wenjun@apache.org, Tue Sep 28 04:35:08 2021 +0800]","Body":"Use try with resource to optimize code\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nOptimize code\r\n\r\n### Changes\r\n\r\n1. Use try with resource to optimize close\r\n2. remove isDebugEnabled\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Andrey Yegorov <None>\n\nThis closes #2783 from ruanwenjun/dev_wenjun_optimizeClosable","Date":"Mon Sep 27 22:35:08 CEST 2021"},{"Commit-ID":"commit 540946422544cce8a6ac74e3b99c446c398ac59a 1632901732 -----sp","Author":"PersonIdent[Prashant Kumar, 65131575+pkumar-singh@users.noreply.github.com, Wed Sep 29 00:48:52 2021 -0700]","Body":"Migrate bookkeepr-server org.apache.bookkeeper.bookie.* tests to gradle (#2809)\n\n","Date":"Wed Sep 29 09:48:52 CEST 2021"},{"Commit-ID":"commit 510439d1c703270ca7b7166a435476ce9ce39eb2 1633384680 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Mon Oct 4 23:58:00 2021 +0200]","Body":"[security] Upgrade Netty to 4.1.68.Final (#2811)\n\n","Date":"Mon Oct 04 23:58:00 CEST 2021"},{"Commit-ID":"commit 7d0fb0df33fdfaceaeef13f5a5617f0d45e23385 1633424336 -----sp","Author":"PersonIdent[gaozhangmin, gaozhangmin456@qq.com, Tue Oct 5 16:58:56 2021 +0800]","Body":"set response body for bookie  is_ready api (#2808)\n\n","Date":"Tue Oct 05 10:58:56 CEST 2021"},{"Commit-ID":"commit 50b5c1e25dd15ee78ec976387147f49e49e8309b 1633424368 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@gmail.com, Tue Oct 5 10:59:28 2021 +0200]","Body":"Issue 2787: TestPerChannelBookieClient.testEpollChannelTcpUserTimeout fails (#2801)\n\n","Date":"Tue Oct 05 10:59:28 CEST 2021"},{"Commit-ID":"commit 29829a4cc3b47928ca8c894474f046bd9deb088d 1633424849 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Tue Oct 5 17:07:29 2021 +0800]","Body":"Add auditor get ledger throttle to avoid auto recovery zk session expire (#2802)\n\n","Date":"Tue Oct 05 11:07:29 CEST 2021"},{"Commit-ID":"commit 9c6c5d9dc626d020e3efa995ad75fe49ccacc23a 1633424952 -----sp","Author":"PersonIdent[Shen Wenbing, oliver.shen999@gmail.com, Tue Oct 5 17:09:12 2021 +0800]","Body":"Fix wrong time unit in the comments of MathUtils (#2798)\n\n","Date":"Tue Oct 05 11:09:12 CEST 2021"},{"Commit-ID":"commit 883231ec8be26b9b118db5a2df3651cff840d322 1633712286 -----sp","Author":"PersonIdent[pradeepbn, pradipbn@gmail.com, Fri Oct 8 09:58:06 2021 -0700]","Body":"Building bookkeeper with gradle on java11\n\n\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n\r\n### Motivation\r\nThis change enable gradle to build on java11 \r\n\r\n### Changes\r\n- generateJniHeaders for CpuAffinity using native gradle config rather than using javac rather than specifying it via command line in gradle\r\n- Update gradle dependencies that helps build java11\r\n- Update checkstyle to use native configurations from gradle \r\n\r\nMaster Issue: #2640\r\n\r\n\n\nReviewers: Prashant Kumar <None>, Henry Saputra <hsaputra@apache.org>, Matteo Merli <mmerli@apache.org>\n\nThis closes #2817 from pradeepbn/java11 and squashes the following commits:\n\n95c19de0d [pradeepbn] Merge pull request #1 from mauricebarnum/pr-2817-jni\n049a510b9 [maurice barnum] use compileJava task to generate jni headers\nf690e90e4 [Pradeep Nagaraju] Replace javac to use gradle native config\n9285c10a0 [Pradeep Nagaraju] Revert the changes to avoid deprecation of finalize()\n22c3cfd5a [Pradeep Nagaraju] remove unwanted changes\nb41605931 [Pradeep Nagaraju] - Building bookkeeper with gradle on java11 - Use gradle native solution for using javac rather than specifying it via command line in gradle","Date":"Fri Oct 08 18:58:06 CEST 2021"},{"Commit-ID":"commit e413c7094f5a4ba7cde3b2e399f8ebe4366b464c 1633959302 -----sp","Author":"PersonIdent[Raúl Gracia, raul.gracia@emc.com, Mon Oct 11 15:35:02 2021 +0200]","Body":"Issue 2728: Entry Log GC may get blocked when using entryLogPerLedgerEnabled option (#2779)\n\n","Date":"Mon Oct 11 15:35:02 CEST 2021"},{"Commit-ID":"commit 354cf37c919d756a47691cc710a6e8d2f1933f2b 1634140317 -----sp","Author":"PersonIdent[Raúl Gracia, raul.gracia@emc.com, Wed Oct 13 17:51:57 2021 +0200]","Body":"Upgraded dependencies with CVEs (#2792)\n\n","Date":"Wed Oct 13 17:51:57 CEST 2021"},{"Commit-ID":"commit 594a0568528120ccffb07450c2c28144efb683d6 1634140357 -----sp","Author":"PersonIdent[Raúl Gracia, raul.gracia@emc.com, Wed Oct 13 17:52:37 2021 +0200]","Body":"Issue 2795: Bookkeeper upgrade using Bookie ID may fail due to cookie mismatch (#2796)\n\n","Date":"Wed Oct 13 17:52:37 CEST 2021"},{"Commit-ID":"commit 04650521b3a91e03cf598a647ecd58df106d081b 1634256641 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Fri Oct 15 02:10:41 2021 +0200]","Body":"Upgrade httpclient from 4.5.5 to 4.5.13 (#2793)\n\nUpgrade httpclient from 4.5.5 to 4.5.13\r\n(on gradle dependencies it was already on 4.5.13) \r\n\r\n### Motivation\r\nResolve security vulnerability, see https://github.com/advisories/GHSA-7r82-7xv7-xcpj\r\n","Date":"Fri Oct 15 02:10:41 CEST 2021"},{"Commit-ID":"commit a522fa33b31e2405830a33cd2120be60d3174cd5 1634256962 -----sp","Author":"PersonIdent[Raúl Gracia, raul.gracia@emc.com, Fri Oct 15 02:16:02 2021 +0200]","Body":"Issue 2815: Upgrade to log4j2 to get rid of CVE-2019-17571 (#2816)\n\n### Motivation\r\nUpgrades to log4j2 to get rid of CVE-2019-17571.  \r\n\r\n### Changes\r\n\r\nThe migration of log4j has been done mainly taking the official guidelines: https://logging.apache.org/log4j/2.x/manual/migration.html.\r\nIn this PR, the following changes are included:\r\n- Replacement of `slf4j-log4j12` by `log4j-1.2-api`. Also included the `log4j-slf4j-impl` binding as well as the `log4j-core` library.\r\n- Changes in `pom`, `gradle` and license files to reflect the above library upgrade.\r\n- Test classes `TestOrderedExecutorDecorators`, `LoggerOutput`, `MdcContextTest`, as well as the class `FIleSystemUpgrade` made use of log4j1.2 API. This PR attempts to keep the same functionality with the new APIs.\r\n\r\n### Verification\r\n- Existing tests are passing.\r\n- log4j1.2 is removed from project: https://github.com/apache/bookkeeper/pull/2816#issuecomment-937818625\r\n- Using `localbookie`, we observe that logs are shown correctly:\r\n```\r\n2021-10-07T16:04:23,757 - INFO  - [main:GarbageCollectorThread@245] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000\r\n2021-10-07T16:04:23,760 - INFO  - [main:GarbageCollectorThread@247] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000\r\n2021-10-07T16:04:23,952 - INFO  - [main:BookieImpl@920] - Finished replaying journal in 2 ms.\r\n2021-10-07T16:04:23,958 - INFO  - [SyncThread-7-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.\r\n2021-10-07T16:04:23,980 - INFO  - [main:BookieImpl@1010] - Finished reading journal, starting bookie\r\n2021-10-07T16:04:24,011 - INFO  - [BookieJournal-5000:Journal@919] - Starting journal on /tmp/localbookkeeper06554024139823286046test/current\r\n2021-10-07T16:04:24,031 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started\r\n2021-10-07T16:04:24,048 - INFO  - [BookieJournal-5000:JournalChannel@169] - Opening journal /tmp/localbookkeeper06554024139823286046test/current/17c5b11c65b.txn\r\n```\r\nIn addition to that, if we change the `log4j.properties` file, the changes are reflected in the console output, meaning that the legacy configuration works and changes can be correctly applied:\r\n```\r\nOver Replicated Ledger Deletion : enabled=true, interval=86400000\r\nMinor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000\r\nMajor Compaction : enabled=true, threshold=0.800000011920929, interval=86400000\r\nFinished replaying journal in 5 ms.\r\nFlush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.\r\nFinished reading journal, starting bookie\r\nStarting journal on /tmp/localbookkeeper015049859959001160726test/current\r\nForceWrite Thread started\r\nOpening journal /tmp/localbookkeeper015049859959001160726test/current/17c5b143063.txn\r\n```\r\nMore verifications that logging works properly related to other Bookkeeper sub-components impacted may be needed.\r\n\r\nMaster Issue: #2815\r\n","Date":"Fri Oct 15 02:16:02 CEST 2021"},{"Commit-ID":"commit 4dc426000d35a93ee0681c0c0124d4b1d3c53ad8 1634257402 -----sp","Author":"PersonIdent[gaozhangmin, gaozhangmin456@qq.com, Fri Oct 15 08:23:22 2021 +0800]","Body":"Heap memory leak problem when ledger replication failed (#2794)\n\n### Motivation\r\n\r\nproduction environment, memory leak always happened, and there were ledger cannot be replicated successfully.\r\n\r\n\r\n\r\nThis cause by when `openLedgerNoRecovery` with `BKNotEnoughBookiesException`,  the LedgerHandler won't  closed properly, caused memory leak\r\n\r\nhttps://github.com/apache/bookkeeper/blob/c7236adc3cb659e65ae5ce53b7156569d7f50ebd/bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/ReplicationWorker.java#L364-L424\r\n\r\n### Changes\r\n\r\nclose LedgerHandler when openComplete with exception\r\n","Date":"Fri Oct 15 02:23:22 CEST 2021"},{"Commit-ID":"commit 148bf22426041e1e2dd26d17bf1e967fc35904aa 1634409820 -----sp","Author":"PersonIdent[Yun Tang, myasuka@live.com, Sun Oct 17 02:43:40 2021 +0800]","Body":"Ensure to release cache during KeyValueStorageRocksDB#closec (#2821)\n\n","Date":"Sat Oct 16 20:43:40 CEST 2021"},{"Commit-ID":"commit a9b576da2f7f974ce46789dd8308240d18765754 1634421604 -----sp","Author":"PersonIdent[Yunze Xu, xyzinfernity@163.com, Sun Oct 17 06:00:04 2021 +0800]","Body":"Release semaphore when addEntry accepts the same entries (#2832)\n\n","Date":"Sun Oct 17 00:00:04 CEST 2021"},{"Commit-ID":"commit a4afaa49057002135fc404653a158ad3333005aa 1634571967 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon Oct 18 08:46:07 2021 -0700]","Body":"Eliminate direct ZK access in ScanAndCompareGarbageCollector (#2833)\n\n* Eliminate direct ZK access in ScanAndCompareGarbageCollector\r\n\r\n* Removed unused imports\r\n\r\n* Fixed zk ACLs\r\n\r\n* Addressed comments\r\n\r\n* Fixed checkstyle","Date":"Mon Oct 18 17:46:07 CEST 2021"},{"Commit-ID":"commit f6903b8e8e752b642012d1fafc4f411bfce74e9a 1634747619 -----sp","Author":"PersonIdent[Jack Vanlightly, vanlightly@gmail.com, Wed Oct 20 18:33:39 2021 +0200]","Body":"BP-44 USE metrics\n\nBP-44: USE metrics. A proposal for improving BookKeeper metrics so that operators can employ the USE method for diagnosing performance issues.\r\n\n\nReviewers: Henry Saputra <hsaputra@apache.org>, Andrey Yegorov <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2835 from Vanlightly/BP-44-use-metrics and squashes the following commits:\n\n8d9baabf6 [Jack Vanlightly] Added link to USE method and listed each term of USE\n5a0f67dcf [Jack Vanlightly] BP-44 USE metrics\na9b576da2 [Yunze Xu] Release semaphore when addEntry accepts the same entries (#2832)\n148bf2242 [Yun Tang] Ensure to release cache during KeyValueStorageRocksDB#closec (#2821)\n4dc426000 [gaozhangmin] Heap memory leak problem when ledger replication failed (#2794)\na522fa33b [Raúl Gracia] Issue 2815: Upgrade to log4j2 to get rid of CVE-2019-17571 (#2816)\n04650521b [Nicolò Boschi] Upgrade httpclient from 4.5.5 to 4.5.13 (#2793)\n594a05685 [Raúl Gracia] Issue 2795: Bookkeeper upgrade using Bookie ID may fail due to cookie mismatch (#2796)\n354cf37c9 [Raúl Gracia] Upgraded dependencies with CVEs (#2792)\ne413c7094 [Raúl Gracia] Issue 2728: Entry Log GC may get blocked when using entryLogPerLedgerEnabled option (#2779)\n883231ec8 [pradeepbn] Building bookkeeper with gradle on java11","Date":"Wed Oct 20 18:33:39 CEST 2021"},{"Commit-ID":"commit 3dd671c740cf34e0cbdca0dc2ac506c06cf97472 1634748767 -----sp","Author":"PersonIdent[Prashant Kumar, 65131575+pkumar-singh@users.noreply.github.com, Wed Oct 20 09:52:47 2021 -0700]","Body":"Migrate bookkeepr-server:test to gradle run unit tests excepts org.apache.bookkeeper.bookie. org.apache.bookkeeper.client org.apache.bookkeeper.replication org.apache.bookkeeper.tls. (#2812)\n\nCo-authored-by: Prashant Kumar <prashantk@splunk.com>","Date":"Wed Oct 20 18:52:47 CEST 2021"},{"Commit-ID":"commit 031d168abdeedb6acbee7839c902a184f083da4c 1634820527 -----sp","Author":"PersonIdent[gaozhangmin, gaozhangmin456@qq.com, Thu Oct 21 20:48:47 2021 +0800]","Body":"fix-npe-when-pulsar-ZkBookieRackAffinityMapping-getBookieAddressResolver (#2788)\n\nError log:\r\n\r\n`16:21:20.140 [main] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.pulsar.zookeeper.ZkBookieRackAffinityMapping, used default subnet resolver : java.lang.RuntimeException: java.lang.NullPointerException java.lang.NullPointerException`\r\n\r\n`BookieAddressResolver` should be set before  `((Configurable) dnsResolver).setConf(conf);`  \r\n\r\nIt will throw npe. when pulsar `ZkBookieRackAffinityMapping` invoke getBookieAddressResolver","Date":"Thu Oct 21 14:48:47 CEST 2021"},{"Commit-ID":"commit 919fdd39856512b98aab53ee72332a81a1317bea 1634862007 -----sp","Author":"PersonIdent[Prashant Kumar, 65131575+pkumar-singh@users.noreply.github.com, Thu Oct 21 17:20:07 2021 -0700]","Body":"Issue:2840 Create bookie shellscript for gradle (#2841)\n\nCo-authored-by: Prashant Kumar <prashantk@splunk.com>","Date":"Fri Oct 22 02:20:07 CEST 2021"},{"Commit-ID":"commit 53954caae3a4f40cf0a45718d306b6a8555c54e2 1634870603 -----sp","Author":"PersonIdent[shustsud, 51769018+shustsud@users.noreply.github.com, Fri Oct 22 11:43:23 2021 +0900]","Body":"Add ensemble check to over-replicated ledger GC (#2813)\n\n### Motivation\r\n- Issue is as described in [PR#2797](https://github.com/apache/bookkeeper/pull/2797).\r\n> In one day, zookeepers became high cpu usage and disk full.\r\n> The cause of this is bookie's gc of overreplicated ledgers.\r\n> Gc created/deleted zk nodes under /ledgers/underreplication/locks very frequently and some bookies ran gc at same time.\r\n> As a result, zookeepers created a lot of snapshots and became disk full.\r\n\r\n- I want to reduce the number of lock node creations and deletions in ZK.\r\n\r\n### Changes\r\n- Add an ensemble check before creating the lock node.\r\nThis is to reduce the number of lock node creations and deletions in ZK.\r\n\r\n- ~~If [PR#2797](https://github.com/apache/bookkeeper/pull/2797) was merged, this PR needs to be fixed.~~\r\n","Date":"Fri Oct 22 04:43:23 CEST 2021"},{"Commit-ID":"commit e10f3fe6f8c0f044052519586137d32e5bb7ea56 1634923138 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sat Oct 23 01:18:58 2021 +0800]","Body":"Forget to close preAllocator log on shutdown (#2819)\n\n* Forget to close preAllocator log on shutdown\r\n\r\n* Fix synchronize problem\r\n\r\n* handle InterruptedException","Date":"Fri Oct 22 19:18:58 CEST 2021"},{"Commit-ID":"commit 14ef56fb7dd99c59b8c05df8c4faef1ef2b06c67 1634939920 -----sp","Author":"PersonIdent[Prashant Kumar, 65131575+pkumar-singh@users.noreply.github.com, Fri Oct 22 14:58:40 2021 -0700]","Body":"BookieId can not be cast to BookieSocketAddress (#2843)\n\nCo-authored-by: Prashant Kumar <prashantk@splunk.com>","Date":"Fri Oct 22 23:58:40 CEST 2021"},{"Commit-ID":"commit 411720040ebe71fbc4cc4f14ab95c6844d07785c 1634948294 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sat Oct 23 08:18:14 2021 +0800]","Body":"the compare should be >= instead of > (#2782)\n\n","Date":"Sat Oct 23 02:18:14 CEST 2021"},{"Commit-ID":"commit 746f9f6ff5f54203a6f1c25b7d0f02642455ea04 1634962887 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri Oct 22 21:21:27 2021 -0700]","Body":"Remove direct ZK access for Auditor (#2842)\n\n* Remove direct ZK access for Auditor\r\n\r\n* Fixed unused imports\r\n\r\n* Fixed checkstyle\r\n\r\n* Fixed checkstyle in tests","Date":"Sat Oct 23 06:21:27 CEST 2021"},{"Commit-ID":"commit bd5c50bf331c28e6a9db2b8d2b186b86342dbd6b 1635126014 -----sp","Author":"PersonIdent[shustsud, 51769018+shustsud@users.noreply.github.com, Mon Oct 25 10:40:14 2021 +0900]","Body":"Add error handling to readLedgerMetadata in over-replicated ledger GC (#2844)\n\n### Motivation\r\nFor each ledger whose metadata is not in ZK, following stack trace will be output:\r\n\r\n```\r\n15:30:17.925 [GarbageCollectorThread-11-1] ERROR o.a.b.b.ScanAndCompareGarbageCollector - Exception when iterating through the ledgers to check for over-replication\r\njava.util.concurrent.ExecutionException: org.apache.bookkeeper.client.BKException$BKNoSuchLedgerExistsException: No such ledger exists\r\n        at java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:357)\r\n        at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1908)\r\n        at org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector.removeOverReplicatedledgers(ScanAndCompareGarbageCollector.java:199)\r\n        at org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector.gc(ScanAndCompareGarbageCollector.java:120)\r\n        at org.apache.bookkeeper.bookie.GarbageCollectorThread.doGcLedgers(GarbageCollectorThread.java:372)\r\n        at org.apache.bookkeeper.bookie.GarbageCollectorThread.runWithFlags(GarbageCollectorThread.java:323)\r\n        at org.apache.bookkeeper.bookie.GarbageCollectorThread.safeRun(GarbageCollectorThread.java:301)\r\n        at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36)\r\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n        at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)\r\n        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)\r\n        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n        at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\r\n        at java.lang.Thread.run(Thread.java:748)\r\nCaused by: org.apache.bookkeeper.client.BKException$BKNoSuchLedgerExistsException: No such ledger exists\r\n        at org.apache.bookkeeper.meta.AbstractZkLedgerManager$3.processResult(AbstractZkLedgerManager.java:397)\r\n        at org.apache.bookkeeper.zookeeper.ZooKeeperClient$19$1.processResult(ZooKeeperClient.java:994)\r\n        at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:575)\r\n        at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:508)\r\n```\r\n\r\nIt is noisy, makes the size of log files large and finally causes OOM during log rotation.\r\nSo we should suppress the stacktrace.\r\n\r\n(This problem is due to [#2813](https://github.com/apache/bookkeeper/pull/2813).)\r\n\r\n### Changes\r\nAdd error handling to readLedgerMetadata in over-replicated ledger GC in order to suppress the stacktrace.\r\n","Date":"Mon Oct 25 03:40:14 CEST 2021"},{"Commit-ID":"commit b1d5e1434f393d9ae3b5ffae1cc2fb79ce2fb624 1635145709 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Mon Oct 25 15:08:29 2021 +0800]","Body":"A empty implement in EtcdLedgerManagerFactory to let the project can compile (#2845)\n\n","Date":"Mon Oct 25 09:08:29 CEST 2021"},{"Commit-ID":"commit 4ae5b3b5a6bf5a13ea73a2f6157a56ad22ec4ebe 1635210719 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Tue Oct 26 03:11:59 2021 +0200]","Body":"Remove no longer used Jenkins scripts and TravisCI references (#2848)\n\n* Remove deprecated Jenkinsfile\r\n\r\n* Remove Jenkins job, Travis refs, update doc/website for contributions\r\n\r\n* readd newline","Date":"Tue Oct 26 03:11:59 CEST 2021"},{"Commit-ID":"commit 77a6adb3786cc1d507191a332c944c37213d5ab8 1635321492 -----sp","Author":"PersonIdent[Jack Vanlightly, vanlightly@gmail.com, Wed Oct 27 09:58:12 2021 +0200]","Body":"ISSUE #2835: BP-44 Addition of thread-scoped OpStatsLogger and Counter (#2839)\n\n* Addition of thread-scoped stats\r\n\r\nThe Counter and OpStatsLogger have new variants that\r\nadd threadPool and thread labels to their metrics.\r\nThese new variants can be obtained via new methods\r\nin the StatsLogger interface.","Date":"Wed Oct 27 09:58:12 CEST 2021"},{"Commit-ID":"commit 6e3c82cbfba7e75b946075a65c16cb390c09f9a6 1635337276 -----sp","Author":"PersonIdent[Raúl Gracia, raul.gracia@emc.com, Wed Oct 27 14:21:16 2021 +0200]","Body":"Issue 2837: Remove unnecessary log4j bindings from Bookkeeper packages (#2838)\n\n","Date":"Wed Oct 27 14:21:16 CEST 2021"},{"Commit-ID":"commit 98ddf8149592572eebcfaf6bdd4916f295ffd9d7 1635468335 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Fri Oct 29 02:45:35 2021 +0200]","Body":"Gradle build - some submodules are skipped\n\n### Motivation\r\n\r\nIn order to complete migration to Gradle we must build all the subprojects.\r\n\r\n### Changes\r\n\r\n- Enabled `sh` integration tests with gradle, located in `tests/scripts/src/test/bash/gradle`\r\n- Added these modules to the build\r\n    - `bookkeeper-http:servlet-http-server` \r\n    - `metadata-drivers:etcd`\r\n    - `tests:backward-compat:*`\r\n    - `tests:shaded:*`\r\n    - `stream:bk-grpc-name-resolver`\r\n- DL shading process is now performed (before it didn't build any jar)\r\n- Groovy tests (`tests:backward-compat:*`) now are triggered by the build/tests itself; with Maven, there is a \"runner\" project (`tests/integration-tests-base-groovy`); in Gradle is useless so it is skipped\r\n\r\n\r\n### Test\r\n\r\n- Both `bin/bookkeper standalone` and `bin/bookkeper_gradle standalone` work locally\r\n- Tests are passing locally  \r\n\r\nMaster Issue: #2849\r\n\r\n\n\nReviewers: Henry Saputra <hsaputra@apache.org>, Prashant Kumar <None>\n\nThis closes #2850 from nicoloboschi/fix/2849/gradle and squashes the following commits:\n\n00b49f4f5 [Nicolò Boschi] Fix common_gradle.sh regex\nbd739fdf5 [Nicolò Boschi] fix sh tests\n43230ba2f [Nicolò Boschi] revert sh files. Avoid to modify maven files, create gradle versions to faciltate migration\nd1f95e40f [Nicolò Boschi] fix shaded deps\nbcab40ddb [Nicolò Boschi] fix build\n5fd03414b [Nicolò Boschi] fix build\n0082e0e1a [Nicolò Boschi] fix build\n2c32ac117 [Nicolò Boschi] fixes\n3bc0b2627 [Nicolò Boschi] bookkeeper-server-shaded-tests\nba8913240 [Nicolò Boschi] shaded tests\n6d39e33db [Nicolò Boschi] sh tests\ne0032bc6f [Nicolò Boschi] actually run arquillian groovy tests\n08dcc3963 [Nicolò Boschi] backwards\n2361f794f [Nicolò Boschi] hierarchical-ledger-manager\n8388e1111 [Nicolò Boschi] current-server-old-clients\n6a243441d [Nicolò Boschi] bc-non-fips\n2faca014f [Nicolò Boschi] bk-grpc-name-resolver\n991bc1172 [Nicolò Boschi] servlet-http-server\n675ef7b81 [Nicolò Boschi] etcd\nb1d5e1434 [ZhangJian He] A empty implement in EtcdLedgerManagerFactory to let the project can compile (#2845)\nbd5c50bf3 [shustsud] Add error handling to readLedgerMetadata in over-replicated ledger GC (#2844)\n746f9f6ff [Matteo Merli] Remove direct ZK access for Auditor (#2842)\n411720040 [ZhangJian He] the compare should be >= instead of > (#2782)\n14ef56fb7 [Prashant Kumar] BookieId can not be cast to BookieSocketAddress (#2843)\ne10f3fe6f [ZhangJian He] Forget to close preAllocator log on shutdown (#2819)\n53954caae [shustsud] Add ensemble check to over-replicated ledger GC (#2813)\n919fdd398 [Prashant Kumar] Issue:2840 Create bookie shellscript for gradle (#2841)\n031d168ab [gaozhangmin] fix-npe-when-pulsar-ZkBookieRackAffinityMapping-getBookieAddressResolver (#2788)\n3dd671c74 [Prashant Kumar] Migrate bookkeepr-server:test to gradle run unit tests excepts org.apache.bookkeeper.bookie. org.apache.bookkeeper.client org.apache.bookkeeper.replication org.apache.bookkeeper.tls. (#2812)\nf6903b8e8 [Jack Vanlightly] BP-44 USE metrics\na4afaa490 [Matteo Merli] Eliminate direct ZK access in ScanAndCompareGarbageCollector (#2833)\na9b576da2 [Yunze Xu] Release semaphore when addEntry accepts the same entries (#2832)\n148bf2242 [Yun Tang] Ensure to release cache during KeyValueStorageRocksDB#closec (#2821)\n4dc426000 [gaozhangmin] Heap memory leak problem when ledger replication failed (#2794)\na522fa33b [Raúl Gracia] Issue 2815: Upgrade to log4j2 to get rid of CVE-2019-17571 (#2816)\n04650521b [Nicolò Boschi] Upgrade httpclient from 4.5.5 to 4.5.13 (#2793)\n594a05685 [Raúl Gracia] Issue 2795: Bookkeeper upgrade using Bookie ID may fail due to cookie mismatch (#2796)\n354cf37c9 [Raúl Gracia] Upgraded dependencies with CVEs (#2792)\ne413c7094 [Raúl Gracia] Issue 2728: Entry Log GC may get blocked when using entryLogPerLedgerEnabled option (#2779)\n883231ec8 [pradeepbn] Building bookkeeper with gradle on java11","Date":"Fri Oct 29 02:45:35 CEST 2021"},{"Commit-ID":"commit f69f70f182f4f040a6aebf18d114bc7583d44779 1635508864 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Fri Oct 29 20:01:04 2021 +0800]","Body":"Allow to run on java 17, catch InaccessibleObjectException in DirectMemoryCRC32Digest  (#2847)\n\n","Date":"Fri Oct 29 14:01:04 CEST 2021"},{"Commit-ID":"commit fe671ea51bc837d71c54a9db265c3dbd5c990e47 1635525865 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Fri Oct 29 18:44:25 2021 +0200]","Body":"Update version to 4.15.0-SNAPSHOT (Gradle) (#2869)\n\n","Date":"Fri Oct 29 18:44:25 CEST 2021"},{"Commit-ID":"commit 4b0f0fa2a46874033f6440f72b8bea2d6e549cbf 1635836337 -----sp","Author":"PersonIdent[Yuri Mizushima, equanz324@gmail.com, Tue Nov 2 15:58:57 2021 +0900]","Body":"fix: use correct lockpath, store Lock to heldLocks at ZkLedgerUnderreplicationManager#acquireUnderreplicatedLedger (#2855)\n\n","Date":"Tue Nov 02 07:58:57 CET 2021"},{"Commit-ID":"commit 2aa59c74cdd1de13c33a593f6dccc888823c4a83 1635900874 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Wed Nov 3 08:54:34 2021 +0800]","Body":"Add skip unrecoverable ledger option for bookkeeper shell recover command (#2870)\n\n### Motivation\r\nWhen we use `bin/bookkeeper shell recover bookieId` command to recover specific bookie's ledgers, the recover process will exit when occurs recover ledger failed.\r\n\r\nIn our production bookkeeper cluster, we found some ledgers in Open state and has no entry.  When we call `bin/bookkeeper shell recover bookieId` command, it will traverse all the ledgers level by level. In the end, for each ledger, it will call the following code to process recover.\r\n```Java\r\nProcessor<Long> ledgerProcessor = new Processor<Long>() {\r\n            @Override\r\n            public void process(Long ledgerId, AsyncCallback.VoidCallback iterCallback) {\r\n                recoverLedger(bookiesSrc, ledgerId, dryrun, skipOpenLedgers, skipUnrecoverableLedgers, iterCallback);\r\n            }\r\n};\r\n```\r\n\r\nIn the `recoverLedger` method, it will call `asyncOpenLedgerNoRecovery` to open ledger and get LAC if the ledger in `OPEN` state. For the `getLAC` request, if the request ledger has no entry, it will return entry = -1 and return ERROR for this `getLAC` request.\r\nhttps://github.com/apache/bookkeeper/blob/98ddf8149592572eebcfaf6bdd4916f295ffd9d7/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java#L756-L769\r\n\r\nAnd for the `asyncOpenLedgerNoRecovery` callback, it will return error for this process. It will stop the recover process of the following ledgers.\r\n\r\nIn the end, the recover command runs failed, and the following ledger can't be recovered.\r\n\r\n### Changes\r\nWe should expose a flag for user to determine whether to move forward to recover the following ledgers when some ledgers recover failed.\r\n\r\nSo, I provide the parameter `sku` to handle this case.","Date":"Wed Nov 03 01:54:34 CET 2021"},{"Commit-ID":"commit 3adb0b2b093bca4a6bebbcc8ae38900d0acff2c9 1635956308 -----sp","Author":"PersonIdent[pradeepbn, pradipbn@gmail.com, Wed Nov 3 09:18:28 2021 -0700]","Body":"Return too many requests error when the write cache flush timeout occurs (#2860)\n\nReturn too many requests error when there is OperationRejectedException which occurs because of internal resource saturation\r\n","Date":"Wed Nov 03 17:18:28 CET 2021"},{"Commit-ID":"commit ebf716db3128e2a43e923fc60194570fc770a968 1636035927 -----sp","Author":"PersonIdent[Jack Vanlightly, vanlightly@gmail.com, Thu Nov 4 15:25:27 2021 +0100]","Body":"There should only be a single BookieImpl constructor (#2876)\n\nTo have DI on the bookie, it's better to have a single constructor\r\nthat takes all the injected implementations. With a single\r\nconstructor, there's only one place modify in production code when we\r\nwant to inject something, rather than having the bookie need to know\r\nhow to create a \"default\" version (which often breaks encapsulation).\r\n\r\nIf we need convenience constructors for tests, they should live in the\r\ntests.\r\n\r\nCo-authored-by: Ivan Kelly <ikelly@splunk.com>","Date":"Thu Nov 04 15:25:27 CET 2021"},{"Commit-ID":"commit cd6ce3e8d513c62b5802094ca93d1b695c0d3611 1636372454 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Mon Nov 8 12:54:14 2021 +0100]","Body":"Fix flaky AutoRecoveryMainTest (#2881)\n\n","Date":"Mon Nov 08 12:54:14 CET 2021"},{"Commit-ID":"commit 06fe2ab00612c7b91bc1f07aa27fbaaedb492bf2 1636486379 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Tue Nov 9 11:32:59 2021 -0800]","Body":"fix: Stream Storage tests are flaky; statelib test times out (#2883)\n\n","Date":"Tue Nov 09 20:32:59 CET 2021"},{"Commit-ID":"commit c6c29aef618740a181c94a81c86bdf1c450a0e25 1636559519 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Wed Nov 10 16:51:59 2021 +0100]","Body":"Fix checkstyle on \"microbenchmarks\" (#2858)\n\n","Date":"Wed Nov 10 16:51:59 CET 2021"},{"Commit-ID":"commit effb2c1bd59a4a78b9b8a3c6da89da97c0e05e02 1636593304 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Thu Nov 11 09:15:04 2021 +0800]","Body":"Fix typo in method name (#2885)\n\n---\r\n\r\n*Motivation*\r\n\r\nFix typo in DBLedgerStorage. `getLedgerSorage` -> `getLedgerStorage`","Date":"Thu Nov 11 02:15:04 CET 2021"},{"Commit-ID":"commit 4124f1dd3509cd81092163e9def964019e7389ea 1636615900 -----sp","Author":"PersonIdent[hrsakai, hsakai@yahoo-corp.jp, Thu Nov 11 16:31:40 2021 +0900]","Body":"Make maxConcurrentZkRequests for gc configurable (#2797)\n\n","Date":"Thu Nov 11 08:31:40 CET 2021"},{"Commit-ID":"commit 082a521671b472e8d9c2c0fb3704a8ee588cd62e 1636638012 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Thu Nov 11 21:40:12 2021 +0800]","Body":"Release note for 4.14.3 (#2864)\n\n### Motivation\r\n\r\nRelease note for 4.14.3\r\n\r\n","Date":"Thu Nov 11 14:40:12 CET 2021"},{"Commit-ID":"commit ea63b19cf7398dc59f81b7087c877fa03413f040 1636884694 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sun Nov 14 18:11:34 2021 +0800]","Body":"Remove unnecessary boxing unboxing (#2859)\n\n","Date":"Sun Nov 14 11:11:34 CET 2021"},{"Commit-ID":"commit a142ebc08cc855003fbfb674f7e7accb45e1f61f 1637068156 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Tue Nov 16 21:09:16 2021 +0800]","Body":"Fix bookkeeper logger number not correct (#2893)\n\n### Changes\r\n\r\nFix bookkeeper logger number not correct","Date":"Tue Nov 16 14:09:16 CET 2021"},{"Commit-ID":"commit 8720c54904bfe73002abd93b9ae58f7d776cb23d 1637315328 -----sp","Author":"PersonIdent[Jack Vanlightly, vanlightly@gmail.com, Fri Nov 19 10:48:48 2021 +0100]","Body":"Rejected requests counter metric (#2866)\n\nRecording the number of requests that are rejected\r\ndue to overload of internal components is important\r\nfor diagnosing that a bookie is under stress.\r\nPreviously these events were only recorded as request\r\nfailures","Date":"Fri Nov 19 10:48:48 CET 2021"},{"Commit-ID":"commit cc92ca643197d9f1d009ca72c46024c97a09282b 1637315659 -----sp","Author":"PersonIdent[Jack Vanlightly, vanlightly@gmail.com, Fri Nov 19 10:54:19 2021 +0100]","Body":"Journal metrics enhancement (#2865)\n\nThe following metrics changes added to provider greater\r\nresolution to existing metrics:\r\n- all journal metrics now include the journalIndex as a label\r\n- journal memory max and used metrics moved into JournalStats\r\n  and scoped to the journal instance (rather than being and\r\n  aggregated metric).\r\n\r\nFollowing changes to allow for time utilization/saturation\r\ncalculations:\r\n- journal, force write and callback threads report time spent\r\n- journal queue max size added as a gauge\r\n- number of journal directories added as a gauge","Date":"Fri Nov 19 10:54:19 CET 2021"},{"Commit-ID":"commit 7d392780bc73fbab30da758ce5eb06bd009c4748 1637315740 -----sp","Author":"PersonIdent[Jack Vanlightly, vanlightly@gmail.com, Fri Nov 19 10:55:40 2021 +0100]","Body":"BP-44: OrderedExecutor metrics (#2861)\n\n* Removed double nested TimedCallable and TimedRunnable\r\n\r\nThe TimedCallable and TimedRunnable are added by decorators\r\nalready which caused a second instance to be nested resulting\r\nin metrics being recorded twice. This commit removes this\r\ndouble nesting.\r\n\r\n* Moved OrderedExecutor thread ordinal number from metric names to label\r\n\r\n* OrderedExecutor thread metrics\r\n\r\nOrderedExecutor metrics can be configured to be scoped\r\nby thread. Enabled on the server-side BookieRequestProcessor\r\nand left disabled in the client and all tests.","Date":"Fri Nov 19 10:55:40 CET 2021"},{"Commit-ID":"commit 306312b2bc60027a5755ddb37664ca0caca5b038 1637315773 -----sp","Author":"PersonIdent[Jack Vanlightly, vanlightly@gmail.com, Fri Nov 19 10:56:13 2021 +0100]","Body":"Removed bookie port number from OrderedExecutor name (#2880)\n\nIncluding the port number only complicates things for\r\nadmins who rely on OrderedExecutor metrics for alerts\r\nand dashboards. Removing the port number reduces,\r\nthe complexity for deployments which use various\r\nnon-standard bookie ports.","Date":"Fri Nov 19 10:56:13 CET 2021"},{"Commit-ID":"commit e9e9bf92f7c124fb11d8de57fdfec860441ac8a8 1637319415 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Fri Nov 19 02:56:55 2021 -0800]","Body":"Reduce flakiness of TestBKDistributedLogManager (#2892)\n\n* Got rid of OODME by ensuring the cleanup of resources.\r\n\r\n* TestNonBlockingReadsMultiReader: load test base config\r\n\r\n* localize max num of bookies effect to one test suite","Date":"Fri Nov 19 11:56:55 CET 2021"},{"Commit-ID":"commit b57010737ef9a2c78daf5b19b17c075706eb3c21 1637655816 -----sp","Author":"PersonIdent[pradeepbn, pradipbn@gmail.com, Tue Nov 23 00:23:36 2021 -0800]","Body":"Fix the compatibility workflows (#2899)\n\n* Fix workflow yaml for compatibility tests\r\n\r\n* remove duplicate of com.google relocate in build.gradle","Date":"Tue Nov 23 09:23:36 CET 2021"},{"Commit-ID":"commit abf1a96e38bb74f7f7a47e9b6f2b337bd07d622f 1637767654 -----sp","Author":"PersonIdent[Jack Vanlightly, vanlightly@gmail.com, Wed Nov 24 16:27:34 2021 +0100]","Body":"Construct and inject bookie components (#2901)\n\n* Construct and inject bookie components\r\n\r\nConstruct and inject metadata driver and ledger storage outside of\r\nthe BookieImpl. Also extract the cookie validation into a separate\r\ninjectable interface.\r\n\r\nThe metadata driver is a factory that creates the correct metadata\r\naccessors based on the configuration of the bookie. This is used by\r\nmultiple components, so should be constructed before these\r\ncomponents and passed in as a parameter.\r\n\r\nPreviously it was constructed by the bookie, and other components\r\ncalled into the bookie to get the instance, which broken encapsulation\r\nof the bookie and let to a bunch of ugly mocking.\r\n\r\nThis change also removes a circular dependency in the construction of\r\nthe RegistrationManager. Previously it was requiring a listener on\r\nconstruction, but the listener needed the bookie instance, so it all\r\nwent through a supplier. Now the listener is not needed at\r\nconstruction, but rather it is registered then the bookie starts.\r\n\r\nThis change also adds an injectable interface for cookie validation. The\r\nlegacy implementation of this interface is then injected into the\r\nBookieImpl on creation. The legacy implementation is code moved out of\r\nthe BookieImpl class itself.\r\n\r\nInjecting ledger storage is good for encapsulation, as it stops the\r\nledgerstorage depending on bookie behaviour. To that end, this change\r\nhighlights a couple of circular dependencies. Notably, between the\r\nledger storage and each of the statemanager, checkpointer and\r\ncheckpointState. I've removed each of these from\r\nLedgerStorage#initialize() so that is is clearer that these are\r\ncircular, and so that they can be fixed one by one.\r\n\r\nOne thing to note in this change is that the order of initialization\r\nhas changed. LedgerStorage is initialized before the cookie\r\ncheck. This means that directory structure needs to be checked before\r\nthe cookie check. Previously it was done as part of the cookie\r\ncheck. Ledger storage must be initialized before the cookie check, as\r\nthe cookie check needs to use ledger storage to update limbo bits.\r\n\r\nBookieImpl is still responsible for shutting down the LedgerStorage. I\r\nwould have changed this, but it would have meant a lot of changes, as\r\nthere are good few ledger storage implementations.\r\n\r\n* Ensure RegistrationManagers are closed\r\n\r\n* Remove PortManager next port and args that set it\r\n\r\n* Fix checkstyle in tests\r\n\r\n* Add stacktrace to standalone test\r\n\r\n* Add --debug to standalone test\r\n\r\n* Add dynamic scaling to LocalBookKeeper\r\n\r\nSome tests in distributedlog require the ability\r\nto scale up and down bookies, using the\r\nLocalBookKeeper class but doing so using\r\nBookieServer directly. Now that components are\r\nconstructed outside of BookieServer, this scaling\r\nhad to be built into LocalBookKeeper itself so\r\nthe components could be constructed and destroyed\r\ncorrectly.\r\n\r\n* Moved state store server creation to constructor\r\n\r\n* Remove stacktrace option from standalone test\r\n\r\nCo-authored-by: Ivan Kelly <ikelly@splunk.com>","Date":"Wed Nov 24 16:27:34 CET 2021"},{"Commit-ID":"commit 4576ec98a8a1f1894f61d74ff834559868022d7d 1638285621 -----sp","Author":"PersonIdent[Jack Vanlightly, vanlightly@gmail.com, Tue Nov 30 16:20:21 2021 +0100]","Body":"BP-44: Ledger storage metrics enhancement (#2862)\n\n* Ledger storage metrics enhancement\r\n\r\nVarious enhancements related to DbLedgerStorage:\r\n- All DbLedgerStorage stats now report their ledgerDir.\r\n- Read cache hit/misses now differentiated from write cache.\r\n- Read/write cache hit/misses now counters, not OpStatsLoggers.\r\n  The OpStatsLoggers are relatively expensive and the counter\r\n  values are most important here.\r\n- Stats where thread info useful are now thread-scoped. In\r\n  general the focus is on time based metrics for operations\r\n  carried out by the read/write thread pools.\r\n- Time spent counters on sub-operations for reads (entry log,\r\n  locations index, readahead).\r\n- Flush time started moved to after lock to avoid 200% time\r\n  utilization calculations. Can reach 200% because one thread\r\n  is busy flusing and another busy waiting on the lock.\r\n- Time spent counters on sub-operations for flushes (entry log,\r\n  locations index, ledgers index).\r\n- DbStorage thread reports time utilization.\r\n- SyncThread reports time utilization.\r\n\r\nSome new gauges that report configuration values which are useful\r\nfor utilization calculations in dashboards/alerts:\r\n- Write cache max size.\r\n- Number of ledger dirs.\r\n- Readahead batch size.\r\n\r\n* Fix checkstyle","Date":"Tue Nov 30 16:20:21 CET 2021"},{"Commit-ID":"commit f6ebb0f7bf41d2dbce2f314f1178a03ff976f87a 1638348352 -----sp","Author":"PersonIdent[JiangHaiting, jason.918@qq.com, Wed Dec 1 16:45:52 2021 +0800]","Body":"Cleanup unused Journal#EMPTY_ARRAY_LIST (#2917)\n\n","Date":"Wed Dec 01 09:45:52 CET 2021"},{"Commit-ID":"commit 7395bb48e2ff41fac93a84ff8bfa9097bd0af8fe 1638380248 -----sp","Author":"PersonIdent[pradeepbn, pradipbn@gmail.com, Wed Dec 1 09:37:28 2021 -0800]","Body":"Reorder the sequence of the bookkeeper server shutdown (#2888)\n\nReorders the sequence of the bookkeeper server shutdown\r\nso that any in-progress reads or writes don't hit ledger\r\nstorage after it has been shutdown. Now the request processor\r\nis shutdown before the bookie.\r\n\r\nAn additional check if the channel is active is performed in\r\nthe packet processor callbacks before sending response \r\nto avoid RejectedExecutionException messages within\r\nNetty from polluting the log.","Date":"Wed Dec 01 18:37:28 CET 2021"},{"Commit-ID":"commit 163df5b203d3e341ee9e3e5738ba5e1be2af4112 1638545094 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Fri Dec 3 16:24:54 2021 +0100]","Body":"Gradle compileJava: enable -Xlint options (#2919)\n\n* Enable -Xlint:unchecked -Xlint:deprecation -Werror on all projects","Date":"Fri Dec 03 16:24:54 CET 2021"},{"Commit-ID":"commit 684a0c3e17180a8618bff036e2f0add303bc910d 1638858203 -----sp","Author":"PersonIdent[Aloys, lofterzhang@gmail.com, Tue Dec 7 14:23:23 2021 +0800]","Body":"Remove legacy code to resolve class missing error (#2918)\n\n","Date":"Tue Dec 07 07:23:23 CET 2021"},{"Commit-ID":"commit fd358fdb145f7ca460bdad2134408f63260f8106 1639121846 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Fri Dec 10 15:37:26 2021 +0800]","Body":"Allow to configure bookie http host (#2914)\n\n","Date":"Fri Dec 10 08:37:26 CET 2021"},{"Commit-ID":"commit 3ff15525a90bd2f9d9e8b50bdd2eac5365ea6b34 1639176955 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sat Dec 11 06:55:55 2021 +0800]","Body":"Bump log4j2 to 2.15.0 (#2933)\n\n","Date":"Fri Dec 10 23:55:55 CET 2021"},{"Commit-ID":"commit 9167d2af587e5b84a156635874dc9c9a8da0ac39 1639255046 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Sun Dec 12 04:37:26 2021 +0800]","Body":"Cleanup code in RackawareEnsemblePlacementPolicyImpl (#2920)\n\n* Cleanup code:\r\n1.RackawareEnsemblePlacementPolicyImpl.REPP_DNS_RESOLVER_CLASS has be existed in his parent class\r\n2.NetUtils.logger is no use\r\n\r\n* remove no use import\r\n\r\nCo-authored-by: lushiji <lushiji@didiglobal.com>","Date":"Sat Dec 11 21:37:26 CET 2021"},{"Commit-ID":"commit 28de93dd6a377ecf4d91ef54bf06a49c9bb956b5 1639328712 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sun Dec 12 09:05:12 2021 -0800]","Body":"ReplicationWorker should not try to create a ZK based LedgerManagerFactory (#2935)\n\n* ReplicationWorker should not try to create a ZK based LedgerManagerFactory\r\n\r\n* Get the ledger factory from the bk client instead\r\n\r\n* Removed unused imports","Date":"Sun Dec 12 18:05:12 CET 2021"},{"Commit-ID":"commit a2d73416667a94597d507f9a27b1561d39366c98 1639396502 -----sp","Author":"PersonIdent[gaozhangmin, gaozhangmin456@qq.com, Mon Dec 13 19:55:02 2021 +0800]","Body":"Ledger replicate supports throttle (#2778)\n\n### Motivation\r\n\r\nLedger replicating puts  heavy loads on cluster.\r\nNow,  ledger replicate only supports split fragments into small pieces.\r\n But, throttling is not supported.\r\n\r\n### Changes\r\n\r\nAdd a confiuration `replicationRateByBytes `\r\n\r\nsupport throttling  read rate in bytes.\r\n\r\nAlso bookkeeper shell recover command supports throttle.\r\n","Date":"Mon Dec 13 12:55:02 CET 2021"},{"Commit-ID":"commit 3218f9d3dfaa4095496e125614fbdcf546bfe970 1639490069 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Dec 14 05:54:29 2021 -0800]","Body":"Upgrade to Grpc 1.42.1 (#2934)\n\n* Upgrade to Grpc 1.42.1\r\n\r\n* Fixed Guava classpath issue in tests with Gradle\r\n\r\n* Also update jetcd to 0.5.11\r\n\r\n* Fixed test mock initialization\r\n\r\n* Fixed license file\r\n\r\n* Fixed guava dependency in stream/proto\r\n\r\n* More guava dep runtime issues\r\n\r\n* More guava deps\r\n\r\n* Fixed license file\r\n\r\n* Fixed protobuf version in license file\r\n\r\n* Added logs for etcd driver tests\r\n\r\n* Added test assertions\r\n\r\n* Added assert debug string when validate fails\r\n\r\n* Added gradle info logs\r\n\r\n* Fixed test regex\r\n\r\n* More test regex\r\n\r\n* More regexes\r\n\r\n* Line too long","Date":"Tue Dec 14 14:54:29 CET 2021"},{"Commit-ID":"commit e5dbc4f25d52f35ba0a0ad2d3d546e83393aab34 1639530815 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Wed Dec 15 09:13:35 2021 +0800]","Body":"Forget to Add tlsProviderFactoryClass in the tls doc (#2915)\n\n","Date":"Wed Dec 15 02:13:35 CET 2021"},{"Commit-ID":"commit ecd1d30ae8371eabd368179bc652b2804b99623b 1639641973 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Thu Dec 16 16:06:13 2021 +0800]","Body":"upgrade log4j2 from 2.15.0 to 2.16.0 (#2938)\n\n### Motivation\r\nApache Log4j 2.16.0 was just released. It is a more complete fix for Log4Shell. See the Apache Log4j mailing list for details: https://lists.apache.org/thread/d6v4r6nosxysyq9rvnr779336yf0woz4\r\n\r\n### Modifications\r\nUpdate log4j version from 2.15.0 to 2.16.0.\r\n\r\n### Verifying this change\r\nBased on the release notes, this change should be trivial.","Date":"Thu Dec 16 09:06:13 CET 2021"},{"Commit-ID":"commit 7385d90189b2aa9ae11418a7c1c0fa60e5d0ea25 1639659290 -----sp","Author":"PersonIdent[chenlin, 1572139390@qq.com, Thu Dec 16 20:54:50 2021 +0800]","Body":"Remove BK_CLIENT_SCOPE in ReplicationStats. It's not used anymore. (#2923)\n\n","Date":"Thu Dec 16 13:54:50 CET 2021"},{"Commit-ID":"commit 05f42e5dd466437bd0ae08190f065cc7c2ec05a7 1640118261 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Wed Dec 22 04:24:21 2021 +0800]","Body":"Bump log4j2 to 2.17.0 (#2949)\n\n","Date":"Tue Dec 21 21:24:21 CET 2021"},{"Commit-ID":"commit 10081d2720ed33314ecffa80c6ddc744a3f83047 1640146799 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Wed Dec 22 05:19:59 2021 +0100]","Body":"[security] Upgrade Netty to 4.1.72 - CVE-2021-43797 (#2951)\n\n### Motivation\r\n\r\nNetty versions prior to 4.1.71 are vulnerable to CVE-2021-43797\r\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-43797\r\n\r\n\r\nNetty release notes:\r\n- https://netty.io/news/2021/10/11/4-1-69-Final.html\r\n- https://netty.io/news/2021/10/11/4-1-70-Final.html\r\n- https://netty.io/news/2021/12/09/4-1-71-Final.html\r\n- https://netty.io/news/2021/12/13/4-1-72-Final.html\r\n\r\n\r\n### Changes\r\n- Upgraded Netty libraries to 4.1.72.Final\r\n- Upgraded netty-tcnative-boringssl-static to 2.0.46.Final which is compatible with Netty 4.1.72.Final","Date":"Wed Dec 22 05:19:59 CET 2021"},{"Commit-ID":"commit 370d785ff674841943fa8cddee1964408e826f5b 1640156515 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Tue Dec 21 23:01:55 2021 -0800]","Body":"[bookie-gc] add option to cache entry-log metadata map into rocksDB (#1949)\n\n### Motivation\r\n\r\nIt addresses #1938, where it provides interface for `entyLogMetadataMap` so, `entrylogMetadata` can be cached into RocksDB instead main-memory.\r\n\r\n### Modification\r\n- introduced RocksDB entryLogMetadataMap to cache entry-log metadata.\r\n- it can fallback to in-memory implementation using  `gcPersistentEntrylogMetadataMapEnabled` flag and that can be removed in future release and keep only rocksDB implementation in future.\r\n\r\n### Result\r\n- It will help to avoid storing entryLogMetadata into main-memory.\r\n","Date":"Wed Dec 22 08:01:55 CET 2021"},{"Commit-ID":"commit b65a20a78d3f2b42dc3377d7452740a7da433b9e 1640186398 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Dec 22 07:19:58 2021 -0800]","Body":"Allow to easily override `zkServers` with `metadataServiceUri` (#2952)\n\n","Date":"Wed Dec 22 16:19:58 CET 2021"},{"Commit-ID":"commit 74bbeec7a61ecf948188485f9f5e0f6a2a210567 1640246691 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Thu Dec 23 09:04:51 2021 +0100]","Body":"Gradle - Enable backward-compatibility tests (#2937)\n\n","Date":"Thu Dec 23 09:04:51 CET 2021"},{"Commit-ID":"commit 4dae979c5b35c434105f0c9810c87dd91237bb7e 1640252608 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Thu Dec 23 17:43:28 2021 +0800]","Body":"fix readlogMetadata get logid is 0 bug (#2349)\n\n### Motivation\r\nWhen i use `bookkeeper shell readlogmetadata`  to get an entrylog file's metadata info, i encountered the following exception:\r\n```\r\n19:51:11.282 [main] INFO  org.apache.bookkeeper.bookie.EntryLogger - Failed to get ledgers map index from: 0.log : No file for log 0\r\n19:51:11.284 [main] WARN  org.apache.bookkeeper.bookie.EntryLogger - Failed to get channel to scan entry log: 0.log\r\nException in thread \"main\" com.google.common.util.concurrent.UncheckedExecutionException: No file for log 0\r\n\tat org.apache.bookkeeper.tools.cli.commands.bookie.ReadLogMetadataCommand.apply(ReadLogMetadataCommand.java:106)\r\n\tat org.apache.bookkeeper.bookie.BookieShell$ReadLogMetadataCmd.runCmd(BookieShell.java:988)\r\n\tat org.apache.bookkeeper.bookie.BookieShell$MyCommand.runCmd(BookieShell.java:223)\r\n\tat org.apache.bookkeeper.bookie.BookieShell.run(BookieShell.java:1976)\r\n\tat org.apache.bookkeeper.bookie.BookieShell.main(BookieShell.java:2067)\r\nCaused by: java.io.FileNotFoundException: No file for log 0\r\n\tat org.apache.bookkeeper.bookie.EntryLogger.findFile(EntryLogger.java:960)\r\n\tat org.apache.bookkeeper.bookie.EntryLogger.getChannelForLogId(EntryLogger.java:895)\r\n\tat org.apache.bookkeeper.bookie.EntryLogger.scanEntryLog(EntryLogger.java:976)\r\n\tat org.apache.bookkeeper.bookie.EntryLogger.extractEntryLogMetadataByScanning(EntryLogger.java:1132)\r\n\tat org.apache.bookkeeper.bookie.EntryLogger.getEntryLogMetadata(EntryLogger.java:1041)\r\n\tat org.apache.bookkeeper.tools.cli.commands.bookie.ReadLogMetadataCommand.printEntryLogMetadata(ReadLogMetadataCommand.java:132)\r\n\tat org.apache.bookkeeper.tools.cli.commands.bookie.ReadLogMetadataCommand.readLogMetadata(ReadLogMetadataCommand.java:125)\r\n\tat org.apache.bookkeeper.tools.cli.commands.bookie.ReadLogMetadataCommand.apply(ReadLogMetadataCommand.java:104)\r\n\r\n```\r\n\r\nIn the source code, it parse the entry log id with 10 radix, however, the entry log file name is 16 radix entry log id and parse failed. Then parsing it with entry log file name, and set the log file name into flags. When parse the flags in `ReadLogMetadataCommand` class, it first check\r\n```\r\nprivate static final long DEFAULT_LOGID = -1L\r\nif (flags.logId != DEFAULT_LOGID) {\r\n     logid = flags.logId;\r\n}\r\n```\r\nthe default flag.logid is 0, so the `logid` will be set to 0.\r\n\r\n### Changes\r\n1. using `16 radix` to parse entry log id\r\n2. when using entry log file name to get entry log metatdata, set the flags.logid to `-1`\r\n3. export entry log usage to the output","Date":"Thu Dec 23 10:43:28 CET 2021"},{"Commit-ID":"commit 0fdf2419d0a46e6ad5ae105fd873263a423a4432 1641591122 -----sp","Author":"PersonIdent[Prashant Kumar, 65131575+pkumar-singh@users.noreply.github.com, Fri Jan 7 13:32:02 2022 -0800]","Body":"Adding Prashant Kumar to committer list (#2971)\n\nCo-authored-by: Prashant Kumar <prashantk@splunk.com>","Date":"Fri Jan 07 22:32:02 CET 2022"},{"Commit-ID":"commit 0c900c808ef700c2c010138db413e279c745e258 1641591770 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Fri Jan 7 22:42:50 2022 +0100]","Body":"Backward compatibility tests: add retries (#2978)\n\n","Date":"Fri Jan 07 22:42:50 CET 2022"},{"Commit-ID":"commit 283e01aa786b1df5e7a8bac6688ec60042662fe8 1641591816 -----sp","Author":"PersonIdent[mauricebarnum, mbarnum@splunk.com, Fri Jan 7 13:43:36 2022 -0800]","Body":"Update gradle to 6.9.1 (#2972)\n\nUpdate gradle to 6.9.1 to reduce the amount of drift from the latest\r\nstable gradle release.","Date":"Fri Jan 07 22:43:36 CET 2022"},{"Commit-ID":"commit 3fcceb165c374dcc009b7fa8055b76232b922742 1641668080 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sun Jan 9 02:54:40 2022 +0800]","Body":"[security] Bump bc fips version from 1.0.2 to 1.0.2.1 (#2976)\n\n* Bump bc fips version from 1.0.2 to 1.0.2.1\r\n\r\n* fix license file","Date":"Sat Jan 08 19:54:40 CET 2022"},{"Commit-ID":"commit 3301a4acb18647522942ac52a88b7819c0f206df 1641748994 -----sp","Author":"PersonIdent[chenlin, 1572139390@qq.com, Mon Jan 10 01:23:14 2022 +0800]","Body":"fix method description (#2959)\n\n","Date":"Sun Jan 09 18:23:14 CET 2022"},{"Commit-ID":"commit 27e7973fc0b1755d8fc0fb4a163349e4bff561c3 1641757468 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Mon Jan 10 03:44:28 2022 +0800]","Body":"Updated Notice file, set 2022 (#2979)\n\n","Date":"Sun Jan 09 20:44:28 CET 2022"},{"Commit-ID":"commit 84ddc9116b36221c92df89bc2f55eeff5c0442c5 1641778672 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Mon Jan 10 09:37:52 2022 +0800]","Body":"zk client config update and bugfix for ZKMetadataClientDriver (#2958)\n\n### Motivation\r\n\r\n1. bug fix for error config for BoundExponentialBackoffRetryPolicy in class ZKMetadataClientDriver,if set MaxRetries zero, zk client will throw ConnectionLossException when the zk has some changing,for example: zk leader node changed.\r\n\r\n2. In Bookie's ZKClient, different BoundExponentialBackoffRetryPolicy set different MaxRetries,so change zkRetryBackoffMaxRetries to config in Bookie's AbstractConfiguration\r\n\r\n### Changes\r\n\r\n1. update a error config for BoundExponentialBackoffRetryPolicy in class ZKMetadataClientDriver\r\n2. change zkRetryBackoffMaxRetries to config\r\n\r\nMaster Issue: #2760 \r\n","Date":"Mon Jan 10 02:37:52 CET 2022"},{"Commit-ID":"commit 93d6e61a06d196ed0d701f5783dd51870d5fc9e9 1641778881 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Mon Jan 10 09:41:21 2022 +0800]","Body":"check all Op requests and update log (#2969)\n\n* check all Op requests and update log\r\n\r\n* format old log\r\n\r\n* format old log\r\n\r\nCo-authored-by: lushiji <lushiji@didiglobal.com>","Date":"Mon Jan 10 02:41:21 CET 2022"},{"Commit-ID":"commit ee2462ce30341583eb7f4471ca27c72771a1202f 1641845434 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Tue Jan 11 04:10:34 2022 +0800]","Body":"Replace gradle deprecated api use runtime to runtimeClasspath (#2925)\n\n","Date":"Mon Jan 10 21:10:34 CET 2022"},{"Commit-ID":"commit 7c42c9d54152e4886617ff6a9388f7e3a330d2d6 1641900938 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Tue Jan 11 19:35:38 2022 +0800]","Body":"bug fix for EntryLocationIndex.getLastEntryInLedger (#2946)\n\n### Motivation\r\n\r\nbug fix for EntryLocationIndex.getLastEntryInLedger\r\nwhen the ledger is deleted, then get last entry in this ledger, two case in method(name is EntryLocationIndex.getLastEntryInLedger)\r\n\r\ncase return -1:\r\n    1)  when the ledger is deleted,return -1\r\n    2)  then the method(name is SingleDirectoryDbLedgerStorage.getLastEntry) should read entry's location index,  but entryID's value is -1, the code will throw a unexcepted error( error information is \"IOException: org.apache.bookkeeper.bookie.EntryLogger$EntryLookupException$MissingLogFileException: Missing entryLog 0 for ledgerId ***, entry -1 at offset 0\", if you want to get more details,you can read the Issue: #2927 \r\n\r\ncase throw NoEntryException:\r\n    1)  when the ledger is deleted,throw NoEntryException like the method( name is  **getLastEntryInLedgerInternal** )  solving ledgerId is not found\r\n    2)  then the method(name is SingleDirectoryDbLedgerStorage.getLastEntry) just throw NoEntryException , don't need to read entry's location index and entry's log\r\n\r\n\r\nFrom what has been discussed above\r\nWhen ledger is deleted, it is more correct to return NoEntryException when get last entry\r\n\r\n### Changes\r\n\r\n1.if the ledger has been deleted,run default path for NoEntryException\r\n\r\nMaster Issue: #2927 \r\n","Date":"Tue Jan 11 12:35:38 CET 2022"},{"Commit-ID":"commit 525a4a03f99afe1dca120477273537a6db46873c 1641925880 -----sp","Author":"PersonIdent[chenlin, 1572139390@qq.com, Wed Jan 12 02:31:20 2022 +0800]","Body":"checkAllLedgers in Auditor supports read throttle (#2973)\n\n* support  read throttle in checkAllLedgers\r\n\r\n* using number of entries in flight (using Semaphore, releasing when processed) instead of guessing avg sizes and rate limiting.\r\n\r\n* using number of entries in flight (using Semaphore, releasing when processed) instead of guessing avg sizes and rate limiting.\r\n\r\n* check style","Date":"Tue Jan 11 19:31:20 CET 2022"},{"Commit-ID":"commit 8b0351b1674cef65cd12219ba4a50f6b880135db 1641941142 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Jan 11 14:45:42 2022 -0800]","Body":"Website changes for 4.14.4 release (#2987)\n\n* Added release notes for 4.14.4\r\n\r\n* Website changes for 4.14.4 release","Date":"Tue Jan 11 23:45:42 CET 2022"},{"Commit-ID":"commit a65e888b25eb966921ff39032e04f367a553d634 1642002438 -----sp","Author":"PersonIdent[Jack Vanlightly, vanlightly@gmail.com, Wed Jan 12 16:47:18 2022 +0100]","Body":"BP-46: Data integrity check for running without journal (#2936)\n\n* Data integrity check\r\n\r\nThe integrity check is comprised two parts: a preboot check that\r\nis triggered by either an unclean shutdown or an invalid cookie.\r\nThe preboot check marks any open ledgers as both fenced and in\r\nlimbo to prevent ledgers affected by potential data loss from\r\nbeing written to. The limbo status prevents NoSuchEntry and\r\nNoSuchLedger responses from being sent which avoid ledger\r\ntruncation from any ledger recovery operations. Finally it sets\r\na storage flag that a full check is required.\r\n\r\nA new data integrity check service has been to run the full\r\nintegrity check once the bookie is running. If the service\r\nsees that the full check storage flag is set then it runs\r\na full check. This involves scanning the index and comparing\r\nit against metadata to discover missing entries. Any\r\nmissing entries are sourced from peer bookies by the\r\nEntryCopier and written to ledger storage.\r\n\r\nThe data integrity check also has a different cookie validation\r\nimplementation.\r\n\r\nThe following configurations have been added to the conf\r\nfile:\r\n- dataIntegrityCheckingEnabled=true/false. False by default.\r\n  This config enables or disables data integrity checking.\r\n  When set to false the legacy cookie validation is used.\r\n- dataIntegrityStampMissingCookies=true/false. False by\r\n  default. This config allows the data integrity process\r\n  to stamp new cookies if a cookie is missing from a\r\n  directory. The full check will repair any lost data if\r\n  the directory data was lost.\r\n\r\n* Cookie verification for data integrity checking\r\n\r\nThe algorithm differs from that of LegacyCookieValidation in the\r\nfollowing ways:\r\n\r\n- A empty directory isn't considered a fatal condition. It just means\r\n  that the preboot phase of the data integrity checker must run. Once\r\n  the preboot phase runs, it should be safe to stamp the cookies\r\n  again.\r\n- Bookies are not allowed to change their identity. If they do, manual\r\n  operator intervention is required (which is ok as it is expected\r\n  that an operator would have to intervene to change the identity in\r\n  the first place).\r\n- A missing cookie in zookeeper is only valid, if there are no cookies\r\n  in any of the directories, as this is considered a new\r\n  boot. Otherwise, manual operator intervention is required.\r\n\r\n* Async iterator for ledger metadata\r\n\r\nCommon code for iterating over ledger metadata. There is already\r\nasyncProcessLedgers in LedgerManager, but that only gives the ledgerId\r\nand the API is nasty (it even uses ZK specific callbacks).\r\n\r\nThis change adds a more modern iterator, which takes a function which\r\nreturns a CompletableFuture. The iterator has rudimentary rate\r\nlimiting, by limiting the number of ledgers which can be processed at\r\na time. We should add something more advanced later, which takes into\r\naccount the response time from ZK.\r\n\r\n* Add limbo state to bookie ledger representation\r\n\r\nLimbo state for a ledger means that we don't know whether we should\r\nhave an entry for the ledger or not, which can happen when a bookie is\r\nstarted after having its disk wiped. We cannot response with a\r\nNoSuchEntryException or NoSuchLedgerException as this tell the client\r\nthat we never had the requested entry, which may or may not be true,\r\nbut if we tell it to the client, the client will act like it's true\r\nand possible mark the end of the ledger at an incorrect point.\r\n\r\nThis change also adds locking to LedgerMetadataIndex. Previously it\r\nrelied on the good graces to the calling code to avoid modifying the\r\nsame ledger concurrently. Now that we are also using the index to\r\nstore limbo state, we can't be so blasé.\r\n\r\n* Add entryExists call to ledgerStorage\r\n\r\nCurrently the only way to check if an entry exists in the storage is\r\nto try to read the entry. However, this means pulling data out of the\r\nentrylog, which it should be sufficient to check that the entry exists\r\nin the index.\r\n\r\nThis change adds the entryExists call to ledgerStorage. This has only\r\nbeen implemented for DbLedgerStorage. The implementation for the\r\nothers should be trivial, but it needs to be tested.\r\n\r\n* Pregenerate the writeset from ledger metadata\r\n\r\nThe bookkeeper client uses DistributionSchedule (of which\r\nRoundRobinDistributionSchedule is the only impl) to decide which\r\nmembers of the ensemble it writes an entry to. This writeset is\r\ngenerated for each entry. However, there is only |ensemble| possible\r\nwritesets, so we should pregenerate them for the ledger and stop\r\ntrashing memory.\r\n\r\nWriteSets represent a set of pregenerated writesets as would be\r\notherwise generated from the distribution schedule. The constructor\r\ntakes a list of indices (which should be generated based on the list\r\nof bookies in the ensemble), which specifies the preferred order that\r\nbookies should be tried for reads.\r\n\r\n* Storage state flags for LedgerStorage\r\n\r\nIf a bookie crashes in the middle of a full integrity check, it needs\r\nto know to start it again when it reboots. For this, we need to\r\npersist some flag to persistent storage.\r\n\r\nThis change adds persistent flags to the ledger storage\r\ninterface. Multiple flags can be added in future, for example to mark\r\nthe storage as dirty on boot, so we can detect non-clean shutdown.\r\n\r\nFlags are only implemented for DbLedgerStorage. The flags are stored\r\nin the metadata index, with a negative ledger id as key. The key of\r\nthe storage selected for ledger 0 is used. This does mean flags will\r\nbe lost if there is a change in the storage disk configuration, but\r\ndata integrity checks will run in this case regardless.\r\n\r\n* EUNKNOWN code\r\n\r\nA new response code has been added to communicate that the state\r\nof an entry is unknown due the ledger being in limbo.\r\n\r\n* Added bookie unclean shutdown detection\r\n\r\nAdds unclean shutdown detection. When running with journal\r\nwrites disabled and data integrity checking enabled, if\r\nthe prior shutdown was unclean (not a graceful shutdown)\r\nthen the data integrity checks are triggered. These checks\r\navoid additional data loss scenarios and repair any lost\r\ndata caused by the loss of unflushed data at the time\r\nof the unclean shutdown.\r\n\r\nThe BookieServer registers start-up and shutdown with the\r\nUncleanShutdownDetection class. This class adds a dirty\r\nfile to each ledger dir on registering start-up and clears\r\nall these files on registering shutdown. The presence of\r\nany of these files on boot-up indicates the prior shutdown\r\nwas unclean.\r\n\r\nCo-authored-by: Ivan Kelly <ikelly@splunk.com>","Date":"Wed Jan 12 16:47:18 CET 2022"},{"Commit-ID":"commit bbc690f4230278419639f69687b88fe2a2aa091d 1642009461 -----sp","Author":"PersonIdent[Nicholas Nezis, nicholas.nezis@gmail.com, Wed Jan 12 12:44:21 2022 -0500]","Body":"Bump log4j2 to 2.17.1 (#2988)\n\n","Date":"Wed Jan 12 18:44:21 CET 2022"},{"Commit-ID":"commit 3f30d22a185a775fac6fe10da2c1f12e4f7e4005 1642009504 -----sp","Author":"PersonIdent[chenlin, 1572139390@qq.com, Thu Jan 13 01:45:04 2022 +0800]","Body":"if entrySize > segmentSize ,will throw IndexOutOfBoundsException when put entry into ReadCache (#2982)\n\n","Date":"Wed Jan 12 18:45:04 CET 2022"},{"Commit-ID":"commit e7688fa520de1bfec164b991c3a5d189812c10dd 1642048167 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Thu Jan 13 12:29:27 2022 +0800]","Body":"wait a BackOff Time when rereplicate failed (#2967)\n\n* reduce CPU Resource:\r\nwhen the other bookie restart,rereplicate will run failed for BookieIdNotResolvedException,\r\nso wait a BackOff Time when rereplicate run failed\r\n\r\n* clean error code\r\n\r\nCo-authored-by: lushiji <lushiji@didiglobal.com>","Date":"Thu Jan 13 05:29:27 CET 2022"},{"Commit-ID":"commit bc02d8c487a809fa58d75c477d9e2d5c7dedccec 1642096441 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Fri Jan 14 01:54:01 2022 +0800]","Body":"Bump gradle plugin version (#2985)\n\n","Date":"Thu Jan 13 18:54:01 CET 2022"},{"Commit-ID":"commit 3570f83fd5f435e4505e3c5c15c8ff7685a8581a 1642382533 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sun Jan 16 17:22:13 2022 -0800]","Body":"Added release notes for 4.14.4 (#2986)\n\n### Motivation\r\n\r\nAdded release notes for 4.14.4","Date":"Mon Jan 17 02:22:13 CET 2022"},{"Commit-ID":"commit 002725ea5a25073de190bfe29f622d85fa264f0a 1642386091 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Mon Jan 17 10:21:31 2022 +0800]","Body":"fix region aware placement policy use disk weight not work (#2981)\n\n### Motivation\r\nWhen we meet the following conditions:\r\n1. configured region aware placement policy\r\n2. enable disk weight based placement\r\n3. fallback random selection when selecting ensemble bookies, such as:\r\n     - not enough regions\r\n     - rack number less than 2 in one region\r\n\r\nIt will throw the following exception, and create ledger failed.\r\n```\r\n12:15:36.459 [bookkeeper-ml-scheduler-OrderedScheduler-1-0] ERROR org.apache.bookkeeper.mledger.impl.ManagedLedgerImpl - [public/default/persistent/test_v2] Encountered unexpected error when creating ledger\r\njava.lang.NullPointerException: null\r\n        at org.apache.bookkeeper.client.WeightedRandomSelectionImpl.getNextRandom(WeightedRandomSelectionImpl.java:150) ~[io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:748) ~[io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:698) ~[io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.newEnsembleInternal(RackawareEnsemblePlacementPolicyImpl.java:409) ~[io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.newEnsemble(RackawareEnsemblePlacementPolicyImpl.java:372) ~[io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.newEnsemble(RackawareEnsemblePlacementPolicy.java:159) ~[io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.client.RegionAwareEnsemblePlacementPolicy.newEnsemble(RegionAwareEnsemblePlacementPolicy.java:303) ~[io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.client.BookieWatcherImpl.newEnsemble(BookieWatcherImpl.java:270) ~[io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.client.LedgerCreateOp.initiate(LedgerCreateOp.java:161) ~[io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.client.BookKeeper.asyncCreateLedger(BookKeeper.java:860) ~[io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.mledger.impl.ManagedLedgerImpl.asyncCreateLedger(ManagedLedgerImpl.java:3657) ~[io.streamnative-managed-ledger-2.8.1.30.jar:2.8.1.30]\r\n        at org.apache.bookkeeper.mledger.impl.ManagedLedgerImpl.initializeBookKeeper(ManagedLedgerImpl.java:460) ~[io.streamnative-managed-ledger-2.8.1.30.jar:2.8.1.30]\r\n        at org.apache.bookkeeper.mledger.impl.ManagedLedgerImpl.access$400(ManagedLedgerImpl.java:141) ~[io.streamnative-managed-ledger-2.8.1.30.jar:2.8.1.30]\r\n        at org.apache.bookkeeper.mledger.impl.ManagedLedgerImpl$1.operationComplete(ManagedLedgerImpl.java:396) ~[io.streamnative-managed-ledger-2.8.1.30.jar:2.8.1.30]\r\n        at org.apache.bookkeeper.mledger.impl.ManagedLedgerImpl$1.operationComplete(ManagedLedgerImpl.java:328) ~[io.streamnative-managed-ledger-2.8.1.30.jar:2.8.1.30]\r\n        at org.apache.bookkeeper.mledger.impl.MetaStoreImpl.lambda$getManagedLedgerInfo$2(MetaStoreImpl.java:97) ~[io.streamnative-managed-ledger-2.8.1.30.jar:2.8.1.30]\r\n        at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:714) [?:?]\r\n        at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478) [?:?]\r\n        at org.apache.bookkeeper.common.util.OrderedExecutor$TimedRunnable.run(OrderedExecutor.java:203) [io.streamnative-bookkeeper-common-4.14.3.1.jar:4.14.3.1]\r\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) [?:?]\r\n        at java.util.concurrent.FutureTask.run(FutureTask.java:264) [?:?]\r\n        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) [?:?]\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]\r\n        at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.72.Final.jar:4.1.72.Final]\r\n        at java.lang.Thread.run(Thread.java:834) [?:?]\r\n```\r\n\r\nThe root cause of this case it that in `selectRandomInternal`, the `wRselection` haven't ever update any bookie map and the filed `randomMax` and `cummulativeMap` doesn't initialized.\r\n\r\n### Modification\r\n1. update the `wRSelection`'s map on `selectRandomInternal` method whenever the `wRSelection` have ever set or not.","Date":"Mon Jan 17 03:21:31 CET 2022"},{"Commit-ID":"commit 7a770dcf44213eeacecfdb60083141bcb891b056 1642409521 -----sp","Author":"PersonIdent[chenlin, 1572139390@qq.com, Mon Jan 17 16:52:01 2022 +0800]","Body":"suport dynamic enable/disable health check (#2947)\n\n","Date":"Mon Jan 17 09:52:01 CET 2022"},{"Commit-ID":"commit f737e9b072b19c16408d2df70af4699a1bfe1b7e 1642441980 -----sp","Author":"PersonIdent[chenlin, 1572139390@qq.com, Tue Jan 18 01:53:00 2022 +0800]","Body":"remove unused variable (#2916)\n\n* remove unused variable\r\n\r\n* check style","Date":"Mon Jan 17 18:53:00 CET 2022"},{"Commit-ID":"commit a3b60db38fea5019ecbd38a74241811854d72a37 1642530617 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Wed Jan 19 02:30:17 2022 +0800]","Body":"Add github actions timeout (#2996)\n\n","Date":"Tue Jan 18 19:30:17 CET 2022"},{"Commit-ID":"commit 7f317486abf6fab2bb7e05d8d9cd728c9285e773 1642560854 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Wed Jan 19 10:54:14 2022 +0800]","Body":"improve the throttle function (#2991)\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n### Motivation\r\n\r\nimprove the throttle function : old pr: #2778 \r\n1. duplicate definition for replicationRateByBytes\r\n2.make sure this update safety when different callback run averageEntrySize updating\r\n\r\n### Changes\r\n\r\n1.clean code for duplicate definition for replicationRateByBytes\r\n2.add a lock to make sure data safety for updateAverageEntrySize\r\n","Date":"Wed Jan 19 03:54:14 CET 2022"},{"Commit-ID":"commit 268c825ec9a1f0e61389189cc631d783e0c8081f 1643222925 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Jan 26 10:48:45 2022 -0800]","Body":"Auditor should get the LegdgerManagerFactory from the client instance (#3011)\n\n* Auditor should get the LegdgerManagerFactory from the client instance\r\n\r\n* Removed unused import","Date":"Wed Jan 26 19:48:45 CET 2022"},{"Commit-ID":"commit e089b51ab5e1cf5f061c81463d27f33a21198271 1643231904 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Wed Jan 26 22:18:24 2022 +0100]","Body":"[build] remove Maven POM files (#3009)\n\n* Initial commit for dropping maven\r\n\r\n* fix gh action\r\n\r\n* fix typo","Date":"Wed Jan 26 22:18:24 CET 2022"},{"Commit-ID":"commit 62aca0a237851c28cc68650962924c1b45022446 1643289634 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Thu Jan 27 05:20:34 2022 -0800]","Body":"Upgraded snakeyaml, CVE-2017-18640 (#3014)\n\n","Date":"Thu Jan 27 14:20:34 CET 2022"},{"Commit-ID":"commit de3019e41692343b69dea28cdc9400692473b638 1643289653 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Thu Jan 27 05:20:53 2022 -0800]","Body":"Upgrading protobuf, CVE-2021-22569 (#3013)\n\n","Date":"Thu Jan 27 14:20:53 CET 2022"},{"Commit-ID":"commit 036fc1f22228a14c7f91d4f119378fc6cf719ed5 1643289884 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Thu Jan 27 05:24:44 2022 -0800]","Body":"Added OWASP dependency-check (#3002)\n\n* Added OWASP dependency-check\r\n* Suppress ETCD-related misdetections","Date":"Thu Jan 27 14:24:44 CET 2022"},{"Commit-ID":"commit 568fea837c8c793da0020abd9b7c0dd3f525c433 1643296139 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Thu Jan 27 16:08:59 2022 +0100]","Body":"[build] do not run spotbugsTest by default (#3017)\n\n","Date":"Thu Jan 27 16:08:59 CET 2022"},{"Commit-ID":"commit 317080d44334b1751d70de61f27e60505ae834cb 1643821958 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Wed Feb 2 09:12:38 2022 -0800]","Body":"Forcing the same version of netty across the projects\n\n### Motivation\r\n\r\nWhile experimenting with OWASP dependency checker I noticed that we have 3 versions of netty mixed in: 4.1.72 (current one, expected) plus 4.1.63 and 4.1.50 (brought with ZK and some other dependencies). \r\n\r\n### Changes\r\n\r\nMade gradle enforce the same version of netty in subprojects.\n\nReviewers: Nicolò Boschi <boschi1997@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #3008 from dlg99/gradle-netty","Date":"Wed Feb 02 18:12:38 CET 2022"},{"Commit-ID":"commit f02e9e0218b466a4fdf4122a0e0d64c713d96b47 1643822066 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Wed Feb 2 09:14:26 2022 -0800]","Body":"Forced the same version of guava (plus upgraded it); fixed deprecations etc.\n\n### Motivation\r\n\r\nOlder versions of guava (w/CVEs) used in some subprojects\r\n\r\n### Changes\r\n\r\nForced the same version of guava; fixed deprecation problems (murmur3_32) and compilation problems (checkArgument).\r\ncheckArgument cannot be statically imported because there are now overrides of it; checkstyle was not very cooperative so I had to remove the import altogether. \r\nThen updated the guava version to match one in Pulsar.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Nicolò Boschi <boschi1997@gmail.com>\n\nThis closes #3010 from dlg99/gradle-guava","Date":"Wed Feb 02 18:14:26 CET 2022"},{"Commit-ID":"commit 3f068390a66706b41798d562835278bb37227b97 1643822227 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Wed Feb 2 18:17:07 2022 +0100]","Body":"Upgrade Netty to 4.1.73.Final\n\n### Motivation\r\n\r\nChangelog: https://netty.io/news/2022/01/12/4-1-73-Final.html\r\n\r\nThe main reason to upgrade is because of an [intensive I/O disk scheduled task](https://github.com/netty/netty/pull/11943) introduced in 4.1.72.Final which is synchronous and can cause EventLoop to blocked very often. \r\n\r\n### Changes\r\n\r\n* Upgrade Netty from 4.1.72.Final to 4.1.73.Final\r\n* [Netty 4.1.73.Final depends on netty-tc-native 2.0.46](https://github.com/netty/netty/blob/b5219aeb4ee62f15d5dfb2b9c29d0c694aca05be/pom.xml#L545) as Netty 4.1.72.Final, so no need to upgrade\r\n\r\n\n\nReviewers: Andrey Yegorov <None>\n\nThis closes #3020 from nicoloboschi/upgrade-netty-4.1.73","Date":"Wed Feb 02 18:17:07 CET 2022"},{"Commit-ID":"commit d7e5c51aaa5e1faa781cf07d261a63319a946326 1643873973 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Thu Feb 3 08:39:33 2022 +0100]","Body":"[website] Remove Maven references and remove dead links from README (#3018)\n\n","Date":"Thu Feb 03 08:39:33 CET 2022"},{"Commit-ID":"commit b8351cb8c8994f55fdc6f8c302299408903be304 1643905470 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Thu Feb 3 08:24:30 2022 -0800]","Body":"CI workflow to check dependencies with OWASP (#3021)\n\n","Date":"Thu Feb 03 17:24:30 CET 2022"},{"Commit-ID":"commit ee8c5bc2a32f56e3056dd7e5cc12cf292b1cbed9 1644016237 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Sat Feb 5 00:10:37 2022 +0100]","Body":"[BACKWARD TESTS] add BookKeeper 4.14.4\n\n### Motivation\r\nBK 4.14.4 has been released and we should test it in the upgrade tests\r\n\r\nNote: for the sake of test performance, we test the upgrades only for the latest releases of each minor release \r\n\r\n### Changes\r\n\r\n* Replaced BK 4.14.3 with 4.14.4\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Andrey Yegorov <None>\n\nThis closes #2997 from nicoloboschi/tests/add-bk-4144-backward-compat","Date":"Sat Feb 05 00:10:37 CET 2022"},{"Commit-ID":"commit d9c40219ad4a02c0703f3f5907ffc7a039dcc42a 1644020921 -----sp","Author":"PersonIdent[mauricebarnum, maurice.barnum@gmail.com, Fri Feb 4 16:28:41 2022 -0800]","Body":"Gradle 6.9.2 (#3022)\n\n* Remove annoying println\r\n\r\n* Update gradle to 6.9.2\r\n\r\nThis includes `Mitigations for log4j vulnerability in Gradle builds`\r\nhttps://github.com/gradle/gradle/issues/19328\r\n\r\nFull release notes https://docs.gradle.org/6.9.2/release-notes.html","Date":"Sat Feb 05 01:28:41 CET 2022"},{"Commit-ID":"commit dcf12813de7438fb5d5e96f7c99b27db8949dff5 1644082610 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sun Feb 6 01:36:50 2022 +0800]","Body":"Bump gradle to 7.3.3, compat java 17 (#2924)\n\n","Date":"Sat Feb 05 18:36:50 CET 2022"},{"Commit-ID":"commit 1eae5e473b7775419760747b5d1f4dadd0c09052 1644326230 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Tue Feb 8 14:17:10 2022 +0100]","Body":"[tests] remove backward compatibility test against yahoo-version (apache Pulsar 1.21) (#3028)\n\n","Date":"Tue Feb 08 14:17:10 CET 2022"},{"Commit-ID":"commit 07252550317c3bdd172bbda1834033c046b83356 1644371694 -----sp","Author":"PersonIdent[Yang Yang, yyang@streamnative.io, Wed Feb 9 09:54:54 2022 +0800]","Body":"Support specifying bookie http port as a command argument (#2769)\n\n### Motivation\r\n\r\nI was trying to start multiple bookies locally and found it's a bit inconvenient to specify different http ports for different bookies.\r\n\r\n### Changes\r\n\r\nAdd a command-line argument `httpport` to the bookie command to support specifying bookie http port from the command line.\r\n","Date":"Wed Feb 09 02:54:54 CET 2022"},{"Commit-ID":"commit 5405ee98e1d7e7c155fad55f634c20ed424d1e2e 1644434661 -----sp","Author":"PersonIdent[Qiang Zhao, 74767115+mattisonchao@users.noreply.github.com, Thu Feb 10 03:24:21 2022 +0800]","Body":"Fix performance issue to avoid unnessary loop. (#3030)\n\n","Date":"Wed Feb 09 20:24:21 CET 2022"},{"Commit-ID":"commit 7d35b67a8d2306a7d92cbc51cacc36cbf29f8899 1644441224 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Wed Feb 9 13:13:44 2022 -0800]","Body":"Upgrade RocksDB\n\nDescriptions of the changes in this PR:\r\n\r\nDependency change\r\n\r\n### Motivation\r\n\r\nI encountered https://github.com/apache/bookkeeper/issues/3024 and noticed that newer version of RocksDB includes multiple fixes for concurrency issues with various side-effects and fixes for a few crashes.\r\nI upgraded, ran `org.apache.bookkeeper.bookie.BookieJournalTest` test in a loop and didn't repro the crash so far.\r\nIt is hard to say 100% if it is fixed given it was not happening all the time. \r\n\r\n### Changes\r\n\r\nUpgraded RocksDB\r\nMaster Issue: #3024\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Nicolò Boschi <boschi1997@gmail.com>\n\nThis closes #3026 from dlg99/rocksdb-upgrade","Date":"Wed Feb 09 22:13:44 CET 2022"},{"Commit-ID":"commit 098ceaca63e934d4ef9b56e46af7f0c24b5d6a5b 1644549028 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Fri Feb 11 11:10:28 2022 +0800]","Body":"Skip update entryLogMetaMap if not modified (#2964)\n\n### Motivation\r\nAfter we support RocksDB backend entryMetaMap, we should avoid updating the entryMetaMap if unnecessary.\r\n\r\nIn `doGcEntryLogs` method, it iterate through the entryLogMetaMap and update the meta if ledgerNotExists. We should check whether the meta has been modified in `removeIfLedgerNotExists`. If not modified, we can avoid update the  entryLogMetaMap.\r\n\r\n### Modification\r\n 1. Add a flag to represent whether the meta has been modified in `removeIfLedgerNotExists` method. If not, skip update the entryLogMetaMap.","Date":"Fri Feb 11 04:10:28 CET 2022"},{"Commit-ID":"commit eabf7b1a88120ef3263ffdb729f0c6e4171d6fbe 1644549063 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Fri Feb 11 11:11:03 2022 +0800]","Body":"Add rack name invalid check (#2980)\n\n### Motivation\r\nWhen we set region or rack placement policy, but the region or rack name set to `/` or empty string, it will throw the following exception on handling bookies join.\r\n```\r\njava.lang.StringIndexOutOfBoundsException: String index out of range: -1\r\n        at java.lang.String.substring(String.java:1841) ~[?:?]\r\n        at org.apache.bookkeeper.net.NetworkTopologyImpl$InnerNode.getNextAncestorName(NetworkTopologyImpl.java:144) ~[io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.net.NetworkTopologyImpl$InnerNode.add(NetworkTopologyImpl.java:180) ~[io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.net.NetworkTopologyImpl.add(NetworkTopologyImpl.java:425) ~[io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.handleBookiesThatJoined(TopologyAwareEnsemblePlacementPolicy.java:717) ~[io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.handleBookiesThatJoined(RackawareEnsemblePlacementPolicyImpl.java:80) ~[io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.handleBookiesThatJoined(RackawareEnsemblePlacementPolicy.java:249) ~[io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.onClusterChanged(TopologyAwareEnsemblePlacementPolicy.java:663) ~[io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.onClusterChanged(RackawareEnsemblePlacementPolicyImpl.java:80) ~[io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.onClusterChanged(RackawareEnsemblePlacementPolicy.java:92) ~[io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.client.BookieWatcherImpl.processWritableBookiesChanged(BookieWatcherImpl.java:197) ~[io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.client.BookieWatcherImpl.lambda$initialBlockingBookieRead$1(BookieWatcherImpl.java:233) ~[io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.discover.ZKRegistrationClient$WatchTask.accept(ZKRegistrationClient.java:147) [io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at org.apache.bookkeeper.discover.ZKRegistrationClient$WatchTask.accept(ZKRegistrationClient.java:70) [io.streamnative-bookkeeper-server-4.14.3.1.jar:4.14.3.1]\r\n        at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859) [?:?]\r\n        at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837) [?:?]\r\n        at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478) [?:?]\r\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) [?:?]\r\n        at java.util.concurrent.FutureTask.run(FutureTask.java:264) [?:?]\r\n        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) [?:?]\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]\r\n        at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.72.Final.jar:4.1.72.Final]\r\n        at java.lang.Thread.run(Thread.java:829) [?:?]\r\n```\r\nThe root cause is that the node networkLocation is empty string and then use `substring(1)` operation, which will lead to `StringIndexOutOfBoundsException`\r\n\r\n### Modification\r\n1. Add `n.getNetworkLocation()` is empty check on `isAncestor` method to make the exception more clear.","Date":"Fri Feb 11 04:11:03 CET 2022"},{"Commit-ID":"commit 48a87a88f7d98fb890ed2aef58487f19f32a8296 1644549147 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Fri Feb 11 11:12:27 2022 +0800]","Body":"Support multi ledger directories for rocksdb backend entryMetadataMap (#2965)\n\n### Motivation\r\nWhen we use RocksDB backend entryMetadataMap for multi ledger directories configured, the bookie start up failed, and throw the following exception.\r\n```\r\n12:24:28.530 [main] ERROR org.apache.pulsar.PulsarStandaloneStarter - Failed to start pulsar service.\r\njava.io.IOException: Error open RocksDB database\r\n        at org.apache.bookkeeper.bookie.storage.ldb.KeyValueStorageRocksDB.<init>(KeyValueStorageRocksDB.java:202) ~[org.apache.bookkeeper-bookkeeper-server-4.15.0-SNAPSHOT.jar:4.15.0-SNAPSHOT]\r\n        at org.apache.bookkeeper.bookie.storage.ldb.KeyValueStorageRocksDB.<init>(KeyValueStorageRocksDB.java:89) ~[org.apache.bookkeeper-bookkeeper-server-4.15.0-SNAPSHOT.jar:4.15.0-SNAPSHOT]\r\n        at org.apache.bookkeeper.bookie.storage.ldb.KeyValueStorageRocksDB.lambda$static$0(KeyValueStorageRocksDB.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.15.0-SNAPSHOT.jar:4.15.0-SNAPSHOT]\r\n        at org.apache.bookkeeper.bookie.storage.ldb.PersistentEntryLogMetadataMap.<init>(PersistentEntryLogMetadataMap.java:87) ~[org.apache.bookkeeper-bookkeeper-server-4.15.0-SNAPSHOT.jar:4.15.0-SNAPSHOT]\r\n        at org.apache.bookkeeper.bookie.GarbageCollectorThread.createEntryLogMetadataMap(GarbageCollectorThread.java:265) ~[org.apache.bookkeeper-bookkeeper-server-4.15.0-SNAPSHOT.jar:4.15.0-SNAPSHOT]\r\n        at org.apache.bookkeeper.bookie.GarbageCollectorThread.<init>(GarbageCollectorThread.java:154) ~[org.apache.bookkeeper-bookkeeper-server-4.15.0-SNAPSHOT.jar:4.15.0-SNAPSHOT]\r\n        at org.apache.bookkeeper.bookie.GarbageCollectorThread.<init>(GarbageCollectorThread.java:133) ~[org.apache.bookkeeper-bookkeeper-server-4.15.0-SNAPSHOT.jar:4.15.0-SNAPSHOT]\r\n        at org.apache.bookkeeper.bookie.storage.ldb.SingleDirectoryDbLedgerStorage.<init>(SingleDirectoryDbLedgerStorage.java:182) ~[org.apache.bookkeeper-bookkeeper-server-4.15.0-SNAPSHOT.jar:4.15.0-SNAPSHOT]\r\n        at org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage.newSingleDirectoryDbLedgerStorage(DbLedgerStorage.java:190) ~[org.apache.bookkeeper-bookkeeper-server-4.15.0-SNAPSHOT.jar:4.15.0-SNAPSHOT]\r\n        at org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage.initialize(DbLedgerStorage.java:150) ~[org.apache.bookkeeper-bookkeeper-server-4.15.0-SNAPSHOT.jar:4.15.0-SNAPSHOT]\r\n        at org.apache.bookkeeper.bookie.BookieResources.createLedgerStorage(BookieResources.java:110) ~[org.apache.bookkeeper-bookkeeper-server-4.15.0-SNAPSHOT.jar:4.15.0-SNAPSHOT]\r\n        at org.apache.pulsar.zookeeper.LocalBookkeeperEnsemble.buildBookie(LocalBookkeeperEnsemble.java:328) ~[org.apache.pulsar-pulsar-zookeeper-utils-2.8.1.jar:2.8.1]\r\n        at org.apache.pulsar.zookeeper.LocalBookkeeperEnsemble.runBookies(LocalBookkeeperEnsemble.java:391) ~[org.apache.pulsar-pulsar-zookeeper-utils-2.8.1.jar:2.8.1]\r\n        at org.apache.pulsar.zookeeper.LocalBookkeeperEnsemble.startStandalone(LocalBookkeeperEnsemble.java:521) ~[org.apache.pulsar-pulsar-zookeeper-utils-2.8.1.jar:2.8.1]\r\n        at org.apache.pulsar.PulsarStandalone.start(PulsarStandalone.java:264) ~[org.apache.pulsar-pulsar-broker-2.8.1.jar:2.8.1]\r\n        at org.apache.pulsar.PulsarStandaloneStarter.main(PulsarStandaloneStarter.java:121) [org.apache.pulsar-pulsar-broker-2.8.1.jar:2.8.1]\r\nCaused by: org.rocksdb.RocksDBException: lock hold by current process, acquire time 1640492668 acquiring thread 123145515651072: data/standalone/bookkeeper00/entrylogIndexCache/metadata-cache/LOCK: No locks available\r\n        at org.rocksdb.RocksDB.open(Native Method) ~[org.rocksdb-rocksdbjni-6.10.2.jar:?]\r\n        at org.rocksdb.RocksDB.open(RocksDB.java:239) ~[org.rocksdb-rocksdbjni-6.10.2.jar:?]\r\n        at org.apache.bookkeeper.bookie.storage.ldb.KeyValueStorageRocksDB.<init>(KeyValueStorageRocksDB.java:199) ~[org.apache.bookkeeper-bookkeeper-server-4.15.0-SNAPSHOT.jar:4.15.0-SNAPSHOT]\r\n        ... 15 more\r\n```\r\n\r\nThe reason is multi garbageCollectionThread will open the same RocksDB and own the LOCK, and then throw the above exception.\r\n\r\n### Modification\r\n1. Change the default GcEntryLogMetadataCachePath from `getLedgerDirNames()[0] + \"/\" + ENTRYLOG_INDEX_CACHE` to  `null`. If it is `null`, it will use each ledger's directory.\r\n2. Remove the internal directory `entrylogIndexCache`. The data structure looks like: \r\n```\r\n   └── current\r\n       ├── lastMark\r\n       ├── ledgers\r\n       │   ├── 000003.log\r\n       │   ├── CURRENT\r\n       │   ├── IDENTITY\r\n       │   ├── LOCK\r\n       │   ├── LOG\r\n       │   ├── MANIFEST-000001\r\n       │   └── OPTIONS-000005\r\n       ├── locations\r\n       │   ├── 000003.log\r\n       │   ├── CURRENT\r\n       │   ├── IDENTITY\r\n       │   ├── LOCK\r\n       │   ├── LOG\r\n       │   ├── MANIFEST-000001\r\n       │   └── OPTIONS-000005\r\n       └── metadata-cache\r\n           ├── 000003.log\r\n           ├── CURRENT\r\n           ├── IDENTITY\r\n           ├── LOCK\r\n           ├── LOG\r\n           ├── MANIFEST-000001\r\n           └── OPTIONS-000005\r\n```\r\n3. If user configured `GcEntryLogMetadataCachePath` in `bk_server.conf`, it only support one ledger directory configured for `ledgerDirectories`. Otherwise, the best practice is to keep it default.\r\n4. The PR is better to release with #1949 ","Date":"Fri Feb 11 04:12:27 CET 2022"},{"Commit-ID":"commit 0de75bc1ad6521bb96e358fe69882425afe8c260 1644563790 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Thu Feb 10 23:16:30 2022 -0800]","Body":"[ISSUE 3038] Fixed flaky CompactionTest.testMinorCompactionWithMaxTimeMillis (#3039)\n\n","Date":"Fri Feb 11 08:16:30 CET 2022"},{"Commit-ID":"commit 4debbbf84db09f80ffeb4154e8e6feed134be0c0 1644806363 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Mon Feb 14 10:39:23 2022 +0800]","Body":"change log level from error to warn when dns resolver initialize failed (#2856)\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\nWhen start bookie, it will throws the following error message when dns resolver initialize failed.\r\n```\r\n[main] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.\r\n```\r\nIt is confusing for users.\r\n\r\n### Modification\r\n1. change the log level from error to warn.\r\n\r\n","Date":"Mon Feb 14 03:39:23 CET 2022"},{"Commit-ID":"commit 4710fed8a409736e9e5e0aae5b87fdc6b56ed51a 1644864979 -----sp","Author":"PersonIdent[Jack Vanlightly, vanlightly@gmail.com, Mon Feb 14 19:56:19 2022 +0100]","Body":"Ensure BookKeeper process receives sigterm in docker container\n\n### Motivation\r\n\r\nCurrent official docker images do not handle the SIGTERM sent by the docker runtime and so get killed after the timeout. No graceful shutdown occurs.\r\n\r\nThe reason is that the entrypoint does not use `exec` when executing the `bin/bookkeeper` shell script and so the BookKeeper process cannot receive signals from the docker runtime.\r\n\r\n### Changes\r\n\r\nUse `exec` when calling the `bin/bookkeeper` shell script.\n\nReviewers: Nicolò Boschi <boschi1997@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>, Lari Hotari <None>, Matteo Merli <mmerli@apache.org>\n\nThis closes #2857 from Vanlightly/docker-image-handle-sigterm","Date":"Mon Feb 14 19:56:19 CET 2022"},{"Commit-ID":"commit 50f5287f3637c5fa01a4d146477087b217bdebd5 1644865206 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Tue Feb 15 03:00:06 2022 +0800]","Body":"make rocksdb format version configurable\n\n### Motivation\r\nFix #2823\r\nRocksDB support several format versions which uses different data structure to implement key-values indexes and have huge different performance. https://rocksdb.org/blog/2019/03/08/format-version-4.html\r\n\r\nhttps://github.com/facebook/rocksdb/blob/d52b520d5168de6be5f1494b2035b61ff0958c11/include/rocksdb/table.h#L368-L394 \r\n\r\n```C++\r\n  // We currently have five versions:\r\n  // 0 -- This version is currently written out by all RocksDB's versions by\r\n  // default.  Can be read by really old RocksDB's. Doesn't support changing\r\n  // checksum (default is CRC32).\r\n  // 1 -- Can be read by RocksDB's versions since 3.0. Supports non-default\r\n  // checksum, like xxHash. It is written by RocksDB when\r\n  // BlockBasedTableOptions::checksum is something other than kCRC32c. (version\r\n  // 0 is silently upconverted)\r\n  // 2 -- Can be read by RocksDB's versions since 3.10. Changes the way we\r\n  // encode compressed blocks with LZ4, BZip2 and Zlib compression. If you\r\n  // don't plan to run RocksDB before version 3.10, you should probably use\r\n  // this.\r\n  // 3 -- Can be read by RocksDB's versions since 5.15. Changes the way we\r\n  // encode the keys in index blocks. If you don't plan to run RocksDB before\r\n  // version 5.15, you should probably use this.\r\n  // This option only affects newly written tables. When reading existing\r\n  // tables, the information about version is read from the footer.\r\n  // 4 -- Can be read by RocksDB's versions since 5.16. Changes the way we\r\n  // encode the values in index blocks. If you don't plan to run RocksDB before\r\n  // version 5.16 and you are using index_block_restart_interval > 1, you should\r\n  // probably use this as it would reduce the index size.\r\n  // This option only affects newly written tables. When reading existing\r\n  // tables, the information about version is read from the footer.\r\n  // 5 -- Can be read by RocksDB's versions since 6.6.0. Full and partitioned\r\n  // filters use a generally faster and more accurate Bloom filter\r\n  // implementation, with a different schema.\r\n  uint32_t format_version = 5;\r\n```\r\nDifferent format version requires different rocksDB version and it couldn't roll back once upgrade to new format version\r\n\r\nIn our current RocksDB storage code, we hard code the format_version to 2, which is hard to to upgrade format_version to achieve new RocksDB's high performance.\r\n\r\n### Changes\r\n\r\n1. Make the format_version configurable.\r\n\n\nReviewers: Matteo Merli <mmerli@apache.org>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2824 from hangc0276/chenhang/make_rocksdb_format_version_configurable","Date":"Mon Feb 14 20:00:06 CET 2022"},{"Commit-ID":"commit 50b8a2322585ff2269feff064e1a81c65aad6ef5 1644865282 -----sp","Author":"PersonIdent[gaozhangmin, gaozhangmin456@qq.com, Tue Feb 15 03:01:22 2022 +0800]","Body":"delete duplicated semicolon\n\nAs title, delete duplicated semicolon\n\nReviewers: Andrey Yegorov <None>\n\nThis closes #2810 from gaozhangmin/remove-duplicated-semicolon","Date":"Mon Feb 14 20:01:22 CET 2022"},{"Commit-ID":"commit 8530d5c973d1106a4508ac024518df254eac7437 1644865898 -----sp","Author":"PersonIdent[Jack Vanlightly, vanlightly@gmail.com, Mon Feb 14 20:11:38 2022 +0100]","Body":"BP-46: Running without journal proposal\n\nIncludes the BP-46 design proposal markdown document.\r\n\r\nMaster Issue: #2705\n\nReviewers: Andrey Yegorov <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2706 from Vanlightly/bp-44","Date":"Mon Feb 14 20:11:38 CET 2022"},{"Commit-ID":"commit 9fd35f9cefa1b5925dc29e2e734cc5be9df346f1 1644866248 -----sp","Author":"PersonIdent[gaozhangmin, gaozhangmin456@qq.com, Tue Feb 15 03:17:28 2022 +0800]","Body":"Replication stat num-under-replicated-ledgers changed as with the process of replication\n\nMotivation\r\nNow ReplicationStats numUnderReplicatedLedger registers when `publishSuspectedLedgersAsync`, but its value doesn't decrease as with the ledger replicated successfully, We cannot know the progress of replication from the stat.\r\n\r\nChanges\r\nregisters a notifyUnderReplicationLedgerChanged when auditor starts. numUnderReplicatedLedger value will decrease when the ledger path under replicate deleted.\n\nReviewers: Nicolò Boschi <boschi1997@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>, Andrey Yegorov <None>\n\nThis closes #2805 from gaozhangmin/replication-stats-num-under-replicated-ledgers","Date":"Mon Feb 14 20:17:28 CET 2022"},{"Commit-ID":"commit 743def3634cc95e651faa0ca1a6d3c50483f2d37 1644866449 -----sp","Author":"PersonIdent[shustsud, 51769018+shustsud@users.noreply.github.com, Tue Feb 15 04:20:49 2022 +0900]","Body":"Explicit error message if an exception other than BKNoSuchLedgerExistsOnMetadataServerException occurs in over-replicated ledger GC\n\n### Motivation\r\n- Even if an exception other than BKNoSuchLedgerExistsOnMetadataServerException occurs of readLedgerMetadata in over-replicated ledger GC, nothing will be output to the log.\r\n(https://github.com/apache/bookkeeper/pull/2844#discussion_r735219876)\r\n\r\n### Changes\r\n- If an exception other than BKNoSuchLedgerExistsOnMetadataServerException occurs in readLedgerMetadata, output information to the log.\r\n\n\nReviewers: Andrey Yegorov <None>, Nicolò Boschi <boschi1997@gmail.com>\n\nThis closes #2873 from shustsud/improved_error_handling","Date":"Mon Feb 14 20:20:49 CET 2022"},{"Commit-ID":"commit c5a516702e69bd38ca0fe77fb7300c8e7e36f065 1644867175 -----sp","Author":"PersonIdent[Eric Shen, ericshenyuhao@outlook.com, Tue Feb 15 03:32:55 2022 +0800]","Body":"fix(cli): incorrect description for autodiscovery\n\nSigned-off-by: Eric Shen <ericshenyuhaooutlook.com>\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n\r\n### Motivation\r\n\r\nThe description of `bin/bookkeeper autorecovery` is wrong, it won't start in daemon.\r\n\r\n### Changes\r\n\r\n* Changed the description in bookkeeper shell\r\n* Update the doc\r\n\r\n\n\nReviewers: Yong Zhang <zhangyong1025.zy@gmail.com>\n\nThis closes #2910 from ericsyh/fix-bk-cli","Date":"Mon Feb 14 20:32:55 CET 2022"},{"Commit-ID":"commit 0d98266c1de479e9741949d163a3764030569efb 1644867366 -----sp","Author":"PersonIdent[Qiang Zhao, 74767115+mattisonchao@users.noreply.github.com, Tue Feb 15 03:36:06 2022 +0800]","Body":"Add flaky-test template to track many flaky-test.\n\n### Motivation\r\n\r\nI found many flaky-test like  #3031 #3034 #3033.\r\nBecause many flaky tests are actually production code issues so I think it's a good way to add flaky-test template to track them \r\n\r\n### Changes\r\n\r\n- Add flaky-test template.\r\n\r\n\n\nReviewers: Andrey Yegorov <None>\n\nThis closes #3035 from mattisonchao/template_flaky_test","Date":"Mon Feb 14 20:36:06 CET 2022"},{"Commit-ID":"commit 7a13905bc29b1b7263186c2c759b37a1c8ee6bea 1644869994 -----sp","Author":"PersonIdent[mauricebarnum, mbarnum@splunk.com, Mon Feb 14 12:19:54 2022 -0800]","Body":"fix gradle implicit dependency (#3029)\n\n```\r\n> Task :bookkeeper-tools-framework:compileTestJava\r\nExecution optimizations have been disabled for task ':bookkeeper-tools-framework:compileTestJava' to ensure correctness due to the following reasons:\r\n  - Gradle detected a problem with the following location: '/Users/mbarnum/src/bookkeeper/tools/framework/build/classes/java/main'. Reason: Task ':bookkeeper-tools-framework:compileTestJava' uses this output of task ':tools:framework:compileJava' without declaring an explicit or implicit dependency. This can lead to incorrect results being produced, depending on what order the tasks are executed. Please refer to https://docs.gradle.org/7.3.3/userguide/validation_problems.html#implicit_dependency for more details about this problem.\r\n```","Date":"Mon Feb 14 21:19:54 CET 2022"},{"Commit-ID":"commit f19544b5d4aa5e36e5af3c51d9bc34f924af1c82 1644879025 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Tue Feb 15 06:50:25 2022 +0800]","Body":"Use OutOfMemoryPolicy when the direct memory is insufficient when reading the entry in ReadCache\n\n### Motivation\r\n\r\nOriginal PR: https://github.com/apache/bookkeeper/pull/1755,\r\nIt should be that this PR forgot to modify the memory application method.\r\n\r\nWhen the direct memory is insufficient, it does not fall back to the jvm memory, and the bookie hangs directly.\r\n\r\n![image](https://user-images.githubusercontent.com/35599757/137859349-f145bb88-7d1c-4739-b6d1-6f8987831cc0.png)\r\n\r\n![image](https://user-images.githubusercontent.com/35599757/137859462-4e2b3dc5-3287-4bf7-8dad-048ad8a7723f.png)\r\n\r\n\r\n\r\n### Changes\r\n\r\nUse `OutOfMemoryPolicy` when the direct memory is insufficient when reading the entry in `ReadCache`.\r\n\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Andrey Yegorov <None>\n\nThis closes #2836 from wenbingshen/useOutOfMemoryPolicyInReadCache","Date":"Mon Feb 14 23:50:25 CET 2022"},{"Commit-ID":"commit 80a110096368b54831eb0302bcdfb5b9555f86bc 1644889408 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Tue Feb 15 02:43:28 2022 +0100]","Body":"[CI] Dump stacktrace when a job is cancelled\n\n### Motivation\r\n\r\nSometimes CI jobs fail due to timeout. It would be useful understand what the latest test was doing before being interrupted. \r\n\r\n### Changes\r\n\r\n* Added a new script for dumping stacktrace.\r\n* Added in all the jobs the step in case of `cancelled()` is true.\r\n\n\nReviewers: Andrey Yegorov <None>\n\nThis closes #3042 from nicoloboschi/ci-thread-dump","Date":"Tue Feb 15 02:43:28 CET 2022"},{"Commit-ID":"commit a3056b5169665e803cd65ef1a6ea56829ecde27e 1644915357 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Tue Feb 15 16:55:57 2022 +0800]","Body":"update metrics (#2999)\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n### Motivation\r\n\r\nsome metric's value is not right,so update it\r\nthe current is problem-driven, and a comprehensive review will be done later.\r\n\r\n### Changes\r\n\r\nupdate 2 metric:\r\n1.Bookie: ReadBytes use entrySize\r\n2.Journal: report journal write error metric\r\n\r\n","Date":"Tue Feb 15 09:55:57 CET 2022"},{"Commit-ID":"commit 93e22497a88a16cfbf7513bcea27f1b57a08767d 1644915674 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Tue Feb 15 17:01:14 2022 +0800]","Body":"Bump netty version to 4.1.74.Final (#3045)\n\n### Motivation\r\n\r\nChangelog: https://netty.io/news/2022/02/08/4-1-74-Final.html\r\n\r\nNetty 4.1.74 had solved several dns resolver bug\r\n\r\n### Modifications\r\n\r\n* Upgrade Netty from 4.1.73.Final to 4.1.74.Final\r\n* Netty 4.1.74.Final depends on netty-tc-native 2.0.48, also updates\r\n","Date":"Tue Feb 15 10:01:14 CET 2022"},{"Commit-ID":"commit 9b1b188f6856bf7964c0f74d04e89d8eee71a20a 1644944717 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Tue Feb 15 09:05:17 2022 -0800]","Body":"ISSUE #3040: RocksDB segfaulted during CompactionTest\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nRocksDB segfaulted during CompactionTest\r\n\r\n### Changes\r\n\r\nRocksDB can segfault if one tries to use it after close.\r\n[Shutdown/compaction sequence](https://github.com/apache/bookkeeper/issues/3040#issuecomment-1036508397) can lead to such situation. The fix prevents segfault.\r\n\r\nCompactionTests were updated at some point to use metadata cache and non-cached case is not tested. \r\nI added the test suites for this case.\r\n\r\nMaster Issue: #3040 \r\n\r\n\n\nReviewers: Yong Zhang <zhangyong1025.zy@gmail.com>, Nicolò Boschi <boschi1997@gmail.com>\n\nThis closes #3043 from dlg99/fix/issue3040, closes #3040","Date":"Tue Feb 15 18:05:17 CET 2022"},{"Commit-ID":"commit 7018d2fff35de96a90a1008366e38580e448fb84 1644955544 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Tue Feb 15 12:05:44 2022 -0800]","Body":"ISSUE #3034: Add extra checks in the mock to help with error troubleshooting on CI\n\n### Motivation\r\n\r\nFlaky test on CI\r\n\r\n### Changes\r\n\r\nAdded extra check & logging to simplify troubleshooting of the flaky test on CI.\r\nCannot repro the failure locally after running 100+ times in a loop.\r\n\r\nMaster Issue: #3034 \r\n\n\nReviewers: Yong Zhang <zhangyong1025.zy@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #3049 from dlg99/fix/issue3034, closes #3034","Date":"Tue Feb 15 21:05:44 CET 2022"},{"Commit-ID":"commit 39639eb189f929aa7d445c919a31e8d11dc324aa 1645408464 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Sun Feb 20 17:54:24 2022 -0800]","Body":"ISSUE 3034: Fixed flaky test (#3065)\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nMockExecutorControllerWithSchedulerTest is flaky\r\n\r\n### Changes\r\n\r\ntestExecute flakes because runnable runs actually asynchronously in this case, modified the test. \r\n\r\nMaster Issue: #3034 \r\n\r\n","Date":"Mon Feb 21 02:54:24 CET 2022"},{"Commit-ID":"commit 894b32a1dafd4aebd7916b7a889a4aa57dbd48ee 1645490533 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Tue Feb 22 08:42:13 2022 +0800]","Body":"set Mod initial Delay time to simply avoid GarbageCollectorThread working at the same time (#3012)\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nwhen number of ledger's Dir are more than 1,the same of GarbageCollectorThread will do the same thing,\r\nEspecially:\r\n  1) deleting ledger, then SyncThread will be timed to do rocksDB compact\r\n  2) compact: entry, cost cpu.\r\n\r\n### Changes\r\n\r\nset a Mod initial Delay time to simply avoid GarbageCollectorThread working at the same time\r\n","Date":"Tue Feb 22 01:42:13 CET 2022"},{"Commit-ID":"commit 1cf282c31997f2260a4cdaa1467b38ee6a1ef720 1645496258 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Mon Feb 21 18:17:38 2022 -0800]","Body":"ISSUE 3044: ETCD tests hang. Added global timeout, fork tests jvm, fixed noop slf4j to see log in case of hang (#3051)\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nETCD test flake / hang occasionally causing CI job timeout.\r\n\r\n### Changes\r\n\r\nAdded global timeout - kill test early if hanged\r\nfork tests jvm - I think it helped locally (no repro) but possibly just reduced frequency of hangs \r\nfixed noop slf4j warning, also to see log in case of hang \r\n\r\nMaster Issue: #3044\r\n\r\n","Date":"Tue Feb 22 03:17:38 CET 2022"},{"Commit-ID":"commit 794cdbb5fc6e13e19865b98a386430f103b7408a 1645506063 -----sp","Author":"PersonIdent[lin chen, 1572139390@qq.com, Tue Feb 22 13:01:03 2022 +0800]","Body":"Optimize memory：Support shrinking in ConcurrentLongLongPairHashMap (#3061)\n\n* support shrink\r\n\r\n* Reduce unnecessary rehash\r\n\r\n* check style\r\n\r\n* fix: unnecessary rehash\r\n\r\n* add unit test: testExpandAndShrink\r\n\r\n* fix unit test: testExpandAndShrink\r\n\r\n* fix test:\r\n1.verify that the map is able to expand after shrink;\r\n2.does not keep shrinking at every remove() operation;\r\n\r\n* 1.add builder;\r\n2.add config:\r\n  ①MapFillFactor；②MapIdleFactor；③autoShrink；④expandFactor；⑤shrinkFactor\r\n\r\n* check style\r\n\r\n* 1.check style;\r\n2.add check :\r\nshrinkFactor>1\r\nexpandFactor>1\r\n\r\n* check style\r\n\r\n* keep and Deprecate all the public constructors.\r\n\r\n* add final for  autoShrink\r\n\r\n* fix unit test testExpandAndShrink, set autoShrink true\r\n\r\n* add method for update parameters value:\r\n  ①setMapFillFactor\r\n  ②setMapIdleFactor\r\n  ③setExpandFactor\r\n  ④setShrinkFactor\r\n  ⑤setAutoShrink\r\n\r\n* use lombok.Setter replace lombok.Data\r\n\r\n* use pulic for getUsedBucketCount\r\n\r\n* 1.check parameters；\r\n2.fix the shrinkage condition:\r\n  ①newCapacity > size: in order to prevent the infinite loop of rehash, newCapacity should be larger than the currently used size;\r\n  ②newCapacity > resizeThresholdUp: in order to prevent continuous expansion and contraction, newCapacity should be greater than the expansion threshold;\r\n\r\n* 1.update  parameters check；\r\n2.fix newCapacity calculation when shrinking :\r\n  rehash((int) Math.max(size / mapFillFactor, capacity / shrinkFactor));\r\n\r\n* remove set methods:\r\n①setMapFillFactor\r\n②setMapIdleFactor\r\n③setExpandFactor\r\n④setShrinkFactor\r\n⑤setAutoShrink\r\n\r\n* Repair shrinkage conditions: ①newCapacity must be the nth power of 2; ②reduce unnecessary shrinkage;\r\n\r\n* Repair shrinkage conditions\r\n\r\n* add shrinkage when clear\r\n\r\n* 1.add test for clear shrink\r\n2. fix initCapacity value","Date":"Tue Feb 22 06:01:03 CET 2022"},{"Commit-ID":"commit 15a18fa298fb9bd9c751b8730ed1132f1135c977 1645513248 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Tue Feb 22 15:00:48 2022 +0800]","Body":"Avoiding call fileChannelProvider init multiple times (#3046)\n\n","Date":"Tue Feb 22 08:00:48 CET 2022"},{"Commit-ID":"commit 5b9b06f1aeb4a02ed9c8b9fa7669b1bc7ae33d5f 1645557897 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Wed Feb 23 03:24:57 2022 +0800]","Body":"fix gradle publishToMavenLocal failed (#3069)\n\n","Date":"Tue Feb 22 20:24:57 CET 2022"},{"Commit-ID":"commit a3f9cdae74f9295c241bb3ce31043b078367e10d 1645611314 -----sp","Author":"PersonIdent[lin chen, 1572139390@qq.com, Wed Feb 23 18:15:14 2022 +0800]","Body":"update doc RecoveryBookieService: bookie_dest has been removed (#2961)\n\n","Date":"Wed Feb 23 11:15:14 CET 2022"},{"Commit-ID":"commit dc2be020eb87c777b9ef9a9e89cbe5f225de07ae 1645611416 -----sp","Author":"PersonIdent[lin chen, 1572139390@qq.com, Wed Feb 23 18:16:56 2022 +0800]","Body":"fix checkAllLedgersDuration compute (#2970)\n\n","Date":"Wed Feb 23 11:16:56 CET 2022"},{"Commit-ID":"commit 57383aa6fe8b883275e4d4a2f9ced773d299dbb6 1645650096 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Wed Feb 23 13:01:36 2022 -0800]","Body":"[ISSUE 3031] fixed test; chooseThread() uses orderingKey as a param, not a thread index (#3032)\n\n","Date":"Wed Feb 23 22:01:36 CET 2022"},{"Commit-ID":"commit 3db4de9da1447e2a5135ac9330d4347b9d220a0d 1645650191 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Wed Feb 23 13:03:11 2022 -0800]","Body":"Issue 2974: better thread selection for the Ordered Executor (#3023)\n\n","Date":"Wed Feb 23 22:03:11 CET 2022"},{"Commit-ID":"commit c9d218e5f381bbe8901520377e511bccf882e0bb 1645770965 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Fri Feb 25 14:36:05 2022 +0800]","Body":"Allow enabling http tls (#2995)\n\n","Date":"Fri Feb 25 07:36:05 CET 2022"},{"Commit-ID":"commit fd94a903fd8274ea86338c0c1d83b150a8a265d2 1645809761 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Fri Feb 25 18:22:41 2022 +0100]","Body":"[CI] remaining-tests is running all the tests\n\n### Motivation\r\n\r\nThe 'remaining-tests' is supposed to exclude a lot of tests covered by the other checks but the syntax used is wrong\r\n\r\n### Changes\r\n\r\n* Correctly excluded all the tests not needed in 'remaining-tests' suite\r\n\n\nReviewers: Andrey Yegorov <None>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #3078 from nicoloboschi/ci/remove-duplicated-tests","Date":"Fri Feb 25 18:22:41 CET 2022"},{"Commit-ID":"commit 407b09e3cf06254038f00c7616ee06631359cbcc 1645809997 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Fri Feb 25 09:26:37 2022 -0800]","Body":"ISSUE #2898: DistributedLogManager can skip over a segment on read.\n\nDescriptions of the changes in this PR:\r\n### Motivation\r\n\r\nDLM test suite was flaky.\r\nRepro/troubleshooting shows that DLM can skip over a data segment on read.\r\n\r\n### Changes\r\n\r\nTest + fix (don't move segment if it moved already).\r\n\r\nMaster Issue: #2898 \r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Nicolò Boschi <boschi1997@gmail.com>\n\nThis closes #3064 from dlg99/fix/dlm-issue2898, closes #2898","Date":"Fri Feb 25 18:26:37 CET 2022"},{"Commit-ID":"commit 9a932c5822eb8ef47c1954ea31acfd47f8f6f440 1645996488 -----sp","Author":"PersonIdent[lin chen, 1572139390@qq.com, Mon Feb 28 05:14:48 2022 +0800]","Body":"reduce unnecessary expansions for  ConcurrentLong map and set (#3072)\n\n","Date":"Sun Feb 27 22:14:48 CET 2022"},{"Commit-ID":"commit bbc6c35b5bc0ae0e8747020a632e560dab03e507 1646168696 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Tue Mar 1 22:04:56 2022 +0100]","Body":"[tests] Replace powermockito usages with mockito-inline - 'tools' submodule (#3077)\n\n","Date":"Tue Mar 01 22:04:56 CET 2022"},{"Commit-ID":"commit 1a56bd890674145c6a3414f806f0c5d178b958e3 1646208311 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Wed Mar 2 09:05:11 2022 +0100]","Body":"[ci] Move CI to JDK11 (#3027)\n\n","Date":"Wed Mar 02 09:05:11 CET 2022"},{"Commit-ID":"commit 74b00a101cb6ffd06dafccfe9d31c8c5be66efaf 1646329330 -----sp","Author":"PersonIdent[lin chen, 1572139390@qq.com, Fri Mar 4 01:42:10 2022 +0800]","Body":"support shrink for ConcurrentLong map or set (#3074)\n\n* support shrink for ConcurrentLong map or set\r\n\r\n* fix unit test\r\n\r\n* check style\r\n\r\n* add shrink unit test.\r\n\r\n* fix unit test","Date":"Thu Mar 03 18:42:10 CET 2022"},{"Commit-ID":"commit f13f621d6a5c5c134774d2d05e793182a5ec4e79 1646760175 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Tue Mar 8 18:22:55 2022 +0100]","Body":"[website] restore javadoc generation and automate website deployment (#3081)\n\n* [website] restore javadoc generation and automate website deployment","Date":"Tue Mar 08 18:22:55 CET 2022"},{"Commit-ID":"commit 793d83c8790a9ea618188cb0f35cc6477d1e88df 1646870408 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Thu Mar 10 08:00:08 2022 +0800]","Body":"Fix publish do not include test jar\n\n### Motivation\r\nWhen use `./gradlew publishToMavenLocal` command to publish jars to local maven repository, it doesn't include test jars.\r\n\r\n### Changes\r\nWhen publish, including the test jars.\n\nReviewers: Nicolò Boschi <boschi1997@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>, ZhangJian He <shoothzj@gmail.com>, Yong Zhang <zhangyong1025.zy@gmail.com>\n\nThis closes #3071 from hangc0276/chenhang/fix_publish_do_not_include_test_jar","Date":"Thu Mar 10 01:00:08 CET 2022"},{"Commit-ID":"commit df92e0c6bb5c5f7117d7b1dce9cd7a110e142581 1646870520 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Thu Mar 10 08:02:00 2022 +0800]","Body":"Add sizeInBytes interface for ConcurrentLong map and set\n\n### Motivation\r\nWe provide some concurrent maps and sets for specific usage, and provide size() and capacity() interface for user to get the real item number and the max item number. \r\n\r\nHowever, if user want to monitor how much memory those current maps and set allocated, there is not interface to expose this metric.\r\n\r\n### Changes\r\nAdd `sizeInBytes()` interface to expose the memory size has been allocated for those concurrent maps and sets.\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Nicolò Boschi <boschi1997@gmail.com>\n\nThis closes #3068 from hangc0276/chenhang/add_sizeInBytes_interface_for_concurrent_maps","Date":"Thu Mar 10 01:02:00 CET 2022"},{"Commit-ID":"commit e8cbd20626b8702bbed186a4be37ce45cf6e9b41 1646870596 -----sp","Author":"PersonIdent[wuYin, wuyinpost@gmail.com, Thu Mar 10 08:03:16 2022 +0800]","Body":"check all bookies of writeset are writable\n\n### Motivation\r\n\r\n#1088 introduced ensemble writable checking before sending requests, but we should check bookies of writeset, instead of the first few bookies in current ensemble.\r\n\r\n### Changes\r\n\r\nGet the bookies of writeset from ensemble and check writeable.\r\n\r\nRelated change: https://github.com/apache/bookkeeper/pull/1088/files#diff-1d893bb31553b5e1f55c8301d04ae15f38e0d35f531f9dd22475128b7972ddf9R1108\r\n\n\nReviewers: Andrey Yegorov <None>\n\nThis closes #3055 from wuYin/writeset-writable","Date":"Thu Mar 10 01:03:16 CET 2022"},{"Commit-ID":"commit 181a6dcd35485613d65fdf2bad082bc1ef97f313 1646870660 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Thu Mar 10 08:04:20 2022 +0800]","Body":"Add throttle for rebuild entryMetadataMap\n\n### Motivation\r\nWhen a bookie restart, the garbageCollectorThread will rebuild entryMetadataMap from all the entry log files in ledger directory. For normal case, it will extract the EntryLogMetadata from the index in entry log file. However, if there's no index, then fallback to scanning the entry log file. \r\n\r\nIn user's production environment, the log files without index occupied 4%. The total entry log files is 80000, and the log files without index is 3000. The default entry log file size is 2GB, and the garbageCollectorThread will read 3000 * 2GB = 6TB data without speed limit, which will cause ledger disk IO util runs high for dozens of minutes and affect ledger read and write latency.\r\n\r\n### Modification\r\n1. Add read speed rate limiter for scanning entry log file in entryMetadataMap rebuild.\n\nReviewers: Nicolò Boschi <boschi1997@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2963 from hangc0276/chenhang/add_throttle_for_build_entryMetadataMap","Date":"Thu Mar 10 01:04:20 CET 2022"},{"Commit-ID":"commit 3edbc98824bbdf574d97510aec783d5b9355548e 1646870759 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Thu Mar 10 08:05:59 2022 +0800]","Body":"change rocksdb init: use OptionsUtil\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\n1. some old parameters in rocksDB is not configurable\r\n2. for all the tuning of rocksdb in the future, there is no need to update the code or introduce configuration to bookie\r\n\r\n### Changes\r\n\r\n1)   rocks all old parameter change to be configurable\r\n2)  use OptionsUtil to init all params for rocksdb\r\n\r\nthe old pr #3006  has some rebase error,open a new pr\n\nReviewers: Andrey Yegorov <None>, LinChen <None>\n\nThis closes #3056 from StevenLuMT/master_improveRocksDB","Date":"Thu Mar 10 01:05:59 CET 2022"},{"Commit-ID":"commit 1b1e9370f39e386d660ceee11660d7ee87fbb460 1646870965 -----sp","Author":"PersonIdent[Kezhu Wang, kezhuw@gmail.com, Thu Mar 10 08:09:25 2022 +0800]","Body":"Fix Journal.ForceWriteThread.forceWriteRequests.put deadlock\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n`Journal.ForceWriteThread` could deadlock as it is the sole consumer of `Journal.forceWriteRequests` while it send group marker blocking using `BlockingQueue.put`.\r\n\r\nThis PR try to fix this.\r\n\r\n### Changes\r\n* Add testing code to deadlock `Journal.ForceWriteThread` on `forceWriteRequests.put`.\r\n* Send force write group marker non-blocking to avoid deadlock `ForceWriteThread`.\r\n\r\nMaster Issue: #2948\n\nReviewers: Andrey Yegorov <None>\n\nThis closes #2962 from kezhuw/fix-Journal.ForceWriteThread.forceWriteRequests.put-deadlock","Date":"Thu Mar 10 01:09:25 CET 2022"},{"Commit-ID":"commit 07d1c715122a80ecfbca29d8270d37222c827caa 1646897578 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Thu Mar 10 08:32:58 2022 +0100]","Body":"[website] Fix deploy action (#3089)\n\n","Date":"Thu Mar 10 08:32:58 CET 2022"},{"Commit-ID":"commit 9ee04b3133c84979661a3babf1b629d72a5b9f4e 1647028671 -----sp","Author":"PersonIdent[Yang Yang, yyang@streamnative.io, Sat Mar 12 03:57:51 2022 +0800]","Body":"Add a REST API to get or update bookie readOnly state\n\n### Motivation\r\n\r\nThis PR is a part of the work to improve the process of removing bookies from the cluster. Specifically, it implements the `readOnly` API described in the [mail](http://mail-archives.apache.org/mod_mbox/bookkeeper-dev/202109.mbox/raw/%3CCAJdLeK03g8K0h6swn%3D9yVP1Ze2zHxe8TDobK6a-zpTdABkeQEA%40mail.gmail.com%3E).\r\n\r\n### Changes\r\n\r\n- Add an REST API at `/api/v1/bookie/state/readonly`\r\n  - The `GET` method returns the current `readOnly` status\r\n  - The `PUT` method updates the `readOnly` status if needed.\r\n\r\n### TODOs\r\n\r\n- Update the document once the PR is accepted.\r\n- Update the `BookieStateManager` & `BookieImpl` to persist the information that the state change is triggered by the external API request and do not change the state based on the notification from the dirs monitoring service.\n\nReviewers: Yong Zhang <zhangyong1025.zy@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>, Andrey Yegorov <None>\n\nThis closes #2799 from fantapsody/readonly-api","Date":"Fri Mar 11 20:57:51 CET 2022"},{"Commit-ID":"commit b3ce6ca8950da29d1052c9cb230e8e51df9c3d10 1647029596 -----sp","Author":"PersonIdent[ken, 1647023764@qq.com, Sat Mar 12 04:13:16 2022 +0800]","Body":"fix a metric error in bookieStats\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\nfix a metric error in bookieStats\r\n\r\n### Changes\r\n\r\ngetReadEntryStats().registerFailedValue(entrySize) -> getReadBytesStats().registerFailedValue(entrySize)\r\n\r\n\r\n\r\n\r\n\n\nReviewers: Andrey Yegorov <None>, Nicolò Boschi <boschi1997@gmail.com>\n\nThis closes #3083 from TakaHiro0208/fix_bookieStats_metric_error","Date":"Fri Mar 11 21:13:16 CET 2022"},{"Commit-ID":"commit 4206fb5fe44726992cb22e8619525af480dcfc29 1647040032 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Fri Mar 11 15:07:12 2022 -0800]","Body":"Preparing for the release 4.15\n\nDescriptions of the changes in this PR:\r\n\r\nUpdated py client's version to 4.15\r\n\r\nMotivation\r\n\r\nPreparing for the release\r\nhttps://bookkeeper.apache.org/community/release_guide/#change-python-client-version\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #3095 from dlg99/python_client_rel_4.15","Date":"Sat Mar 12 00:07:12 CET 2022"},{"Commit-ID":"commit e4b16b3f883465ae3418b1cffaf9644767b71b9c 1647175817 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Sun Mar 13 20:50:17 2022 +0800]","Body":"fix bkperf message rate limit to 2GB/s (#3100)\n\n","Date":"Sun Mar 13 13:50:17 CET 2022"},{"Commit-ID":"commit 10825c93bccd9e170df75ab9f2cf85cb6043f649 1647256235 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Mon Mar 14 12:10:35 2022 +0100]","Body":"[website] update website every time there is a change (#3090)\n\n","Date":"Mon Mar 14 12:10:35 CET 2022"},{"Commit-ID":"commit 81dee85444de2c3f2036f3209fb0e700a5223cf0 1647340109 -----sp","Author":"PersonIdent[LinChen, 1572139390@qq.com, Tue Mar 15 18:28:29 2022 +0800]","Body":"ConcurrentOpenHashSet: fix reduce  unnecessary expansions (#3082)\n\n","Date":"Tue Mar 15 11:28:29 CET 2022"},{"Commit-ID":"commit d750afca90d532d500d8f4598c92d1198c41b57c 1647341742 -----sp","Author":"PersonIdent[LinChen, 1572139390@qq.com, Tue Mar 15 18:55:42 2022 +0800]","Body":"ConcurrentLong map and set\": add unit tests for reduce unnecessary expansions  (#3092)\n\n","Date":"Tue Mar 15 11:55:42 CET 2022"},{"Commit-ID":"commit 9809a41df4603e47938ef9cba9d06de93b94e912 1647362569 -----sp","Author":"PersonIdent[Lari Hotari, lhotari@users.noreply.github.com, Tue Mar 15 18:42:49 2022 +0200]","Body":"Run protobuf code generation automatically in IntelliJ and fix config (#3107)\n\n","Date":"Tue Mar 15 17:42:49 CET 2022"},{"Commit-ID":"commit 9d2d827509cf639825e73c8902658411e90cfbae 1647387144 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Wed Mar 16 07:32:24 2022 +0800]","Body":"bump lombok from 1.18.20 to 1.18.22 to support java17 compile\n\n### Motivation\r\n- required for compilation on JDK 17\r\n- see https://projectlombok.org/changelog\n\nReviewers: Andrey Yegorov <None>, Nicolò Boschi <boschi1997@gmail.com>\n\nThis closes #3097 from Shoothzj/bump-lombok-1-18-22","Date":"Wed Mar 16 00:32:24 CET 2022"},{"Commit-ID":"commit e99cd4915b56ae3e9891ef9a83eb5e8f089505d7 1647387776 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Wed Mar 16 07:42:56 2022 +0800]","Body":"Bump testcontainers version to 1.16.3\n\n### Motivation\r\n- Bump the testcontainers version to make tests can run on the latest docker on `Mac Intel Chip`\r\n- Bump `docker-java` version to `3.2.13`\n\nReviewers: Nicolò Boschi <boschi1997@gmail.com>, Andrey Yegorov <None>\n\nThis closes #3101 from Shoothzj/bump-test-container-version","Date":"Wed Mar 16 00:42:56 CET 2022"},{"Commit-ID":"commit 3af688bad65ff1ac972c9178a856613bd438e411 1647425459 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Wed Mar 16 18:10:59 2022 +0800]","Body":"add stats for throttled-write (#3102)\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n### Motivation\r\n\r\nmethod:triggerFlushAndAddEntry costing time is a changing,so add a stats metric focus on this method \r\n\r\n### Changes\r\n\r\n1.the previous counter metrics(throttledWriteRequests) are retained\r\n2.add throttledWriteStats to record cost time and count for the method(triggerFlushAndAddEntry) \r\n","Date":"Wed Mar 16 11:10:59 CET 2022"},{"Commit-ID":"commit 46a15520ea0675f74e20242429eeae33fd80f69e 1647446784 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Wed Mar 16 17:06:24 2022 +0100]","Body":"[website] New Website built with Docusaurus v2 (#3088)\n\n","Date":"Wed Mar 16 17:06:24 CET 2022"},{"Commit-ID":"commit 0235be3f4254eab37d4ca0a14a7bd3cc4d9f090c 1647454549 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Wed Mar 16 19:15:49 2022 +0100]","Body":"Gradle build: add mavenLocal() repository\n\n### Motivation\r\n\r\nIn Gradle you need to add `mavenLocal()` repository if you want to test local versions of third party libraries built with Maven (like ZooKeeper, Curator...)\r\n\r\n\r\n### Changes\r\nAdd `mavenLocal()`  repository\n\nReviewers: Matteo Merli <mmerli@apache.org>, Nicolò Boschi <boschi1997@gmail.com>, Andrey Yegorov <None>\n\nThis closes #3114 from eolivelli/impl/gradle-maven-local","Date":"Wed Mar 16 19:15:49 CET 2022"},{"Commit-ID":"commit c112637ec8be2a2f3a6baf6a28bed11934bd4b6f 1647517236 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Thu Mar 17 12:40:36 2022 +0100]","Body":"[website] deploy staging after every change (#3118)\n\n","Date":"Thu Mar 17 12:40:36 CET 2022"},{"Commit-ID":"commit c97fea571b026734e4b3f3d7eecfb15205f75c30 1647533289 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Thu Mar 17 17:08:09 2022 +0100]","Body":"[website] fix current site deployment (#3120)\n\n","Date":"Thu Mar 17 17:08:09 CET 2022"},{"Commit-ID":"commit 5dfade86c896843377de1af1c764b95566647893 1647533344 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Thu Mar 17 17:09:04 2022 +0100]","Body":"[website] fix deploy staging script (#3122)\n\n","Date":"Thu Mar 17 17:09:04 CET 2022"},{"Commit-ID":"commit 7d326838325cd5e4e0bd90e968a87542993a17ba 1647534470 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Thu Mar 17 17:27:50 2022 +0100]","Body":"[website] Fix deploy push to git - use ssh (#3123)\n\n","Date":"Thu Mar 17 17:27:50 CET 2022"},{"Commit-ID":"commit 8a780caf00e7874053a8cc81e7596f9d92b05a07 1647593951 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Fri Mar 18 09:59:11 2022 +0100]","Body":"[website] use GH_TOKEN to push to asf-site and asf-staging branches (#3124)\n\n","Date":"Fri Mar 18 09:59:11 CET 2022"},{"Commit-ID":"commit 3c40d4ac0db5c55b3cd029d316a91d236156a43c 1647600222 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Fri Mar 18 11:43:42 2022 +0100]","Body":"[website] fix GITHUB_TOKEN used for deployment (#3125)\n\n","Date":"Fri Mar 18 11:43:42 CET 2022"},{"Commit-ID":"commit 7bb0bfcafbfb7cb2ee330707e082f27c3a8fd530 1647621643 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Fri Mar 18 17:40:43 2022 +0100]","Body":"[WEBSITE] Staging website: images are not visible\n\n### Motivation\r\n\r\nIn the staging website image links are broken\r\n\r\n### Changes\r\n\r\n* Fixed the links with the correct syntax (I checked every `img` reference) \n\nReviewers: Andrey Yegorov <None>\n\nThis closes #3126 from nicoloboschi/website/fix-imgs","Date":"Fri Mar 18 17:40:43 CET 2022"},{"Commit-ID":"commit edffdd6dc261c3a9222751187a9f5ac601e9b1fa 1647875161 -----sp","Author":"PersonIdent[Andras Beni, andras.beni@streamnative.io, Mon Mar 21 16:06:01 2022 +0100]","Body":"Log NoLedgerException on debug level (#3117)\n\nNoLedgerException does not signify an error in the Bookie that needs\r\nto be fixed. Instead it is - at most - a user error that the user is\r\nnotified about via the status code ENOLEDGER.\r\nLogging this problem at error level introduces an odd difference\r\nbetween the behavior of readLac using v2 versus v3 protocol version.\r\nIn the former case ReadEntryProcessor logs the same problem at debug\r\nlevel. As a result changing protocol version appers to be introducing\r\nan error.","Date":"Mon Mar 21 16:06:01 CET 2022"},{"Commit-ID":"commit ac4a31a85ae8880182851d6691bc49e437942b15 1648022434 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Wed Mar 23 09:00:34 2022 +0100]","Body":"Remove unused site2 directory (#3116)\n\n","Date":"Wed Mar 23 09:00:34 CET 2022"},{"Commit-ID":"commit bb74c81df3b4f1213fa25e67dff1e0cc69476042 1648022460 -----sp","Author":"PersonIdent[Lari Hotari, lhotari@users.noreply.github.com, Wed Mar 23 10:01:00 2022 +0200]","Body":"Issue #3105: Optimize OrderedExecutor performance by using GrowableArrayBlockingQueue (#3108)\n\nFixes #3105\r\n","Date":"Wed Mar 23 09:01:00 CET 2022"},{"Commit-ID":"commit 7b5f96ec9d54849a439b577d7677cda26c7d937e 1648022513 -----sp","Author":"PersonIdent[Kezhu Wang, kezhuw@gmail.com, Wed Mar 23 16:01:53 2022 +0800]","Body":"Set BOOKIE_HTTP_PORT to make it optional in docker run (#3096)\n\nFixes #3075.","Date":"Wed Mar 23 09:01:53 CET 2022"},{"Commit-ID":"commit 9b783ef8d8dcdfdc21a56f4afb873447517b5aaf 1648110122 -----sp","Author":"PersonIdent[congbo, 39078850+congbobo184@users.noreply.github.com, Thu Mar 24 16:22:02 2022 +0800]","Body":"PendingReadOp: Fix ledgerEntryImpl reuse problem (#3110)\n\n","Date":"Thu Mar 24 09:22:02 CET 2022"},{"Commit-ID":"commit 2fe585c00ac94f8d7430dd436edd8745d37d8b89 1648138509 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Thu Mar 24 09:15:09 2022 -0700]","Body":"Bringing back maven build (#3130)\n\n* Revert \"[build] remove Maven POM files (#3009)\"\r\n\r\nThis reverts commit e089b51ab5e1cf5f061c81463d27f33a21198271.\r\n\r\n* rxjava: add maven dependency\r\n\r\n(cherry picked from commit ac73541ce79953141a08c60642cd39c7984ade1e)\r\n\r\n* Bring guava to the same version as gradle\r\n\r\n* ignore deprecation warnings in tests\r\n\r\n* mockito-inline, as in gradle + suppress warnings\r\n\r\n* suppressed warning\r\n\r\n* Exclude site3/ from RAT check\r\n\r\n* CI to use (mostly) maven\r\n\r\n* OWASP check with maven\r\n\r\n* Up'd versions to match gradle, corrected license files: looks like gradle build didn't force versions consistently\r\n\r\n* Removed current-version-image to match https://github.com/apache/bookkeeper/pull/3027\r\n\r\n* Shading patetrn to match gradle\r\n\r\n* Fixed/suppressed CVEs\r\n\r\n* Attempt to fix failing tests in CompactionByEntriesWithMetadataCacheTest\r\n\r\nCo-authored-by: lushiji <lushiji@didiglobal.com>","Date":"Thu Mar 24 17:15:09 CET 2022"},{"Commit-ID":"commit a75b48b44bbe825281877b37b964dc05cb810d8f 1648374816 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Sun Mar 27 17:53:36 2022 +0800]","Body":"Upgrade rocksdb to 6.29.4.1 (#3143)\n\n","Date":"Sun Mar 27 11:53:36 CEST 2022"},{"Commit-ID":"commit e4a2b54240d608763e8f9acd6ffb91740dfd3f10 1648384636 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Sun Mar 27 14:37:16 2022 +0200]","Body":"[security] Upgrade jackson-databind to get rid of CVE-2020-36518 (#3140)\n\n* [security] Upgrade jackson-databind to get rid of CVE-2020-36518","Date":"Sun Mar 27 14:37:16 CEST 2022"},{"Commit-ID":"commit dc2eafa680384c1fc653ad9fd83d4cd5a66d8af4 1648482784 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Mon Mar 28 17:53:04 2022 +0200]","Body":"BookieAutoRecoveryTest.testEmptyLedgerLosesQuorumEventually fix flaky test, ensure that the Auditor is alive (#3149)\n\n","Date":"Mon Mar 28 17:53:04 CEST 2022"},{"Commit-ID":"commit b4d98e8c5afe4b9d6bcf6100dd943c003bd1ca89 1648506194 -----sp","Author":"PersonIdent[赵延, horizonzy@apache.org, Tue Mar 29 06:23:14 2022 +0800]","Body":"Fix doc code problem.\n\nfix docs code demo problem.\n\nReviewers: Nicolò Boschi <boschi1997@gmail.com>, Andrey Yegorov <None>\n\nThis closes #3142 from horizonzy/fix-docs-code-problem","Date":"Tue Mar 29 00:23:14 CEST 2022"},{"Commit-ID":"commit 7ae721dd9fa3aac3cfb511616e23747b09875594 1648508075 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Mon Mar 28 15:54:35 2022 -0700]","Body":"Fix NPE while reordering read-sequence for local-bookie ensemble policy\n\n### Motivation\r\n\r\nWhen Bookie sanity and autoreovery use the same conf file which has flag `reorderReadSequenceEnabled=true` then bookie-sanity command throws NPE as `LocalBookieEnsemblePlacementPolicy::reorderReadLACSequence` returns null writesets which causes the sanity failure.\r\n\r\n```\r\n00:46:46.202 [BookKeeperClientWorker-OrderedExecutor-11-0] ERROR o.a.b.common.util.SafeRunnable       - Unexpected throwable caught \r\njava.lang.NullPointerException: null\r\n\tat org.apache.bookkeeper.client.PendingReadOp$SequenceReadRequest.sendNextRead(PendingReadOp.java:399)\r\n\tat org.apache.bookkeeper.client.PendingReadOp$SequenceReadRequest.read(PendingReadOp.java:385)\r\n\tat org.apache.bookkeeper.client.PendingReadOp.initiate(PendingReadOp.java:529)\r\n\tat org.apache.bookkeeper.client.LedgerRecoveryOp.doRecoveryRead(LedgerRecoveryOp.java:148)\r\n\tat org.apache.bookkeeper.client.LedgerRecoveryOp.access$000(LedgerRecoveryOp.java:37)\r\n\tat org.apache.bookkeeper.client.LedgerRecoveryOp$1.readLastConfirmedDataComplete(LedgerRecoveryOp.java:109)\r\n\tat org.apache.bookkeeper.client.ReadLastConfirmedOp.readEntryComplete(ReadLastConfirmedOp.java:135)\r\n\tat org.apache.bookkeeper.proto.PerChannelBookieClient$ReadCompletion$1.readEntryComplete(PerChannelBookieClient.java:1829)\r\n\tat org.apache.bookkeeper.proto.PerChannelBookieClient$ReadCompletion.handleReadResponse(PerChannelBookieClient.java:1910)\r\n\tat org.apache.bookkeeper.proto.PerChannelBookieClient$ReadCompletion.handleV3Response(PerChannelBookieClient.java:1885)\r\n\tat org.apache.bookkeeper.proto.PerChannelBookieClient$3.safeRun(PerChannelBookieClient.java:1446)\r\n\tat org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\n\r\n```\r\n\r\n### Modification\r\nFix NPE for local ensemble policy while reading entry with `reorderReadSequenceEnabled` flag enabled.\n\nReviewers: Andrey Yegorov <None>, Enrico Olivelli <eolivelli@gmail.com>, Nicolò Boschi <boschi1997@gmail.com>\n\nThis closes #3127 from rdhabalia/repl_seq","Date":"Tue Mar 29 00:54:35 CEST 2022"},{"Commit-ID":"commit 0feaed90c9eb23fb373d2cd40711d6e536203ecf 1648508508 -----sp","Author":"PersonIdent[Andrey Yegorov, andrey.yegorov@datastax.com, Mon Mar 28 16:01:48 2022 -0700]","Body":"[maven-release-plugin] prepare branch branch-4.15\n","Date":"Tue Mar 29 01:01:48 CEST 2022"},{"Commit-ID":"commit e931dbda090ae40e3c39313801fa49e40bcc1fd6 1648508511 -----sp","Author":"PersonIdent[Andrey Yegorov, andrey.yegorov@datastax.com, Mon Mar 28 16:01:51 2022 -0700]","Body":"[maven-release-plugin] prepare for next development iteration\n","Date":"Tue Mar 29 01:01:51 CEST 2022"},{"Commit-ID":"commit 38dc3281f5f175a7d194d4c0d4b255472886187b 1648535340 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Tue Mar 29 14:29:00 2022 +0800]","Body":"fix duplicate typeline for prometheus type (#3137)\n\n","Date":"Tue Mar 29 08:29:00 CEST 2022"},{"Commit-ID":"commit 18e3f851601e016125aaaa7ba4910009cdbea78c 1648636893 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Wed Mar 30 12:41:33 2022 +0200]","Body":"Upgrade ZooKeeper to 3.8.0 (#3145)\n\n","Date":"Wed Mar 30 12:41:33 CEST 2022"},{"Commit-ID":"commit ba2dede103458f6ba64a8fa90e83ac27034cf13c 1648681825 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Thu Mar 31 07:10:25 2022 +0800]","Body":"use mockito.any instead of deprecated mockito.anyObject\n\n### Changes\r\nuse mockito.any instead of deprecated mockito.anyObject\r\n\n\nReviewers: Andrey Yegorov <None>, Nicolò Boschi <boschi1997@gmail.com>\n\nThis closes #3152 from Shoothzj/use-mockito-any-instead-of-anyObject","Date":"Thu Mar 31 01:10:25 CEST 2022"},{"Commit-ID":"commit f55ac1ed55336c3ba461c57a3428430309118344 1648705354 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Thu Mar 31 13:42:34 2022 +0800]","Body":"catch onBookieRackChange exception (#3060)\n\n### Motivation\r\nWhen we update the bookie rack info, it will use all the bookie list to update rack topology. However If one bookie update failed and throw exception out, it will throw the exception out and the remains bookie info won't be updated into the rack topology, which will affect the ledger ensemble selection.\r\n\r\n### Changes\r\n\r\nCatch the bookie topology update exception to ensure the remaining bookies' info can be updated into the rack topology.\r\n","Date":"Thu Mar 31 07:42:34 CEST 2022"},{"Commit-ID":"commit ef0b5cc7726b929aa1fc9c617f2130afae527c18 1648710493 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Thu Mar 31 15:08:13 2022 +0800]","Body":"Revert rocksdb compaction on checkpoint to reduce cpu intensive (#3144)\n\n","Date":"Thu Mar 31 09:08:13 CEST 2022"},{"Commit-ID":"commit d7376c45acd8764bd8efdf6d26feab874a460422 1648727112 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Thu Mar 31 13:45:12 2022 +0200]","Body":"[website] Update committers page\n\n### Changes\r\nUpdate committers info\r\n\n\nReviewers: Andrey Yegorov <None>\n\nThis closes #3161 from nicoloboschi/update-committers-nicoloboschi","Date":"Thu Mar 31 13:45:12 CEST 2022"},{"Commit-ID":"commit 4443c60739ad8f3ea2156c9bd7243e44a22709c9 1648733987 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Thu Mar 31 21:39:47 2022 +0800]","Body":"Fix region/rack aware placement police replace bookie bug (#2642)\n\n","Date":"Thu Mar 31 15:39:47 CEST 2022"},{"Commit-ID":"commit 62cfc0ec8670cb66ce4bf2b0d707f42cba5e3354 1648798677 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Fri Apr 1 09:37:57 2022 +0200]","Body":"[build] Fix various spotbugs warnings  (#3160)\n\n","Date":"Fri Apr 01 09:37:57 CEST 2022"},{"Commit-ID":"commit bf2765ae08540846e3059ed15d33d3de0ec96ea2 1648842864 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Fri Apr 1 21:54:24 2022 +0200]","Body":"[WEBSITE] Update current stable version to 4.14.4\n\n### Motivation\r\n\r\nThe current stable version is 4.14.4 but in the website is still 4.11.1\r\n\r\n### Changes\r\n\r\n* Edit variables to point to 4.14.4\r\n* Cleanup staging website \"download\" page\r\n\n\nReviewers: Yong Zhang <zhangyong1025.zy@gmail.com>\n\nThis closes #3154 from nicoloboschi/update-stable-version","Date":"Fri Apr 01 21:54:24 CEST 2022"},{"Commit-ID":"commit 28e47f9f2a94a7e451e1459b9d9de5296862554f 1648927278 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sun Apr 3 03:21:18 2022 +0800]","Body":"[security] Bump bc fips version from 1.0.2.1 to 1.0.2.3 (#3087)\n\n","Date":"Sat Apr 02 21:21:18 CEST 2022"},{"Commit-ID":"commit e5f68c6a4303a1bcb4abb9b29a9e0abd653018f6 1648927333 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sun Apr 3 03:22:13 2022 +0800]","Body":"[build] Complement missing maven plugin version (#3166)\n\n","Date":"Sat Apr 02 21:22:13 CEST 2022"},{"Commit-ID":"commit 5502b4014944d97e531993606b2c2e7eae89733c 1648972821 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sun Apr 3 16:00:21 2022 +0800]","Body":"Bump netty version to 4.1.75.Final, grpc to 1.45.1 (#3163)\n\n","Date":"Sun Apr 03 10:00:21 CEST 2022"},{"Commit-ID":"commit daf52648f210c65d96326a8b9a4f66a72551deef 1649002189 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Sun Apr 3 18:09:49 2022 +0200]","Body":"[netty] remove no longer used properties io.netty.recycler.linkCapacity and io.netty.recycler.maxCapacity.default (#3172)\n\n* [netty] remove no longer used properties io.netty.recycler.linkCapacity and io.netty.recycler.maxCapacity.default\r\n\r\n* gradle","Date":"Sun Apr 03 18:09:49 CEST 2022"},{"Commit-ID":"commit dc2b0c5dfd9a4cdef44cdab3da46c7ea8027ab13 1649223977 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Wed Apr 6 13:46:17 2022 +0800]","Body":"[build] support apple m1 build (#3175)\n\n","Date":"Wed Apr 06 07:46:17 CEST 2022"},{"Commit-ID":"commit d4eba629504930ca6179dee220e075b489c193a7 1649232793 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Wed Apr 6 16:13:13 2022 +0800]","Body":"Use netty maxDirectMemory instead of DirectMemoryUtils\n\n### Motivation\r\n\r\nOur `DirectMemoryUtils` has huge limit, it can't work well with other jvm. The Netty `PlatformDependent.maxDirectMemory();` is more generic.\r\n\r\n### Changes\r\nUse `PlatformDependent.maxDirectMemory();` instead of `DirectMemoryUtils`\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Andrey Yegorov <None>, Matteo Merli <mmerli@apache.org>, Nicolò Boschi <boschi1997@gmail.com>\n\nThis closes #2989 from Shoothzj/direct-memory","Date":"Wed Apr 06 10:13:13 CEST 2022"},{"Commit-ID":"commit 409ca76f123a28f580c74f41c8536d92e56a9c9b 1649236014 -----sp","Author":"PersonIdent[dependabot[bot], 49699333+dependabot[bot]@users.noreply.github.com, Wed Apr 6 11:06:54 2022 +0200]","Body":"Bump node-forge from 1.2.1 to 1.3.1 in /site3/website (#3180)\n\nBumps [node-forge](https://github.com/digitalbazaar/forge) from 1.2.1 to 1.3.1.\r\n- [Release notes](https://github.com/digitalbazaar/forge/releases)\r\n- [Changelog](https://github.com/digitalbazaar/forge/blob/main/CHANGELOG.md)\r\n- [Commits](https://github.com/digitalbazaar/forge/compare/v1.2.1...v1.3.1)\r\n\r\n---\r\nupdated-dependencies:\r\n- dependency-name: node-forge\r\n  dependency-type: indirect\r\n...\r\n\r\nSigned-off-by: dependabot[bot] <support@github.com>\r\n\r\nCo-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>","Date":"Wed Apr 06 11:06:54 CEST 2022"},{"Commit-ID":"commit 0863979f79386f92945458b2bc02e4625c9d993d 1649236070 -----sp","Author":"PersonIdent[dependabot[bot], 49699333+dependabot[bot]@users.noreply.github.com, Wed Apr 6 11:07:50 2022 +0200]","Body":"Bump minimist from 1.2.5 to 1.2.6 in /site3/website (#3179)\n\nBumps [minimist](https://github.com/substack/minimist) from 1.2.5 to 1.2.6.\r\n- [Release notes](https://github.com/substack/minimist/releases)\r\n- [Commits](https://github.com/substack/minimist/compare/1.2.5...1.2.6)\r\n\r\n---\r\nupdated-dependencies:\r\n- dependency-name: minimist\r\n  dependency-type: indirect\r\n...\r\n\r\nSigned-off-by: dependabot[bot] <support@github.com>\r\n\r\nCo-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>","Date":"Wed Apr 06 11:07:50 CEST 2022"},{"Commit-ID":"commit 7b38a6a1565279c91a25a54820e9dba2cb563bab 1649236627 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Wed Apr 6 11:17:07 2022 +0200]","Body":"[website] add CI checks to validate the website (#3164)\n\n","Date":"Wed Apr 06 11:17:07 CEST 2022"},{"Commit-ID":"commit 139eed311393c7077db6e7470c0f167e16b6b3b0 1649259448 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Wed Apr 6 23:37:28 2022 +0800]","Body":"[BUILD] fix master branch broken http-core license check\n\n### Changes\r\n- the bkctl and bk-server has different `http-core` version\r\n- unify the `http-core` version to 4.4.15\r\n\n\nReviewers: Andrey Yegorov <None>, Nicolò Boschi <boschi1997@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #3183 from Shoothzj/fix-broken-license-check","Date":"Wed Apr 06 17:37:28 CEST 2022"},{"Commit-ID":"commit 67c963a1b02de04166778d906f4cffe89dd86562 1649260727 -----sp","Author":"PersonIdent[gaozhangmin, gaozhangmin456@qq.com, Wed Apr 6 23:58:47 2022 +0800]","Body":"only update topology when bookie rack changed\n\nIt is unnecessary to update  topology, removing and adding the same bookieNode, if the rack of bookie stay unchanged.\n\nReviewers: Yong Zhang <zhangyong1025.zy@gmail.com>, Nicolò Boschi <boschi1997@gmail.com>, Andrey Yegorov <None>, ZhangJian He <shoothzj@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #2790 from gaozhangmin/remove-unnecessary-update-rack","Date":"Wed Apr 06 17:58:47 CEST 2022"},{"Commit-ID":"commit b0030ab5d9132e5c5cd5092b8e6dab79e9fbf16c 1649314596 -----sp","Author":"PersonIdent[Raúl Gracia, raul.gracia@emc.com, Thu Apr 7 08:56:36 2022 +0200]","Body":"Upgrade to log4j 2.17.2. (#3188)\n\nSigned-off-by: Raúl Gracia <raul.gracia@emc.com>","Date":"Thu Apr 07 08:56:36 CEST 2022"},{"Commit-ID":"commit bcccea06e4aab38925dfd28824fdb046825123f9 1649634579 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Mon Apr 11 07:49:39 2022 +0800]","Body":"BP-47 (task1): Add native IO library support (#3189)\n\n* Add native io library support\r\n\r\n* fix jni compile issue\r\n\r\n* fix findbugs failed","Date":"Mon Apr 11 01:49:39 CEST 2022"},{"Commit-ID":"commit d7a653b06233f36786f850270dbb16fc83e45c4e 1649634618 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Mon Apr 11 07:50:18 2022 +0800]","Body":"BP-47 (task2): Add structured logger support (#3190)\n\n* Add slogger support\r\n\r\n* update pom.xml\r\n\r\n* fix check style","Date":"Mon Apr 11 01:50:18 CEST 2022"},{"Commit-ID":"commit b989fbcdae74db6e26a815af605634747f431fb9 1649639002 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Mon Apr 11 09:03:22 2022 +0800]","Body":"Allow running units test on jdk17 (#3195)\n\n* Allow running units test on jdk17\r\n\r\n* Allow running units test on jdk17","Date":"Mon Apr 11 03:03:22 CEST 2022"},{"Commit-ID":"commit 78c0ca5672e6226ca1eff12bd9112d0ed366828e 1649814440 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Wed Apr 13 09:47:20 2022 +0800]","Body":"remove unnessary exception catch (#3169)\n\n### Motivation\r\nWhen read Lac from ledger, we won't throw NoEntryException, remove this exception catch.\r\n\r\n\r\n### Changes\r\nRemove the NoEntryException catch in ReadLac operation.\r\n\r\n\r\n","Date":"Wed Apr 13 03:47:20 CEST 2022"},{"Commit-ID":"commit 1b648a8be00597094a0ef5005ee4d692d9b8770a 1649814474 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Wed Apr 13 09:47:54 2022 +0800]","Body":"expose netty threads num config to bk_server.conf (#3173)\n\n### Motivation\r\nhttps://github.com/apache/bookkeeper/pull/1612 this PR make the Netty io threads number configurable, but doesn't expose to the `bk_server.conf`. This parameter will be usually changed in performance tuning especially deploy this bookie on bare metal which have many cpus. For operation engineer who is unfamiliar with the source code will be hard to do performance tuning.\r\n\r\n### Changes\r\nExpose this parameter configuration into `bk_server.conf` and website. And add more explanation about it. \r\n\r\n","Date":"Wed Apr 13 03:47:54 CEST 2022"},{"Commit-ID":"commit bbd2d4a4f787094c1cc6b67c2c2bd9794ffe435e 1649814555 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Wed Apr 13 09:49:15 2022 +0800]","Body":"simplify throttle code in metadata scanning (#3196)\n\n### Motivation\r\nThe throttler has been checked whether throttle by bytes in `acquire` method, we doesn't need double check.\r\n\r\n### Changes\r\n\r\nRemove the double check of whether throttle by bytes.\r\n","Date":"Wed Apr 13 03:49:15 CEST 2022"},{"Commit-ID":"commit f7579fd13d62ce630ea26638e73f5884da505ec8 1649853428 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Wed Apr 13 20:37:08 2022 +0800]","Body":"Fix master broken ci due to zookeeper CVE fp (#3204)\n\n","Date":"Wed Apr 13 14:37:08 CEST 2022"},{"Commit-ID":"commit e937ae9a6838fd533c3973d6ae6c32d98b6619bd 1649929797 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Thu Apr 14 11:49:57 2022 +0200]","Body":"[website] Make site3 the official website (deploy scripts - master) (#3187)\n\n* [website] Make site3 the official website\r\n\r\n* fix action","Date":"Thu Apr 14 11:49:57 CEST 2022"},{"Commit-ID":"commit 7c8930330da3c20747206ef101a497dc58ab0547 1650002444 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Fri Apr 15 14:00:44 2022 +0800]","Body":"Fix testCompactionPersistence do not cleanup created directory (#3207)\n\n","Date":"Fri Apr 15 08:00:44 CEST 2022"},{"Commit-ID":"commit 760b9e0192e954ebcd7b3b302f3b43672da21a58 1650386090 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Wed Apr 20 00:34:50 2022 +0800]","Body":"Remove log4j1 from bk test code\n\n### Motivation\r\nthis is a part work of remove log4j1 from bookeeper, first remove it from our test code, unit test and integrate test\r\n\r\n### Changes\r\n- remove log4j1 scope test dependency\r\n- use log4j2.xml instread of log4j.properties\r\n- introduce testtools module to reduce duplication,  if a module needs particular configuration (very unlikely) we can add a log4j2-test.xml file which has precedence over log4j2.xml one. idea from [nicoloboschi](https://github.com/nicoloboschi)\n\nReviewers: Andrey Yegorov <None>, Enrico Olivelli <eolivelli@gmail.com>, Nicolò Boschi <boschi1997@gmail.com>\n\nThis closes #3208 from Shoothzj/remove-log4j1-from-bk-test-code2","Date":"Tue Apr 19 18:34:50 CEST 2022"},{"Commit-ID":"commit 16c9766b952fb3d1fb42d6a308e8525c9ffddbf8 1650396304 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Wed Apr 20 03:25:04 2022 +0800]","Body":"fix numLedgersReplicated metric not update (#3218)\n\n","Date":"Tue Apr 19 21:25:04 CEST 2022"},{"Commit-ID":"commit f0ff353d02ec56715d671040717870ec5f1a7630 1650462195 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Wed Apr 20 21:43:15 2022 +0800]","Body":"Fix force GC doesn't work under forceAllowCompaction when disk is full (#3205)\n\n## Motivation\r\nWhen I set `forceAllowCompaction=true` and one ledger disk reaches max usage threshold and transfer bookie to readOnly mode, I expire some pulsar topics or delete some topics to free up disk space. I found that ledger compression cannot be triggered when using `curl -XPUT http://localhost:8000/api/v1/bookie/gc` command.\r\n\r\nThe root cause is that when one ledger disk reaches max usage threshold, it will suspend minor and major compaction\r\nhttps://github.com/apache/bookkeeper/blob/f7579fd13d62ce630ea26638e73f5884da505ec8/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java#L1041-L1058\r\n\r\nWhen we use `curl -XPUT http://localhost:8000/api/v1/bookie/gc` command to trigger compaction, it will be filtered by `suspendMajor` and `suspendMinor` flag.  \r\n\r\nhttps://github.com/apache/bookkeeper/blob/f7579fd13d62ce630ea26638e73f5884da505ec8/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollectorThread.java#L416-L444\r\n\r\nIt will lead to \r\n- The bookie won't clean up deleted ledgers \r\n- Ledger disk can't free up disk usage\r\n- Bookie can't recover from readOnly state into Writeable state.\r\n\r\nAnd then we can only trigger compaction by the following steps.\r\n- Increase max disk usage threshold\r\n- Restart the bookie\r\n- Use command `curl -XPUT http://localhost:8000/api/v1/bookie/gc` to trigger compaction\r\n\r\n### Changes\r\n1. Don't take the `suspendMajor` and `suspendMinor` flag into consideration when setting `forceAllowCompaction=true` and triggered by force GC.","Date":"Wed Apr 20 15:43:15 CEST 2022"},{"Commit-ID":"commit 03be2561e93ad29632b02d9ee2c6a3572e70b35f 1650464135 -----sp","Author":"PersonIdent[dependabot[bot], 49699333+dependabot[bot]@users.noreply.github.com, Wed Apr 20 16:15:35 2022 +0200]","Body":"Bump async from 2.6.3 to 2.6.4 in /site3/website (#3219)\n\nBumps [async](https://github.com/caolan/async) from 2.6.3 to 2.6.4.\r\n- [Release notes](https://github.com/caolan/async/releases)\r\n- [Changelog](https://github.com/caolan/async/blob/v2.6.4/CHANGELOG.md)\r\n- [Commits](https://github.com/caolan/async/compare/v2.6.3...v2.6.4)\r\n\r\n---\r\nupdated-dependencies:\r\n- dependency-name: async\r\n  dependency-type: indirect\r\n...\r\n\r\nSigned-off-by: dependabot[bot] <support@github.com>\r\n\r\nCo-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>","Date":"Wed Apr 20 16:15:35 CEST 2022"},{"Commit-ID":"commit 03cc5f435f1d3072c66cfd0ac69d129e3bdf8923 1650464300 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Wed Apr 20 22:18:20 2022 +0800]","Body":"Bump jackson databind version to 2.13.2.2\n\n### Changes\r\n- jackson bom will release a version when everytime its components releases, so we don't need to define variables like `jackson-data.version`\r\n- bump jackson databind version to 2.13.2.2\n\nReviewers: Nicolò Boschi <boschi1997@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #3216 from Shoothzj/bump-jackson-databind-version-2-13-2-2","Date":"Wed Apr 20 16:18:20 CEST 2022"},{"Commit-ID":"commit 220192ae983db3faeadf52acbae4413cef0f6195 1650500828 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Thu Apr 21 08:27:08 2022 +0800]","Body":"fix cli command doc issue (#3226)\n\n### Motivation\r\nFix #3221 \r\n\r\n### Changes\r\nFix some cli command doc issue, and keep sync with code.\r\n\r\n","Date":"Thu Apr 21 02:27:08 CEST 2022"},{"Commit-ID":"commit b74981fc27f93bc36f549c2c3309cc5ef0c6d51d 1650527409 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Thu Apr 21 15:50:09 2022 +0800]","Body":"[ZooKeeper] [Conflict] Bump dropwizard metrics to zookeeper needed (#3229)\n\n","Date":"Thu Apr 21 09:50:09 CEST 2022"},{"Commit-ID":"commit 1edc68854c3f3aace30c4ae497a3b6242bbce95e 1650541353 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Thu Apr 21 19:42:33 2022 +0800]","Body":"fix broken local bookie (#3230)\n\n","Date":"Thu Apr 21 13:42:33 CEST 2022"},{"Commit-ID":"commit 02d41c0e061daa62e53078be048c5c503d1bfefa 1650541378 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Thu Apr 21 19:42:58 2022 +0800]","Body":"[minor] replace deprecated api use MockitoAnnotations.initMocks (#3177)\n\n","Date":"Thu Apr 21 13:42:58 CEST 2022"},{"Commit-ID":"commit 83ec4a964e2447ce1a36b7087a9cf0bec10457cb 1650589201 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Fri Apr 22 09:00:01 2022 +0800]","Body":"fix logger number not correct (#3211)\n\n### Motivation\r\n\r\nfix logger number not correct\r\n\r\n### Changes\r\n\r\nfix logger number not correct\r\n","Date":"Fri Apr 22 03:00:01 CEST 2022"},{"Commit-ID":"commit 4011138dbe3c2410a9ae1521d2da29be4683cf4e 1650643577 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sat Apr 23 00:06:17 2022 +0800]","Body":"bookeeper all missing stream binary (#3238)\n\n","Date":"Fri Apr 22 18:06:17 CEST 2022"},{"Commit-ID":"commit f0988ddf250440813866849cef4f734174a48fc4 1650643818 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sat Apr 23 00:10:18 2022 +0800]","Body":"Remove log4j from bookkeeper (#3225)\n\n","Date":"Fri Apr 22 18:10:18 CEST 2022"},{"Commit-ID":"commit 28834d037c17268c4398ce7dbbc1246ab56a6f3e 1650643859 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sat Apr 23 00:10:59 2022 +0800]","Body":"[minor] cleanup on InterleavedLedgerStorage (#3210)\n\n","Date":"Fri Apr 22 18:10:59 CEST 2022"},{"Commit-ID":"commit f8612883c7ed358e10ee2579b700ab46f48e95ba 1650645131 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Fri Apr 22 18:32:11 2022 +0200]","Body":"[build] make build passes on JDK17 (#3053)\n\n","Date":"Fri Apr 22 18:32:11 CEST 2022"},{"Commit-ID":"commit 0aace4ed72cceebbc9719d51ee26c95890789e14 1650768765 -----sp","Author":"PersonIdent[leiwingqueen, 496326100@qq.com, Sun Apr 24 10:52:45 2022 +0800]","Body":"Issue 2518:fix error link (#3217)\n\n### Motivation\r\n\r\n(Explain: why you're making that change, what is the problem you're trying to solve)\r\n[issue 2518](https://github.com/apache/bookkeeper/issues/2518)\r\n\r\n### Changes\r\n\r\njust try to fix the error link.","Date":"Sun Apr 24 04:52:45 CEST 2022"},{"Commit-ID":"commit 0a2f796c0f27735c82c8d22b82fa0c88ddb1a674 1650796941 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sun Apr 24 18:42:21 2022 +0800]","Body":"[ci] [github] upload test log when fail (#3241)\n\n","Date":"Sun Apr 24 12:42:21 CEST 2022"},{"Commit-ID":"commit 49bb6369fced44e60bd86dbadec53eec4d173e74 1650925535 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Tue Apr 26 00:25:35 2022 +0200]","Body":"Bump jetty to 9.4.46.v20220331 to get rid of CVE-2021-34429\n\n### Motivation\r\n\r\nCurrent jetty version is vulnerable to https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-34429\r\n\r\n\r\n### Changes\r\n\r\n* Upgrade to the latest 9.x one 9.4.46.v20220331\r\n\n\nReviewers: Andrey Yegorov <None>, ZhangJian He <shoothzj@gmail.com>, Tian Luo <futurer@outlook.com>, Yong Zhang <zhangyong1025.zy@gmail.com>\n\nThis closes #3232 from nicoloboschi/bump-jetty-9.4.46.v20220331","Date":"Tue Apr 26 00:25:35 CEST 2022"},{"Commit-ID":"commit 083e2e94d18edcd85a1d25deaf77ecad0e3de61d 1650925684 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Tue Apr 26 06:28:04 2022 +0800]","Body":"Fix read empty ledger exception using bookkeeper admin\n\n### Motivation\r\nFix #3222 \r\n\r\nThe root cause is that BookKeeperAdmin use `asyncReadEntriesInternal` to read entries. However, the `asyncReadEntriesInternal` doesn't check the lastAddConfirm, which will lead to the exception list in issue 3222\r\n\r\n### Changes\r\n\r\nAdd lastAddConfirm check before call `asyncReadEntriesInternal`\n\nReviewers: Yong Zhang <zhangyong1025.zy@gmail.com>, Andrey Yegorov <None>\n\nThis closes #3240 from hangc0276/chenhang/fix_BKBookieHandleNotAvailableException_for_empty_ledger","Date":"Tue Apr 26 00:28:04 CEST 2022"},{"Commit-ID":"commit b17969e07fbb3a0ca5ec3c374a4fab27e87add17 1650925940 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Tue Apr 26 06:32:20 2022 +0800]","Body":"Format log statements\n\n### Motivation\r\nIn PR #2455 , It convert all `System.*.print` statements to `LOG.* statements`. However, in `LOG.*` statements, it uses string concatenation to print messages, which is low performance.\r\n\r\n### Changes\r\nChange the string concatenation format to `LOG.*` standard statements\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Andrey Yegorov <None>, ZhangJian He <shoothzj@gmail.com>, Nicolò Boschi <boschi1997@gmail.com>, Yong Zhang <zhangyong1025.zy@gmail.com>\n\nThis closes #3213 from hangc0276/chenhang/format_log_info","Date":"Tue Apr 26 00:32:20 CEST 2022"},{"Commit-ID":"commit b7128977d466c6e113b1d576b88d9f1e70689ad7 1650926116 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Tue Apr 26 06:35:16 2022 +0800]","Body":"Fix bookie shell help command exception\n\n### Motivation\r\nWhen run `bin/bookkeeper shell ledgermetadata -h` command, it throw the following exception.\r\n```\r\n23:02:41,236 ERROR Error parsing command line arguments :\r\norg.apache.commons.cli.UnrecognizedOptionException: Unrecognized option: -h\r\n\tat org.apache.commons.cli.Parser.processOption(Parser.java:363) ~[commons-cli-commons-cli-1.2.jar:1.2]\r\n\tat org.apache.commons.cli.Parser.parse(Parser.java:199) ~[commons-cli-commons-cli-1.2.jar:1.2]\r\n\tat org.apache.commons.cli.Parser.parse(Parser.java:85) ~[commons-cli-commons-cli-1.2.jar:1.2]\r\n\tat org.apache.bookkeeper.bookie.BookieShell$MyCommand.runCmd(BookieShell.java:240) ~[org.apache.bookkeeper-bookkeeper-server-4.16.0-SNAPSHOT.jar:4.16.0-SNAPSHOT]\r\n\tat org.apache.bookkeeper.bookie.BookieShell.run(BookieShell.java:2372) ~[org.apache.bookkeeper-bookkeeper-server-4.16.0-SNAPSHOT.jar:4.16.0-SNAPSHOT]\r\n\tat org.apache.bookkeeper.bookie.BookieShell.main(BookieShell.java:2463) ~[org.apache.bookkeeper-bookkeeper-server-4.16.0-SNAPSHOT.jar:4.16.0-SNAPSHOT]\r\nledgermetadata: Print the metadata for a ledger, or optionally dump to a file.\r\nusage: ledgermetadata -ledgerid <ledgerid> [--dump-to-file\r\n                      FILENAME|--restore-from-file FILENAME]\r\n -dumptofile <arg>        Dump metadata for ledger, to a file\r\n -l,--ledgerid <arg>      Ledger ID\r\n -restorefromfile <arg>   Restore metadata for ledger, from a file\r\n```\r\n\r\n### Changes\r\nAdd `-h` and `--help` support.\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, ZhangJian He <shoothzj@gmail.com>, Andrey Yegorov <None>\n\nThis closes #3227 from hangc0276/chenhang/fix_bookieshell_help_exception","Date":"Tue Apr 26 00:35:16 CEST 2022"},{"Commit-ID":"commit 60a671e1f890aab12f94dad2d3de4d3776731c4d 1650935686 -----sp","Author":"PersonIdent[iamazy, iamazy.me@outlook.com, Tue Apr 26 09:14:46 2022 +0800]","Body":"Correct the method signature within annotations\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n### Motivation\r\n\r\nSome interfaces have modified the method signature but the annotations have not.\r\n\r\n### Changes\r\n\r\nCorrect the method signature within annotations and fix typos\n\nReviewers: Andrey Yegorov <None>, ZhangJian He <shoothzj@gmail.com>\n\nThis closes #3201 from iamazy/fix-typo","Date":"Tue Apr 26 03:14:46 CEST 2022"},{"Commit-ID":"commit f60a4d6d4069b5318f61a378125a1ef4d8471adf 1650953857 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Tue Apr 26 14:17:37 2022 +0800]","Body":"Add get under replicated ledger count\n\n### Motivation\r\nFix #3224 \r\n\r\n### Changes\r\nAdd flag for `ListUnderreplicatedCmd` to control only display under replicated ledgers count\r\n\r\n\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Yong Zhang <zhangyong1025.zy@gmail.com>, Andrey Yegorov <None>\n\nThis closes #3228 from hangc0276/chenhang/add_get_under_replicate_ledger_count","Date":"Tue Apr 26 08:17:37 CEST 2022"},{"Commit-ID":"commit d9b98ad8ccec6a9ba65cfc00ef319ee51454c0c4 1651008712 -----sp","Author":"PersonIdent[Andrey Yegorov, andrey.yegorov@datastax.com, Tue Apr 26 14:31:52 2022 -0700]","Body":"[maven-release-plugin] prepare branch branch-4.15\n","Date":"Tue Apr 26 23:31:52 CEST 2022"},{"Commit-ID":"commit e5d5ddac8a10acca031eed0221d925d54713a6ab 1651008715 -----sp","Author":"PersonIdent[Andrey Yegorov, andrey.yegorov@datastax.com, Tue Apr 26 14:31:55 2022 -0700]","Body":"[maven-release-plugin] prepare for next development iteration\n","Date":"Tue Apr 26 23:31:55 CEST 2022"},{"Commit-ID":"commit 091670ab2acbc202741163b39866e70a530c418e 1651009668 -----sp","Author":"PersonIdent[Andrey Yegorov, andrey.yegorov@datastax.com, Tue Apr 26 14:47:48 2022 -0700]","Body":"Revert \"[maven-release-plugin] prepare for next development iteration\"\n\nThis reverts commit e5d5ddac8a10acca031eed0221d925d54713a6ab.\n","Date":"Tue Apr 26 23:47:48 CEST 2022"},{"Commit-ID":"commit c63a9fa76c01196b32cb41f877255d0fb5e00a78 1651009678 -----sp","Author":"PersonIdent[Andrey Yegorov, andrey.yegorov@datastax.com, Tue Apr 26 14:47:58 2022 -0700]","Body":"Revert \"[maven-release-plugin] prepare branch branch-4.15\"\n\nThis reverts commit d9b98ad8ccec6a9ba65cfc00ef319ee51454c0c4.\n","Date":"Tue Apr 26 23:47:58 CEST 2022"},{"Commit-ID":"commit d32f5ef939350b21afbadf8335431d9b886f5681 1651009731 -----sp","Author":"PersonIdent[Andrey Yegorov, andrey.yegorov@datastax.com, Tue Apr 26 14:48:51 2022 -0700]","Body":"[maven-release-plugin] prepare branch branch-4.15\n","Date":"Tue Apr 26 23:48:51 CEST 2022"},{"Commit-ID":"commit db0acf803a87ad067806489251990df992d6a2a3 1651009733 -----sp","Author":"PersonIdent[Andrey Yegorov, andrey.yegorov@datastax.com, Tue Apr 26 14:48:53 2022 -0700]","Body":"[maven-release-plugin] prepare for next development iteration\n","Date":"Tue Apr 26 23:48:53 CEST 2022"},{"Commit-ID":"commit 4175088c8f71b5f167e95a2f495377d7a0804eab 1651043375 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Wed Apr 27 15:09:35 2022 +0800]","Body":"fix some jdk17 test problem (#3242)\n\n","Date":"Wed Apr 27 09:09:35 CEST 2022"},{"Commit-ID":"commit 80ca1f834c9ec5054b6d8757d98126759b9292b4 1651186853 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Fri Apr 29 07:00:53 2022 +0800]","Body":"Move bookkeeper-stats and bookkeeper-stats-providers as submodules of stats\n\n### Motiviations\r\nFix todo to make the project layout more reasonable and easier to fix bug/dev new feature\r\n### Changes\r\nmove `bookkeeper-stats` and `bookkeeper-stats-providers` as submodules of `stats`\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Nicolò Boschi <boschi1997@gmail.com>, Andrey Yegorov <None>\n\nThis closes #3246 from Shoothzj/module-04-25","Date":"Fri Apr 29 01:00:53 CEST 2022"},{"Commit-ID":"commit 6f85e6d5fa735dfea035ba4761c6669fbf5c6880 1651211054 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Fri Apr 29 13:44:14 2022 +0800]","Body":"BP-47 (task3): Abstract interface for entrylogger (#3197)\n\n* Interface for entrylogger\r\n\r\nDefine the interface and contract for entrylogger. This is mostly\r\ntaking the entrylogger methods used by other components and prettying\r\nthem up a bit.\r\n\r\nNotable changes are:\r\n- internalReadEntry is now readEntry. There is no 'validate'\r\n  flag. Instead there are two overloads for the method, and validation\r\n  only runs if ledgerId and entryId are passed in.\r\n- shutdown has been renamed to close.\r\n- the compaction entrylog methods have been put behind an\r\n  interface. As it was they were leaking implementation\r\n  details. Ultimitely compaction itself should be hidden behind the\r\n  entrylogger, but that's a larger refactor.\r\n\r\n(cherry picked from commit c927f4b0128e2b1f0f4b30c41ce442b366d5009c)\r\n\r\n* abstract interface for entrylogger\r\n\r\n* format code\r\n\r\n* format code\r\n\r\n* address comments\r\n\r\n* Apply suggestions from code review\r\n\r\nCo-authored-by: Andrey Yegorov <8622884+dlg99@users.noreply.github.com>\r\n\r\n* address comments\r\n\r\n* format code\r\n\r\nCo-authored-by: Ivan Kelly <ikelly@splunk.com>\r\nCo-authored-by: Andrey Yegorov <8622884+dlg99@users.noreply.github.com>","Date":"Fri Apr 29 07:44:14 CEST 2022"},{"Commit-ID":"commit 2a75296de96c08870b316b5ece639492b1f968a1 1651248642 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Fri Apr 29 09:10:42 2022 -0700]","Body":"Fix: shell tests are broken and not running on CI (#3251)\n\n","Date":"Fri Apr 29 18:10:42 CEST 2022"},{"Commit-ID":"commit 8c661dfd6b118d278222469eb5426ebd7728bdd2 1651645103 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Wed May 4 14:18:23 2022 +0800]","Body":"BP-47 (task4): Aligned native buffer wrapper (#3253)\n\n","Date":"Wed May 04 08:18:23 CEST 2022"},{"Commit-ID":"commit e79da7c218bb3cc0b2018b3d4057eec1770f6acd 1651670411 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Wed May 4 21:20:11 2022 +0800]","Body":"Allow run LocalBookkeeper directly in `bookkeeper-server` module or on IDE (#3255)\n\n","Date":"Wed May 04 15:20:11 CEST 2022"},{"Commit-ID":"commit 90d55017da68111ffc578b611de998269f701f82 1651710403 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Thu May 5 08:26:43 2022 +0800]","Body":"[minor] [optimize] Remove redundant toString call (#3254)\n\n","Date":"Thu May 05 02:26:43 CEST 2022"},{"Commit-ID":"commit b5a483acc0c0669efc97eedd0c2791adbbc4f41c 1651732151 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Thu May 5 14:29:11 2022 +0800]","Body":"BP-47 (task5): Garbage collection support direct IO entrylogger (#3256)\n\n* Garbage Collection support for DirectIO entrylogger\r\n\r\nGC support requires that the entrylogger provides a way to retrieve\r\nall entrylogs which have been completely flushed to disk. Previously\r\nthis was done by returning the least unflushed log id. However, this\r\nis problematic as it doesn't support the log ids wrapping around. It\r\nalso means that GC has to start checking for log id existence from\r\nzero every time it boots.\r\n\r\nThis change replaces getLeastUnflushedLogId() with getFlushedLogIds(),\r\nto give the entrylogger full control of which logs should be\r\nconsidered for GC.\r\n\r\nIt also changes the CompactableLedgerStorage interface, removing\r\ngetEntryLogger() and adding injection of the entrylogger to the\r\nGarbageCollectionThread. This makes testing easier.\r\n\r\nCo-authored-by: Ivan Kelly <ikelly@splunk.com>","Date":"Thu May 05 08:29:11 CEST 2022"},{"Commit-ID":"commit 29d78af68ad6eb410068dadb766a1ef538856877 1651925498 -----sp","Author":"PersonIdent[Tian Luo, futurer@outlook.com, Sat May 7 20:11:38 2022 +0800]","Body":"Fix spelling mistake in bk_server.conf (#3262)\n\n### Motivation\r\n\r\nFix spelling mistake in bk_server.conf\r\n\r\n### Changes\r\n\r\nMaster Issue: #3261","Date":"Sat May 07 14:11:38 CEST 2022"},{"Commit-ID":"commit dcf1168b6061bd2689aafe60fa96ec9680c86a4d 1652122318 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Mon May 9 11:51:58 2022 -0700]","Body":"Release notes for BK 4.15\n\nDescriptions of the changes in this PR:\r\n### Motivation\r\n\r\nrelease notes for BK release 4.15\r\n\r\n### Changes\r\n\r\nDoc updates per release procedure.\n\nReviewers: Enrico Olivelli <eolivelli@gmail.com>, Yong Zhang <zhangyong1025.zy@gmail.com>, Hang Chen <chenhang@apache.org>, Nicolò Boschi <boschi1997@gmail.com>\n\nThis closes #3155 from dlg99/bk-4.15-release-notes","Date":"Mon May 09 20:51:58 CEST 2022"},{"Commit-ID":"commit e0bcc356918056c00783193ccbd90f577b22a549 1652165916 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Tue May 10 08:58:36 2022 +0200]","Body":"[website] Set 4.15.0 as latest release (#3265)\n\n","Date":"Tue May 10 08:58:36 CEST 2022"},{"Commit-ID":"commit ff3607587a000507ad21e024ed58e51206290684 1652210013 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Tue May 10 12:13:33 2022 -0700]","Body":"cleaning up leftover 4.15-snapshot versions (#3267)\n\n* cleaning up leftover 4.15-snapshot versions\r\n\r\n* updated news page","Date":"Tue May 10 21:13:33 CEST 2022"},{"Commit-ID":"commit 873602965d684f8531919c91d8ed38c5cee2408a 1652269112 -----sp","Author":"PersonIdent[赤月, 974226358@qq.com, Wed May 11 19:38:32 2022 +0800]","Body":"Fix link Apache Pulsar#persistent-storage  (#3271)\n\n","Date":"Wed May 11 13:38:32 CEST 2022"},{"Commit-ID":"commit 78662ac16513406f49e142d5b6977d62c3baaafb 1652289464 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Wed May 11 19:17:44 2022 +0200]","Body":"Enable Netty and BookKeeper IO optimizations on jdk17 (#3234)\n\n* Enable netty optimization and BK native IO on jdk17\r\n\r\n* zip and better docs","Date":"Wed May 11 19:17:44 CEST 2022"},{"Commit-ID":"commit 300b8ba080c44c896251e551c268d8bb5b7ad3d4 1652313013 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Thu May 12 07:50:13 2022 +0800]","Body":"Bump prometheus client version to 0.15.0 (#3266)\n\n### Motivation\r\nprometheus client `0.8.1` is release on Jan,2020, Keep update\r\n\r\n### Changes\r\nBump prometheus client version from 0.8.1 to 0.15.0\r\n\r\n### Test\r\nUpdate prometheus client to 0.15.0, compare the metrics txt, the results are same.","Date":"Thu May 12 01:50:13 CEST 2022"},{"Commit-ID":"commit 74927db9ac8b1b90d5ad6e20bab8b7d2e065ebef 1652359708 -----sp","Author":"PersonIdent[赤月, 974226358@qq.com, Thu May 12 20:48:28 2022 +0800]","Body":"[website] fix hyperlink (#3276)\n\nCo-authored-by: zwen <zwen@didiglobal.com>","Date":"Thu May 12 14:48:28 CEST 2022"},{"Commit-ID":"commit 736759fb2266cdf9edbe21b2a93502c61e48bc39 1652428222 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Fri May 13 09:50:22 2022 +0200]","Body":"[website] Add script for cut new release (release-notes, new docs, sidebar..) (#3198)\n\n","Date":"Fri May 13 09:50:22 CEST 2022"},{"Commit-ID":"commit b4b3ca3b6b9638676564b7cdc1f7882695ec2017 1652429015 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Fri May 13 10:03:35 2022 +0200]","Body":"4.14.5 release notes and doc (#3199)\n\n","Date":"Fri May 13 10:03:35 CEST 2022"},{"Commit-ID":"commit 4b852808b74380169d4d4a9af779d180695c3d33 1652457787 -----sp","Author":"PersonIdent[AlvaroStream, 102966649+AlvaroStream@users.noreply.github.com, Fri May 13 18:03:07 2022 +0200]","Body":"Updated organization to Streamlio former members (#3280)\n\nUpdate the organization to former Streamlio members to StreamNative","Date":"Fri May 13 18:03:07 CEST 2022"},{"Commit-ID":"commit 82248121930a7a54431aae0c37ae7f96cb0d2d53 1652709384 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Mon May 16 15:56:24 2022 +0200]","Body":"[doc] Remove old site source code (#3281)\n\n","Date":"Mon May 16 15:56:24 CEST 2022"},{"Commit-ID":"commit 409c091dcb693f7b2e31a756373de25dfd0f4c52 1652972016 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Thu May 19 16:53:36 2022 +0200]","Body":"[doc] Remove DC/OS installation guide (#3278)\n\n* [doc] Remove DC/OS installation guide\r\n\r\n* remove from release guide","Date":"Thu May 19 16:53:36 CEST 2022"},{"Commit-ID":"commit 3f55fdf71b7dfe0fc959bccc81300fa7f57ca5c0 1652972061 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Thu May 19 16:54:21 2022 +0200]","Body":"[doc] Improve release guide (#3277)\n\n* Improve release guide\r\n\r\n* also fix website validation action","Date":"Thu May 19 16:54:21 CEST 2022"},{"Commit-ID":"commit 4bbdaf868b1570a99827f3018ace56e485ffea63 1652972134 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Thu May 19 22:55:34 2022 +0800]","Body":"Bump netty version to 4.1.77.Final (#3273)\n\n","Date":"Thu May 19 16:55:34 CEST 2022"},{"Commit-ID":"commit 43fc9c232253dd30d6d18f1235e3dc978b1fbe1a 1653483667 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Wed May 25 15:01:07 2022 +0200]","Body":"[website] Make download page fully ASF compliant (#3291)\n\n","Date":"Wed May 25 15:01:07 CEST 2022"},{"Commit-ID":"commit 6c83b4a9e2efbe420d193e2136e23fce65b25478 1653817582 -----sp","Author":"PersonIdent[Asaf Mesika, asaf.mesika@gmail.com, Sun May 29 12:46:22 2022 +0300]","Body":"Fixed build instruction to Maven since Gradle usage was reverted (#3296)\n\n### Motivation\r\n\r\nGetting started instructions for building the project were wrong since Gradle is not used anymore. I reverted to the old Maven one","Date":"Sun May 29 11:46:22 CEST 2022"},{"Commit-ID":"commit 42303a9f2581dc00534fdfdfdb7d51a8d179f3c1 1653891715 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Mon May 30 14:21:55 2022 +0800]","Body":"[build] misc bump several maven plugin version (#3294)\n\n### Motivation\r\nKeep plugin version update. I am trying to make bookkeeper can run on windows(more developers can join this project). I believe update some maven plugin versions can help a little.\r\n\r\n### Changes\r\n- bump jacoco maven plugin from 0.8.0 to 0.8.8\r\n- bump maven-clean-plugin from 2.5 to 3.2.0\r\n- bump maven-compiler version to 3.10.1\r\n- bump maven-jar-plugin from 2.4 to 3.2.2\r\n- bump nar-maven-plugin from 3.5.2 to 3.10.1\r\n- delete a unnecessary dependency, it's already defined in parent pom\r\n\r\n### ci failure\r\nboth `google-http-client-gson` and `maven-settings` are not related to this PR","Date":"Mon May 30 08:21:55 CEST 2022"},{"Commit-ID":"commit f1ff8b4a307e09594fc663625c50318dde5fd7e4 1653908618 -----sp","Author":"PersonIdent[magiccao, uestcdongcao@163.com, Mon May 30 19:03:38 2022 +0800]","Body":"[build] support circe-checksum and cpu-affinity build on Windows (#2549)\n\nCo-authored-by: dongcao <dongcao@trip.com>","Date":"Mon May 30 13:03:38 CEST 2022"},{"Commit-ID":"commit 3e224a2ac40b8cd7804c758a195e70a9b55cfdaa 1653954465 -----sp","Author":"PersonIdent[Vladislav Khakin, vkhakin@gmail.com, Tue May 31 02:47:45 2022 +0300]","Body":"Fix javadoc and build warnings (#3297)\n\nFix #472 #2155","Date":"Tue May 31 01:47:45 CEST 2022"},{"Commit-ID":"commit 77441e6f2602632b44b7d4a01c6d122cdc2a1ced 1653962781 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Tue May 31 10:06:21 2022 +0800]","Body":"[build] [windows] fix broken master code compile error strerror_s (#3300)\n\n### Motivation\r\nmaster compile is broken by #2549 \r\n\r\n### Changes\r\n\r\nAdd windows `#ifdef _WIN32` directive on `define`. Test on my m1 mac and windows 10.\r\n","Date":"Tue May 31 04:06:21 CEST 2022"},{"Commit-ID":"commit 8eb26dbeb0988d04136d63805eccd9d466d309b9 1654081754 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Wed Jun 1 19:09:14 2022 +0800]","Body":"[ci] [build] add macos build check (#3301)\n\n","Date":"Wed Jun 01 13:09:14 CEST 2022"},{"Commit-ID":"commit 1d93ff708318cdcb1b477f416cbebed19e220d1b 1654182322 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Thu Jun 2 23:05:22 2022 +0800]","Body":"[build] Support windows build (#3303)\n\n### Motivation\r\nSupport windows build to let more people easily contributed in this project. Test on my windows10 and windows11 PC.\r\nI think that Windows now can be used for development, but not for production.\r\n### Changes\r\n- add some win32 compat code\r\n- add windows build check\r\n### owasp ci failure\r\nboth `google-http-client-gson` and `maven-settings` are not related to this PR","Date":"Thu Jun 02 17:05:22 CEST 2022"},{"Commit-ID":"commit 5f1b00074437a632cd48d5709492a8aca6b4d540 1654233786 -----sp","Author":"PersonIdent[Fangbin Sun, sunfangbin@gmail.com, Fri Jun 3 13:23:06 2022 +0800]","Body":"Clean up javadoc mojos execution (#2906)\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nFixes #1514.\r\n\r\n### Changes\r\n\r\n1. Configuring maven-javadoc-plugin with `detectOfflineLinks=false` eliminates the Maven invocations (refer to: [https://issues.redhat.com/browse/ISPN-8629](https://issues.redhat.com/browse/ISPN-8629)).\r\n2. Use option `notimestamp` to replace `additionalparam` since the latter is not allowed from version `3.x`.","Date":"Fri Jun 03 07:23:06 CEST 2022"},{"Commit-ID":"commit 6b22f852d31c6e325e0ac5019a34c36acc271ed3 1654411175 -----sp","Author":"PersonIdent[Michael Marshall, mmarshall@apache.org, Sun Jun 5 01:39:35 2022 -0500]","Body":"[Client] Switch to rely on Netty for Hostname Verification (#3310)\n\n### Motivation\r\n\r\nCurrently, we initiate hostname verification for the Bookkeeper Client in the `PerChannelBookieClient` class. In order to simplify the code, I propose that we refactor the client so it relies on Netty, its SslHandler/SslEngine, and the JVM, to perform the hostname verification.\r\n\r\nWhen HTTPS is configured as the endpoint verification algorithm, it uses [RFC 2818](https://datatracker.ietf.org/doc/html/rfc2818) to perform hostname verification. This is defined by the Java Security Standard Algorithm Names documentation for JDK versions 8, 11, and 17. Here are the official docs:\r\n\r\n* https://docs.oracle.com/javase/8/docs/technotes/guides/security/StandardNames.html\r\n* https://docs.oracle.com/en/java/javase/11/docs/specs/security/standard-names.html\r\n* https://docs.oracle.com/en/java/javase/17/docs/specs/security/standard-names.html\r\n\r\n### Changes\r\n\r\n* Rely on Netty and the SslEngine to perform hostname verification. With this change, CN matching is now deprecated, which brings the bookkeeper client in alignment with RFC 2818.\r\n* Add new method to the `SecurityHandlerFactory` interface. It is named `newTLSHandler` and takes the `host` and `port` of the remote peer when creating a new SslEngine. To ensure backwards compatibility, the default implementation will call the original method. Note that the remote host and port are only needed when a client is using them for hostname verification.","Date":"Sun Jun 05 08:39:35 CEST 2022"},{"Commit-ID":"commit e21e208f4c43d1fc4f6c6f35153eb12753259d8b 1654414166 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sun Jun 5 15:29:26 2022 +0800]","Body":"Bump grpc from 1.45.1 to 1.47.0, solve dependency check FP (#3305)\n\n* Bump grpc from 1.45.1 to 1.47.0\r\n\r\n* add dependency check suppression","Date":"Sun Jun 05 09:29:26 CEST 2022"},{"Commit-ID":"commit d3229c5cdb73c53de86d6e4b5a44a9eea9a5852d 1654494107 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Mon Jun 6 13:41:47 2022 +0800]","Body":"Close journal channel in testJunkEndedJournal (#3307)\n\n","Date":"Mon Jun 06 07:41:47 CEST 2022"},{"Commit-ID":"commit 04d09c1de74c5f35a7cdd26be6e7f1c3dda9867a 1654499271 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Mon Jun 6 15:07:51 2022 +0800]","Body":"Bump apache version from 19 to 26 (#3315)\n\n","Date":"Mon Jun 06 09:07:51 CEST 2022"},{"Commit-ID":"commit 711b9d0b13db14bf198e655f84777d86b5fadb60 1654571674 -----sp","Author":"PersonIdent[Vladislav Khakin, vkhakin@gmail.com, Tue Jun 7 06:14:34 2022 +0300]","Body":"add missing link to paxos algorithm (#3298)\n\nFixes #3293","Date":"Tue Jun 07 05:14:34 CEST 2022"},{"Commit-ID":"commit b477f8d506ea493f211dfc96e40d647f5254d3ca 1654599234 -----sp","Author":"PersonIdent[Raúl Gracia, raul.gracia@emc.com, Tue Jun 7 12:53:54 2022 +0200]","Body":"Consider consider Bookie ID when validating the Cookie. (#3308)\n\nSigned-off-by: Raúl Gracia <raul.gracia@emc.com>","Date":"Tue Jun 07 12:53:54 CEST 2022"},{"Commit-ID":"commit 9f3a815902171467ad6ca863d186449049d78448 1654599242 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Tue Jun 7 18:54:02 2022 +0800]","Body":"Fix maven javadoc generate (#3317)\n\n### Motivation\r\nCurrently, the maven javadoc generate is broken both on master and branch-4.14\r\n\r\n### Changes\r\n- fix the javadoc generate, the gradle script has already use `delombok`\r\n- delete unneeded `package-info` file\r\n- delete unused dependency `spotbugs-annotations`, it's not worth to open other pr(IMO)","Date":"Tue Jun 07 12:54:02 CEST 2022"},{"Commit-ID":"commit 35f66a00513878a68c635153c55daedd774ac831 1654606313 -----sp","Author":"PersonIdent[TingTing Wang, 1922919664@qq.com, Tue Jun 7 20:51:53 2022 +0800]","Body":"Enable maven batch mode to reduce log in mac and windows workflow (#3318)\n\n","Date":"Tue Jun 07 14:51:53 CEST 2022"},{"Commit-ID":"commit 168e4c6bcbf5c54cb9f14b7a4ccdff2a5e485ee2 1654651610 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Jun 7 18:26:50 2022 -0700]","Body":"Try to use Java9 CRC32C when JNI based CRC is not available (#3309)\n\n* Try to use Java9 CRC32C when JNI based CRC is not available\r\n\r\n* Fixed shading test dependency\r\n\r\n* Fixed dlog shading deps","Date":"Wed Jun 08 03:26:50 CEST 2022"},{"Commit-ID":"commit 3d01e6e13cf5410e913859c5c92c002e986df518 1654682552 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Wed Jun 8 18:02:32 2022 +0800]","Body":"Fix the PendingAddOp is not recycled when LedgerHandler closed (#3321)\n\n---\r\n\r\n**Motivation**\r\n\r\nWhen adding an entry into a bookie, the entry data lifecycle\r\nis handled by the bookie client. The data buffer will be\r\nreleased after receiving a corresponding response from the\r\nbookie server. So the user doesn't care about the entry\r\nbuffer releasing.\r\nBut when the ledgerHandler is closed, the PendingAddOp is not\r\nrecycled which leads to the data buffer never being released.\r\nWe should release that after the callback executed.","Date":"Wed Jun 08 12:02:32 CEST 2022"},{"Commit-ID":"commit bd827978ca7c72ad74ba5efc014f59aea3e6706c 1654751287 -----sp","Author":"PersonIdent[Michael Marshall, mmarshall@apache.org, Thu Jun 9 00:08:07 2022 -0500]","Body":"[Client] Deduplicate error log for SSLException (#3320)\n\n### Motivation\r\n\r\nWhile testing #3310, I noticed that the `PerChannelBookieClient#exceptionCaught` logic contains redundant logs when the exception is an `SSLException`. This PR removes a redundant log from client.\r\n\r\nBased on reading through the rest of the method, this should be a trivial change with no other side effects. My one question is how closing a channel and closing the context differ. Technically, returning early skips the `ctx.close()`, which could change the behavior.\r\n\r\n### Changes\r\n\r\n* Return early to prevent a redundant log","Date":"Thu Jun 09 07:08:07 CEST 2022"},{"Commit-ID":"commit 19306e4cefd21a0b53c261f22f26beb14c62e7c5 1654853449 -----sp","Author":"PersonIdent[Raúl Gracia, raul.gracia@emc.com, Fri Jun 10 11:30:49 2022 +0200]","Body":"Add Pravega as a Bookkeeper use case. (#3328)\n\n","Date":"Fri Jun 10 11:30:49 CEST 2022"},{"Commit-ID":"commit f887f8d7a507800b71b4143a40b0e45902f5f170 1655105271 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Mon Jun 13 15:27:51 2022 +0800]","Body":" Fix the V2 AddRequest object leak issue (#3323)\n\n---\r\n\r\n**Motivation**\r\n\r\nIf the request is a V2 add request, we retained the data's\r\nreference when creating the AddRequest object. To avoid the\r\nobject leak, we need to release the reference if we met\r\nany errors before sending it.\r\n\r\n","Date":"Mon Jun 13 09:27:51 CEST 2022"},{"Commit-ID":"commit 62400bd959b781fafa9471915c0cc7133a89dee7 1655338639 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Thu Jun 16 08:17:19 2022 +0800]","Body":"Apply the backpressure changes on the V2 requests (#3324)\n\n---\r\n\r\n*Motivation*\r\n\r\nIf one bookie is slow (not down, just slow), the BK client\r\nwill the acks to the user that the entries are written after\r\nthe first 2 acks. In the meantime, it will keep waiting for\r\nthe 3rd bookie to respond. If the bookie responds within the\r\ntimeout, the entries can now be dropped from memory, otherwise\r\nthe write will timeout internally and it will get replayed\r\nto a new bookie.\r\n\r\nIn the V3 request, we have [server-side backpressure](https://github.com/apache/bookkeeper/pull/1410)\r\nto impact the client-side behaviors. We should apply the same\r\nchanges to the V2 request. That would help this [issue](https://github.com/apache/pulsar/issues/14861)\r\nto be resolved.\r\n\r\n*Modification*\r\n\r\n- Apply the change https://github.com/apache/bookkeeper/pull/1410 to V2 protocol\r\n\r\nDescriptions of the changes in this PR:","Date":"Thu Jun 16 02:17:19 CEST 2022"},{"Commit-ID":"commit 9de724203cf09a8e160d82781eb27b39cc8ccd22 1655367118 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Thu Jun 16 16:11:58 2022 +0800]","Body":"Remove gradle from workflow (#3314)\n\n* Remove gradle from workflow\r\n\r\n* add dep","Date":"Thu Jun 16 10:11:58 CEST 2022"},{"Commit-ID":"commit 708f890874e3327a4ad2d6262ba6841a3c52b72c 1655426368 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Fri Jun 17 08:39:28 2022 +0800]","Body":"Remove gradle build script (#3340)\n\n### Motivation\r\nRemove gradle build script\r\nSee \r\nhttps://lists.apache.org/thread/k3pdlpbvkzt061338fkxtppq3z70nk03\r\nhttps://lists.apache.org/thread/os28qm4t0kf74q2k3lzsmnnpr0lnm6zc\r\n### Changes\r\n- delete gradle build script\r\n- add `netty-buffer` dependency on module `distributedlog-core-shaded-test` to fix broken master tests.","Date":"Fri Jun 17 02:39:28 CEST 2022"},{"Commit-ID":"commit da4c40d5399521266970e7a0f659b8cf37456a82 1655650445 -----sp","Author":"PersonIdent[LeKe, 95280282+goflutterjava@users.noreply.github.com, Sun Jun 19 22:54:05 2022 +0800]","Body":"Remove unused value assign in BookKeeperTestClient (#3331)\n\n","Date":"Sun Jun 19 16:54:05 CEST 2022"},{"Commit-ID":"commit f765119494ccb75261adc47a435be02744848af2 1655663582 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Mon Jun 20 02:33:02 2022 +0800]","Body":"allow build on jdk17 (#3343)\n\n","Date":"Sun Jun 19 20:33:02 CEST 2022"},{"Commit-ID":"commit 65469ddff5d977f87c3b9ea1a793f09c02e515cb 1655707401 -----sp","Author":"PersonIdent[Max Xu, xuhuan@live.cn, Mon Jun 20 14:43:21 2022 +0800]","Body":"fix: broken link of code guide in README (#3347)\n\n","Date":"Mon Jun 20 08:43:21 CEST 2022"},{"Commit-ID":"commit 6e268800c5d5d8f6c250202feed68fb38964251e 1655708507 -----sp","Author":"PersonIdent[LinChen, 1572139390@qq.com, Mon Jun 20 15:01:47 2022 +0800]","Body":"reduce unnecessary checkpoints (#3341)\n\n","Date":"Mon Jun 20 09:01:47 CEST 2022"},{"Commit-ID":"commit eadbdd4b6bfeef9924a3ff2c59fc3718cf3dc06b 1655804678 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Tue Jun 21 02:44:38 2022 -0700]","Body":"Autorecovery to rereplicate empty ledgers (#3239)\n\n","Date":"Tue Jun 21 11:44:38 CEST 2022"},{"Commit-ID":"commit 8d4b9e2ce436977356f882ef39096e8281e56ebd 1655903380 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Wed Jun 22 21:09:40 2022 +0800]","Body":"upgrade groovy from 2.5.17 to 3.0.11 to fix CVE-2019-11358(7.5) (#3346)\n\n","Date":"Wed Jun 22 15:09:40 CEST 2022"},{"Commit-ID":"commit 677ccec3eb84f5be1b3556537871e14eb5e8359c 1655950755 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Thu Jun 23 10:19:15 2022 +0800]","Body":"BP-47 (task6): Direct I/O entrylogger support (#3263)\n\n* Direct I/O entry log support\r\n\r\nThe implementation uses JNI to do direct I/O to files via posix\r\nsyscalls. Fallocate is used if running on linux, otherwise this is\r\nskipped (at the cost of more filesystem operates during writing).\r\n\r\nThere are two calls to write, writeAt and writeDelimited. I expect\r\nwriteAt to be used for the entrylog headers, which entries will go\r\nthrough writeDelimited. In both cases, the calls may return before the\r\nsyscalls occur. #flush() needs to be called to ensure things are\r\nactually written.\r\n\r\nThe entry log format isn't much changed from what is used by the\r\nexisting entrylogger. The biggest difference is the padding. Direct\r\nI/O must write in aligned blocked. The size of the alignment varies by\r\nmachine configuration, but 4K is a safe bet on most. As it is unlikely\r\nthat entry data will land exactly on the alignment boundary, we need\r\nto add padding to writes. The existing entry logger has been changed\r\nto take this padding into account. When read as a signed int/long/byte\r\nthe padding will aways parse to a negative value, which distinguishes\r\nit from valid entry data (the entry size will always be positive) and\r\nalso from preallocated space (which is always 0).\r\n\r\nAnother difference in the format is that the header is now 4K rather\r\nthan 1K. Again, this is to allow aligned rights. No changes are\r\nnecessary to allow the existing entry logger to deal with the header\r\nchange, as we create a dummy entry in the extra header space that the\r\nexisting entry logger already knows to ignore.\r\n\r\nTo enable, set dbStorage_directIOEntryLogger=true in the configuration.\r\n\r\n(cherry picked from commit 09a1c81b6894d4398c5a59e54cc18784550badb5)\r\n\r\n* format code\r\n\r\n* format code\r\n\r\n* fix spotbugs check\r\n\r\n* fix jnilib not found\r\n\r\n* fix jnilib not found\r\n\r\n* address comments\r\n\r\n* fix so lib not found\r\n\r\n* address comments\r\n\r\n* format code\r\n\r\n* add compat test\r\n\r\n* add compat test\r\n\r\n* address comments\r\n\r\n* fix findbugs failed\r\n\r\n* format code\r\n\r\nCo-authored-by: Ivan Kelly <ikelly@splunk.com>","Date":"Thu Jun 23 04:19:15 CEST 2022"},{"Commit-ID":"commit 97dff2e4ebd9d088cf1fa30f1e23fa0e28753a5c 1656378139 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Tue Jun 28 09:02:19 2022 +0800]","Body":"Fix bookie CI test not run (#3367)\n\n### Motivation\r\nThe `bookie-tests` CI runs the following tests.\r\n```\r\n- name: Run bookie tests\r\n        run: mvn -B -nsu -pl bookkeeper-server test -Dtest=\"org.apache.bookkeeper.bookie.*Test\" -DfailIfNoTests=false -Dorg.slf4j.simpleLogger.defaultLogLevel=INFO\r\n```\r\n\r\nFor the `remaining-tests` CI runs the following tests.\r\n```bash\r\n- name: Run remaining tests\r\n        run: mvn -B -nsu -am -pl bookkeeper-server clean install test -Dtest=\"!org.apache.bookkeeper.client.**,!org.apache.bookkeeper.bookie.**,!org.apache.bookkeeper.replication.**,!org.apache.bookkeeper.tls.**\" -DfailIfNoTests=false -Dorg.slf4j.simpleLogger.defaultLogLevel=INFO\r\n```\r\n\r\nThe problem is that `bookie-tests` only run tests with the name `org.apache.bookkeeper.bookie.*Test`, however, the `remaining-tests` exclude tests with name `org.apache.bookkeeper.bookie.**`. It leads to a lot of tests in `org.apache.bookkeeper.bookie.*` package doesn't run at all in CI.\r\n\r\n### Modification\r\nTurn on `org.apache.bookkeeper.bookie.**` tests in `bookie-tests` CI. \r\n\r\nI have been testing on my laptop, there are many tests can't pass, I may need more time to make those failed tests to be passed.\r\n\r\nThe following tests need to fixed.\r\n- [x] org.apache.bookkeeper.bookie.storage.ldb.ConversionTest.test\r\n- [x] org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorageTest.testLimboStateThrowsInLimboWhenNoEntry\r\n- [x] org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorageTest.testLimboStateSucceedsWhenFenced\r\n- [x] org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorageTest.testLimboStateSucceedsWhenInLimboButHasEntry\r\n- [x] org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorageTest.testLimboStateThrowsInLimboWhenNotFenced\r\n- [x] org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorageTest.testStorageStateFlags","Date":"Tue Jun 28 03:02:19 CEST 2022"},{"Commit-ID":"commit 27b6cb9c9601cfd0ce3f498b2f107aadad231e9e 1656415386 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Tue Jun 28 19:23:06 2022 +0800]","Body":"Basic function: directories to store index files (#3352)\n\nCo-authored-by: lushiji <lushiji@didiglobal.com>","Date":"Tue Jun 28 13:23:06 CEST 2022"},{"Commit-ID":"commit 4976960b557fec2841ce1785e8cafa3b1e0d4e09 1656439119 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Wed Jun 29 01:58:39 2022 +0800]","Body":"convert testcase to junit 4 (#3371)\n\n* Basic function: directories to store index files\r\n\r\n* add test case for indexDirs fix\r\n\r\n* checkstyle fixed\r\n\r\n* use junit 5 api to run testcase\r\n\r\n* convert this testcase to junit 4\r\n\r\nCo-authored-by: lushiji <lushiji@didiglobal.com>","Date":"Tue Jun 28 19:58:39 CEST 2022"},{"Commit-ID":"commit 4625fce39043d96561196eb1108e64e472905194 1656568943 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Thu Jun 30 14:02:23 2022 +0800]","Body":"Fix a typo in bk_server.conf (#3370)\n\n","Date":"Thu Jun 30 08:02:23 CEST 2022"},{"Commit-ID":"commit 649d2bbd473283b21db5f714ba05b5747e07cc40 1656602393 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Thu Jun 30 23:19:53 2022 +0800]","Body":"use estimateMaxDirectMemory instead of maxDirectMemory (#3375)\n\n### Motivation\r\nhttps://github.com/apache/bookkeeper/pull/2989\r\n\r\n### Modification\r\nUse estimateMaxDirectMemory instead of maxDirectMemory ","Date":"Thu Jun 30 17:19:53 CEST 2022"},{"Commit-ID":"commit dc0918288f3c4a708ba8bb12b13ba94843570cf7 1656656026 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Fri Jul 1 14:13:46 2022 +0800]","Body":"add and check indexDirs in Cookie meta (#3372)\n\nCo-authored-by: lushiji <lushiji@didiglobal.com>","Date":"Fri Jul 01 08:13:46 CEST 2022"},{"Commit-ID":"commit 6ae2221bad0a8b9ebbc1528984f120bb0ee3fc5e 1656741727 -----sp","Author":"PersonIdent[liuzhuang2017, 95120044+liuzhuang2017@users.noreply.github.com, Sat Jul 2 14:02:07 2022 +0800]","Body":"Fix the Intellij key nouns. (#3381)\n\n","Date":"Sat Jul 02 08:02:07 CEST 2022"},{"Commit-ID":"commit d4b3910ca69ef90a62bfc853b232049ff1f6df6f 1656948874 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Mon Jul 4 23:34:34 2022 +0800]","Body":"BP-47 (task7): DbLedgerStorage add direct entry logger support (#3366)\n\n","Date":"Mon Jul 04 17:34:34 CEST 2022"},{"Commit-ID":"commit 04efcca7ebbdf22395ac905e0f3a79f41ac3217e 1657069072 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Tue Jul 5 17:57:52 2022 -0700]","Body":"Fix: NPE in RackawareEnsemblePlacementPolicyImpl logged by AutoRecovery (#3350)\n\n### Motivation\r\n\r\nAR keeps on logging NPE during rereplication:\r\n\r\n```\r\n[ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Received exception while trying to get network location of bookie: ...\r\njava.lang.NullPointerException: null \r\n```\r\n\r\nThe NPE seems to be easily avoidable, no need to throw exception and log it just to ignore.\r\n\r\n### Changes\r\n\r\nAdded check for bookie being present in the knownBookies map before accessing it.\r\n","Date":"Wed Jul 06 02:57:52 CEST 2022"},{"Commit-ID":"commit 458ca64150b1f0b26e2696882c3e1f4de630f755 1657089038 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Wed Jul 6 14:30:38 2022 +0800]","Body":"stage 2.2: (#3380)\n\nif old bookeeper node want to upgrade this cookie\r\nadd a funtion in cookie_generate for update indexDirs\r\n\r\nCo-authored-by: lushiji <lushiji@didiglobal.com>","Date":"Wed Jul 06 08:30:38 CEST 2022"},{"Commit-ID":"commit 414772d714d4309aa3d29c958d57387fbf032c78 1657106304 -----sp","Author":"PersonIdent[Kirs, ACM_China@yeah.net, Wed Jul 6 19:18:24 2022 +0800]","Body":"Fix dead link and add CI check (#3269)\n\n* Fix dead link and add CI check\r\n\r\n* fix dead link\r\nexclude license checks for json files\r\n\r\n* Run CI when only md files have been modified\r\n\r\n* fix dead link\r\n\r\n* fix dead link\r\n\r\n* Ignore some link checks\r\n\r\n* Ignore some link checks\r\n\r\n* Ignore some link checks\r\n\r\n* Ignore some link checks\r\n\r\n* fix link checks\r\n\r\n* ignore some links check\r\n\r\n* ignore some links check\r\n\r\n* ignore some links check\r\n\r\n* fix dead link\r\n\r\n* fix dead link\r\n\r\n* fix dead link\r\n\r\n* ignore some link\r\n\r\n* fix deadlink\r\n\r\n* ignore some unknown link\r\n\r\n* ignore some unknown link\r\n\r\n* ignore some unknown link\r\n\r\n* ignore some unknown link\r\n\r\n* ignore some unknown link\r\n\r\n* ignore some unknown link\r\n\r\n* ignore some unknown link\r\n\r\n* ignore some unknown link\r\n\r\n* fix dead link\r\n\r\n* fix dead link\r\n\r\n* fix dead link\r\n\r\n* fix dead link\r\n\r\n* ignore some link\r\n\r\n* ignore some link\r\n\r\n* ignore some link\r\n\r\n* fix dead link\r\n\r\n* fix dead link\r\n\r\n* rename job name\r\n\r\n* fix config error\r\n\r\n* ignore daxue link","Date":"Wed Jul 06 13:18:24 CEST 2022"},{"Commit-ID":"commit f7732921e72021e2f42dff32b12796f290249a33 1657180320 -----sp","Author":"PersonIdent[LinChen, 1572139390@qq.com, Thu Jul 7 15:52:00 2022 +0800]","Body":"Metrics: add journalCbQueueLatency (#3364)\n\n","Date":"Thu Jul 07 09:52:00 CEST 2022"},{"Commit-ID":"commit 65ffc4df75433c0ce7db0862447ae5a18c54fbc1 1657238068 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Fri Jul 8 01:54:28 2022 +0200]","Body":"Remove gradle usage from Javadoc gen script (#3386)\n\n### Motivation\r\n\r\n`javadoc-gen.sh` still uses Gradle for master branch.\r\n\r\n### Changes\r\n\r\n- Remove gradle and always use maven\r\n\r\nFailure check: https://github.com/apache/bookkeeper/runs/7211295355?check_suite_focus=true","Date":"Fri Jul 08 01:54:28 CEST 2022"},{"Commit-ID":"commit 1fcf74c1dc18cfc96960ebf41170177f5a98e2d6 1657580318 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Tue Jul 12 06:58:38 2022 +0800]","Body":"stage 2.3 ~ 2.4: (#3397)\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nplanning for index dir: [mail talking](https://lists.apache.org/thread/r657jf55khl59bbqltj2s95107lbkr0w)\r\nstage 3~4 : \r\n1) disk monitor(DiskChecker/LedgerDirsMonitor) have checked indexDir,it's good; \r\n2) add indexDirs in statsLogger, and add indexDirs's Listener. \r\n\r\n### Changes\r\n\r\n1. add indexDirs in statsLogger, and add indexDirs's Listener. \r\n2. update index's testcase for SingleDirectoryDbLedgerStorage","Date":"Tue Jul 12 00:58:38 CEST 2022"},{"Commit-ID":"commit 5045cb7d417ad4565e62dd992d8ebfba2f043b38 1657584766 -----sp","Author":"PersonIdent[LinChen, 1572139390@qq.com, Tue Jul 12 08:12:46 2022 +0800]","Body":"clean code: remove unused JOURNAL_NUM_FORCE_WRITES (#3379)\n\n### Motivation\r\nclean code: remove unused JOURNAL_NUM_FORCE_WRITES","Date":"Tue Jul 12 02:12:46 CEST 2022"},{"Commit-ID":"commit e02f47f771176da34a6101c84e7354500673dbfa 1657612068 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Tue Jul 12 15:47:48 2022 +0800]","Body":"stage 6: bugfix indexDirs for LocationsIndexRebuildOp (#3399)\n\nCo-authored-by: lushiji <lushiji@didiglobal.com>","Date":"Tue Jul 12 09:47:48 CEST 2022"},{"Commit-ID":"commit c3706e9c2508ba9042afc0e3c19a92c30bc2b32d 1657637839 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Tue Jul 12 07:57:19 2022 -0700]","Body":"Shut down ReplicationWorker and Auditor on non-recoverable ZK error (#3374)\n\n","Date":"Tue Jul 12 16:57:19 CEST 2022"},{"Commit-ID":"commit 6e2952b07bbd2433dabd7c7e1424ecf3685061c5 1657680347 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Wed Jul 13 10:45:47 2022 +0800]","Body":"stage 5: bugfix indexDirs for readLedgerIndexEntries (#3398)\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nplanning for index dir: [mail talking](https://lists.apache.org/thread/r657jf55khl59bbqltj2s95107lbkr0w)\r\nstage 5 : \r\n1)  fix indexDirs for EntryLocationIndex's tool\r\n\r\n### Changes\r\n\r\n1.  bugfix indexDirs for EntryLocationIndex's tool\r\n2. add index's testcase for testReadLedgerIndexEntries\r\n3. bugfix findexDirs for TestBase","Date":"Wed Jul 13 04:45:47 CEST 2022"},{"Commit-ID":"commit 658433c26e50b2b2411dcfe04372005546bb95f3 1657680408 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Tue Jul 12 19:46:48 2022 -0700]","Body":"Upgrading JNA from 3.2.7 to 5.12.1 (#3400)\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nUpgrading JNA\r\n\r\n### Changes\r\n\r\nchanged dependency version\r\n\r\nMaster Issue: #3394 ","Date":"Wed Jul 13 04:46:48 CEST 2022"},{"Commit-ID":"commit 988b92d9d3364513dd3857b89a95f515b99d4e87 1657723047 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Wed Jul 13 22:37:27 2022 +0800]","Body":"Add static declaration for useFallocate in DirectWriter (#3388)\n\n### Motivation\r\n\r\nThe work of the `BP-47` has been very meaningful. I am reading and learning it.\r\n\r\nAs the title, `useFallocate` in `DirectWriter` has no practical meaning, because the judgment of SystemUtils.IS_OS_LINUX always happens.","Date":"Wed Jul 13 16:37:27 CEST 2022"},{"Commit-ID":"commit 07e79408240c564fe05e36eaee119bf89b26ce90 1657723153 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Wed Jul 13 22:39:13 2022 +0800]","Body":"Make BookieFileChannel interface public (#3396)\n\n### Motivation\r\nThe `BookieFileChannel` is package public, and can't be implemented out of the `org.apache.bookkeeper.bookie` package.\r\nWe should make it public\r\n\r\n### Modification\r\nMake `BookieFileChannel` and `DefaultFileChannel` public","Date":"Wed Jul 13 16:39:13 CEST 2022"},{"Commit-ID":"commit 207368b254b4588be6852c1c18740e8097be7066 1657779000 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Thu Jul 14 08:10:00 2022 +0200]","Body":"[security] Upgrade Jetty to 9.4.48.v20220622 to get rid of CVE-2022-2047 (#3404)\n\n","Date":"Thu Jul 14 08:10:00 CEST 2022"},{"Commit-ID":"commit 79808dccb084b057f3bb9dbc6ce300bf04443b13 1657810895 -----sp","Author":"PersonIdent[LinChen, 1572139390@qq.com, Thu Jul 14 23:01:35 2022 +0800]","Body":"add writeThreadQueuedLatency (#3363)\n\n### Motivation\r\nadd writeThreadQueueStats :  calculate the time the request stays in the write threadpool queue\r\n","Date":"Thu Jul 14 17:01:35 CEST 2022"},{"Commit-ID":"commit 8f36ebc6597aadd02d9da137b08d78d6e0d195a2 1657869417 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Fri Jul 15 15:16:57 2022 +0800]","Body":"stage 7: just add log for indexDirs (#3401)\n\nCo-authored-by: lushiji <lushiji@didiglobal.com>","Date":"Fri Jul 15 09:16:57 CEST 2022"},{"Commit-ID":"commit 93f202817582190ccb8b0d9af6241e6d621aeaa0 1657869431 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Fri Jul 15 15:17:11 2022 +0800]","Body":"stage 8: bugfix indexDirs for LedgersIndexCheckOp (#3402)\n\nCo-authored-by: lushiji <lushiji@didiglobal.com>","Date":"Fri Jul 15 09:17:11 CEST 2022"},{"Commit-ID":"commit f0a198e2b35d2c3b9451dd4e50373b274b42f0f8 1657869458 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Fri Jul 15 15:17:38 2022 +0800]","Body":"stage 9: bugfix indexDirs for LedgersIndexRebuildOp (#3403)\n\nCo-authored-by: lushiji <lushiji@didiglobal.com>","Date":"Fri Jul 15 09:17:38 CEST 2022"},{"Commit-ID":"commit ba22beeb0ac99d1932206f5d028228642e8436be 1657934614 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sat Jul 16 09:23:34 2022 +0800]","Body":"Rename bookkeeper metrics to specify OpenMetrics (#3406)\n\n### Motivation\r\nSee https://github.com/OpenObservability/OpenMetrics/blob/main/specification/OpenMetrics.md\r\nA COUNTER needs `metrics_name_total` or `metrics_name_created`\r\n\r\nThis PR contains metric name broken changes.\r\n\r\n### Modifications\r\nRename counter's `_count` to `_total`\r\n\r\n### metrics name broken changes\r\n- rename `FAILED_TO_RESOLVE_NETWORK_LOCATION_COUNTER` to `FAILED_TO_RESOLVE_NETWORK_LOCATION_TOTAL`\r\n- rename `ENSEMBLE_NOT_ADHERING_TO_PLACEMENT_POLICY_COUNT` to `ENSEMBLE_NOT_ADHERING_TO_PLACEMENT_POLICY_TOTAL`\r\n- rename `ACTIVE_ENTRY_LOG_COUNT` to `ACTIVE_ENTRY_LOG_TOTAL`\r\n- rename `MAJOR_COMPACTION_COUNT` to `MAJOR_COMPACTION_TOTAL`\r\n- rename `MINOR_COMPACTION_COUNT` to `MINOR_COMPACTION_TOTAL`\r\n- rename `ACTIVE_LEDGER_COUNT` to `ACTIVE_LEDGER_TOTAL`\r\n- rename `DELETED_LEDGER_COUNT` to `DELETED_LEDGER_TOTAL`\r\n- rename `JOURNAL_FORCE_WRITE_GROUPING_COUNT` to `JOURNAL_FORCE_WRITE_GROUPING_TOTAL`\r\n\r\n### Also see\r\n- https://github.com/apache/pulsar/pull/13785\r\n- https://github.com/apache/pulsar/pull/16591\r\n- https://github.com/apache/pulsar/pull/16610\r\n- https://github.com/apache/pulsar/pull/16611","Date":"Sat Jul 16 03:23:34 CEST 2022"},{"Commit-ID":"commit fcb714999c516b71ba680693b3d95f284023e59d 1658132545 -----sp","Author":"PersonIdent[weiping-code, 54316849+weiping-code@users.noreply.github.com, Mon Jul 18 16:22:25 2022 +0800]","Body":"Fix JVM exited when running localbookie with jdk17 (#3334)\n\nCo-authored-by: ZhangJian He <shoothzj@gmail.com>","Date":"Mon Jul 18 10:22:25 CEST 2022"},{"Commit-ID":"commit c687524cae97ad9266391ee59c45e61572f39da3 1658214674 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Tue Jul 19 15:11:14 2022 +0800]","Body":"stage 10: bugfix indexDirs for ConvertToInterleavedStorageCommand (#3409)\n\nCo-authored-by: lushiji <lushiji@didiglobal.com>","Date":"Tue Jul 19 09:11:14 CEST 2022"},{"Commit-ID":"commit 6b03b012f731536af56cc63ba29511f09994d11b 1658267936 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Tue Jul 19 23:58:56 2022 +0200]","Body":"[website] Remove alert for non mantained releases (#3411)\n\n","Date":"Tue Jul 19 23:58:56 CEST 2022"},{"Commit-ID":"commit 0b910db875e6c5f821e69c41330aa3e2686ae224 1658396130 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Thu Jul 21 02:35:30 2022 -0700]","Body":"Issue 3206: Flaky-test: BookieZKExpireTest.testBookieServerZKExpireBehaviour (#3415)\n\n* Issue 3206: Flaky-test: BookieZKExpireTest.testBookieServerZKExpireBehaviour\r\n\r\n* clear property at the end of the test","Date":"Thu Jul 21 11:35:30 CEST 2022"},{"Commit-ID":"commit 92cdf5bfd262be7e1d2e2eef17610e37fcc7a44b 1658508656 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Fri Jul 22 09:50:56 2022 -0700]","Body":"Switch back ordered executor to LinkedBlockingQueue (#3384)\n\n","Date":"Fri Jul 22 18:50:56 CEST 2022"},{"Commit-ID":"commit 34746858b47e3962914f646803e930afe77859a3 1658509182 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Sat Jul 23 00:59:42 2022 +0800]","Body":"Added flag to control whether to transition to read-only mode when any disks full (#3212)\n\n* Added flag to control whether to transition to read-only mode when any disk is full\r\n\r\n* add unit test\r\n\r\n* address comments\r\n\r\n* add docs and config in conf/bk_server.conf","Date":"Fri Jul 22 18:59:42 CEST 2022"},{"Commit-ID":"commit 93a6f670296ebe5e86af22bfb632eeb50825c5e7 1658509300 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Sat Jul 23 01:01:40 2022 +0800]","Body":"use LinkedList to take place of ArrayList. (#3330)\n\n","Date":"Fri Jul 22 19:01:40 CEST 2022"},{"Commit-ID":"commit 1825677b1ebacef113423b4afc463a0dcdc8988e 1658533861 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Fri Jul 22 16:51:01 2022 -0700]","Body":"[Issue 3389] Prioritize compaction of entry logs with the lowest amount of remaining usable data (#3390)\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n### Motivation\r\n\r\nPrioritize compaction to free up more space faster.\r\n\r\n### Changes\r\n\r\ndoCompactEntryLogs() iterates over entry logs in whatever natural order they happen to be, picks the first with usage below thresholds and starts compacting.\r\n\r\nAdded a Priority Queue of entry logs to pick ones with the most compactable space first; it also helps when the time for compaction is limited (via majorCompactionMaxTimeMillis / minorCompactionMaxTimeMillis), instead of spending time on rewriting files with more data we'll pick the files with the least amount of data first.\r\n\r\nMaster Issue: #3389 \r\n\r\n","Date":"Sat Jul 23 01:51:01 CEST 2022"},{"Commit-ID":"commit 590de2b0e2f39466f5c466356b8106ed736dc303 1658798246 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Tue Jul 26 09:17:26 2022 +0800]","Body":"If ensembleList is empty, return PlacementPolicyAdherence.FAIL. (#3369)\n\nDescriptions of the changes in this PR:\r\nIf the ensembleList is empty, should not return PlacementPolicyAdherence.MEETS_STRICT.\r\nReturn PlacementPolicyAdherence.FAIL to remind user.\r\n\r\n","Date":"Tue Jul 26 03:17:26 CEST 2022"},{"Commit-ID":"commit 03255bbd391e8298e358c25304f7630d5ea36f74 1658799515 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Tue Jul 26 09:38:35 2022 +0800]","Body":"enhance future sync wait. (#3336)\n\nDescriptions of the changes in this PR:\r\n\r\nEnhance future sync wait. \r\nThe same logicment:\r\nhttps://github.com/apache/bookkeeper/blob/f887f8d7a507800b71b4143a40b0e45902f5f170/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/SyncCallbackUtils.java#L45-L71\r\n","Date":"Tue Jul 26 03:38:35 CEST 2022"},{"Commit-ID":"commit 1908b7ecdbe4aea0dabdb91009d9635a4d14c533 1658806467 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Tue Jul 26 11:34:27 2022 +0800]","Body":"Stable testBookieContinueWritingIfMultipleLedgersPresent test (#3421)\n\n### Motivation\r\n\r\nFixes issue #2665 \r\n\r\nWhen the disk is full, `InterleavedLedgerStorage` creates a new entryLog and index file, copies and moves the old index (newFile) `FileInfo` to the new directory, and finally deletes the old index file.\r\n\r\nThe old file of `FileInfo` was `deleted`, but it was copied and moved a newFile to the new directory. Therefore, the delete status flag should be restored. If it is not set to false,`checkOpen` will throw `FileInfoDeletedException` when judging the fence status of `ledgerHandle` when adding an entry, causing the writing to fail. When the client changes the `ensemble`, it throws an exception because the test has only two bookie nodes and cannot satisfy the two writeSet: `Not enough non-faulty bookies available`.\r\n```java\r\n    public synchronized boolean isFenced() throws IOException {\r\n        checkOpen(false);\r\n        return (stateBits & STATE_FENCED_BIT) == STATE_FENCED_BIT;\r\n    }\r\n\r\n    private synchronized void checkOpen(boolean create, boolean openBeforeClose)\r\n            throws IOException {\r\n        if (deleted) {\r\n            throw new FileInfoDeletedException();\r\n        }\r\n      .....\r\n    }\r\n``` \r\n\r\n### Changes\r\nWhen `FileInfo` moves to a new directory by `moveToNewLocation`,delete the old index file and restore the `delete` flag, because the new index file is ready.\r\n\r\n\r\nSet the disk check interval to the `Integer.MAX_VALUE`, which is stable \r\n`assertEquals(\"writable dirs should have one dir\", 1, ledgerDirsManager\r\n                .getWritableLedgerDirs().size());`\r\nBecause once the test thrashes, the disk check thread will restore the full disk to a writable state.\r\n```java\r\nnewConf.setDiskCheckInterval(Integer.MAX_VALUE);\r\n```\r\n\r\n","Date":"Tue Jul 26 05:34:27 CEST 2022"},{"Commit-ID":"commit ded05aa2218f1e98c650070e9d0152213c4d09fe 1658813314 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Tue Jul 26 13:28:34 2022 +0800]","Body":"fix underReplicatedLedgerTotalSize calculate problem. (#3337)\n\nDescriptions of the changes in this PR:\r\n```\r\n  LongAdder underReplicatedSize = new LongAdder();\r\n        FutureUtils.processList(\r\n                Lists.newArrayList(ledgers),\r\n                ledgerId ->\r\n                    ledgerManager.readLedgerMetadata(ledgerId).whenComplete((metadata, exception) -> {\r\n                        if (exception == null) {\r\n                            underReplicatedSize.add(metadata.getValue().getLength());\r\n                        }\r\n                    }), null);\r\n        underReplicatedLedgerTotalSize.registerSuccessfulValue(underReplicatedSize.longValue());\r\n```\r\n`FutureUtils.processList`  is async process, should record `underReplicatedLedgerTotalSize` when it completed.","Date":"Tue Jul 26 07:28:34 CEST 2022"},{"Commit-ID":"commit cb70194be62ba8110a9dba316f53b9760b6a8fc0 1658827096 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Tue Jul 26 17:18:16 2022 +0800]","Body":"avoid init WriteSet when waitForWriteSetMs < 0. (#3325)\n\n### Motivation\r\nAvoid init WriteSet when waitForWriteSetMs < 0.\r\nAnd LedgerHandleAdv didn't recycle WriteSet.","Date":"Tue Jul 26 11:18:16 CEST 2022"},{"Commit-ID":"commit f181325b9fff32d1b26af4b049a5c343081c97a5 1658827458 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Tue Jul 26 17:24:18 2022 +0800]","Body":"validate diskUsageThreshold and diskUsageLwmThreshold (#3285)\n\n### Motivation\r\n\r\nWhen `diskUsageThreshold < diskUsageLwmThreshold`, the bookie can be started normally. When the disk usage reaches `diskUsageThreshold` , bookie will automatically switch to `ReadOnly` mode. The `LedgerDirsMonitor` then switches the bookie back to  `read-write` mode since the disk usage is less than `diskUsageLwmThreshold`, the bookie will switch state back and forth frequently.\r\n\r\n### Changes\r\nWhen creating `LedgerDirsMonitor`, we need to validate `diskUsageThreshold` and `diskUsageLwmThreshold` first.\r\n","Date":"Tue Jul 26 11:24:18 CEST 2022"},{"Commit-ID":"commit da1b29a510fa924f612d22f36b3c73d61d7953d2 1658827960 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Tue Jul 26 17:32:40 2022 +0800]","Body":"Fix autoRecover memory leak. (#3361)\n\n","Date":"Tue Jul 26 11:32:40 CEST 2022"},{"Commit-ID":"commit de70f4fa6b6f3d66a5c92453b370712925db43b6 1658828041 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Jul 26 02:34:01 2022 -0700]","Body":"Consolidate Netty channel flushes to mitigate syscall overhead (#3383)\n\n","Date":"Tue Jul 26 11:34:01 CEST 2022"},{"Commit-ID":"commit a5805476cdd0bfb27aa162515989620ee64d694c 1658839190 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Tue Jul 26 20:39:50 2022 +0800]","Body":"Optimize concurrent collection's shrink logic (#3417)\n\n### Motivation\r\n\r\nOptimize concurrent collection's shrink and clear logic\r\n\r\n### Changes\r\n1. Reduce the repeated `Arrays.fill` in the clear process\r\n2. When `capacity` is already equal to `initCapacity`,`rehash` should not be executed\r\n3. Reduce the `rehash` logic in the `clear` process\r\n4. Shrinking must at least ensure `initCapacity`, so as to avoid frequent shrinking and expansion near `initCapacity`, frequent shrinking and expansion, additionally opened `arrays` will consume more memory and affect GC.\r\n\r\nIf this PR is accepted, I will optimize the same `concurrent collection's shrink and clear logic ` defined in pulsar.\r\n\r\nRelated to #3061 and #3074 \r\n","Date":"Tue Jul 26 14:39:50 CEST 2022"},{"Commit-ID":"commit 3e22cfb25777c9eed5bd151442c729432650b213 1658842707 -----sp","Author":"PersonIdent[萧易客, kmter@live.com, Tue Jul 26 21:38:27 2022 +0800]","Body":"Remove useless and duplicated ledger directory usage metric (#3156)\n\n### Motivation\r\n\r\nThe disk usage metric and the number of writable directories about ledger directories is duplicated cause `LedgerDirsManager` was created with same ledgerDir more than once, here it is:\r\n1. with `bookie_ledger` scope\r\nhttps://github.com/apache/bookkeeper/blob/38dc3281f5f175a7d194d4c0d4b255472886187b/bookkeeper-server/src/main/java/org/apache/bookkeeper/server/Main.java#L365-L366\r\n- `bookie_ledger_dir_<ledger directory>_usage`\r\n- `bookie_ledger_writable_dirs`\r\n\r\n2. with `bookie` score\r\nhttps://github.com/apache/bookkeeper/blob/38dc3281f5f175a7d194d4c0d4b255472886187b/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/DbLedgerStorage.java#L155\r\n- `bookie_dir_<ledger directory>_usage`\r\n- `bookie_writable_dirs`\r\n\r\nThe second one wasn't bind with a `DiskChecker`, so it's metric never changes.\r\n\r\n### Changes\r\n\r\nRemove second one, remove metrics below:\r\n- `bookie_dir_<ledger directory>_usage`\r\n- `bookie_writable_dirs`","Date":"Tue Jul 26 15:38:27 CEST 2022"},{"Commit-ID":"commit 39a9c281a6ab329ba1aa8fb232ce81c2ad6719cc 1658848927 -----sp","Author":"PersonIdent[xiaolong ran, xiaolongran@tencent.com, Tue Jul 26 23:22:07 2022 +0800]","Body":"Fix the 3141 revert issue (#3283)\n\nSigned-off-by: xiaolongran <xiaolongran@tencent.com>\r\n\r\n### Motivation\r\n\r\nIn #3144, we reverted the changes of #2686, but after the revert, the self-increment behavior of deletedEntries was also removed, resulting in deletedEntries No assignment, always 0.\r\n\r\nIn #2686\r\n\r\n<img width=\"1501\" alt=\"image\" src=\"https://user-images.githubusercontent.com/20965307/169231903-1a0bee03-f602-4c61-9c98-6b832f75648f.png\">\r\n\r\nIn #3144 \r\n\r\n<img width=\"1352\" alt=\"image\" src=\"https://user-images.githubusercontent.com/20965307/169232028-658a1182-d8c5-4cfa-8f39-2ed7416ee508.png\">\r\n\r\n\r\n### Changes\r\n\r\n- Add `++deletedEntries` for removeOffsetFromDeletedLedgers.\r\n","Date":"Tue Jul 26 17:22:07 CEST 2022"},{"Commit-ID":"commit 82e87f24a8c173ba31419d544becaea19bdf2466 1658905432 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Wed Jul 27 15:03:52 2022 +0800]","Body":"Fix typo in bookkeeper-proposals.md (#3427)\n\n","Date":"Wed Jul 27 09:03:52 CEST 2022"},{"Commit-ID":"commit 505ee5fcd43b32f947dd716b3bf96e7da0140617 1658919861 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Wed Jul 27 19:04:21 2022 +0800]","Body":"BP-50: Add reuse journal file feature to support Intel PMem disk (#3194)\n\n### Motivation\r\nThe implementation of #3193 \r\n","Date":"Wed Jul 27 13:04:21 CEST 2022"},{"Commit-ID":"commit ca7d7c23e3aa572befeb447157b3ef9d96bb1449 1658920147 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Wed Jul 27 19:09:07 2022 +0800]","Body":"Pre break loop when self create layoutZNode succeed. (#3335)\n\nPre break loop when self create layoutZNode succeed.","Date":"Wed Jul 27 13:09:07 CEST 2022"},{"Commit-ID":"commit e345321cef263c078cd48ee3a23043f3f4e80833 1658937130 -----sp","Author":"PersonIdent[lixinyang, 84127069+Nicklee007@users.noreply.github.com, Wed Jul 27 23:52:10 2022 +0800]","Body":"[improve][client] release the bookie from QuarantinedBookies when health check is disabled (#3349)\n\n### Motivation\r\nwe need release all quarantined bookies when we use the dynamic config to disable the health check. In some case, we disable the health check when the client has add all bookies to `quarantinedBookies`, then we want to recovery all client's read/write capability immediately.\r\nBut now we need wait `BOOKIE_QUARANTINE_TIME_SECONDS` reached or we need restart all client, it's too slowly to recovery the client read/write for us.\r\n\r\n### Changes\r\nRelease all `QuarantinedBookies`,  after we dynamic disable the  health check.\r\n","Date":"Wed Jul 27 17:52:10 CEST 2022"},{"Commit-ID":"commit 01c882415714ecfcf11aaf77c86ae550bef6feb6 1658937468 -----sp","Author":"PersonIdent[ssj, sunshujie1990@gmail.com, Wed Jul 27 23:57:48 2022 +0800]","Body":"update ALLOCATOR_POOLING_CONCURRENCY default value (#3001)\n\nSet a more reasonable default value to avoid OutOfDirectMemoryError.\r\n\r\nDescriptions of the changes in this PR:\r\n\r\n\r\n### Motivation\r\nThe default value of  allocatorPoolingConcurrency is 2 * Runtime.getRuntime().availableProcessors(). It's used to specify the num of Arena in PooledByteBufAllocator. \r\n\r\nAssume:\r\n40 processors\r\n80 arena (processors*2)\r\n2 chunk per arena\r\n16MiB per chunk\r\nJVM's total direct mem should be larger then 80*2*16=2560MiB, otherwise OutOfDirectMemoryError occured.\r\n\r\nOutOfDirectMemoryError much more likely to occur in Docker, cause JDK versions earlier than Java SE 8U131 does not support Docker CPU limits.\r\n\r\n\r\n### Changes\r\nUse Netty default arena num `PooledByteBufAllocator.defaultNumDirectArena()` as default allocatorPoolingConcurrency.\r\n\r\n\r\n","Date":"Wed Jul 27 17:57:48 CEST 2022"},{"Commit-ID":"commit 333a11f28aa4be3e8b214cffe6d25da85dd33702 1658972015 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Thu Jul 28 09:33:35 2022 +0800]","Body":"fix check style (#3429)\n\n### Modification\r\nThe CI failed witch check style, fix it.\r\nhttps://github.com/apache/bookkeeper/runs/7544140069?check_suite_focus=true","Date":"Thu Jul 28 03:33:35 CEST 2022"},{"Commit-ID":"commit eef34477befc27e01f2e4531677236427ed859ef 1658974023 -----sp","Author":"PersonIdent[Kezhu Wang, kezhuw@gmail.com, Thu Jul 28 10:07:03 2022 +0800]","Body":"Fix wrong ledger id parse radix for index relocation file in IndexPersistenceMgr (#2944)\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n1. `IndexPersistenceMgr` fails to start after crashing index file movement.\r\n\r\n### Changes\r\n1. Add test to assert index file relocation\r\n2. Fix wrong ledger id parse radix for index relocation file in IndexPersistenceMgr\r\n\r\nMaster Issue: None\r\n","Date":"Thu Jul 28 04:07:03 CEST 2022"},{"Commit-ID":"commit 442e3bbad384fba9b09f8ea774e28562a8d5c6d7 1658979712 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Thu Jul 28 11:41:52 2022 +0800]","Body":"Fix the infinite waiting for shutdown due to throttler limit (#2942)\n\nDescriptions of the changes in this PR:\r\n### Motivation\r\n\r\nIf the compactor is limited, the shutdown priority should be higher than waiting for RateLimiter.acquire.\r\n\r\n### Changes\r\n\r\nAccording to @hangc0276 suggestion, when processing the shutdown logic of `GarbageCollectorThread`, we should check the status of the `newScanner.process` method. If the status is false, throw an `IOException` and stop compact immediately.\r\n\r\n\r\nMaster Issue: #2941 \r\n","Date":"Thu Jul 28 05:41:52 CEST 2022"},{"Commit-ID":"commit f71b26ac092427142b3d83cff596afaf38357cf5 1659058247 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Fri Jul 29 09:30:47 2022 +0800]","Body":"Bump puppycrawl checkstyle version from 6.19 to 7.8.2 (#3425)\n\n### Changes\r\nBump puppycrawl checkstyle version to 7.8.2. Fix violation","Date":"Fri Jul 29 03:30:47 CEST 2022"},{"Commit-ID":"commit 05ca058444e83a349d3a002b8d893817691f36b0 1659077808 -----sp","Author":"PersonIdent[Penghui Li, penghui@apache.org, Fri Jul 29 14:56:48 2022 +0800]","Body":"Make sure the LedgerHandle close callback can be completed when encounter exception (#2913)\n\n* Make sure the LedgerHandle close callback can be completed when encounter exception.","Date":"Fri Jul 29 08:56:48 CEST 2022"},{"Commit-ID":"commit 9be4eca585f4a34a37cff81b7d91f76fb52a3440 1659079379 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Fri Jul 29 15:22:59 2022 +0800]","Body":"fix Flaky-test: testBookieShouldTurnWritableFromReadOnly (#3423)\n\n### Motivation\r\nFixes issue #3422 \r\n\r\n1.`waitForReadOnlyBookie` adds another `listener` thread to observe the node status of bookie, which may be out of sync with the triggering of node changes(`onClusterChanged`) in `EnsemblePlacementPolicy`.This `sequence` leads to flaky test. \r\n\r\n2.Expose bookie nodes in EnsemblePlacementPolicy to client.\r\n\r\n3.Just change from watching zk to thread sleep.\r\n\r\nWe currently don't have any additional requirements for getting bookie nodes on the client side, so it's better to just use thread sleep here. \r\n\r\n### Changes\r\nChange from `waitForReadOnlyBookie` and `waitForWritableBookie` to thread `sleep`.\r\n3 seconds is enough for most.\r\n\r\n","Date":"Fri Jul 29 09:22:59 CEST 2022"},{"Commit-ID":"commit 35c71ab1626459fdac111a8164e359e871b732e4 1659079820 -----sp","Author":"PersonIdent[LinChen, 1572139390@qq.com, Fri Jul 29 15:30:20 2022 +0800]","Body":"add metric cbThreadPoolQueueSize (#3424)\n\n### Motivation\r\nAdd a new metric cbThreadPoolQueueSize to count the queue size in the thread pool cbThreadPool.","Date":"Fri Jul 29 09:30:20 CEST 2022"},{"Commit-ID":"commit cefe9d44dad3558cd4cc30547007c3c41b9bfbec 1659091107 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Fri Jul 29 18:38:27 2022 +0800]","Body":"[ISSUE 2637] Fix jvm_memory_direct_bytes_used metrics when using jdk11+ (#3252)\n\nFix #2637 #3247\r\n\r\n### Motivation\r\nThe mertics about `jvm_memory_direct_bytes_used` is acquired by netty's `PlatformDependent#DIRECT_MEMORY_COUNTER`. Which can only acquired the memory used by netty.\r\n\r\n### Changes\r\n- use `java.nio.Bits#RESERVED_MEMORY` for jvm direct memory metrics.\r\n- add tests to ensure `jvm_memory_direct_bytes_max` and `jvm_memory_direct_bytes_used` gets value.","Date":"Fri Jul 29 12:38:27 CEST 2022"},{"Commit-ID":"commit 6520a45724abcf8f4fe4566bc58b67f8aea659a0 1659096681 -----sp","Author":"PersonIdent[Penghui Li, penghui@apache.org, Fri Jul 29 20:11:21 2022 +0800]","Body":"[conf] minorCompactionInterval should be greater than gcWaitTime (#2116)\n\n","Date":"Fri Jul 29 14:11:21 CEST 2022"},{"Commit-ID":"commit 4ee8c0411878689417c39b7027899ed7ce815e7e 1659100373 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Fri Jul 29 21:12:53 2022 +0800]","Body":"Bump puppycrawl checkstyle version from 7.8.2 to 9.3 (#3311)\n\n### Changes\r\n- Bump puppycrawl checkstyle version from 6.19 to 10.3\r\n- adapt the `static import, SPACE LINE, import` order\r\n\r\n### why so many files are changed\r\nFormer checkstyle config is not strict, we have different importOrder styles in code. Most of it (2100+) is `static import, SPACE LINE, import`. Others(366) only needs to remove or add space line.","Date":"Fri Jul 29 15:12:53 CEST 2022"},{"Commit-ID":"commit 8c557f9f16bf150d2efd010b5f5939fe44aef740 1659195509 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Sat Jul 30 23:38:29 2022 +0800]","Body":"upgrade log4j2 to 2.18.0 (#3434)\n\n### Modification\r\nUpgrade log4j2 from 2.17.2 to 2.18.0","Date":"Sat Jul 30 17:38:29 CEST 2022"},{"Commit-ID":"commit 67208fb74181faa640e793cd5757712fd9b5d9d5 1659238245 -----sp","Author":"PersonIdent[AloysZhang, lofterzhang@gmail.com, Sun Jul 31 11:30:45 2022 +0800]","Body":"issue #2879 : let bookie quit if journal thread exit (#2887)\n\nDescriptions of the changes in this PR:\r\nfix #2879 \r\nThis pull request let bookie quit when there's journal thread exit\r\n\r\n### Motivation\r\n\r\nAs described in #2879, now if a bookie has multi journal directories means it has multi journal thread. Once a journal thread exits, the bookie will be unhealthy due to the block of all bookie-io threads, and then the bookie will not work but progress is still alive.\r\nThis pull request tries to fix this problem.\r\n\r\n### Changes\r\n\r\ncheck the journal thread alive in a fixed interval, let bookie quit once there's a journal thread exit\r\n\r\n","Date":"Sun Jul 31 05:30:45 CEST 2022"},{"Commit-ID":"commit f06800c02ea5045de21c115dee9c68a5a5759434 1659240441 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Sun Jul 31 12:07:21 2022 +0800]","Body":"indexDir compatible fix for issue #3430 (#3433)\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\nFixes https://github.com/apache/bookkeeper/issues/3430, make cookie validation is compatible with old version.\r\nI think we should check indexDirs when configuration\u2018s indexDirectories is setted  rather than avoiding the check \r\n\r\n### Changes\r\n1. add compatible check \r\n2. add testcase to cover the new code\r\n","Date":"Sun Jul 31 06:07:21 CEST 2022"},{"Commit-ID":"commit c31dff9ff8dc3ec7454a62d71a9fff2af8505ee9 1659251526 -----sp","Author":"PersonIdent[Masahiro Sakamoto, massakam@yahoo-corp.jp, Sun Jul 31 16:12:06 2022 +0900]","Body":"BP-41 Add flag to enable/disable BookieAddressResolver (#3356)\n\n### Motivation\r\n\r\nWith BP-41, the BookKeeper client now needs a request to ZooKeeper to resolve the address from each bookie ID.\r\n\r\nIn the following document, there is a description of the flag ~`enableBookieAddressResolver`~ `bookieAddressResolverEnabled` for disabling this feature by regarding the bookie ID as an address or hostname, but it seems that this has not been implemented yet.\r\nhttps://github.com/apache/bookkeeper/blob/master/site3/website/src/pages/bps/BP-41-bookieid.md\r\n\r\nI implemented this because I want this flag to reduce the number of requests to ZK.\r\n\r\n### Changes\r\n\r\nAdded a flag named ~`enableBookieAddressResolver`~ `bookieAddressResolverEnabled` to the client configuration. If this flag is false, use `BookieAddressResolverDisabled` instead of `DefaultBookieAddressResolver` as the address resolver for bookies. `BookieAddressResolverDisabled` regards a bookie ID to be in legacy format, i.e. \"address:port\" or \"hostname:port\", and returns the address of that bookie without access to ZK.\r\n\r\nMaster Issue: #2396","Date":"Sun Jul 31 09:12:06 CEST 2022"},{"Commit-ID":"commit 966b865973714c1bde596004bc4e5c1daa5a6d00 1659337895 -----sp","Author":"PersonIdent[Jack Vanlightly, vanlightly@gmail.com, Mon Aug 1 09:11:35 2022 +0200]","Body":"Issue #2908: Replace unsafe NoEntryException with IOException (#2909)\n\n* Replace unsafe NoEntryException with IOException\r\n\r\nThrowing a NoEntryException from the entry logger\r\nfor an entry that the index says should exist is\r\nunsafe. It can cause ledger truncation during ledger\r\nrecovery. It only takes a single false NoSuchEntry\r\nresponse to trigger truncation.\r\n\r\nNoEntryException should only be thrown from inside\r\nledger storage if the entry is not found in the index.\r\n\r\n* fix CI\r\n\r\nCo-authored-by: chenhang <chenhang@apache.org>","Date":"Mon Aug 01 09:11:35 CEST 2022"},{"Commit-ID":"commit 8e7dcb784c4f9bf118c50891268f75665f573bcd 1659362036 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Mon Aug 1 21:53:56 2022 +0800]","Body":"Bump version for release 4.16 (#3436)\n\n### Descriptions of the changes in this PR:\r\n\r\nUpdated py client's version to 4.16\r\n\r\n### Motivation\r\n\r\nPreparing for the release\r\nhttps://bookkeeper.apache.org/community/release_guide/#change-python-client-version","Date":"Mon Aug 01 15:53:56 CEST 2022"},{"Commit-ID":"commit 7bd0da4e09607a56ba4905f7ead4e23dcba48ce8 1659362086 -----sp","Author":"PersonIdent[dependabot[bot], 49699333+dependabot[bot]@users.noreply.github.com, Mon Aug 1 21:54:46 2022 +0800]","Body":"Bump terser from 5.12.0 to 5.14.2 in /site3/website (#3414)\n\nBumps [terser](https://github.com/terser/terser) from 5.12.0 to 5.14.2.\r\n- [Release notes](https://github.com/terser/terser/releases)\r\n- [Changelog](https://github.com/terser/terser/blob/master/CHANGELOG.md)\r\n- [Commits](https://github.com/terser/terser/commits)\r\n\r\n---\r\nupdated-dependencies:\r\n- dependency-name: terser\r\n  dependency-type: indirect\r\n...\r\n\r\nSigned-off-by: dependabot[bot] <support@github.com>\r\n\r\nCo-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>","Date":"Mon Aug 01 15:54:46 CEST 2022"},{"Commit-ID":"commit 942fadd439e4746f99c786d97cf10dc61ec5cc80 1659418595 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Tue Aug 2 13:36:35 2022 +0800]","Body":"Revert some unwanted changes in commit 3309 (#3438)\n\n---\r\n\r\n*Motivation*\r\n\r\nThere are some unwanted changes committed by 3309\r\nhttps://github.com/apache/bookkeeper/pull/3309","Date":"Tue Aug 02 07:36:35 CEST 2022"},{"Commit-ID":"commit de5d45fb823dc558f15bcb9d958b9c0a5144043c 1659881376 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sun Aug 7 22:09:36 2022 +0800]","Body":"Bump vertx version from 3.9.8 to 4.3.2 (#3435)\n\n","Date":"Sun Aug 07 16:09:36 CEST 2022"},{"Commit-ID":"commit 19fd8f74265130f76f55b04a24cc0ee5c7a634a5 1660646793 -----sp","Author":"PersonIdent[Lari Hotari, lhotari@users.noreply.github.com, Tue Aug 16 13:46:33 2022 +0300]","Body":"Add latency stats for entry location index lookup so that possible RocksDB bottleneck can be detected (#3444)\n\n* Add operation latency stats for entry location lookup\r\n\r\n- this metric will help detecting when the bottleneck is in the entry location index lookup operations\r\n  and RocksDB tuning is needed\r\n\r\n* Address review feedback: fix issue with eventLatencyMillis variable\r\n\r\n* Rename misleading parameter name","Date":"Tue Aug 16 12:46:33 CEST 2022"},{"Commit-ID":"commit 1cbde1a31cde56383ed28967f3d10f607eec36d0 1660822488 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Thu Aug 18 19:34:48 2022 +0800]","Body":"Fix the tls failed test (#3448)\n\n---\r\n\r\n*Motivation*\r\n\r\nWhen runing the tls test, the remote address is a LocalAddress,\r\nbut we cast it to the `InetSocketAddress`. That cause the test\r\n`testConnectToLocalTLSClusterTLSClient` failed.","Date":"Thu Aug 18 13:34:48 CEST 2022"},{"Commit-ID":"commit be00ab5faef6ea256c663ccbebfe2e9a3e175db1 1660917154 -----sp","Author":"PersonIdent[Hang Chen, hangc0276@163.com, Fri Aug 19 21:52:34 2022 +0800]","Body":"Fix wrong stats name (#3450)\n\n### Modification\r\nFix the wrong `cbThreadPoolQueueSize` doc name","Date":"Fri Aug 19 15:52:34 CEST 2022"},{"Commit-ID":"commit 854dd7d8614a3dd68f881b404d0f4a47b732e558 1660927559 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Sat Aug 20 00:45:59 2022 +0800]","Body":"Add .asf.yaml for configuring the project (#3439)\n\n---\r\n\r\n*Motivation*\r\n\r\nSame as Pulsar, Pulsar is using [.asf.yaml](https://cwiki.apache.org/confluence/display/INFRA/Git+-+.asf.yaml+features#Git.asf.yamlfeatures-Branchprotection) to configure the project,\r\nlike the branch protection.\r\nAdd .asf.yaml for configuring the PR required CI.","Date":"Fri Aug 19 18:45:59 CEST 2022"},{"Commit-ID":"commit d9bcc8bde2690e5b5d3a97488d658e0a5cbae884 1660968136 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Sat Aug 20 12:02:16 2022 +0800]","Body":"bugfix for .asf.yaml (#3451)\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nusing [.asf.yaml](https://cwiki.apache.org/confluence/display/INFRA/Git+-+.asf.yaml+features#Git.asf.yamlfeatures-Branchprotection) to configure the project,\r\nbut there 's some config bugfix for project's .asf.yaml\r\nthe name of workflow's jobs is not set, so #3439 causes contexts can't match check's jobs\r\n\r\nthis picture is the other new add pr's running result: the other pr's workflow run abnormally\r\n<img width=\"923\" alt=\"image\" src=\"https://user-images.githubusercontent.com/42990025/185718866-b7054dd7-502f-4371-8906-c43f8b1b166b.png\">\r\n\r\nthis picture is current running result: current pr is running normally because the job name is added in yaml file\r\n<img width=\"954\" alt=\"image\" src=\"https://user-images.githubusercontent.com/42990025/185718710-ec41584e-4871-40cc-9ed6-655caa7ff021.png\">\r\n \r\n### Changes\r\n\r\n1.  add the name for checks\r\n2. change required_approving_review_count to 2 person\r\n3. update README.md for workflows","Date":"Sat Aug 20 06:02:16 CEST 2022"},{"Commit-ID":"commit 03d38a7639c8013f16838cc795ac9bf7a03ecd99 1661064374 -----sp","Author":"PersonIdent[karanmehta93, k.mehta@salesforce.com, Sat Aug 20 23:46:14 2022 -0700]","Body":"WriteLacResponse should be processed in the same thread as other requ\u2026 (#3452)\n\n* WriteLacResponse should be processed in the same thread as other requests for same ledgerId\r\n\r\nIn PCBC code, the WriteLacCompletion object uses LAC as the key for selecting the thread in which the response\r\nwill be processed. However, according to bookkeeper code guarantees, the thread should be decided based on hash of ledgerId.\r\n\r\n* Empty-Commit","Date":"Sun Aug 21 08:46:14 CEST 2022"},{"Commit-ID":"commit 149ecd93e75dd23447de9ea24bba68d7ef5a8e33 1661236234 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Tue Aug 23 14:30:34 2022 +0800]","Body":"required_approving_review_count update (#3453)\n\nCo-authored-by: lushiji <lushiji@didiglobal.com>","Date":"Tue Aug 23 08:30:34 CEST 2022"},{"Commit-ID":"commit dcc9a414eafbb27ed8d9a976ef824e825777273a 1661300758 -----sp","Author":"PersonIdent[yapeng, 562250082@qq.com, Wed Aug 24 08:25:58 2022 +0800]","Body":"move forceWriteMarkerSent out of loop of ForceWriteThread to avoid frequently forceWrite (#3454)\n\nFix group ForceWrite not take effect with forceWriteMarkerSent in while loop of ForceWriteThread\r\n\r\n### Motivation\r\nBookkeeper 4.15 has performance issue. There are too many journal sync.\r\nThen I found in ForceWriteThread, forceWriteMarkerSent is reset to false for every loop, and this can cause shouldForceWrite=true and trigger journal sync. This new logic is bringed by https://github.com/apache/bookkeeper/pull/2962\r\n\r\n### Changes\r\nmove forceWriteMarkerSent=false out of while loop.\r\n\r\n","Date":"Wed Aug 24 02:25:58 CEST 2022"},{"Commit-ID":"commit f1b2256f9f251e6c9ddc4a6a728aba07a504b848 1661409872 -----sp","Author":"PersonIdent[grayson, 916028390@qq.com, Thu Aug 25 14:44:32 2022 +0800]","Body":"Make netty acceptor threadPool size configurable (#3153)\n\n","Date":"Thu Aug 25 08:44:32 CEST 2022"},{"Commit-ID":"commit 7dc5692b4c137c831c10381ecd4cdd0c331a0e7b 1661789928 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Mon Aug 29 18:18:48 2022 +0200]","Body":"[ci] Cache maven dependencies (#3461)\n\n### Motivation\r\nOur current CI doesn't implement a cache solution and it's a waste of resources and time. \r\nGH offers a builtin action\r\nhttps://docs.github.com/en/actions/using-workflows/caching-dependencies-to-speed-up-workflows \r\n\r\n### Changes\r\n\r\n* Added a cache for each job that build with maven","Date":"Mon Aug 29 18:18:48 CEST 2022"},{"Commit-ID":"commit b13dd20f0a905c615daef2e1ddcfa0e0979d1a07 1661909896 -----sp","Author":"PersonIdent[赤月, 974226358@qq.com, Wed Aug 31 09:38:16 2022 +0800]","Body":"[BOOKIE-SHELL]fix queryautorecoverystatus command (#3459) (#3460)\n\n### Motivation\r\n\r\nbugfix\r\n\r\n### Changes\r\n\r\nFix CMD_QUERY_AUTORECOVERY_STATUS command about registering to BOOKIE_SHEEL command mapping\r\n\r\nMaster Issue: #3459 ","Date":"Wed Aug 31 03:38:16 CEST 2022"},{"Commit-ID":"commit 8954d9848e63ec5d32d1ba4bde26db1df2241801 1662015827 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Thu Sep 1 15:03:47 2022 +0800]","Body":"Skip runs the workflow when only have site related changes (#3462)\n\n---\r\n\r\n*Motivation*\r\n\r\nWe have enabled the requirement of the workflow before merging a\r\nPR. We should skip checking the sites related changes because they\r\nare non-code change.\r\n\r\n*Modification*\r\n\r\n- Using apache/pulsar-test-infra/paths-filter@master to filter the files","Date":"Thu Sep 01 09:03:47 CEST 2022"},{"Commit-ID":"commit d5ab02a07c11a585bf8a96c787ba27504c09f3ec 1662084928 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Fri Sep 2 10:15:28 2022 +0800]","Body":"Add 4.15.1 release note (#3440)\n\n* Add 4.15.1 release note\r\n---\r\n\r\n*Motivation*\r\n\r\nGenerates the 4.15.1 docs and release note\r\n","Date":"Fri Sep 02 04:15:28 CEST 2022"},{"Commit-ID":"commit a266c92acadf7054667db4974bb84439c4d78475 1662341889 -----sp","Author":"PersonIdent[Lishen Yao, yaalsn@gmail.com, Mon Sep 5 09:38:09 2022 +0800]","Body":"Add powermock global configuration (#3467)\n\n### Motivation\r\n\r\nFix https://github.com/apache/bookkeeper/issues/3115 \r\n\r\nWhen I try to run some test classes, there will occur an error message like the above issue cause `javax/management/MBeanServer` is a system class and javassist's classloader cannot load it. we can add powermock global configuration to ignore this error message.\r\n\r\nThe powermock's instruction is here: https://github.com/powermock/powermock/wiki/PowerMock-Configuration\r\n\r\n### Changes\r\n\r\nAdd `org/powermock/extensions/configuration.properties`.","Date":"Mon Sep 05 03:38:09 CEST 2022"},{"Commit-ID":"commit 1adc0414bd96fd4eda67837d980e9df37471f631 1662346543 -----sp","Author":"PersonIdent[Xiaoyu Hou, AnonHxyGo@gmail.com, Mon Sep 5 10:55:43 2022 +0800]","Body":"Optimize log for failed to write entry (#3463)\n\nDescriptions of the changes in this PR:\r\n\r\nPrint bookie address when writing entry failed\r\n\r\n### Motivation\r\n\r\nPrinting bookie info will be help for solving online problem\r\n### Changes\r\n\r\nPrint bookie address when writing entry failed\r\n","Date":"Mon Sep 05 04:55:43 CEST 2022"},{"Commit-ID":"commit fc981ba04bae126afe3452b76006e80487cc9d84 1662365616 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Mon Sep 5 16:13:36 2022 +0800]","Body":"Feature: auto recover support repaired not adhering placement ledger (#3359)\n\n","Date":"Mon Sep 05 10:13:36 CEST 2022"},{"Commit-ID":"commit a0acdfefc419c070064ee1c0dd83e96e0e4fe89d 1662508167 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Wed Sep 7 07:49:27 2022 +0800]","Body":"Bump dependency check to 7.1.2 to avoid FP (#3470)\n\n","Date":"Wed Sep 07 01:49:27 CEST 2022"},{"Commit-ID":"commit 457eaf8dbc0101deef2159e7ec1c312ab66af2db 1662508235 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Wed Sep 7 07:50:35 2022 +0800]","Body":"Bump snakeyaml from 1.30 to 1.31 to solve CVE-2022-25857 (#3469)\n\n","Date":"Wed Sep 07 01:50:35 CEST 2022"},{"Commit-ID":"commit eadac6297ec14455f3c7a3a02ceb48382cebbd25 1662561498 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Wed Sep 7 22:38:18 2022 +0800]","Body":"Bump jcommander from 1.78 to 1.82 (#3476)\n\n### Motivation\r\nThat's a regular update, `jcommander` 1.78 was released in 2019.\r\n\r\n### Modifications\r\nBump jcommander version from 1.78 to 1.82","Date":"Wed Sep 07 16:38:18 CEST 2022"},{"Commit-ID":"commit be7053b850a3ad53c09baeac15b01cabc8e9412a 1662600300 -----sp","Author":"PersonIdent[HuangZeGui, hzgui1314@126.com, Thu Sep 8 09:25:00 2022 +0800]","Body":"clean code for BookKeeperServerStats (#3478)\n\n### Motivation\r\nclean code : remove unused fields in `org.apache.bookkeeper.bookie.BookKeeperServerStats`","Date":"Thu Sep 08 03:25:00 CEST 2022"},{"Commit-ID":"commit 70e9477937a40fc5a5e637e887bb85942958163a 1662707605 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Fri Sep 9 15:13:25 2022 +0800]","Body":"Bump netty version to 4.1.79.Final (#3479)\n\n### Motivation\r\nNetty 4.1.78 and Netty 4.1.79 solves several bugs\r\n\r\nChangelog:\r\n- https://netty.io/news/2022/06/14/4-1-78-Final.html\r\n- https://netty.io/news/2022/07/11/4-1-79-Final.html\r\n\r\n### Changes\r\n\r\n* Upgrade Netty from 4.1.77.Final to 4.1.79.Final\r\n* Netty 4.1.79.Final depends on netty-tc-native 2.0.53, also updates\r\n\r\n### Why not directed upgraded to 4.1.80.Final\r\nCI fails when upgraded to 4.1.80.Final. I'm still working on it. I think we can update to 4.1.79.Final first.","Date":"Fri Sep 09 09:13:25 CEST 2022"},{"Commit-ID":"commit 3c18ee7ad502c13e6a71ca475fd03d5cc33bbf31 1662901928 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sun Sep 11 21:12:08 2022 +0800]","Body":"optimize SlowBookieTest (#3484)\n\n","Date":"Sun Sep 11 15:12:08 CEST 2022"},{"Commit-ID":"commit 6fa13ecdfca01d4d65d49c489484acc5755e616e 1662965828 -----sp","Author":"PersonIdent[Michael Marshall, mmarshall@apache.org, Sun Sep 11 23:57:08 2022 -0700]","Body":"Add missed call to onReadRequestFinish() when read request rejected (#3482)\n\nFixes: https://github.com/apache/bookkeeper/issues/2945\r\n\r\n### Motivation\r\n\r\nWhen a read request is rejected due to the limit on the number of reads that can be enqueued, we need to decrement the metric for `bookkeeper_server_READ_ENTRY_IN_PROGRESS` and release the `readsSemaphore`, if it is not null.\r\n\r\n### Changes\r\n\r\n* Call `onReadRequestFinish()` for failures in the V2 and V3 request processing logic.\r\n\r\n### Observation\r\nIt looks like the V2 responses for this kind of failure are not throttled, even when `throttleReadResponses` is true. We could call `read.sendReadReqResponse(` to enable this throttling. I didn't change it here because there might be a reason we're not throttling these small responses.","Date":"Mon Sep 12 08:57:08 CEST 2022"},{"Commit-ID":"commit 87c8bcb31c48e8c4670c067e757b1adfd0f1ba84 1662969491 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Mon Sep 12 15:58:11 2022 +0800]","Body":"Bump netty version to 4.1.81.Final (#3481)\n\n### Motivation\r\nNetty 4.1.80 and Netty 4.1.81 solves several bugs\r\n\r\nChangelog:\r\n- https://netty.io/news/2022/08/26/4-1-80-Final.html\r\n- https://netty.io/news/2022/09/08/4-1-81-Final.html\r\n\r\n### Changes\r\n\r\n* Upgrade Netty from 4.1.79.Final to 4.1.81.Final\r\n* Netty 4.1.81.Final depends on netty-tc-native 2.0.54, also updates","Date":"Mon Sep 12 09:58:11 CEST 2022"},{"Commit-ID":"commit 70bbc3830f07691cbdb87fe03958196fafc0effb 1662979772 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Mon Sep 12 18:49:32 2022 +0800]","Body":"Fix the deadlock when only using io thread to handle request (#3480)\n\n* Fix the deadlock when only using io thread to handle request\r\n---\r\n\r\n*Motivation*\r\n\r\nIf user don't configure the ReadWorker thread pool, the reqeust will\r\nprocess with io thread. We cannot call await() from an IO thread,\r\nif the socket buffer is full, that blocking call would cause a deadlock.\r\n\r\n*Modification*\r\n\r\n- only wait the promise when the thread is not io thread\r\n\r\n* Fix the style issue","Date":"Mon Sep 12 12:49:32 CEST 2022"},{"Commit-ID":"commit 27210ea795a9ec17fa4aa85e2f9c8915d3369ebf 1662979821 -----sp","Author":"PersonIdent[Marvin Cai, zxc@streamnative.io, Mon Sep 12 03:50:21 2022 -0700]","Body":"Add option to clean up test ledger after simpletest. (#3474)\n\n* Add option to clean up test ledger after simpletest.\r\n\r\nLedger created by simpletest could be trouble when decommissioning if\r\nwe set small esemble size, so add option to clean it up after test.\r\nAlso adding metadata to such test ledger so we can also manually clean it up later.\r\n","Date":"Mon Sep 12 12:50:21 CEST 2022"},{"Commit-ID":"commit aba568087c6dff99a343346107153ed1d979677b 1663040857 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Tue Sep 13 11:47:37 2022 +0800]","Body":"upgrade hadoop version to 3.2.4 (#3485)\n\n","Date":"Tue Sep 13 05:47:37 CEST 2022"},{"Commit-ID":"commit 2b1a24543b6c1e778d7a90480e704cb6ca2d0e98 1663040948 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Tue Sep 13 11:49:08 2022 +0800]","Body":"Add 4.15.1 to versions file (#3475)\n\n* Add 4.15.1 to versions file\r\n---\r\n\r\n*Motivation*\r\n\r\nAdd 4.15.1 to version file to update the website\r\n\r\n* Regenerate the website docs\r\n\r\n* Fix a minor issue","Date":"Tue Sep 13 05:49:08 CEST 2022"},{"Commit-ID":"commit ef89ff296a6338e3fddf5ae6ff5649553788f68a 1663050195 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Tue Sep 13 14:23:15 2022 +0800]","Body":"Migrate Dockerfile from centos to ubuntu and python3 (#3483)\n\n","Date":"Tue Sep 13 08:23:15 CEST 2022"},{"Commit-ID":"commit 6fc2e08d534159fc078022a6781e94933b7268d1 1663186197 -----sp","Author":"PersonIdent[Enrico Olivelli, eolivelli@apache.org, Wed Sep 14 22:09:57 2022 +0200]","Body":"AutoRecovery - Do not call shutdown() on the main ZookKeeper client thread (#3487)\n\n","Date":"Wed Sep 14 22:09:57 CEST 2022"},{"Commit-ID":"commit d14d696b13dcac47880a947f16c3f6c5594814b4 1663289346 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Fri Sep 16 08:49:06 2022 +0800]","Body":"Migrate centos7 to ubuntu 22.10, reduce image size (#3492)\n\n### Changes\r\n- migrate statestore image from centos7 to ubuntu\r\n- use `--no-install-recommends` to reduce image size\r\n- elminate `gcc`、`gcc-c++` in image\r\n\r\nThanks for @lhotari \r\n\r\nCo-authored-by: Nicolò Boschi <boschi1997@gmail.com>","Date":"Fri Sep 16 02:49:06 CEST 2022"},{"Commit-ID":"commit fc85ce0bbe9e1e33a6e92a6eebab432eadb4e34e 1663289387 -----sp","Author":"PersonIdent[Tian Luo, futurer@outlook.com, Fri Sep 16 08:49:47 2022 +0800]","Body":"Bump snakeyaml from 1.31 to 1.32 to solve CVE-2022-38752 (#3491)\n\n","Date":"Fri Sep 16 02:49:47 CEST 2022"},{"Commit-ID":"commit 1313b8e2e7964a0bbf2e221f49fe30a1fd812d31 1663581471 -----sp","Author":"PersonIdent[Michael Marshall, mmarshall@apache.org, Mon Sep 19 02:57:51 2022 -0700]","Body":"Check if channel closed before processing read request (#3486)\n\n* Check if channel closed before processing read request\r\n\r\n* Add missed call to onReadRequestFinish()\r\n\r\n* Fix test\r\n\r\n* Mock more tests\r\n\r\nCo-authored-by: Nicolò Boschi <boschi1997@gmail.com>","Date":"Mon Sep 19 11:57:51 CEST 2022"},{"Commit-ID":"commit 7004d994938e914561d8343a96d9d75ce98b2837 1663603197 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon Sep 19 08:59:57 2022 -0700]","Body":"Speed up the rebuildinding of RocksDB index (#3458)\n\n* Speed up the rebuildinding of RocksDB index\r\n\r\n* fix check style\r\n\r\nCo-authored-by: chenhang <chenhang@apache.org>","Date":"Mon Sep 19 17:59:57 CEST 2022"},{"Commit-ID":"commit 112f232b36800d9cb008229f13a7b6a3727a4cd3 1663922813 -----sp","Author":"PersonIdent[Fushu Wang, fswang@streamnative.io, Fri Sep 23 16:46:53 2022 +0800]","Body":"docs: fix bookkeeper command path in decommission doc (#3499)\n\n","Date":"Fri Sep 23 10:46:53 CEST 2022"},{"Commit-ID":"commit 1e387f8ef3fdf2c9ba9efcff4f781ef9f17ad75d 1664247774 -----sp","Author":"PersonIdent[StevenLuMT, 42990025+StevenLuMT@users.noreply.github.com, Tue Sep 27 11:02:54 2022 +0800]","Body":"unified latency metric unit (#3501)\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nThe latency of the OpStatsLogger.registerSuccessfulEvent calculation is to convert the time to milliseconds\r\n<img width=\"855\" alt=\"image\" src=\"https://user-images.githubusercontent.com/42990025/191929953-bdac2d25-3fbe-4697-b3e9-f4942ed7c074.png\">\r\nbut Counter.add nothing to do\r\n\r\nso when using Counter for latency statistics, the time unit and OpStatsLogger are not unified, which is easy to be misleading.\r\nthen we unified latency metric unit \r\n\r\n### Changes\r\n\r\n1.  change name : Counter.add -->  Counter.addCount\r\n2. add new method Counter.addLatency to count the time and convert the time to milliseconds\r\n\r\nthen how to use counter correctly:\r\n1. when using Counter for latency metric, call Counter.addLatency\r\n2. when using Counter for count metric, call Counter.addCount","Date":"Tue Sep 27 05:02:54 CEST 2022"},{"Commit-ID":"commit 74a87e260bd0cf9eca2d229cc181638741b5f575 1664338692 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Wed Sep 28 12:18:12 2022 +0800]","Body":"ledgerFragment check and results keep order (#3504)\n\n### Motivation\r\nWhen `LedgerChecker` checks Ledger's fragments, it does not keep the order, and the results of the check are not kept in order, which works correctly most of the time.\r\n\r\nI'm not sure if we should keep the order of checks and final results, but I observed a flaky-test like this:\r\nhttps://github.com/apache/bookkeeper/actions/runs/3124965464/jobs/5068848112\r\n\r\nI have printed some verbose logs as follows:\r\ntestShouldGetTwoFrgamentsIfTwoBookiesFailedInSameEnsemble In the case of success and failure:\r\n\r\n### When the test execution is successful:\r\n2022-09-26T15:00:13,790 - INFO  - [Time-limited test:LedgerChecker@373] - checkLedger nowing.\r\n2022-09-26T15:00:13,792 - INFO  - [Time-limited test:LedgerChecker@398] - LedgerCheck fragments before[Fragment(LedgerID: 0, FirstEntryID: 0[0], LastKnownEntryID: 0[0], Host: [127.0.0.1:50466, 127.0.0.1:50474, 127.0.0.1:50476], Closed: true)]\r\n2022-09-26T15:00:13,793 - INFO  - [Time-limited test:LedgerChecker@430] - not execute check fragments. curEnsemble [127.0.0.1:50466, 127.0.0.1:50486, 127.0.0.1:50476], curEntryId 1\r\n**2022-09-26T15:00:13,809 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:LedgerChecker$1@440] - check2Fragments [Fragment(LedgerID: 0, **FirstEntryID: 0[0]**, LastKnownEntryID: 0[0], Host: [127.0.0.1:50466, 127.0.0.1:50474, 127.0.0.1:50476], Closed: true), Fragment(LedgerID: 0, **FirstEntryID: 1[1]**, LastKnownEntryID: 1[1], Host: [127.0.0.1:50466, 127.0.0.1:50476, 127.0.0.1:50486], Closed: false)]** \r\n2022-09-26T15:00:13,810 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:LedgerChecker@479] - Checking fragment Fragment(LedgerID: 0, FirstEntryID: 0[0], LastKnownEntryID: 0[0], Host: [127.0.0.1:50466, 127.0.0.1:50474, 127.0.0.1:50476], Closed: true)\r\n2022-09-26T15:00:13,813 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:LedgerChecker$FullLedgerCallback@360] - operationComplete Fragment(LedgerID: 0, FirstEntryID: 0[0], LastKnownEntryID: 0[0], Host: [127.0.0.1:50466, 127.0.0.1:50474], Closed: true), -8\r\n2022-09-26T15:00:13,813 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:LedgerChecker@479] - Checking fragment Fragment(LedgerID: 0, FirstEntryID: 1[1], LastKnownEntryID: 1[1], Host: [127.0.0.1:50466, 127.0.0.1:50476, 127.0.0.1:50486], Closed: false)\r\n2022-09-26T15:00:13,817 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:LedgerChecker$FullLedgerCallback@360] - operationComplete Fragment(LedgerID: 0, FirstEntryID: 1[-1], LastKnownEntryID: 1[-1], Host: [127.0.0.1:50466], Closed: false), -8\r\n**2022-09-26T15:00:13,817 - INFO  - [Time-limited test:TestLedgerChecker@534] - waitAndGetResult [Fragment(LedgerID: 0, **FirstEntryID: 0[0]**, LastKnownEntryID: 0[0], Host: [127.0.0.1:50466, 127.0.0.1:50474], Closed: true), Fragment(LedgerID: 0, **FirstEntryID: 1[-1]**, LastKnownEntryID: 1[-1], Host: [127.0.0.1:50466], Closed: false)]** \r\n2022-09-26T15:00:13,818 - INFO  - [Time-limited test:TestLedgerChecker@201] - other Ensemble {0=[127.0.0.1:50466, 127.0.0.1:50474, 127.0.0.1:50476], 1=[127.0.0.1:50466, 127.0.0.1:50486, 127.0.0.1:50476]}\r\n2022-09-26T15:00:13,818 - INFO  - [Time-limited test:TestLedgerChecker@206] - unreplicated fragment: Fragment(LedgerID: 0, FirstEntryID: 0[0], LastKnownEntryID: 0[0], Host: [127.0.0.1:50466, 127.0.0.1:50474], Closed: true)\r\n2022-09-26T15:00:13,819 - INFO  - [Time-limited test:TestLedgerChecker@206] - unreplicated fragment: Fragment(LedgerID: 0, FirstEntryID: 1[-1], LastKnownEntryID: 1[-1], Host: [127.0.0.1:50466], Closed: false)\r\n2022-09-26T15:00:13,819 - INFO  - [Time-limited test:TestLedgerChecker@212] - bookies fragments [127.0.0.1:50466, 127.0.0.1:50474, 127.0.0.1:50476], [0, 1]\r\n2022-09-26T15:00:13,819 - INFO  - [Time-limited test:BookKeeperClusterTestCase@199] - TearDown\r\n\r\n### When test execution failed:\r\n2022-09-26T14:58:09,687 - INFO  - [Time-limited test:LedgerChecker@373] - checkLedger nowing.\r\n2022-09-26T14:58:09,689 - INFO  - [Time-limited test:LedgerChecker@398] - LedgerCheck fragments before[Fragment(LedgerID: 0, FirstEntryID: 0[0], LastKnownEntryID: 0[0], Host: [127.0.0.1:50105, 127.0.0.1:50107, 127.0.0.1:50109], Closed: true)]\r\n2022-09-26T14:58:09,690 - INFO  - [Time-limited test:LedgerChecker@430] - not execute check fragments. curEnsemble [127.0.0.1:50105, 127.0.0.1:50122, 127.0.0.1:50107], curEntryId 1\r\n**2022-09-26T14:58:09,704 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:LedgerChecker$1@440] - check2Fragments [Fragment(LedgerID: 0, **FirstEntryID: 1[1]**, LastKnownEntryID: 1[1], Host: [127.0.0.1:50105, 127.0.0.1:50122, 127.0.0.1:50107], Closed: false), Fragment(LedgerID: 0, **FirstEntryID: 0[0]**, LastKnownEntryID: 0[0], Host: [127.0.0.1:50105, 127.0.0.1:50107, 127.0.0.1:50109], Closed: true)]** \r\n2022-09-26T14:58:09,705 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:LedgerChecker@479] - Checking fragment Fragment(LedgerID: 0, FirstEntryID: 1[1], LastKnownEntryID: 1[1], Host: [127.0.0.1:50105, 127.0.0.1:50122, 127.0.0.1:50107], Closed: false)\r\n2022-09-26T14:58:09,707 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:LedgerChecker@479] - Checking fragment Fragment(LedgerID: 0, FirstEntryID: 0[0], LastKnownEntryID: 0[0], Host: [127.0.0.1:50105, 127.0.0.1:50107, 127.0.0.1:50109], Closed: true)\r\n2022-09-26T14:58:09,708 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:LedgerChecker$FullLedgerCallback@360] - operationComplete Fragment(LedgerID: 0, FirstEntryID: 0[0], LastKnownEntryID: 0[0], Host: [127.0.0.1:50105, 127.0.0.1:50109], Closed: true), -8\r\n2022-09-26T14:58:09,708 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:LedgerChecker$FullLedgerCallback@360] - operationComplete Fragment(LedgerID: 0, FirstEntryID: 1[-1], LastKnownEntryID: 1[-1], Host: [127.0.0.1:50105], Closed: false), -8\r\n**2022-09-26T14:58:09,709 - INFO  - [Time-limited test:TestLedgerChecker@534] - waitAndGetResult [Fragment(LedgerID: 0, **FirstEntryID: 1[-1]**, LastKnownEntryID: 1[-1], Host: [127.0.0.1:50105], Closed: false), Fragment(LedgerID: 0, **FirstEntryID: 0[0]**, LastKnownEntryID: 0[0], Host: [127.0.0.1:50105, 127.0.0.1:50109], Closed: true)]**\r\n2022-09-26T14:58:09,709 - INFO  - [Time-limited test:TestLedgerChecker@201] - other Ensemble {0=[127.0.0.1:50105, 127.0.0.1:50109, 127.0.0.1:50107], 1=[127.0.0.1:50105, 127.0.0.1:50122, 127.0.0.1:50107]}\r\n2022-09-26T14:58:09,709 - INFO  - [Time-limited test:TestLedgerChecker@206] - unreplicated fragment: Fragment(LedgerID: 0, FirstEntryID: 1[-1], LastKnownEntryID: 1[-1], Host: [127.0.0.1:50105], Closed: false)\r\n2022-09-26T14:58:09,709 - INFO  - [Time-limited test:TestLedgerChecker@206] - unreplicated fragment: Fragment(LedgerID: 0, FirstEntryID: 0[0], LastKnownEntryID: 0[0], Host: [127.0.0.1:50105, 127.0.0.1:50109], Closed: true)\r\n2022-09-26T14:58:09,709 - INFO  - [Time-limited test:TestLedgerChecker@212] - bookies fragments [127.0.0.1:50105, 127.0.0.1:50122, 127.0.0.1:50107], [0]\r\n2022-09-26T14:58:09,710 - INFO  - [Time-limited test:BookKeeperClusterTestCase@199] - TearDown\r\n\r\n### Changes\r\nReplace `HashSet` with `LinkedHashSet`","Date":"Wed Sep 28 06:18:12 CEST 2022"},{"Commit-ID":"commit 21560fb9afd9da61231a709c0b86a1a7b2d0f8b0 1664458764 -----sp","Author":"PersonIdent[Masahiro Sakamoto, massakam@yahoo-corp.jp, Thu Sep 29 22:39:24 2022 +0900]","Body":"Issue 3070: Fix bug where checkAllLedgers gets stuck when read throttling is enabled (#3214)\n\n","Date":"Thu Sep 29 15:39:24 CEST 2022"},{"Commit-ID":"commit 1294c00cdd53abac6f64ecbce431cd6775ee6c3d 1664885903 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Tue Oct 4 20:18:23 2022 +0800]","Body":"disable direct IO test on windows (#3515)\n\n","Date":"Tue Oct 04 14:18:23 CEST 2022"},{"Commit-ID":"commit 21357087f08b57a530c94591121b9803b5a486e5 1665057614 -----sp","Author":"PersonIdent[Enrico Olivelli, enrico.olivelli@datastax.com, Thu Oct 6 14:00:14 2022 +0200]","Body":"LedgerHandle: do not complete metadata operation on the ZookKeeper/Metadata callback thread (#3516)\n\n","Date":"Thu Oct 06 14:00:14 CEST 2022"},{"Commit-ID":"commit 2734e8bcec6371cb139913624fd30953fc6c1def 1665195627 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Fri Oct 7 19:20:27 2022 -0700]","Body":"LedgerOpenOp: Do not call blocking close() in the callback (#3513)\n\n* Do not call blocking close() in the callback\r\n     * CR feedback, remove lombok from LedgerOpenOp","Date":"Sat Oct 08 04:20:27 CEST 2022"},{"Commit-ID":"commit bc87bfbea5816b382a7fe54639d71b404736ba62 1665195868 -----sp","Author":"PersonIdent[萧易客, kmter@live.com, Sat Oct 8 10:24:28 2022 +0800]","Body":"Reduce unnecessary loop in removeIf if section is empty (#3512)\n\nReduce unnecessary loop in removeIf if section is empty","Date":"Sat Oct 08 04:24:28 CEST 2022"},{"Commit-ID":"commit 2b981bd63a15714bfd3cf3267e2f487c244a1a48 1665214452 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Sat Oct 8 15:34:12 2022 +0800]","Body":"Add release 4.15.2 release note (#3500)\n\n* Add release 4.15.2 release note\r\n---\r\n\r\n*Motivation*\r\n\r\nGenerates the 4.15.2 release note\r\n\r\n* Update site3/website/src/pages/release-notes.md","Date":"Sat Oct 08 09:34:12 CEST 2022"},{"Commit-ID":"commit 6e43c0a8c6447ada7b1cf46243396ea1abfe01b9 1665287249 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sun Oct 9 11:47:29 2022 +0800]","Body":"Bump jackson version to 2.13.4 (#3518)\n\n### Motivation\r\nBump jackson version to 2.13.4 to solve CVE-2022-42004","Date":"Sun Oct 09 05:47:29 CEST 2022"},{"Commit-ID":"commit 570bb1d61a508a2f52d84786d448a530e6f0b255 1665456265 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Tue Oct 11 10:44:25 2022 +0800]","Body":"Generate 4.15.2 docs (#3520)\n\n---\r\n*Motivation*\r\n\r\nGenerate 4.15.2 docs.","Date":"Tue Oct 11 04:44:25 CEST 2022"},{"Commit-ID":"commit 62155369d199f36720938e913541b223dab8b047 1665628921 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Thu Oct 13 10:42:01 2022 +0800]","Body":"Fix byteBuf potential memory leak problem. (#3525)\n\n* Fix byteBuf potential memory leak problem.","Date":"Thu Oct 13 04:42:01 CEST 2022"},{"Commit-ID":"commit cbb74eab4f1f464c0e4760acf9304af2289acfa1 1665981449 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Mon Oct 17 12:37:29 2022 +0800]","Body":"Adjust log stack output (#3496)\n\n### Motivation\r\nThe default `dnsResolver` of `RackawareEnsemblePlacementPolicyImpl` is initialized as `ScriptBasedMapping`. Since the script is missing by default, detailed stack information will be printed, but the code will fall back to `DefaultResolver` by default, so only simple exception information needs to be printed.\r\n![image](https://user-images.githubusercontent.com/35599757/191254546-54395f24-5e64-4d89-9bcd-61eb9308c91e.png)\r\n","Date":"Mon Oct 17 06:37:29 CEST 2022"},{"Commit-ID":"commit c9055c40e3c09d6eb3be7c4df9838cec79f7fe94 1665991500 -----sp","Author":"PersonIdent[赤月, 974226358@qq.com, Mon Oct 17 15:25:00 2022 +0800]","Body":"Create CONTRIBUTING.md (#3533)\n\n","Date":"Mon Oct 17 09:25:00 CEST 2022"},{"Commit-ID":"commit e313f60d482d45faabaa6f66e21f90a7282f22c7 1665993056 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Mon Oct 17 15:50:56 2022 +0800]","Body":"Make the rocksDB configuration compatible with previous versions (#3523)\n\n* Make the rocksDB configuration compatible with previous versions\r\n---\r\n*Motivation*\r\n\r\nIn the PR 3056, we introduced using rocksDB configuration file\r\nto configure it. But it is not compatible with the previous\r\nversions of bookkeeper. We used to use the bookie configuration\r\nfile to configure it. It would make the existing configuration\r\ndoesn't work. Which causes some performance issues for the user's\r\nexisting environment.\r\n\r\nThis PR adds the old configuration back. The new way only works\r\nif the rocksDB configuration file is existing.\r\n\r\n* Add tests and logs","Date":"Mon Oct 17 09:50:56 CEST 2022"},{"Commit-ID":"commit 7f1842bd6693904706d96fdf0c2977a4e3f49761 1666014814 -----sp","Author":"PersonIdent[gaozhangmin, gaozhangmin456@qq.com, Mon Oct 17 21:53:34 2022 +0800]","Body":"Replication throttle rate support dynamic set (#3157)\n\nReplication throttle rate support dynamic set (#3157)","Date":"Mon Oct 17 15:53:34 CEST 2022"},{"Commit-ID":"commit 30bdedc25a59aa7d4df3f5c0962095a574f0d653 1666074114 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Tue Oct 18 14:21:54 2022 +0800]","Body":"Fix memory leak when reading entry but the connection disconnected. (#3528)\n\n* Fix direct memory leak problem","Date":"Tue Oct 18 08:21:54 CEST 2022"},{"Commit-ID":"commit b63cca8bbb0208afa235abfdfc5f8dafd9eda2dd 1666137806 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Oct 18 17:03:26 2022 -0700]","Body":"Use BlockingQueue.drainTo() in JournalForceWrite thread (#3545)\n\n","Date":"Wed Oct 19 02:03:26 CEST 2022"},{"Commit-ID":"commit 5c6e78f5f477673338df09309b3b1f95c75458dd 1666140704 -----sp","Author":"PersonIdent[gaozhangmin, gaozhangmin456@qq.com, Wed Oct 19 08:51:44 2022 +0800]","Body":"Show content of map (#3538)\n\nFixes #3490\r\nChange ToString method, print the content of map.","Date":"Wed Oct 19 02:51:44 CEST 2022"},{"Commit-ID":"commit 2e1a2f0acd56e7f327e7fddd17d8a39d8f8fdbdf 1666161005 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Wed Oct 19 14:30:05 2022 +0800]","Body":"Rename success with writableResult and update final writableResult about wait writeSet (#3505)\n\n### Changes\r\nupdate `success` about wait writeSet for Writable result.","Date":"Wed Oct 19 08:30:05 CEST 2022"},{"Commit-ID":"commit dbec4e91eca20566a4db1673e9db1d728f659960 1666161048 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Wed Oct 19 14:30:48 2022 +0800]","Body":"fix close ledgerAuditorManager repeatedly (#3503)\n\n### Motivation\r\nthis introduced in #2842, the `ledgerAuditorManager` will be close repeatedly.\r\n\r\n```java\r\n    private void submitShutdownTask() {\r\n        executor.submit(new Runnable() {\r\n                @Override\r\n                public void run() {\r\n                    if (!running.compareAndSet(true, false)) {\r\n                        return;\r\n                    }\r\n\r\n                    try {\r\n                        ledgerAuditorManager.close();   <- here has already closed LAM.\r\n                    } catch (InterruptedException ie) {\r\n                        Thread.currentThread().interrupt();\r\n                        LOG.warn(\"InterruptedException while closing ledger auditor manager\", ie);\r\n                    } catch (Exception ke) {\r\n                        LOG.error(\"Exception while closing ledger auditor manager\", ke);\r\n                    }\r\n                }\r\n            });\r\n    }\r\n```\r\n","Date":"Wed Oct 19 08:30:48 CEST 2022"},{"Commit-ID":"commit 3083412b1ce8baa9ae03ecdef4f80bad72478657 1666226073 -----sp","Author":"PersonIdent[赤月, 974226358@qq.com, Thu Oct 20 08:34:33 2022 +0800]","Body":"[website]Declare the bookkeeper shell queryautorecoverystatuscommand on the web site #3536 (#3537)\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\nThe [bookkeeper shell queryautorecoverystatus](https://github.com/apache/bookkeeper/blob/b13dd20f0a905c615daef2e1ddcfa0e0979d1a07/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java#L1361) command is not publicly listed on the site\r\n\r\n### Changes\r\n\r\nDeclare the bookkeeper shell queryautorecoverystatuscommand on the web site\r\n\r\nMaster Issue: #3536","Date":"Thu Oct 20 02:34:33 CEST 2022"},{"Commit-ID":"commit 255416a8552f34e5fd50231bbeed77e0945b63e3 1666226169 -----sp","Author":"PersonIdent[赤月, 974226358@qq.com, Thu Oct 20 08:36:09 2022 +0800]","Body":"<Issue #3534>[website]fix website mailing_lists_url/slack_url (#3535)\n\nDescriptions of the changes in this PR:\r\nThe community related variables are not replaced\r\n\r\n### Motivation\r\nPoor user experience\r\n\r\n### Changes\r\n1、modify Upgrade page template variables\r\n2、add  variables to config\r\n\r\nMaster Issue: #3534\r\n\r\n![image](https://user-images.githubusercontent.com/18533252/195989997-63ac71d3-8d2a-425d-9c45-f0816f18cd80.png)\r\n","Date":"Thu Oct 20 02:36:09 CEST 2022"},{"Commit-ID":"commit 16a4365d7dcaafb2b0fc5ae6d43b4bee0af78b98 1666278723 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Oct 20 08:12:03 2022 -0700]","Body":"Use BlockingQueue.drainTo() in Journal thread (#3544)\n\n","Date":"Thu Oct 20 17:12:03 CEST 2022"},{"Commit-ID":"commit dff6d03a59b293019a3c1144515e6f931986f82f 1666297461 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Oct 20 13:24:21 2022 -0700]","Body":"Use SingleThreadExecutor for OrderedExecutor and drainTo() tasks into local array (#3546)\n\n* Use SingleThreadExecutor for OrderedExecutor and drainTo() tasks into local array\r\n\r\n* Added metrics to executor\r\n\r\n* Fixed checkstyle\r\n\r\n* Made the test more resilient\r\n\r\n* Made the tests not relying on thread.sleep()\r\n\r\n* Fixed testRejectWhenQueueIsFull\r\n\r\n* Ignore spotbugs warning\r\n\r\n* Fixed annotation formatting\r\n\r\n* Removed test assertion that had already been changed","Date":"Thu Oct 20 22:24:21 CEST 2022"},{"Commit-ID":"commit d5e86038d88d176ee4afb99d73ba84e9d696bec9 1666527754 -----sp","Author":"PersonIdent[FeiFan Wang, zoltar9264@163.com, Sun Oct 23 20:22:34 2022 +0800]","Body":"[docs] fix mistake in ledger api docs (#3566)\n\n","Date":"Sun Oct 23 14:22:34 CEST 2022"},{"Commit-ID":"commit c76e549fc93efb290adac9f7e295f44145772670 1666576407 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Mon Oct 24 09:53:27 2022 +0800]","Body":"fix flaky-test testWriteSetWriteableCheck (#3555)\n\n### Motivation\r\n `testWriteSetWriteableCheck` always failed. After investigation, it is found that `isWritable=false` is set when the simulated channel is not writable, but the unit test cannot fully perceive the channel establishment, because the channel is completely established asynchronously. The isWritable state of false is changed to true again.\r\n\r\nyou can see the following logs:\r\n![image](https://user-images.githubusercontent.com/35599757/196625314-0ea5a305-9564-4738-8055-20baa6a5c5a2.png)\r\n\r\nThe smallest change is that we can ensure that the channel is established before changing the channel state, such as executing `bkc.getBookieInfo()`, and then `setTargetChannelState`\r\n","Date":"Mon Oct 24 03:53:27 CEST 2022"},{"Commit-ID":"commit 1966512a2168c27a07836c935821b9aa9974e9bd 1666587606 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Mon Oct 24 13:00:06 2022 +0800]","Body":"Update website to record the RocksDB configuration changes (#3540)\n\n---\r\n\r\n*Motivation*\r\n\r\nRelated PR: #3523\r\nMailing discussion: https://lists.apache.org/thread/drh4p5prxbcs8gszhxnd1xsv0g48vvbt\r\n\r\nWe introduce the new way to configure the RocksDB but we haven't\r\nmentioned it in the website and release-note.\r\n\r\nThis PR add the document for the RocksDB configuration updates.\r\nAnd rename the RocksDB configuration files with the suffix `.default`\r\nto avoid loading them by default.\r\n\r\n*Modification*\r\n\r\n- Add the configuration changes in the 4.15.0 release notes.\r\n- Add how to configure the RocksDB with the new file in the website.\r\n- Rename the file with `.default` suffix to avoid loading it by default.","Date":"Mon Oct 24 07:00:06 CEST 2022"},{"Commit-ID":"commit 9d17efa431f1fbc5a4ffab15cb9dfc3394d543c3 1666619456 -----sp","Author":"PersonIdent[赤月, 974226358@qq.com, Mon Oct 24 21:50:56 2022 +0800]","Body":"[website][fix]Repair `sequential nodes` address (#3569)\n\n","Date":"Mon Oct 24 15:50:56 CEST 2022"},{"Commit-ID":"commit cfc6b9770f2189b17ac9ce61c763b4ce6a2d7e55 1666662584 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Tue Oct 25 09:49:44 2022 +0800]","Body":"skipping placementPolicyCheck when ledger replication disabled (#3561)\n\n### Motivation\r\n\r\nWhen `placementPolicyCheck` is enabled and then `bookkeeper shell autorecovery -disable` is executed, `placementPolicyCheck` will detect ledgers that do not satisfy `placementPolicy` and write to zookeeper, but `ReplicationWorker` no longer obtains ledgers from zookeeper for replication work because autorecovery is disabled, which results in a large number of temporary nodes on zookeeper , when there are more ledgers that do not satisfy placementPolicy, the problem will get worse.\r\n\r\nThe method of `ReplicationWorker` to get ledger:\r\n```java\r\nprivate boolean rereplicate() throws InterruptedException, BKException,\r\n            UnavailableException {\r\n        long ledgerIdToReplicate = underreplicationManager\r\n                .getLedgerToRereplicate();\r\n       \r\n       ...\r\n```\r\n\r\nSo we should also disable `placementPolicyCheck`.","Date":"Tue Oct 25 03:49:44 CEST 2022"},{"Commit-ID":"commit c97b57635bb65551ebf149ba458a73a056129bb9 1666668509 -----sp","Author":"PersonIdent[zhaohaidao, zhaohaidao2008@hotmail.com, Tue Oct 25 11:28:29 2022 +0800]","Body":"Flush time started moved to after lock (#3570)\n\n### Motivation\r\n\r\nIn BP-44(Ledger storage metrics enhancement), ledger flush start time is moved to after lock to avoid 200% time\r\n  utilization calculations.\r\nHowever, 200% time utilization still happens in my test. After reading the source code, I found that this part was rolled back by #3160. \r\nIf I understand correctly, this change is not as expected\r\n\r\n### Changes\r\n\r\nFlush start time is moved to after lock again.","Date":"Tue Oct 25 05:28:29 CEST 2022"},{"Commit-ID":"commit a58f11ff13b7690fbb1e7da92be4b65cded5d4bf 1666686030 -----sp","Author":"PersonIdent[StevenLuMT, lsj_sdjzu@126.com, Tue Oct 25 16:20:30 2022 +0800]","Body":"Change masterKeyCache to dynamic size (#3522)\n\n","Date":"Tue Oct 25 10:20:30 CEST 2022"},{"Commit-ID":"commit ec79daa6c7c55ce0f1f50a8231aea18b80787937 1666711547 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Oct 25 08:25:47 2022 -0700]","Body":"Single thread executor should not have max capacity by default (#3575)\n\n* Single thread executor should not have max capacity by default\r\n\r\n* Fixed checkstyle\r\n\r\n* Fixed throwing interrupted exception\r\n\r\n* Same on poll()","Date":"Tue Oct 25 17:25:47 CEST 2022"},{"Commit-ID":"commit 1704ca43d6be0a49c7a311e9c42cd696f76c59ff 1666752763 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Wed Oct 26 10:52:43 2022 +0800]","Body":"skip replicasCheck when replication disabled (#3563)\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\nWhen disabled replication by the BookKeeper shell, the `replicasCheckTask` doesn't check the `replication disabled` flag and keeps checking the ledger replicas, which will lead to more disk IO.\r\n\r\n### Changes\r\nCheck the `replication disabled` flag before running `replicasCheckTask`\r\n\r\n(Describe: what changes you have made)\r\n\r\n","Date":"Wed Oct 26 04:52:43 CEST 2022"},{"Commit-ID":"commit e169cbd3f5785d107beff115056ce2068e0e45ba 1666757071 -----sp","Author":"PersonIdent[gaozhangmin, gaozhangmin456@qq.com, Wed Oct 26 12:04:31 2022 +0800]","Body":"Add new api resumeCompaction and suspendCompaction to support resume and suspend compaction through api (#3509)\n\n### Motivation\r\nCompaction would bring high disk io util, It would better allowing to control suspending and resuming compaction through api\r\n\r\n### Changes\r\nAdd two apis to control resuming and suspending compaction.\r\n`/api/v1/bookie/gc/suspend_compaction`\r\n`/api/v1/bookie/gc/resume_compaction`\r\n","Date":"Wed Oct 26 06:04:31 CEST 2022"},{"Commit-ID":"commit 3a4af4a806821eb6a4040458332bb8e98b1cb4eb 1666766828 -----sp","Author":"PersonIdent[Qiang Huang, epoch2022@163.com, Wed Oct 26 14:47:08 2022 +0800]","Body":"remove unused variable in checkEnvironment (#3572)\n\n","Date":"Wed Oct 26 08:47:08 CEST 2022"},{"Commit-ID":"commit da4583e9390352d3414cc1b954591926034431bb 1666795392 -----sp","Author":"PersonIdent[FeiFan Wang, zoltar9264@163.com, Wed Oct 26 22:43:12 2022 +0800]","Body":"[configuration] fix typo in bk_server.conf (#3574)\n\n","Date":"Wed Oct 26 16:43:12 CEST 2022"},{"Commit-ID":"commit e50cf06ce208989c3c295a518f3e0a2da8e5abc9 1666834439 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Thu Oct 27 09:33:59 2022 +0800]","Body":"Add example for multiple server list in metadataServiceUri configuration (#3580)\n\n### Motivation\r\nWhen users configure multiple servers for `metadataServiceUri`, they will be confused about how to separate the server list.\r\n\r\n### Changes\r\nAdd an example to explain how to configure multiple servers for `metadataServiceUri`\r\n","Date":"Thu Oct 27 03:33:59 CEST 2022"},{"Commit-ID":"commit b7af1e9240d1430366c05de11963d41d91885064 1666835427 -----sp","Author":"PersonIdent[fengyubiao, 9947090@qq.com, Thu Oct 27 09:50:27 2022 +0800]","Body":"[doc]Fixed incorrect checkstyle configuration prompts (#3571)\n\n### Motivation\r\n\r\nThe property name of `checkstyle suppressions` already changed in the PR https://github.com/apache/bookkeeper/pull/2817/files#diff-f295bca9ef0353572bbaeaeaa17061f524e9236ac46763c836ed779dee99935e, but web site still recommends the old\r\n\r\n<img width=\"855\" alt=\"截屏2022-10-25 10 36 05\" src=\"https://user-images.githubusercontent.com/25195800/197669021-6c6e0a59-3ee3-4800-bb32-b83cd091cba1.png\">\r\n\r\n\r\n\r\n\r\n\r\n<img width=\"1354\" alt=\"截屏2022-10-25 10 33 46\" src=\"https://user-images.githubusercontent.com/25195800/197668603-d1faac1e-393b-4328-9eb8-039b9c2346e9.png\">\r\n\r\n### Changes\r\n\r\nSince this configuration has a default setting, change the doc-line to \"Click Next -> Finish\".\r\n","Date":"Thu Oct 27 03:50:27 CEST 2022"},{"Commit-ID":"commit 4c79215af5ec02bd99729f4964d87e70755bcc67 1666836112 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Thu Oct 27 10:01:52 2022 +0800]","Body":"Fix the typo of double the (#3552)\n\n### Changes\r\nFix the typo of double the","Date":"Thu Oct 27 04:01:52 CEST 2022"},{"Commit-ID":"commit 520c3e441996f58a31351692b472f8189e26aa21 1666845376 -----sp","Author":"PersonIdent[gaozhangmin, gaozhangmin456@qq.com, Thu Oct 27 12:36:16 2022 +0800]","Body":"[test] Fix flaky test testAutoRecoverySessionLoss (#3576)\n\nFix flaky tests:\r\nhttps://github.com/apache/bookkeeper/actions/runs/3279561577/jobs/5399266347\r\n\r\nUse `Awaitility.await()` wait until the election is done.\r\n\r\n\r\n```\r\norg.apache.bookkeeper.replication.AutoRecoveryMainTest.testAutoRecoverySessionLoss  Time elapsed: 1.65 s  <<< ERROR!\r\njava.lang.NullPointerException\r\n\tat org.apache.bookkeeper.replication.AutoRecoveryMainTest.testAutoRecoverySessionLoss(AutoRecoveryMainTest.java:119)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n\tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)\r\n\tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n\tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)\r\n\tat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)\r\n\tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)\r\n\tat org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n\tat org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)\r\n\tat org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)\r\n\tat java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\r\n\r\n```","Date":"Thu Oct 27 06:36:16 CEST 2022"},{"Commit-ID":"commit 5a9fb5ff44cfd710f2d60e0978e774d08455713f 1666852599 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Thu Oct 27 14:36:39 2022 +0800]","Body":"Replace sleep with await to avoid flaky test in SlowBookieTest (#3581)\n\n### Motivation\r\nThere is a lot of `Thread.sleep()` in Bookie tests, which may lead to flaky tests.\r\n\r\n### Changes\r\nReplace sleep with await to avoid flaky test in SlowBookieTest\r\n","Date":"Thu Oct 27 08:36:39 CEST 2022"},{"Commit-ID":"commit ace4f8a4a3ff271148ce2fa608e8a553759db17d 1666854341 -----sp","Author":"PersonIdent[fengyubiao, yubiao.feng@streamnative.io, Thu Oct 27 15:05:41 2022 +0800]","Body":"Upgrade dependencies for CVE-2022-3171 and CVE-2022-42003 (#3579)\n\n### Motivation\r\n\r\n[CVE-2022-3171](https://ubuntu.com/security/CVE-2022-3171)\r\n[CVE-2022-42003](https://github.com/FasterXML/jackson-databind/commit/d78d00ee7b5245b93103fef3187f70543d67ca33)\r\n\r\n<img width=\"998\" alt=\"截屏2022-10-26 10 46 13\" src=\"https://user-images.githubusercontent.com/25195800/197922540-fa58ae0a-7bc4-4c62-91b5-61209090552c.png\">\r\n\r\n\r\n### Changes\r\n- upgrade `jackson.version` from `2.13.4 -> 2.14.0-rc1` \r\n- upgrade `protobuf.version` from `2.19.2 -> 3.19.6` ","Date":"Thu Oct 27 09:05:41 CEST 2022"},{"Commit-ID":"commit ef31c7a37415c063b2f485f63198ec28e8f9f0fa 1666854386 -----sp","Author":"PersonIdent[fengyubiao, yubiao.feng@streamnative.io, Thu Oct 27 15:06:26 2022 +0800]","Body":"When call openLedgerOp, make the timeout ex is a separate error code (#3562)\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\nWhen we execute `bkClient.openLedger(ledgerId)`, the execution flow is as follows：\r\n\r\n1. start opening the ledger\r\n2. get ledger meta\r\n3. read the last confirmed entry\r\n4. open ledger success\r\n\r\nIf we get the correct ledgerMeta at step 2, this means that this ledger has not been deleted. If step 3 times out, we should try again to make sure the ledger exists until we get a clear response from the BK server.<strong>(High light)<\/strong>However, in the current implementation, the timeout exception is rewritten as a `LedgerRecoveryException`, making it impossible to determine whether we should retry.\r\n\r\nLog:\r\n```\r\nOct 17, 2022 22:54:05.818 [BookKeeperClientWorker-OrderedExecutor-16-0] ERROR org.apache.bookkeeper.client.ReadLastConfirmedOp - While readLastConfirmed ledger: 59158316 did not hear success responses from all quorums, QuorumCoverage(e:2,w:2,a:2) = [-23, -23]\r\nOct 17, 2022 22:54:05.818 [BookKeeperClientWorker-OrderedExecutor-16-0] INFO org.apache.bookkeeper.mledger.impl.ManagedCursorImpl - [order/org-217/persistent/p1010-tx] Opened ledger 59158316 for consumer order-service. rc=-10\r\n```\r\n\r\nLooking at the ledger metadata:\r\n```\r\nLedgerMetadata{formatVersion=3, ensembleSize=2, writeQuorumSize=2, ackQuorumSize=2, state=IN_RECOVERY, digestType=CRC32C, password=base64:, ensembles={0=[***:3181, ***:3181]}, customMetadata={component=***, pulsar/managed-ledger=***, pulsar/cursor=***, application=***}}\r\n```\r\n\r\nsee also: https://github.com/apache/pulsar/pull/18123\r\n\r\n### Changes\r\n\r\n- When calling openLedgerOp, do not rewritten `TiemoutException` as a `LedgerRecoveryException`\r\n- add the dependency: `junit4-dataprovider`\r\n- use `@DataProvider` to simpler the test case \"testOpenLedgerRecover\" & \"testOpenLedgerNoRecover\"\r\n","Date":"Thu Oct 27 09:06:26 CEST 2022"},{"Commit-ID":"commit 8ac28db16118e5415c041f8da8cca73777971ce6 1667038351 -----sp","Author":"PersonIdent[zhaohaidao, zhaohaidao2008@hotmail.com, Sat Oct 29 18:12:31 2022 +0800]","Body":"Issue 3588: write meta to log header before fsync in DirectIO mode (#3589)\n\n","Date":"Sat Oct 29 12:12:31 CEST 2022"},{"Commit-ID":"commit ca922fed05dc0d4cb11e936f61c400fe967eab7f 1667182673 -----sp","Author":"PersonIdent[zhaohaidao, zhaohaidao2008@hotmail.com, Mon Oct 31 10:17:53 2022 +0800]","Body":"Fix typo issue when Header.assertFingerPrint throws IOException (#3590)\n\n### Motivation\r\n\r\nFix typo issue when Header.assertFingerPrint throws IOException\r\n\r\n### Changes\r\n\r\nFix typo issue when Header.assertFingerPrint throws IOException","Date":"Mon Oct 31 03:17:53 CET 2022"},{"Commit-ID":"commit 75a293b77ccc878036318a8a2d50ac8f9ed9dcc5 1667250010 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Tue Nov 1 05:00:10 2022 +0800]","Body":"add javadoc comments for test classes (#3587)\n\n","Date":"Mon Oct 31 22:00:10 CET 2022"},{"Commit-ID":"commit 9efd606d1cf1a2f4573606335490548f59b083c2 1667250097 -----sp","Author":"PersonIdent[gaozhangmin, gaozhangmin456@qq.com, Tue Nov 1 05:01:37 2022 +0800]","Body":"Correct link class name (#3594)\n\nCo-authored-by: gavingaozhangmin <gavingaozhangmin@didiglobal.com>","Date":"Mon Oct 31 22:01:37 CET 2022"},{"Commit-ID":"commit 96b2446b3521f83932239df64d546819519df566 1667252550 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Tue Nov 1 05:42:30 2022 +0800]","Body":"fix memtable getEntryStats typo (#3592)\n\n","Date":"Mon Oct 31 22:42:30 CET 2022"},{"Commit-ID":"commit 02be9d2ee28cd7c4a1895fc8494db96381484a20 1667275542 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon Oct 31 21:05:42 2022 -0700]","Body":"Avoid extra buffer to prepend frame size (#3560)\n\n* Avoid extra buffer to prepend frame size\r\n\r\n* Fixed checkstyle\r\n\r\n* Fixed touch methods on ReadResponse\r\n\r\n* Fixed frame size for protobuf requests\r\n\r\n* Removed unwanted changes\r\n\r\n* Fixed AuthResponse in v2 protocol\r\n\r\n* Fixed test","Date":"Tue Nov 01 05:05:42 CET 2022"},{"Commit-ID":"commit faaf041ac5422ab1d4e46c123084202f48ea6aa8 1667319875 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Wed Nov 2 00:24:35 2022 +0800]","Body":"Fix ByteBuf memory leak problem when setExplicitLac (#3577)\n\n* fix set explicitLac no released entry","Date":"Tue Nov 01 17:24:35 CET 2022"},{"Commit-ID":"commit e6722848e0a599f215e68e1340196c9dfe8e906e 1667326745 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Wed Nov 2 02:19:05 2022 +0800]","Body":"Optimized debug log enable (#3596)\n\n* Optimized debug log enable\r\n\r\n* Unified debug log enable","Date":"Tue Nov 01 19:19:05 CET 2022"},{"Commit-ID":"commit 6e7ff78e7c24d71a17508144354f244c96150a69 1667344933 -----sp","Author":"PersonIdent[zhaohaidao, zhaohaidao2008@hotmail.com, Wed Nov 2 07:22:13 2022 +0800]","Body":"Fix readEntryStats typo (#3591)\n\n","Date":"Wed Nov 02 00:22:13 CET 2022"},{"Commit-ID":"commit 9843ad62c95cc6d975da8a0be9bccc8e2850bf3f 1667403658 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Wed Nov 2 23:40:58 2022 +0800]","Body":"Add ByteBuf refCnt test for AddEntry and use pooled ByteBuf reduce heap usage (#3598)\n\n* Fix ByteBuf memory leak problem when addEntryInternal\r\n\r\n* fix checkstyle\r\n\r\n* use pooled ByteBuf","Date":"Wed Nov 02 16:40:58 CET 2022"},{"Commit-ID":"commit 2c5d98ebbe1ff8e935c4efd29aa92f37341452ec 1667410251 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Nov 2 10:30:51 2022 -0700]","Body":"Removed the necessity of SafeRunnable (#3593)\n\n* Removed the necessity of SafeRunnable\r\n\r\n* Fixed conflicts\r\n\r\n* Removed unused imports\r\n\r\n* Fixed missing import\r\n\r\n* Fixed checkstyle\r\n\r\n* Fixed merge conflict","Date":"Wed Nov 02 18:30:51 CET 2022"},{"Commit-ID":"commit b82e2247e67d6a2b3f2f8cb76bc2b0a7c733b5c5 1667410262 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Nov 2 10:31:02 2022 -0700]","Body":"Allow to use IO uring instead of epoll (#3595)\n\n* Allow to use IO uring instead of epoll\r\n\r\n* Removed unused import\r\n\r\n* Fixed license file\r\n\r\n* Fixed license file","Date":"Wed Nov 02 18:31:02 CET 2022"},{"Commit-ID":"commit 396ec12dc747fc21105d65f13d2dedace247d1a2 1667410971 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Nov 2 10:42:51 2022 -0700]","Body":"Optimize ReadResponse for small entry sizes (#3597)\n\n* Optimize ReadResponse for small entry sizes\r\n\r\n* Fixed checkstyle","Date":"Wed Nov 02 18:42:51 CET 2022"},{"Commit-ID":"commit 5724bc8434a4d6903487221d39713f39a4bcb6b4 1667466283 -----sp","Author":"PersonIdent[gaozhangmin, gaozhangmin456@qq.com, Thu Nov 3 17:04:43 2022 +0800]","Body":"Using a separate thread pool to execute openWithMetadata (#3548)\n\n","Date":"Thu Nov 03 10:04:43 CET 2022"},{"Commit-ID":"commit 860d40d58ca0eea1eaca2ddb81b43cb80447ae73 1667545241 -----sp","Author":"PersonIdent[LinChen, 1572139390@qq.com, Fri Nov 4 15:00:41 2022 +0800]","Body":" update doc about flushInterval config (#3601)\n\n* update flushInterval doc","Date":"Fri Nov 04 08:00:41 CET 2022"},{"Commit-ID":"commit 43bdfb35317d9a69840d17df94c5c801a4cbba62 1667800138 -----sp","Author":"PersonIdent[xiang092689, 58943501+xiang092689@users.noreply.github.com, Mon Nov 7 13:48:58 2022 +0800]","Body":"migrate apply-config-from-env.py from python2 to python3 (#3614)\n\nFix #3549\r\n\r\nDescriptions of the changes in this PR:\r\nmigrate apply-config-from-env.py from python2 to python3\r\nfix docker/Dockerfile\r\n\r\n### Motivation\r\n\r\nIssue 3549: migrate apply-config-from-env.py from python2 to python3\r\n\r\n### Changes\r\n\r\nadd newline character, and reformat for docker/Dockerfile\r\nchange print to print()\r\n\r\nMaster Issue: 3549","Date":"Mon Nov 07 06:48:58 CET 2022"},{"Commit-ID":"commit 8357e4b00f0b2244dbe7648302dd02d930e5ecb7 1667956139 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Tue Nov 8 17:08:59 2022 -0800]","Body":"[log] Add journal file path that caused failure in multi-journal config (#3623)\n\n### Motivation\r\n\r\nRight now, if bookie fails to replay the journal then it logs journal-txn-id but it doesn't log journal dir path. It will be useful if bookie prints journal path along with journal-dir in case if user is using multi-journal directories so, user can troubleshoot the issue and fix it correctly.\r\n\r\n```\r\n2022-11-07T18:29:07,205+0000 [main] ERROR org.apache.bookkeeper.bookie.Bookie - Exception while replaying journals, shutting down\r\njava.io.IOException: Recovery log 1667603421612 is missing\r\n        at org.apache.bookkeeper.bookie.Bookie.replay(Bookie.java:932) ~[org.apache.bookkeeper-bookkeeper-server-4.12.jar:4.12]\r\n        at org.apache.bookkeeper.bookie.Bookie.readJournal(Bookie.java:911) ~[org.apache.bookkeeper-bookkeeper-server-4.12.jar]\r\n```\r\n\r\n### Changes\r\n\r\nAdd journal dir file path in journal replay failure.\r\n\r\n\r\n","Date":"Wed Nov 09 02:08:59 CET 2022"},{"Commit-ID":"commit 74e9ef4d732622fba6cf023cc26ce9a07e066af0 1667956166 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Wed Nov 9 09:09:26 2022 +0800]","Body":"Fix GetBookieInfo failed event stats (#3622)\n\n### Motivation\r\n\r\nIn `GetBookieInfoProcessorV3`, even if throw `IOException` and get DiskSpace failed, it will still `registerSuccessfulEvent`, which is wrong, we should `registerFailedEvent`.\r\n\r\n### Changes\r\n\r\n1. registerFailedEvent when get DiskSpace failed.\r\n2. add unit test.\r\n","Date":"Wed Nov 09 02:09:26 CET 2022"},{"Commit-ID":"commit 94f247c5a3f042fa45823c0bb2eee3c688ff82a5 1667980765 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Wed Nov 9 15:59:25 2022 +0800]","Body":"Upgrade maven version in release docker image (#3625)\n\n---\r\n\r\n*Motivation*\r\n\r\nWhen using the lower maven version to build bookkeeper, we will meet the license problem in the binary package.\r\n\r\n```\r\nch.qos.logback-logback-classic-1.2.10.jar unaccounted for in LICENSE\r\nch.qos.logback-logback-core-1.2.10.jar unaccounted for in LICENSE\r\nio.netty-netty-tcnative-2.0.48.Final.jar unaccounted for in LICENSE\r\nio.netty-netty-transport-native-epoll-4.1.75.Final.jar unaccounted for in LICENSE\r\n```\r\n\r\n","Date":"Wed Nov 09 08:59:25 CET 2022"},{"Commit-ID":"commit 830116280ff6fb04ef330a1f01e0a009060ae507 1668010745 -----sp","Author":"PersonIdent[Diego Salvi, lothruin.mirwen@gmail.com, Wed Nov 9 17:19:05 2022 +0100]","Body":"Issue #3488 Create an EmbeddedSever extracting code from Main class and adding a builder pattern (#3489)\n\n","Date":"Wed Nov 09 17:19:05 CET 2022"},{"Commit-ID":"commit a9d40822afd48e5e84988e0a41b6140923fb304d 1668274363 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Sun Nov 13 01:32:43 2022 +0800]","Body":"Include bkperf into bk all package (#3632)\n\n","Date":"Sat Nov 12 18:32:43 CET 2022"},{"Commit-ID":"commit f8b9e1886d1f6a806150e450cc525933f6c9063f 1668389056 -----sp","Author":"PersonIdent[Aditya Kumbhar, 31104730+aditya-kumbhar@users.noreply.github.com, Sun Nov 13 19:24:16 2022 -0600]","Body":"Use LinkedHashMap instead of HashMap to fix flaky tests due non-deterministic order (#3551)\n\n### Motivation\r\n\r\nAuditorReplicasCheckTest has the following tests that are flaky, detected using the [NonDex](https://github.com/TestingResearchIllinois/NonDex) tool.\r\ntestReplicasCheckForLedgersFoundHavingLessThanAQReplicasOfAnEntry()\r\ntestReplicasCheckForLedgersFoundHavingLessThanWQReplicasOfAnEntry()\r\ntestReplicasCheckForLedgersFoundHavingNoReplica()\r\ntestReplicasCheckForLedgersWithEmptySegments()\r\n\r\nThe tests fail due to non-deterministic ordering in the HashMap `segmentEnsembles`\r\nThe following check fails in the `newEnsembleEntry()` method since it assumes the ordering of `segmentEnsembles` to be deterministic:\r\n```\r\ncheckArgument(ensembles.isEmpty() || firstEntry > ensembles.lastKey(),\r\n                      \"New entry must have a first entry greater than any existing ensemble key\");\r\n```\r\nFixes #3550 \r\n\r\nCommand to reproduce:\r\n```\r\nmvn -pl bookkeeper-server edu.illinois:nondex-maven-plugin:1.1.2:nondex -Dtest=org.apache.bookkeeper.replication.AuditorReplicasCheckTest\r\n```\r\n\r\n### Changes\r\n\r\nChanged the datatype of `segmentEnsembles` from HashMap to [LinkedHashMap](https://docs.oracle.com/javase/8/docs/api/java/util/LinkedHashMap.html) as it has a deterministic iteration order, while [HashMap](https://docs.oracle.com/javase/8/docs/api/java/util/HashMap.html) does not guarantee the order of its elements.\r\nThe tests pass with NonDex after making this change.\r\n","Date":"Mon Nov 14 02:24:16 CET 2022"},{"Commit-ID":"commit 0d2fbe434ec2412a166103ebf7fe9c28ecfc48f6 1668389275 -----sp","Author":"PersonIdent[zhaohaidao, zhaohaidao2008@hotmail.com, Mon Nov 14 09:27:55 2022 +0800]","Body":"Apply recycle logic during add entry creation but ledger close to LedgerHandleAdv (#3621)\n\nDescriptions of the changes in this PR:\r\nApply recycle logic during add entry creation but ledger close to LedgerHandleAdv\r\n\r\n### Motivation\r\nThis pr is a supplement to #3321\r\nIf I understand correctly. these recycled logic should be applied to LedgerHandleAdv","Date":"Mon Nov 14 02:27:55 CET 2022"},{"Commit-ID":"commit 0f37dd8756ef357081e8b2e6ff0e1475721b79a3 1668394215 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Mon Nov 14 10:50:15 2022 +0800]","Body":"Add 4.15.3 relese note (#3602)\n\n* Add 4.15.3 relese note\r\n---\r\n\r\n*Motivation*\r\n\r\nAdd 4.15.3 release note\r\n\r\n","Date":"Mon Nov 14 03:50:15 CET 2022"},{"Commit-ID":"commit 17dbd5029611de4a9554828272613c1698204e1d 1668477207 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Tue Nov 15 09:53:27 2022 +0800]","Body":"Generate 4.15.3 website docs (#3635)\n\n---\r\n\r\n### Motivation\r\n\r\nGenerate the 4.15.3 website docs.","Date":"Tue Nov 15 02:53:27 CET 2022"},{"Commit-ID":"commit fbad323775f72ae2e8154892b489801305860bb1 1668500954 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Tue Nov 15 16:29:14 2022 +0800]","Body":"Upgrade docker image version to fix CVEs (#3640)\n\n### Motivation\r\nThere are a lot of critical CVEs in the `maven:3.8.6-jdk-11` docker image\r\nhttps://snyk.io/test/docker/maven%3A3.8.6-jdk-11\r\n\r\n### Changes\r\nUse `maven:3.8.3-eclipse-temurin-11` instead of `maven:3.8.6-jdk-11` to fix it.","Date":"Tue Nov 15 09:29:14 CET 2022"},{"Commit-ID":"commit e4ef0ef7f4f989e46f854c92ac7684325f050a60 1668502112 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Tue Nov 15 09:48:32 2022 +0100]","Body":"[website] Fix releases page header and move latest release to 4.15.3 (#3645)\n\n","Date":"Tue Nov 15 09:48:32 CET 2022"},{"Commit-ID":"commit a3401a2139a554a8fbe52c8a398eeb4e51a8dad1 1668691238 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Thu Nov 17 21:20:38 2022 +0800]","Body":"make rocksdb delete entries batch size configurable (#3646)\n\n","Date":"Thu Nov 17 14:20:38 CET 2022"},{"Commit-ID":"commit 696919cccb2a4d030dab8e7d91e4b72f9a69d302 1668759382 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Fri Nov 18 16:16:22 2022 +0800]","Body":"bring back deleteRange for RocksDB to improve location delete performance (#3653)\n\n### Motivation\r\nThe entry log location index deletion is deleted in batches one by one currently, and it will have low performance. Refer to: https://github.com/apache/bookkeeper/pull/3646\r\n\r\nMatteo has introduced deleteRange API a few years ago, but rollback due to RocksDB delete ranges bug. https://github.com/apache/bookkeeper/pull/1620.  The RocksDB bug has been addressed since 5.18.0 https://github.com/facebook/rocksdb/blob/main/HISTORY.md#5180-2018-11-30. We can bring the `deleteRange` API back to improve the entry log location deletion performance.\r\n\r\n### Changes\r\nBring `deleteRange` API back for entry log location deletion.","Date":"Fri Nov 18 09:16:22 CET 2022"},{"Commit-ID":"commit 034e8997ab43850d2968d8780abf9bb6e57dabd5 1669016837 -----sp","Author":"PersonIdent[gaozhangmin, gaozhangmin456@qq.com, Mon Nov 21 15:47:17 2022 +0800]","Body":"bookkeeper-daemon script supports restart command (#3649)\n\n### Motivation\r\n\r\nbookkeeper-daemon script supports restart command","Date":"Mon Nov 21 08:47:17 CET 2022"},{"Commit-ID":"commit 948d94fb652d33e714eea39820a8fbf64080b261 1669258263 -----sp","Author":"PersonIdent[gaozhangmin, gaozhangmin456@qq.com, Thu Nov 24 10:51:03 2022 +0800]","Body":"Dont validate CompactionInterval when compaction is disabled (#3664)\n\n### Motivation\r\nCurrently, We cannot disable minorCompaction and majorCompaction by setting interval to -1, with `gcWaitTime` is  enabled.\r\n\r\n### Changes\r\nDon't validate CompactionInterval if compaction is disabled\r\n","Date":"Thu Nov 24 03:51:03 CET 2022"},{"Commit-ID":"commit 221cba4ed32980e6e3109e9b9cca7e380b64ee65 1669258392 -----sp","Author":"PersonIdent[Qiang Zhao, mattisonchao@apache.org, Thu Nov 24 10:53:12 2022 +0800]","Body":"Check client if closed when complete callback. (#3661)\n\n### Motivation\r\n\r\nFollow the same rules to complete the callback to avoid Bookkeeper client operations being allowed even after its closure.\r\n\r\n### Changes\r\n\r\n- Use `bk.getReturnRc(rc)` check the client state.","Date":"Thu Nov 24 03:53:12 CET 2022"},{"Commit-ID":"commit 7d44414484450dd73d2b1ef067c135284950dbf5 1669352830 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Fri Nov 25 13:07:10 2022 +0800]","Body":"sync depedency version with source version in license (#3633)\n\n### Motivation\r\nIn the license file, the dependency source versions are not sync with the dependency version.\r\n\r\n### Changes\r\nSync the dependency version with the source version in license files.","Date":"Fri Nov 25 06:07:10 CET 2022"},{"Commit-ID":"commit c2e59e14115d1e1b67e0fcbad4d44ee904be27cf 1669353788 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Thu Nov 24 21:23:08 2022 -0800]","Body":"Add Http-service to check bookie sanity state (#3630)\n\n### Motivation\r\n\r\nRight now, if Bookie startup or process fails due to various reasons then bookie getState() rest API still gives a successful response even though bookie writes are not going through. Therefore. Bookie should have a REST API to check bookie sanity test and that can be used to check bookie liveliness in k8/helm-chart or to plot bookie health graph.\r\n\r\n### Changes\r\n\r\nAdd Bookie REST API to check bookie health to validate bookie liveliness","Date":"Fri Nov 25 06:23:08 CET 2022"},{"Commit-ID":"commit 145ab158944fc28c1b4c3aaa5067d87e846d1fcb 1669357635 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Fri Nov 25 14:27:15 2022 +0800]","Body":"fix testWriteLac (#3627)\n\n### Motivation\r\n\r\ntestWriteLac recently became flaky-test: \r\nhttps://github.com/apache/bookkeeper/actions/runs/3424530676/jobs/5704307573#logs\r\n\r\n1. Before the entry added the journal entry queue, entry.retain() will be executed.\r\n2. So add a callback function to ensure that the entry is verified after the entry is executed done in the journal entry queue.\r\n\r\n\r\n```java\r\n    public void logAddEntry(long ledgerId, long entryId, ByteBuf entry,\r\n                            boolean ackBeforeSync, WriteCallback cb, Object ctx)\r\n            throws InterruptedException {\r\n        // Retain entry until it gets written to journal\r\n        entry.retain();\r\n        ......\r\n    }\r\n```","Date":"Fri Nov 25 07:27:15 CET 2022"},{"Commit-ID":"commit 381af55b698c2c6e2ba691f43864434af7568fdd 1669357664 -----sp","Author":"PersonIdent[gaozhangmin, gaozhangmin456@qq.com, Fri Nov 25 14:27:44 2022 +0800]","Body":"Include com.google.guava:failureaccess in shaded package (#3624)\n\nFixes #3606","Date":"Fri Nov 25 07:27:44 CET 2022"},{"Commit-ID":"commit aa6d3f9efe75d52008f4624df89444c5461863de 1669371426 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Fri Nov 25 11:17:06 2022 +0100]","Body":"Run CI when a pull request contains doc changes (#3671)\n\n* Run CI when a pull request contains doc changes\r\n\r\n* Push filters","Date":"Fri Nov 25 11:17:06 CET 2022"},{"Commit-ID":"commit dd8ba477ee1f7b376869777ecf37463e8d2edec5 1669375688 -----sp","Author":"PersonIdent[Yuri Mizushima, yumizush@yahoo-corp.jp, Fri Nov 25 20:28:08 2022 +0900]","Body":"Exit bookkeeper shell correctly even if fails to run for some reason (#3663)\n\n* fix: close legacyLM and longLM if call HierarchicalLedgerManager#close\r\n\r\n* fix: exit as ok when calling listledgers command and get NoSuchLedgerExistsOnMetadataServerException\r\n\r\n* fix: call exit even if get some exception in bookkeeler shell","Date":"Fri Nov 25 12:28:08 CET 2022"},{"Commit-ID":"commit 109688c1b460621d636d601580a407b721ca282a 1669556140 -----sp","Author":"PersonIdent[Qiang Huang, qiang.huang1991@gmail.com, Sun Nov 27 21:35:40 2022 +0800]","Body":"[fix][server]fix memory leak when operating ledger metadata (#3662)\n\n* [fix][server]fix memory leak when operating ledger metadata","Date":"Sun Nov 27 14:35:40 CET 2022"},{"Commit-ID":"commit 25f03a046b65b1f3db61bf8d23b5611fea3f33fb 1669705518 -----sp","Author":"PersonIdent[StevenLuMT, lsj_sdjzu@126.com, Tue Nov 29 15:05:18 2022 +0800]","Body":"InterleavedLedgerStorage: safe release ByteBuf (#3674)\n\nCo-authored-by: lushiji <lushiji@didiglobal.com>","Date":"Tue Nov 29 08:05:18 CET 2022"},{"Commit-ID":"commit 8fce024989ea0427877cb8981fcb94f7afadc3c7 1669705632 -----sp","Author":"PersonIdent[Qiang Huang, qiang.huang1991@gmail.com, Tue Nov 29 15:07:12 2022 +0800]","Body":"[refactor][bookkeeper] Refactor ByteBuf release method in DefaultEntryLogger (#3673)\n\n","Date":"Tue Nov 29 08:07:12 CET 2022"},{"Commit-ID":"commit 01232c94c91759a175345e8c055951e5cc6091dd 1669772083 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Wed Nov 30 09:34:43 2022 +0800]","Body":"Enhance simple test (#3675)\n\n### Motivation\r\nFixes #3670 ","Date":"Wed Nov 30 02:34:43 CET 2022"},{"Commit-ID":"commit ac7e9092aebe9fc7e7e16832ae3fc1d2bbd91fc4 1669940362 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Fri Dec 2 08:19:22 2022 +0800]","Body":"clean code: remove unused gcExecutor (#3682)\n\n","Date":"Fri Dec 02 01:19:22 CET 2022"},{"Commit-ID":"commit f186d2a0a2e8149672c44aa1eb51b863b0d31395 1670153506 -----sp","Author":"PersonIdent[StevenLuMT, lsj_sdjzu@126.com, Sun Dec 4 19:31:46 2022 +0800]","Body":"module bookkeeper-server: refactor ByteBuf release usage (#3688)\n\nCo-authored-by: lushiji <lushiji@didiglobal.com>","Date":"Sun Dec 04 12:31:46 CET 2022"},{"Commit-ID":"commit 324b8d43ab47f1a9bf681abaa8ab486c00d331a5 1670153531 -----sp","Author":"PersonIdent[Qiang Huang, qiang.huang1991@gmail.com, Sun Dec 4 19:32:11 2022 +0800]","Body":"[refactor][bookkeeper] Refactor ByteBuf release method in stream/statelib (#3689)\n\n* refactor ByteBuf release usage","Date":"Sun Dec 04 12:32:11 CET 2022"},{"Commit-ID":"commit 542926c1637c2dc295d4ccea16d9e266d1328cf4 1670204593 -----sp","Author":"PersonIdent[LinChen, 1572139390@qq.com, Mon Dec 5 09:43:13 2022 +0800]","Body":"remove unused attempts (#3685)\n\n### Motivation\r\nremove unused variable attempts:\r\nhttps://github.com/apache/bookkeeper/blob/01232c94c91759a175345e8c055951e5cc6091dd/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectReader.java#L209-L215\r\n","Date":"Mon Dec 05 02:43:13 CET 2022"},{"Commit-ID":"commit 9d8b922708162549f2977c75fc9b63a0712bffce 1670209678 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Mon Dec 5 11:07:58 2022 +0800]","Body":"Add an argument to decide expose the default JVM metrics (#3676)\n\n---\r\n\r\n### Motivation\r\n\r\nExpose the default JVM Metrics or not. If you are using the\r\nBookKeeper as an embedded service and you want to expose metrics\r\nin your application, you might need to disable this to avoid the\r\nJVM metrics register duplicated.\r\n\r\n### Modification\r\n\r\n- Add a configuration variable to decide whether or not to expose the\r\nJVM metrics","Date":"Mon Dec 05 04:07:58 CET 2022"},{"Commit-ID":"commit 7ae5a04a83984f1731781c7892613e8932d2f62e 1670311281 -----sp","Author":"PersonIdent[StevenLuMT, lsj_sdjzu@126.com, Tue Dec 6 15:21:21 2022 +0800]","Body":"module distributedlog-core: refactor ByteBuf release usage (#3691)\n\nCo-authored-by: lushiji <lushiji@didiglobal.com>","Date":"Tue Dec 06 08:21:21 CET 2022"},{"Commit-ID":"commit e13ff85234dc9b78e0d9897b483b0db0e1209595 1670311342 -----sp","Author":"PersonIdent[Qiang Huang, qiang.huang1991@gmail.com, Tue Dec 6 15:22:22 2022 +0800]","Body":"refactor ByteBuf release usage (#3687)\n\n","Date":"Tue Dec 06 08:22:22 CET 2022"},{"Commit-ID":"commit 394ff12dc180c351227f28ce31031e74b96f4352 1670379605 -----sp","Author":"PersonIdent[gaozhangmin, gaozhangmin456@qq.com, Wed Dec 7 10:20:05 2022 +0800]","Body":"Show result of isFenced in log (#3678)\n\nLog `isFenced`, output to  log file","Date":"Wed Dec 07 03:20:05 CET 2022"},{"Commit-ID":"commit eda9c4284d434cdc4d94637f6257a1c6bf179745 1670382001 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Wed Dec 7 11:00:01 2022 +0800]","Body":"use READ_ENTRY_SCHEDULING_DELAY to stable stickyReadsWithFailures (#3628)\n\n### Motivation\r\nI found the following flaky-test: org.apache.bookkeeper.bookie.BookieStickyReadsTest.stickyReadsWithFailures:\r\nhttps://github.com/apache/bookkeeper/actions/runs/3367374609/jobs/5584792353\r\n```\r\nError:  Tests run: 4, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 8.925 s <<< FAILURE! - in org.apache.bookkeeper.bookie.BookieStickyReadsTest\r\nError:  org.apache.bookkeeper.bookie.BookieStickyReadsTest.stickyReadsWithFailures  Time elapsed: 1.752 s  <<< ERROR!\r\njava.lang.IndexOutOfBoundsException: Index: -1, Size: 3\r\n\tat java.base/java.util.LinkedList.checkElementIndex(LinkedList.java:559)\r\n\tat java.base/java.util.LinkedList.get(LinkedList.java:480)\r\n\tat org.apache.bookkeeper.test.BookKeeperClusterTestCase.serverByIndex(BookKeeperClusterTestCase.java:369)\r\n\tat org.apache.bookkeeper.bookie.BookieStickyReadsTest.stickyReadsWithFailures(BookieStickyReadsTest.java:153)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n\tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)\r\n\tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n\tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)\r\n\tat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)\r\n\tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)\r\n\tat org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n\tat org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)\r\n\tat org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)\r\n\tat java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\r\n\tat java.base/java.lang.Thread.run(Thread.java:829)\r\n```\r\n\r\nIn the stickyReadsWithFailures test, the client successfully reads the entry, but the `READ_ENTRY_REQUEST` metric does not get bonuses. After reading the `READ_ENTRY_REQUEST`update logic, I found the metric updating after netty channel sends the response successfully, the metric is updated through the `ChannelFutureListener` callback, and the asynchronous update causes the above test to fail.\r\n\r\n```java\r\nprotected void sendResponse(StatusCode code, Object response, OpStatsLogger statsLogger) {\r\n         ......\r\n         if (channel.isActive()) {\r\n            channel.writeAndFlush(response).addListener(new ChannelFutureListener() {\r\n                @Override\r\n                public void operationComplete(ChannelFuture future) throws Exception {\r\n                    long writeElapsedNanos = MathUtils.elapsedNanos(writeNanos);\r\n                    if (!future.isSuccess()) {\r\n                        requestProcessor.getRequestStats().getChannelWriteStats()\r\n                                .registerFailedEvent(writeElapsedNanos, TimeUnit.NANOSECONDS);\r\n                    } else {\r\n                        requestProcessor.getRequestStats().getChannelWriteStats()\r\n                                .registerSuccessfulEvent(writeElapsedNanos, TimeUnit.NANOSECONDS);\r\n                    }\r\n                    if (StatusCode.EOK == code) {\r\n                        statsLogger.registerSuccessfulEvent(MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);\r\n                    } else {\r\n                        statsLogger.registerFailedEvent(MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n         ......\r\n}\r\n```\r\n\r\n### Changes\r\n\r\nThe `READ_ENTRY_SCHEDULING_DELAY` metric is processed before the Read request is processed, which proved that bookie receives the read request from the client and can well meet the needs of `BookieStickyReadsTest`.\r\n\r\nThis makes the `BookieStickyReadsTest` test more stabled.\r\n","Date":"Wed Dec 07 04:00:01 CET 2022"},{"Commit-ID":"commit 4574ba02333308ad648c9b78963a381ad83ea564 1670399409 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Wed Dec 7 15:50:09 2022 +0800]","Body":"Fix RegionAwareEnsemblePlacementPolicy update rack info problem. (#3666)\n\n","Date":"Wed Dec 07 08:50:09 CET 2022"},{"Commit-ID":"commit 5a38080ccfd4be051d5c276283e0f24c21ef938d 1670399528 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Wed Dec 7 15:52:08 2022 +0800]","Body":"Make `jvm_memory_direct_bytes_used` metrics compatible with jdk8. (#3677)\n\n","Date":"Wed Dec 07 08:52:08 CET 2022"},{"Commit-ID":"commit a19d849a370d0b3eed73bb90f329b47f00730146 1670405417 -----sp","Author":"PersonIdent[StevenLuMT, lsj_sdjzu@126.com, Wed Dec 7 17:30:17 2022 +0800]","Body":"[fix][server]fix memory leak when closeRecovered,failed on clearing newEnsemblesFromRecovery (#3672)\n\nCo-authored-by: lushiji <lushiji@didiglobal.com>","Date":"Wed Dec 07 10:30:17 CET 2022"},{"Commit-ID":"commit a71c7a7e681e9908c04245d3d719d8f1c0a79176 1670413730 -----sp","Author":"PersonIdent[StevenLuMT, lsj_sdjzu@126.com, Wed Dec 7 19:48:50 2022 +0800]","Body":"module distributedlog-common/distributedlog-protocol: refactor ByteBuf release usage (#3693)\n\nCo-authored-by: lushiji <lushiji@didiglobal.com>","Date":"Wed Dec 07 12:48:50 CET 2022"},{"Commit-ID":"commit 4e37cf68d1af0ad6754720a34db958a3d8ee4f0e 1670762150 -----sp","Author":"PersonIdent[StevenLuMT, lsj_sdjzu@126.com, Sun Dec 11 20:35:50 2022 +0800]","Body":"module stream-storage-common/stream-storage-java-kv-client/stream-storage-cli: refactor ByteBuf release usage (#3694)\n\nCo-authored-by: lushiji <lushiji@didiglobal.com>","Date":"Sun Dec 11 13:35:50 CET 2022"},{"Commit-ID":"commit 004dfa86bf9dad829088472f7df838ebd63c63af 1670762181 -----sp","Author":"PersonIdent[Qiang Huang, qiang.huang1991@gmail.com, Sun Dec 11 20:36:21 2022 +0800]","Body":"refactor ByteBuf release usage (#3695)\n\n","Date":"Sun Dec 11 13:36:21 CET 2022"},{"Commit-ID":"commit c67dfb973333d7a02730e472216b78b300fe27e7 1670898265 -----sp","Author":"PersonIdent[priyanka-28, 52324780+priyanka-28@users.noreply.github.com, Mon Dec 12 20:24:25 2022 -0600]","Body":"Issue #3701 Fixed Flaky Tests (#3702)\n\nDescriptions of the changes in this PR:\r\n\r\nThe test in org.apache.bookkeeper.slogger.SloggerTest#testMap express non-deterministic behaviour and change the order of the attributes. The fix is changing HashMap to LinkedHashMap to ensure determinism.\r\n\r\n### Motivation\r\n\r\nFixing non-deterministic flaky tests.\r\n\r\n### Changes\r\n\r\nChanged the HashMap to LinkedHashMap in test code.","Date":"Tue Dec 13 03:24:25 CET 2022"},{"Commit-ID":"commit 44edbd10b79f6d573d147758a84007d9499e30fe 1670986221 -----sp","Author":"PersonIdent[Maciej Laskowski, 19705838+malaskowski@users.noreply.github.com, Wed Dec 14 03:50:21 2022 +0100]","Body":"fix docker compose deployment (#3660)\n\n### Motivation\r\n\r\nI tried to run the Apache BookKeeper server locally for learning and development purposes. I found out that the [deploy/docker-compose](https://github.com/apache/bookkeeper/tree/master/deploy/docker-compose) is using some old docker images and is not working with the latest version of BookKeeper and Zookeeper.\r\nI updated it to work with current versions and also fixed #3657 .\r\n\r\n### Changes\r\n- updated images (BookKeeper and Zookeeper) to the latest official versions\r\n- updated Helm template \r\n   - configuration adjusted to the latest versions\r\n   - numeration of services starts from `1` instead of `0`\r\n   - by default do not mount data to the host drive (empty `dataDir` value)\r\n- updated `docker-compose.yml` according to the Helm template changes\r\n- updated `README.md`\r\n\r\nMaster Issue: #3657\r\n\r\n\r\n","Date":"Wed Dec 14 03:50:21 CET 2022"},{"Commit-ID":"commit dd80e967e7d3dc6873231a7bc04feaba83be54c3 1671673732 -----sp","Author":"PersonIdent[LinChen, 1572139390@qq.com, Thu Dec 22 09:48:52 2022 +0800]","Body":"[fix][server] When dbStorage_directIOEntryLogger=true, EntryLogIdsImpl only takes effect for a single ledger directory (#3680)\n\n### Motivation\r\nWhen building the EntryLogIdsImpl object, the ledgerDirsManager variable is used. When the EntryLogIdsImpl object is used to generate an id, all ledger directories will be scanned in the findLargestGap method. for example:\r\nWe configured three ledger directories:\r\n/data1/bk-data1\r\n/data1/bk-data2\r\n  /data1/bk-data3\r\n\r\nThe findLargestGap method scans these three data directories to generate ids, but actually only needs to scan one data directory corresponding to the EntryLogIdsImpl object:\r\nhttps://github.com/apache/bookkeeper/blob/01232c94c91759a175345e8c055951e5cc6091dd/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/DbLedgerStorage.java#L225-L236\r\n\r\n### Changes\r\nWhen building the EntryLogIdsImpl object, use the variable ldm instead of the variable ledgerDirsManager:\r\n\r\n```\r\n           lDirs[0] = ledgerDir.getParentFile();\r\n            LedgerDirsManager ldm = new LedgerDirsManager(conf, lDirs, ledgerDirsManager.getDiskChecker(),\r\n                    NullStatsLogger.INSTANCE);\r\n\r\n```\r\n\r\n```\r\n entrylogger = new DirectEntryLogger(ledgerDir, new EntryLogIdsImpl(ldm, slog),\r\n                    new NativeIOImpl(),\r\n                    allocator, entryLoggerWriteExecutor, entryLoggerFlushExecutor,\r\n                    conf.getEntryLogSizeLimit(),\r\n                    conf.getNettyMaxFrameSizeBytes() - 500,\r\n                    perDirectoryTotalWriteBufferSize,\r\n                    perDirectoryTotalReadBufferSize,\r\n                    readBufferSize,\r\n                    numReadThreads,\r\n                    maxFdCacheTimeSeconds,\r\n                    slog, statsLogger);\r\n```\r\n\r\n\r\n","Date":"Thu Dec 22 02:48:52 CET 2022"},{"Commit-ID":"commit 5194c5bbd62783dfb6f0b9c3a521194b4092e670 1671698077 -----sp","Author":"PersonIdent[Qiang Huang, qiang.huang1991@gmail.com, Thu Dec 22 16:34:37 2022 +0800]","Body":"[refactor][bookkeeper] Refactor ByteBuf release method in stream/storage (#3703)\n\n* refactor ByteBuf release usage","Date":"Thu Dec 22 09:34:37 CET 2022"},{"Commit-ID":"commit 700c5281e8e74dbbe2660eb9fea1b52c1e035400 1671698109 -----sp","Author":"PersonIdent[Qiang Huang, qiang.huang1991@gmail.com, Thu Dec 22 16:35:09 2022 +0800]","Body":"[refactor][bookkeeper] Refactor ByteBuf release method in bookkeeper-server (#3700)\n\n* refactor ByteBuf release usage","Date":"Thu Dec 22 09:35:09 CET 2022"},{"Commit-ID":"commit c31e3997ba012d4860bb8150952d17b2a4cae482 1671698127 -----sp","Author":"PersonIdent[Qiang Huang, qiang.huang1991@gmail.com, Thu Dec 22 16:35:27 2022 +0800]","Body":"refactor ByteBuf release usage (#3698)\n\n","Date":"Thu Dec 22 09:35:27 CET 2022"},{"Commit-ID":"commit 1ce1bedfbfe645ff39b611bd92ae07dce5ae59c5 1671728885 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Dec 22 09:08:05 2022 -0800]","Body":"Added new way to self-invite to BK Slack (#3712)\n\n","Date":"Thu Dec 22 18:08:05 CET 2022"},{"Commit-ID":"commit 032aef7e75f6b3487a6611a2b8af8306b9a3f7bb 1671744146 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Thu Dec 22 13:22:26 2022 -0800]","Body":"[FEATURE] Added api/v1/bookie/cluster_info REST API\n\nDescriptions of the changes in this PR:\r\n\r\n### Motivation\r\n\r\nInformation provided by current REST API is not enough (and cumbersome to combine) to answer such question as \"is any data in danger if I shut down one more bookie\".\r\nE.g. getting list of underreplicated ledgers can get some info but it is either fast (no ledgers) or can be super slow on large cluster with some bookies lost (it retrieves full list of ledgers).\r\nEven if there are no UR ledgers it still possible that the problem is that Auditor is down etc.\r\n\r\n### Changes\r\n\r\n Added api/v1/bookie/cluster_info REST API\r\n\r\n```\r\ncurl -s 127.0.0.1:8080/api/v1/bookie/cluster_info\r\n{\r\n  \"auditorElected\" : false,\r\n  \"auditorId\" : \"\",\r\n  \"clusterUnderReplicated\" : false,\r\n  \"ledgerReplicationEnabled\" : true,\r\n  \"totalBookiesCount\" : 1,\r\n  \"writableBookiesCount\" : 1,\r\n  \"readonlyBookiesCount\" : 0,\r\n  \"unavailableBookiesCount\" : 0\r\n}%\r\n```\r\n\r\nSide-fix:\r\n`org.apache.bookkeeper.stream.cluster.StandaloneStarter` (used by bookie standalone) did not pass `LedgerManagerFactory` to the http server thus REST calls that needed it didn't work.\r\n\n\nReviewers: Nicolò Boschi <boschi1997@gmail.com>, Enrico Olivelli <eolivelli@gmail.com>\n\nThis closes #3710 from dlg99/rest-cluster-info","Date":"Thu Dec 22 22:22:26 CET 2022"},{"Commit-ID":"commit 405e72acf42bb1104296447ea8840d805094c787 1672145273 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Tue Dec 27 20:47:53 2022 +0800]","Body":"unify SLASHSTAR_STYLE for licenses in Java files (#3717)\n\n### Motivation\r\nUse SLASHSTAR_STYLE to avoid formatting unnecessary changes.\r\n\r\nSee also: \r\n- https://github.com/apache/pulsar/pull/18177\r\n- https://lists.apache.org/thread/gwy3ycgsq24r784mk3yv6cbppmbfxgjd\r\n\r\n### Changes\r\nUse SLASHSTAR_STYLE instead of javadoc style.","Date":"Tue Dec 27 13:47:53 CET 2022"},{"Commit-ID":"commit 03ba1883df998ce6848200d11fd141fb801d9382 1672907003 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Thu Jan 5 16:23:23 2023 +0800]","Body":"Expose registrationClient in DefaultBookieAddressResolver (#3724)\n\n","Date":"Thu Jan 05 09:23:23 CET 2023"},{"Commit-ID":"commit 05378442f776febf9f8ef49f10779a9e39438bd5 1672907357 -----sp","Author":"PersonIdent[Paul Gier, paul.gier@datastax.com, Thu Jan 5 02:29:17 2023 -0600]","Body":"[improve][doc] improve bk_server.conf docs (#3715)\n\n* [improve][doc] improve bk_server.conf docs\r\n\r\nAdd default value of allowMultipleDirsUnderSameDiskPartition\r\n\r\nSigned-off-by: Paul Gier <paul.gier@datastax.com>\r\n\r\n* [improve][doc] change example conf to match default\r\n\r\nSigned-off-by: Paul Gier <paul.gier@datastax.com>\r\n\r\nSigned-off-by: Paul Gier <paul.gier@datastax.com>","Date":"Thu Jan 05 09:29:17 CET 2023"},{"Commit-ID":"commit ce229a4ce078c9541f80df2bc5021c007efdbfff 1673401006 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Wed Jan 11 09:36:46 2023 +0800]","Body":"Add 4.14.6 release note (#3659)\n\n### Motivation\r\n\r\nBookKeeper 4.14.6 will be released, this is the release note.\r\n\r\n### Changes\r\nAdd BookKeeper 4.14.6 release note.\r\n","Date":"Wed Jan 11 02:36:46 CET 2023"},{"Commit-ID":"commit c64dbcd305df4bd2cdd33cc7c7cf8831a0a10aaa 1673420892 -----sp","Author":"PersonIdent[Lari Hotari, lhotari@users.noreply.github.com, Wed Jan 11 09:08:12 2023 +0200]","Body":"Upgrade Netty to 4.1.86.Final (#3669)\n\n### Motivation\r\n\r\n- see release notes for 4.1.85.Final: https://netty.io/news/2022/11/09/4-1-85-Final.html\r\n- see release notes for 4.1.86.Final: https://netty.io/news/2022/12/12/4-1-86-Final.html\r\n\r\nIt is unknown whether there are fixes that specifically target Netty features used in Bookkeeper. One of the motivation of this PR is to upgrade Netty in Bookkeeper when the Netty version gets upgraded in Pulsar. The PR for Netty 4.1.86.Final upgrade in Pulsar is apache/pulsar#18599\r\n\r\n\r\n### Changes\r\n\r\nUpgrade Netty version to 4.1.86.Final","Date":"Wed Jan 11 08:08:12 CET 2023"},{"Commit-ID":"commit 49ca9fe3b13d0b4f82579e5023d98928a4f4bb74 1673422491 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Wed Jan 11 15:34:51 2023 +0800]","Body":"BP-60:Change PCBC limitStatsLogging default value to true (#3719)\n\n### Motivation\r\n\r\nFixes #3718 \r\n","Date":"Wed Jan 11 08:34:51 CET 2023"},{"Commit-ID":"commit 4fd5f814ddac4a1c6c11f31256a942871b00e3d0 1673423344 -----sp","Author":"PersonIdent[FeiFan Wang, zoltar9264@163.com, Wed Jan 11 15:49:04 2023 +0800]","Body":"[docs] update parameter in manual deployment page (#3573)\n\n### Motivation\r\n\r\nconfiguration 'zkServers' is deprecated, user only config this parameter may cause failure. So update manual deployment page.","Date":"Wed Jan 11 08:49:04 CET 2023"},{"Commit-ID":"commit b5f85e0d1d17c5e29ac7b378f93a3558ed843eaa 1673425317 -----sp","Author":"PersonIdent[dependabot[bot], 49699333+dependabot[bot]@users.noreply.github.com, Wed Jan 11 09:21:57 2023 +0100]","Body":"Bump json5 from 1.0.1 to 1.0.2 in /site3/website (#3727)\n\nBumps [json5](https://github.com/json5/json5) from 1.0.1 to 1.0.2.\r\n- [Release notes](https://github.com/json5/json5/releases)\r\n- [Changelog](https://github.com/json5/json5/blob/main/CHANGELOG.md)\r\n- [Commits](https://github.com/json5/json5/compare/v1.0.1...v1.0.2)\r\n\r\n---\r\nupdated-dependencies:\r\n- dependency-name: json5\r\n  dependency-type: indirect\r\n...\r\n\r\nSigned-off-by: dependabot[bot] <support@github.com>\r\n\r\nSigned-off-by: dependabot[bot] <support@github.com>\r\nCo-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>","Date":"Wed Jan 11 09:21:57 CET 2023"},{"Commit-ID":"commit 2536a580dd60442d4846be4c7fe6779ee3786500 1673425406 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Wed Jan 11 16:23:26 2023 +0800]","Body":"Generate 4.14.6 website docs (#3729)\n\n* generate 4.14.6 doc\r\n\r\n* update BookKeeper stable_release version","Date":"Wed Jan 11 09:23:26 CET 2023"},{"Commit-ID":"commit 9e8cda30d4e63371ff9ae12e64189aee47ad8000 1673426597 -----sp","Author":"PersonIdent[dependabot[bot], 49699333+dependabot[bot]@users.noreply.github.com, Wed Jan 11 09:43:17 2023 +0100]","Body":"Bump loader-utils from 1.4.0 to 1.4.2 in /site3/website (#3648)\n\nBumps [loader-utils](https://github.com/webpack/loader-utils) from 1.4.0 to 1.4.2.\r\n- [Release notes](https://github.com/webpack/loader-utils/releases)\r\n- [Changelog](https://github.com/webpack/loader-utils/blob/v1.4.2/CHANGELOG.md)\r\n- [Commits](https://github.com/webpack/loader-utils/compare/v1.4.0...v1.4.2)\r\n\r\n---\r\nupdated-dependencies:\r\n- dependency-name: loader-utils\r\n  dependency-type: indirect\r\n...\r\n\r\nSigned-off-by: dependabot[bot] <support@github.com>\r\n\r\nSigned-off-by: dependabot[bot] <support@github.com>\r\nCo-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>","Date":"Wed Jan 11 09:43:17 CET 2023"},{"Commit-ID":"commit 7b5b6b240ca7551da266903078f2dd2ba2906b96 1673948440 -----sp","Author":"PersonIdent[Nicolò Boschi, boschi1997@gmail.com, Tue Jan 17 10:40:40 2023 +0100]","Body":"CI: move all tests in a single workflow  (#3735)\n\n* CI: move all tests in a single workflow\r\n\r\n* fix java8\r\n\r\n* also owasp dep check\r\n\r\n* fix streamstorage\r\n\r\n* Fix\r\n\r\n* fix fail if tests not passing\r\n\r\n* separate steps\r\n\r\n* fix PR Validation job name\r\n\r\n* add retention-days to owasp","Date":"Tue Jan 17 10:40:40 CET 2023"},{"Commit-ID":"commit e7636086ed0ad8615fd30807da1ea740ed400756 1674893739 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sat Jan 28 16:15:39 2023 +0800]","Body":"unify SLASHSTAR_STYLE for licenses in Java files (#3741)\n\n### Motivation\r\nUse SLASHSTAR_STYLE to avoid formatting unnecessary changes.\r\n\r\nSee also: \r\n- https://github.com/apache/bookkeeper/pull/3717\r\n- https://github.com/apache/pulsar/pull/18177\r\n- https://lists.apache.org/thread/gwy3ycgsq24r784mk3yv6cbppmbfxgjd\r\n\r\n### Changes\r\nUse SLASHSTAR_STYLE instead of javadoc style.","Date":"Sat Jan 28 09:15:39 CET 2023"},{"Commit-ID":"commit 8ea223418330b55ccb890a223aa166f5c2ad8372 1674893885 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sat Jan 28 16:18:05 2023 +0800]","Body":"Update copy right year from 2022 to 2023 (#3742)\n\n","Date":"Sat Jan 28 09:18:05 CET 2023"},{"Commit-ID":"commit a2b0709627f642c16bc13e370394095ad3c58532 1674898789 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sat Jan 28 17:39:49 2023 +0800]","Body":"Bump hadoop-common from 3.2.4 to 3.3.4 (#3756)\n\n### Motivation\r\nBump hadoop-common from 3.2.4 to 3.3.4 to avoid indirect dependent security vulnerabilities, such as **commons-text**\r\n\r\n### Changes\r\n\r\nBump hadoop-common from 3.2.4 to 3.3.4","Date":"Sat Jan 28 10:39:49 CET 2023"},{"Commit-ID":"commit dbf682d76c368c9a805a1689cfc134e3f78ac9c0 1674955153 -----sp","Author":"PersonIdent[houxiaoyu, houxiaoyu@apache.org, Sun Jan 29 09:19:13 2023 +0800]","Body":"Remove unnecessary hasExplicitLac check (#3748)\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\nRemove the unnecessary `ledgerData.hasExplicitLac()` check,  because we have check it at Line985\r\n\r\n### Changes\r\n\r\nRemove the unnecessary `ledgerData.hasExplicitLac()` check","Date":"Sun Jan 29 02:19:13 CET 2023"},{"Commit-ID":"commit c7cc668230b7a2d5f114f37709d01a1449caea12 1675065668 -----sp","Author":"PersonIdent[Lishen Yao, yaalsn@gmail.com, Mon Jan 30 16:01:08 2023 +0800]","Body":"Add code coverage report and upload to Codecov (#3586)\n\n","Date":"Mon Jan 30 09:01:08 CET 2023"},{"Commit-ID":"commit accaa6966f17cb9bf6c7d74de3deac49b758c01b 1675244394 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Wed Feb 1 17:39:54 2023 +0800]","Body":"Bump snakeyaml from 1.32 to 1.33 (#3757)\n\n","Date":"Wed Feb 01 10:39:54 CET 2023"},{"Commit-ID":"commit f6a7c0617c9c5b566671234c98fa84e43655631b 1675391548 -----sp","Author":"PersonIdent[Lishen Yao, yaalsn@gmail.com, Fri Feb 3 10:32:28 2023 +0800]","Body":"Add push trigger condition for CI (#3760)\n\n### Motivation\r\n\r\n1. Make code coverage have a base branch to diff.\r\n2. Every PR may not sync and merge the latest master code, so we need to run CI for the target branch after a PR merged.\r\n","Date":"Fri Feb 03 03:32:28 CET 2023"},{"Commit-ID":"commit 901f76ce4c4f9f771363424dbb60da4d590ad122 1675391681 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Fri Feb 3 10:34:41 2023 +0800]","Body":"Fix QueueEntry recycle problem. (#3747)\n\nDescriptions of the changes in this PR:\r\nIn the QueueEntry recycle, it only recycles itself to the object pool, but didn't reset some properties.\r\nLike entry, cb, etc. We should reset the filed before recycles itself.\r\n\r\n","Date":"Fri Feb 03 03:34:41 CET 2023"},{"Commit-ID":"commit 02e64a4b97e03afc9993ab227f82a5956965c03f 1675489988 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Fri Feb 3 21:53:08 2023 -0800]","Body":"[improve] Upgrade zk to 3.8.1 (#3754)\n\n","Date":"Sat Feb 04 06:53:08 CET 2023"},{"Commit-ID":"commit af82d14cb1da6a97b563b80e80b5d2fe462e2c4f 1675839191 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Wed Feb 8 14:53:11 2023 +0800]","Body":"Fix memory leak when the Bookie is in read-only mode. (#3746)\n\nDescriptions of the changes in this PR:\r\nFixes #3745 \r\n","Date":"Wed Feb 08 07:53:11 CET 2023"},{"Commit-ID":"commit 700d45f43566f49299f70b7d2c64e05bfd05b25a 1675840554 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Wed Feb 8 15:15:54 2023 +0800]","Body":"Replace LedgerStorageNotificationListener with existing LedgerDeletionListener (#3736)\n\n","Date":"Wed Feb 08 08:15:54 CET 2023"},{"Commit-ID":"commit 61c553b9a892612721c1f2c508a3660b9707cfcf 1675912558 -----sp","Author":"PersonIdent[dependabot[bot], 49699333+dependabot[bot]@users.noreply.github.com, Thu Feb 9 11:15:58 2023 +0800]","Body":"Bump http-cache-semantics from 4.1.0 to 4.1.1 in /site3/website (#3765)\n\nBumps [http-cache-semantics](https://github.com/kornelski/http-cache-semantics) from 4.1.0 to 4.1.1.\r\n- [Release notes](https://github.com/kornelski/http-cache-semantics/releases)\r\n- [Commits](https://github.com/kornelski/http-cache-semantics/compare/v4.1.0...v4.1.1)\r\n\r\n---\r\nupdated-dependencies:\r\n- dependency-name: http-cache-semantics\r\n  dependency-type: indirect\r\n...\r\n\r\nSigned-off-by: dependabot[bot] <support@github.com>\r\nCo-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>","Date":"Thu Feb 09 04:15:58 CET 2023"},{"Commit-ID":"commit 4ca4b4e4845ec1a3d5b17c96c99e97a62b5ec6c7 1675912950 -----sp","Author":"PersonIdent[Masahiro Sakamoto, massakam@yahoo-corp.jp, Thu Feb 9 12:22:30 2023 +0900]","Body":"Fix issue where checkAllLedgers could get stuck when read throttling is enabled (#3655)\n\n### Motivation\r\n\r\nSome time ago, I fixed a bug where check of all ledgers periodically run by the auditor got stuck (cf. https://github.com/apache/bookkeeper/pull/3214). That PR was merged so we cherry-picked it and released it, but `checkAllLedgers` still got stuck when the `inFlightReadEntryNumInLedgerChecker` value was very small.\r\n\r\nThe cause is that multiple `BookKeeperClientWorker-OrderedExecutor` threads are blocked waiting for the semaphore to be released. This semaphore is released by the `BookKeeperClientWorker-OrderedExecutor` threads, so they should not run the `LedgerChecker#checkLedger` method.\r\n```\r\n\"BookKeeperClientWorker-OrderedExecutor-1-0\" #60 prio=5 os_prio=0 tid=0x00007f680401d800 nid=0x75e8 waiting on condition [0x00007f684a6e9000]\r\n   java.lang.Thread.State: WAITING (parking)\r\n        at sun.misc.Unsafe.park(Native Method)\r\n        - parking to wait for  <0x00000000a2121780> (a java.util.concurrent.Semaphore$NonfairSync)\r\n        at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)\r\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:836)\r\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:997)\r\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1304)\r\n        at java.util.concurrent.Semaphore.acquire(Semaphore.java:467)\r\n        at org.apache.bookkeeper.client.LedgerChecker.acquirePermit(LedgerChecker.java:163)\r\n        at org.apache.bookkeeper.client.LedgerChecker.checkLedger(LedgerChecker.java:431)\r\n        at org.apache.bookkeeper.replication.Auditor.lambda$null$4(Auditor.java:1216)\r\n        at org.apache.bookkeeper.replication.Auditor$$Lambda$137/1553334572.openComplete(Unknown Source)\r\n        at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232)\r\n        at org.apache.bookkeeper.client.LedgerOpenOp$2.readLastConfirmedComplete(LedgerOpenOp.java:218)\r\n        at org.apache.bookkeeper.client.LedgerHandle$14.getLacComplete(LedgerHandle.java:1718)\r\n        at org.apache.bookkeeper.client.PendingReadLacOp.readLacComplete(PendingReadLacOp.java:154)\r\n        at org.apache.bookkeeper.proto.PerChannelBookieClient$ReadLacCompletion$1.readLacComplete(PerChannelBookieClient.java:1801)\r\n        at org.apache.bookkeeper.proto.PerChannelBookieClient$ReadLacCompletion.handleV3Response(PerChannelBookieClient.java:1840)\r\n        at org.apache.bookkeeper.proto.PerChannelBookieClient$3.safeRun(PerChannelBookieClient.java:1473)\r\n        at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36)\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n        at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\r\n        at java.lang.Thread.run(Thread.java:750)\r\n```\r\n\r\n### Changes\r\n\r\nIn the `Auditor` class, have the `LedgerChecker#checkLedger` method run in a different thread from the `BookKeeperClientWorker-OrderedExecutor` threads.\r\n\r\nMaster Issue: https://github.com/apache/bookkeeper/issues/3070\r\n","Date":"Thu Feb 09 04:22:30 CET 2023"},{"Commit-ID":"commit b85ac48e8b61748300206646ab9dd1fc16ed1616 1675927852 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Thu Feb 9 15:30:52 2023 +0800]","Body":"BookieImpl remove wait until journal quits (#3603)\n\n### Motivation\r\n\r\nPR #2887 introduced the feature of shutdown the bookie service after any Journal thread exits, so we don't need to wait in BookieImpl for all Journal threads to exit before shutdown the Bookie service, because this cannot happen.","Date":"Thu Feb 09 08:30:52 CET 2023"},{"Commit-ID":"commit 7303cf1af3ae66aace8fd795dc1c5a8695224c7e 1676016054 -----sp","Author":"PersonIdent[Lari Hotari, lhotari@users.noreply.github.com, Fri Feb 10 10:00:54 2023 +0200]","Body":"Upgrade Netty to 4.1.87.Final (#3766)\n\n- Brings Netty Tcnative 2.0.56.Final\r\n- Also upgraded Netty's io_uring support to a compatible version\r\n\r\nRelease notes:\r\nhttps://netty.io/news/2023/01/12/4-1-87-Final.html\r\nhttps://netty.io/news/2023/02/02/multiple_releases_incubator.html\r\n\r\nSome relevant Netty bug fixes:\r\n\r\nImproves compatibility with newer Linux distros:\r\nhttps://github.com/netty/netty/pull/13112\r\n\r\nTLS 1.3 handshake issue fix:\r\nhttps://github.com/netty/netty/issues/13073 fixed by https://github.com/netty/netty/pull/13095","Date":"Fri Feb 10 09:00:54 CET 2023"},{"Commit-ID":"commit 3068b2ae923e9122af562248ce23c9c051622e35 1676017348 -----sp","Author":"PersonIdent[Lari Hotari, lhotari@users.noreply.github.com, Fri Feb 10 10:22:28 2023 +0200]","Body":"Upgrade dependency-check-maven plugin to fix broken OWASP check (#3731)\n\n* Upgrade dependency-check-maven plugin to fix broken OWASP check\r\n\r\n- 7.4.4 includes fix for issue\r\n      https://github.com/jeremylong/DependencyCheck/issues/5220\r\n\r\n    Error:  org.owasp.dependencycheck.data.nvdcve.DatabaseException: Error updating 'CVE-2020-36569'\r\n    org.owasp.dependencycheck.data.update.exception.UpdateException: org.owasp.dependencycheck.data.nvdcve.DatabaseException: Error updating 'CVE-2020-36569'\r\n    ...\r\n    Caused by: org.h2.jdbc.JdbcBatchUpdateException: Value too long for column \"VERSIONENDEXCLUDING CHARACTER VARYING(60)\": \"'0.0.0-20160722212129-ac0cc4484ad4_before_v0.0.0-20200131131040-063a3fb69896' (75)\"; SQL statement:\r\n\r\n* Add suppressions related to snakeyaml\r\n\r\n* Add more suppressions\r\n\r\n* Upgrade to 8.0.2 version\r\n\r\n* Add snakeyaml suppression","Date":"Fri Feb 10 09:22:28 CET 2023"},{"Commit-ID":"commit cec8267682202dfb77342db4366fef07ad7632d6 1676021194 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Fri Feb 10 17:26:34 2023 +0800]","Body":"recycle LongPairWrapper (#3728)\n\n","Date":"Fri Feb 10 10:26:34 CET 2023"},{"Commit-ID":"commit 591ceb971a7eda7ce5252f88c5cf694f3f4c30b2 1676078452 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sat Feb 11 09:20:52 2023 +0800]","Body":"fix admin rest api typo (#3776)\n\n","Date":"Sat Feb 11 02:20:52 CET 2023"},{"Commit-ID":"commit b9a82c54c75108662d35c7bfef075e8e971cb2f7 1676260971 -----sp","Author":"PersonIdent[houxiaoyu, houxiaoyu@apache.org, Mon Feb 13 12:02:51 2023 +0800]","Body":"Remove duplicated JournalQueueStats (#3753)\n\n","Date":"Mon Feb 13 05:02:51 CET 2023"},{"Commit-ID":"commit 6489a7d4193ca96379578a8c82b14e780154c6ef 1676445219 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Wed Feb 15 15:13:39 2023 +0800]","Body":"Fix numLedgersReplicated metric (#3654)\n\n### Motivation\r\n\r\nWhen I want to add num not adhering placement ledgers replicated metric for RW(#3652), I found the numLedgersReplicated statistic to be inaccurate.\r\n\r\nWhen we could not find a target bookie to replicate the ledger, the numLedgersReplicated metric will still increase.\r\n![image](https://user-images.githubusercontent.com/35599757/202638656-58f974f6-9ffc-4cfe-9ac7-85962f941de7.png)\r\n","Date":"Wed Feb 15 08:13:39 CET 2023"},{"Commit-ID":"commit d6d9212a64a6c9dabd69a646082718929c43b4f9 1676445311 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Wed Feb 15 15:15:11 2023 +0800]","Body":"Not wrap IOException twice form checkpoint (#3683)\n\n### Motivation\r\n\r\nIOException may be wrapped by RuntimeException, so don't wrap RuntimeException with IOException.","Date":"Wed Feb 15 08:15:11 CET 2023"},{"Commit-ID":"commit c217385ea4a50fc3721b4750f5625fbc7355e853 1676518760 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Thu Feb 16 11:39:20 2023 +0800]","Body":"[improvement] Refactor Auditor to simplify the readability (#3637)\n\n### Motivation\r\n\r\nFix #3636 \r\n\r\nSee explanation in #3636 \r\n\r\n### Changes\r\n\r\n1. Auditor class: Only reserved to do some necessary initialization work, scheduling of various detection tasks\r\n2. Separate monitoring metrics into `AuditorStats`\r\n3. Separate the auditBookies task to the `AuditorBookieCheckTask`\r\n4. Separate the checkAllLedgers task into the `AuditorCheckAllLedgersTask`\r\n5. Separate placementPolicyCheck task into `AuditorPlacementPolicyCheckTask`\r\n6. Separate replicasCheck to `AuditorReplicasCheckTask`\r\n\r\n","Date":"Thu Feb 16 04:39:20 CET 2023"},{"Commit-ID":"commit 1162512fd8929266a0b38b4929d105698d3fd446 1676518829 -----sp","Author":"PersonIdent[gaozhangmin, gaozhangmin456@qq.com, Thu Feb 16 11:40:29 2023 +0800]","Body":"Fix missing blank in log text (#3781)\n\nCo-authored-by: gavingaozhangmin <gavingaozhangmin@didiglobal.com>","Date":"Thu Feb 16 04:40:29 CET 2023"},{"Commit-ID":"commit 7f8c31bdad3bf7261e795feafd7f969f871baa82 1676599969 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Fri Feb 17 10:12:49 2023 +0800]","Body":"New ensemble choose different rack first. (#3721)\n\nDescriptions of the changes in this PR:\r\nFixes #3720\r\n\r\n\r\n### Motivation\r\nWhen new ensemble, choose the different rack node first, if there are no more different rack nodes, step down to pick nodes randomly.","Date":"Fri Feb 17 03:12:49 CET 2023"},{"Commit-ID":"commit 2381d9b65a37b6e58ffc9c7be2aba35fd37874b7 1676617776 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Fri Feb 17 15:09:36 2023 +0800]","Body":"Fix RegionAwareEnsemblePlacementPolicy.newEnsemble sometimes failed problem. (#3725)\n\nDescriptions of the changes in this PR:\r\nFixes #3722\r\n\r\n### Motivation\r\nSee [#3722](https://github.com/apache/bookkeeper/issues/3722#issuecomment-1369859251)","Date":"Fri Feb 17 08:09:36 CET 2023"},{"Commit-ID":"commit 10daf4cd4d3ccf6b74b98609e321b5fe58bd1fe2 1676857499 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Mon Feb 20 09:44:59 2023 +0800]","Body":"Generate 4.14.7 release note (#3770)\n\n### Motivation\r\n\r\nBookKeeper 4.14.7 will be released, this is the release note.\r\n\r\n### Changes\r\nGenerate BookKeeper 4.14.7 release note.\r\n","Date":"Mon Feb 20 02:44:59 CET 2023"},{"Commit-ID":"commit 5726e8f1c03a6687c74678004f069c093eb0c94e 1676882603 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Mon Feb 20 16:43:23 2023 +0800]","Body":"generate 4.14.7 website docs (#3787)\n\n### Modification\r\nGenerate 4.14.7 website docs","Date":"Mon Feb 20 09:43:23 CET 2023"},{"Commit-ID":"commit 13ccc4caf8ad80e84279e88edae0e71b8a555e09 1676941806 -----sp","Author":"PersonIdent[lifepuzzlefun, wjl_is_213@163.com, Tue Feb 21 09:10:06 2023 +0800]","Body":"Only acquire buffer when need write. (#3786)\n\n### Motivation\r\nsmall fix: when ByteBuf size is zero. the acquired buffer is not released.\r\n","Date":"Tue Feb 21 02:10:06 CET 2023"},{"Commit-ID":"commit e0fd93a4bc248e438fabcc06255d885b8a21e4f2 1676950075 -----sp","Author":"PersonIdent[dependabot[bot], 49699333+dependabot[bot]@users.noreply.github.com, Tue Feb 21 11:27:55 2023 +0800]","Body":"Bump vertx-web from 4.3.2 to 4.3.8 (#3775)\n\n* Bump vertx-web from 4.3.2 to 4.3.8\r\n\r\nBumps vertx-web from 4.3.2 to 4.3.8.\r\n\r\n---\r\nupdated-dependencies:\r\n- dependency-name: io.vertx:vertx-web\r\n  dependency-type: direct:production\r\n...\r\n\r\nSigned-off-by: dependabot[bot] <support@github.com>\r\n\r\n* update licenses\r\n\r\n---------\r\n\r\nSigned-off-by: dependabot[bot] <support@github.com>\r\nCo-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>\r\nCo-authored-by: chenhang <chenhang@apache.org>","Date":"Tue Feb 21 04:27:55 CET 2023"},{"Commit-ID":"commit 6b6ea7620157b600ded505b38dec472da824fe17 1677001974 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Wed Feb 22 01:52:54 2023 +0800]","Body":"Fix CI is not failed when test have errors (#3790)\n\n* Fix CI is not failed when test have errors\r\n---\r\n\r\n### Motivation\r\n\r\nWe added the test coverage to report the tests status.\r\nBut when we use the code-coverage profile, it will ignore\r\ntest failure because we set `<testFailureIgnore>true<\/testFailureIgnore>`.\r\n\r\nWe should do the test and test coverage in different steps\r\nand fail the test if there have errors.\r\n\r\n* Fix the test errors","Date":"Tue Feb 21 18:52:54 CET 2023"},{"Commit-ID":"commit 5fced0d4346f851b5698f1bdd3f7a06ee62a7fcb 1677002020 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Wed Feb 22 01:53:40 2023 +0800]","Body":"change directIO configuration names to avoid confuse (#3791)\n\n","Date":"Tue Feb 21 18:53:40 CET 2023"},{"Commit-ID":"commit c295f1880f6c9c18ceb9bc985db9c88e636b9171 1677012723 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Feb 21 12:52:03 2023 -0800]","Body":"Made PendingAddOp thread safe (#3784)\n\n","Date":"Tue Feb 21 21:52:03 CET 2023"},{"Commit-ID":"commit 9ff295443097cc85903d8d9f0319ec582fb601bf 1677028099 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Wed Feb 22 09:08:19 2023 +0800]","Body":"Add logs for ensemble select failed (#3779)\n\n### Motivation\r\nWe have 3 bookies in the same rack, and configured `E = 2, W = 2, A = 2`. When one bookie restarted, we found the ledger select bookie from the same rack failed in the ensemble change replacing the failed bookie step.\r\n\r\nDue to there being no log information in `selectRandomFromRack`, it's hard to debug the root cause.\r\nhttps://github.com/apache/bookkeeper/blob/02e64a4b97e03afc9993ab227f82a5956965c03f/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java#L630-L679\r\n\r\n### Modification\r\nAdd one warn log in `selectRandomFromRack` when selecting a new bookie node failed.","Date":"Wed Feb 22 02:08:19 CET 2023"},{"Commit-ID":"commit 58cdd499c6b398f4bc5f94c66d4e139a6a1a00b0 1677028792 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Wed Feb 22 09:19:52 2023 +0800]","Body":"Make profile code-coverage and dev-debug tests using `-Dio.netty.leakDetection.level=paranoid`. (#3785)\n\n### Motivation\r\nOur ci tests use `code-coverage` profile to run, using `-Dio.netty.leakDetection.level=paranoid` will cover more cases.\r\n\r\n","Date":"Wed Feb 22 02:19:52 CET 2023"},{"Commit-ID":"commit 80d3aac30f69d2a10f06dca4f9c2a62b8d01220a 1677031857 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Wed Feb 22 10:10:57 2023 +0800]","Body":"upgrade rocksdb version to 7.9.2 (#3795)\n\n### Motivation\r\nRelated to https://github.com/apache/bookkeeper/issues/3734\r\n\r\n### Modification\r\nUpgrade RocksDB version to 7.9.2","Date":"Wed Feb 22 03:10:57 CET 2023"},{"Commit-ID":"commit 8d922634c71ac96daeb2fa7db7692424895df722 1677438652 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sun Feb 26 11:10:52 2023 -0800]","Body":"Fixed locking of PendingAddOp (#3806)\n\n* Fixed locking of PendingAddOp\r\n\r\n* Fixed stack overflow\r\n\r\n* Fixed stack overflow in different point","Date":"Sun Feb 26 20:10:52 CET 2023"},{"Commit-ID":"commit 7f263fa8f41924ef0996f84beffdf008480075d8 1677459602 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sun Feb 26 17:00:02 2023 -0800]","Body":"Fixed the pivot selection in the group quick-sort (#3800)\n\n* Fixed the pivot selection in the group quick-sort\r\n\r\n* Fixed formatting\r\n\r\n* Fixed alignment","Date":"Mon Feb 27 02:00:02 CET 2023"},{"Commit-ID":"commit 08ef6491a61cc3fbc3d055eb56b75eb221f986ec 1677470558 -----sp","Author":"PersonIdent[houxiaoyu, houxiaoyu@apache.org, Mon Feb 27 12:02:38 2023 +0800]","Body":"Fix ReadEntryProcessor v2 SchedulingDelayStats (#3758)\n\nDescriptions of the changes in this PR:\r\n\r\n\r\n\r\n### Motivation\r\n\r\nWe registered `ReadEntrySchedulingDelayStats` of `ReadEntryProcessor` as `WriteThreadQueuedLatency` mistakenly, so we need fix it.\r\n\r\n### Changes\r\n\r\nRegister `ReadEntrySchedulingDelayStats`  if `ReadEntryProcessor`\r\n\r\n","Date":"Mon Feb 27 05:02:38 CET 2023"},{"Commit-ID":"commit f65b72d54bff677adb273c509d84ada7f93727a9 1677472888 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sun Feb 26 20:41:28 2023 -0800]","Body":"Use mixed quick/insertion sort (#3807)\n\n","Date":"Mon Feb 27 05:41:28 CET 2023"},{"Commit-ID":"commit 1f8de8ffa2e63bb748b096c1427f58e6b07e5c5c 1677473074 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sun Feb 26 20:44:34 2023 -0800]","Body":"Improved efficiency in DigestManager.verify() (#3810)\n\n","Date":"Mon Feb 27 05:44:34 CET 2023"},{"Commit-ID":"commit 1e028534855a4dc83a74432f9de9a062c94c9984 1677484813 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon Feb 27 00:00:13 2023 -0800]","Body":"Avoid thread-local state when computing CRCs (#3811)\n\n### Motivation\r\n\r\nIn `DigestManager` there are several accesses to ThreadLocal variable per each entry processed.\r\n\r\nThe reason is the mainly due to `DigestManager` API which exposes a stateful `update()` method which can be invoked multiple times and keeps the current checksum as a thread-local variable.\r\n\r\nIf we exclude MAC digest which is 20 bytes, for other digests we can instead keep the current checksum in a local variable and pass it each time, avoiding all the thread-locals and also the need for writing the checksum result into a buffer.\r\n\r\n### Benchmarks\r\n\r\n#### Before #3810 \r\n\r\n```\r\nBenchmark                            (entrySize)   Mode  Cnt   Score   Error   Units\r\nDigestManagerBenchmark.verifyDigest           64  thrpt    3  13.450 ± 3.634  ops/us\r\nDigestManagerBenchmark.verifyDigest         1024  thrpt    3   7.908 ± 2.637  ops/us\r\nDigestManagerBenchmark.verifyDigest         4086  thrpt    3   3.233 ± 0.882  ops/us\r\nDigestManagerBenchmark.verifyDigest         8192  thrpt    3   1.846 ± 0.047  ops/us\r\n```\r\n\r\n#### After #3810 \r\n\r\n```\r\nBenchmark                            (entrySize)   Mode  Cnt   Score   Error   Units\r\nDigestManagerBenchmark.verifyDigest           64  thrpt    3  46.312 ± 7.414  ops/us\r\nDigestManagerBenchmark.verifyDigest         1024  thrpt    3  13.379 ± 1.069  ops/us\r\nDigestManagerBenchmark.verifyDigest         4086  thrpt    3   3.787 ± 0.059  ops/us\r\nDigestManagerBenchmark.verifyDigest         8192  thrpt    3   1.956 ± 0.052  ops/us\r\n```\r\n\r\n#### After this change\r\n\r\n\r\n\r\n```\r\nBenchmark                            (entrySize)   Mode  Cnt    Score   Error   Units\r\nDigestManagerBenchmark.verifyDigest           64  thrpt    3  130.108 ± 4.854  ops/us\r\nDigestManagerBenchmark.verifyDigest         1024  thrpt    3   17.744 ± 0.238  ops/us\r\nDigestManagerBenchmark.verifyDigest         4086  thrpt    3    4.104 ± 0.181  ops/us\r\nDigestManagerBenchmark.verifyDigest         8192  thrpt    3    2.050 ± 0.066  ops/us\r\n```","Date":"Mon Feb 27 09:00:13 CET 2023"},{"Commit-ID":"commit 6f09c60d2c29cdce3be7f784b0f1f7cfd7860e70 1677496847 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Mon Feb 27 19:20:47 2023 +0800]","Body":"Upgrade lombok to 1.18.26 (#3814)\n\n### Modifications\r\nUpgrade Lombok to 1.18.26","Date":"Mon Feb 27 12:20:47 CET 2023"},{"Commit-ID":"commit c389b96f12cd8dbcb654acc84234afe3f981f698 1677524537 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Tue Feb 28 03:02:17 2023 +0800]","Body":"Speed up shutdown in test cases (#3809)\n\n* speed up shutdown in test cases\r\n\r\n* fix failed test","Date":"Mon Feb 27 20:02:17 CET 2023"},{"Commit-ID":"commit 284cf9611a2e569616a7ecca30fd93fd90af721f 1677529810 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon Feb 27 12:30:10 2023 -0800]","Body":"Remove compiling with `-Werror` to support Java 19 (#3820)\n\n","Date":"Mon Feb 27 21:30:10 CET 2023"},{"Commit-ID":"commit e0ee70826974dd02c24133565bb1d81c30a753f1 1677545196 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Mon Feb 27 16:46:36 2023 -0800]","Body":"Support update ledger metadata option bk-cli (#3821)\n\n","Date":"Tue Feb 28 01:46:36 CET 2023"},{"Commit-ID":"commit ade30bda1996df747a2fe48948ec1a53413ae3a3 1677545211 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Mon Feb 27 16:46:51 2023 -0800]","Body":"Fix: bookie-shell ledger-metadata usage with correct param (#3822)\n\n","Date":"Tue Feb 28 01:46:51 CET 2023"},{"Commit-ID":"commit 0ca4fe26978c231c81796f4cfd52ae8fa3b2fc29 1677545239 -----sp","Author":"PersonIdent[Rajan Dhabalia, rdhabalia@apache.org, Mon Feb 27 16:47:19 2023 -0800]","Body":"Fix: typo for ledger-metadata param: restorefromfile (#3823)\n\n","Date":"Tue Feb 28 01:47:19 CET 2023"},{"Commit-ID":"commit 6d003367280b0a761d02dbfc8c8d6ab8b6637e73 1677571567 -----sp","Author":"PersonIdent[lixinyang, 84127069+Nicklee007@users.noreply.github.com, Tue Feb 28 16:06:07 2023 +0800]","Body":"fix mailing-lists dead links (#3804)\n\n### Motivation\r\nFix the mailing-lists.md dead links which cause Dead link checker failed.\r\nThere are some links looks like not stable, we can use new link to replace it.\r\n\r\nCI filed link:https://github.com/apache/bookkeeper/actions/runs/4260370313/jobs/7413461899\r\n\r\n```\r\n[✖] http://mail-archives.apache.org/mod_mbox/bookkeeper-user/\r\nERROR: 4 dead links found!\r\n[✖] http://mail-archives.apache.org/mod_mbox/bookkeeper-dev/\r\n[✖] http://mail-archives.apache.org/mod_mbox/bookkeeper-issues/\r\n[✖] http://mail-archives.apache.org/mod_mbox/bookkeeper-commits/\r\n\r\n20 links checked.\r\n[✖] http://mail-archives.apache.org/mod_mbox/bookkeeper-user/ → Status: 0\r\n[✖] http://mail-archives.apache.org/mod_mbox/bookkeeper-dev/ → Status: 0\r\n[✖] http://mail-archives.apache.org/mod_mbox/bookkeeper-issues/ → Status: 0\r\n[✖] http://mail-archives.apache.org/mod_mbox/bookkeeper-commits/ → Status: 0\r\n```\r\n### Changes\r\n1. use new link to replace the dead links in mailing-lists.md.\r\n","Date":"Tue Feb 28 09:06:07 CET 2023"},{"Commit-ID":"commit b70d128ad00b99d9e9771d20e4a50bc3b129a00f 1677635264 -----sp","Author":"PersonIdent[Lari Hotari, lhotari@users.noreply.github.com, Wed Mar 1 03:47:44 2023 +0200]","Body":"Upgrade Netty to 4.1.89.Final (#3816)\n\n- Also upgraded Netty's io_uring support to a compatible version\r\n\r\nRelease notes:\r\nhttps://netty.io/news/2023/02/12/4-1-88-Final.html\r\nhttps://netty.io/news/2023/02/13/4-1-89-Final.html\r\nhttps://netty.io/news/2023/02/22/io_uring_0-0-18-Final.html","Date":"Wed Mar 01 02:47:44 CET 2023"},{"Commit-ID":"commit fbd18aeecaf8089c4a15676fea0dff3b32615293 1677635560 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Feb 28 17:52:40 2023 -0800]","Body":"Use JNI directly for posix_fadvise (#3824)\n\n* Use JNI directly for posix_fadvise\r\n\r\n* Fixed checkstyle\r\n\r\n* fixed checkstyle\r\n\r\n* Fixed jni function name","Date":"Wed Mar 01 02:52:40 CET 2023"},{"Commit-ID":"commit a96317e3537abff1d5759356ee27fc1044740f44 1677635641 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Wed Mar 1 09:54:01 2023 +0800]","Body":"Update testcontainers to last version to support m1 (#3819)\n\n","Date":"Wed Mar 01 02:54:01 CET 2023"},{"Commit-ID":"commit 73294ce00f039151f484dccf5c3d03114c852c73 1677663267 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Mar 1 01:34:27 2023 -0800]","Body":"Fixed back API of Crc32cIntChecksum (#3826)\n\n### Motivation\r\n\r\nIn #3810 the signature of `Crc32cIntChecksum.resumeChecksum()` was changed to accept `offset` & `len` in the buffer.\r\n\r\nSince this method is also used externally (in Pulsar), we should leave also the old method signature to avoid breaking the API when upgrading BK.","Date":"Wed Mar 01 10:34:27 CET 2023"},{"Commit-ID":"commit 3dcd8d58692a55a3c95184d4692d5d4f2e65c11b 1677668494 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Wed Mar 1 03:01:34 2023 -0800]","Body":"Remove callback threadpool for sending add responses (#3825)\n\n### Motivation\r\n\r\nThe option of triggering journal callbacks from a thread-pool instead of from the JournalForceWrite thread is not really helpful under any condition.\r\n\r\nThe only thing this option does is to introduce an extra context switch to jump on this thread-pool and from there it will trigger the response, though basically no work is done in this thread-pool. It will just jump on the Netty IO-thread for the specific connection and from there the serialization and the socket write will be done.\r\n\r\nWhen using the thread-pool, one can see the effect of the extra-context switch and the contention on the execution.\r\n\r\nAdditionally, when 0 threads are configured, we are using the Guava DirectExecutor which has non-zero overhead in the form of a mutex that is contended between multiple journal threads.","Date":"Wed Mar 01 12:01:34 CET 2023"},{"Commit-ID":"commit 7852db60591aefae9ae170ec4990bcb3de59f574 1677705308 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Thu Mar 2 05:15:08 2023 +0800]","Body":"remove unused 'close ledger manager' comment (#3827)\n\n","Date":"Wed Mar 01 22:15:08 CET 2023"},{"Commit-ID":"commit 227b166018242d26a5299b6ed338e12632ebe780 1677719688 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Thu Mar 2 09:14:48 2023 +0800]","Body":"Support build in the aarch64 linux platform (#3828)\n\n---\r\n### Motivation\r\n\r\nWhen releasing the bookkeeper on aarch64 Mac OS, it will\r\nbuild aarch64 linux image use to release operations. Add\r\naol properties for the aarch64 linux.","Date":"Thu Mar 02 02:14:48 CET 2023"},{"Commit-ID":"commit 20aad8006e7bb21f034dfe61bc68a38968428d1e 1677772330 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Thu Mar 2 07:52:10 2023 -0800]","Body":"Avoid using thread-local WriteSet when possible (#3829)\n\n","Date":"Thu Mar 02 16:52:10 CET 2023"},{"Commit-ID":"commit b4112dfdbf29c16da89d914d44faaa8c821723a8 1677947198 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Sun Mar 5 00:26:38 2023 +0800]","Body":"Fix Spotbugs check failed (#3836)\n\n* fix spotbugs check failed\r\n\r\n* format code\r\n\r\n* install the package first\r\n\r\n* upgrade spotbugs version to 4.7.3.2\r\n\r\n* upgrade javadoc plugin to 3.5.0\r\n\r\n* upgrade javadoc plugin to 3.2.0\r\n\r\n* format code\r\n\r\n* set maven version 3.8.7\r\n\r\n* set all test maven version to 3.8.7\r\n\r\n* fix failed CI\r\n\r\n* add test failure\r\n\r\n* address test failure\r\n\r\n* fix failed CI\r\n\r\n* format code","Date":"Sat Mar 04 17:26:38 CET 2023"},{"Commit-ID":"commit dfde3d6836094cc39d8a3603cb268ca0f633350b 1678038217 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sun Mar 5 09:43:37 2023 -0800]","Body":"Pass BookieRequestHandler instead of Channel to the request processors (#3835)\n\n* Pass BookieRequestHandler instead of Channel to the request processors\r\n\r\n* Fixed checkstyle\r\n\r\n* Fixed ForceLedgerProcessorV3Test\r\n\r\n* Fixed TestBookieRequestProcessor\r\n\r\n* Fixed line length","Date":"Sun Mar 05 18:43:37 CET 2023"},{"Commit-ID":"commit 128c52eeffeb0d009aedc3b92e8bd30852332a09 1678064577 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Sun Mar 5 17:02:57 2023 -0800]","Body":"Simplified the logic for ForceWriteThread after we introduced queue.drainTo() (#3830)\n\n### Motivation\r\n\r\nIn #3545 we have switched the `ForceWriteThread` to take advantage o `BlockingQueue.drainTo()` method for reducing contention, though the core logic of the force-write was not touched at the time.\r\n\r\nThe logic of force-write is quite complicated because it tries to group multiple force-write requests in the queue by sending a new marker and grouping them when the marker is received. This also leads to a bit of lag when there are many requests coming in and the IO is stressed, as we're waiting a bit more before issuing the fsync.\r\n\r\nInstead, with the `drainTo()` approach we can greatly simplify the logic and maintain a strict fsync grouping: \r\n 1. drain all the force-write-requests available in the queue into a local array list\r\n 2. perform the fsync\r\n 3. update the journal log mark to the position of the last fw request\r\n 4. trigger send-responses for all the requests\r\n 5. go back to read from the queue\r\n\r\n\r\nThis refactoring will also enable further improvements, to optimize how the send responses are prepared, since we have now a list of responses ready to send.\r\n","Date":"Mon Mar 06 02:02:57 CET 2023"},{"Commit-ID":"commit 3199fbe4d60cc392f58850e8a572d0211c296d9d 1678086116 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Mon Mar 6 15:01:56 2023 +0800]","Body":"Add directIO entry logger settings documents (#3789)\n\n### Motivation\r\nWe have support DirectIO entry logger, but we don't have any user guides to show how to enable and configure the DirectIO entry logger.\r\n\r\n### Modifications\r\nAdd DirectIO Entry logger settings documents.\r\n","Date":"Mon Mar 06 08:01:56 CET 2023"},{"Commit-ID":"commit 3844bf128cbd07ffd0f77eb8ec9dcedc163a839b 1678086164 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Mon Mar 6 15:02:44 2023 +0800]","Body":"Make RrocksDB checksum type configurable (#3793)\n\n### Motivation\r\nFix https://github.com/apache/bookkeeper/issues/3734#issuecomment-1407626941\r\n\r\nWe have two rocksDB tables, one for the ledger index, and another for the entry log location.\r\n - ledger index RocksDB table: Use the default table option, and the checksum is `kCRC32c`\r\n - entry log location RocksDb table: Use configured table option, and the checksum is `kxxHash` \r\n\r\nWhen we upgrade the RocksDB version from 6.10.2 to 7.9.2, the new RocksDB version's default table checksum has changed from `kCRC32c` to `kXXH3`, and `kXXH3` only supported since RocksDB 6.27. The RocksDB version rollback to 6.10.2 will be failed due to RocksDB 6.10.2 doesn't support the `kXXH3` checksum type.\r\n\r\n### Modifications\r\nIn this PR, I make the RocksDB checksum type configurable. But there is one change that will change the ledger index RocksDB table's checksum type from the default `kCRC32c` to `kxxHash`. I have tested the compatibility of the two checksum types in and between multiple RocksDB versions, it works fine.\r\n\r\nAfter setting the two RocksDB table's checksum type to `kxxHash`, the RocksDB's version upgraded from 6.10.2 to 7.9.2, and rolling back to 6.10.2 works fine.\r\n\r\n### More to discuss\r\nWhen writing the unit test to read the table checksum type from RocksDB configuration files, it failed. I found the related issue on RocksDB: https://github.com/facebook/rocksdb/issues/5297\r\nThe related PR: https://github.com/facebook/rocksdb/pull/10826\r\n\r\nIt means we still can't load RocksDB table options from configuration files. Maybe I missed some parts about reading RocksDB table options from the configuration file. \r\n\r\nIf this issue exists, we do **NOT** recommend users configure RocksDB configurations through configuration files.\r\n\r\n@merlimat @eolivelli @dlg99 Please help take a look, thanks.","Date":"Mon Mar 06 08:02:44 CET 2023"},{"Commit-ID":"commit bf5a6aabb69d4898a261480a867b0a15416a6b88 1678092954 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Mon Mar 6 16:55:54 2023 +0800]","Body":"BP61: revert BP-59 to release ByteBuf using ReferenceCountUtil.release() instead of ReferenceCountUtil.safeRelease() (#3796)\n\n","Date":"Mon Mar 06 09:55:54 CET 2023"},{"Commit-ID":"commit 1bd1745742ce920a6bc015e086b78cc1aaec6357 1678102018 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Mon Mar 6 19:26:58 2023 +0800]","Body":"fix website deploy build failed (#3841)\n\n","Date":"Mon Mar 06 12:26:58 CET 2023"},{"Commit-ID":"commit 73c5a0e0111754690e5cd74fb030ee64a2f829d9 1678113311 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon Mar 6 06:35:11 2023 -0800]","Body":"Added BatchedArrayBlockingQueue (#3838)\n\n","Date":"Mon Mar 06 15:35:11 CET 2023"},{"Commit-ID":"commit 08c3138aeb7532a6b0582af12080253707c8ce29 1678148196 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Tue Mar 7 08:16:36 2023 +0800]","Body":"Add num not adhering placement ledgers replicated metric for ReplicationWorker (#3652)\n\n### Motivation\r\n\r\nWe have `NUM_FULL_OR_PARTIAL_LEDGERS_REPLICATED` in `ReplicationWorker`, which includes both `DATA_LOSS` and `DATA_NOT_ADHERING_PLACEMENT` data repair types. It is meaningful to add `NUM_NOT_ADHERING_PLACEMENT_LEDGERS_REPLICATED` metric for `DATA_NOT_ADHERING_PLACEMENT` type separately.","Date":"Tue Mar 07 01:16:36 CET 2023"},{"Commit-ID":"commit d6748f915d4801e90f001bc09d65918df85b305f 1678161341 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon Mar 6 19:55:41 2023 -0800]","Body":"Group and flush add-responses after journal sync (#3837)\n\n### Motivation\r\n\r\nNote: this is stacked on top of #3830 & #3835\r\n\r\nThis change improves the way the AddRequests responses are send to client. \r\n\r\nThe current flow is: \r\n * The journal-force-thread issues the fsync on the journal file\r\n * We iterate over all the entries that were just synced and for each of them:\r\n     1. Trigger channel.writeAndFlus()\r\n     2. This will jump on the connection IO thread (Netty will use a `write()` to `eventfd` to post the task and wake the epoll)\r\n     3. Write the object in the connection and trigger the serialization logic\r\n     4. Grab a `ByteBuf` from the pool and write ~20 bytes with the response\r\n     5. Write and flush the buffer on the channel\r\n     6. With the flush consolidator we try to group multiple buffer into a single `writev()` syscall, though each call will have a long list of buffer, making the memcpy inefficient.\r\n     7. Release all the buffers and return them to the pool\r\n\r\nAll these steps are quite expensive when the bookie is receiving a lot of small requests. \r\n\r\nThis PR changes the flow into: \r\n\r\n1. journal fsync\r\n2. go through each request and prepare the response into a per-connection `ByteBuf` which is not written on the channel as of yet\r\n3. after preparing all the responses, we flush them at once: Trigger an event on all the connections that will write the accumulated buffers.\r\n\r\nThe advantages are: \r\n 1. 1 ByteBuf allocated per connection instead of 1 per request\r\n    1. Less allocations and stress of buffer pool\r\n    2. More efficient socket write() operations\r\n 3. 1 task per connection posted on the Netty IO threads, instead of 1 per request.","Date":"Tue Mar 07 04:55:41 CET 2023"},{"Commit-ID":"commit 57031323166bd55004aaf50e3f46611dbb7eacf7 1678205226 -----sp","Author":"PersonIdent[Penghui Li, penghui@apache.org, Wed Mar 8 00:07:06 2023 +0800]","Body":"Fix memory leak issue of reading small entries (#3844)\n\n","Date":"Tue Mar 07 17:07:06 CET 2023"},{"Commit-ID":"commit 09365dfdd8aa20c603d7a134d7333b907ce50d24 1678211400 -----sp","Author":"PersonIdent[Penghui Li, penghui@apache.org, Wed Mar 8 01:50:00 2023 +0800]","Body":"Make read entry request recyclable (#3842)\n\n* Make read entry request recyclable\r\n\r\n* Move recycle to finally block\r\n\r\n* Fix test and comments\r\n\r\n* Fix test","Date":"Tue Mar 07 18:50:00 CET 2023"},{"Commit-ID":"commit f9313195f017ce47f3cb1900d4db6ad8b261ad7e 1678211429 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Wed Mar 8 01:50:29 2023 +0800]","Body":"Avoid unnecessary force write. (#3847)\n\n* Avoid unnecessary force write.\r\n\r\n* code clean.\r\n\r\n* fix style","Date":"Tue Mar 07 18:50:29 CET 2023"},{"Commit-ID":"commit caddb6ee5bbf1823dfa6cae6cb419159f7327aa6 1678418064 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Fri Mar 10 11:14:24 2023 +0800]","Body":"Correct the running job name for the test group (#3851)\n\n---\r\n\r\n### Motivation\r\n\r\nThe running tests job name doesn't match the tests. Correct\r\nthe job name.","Date":"Fri Mar 10 04:14:24 CET 2023"},{"Commit-ID":"commit 0a21dd53877ca284d907856cf51f590fdc1ace46 1678465569 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Sat Mar 11 00:26:09 2023 +0800]","Body":"add timeout for two flaky timeout tests (#3855)\n\n","Date":"Fri Mar 10 17:26:09 CET 2023"},{"Commit-ID":"commit 3a488150e939b2980bbe2169a6c83f4f570d5e6a 1678465804 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Sat Mar 11 00:30:04 2023 +0800]","Body":"add V2 protocal and warmupMessages support for benchMark (#3856)\n\n","Date":"Fri Mar 10 17:30:04 CET 2023"},{"Commit-ID":"commit cd43c91addb252f139cc207fe10adbb9344f9590 1678465829 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Sat Mar 11 00:30:29 2023 +0800]","Body":"disable trimStackTrack for code-coverage profile (#3854)\n\n","Date":"Fri Mar 10 17:30:29 CET 2023"},{"Commit-ID":"commit 06c3cabde7e311666837598c2b8ebd1a8aa00efc 1678670217 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Mon Mar 13 09:16:57 2023 +0800]","Body":"Fix bkperf log directory not found (#3858)\n\n### Motivation\r\nWhen using the bkperf command `bin/bkperf journal append -j data -n 100000000 --sync true` to test the BookKeeper journal performance, it failed with the following exception\r\n```\r\n[0.002s][error][logging] Error opening log file '/Users/hangc/Downloads/tmp/tc/batch/ta/bookkeeper-all-4.16.0-SNAPSHOT/logs/bkperf-gc.log': No such file or directory\r\n[0.002s][error][logging] Initialization of output 'file=/Users/hangc/Downloads/tmp/tc/batch/ta/bookkeeper-all-4.16.0-SNAPSHOT/logs/bkperf-gc.log' using options 'filecount=5,filesize=64m' failed.\r\nInvalid -Xlog option '-Xlog:gc=info:file=/Users/hangc/Downloads/tmp/tc/batch/ta/bookkeeper-all-4.16.0-SNAPSHOT/logs/bkperf-gc.log::filecount=5,filesize=64m', see error log for details.\r\nError: Could not create the Java Virtual Machine.\r\nError: A fatal exception has occurred. Program will exit.\r\n```\r\n\r\nThe root cause is that the `logs` directory was not created.\r\n\r\n### Modifications\r\nCreate the `logs` directory before bkperf started.","Date":"Mon Mar 13 02:16:57 CET 2023"},{"Commit-ID":"commit 263d8cc32ea26cd5074e7fdafb06f79260ce4439 1678693478 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Mon Mar 13 15:44:38 2023 +0800]","Body":"[improve] Fix indexDirs upgrade failed (#3762)\n\n* fix indexDirs upgrade failed","Date":"Mon Mar 13 08:44:38 CET 2023"},{"Commit-ID":"commit 1a8d84251b0f7bf00db66412926edc43203c91b3 1678713924 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Mon Mar 13 21:25:24 2023 +0800]","Body":"Bump checkstyle-plugin from 3.1.2 to 3.2.1 (#3850)\n\n","Date":"Mon Mar 13 14:25:24 CET 2023"},{"Commit-ID":"commit caea6c94517b1923904d8547a7ec25dd8a307fe2 1678736293 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Tue Mar 14 03:38:13 2023 +0800]","Body":"[Flaky] Fix flaky test in testRaceGuavaEvictAndReleaseBeforeRetain (#3857)\n\n* Fix flaky test in testRaceGuavaEvictAndReleaseBeforeRetain\r\n\r\n* format code","Date":"Mon Mar 13 20:38:13 CET 2023"},{"Commit-ID":"commit ebf3108d54774f01934ba1c5bfb177dc94c8169d 1678736315 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Tue Mar 14 03:38:35 2023 +0800]","Body":"Fix NPE in BenchThroughputLatency (#3859)\n\n","Date":"Mon Mar 13 20:38:35 CET 2023"},{"Commit-ID":"commit 0bc178513405d274f6b7469e3a26ff15bc903083 1678774236 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Tue Mar 14 14:10:36 2023 +0800]","Body":"Update website to 4.15.4 (#3862)\n\n---\r\n\r\n### Motivation\r\n\r\nUpdate website to 4.15.4","Date":"Tue Mar 14 07:10:36 CET 2023"},{"Commit-ID":"commit 5542afe6b642e4af8896a6219814533221ee09b9 1678776857 -----sp","Author":"PersonIdent[lixinyang, 84127069+Nicklee007@users.noreply.github.com, Tue Mar 14 14:54:17 2023 +0800]","Body":"change rocksDB config level_compaction_dynamic_level_bytes to CFOptions (#3860)\n\n### Motivation\r\nAfter PR #3056 , Bookkeeper set `level_compaction_dynamic_level_bytes=true` as `TableOptions` in `entry_location_rocksdb.conf.default` , which will cause `level_compaction_dynamic_level_bytes` lose efficacy and will cause rocksDB .sst file compact sort chaos when update bookie release.\r\nAs RocksDB  conf, `level_compaction_dynamic_level_bytes` need set as `CFOptions` https://github.com/facebook/rocksdb/blob/master/examples/rocksdb_option_file_example.ini\r\n\r\n<img width=\"703\" alt=\"image\" src=\"https://user-images.githubusercontent.com/84127069/224640399-d5481fe5-7b75-4229-ac06-3d280aa9ae6d.png\">\r\n\r\n\r\n<img width=\"240\" alt=\"image\" src=\"https://user-images.githubusercontent.com/84127069/224640621-737d0a42-4e01-4f38-bd5a-862a93bc4b32.png\">\r\n\r\n### Changes\r\n\r\n1. Change `level_compaction_dynamic_level_bytes=true` from `TableOptions` to `CFOptions`  in `entry_location_rocksdb.conf.default` ;\r\n\r\n","Date":"Tue Mar 14 07:54:17 CET 2023"},{"Commit-ID":"commit 8ea5590e78eea980306fb633e791aa8887a38581 1678801536 -----sp","Author":"PersonIdent[YANGLiiN, ielin@qq.com, Tue Mar 14 21:45:36 2023 +0800]","Body":"Correct the running job flag for the test group. (#3865)\n\n","Date":"Tue Mar 14 14:45:36 CET 2023"},{"Commit-ID":"commit ea04926a0a6fd4b6ac96e0f4d8d75fdacb14beab 1678835214 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Wed Mar 15 07:06:54 2023 +0800]","Body":"Release note for 4.15.4 (#3831)\n\n---\r\n\r\n### Motivation\r\n\r\nRelease note for 4.15.4","Date":"Wed Mar 15 00:06:54 CET 2023"},{"Commit-ID":"commit 0fa39b6236fb20f5ff527d62300e0988ca9c5836 1678841792 -----sp","Author":"PersonIdent[lixinyang, 84127069+Nicklee007@users.noreply.github.com, Wed Mar 15 08:56:32 2023 +0800]","Body":"Add trigger entry location index rocksDB compact interface. (#3802)\n\n### Motivation\r\nAfter the bookie instance running long time, the bookie entry location index rocksDB `.sst` file size maybe expand to 20-30GB as one ledger data dir's location index in some case, which will cause the rocksDB scan operator cost more time and cause the bookie client request timeout.\r\n\r\nAdd trigger entry location index rocksDB compact REST API which can trigger  entry location rocksDB compaction and get the compaction status. \r\n\r\nThe full range entry location index rocksDB compact will cause the entry location index dir express higher IOUtils. So we'd better trigger the entry location rocksDB compact by the api in low data flow period.\r\n\r\n**Some case before rocksDB compact:**\r\n<img width=\"232\" alt=\"image\" src=\"https://user-images.githubusercontent.com/84127069/220893469-e6fbc1a3-c767-4ffe-8ae9-f05ad1833c50.png\">\r\n\r\n\r\n<img width=\"288\" alt=\"image\" src=\"https://user-images.githubusercontent.com/84127069/220891359-dc37e139-37b0-461b-8001-dcc48517366c.png\">\r\n\r\n**After rocksDB compact:**\r\n<img width=\"255\" alt=\"image\" src=\"https://user-images.githubusercontent.com/84127069/220891419-24267fa7-348c-4fbd-8b3e-70a99840bce5.png\">\r\n\r\n### Changes\r\n1. Add  REST API  to trigger entry location index rocksDB compact.","Date":"Wed Mar 15 01:56:32 CET 2023"},{"Commit-ID":"commit 915deb035b618a50915e438be2c2a0bc08a10323 1678867104 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Wed Mar 15 15:58:24 2023 +0800]","Body":"Pick the higher leak detection level between netty and bookkeeper. (#3794)\n\n### Motivation\r\n1. Pick the higher leak detection level between netty and bookkeeper.\r\n2. Enhance the bookkeeper leak detection value match rule, now it's case insensitive.\r\n\r\nThere are detailed information about it: https://lists.apache.org/thread/d3zw8bxhlg0wxfhocyjglq0nbxrww3sg","Date":"Wed Mar 15 08:58:24 CET 2023"},{"Commit-ID":"commit 8aee66a2f767f346265be7391d887254923e1ab4 1678887793 -----sp","Author":"PersonIdent[Lishen Yao, yaalsn@gmail.com, Wed Mar 15 21:43:13 2023 +0800]","Body":"Disable code coverage and codecov report (#3863)\n\n### Motivation\r\n\r\nThere're two reasons that we want to disable the code coverage.\r\n\r\n1. The current report result is not accurate.\r\n2. We can't get the PR's unit test's code coverage because of the apache Codecov permission.","Date":"Wed Mar 15 14:43:13 CET 2023"},{"Commit-ID":"commit 2fad33bfcf24a72f7fdf103969ed4b0aa26778a2 1678937328 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Thu Mar 16 11:28:48 2023 +0800]","Body":"Add small files check in garbage collection (#3631)\n\n### Motivation\r\nWhen we use `TransactionalEntryLogCompactor` to compact the entry log files, it will generate a lot of small entry log files, and for those files, the file usage is usually greater than 90%, which can not be compacted unless the file usage decreased.\r\n\r\n![image](https://user-images.githubusercontent.com/5436568/201135615-4d6072f5-e353-483d-9afb-48fad8134044.png)\r\n\r\n\r\n### Changes\r\nWe introduce the entry log file size check during compaction, and the checker is controlled by `gcEntryLogSizeRatio`. \r\nIf the total entry log file size is less than `gcEntryLogSizeRatio * logSizeLimit`, the entry log file will be compacted even though the file usage is greater than 90%. This feature is disabled by default and the `gcEntryLogSizeRatio` default value is `0.0`","Date":"Thu Mar 16 04:28:48 CET 2023"},{"Commit-ID":"commit ed542b963621907361ee518ea5fc3c27cb3aa41c 1678940488 -----sp","Author":"PersonIdent[wenbingshen, oliver.shen999@gmail.com, Thu Mar 16 12:21:28 2023 +0800]","Body":"[improvement] Delay all audit task when have a already delayed bookie check task (#3818)\n\n### Motivation\r\n\r\nFixes #3817 \r\n\r\nFor details, see: #3817 \r\n\r\n### Changes\r\n\r\nWhen there is an `auditTask` during the `lostBookieRecoveryDelay` delay, other detection tasks should be skipped.\r\n\r\n\r\n","Date":"Thu Mar 16 05:21:28 CET 2023"},{"Commit-ID":"commit a633ec4bd8d69dc991148099ce4dbb6fc802ca88 1678964194 -----sp","Author":"PersonIdent[Andrey Yegorov, 8622884+dlg99@users.noreply.github.com, Thu Mar 16 03:56:34 2023 -0700]","Body":"Change order of doGcLedgers and extractMetaFromEntryLogs (#3869)\n\n","Date":"Thu Mar 16 11:56:34 CET 2023"},{"Commit-ID":"commit c3e5bfe431c1d0c6b0dba6d56b6b1b19dec0ecdd 1679043734 -----sp","Author":"PersonIdent[ZanderXu, zanderxu@apache.org, Fri Mar 17 17:02:14 2023 +0800]","Body":"[Bugfix] make metadataDriver initialization more robust (#3873)\n\nCo-authored-by: zengqiang.xu <zengqiang.xu@shopee.com>","Date":"Fri Mar 17 10:02:14 CET 2023"},{"Commit-ID":"commit dda42a3a33546907a63cd6efa1f89aa3ddcb6717 1679330396 -----sp","Author":"PersonIdent[Yong Zhang, zhangyong1025.zy@gmail.com, Tue Mar 21 00:39:56 2023 +0800]","Body":"Enable CI for the streamstorage python client (#3875)\n\n","Date":"Mon Mar 20 17:39:56 CET 2023"},{"Commit-ID":"commit e19cb9d822c316a13cbf015fd4a627fce44172be 1679330577 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Tue Mar 21 00:42:57 2023 +0800]","Body":"Fix compaction threshold default value precision problem. (#3871)\n\n* Fix compaction threshold precision problem.\r\n\r\n* Fix compaction threshold precision problem.","Date":"Mon Mar 20 17:42:57 CET 2023"},{"Commit-ID":"commit 234b817cdb4e054887ffd5e42eaed25dc02daf63 1679333891 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Mon Mar 20 10:38:11 2023 -0700]","Body":"Single buffer for small add requests (#3783)\n\n* Single buffer for small add requests\r\n\r\n* Fixed checkstyle\r\n\r\n* Fixed treating of ComposityByteBuf\r\n\r\n* Fixed merge issues\r\n\r\n* Fixed merge issues\r\n\r\n* WIP\r\n\r\n* Fixed test and removed dead code\r\n\r\n* Removed unused import\r\n\r\n* Fixed BookieJournalTest\r\n\r\n* removed unused import\r\n\r\n* fix the checkstyle\r\n\r\n* fix failed test\r\n\r\n* fix failed test\r\n\r\n---------\r\n\r\nCo-authored-by: chenhang <chenhang@apache.org>","Date":"Mon Mar 20 18:38:11 CET 2023"},{"Commit-ID":"commit b3aca10deacf71cdca49c9939d54e8efbdaa58ef 1679335158 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Tue Mar 21 01:59:18 2023 +0800]","Body":"Add log for entry log file delete. (#3872)\n\n* Add log for entry log file delete.\r\n\r\n* add log info.\r\n\r\n* Address the comment.\r\n\r\n* Address the comment.\r\n\r\n* revert the code.","Date":"Mon Mar 20 18:59:18 CET 2023"},{"Commit-ID":"commit e3c24ae1381c6fb20b0e4580ce0f3962fd1a856f 1679371479 -----sp","Author":"PersonIdent[Yan Zhao, horizonzy@apache.org, Tue Mar 21 12:04:39 2023 +0800]","Body":"Improve group and flush add-responses after journal sync (#3848)\n\nDescriptions of the changes in this PR:\r\nThis is an improvement for #3837\r\n\r\n### Motivation\r\n1. Now if the maxPendingResponsesSize is expanded large, it will not decrease. => We should make it flexible.\r\n2. Now after prepareSendResponseV2 to the channel, then we trigger all channels to flush pendingSendResponses, maybe there is only a few channels that need to flush, but if we trigger all channels, it's a waste. => We only flush the channel which prepareSendResponseV2.","Date":"Tue Mar 21 05:04:39 CET 2023"},{"Commit-ID":"commit 9fe07bb1fdba0b9a8f26b79e547e23c99d4b7be7 1679384895 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Tue Mar 21 15:48:15 2023 +0800]","Body":"Add V2 protocol support for BenchReadThroughputLatency (#3878)\n\n### Motivation\r\nThe `BenchReadThroughputLatency` only supports the V3 protocol to read ledgers from the bookie server. Add the V2 protocol support.\r\n\r\n### Changes\r\nAdd V2 protocol support for BenchReadThroughputLatency","Date":"Tue Mar 21 08:48:15 CET 2023"},{"Commit-ID":"commit 97e3bb1962ad253c683494a7f5c362a4f974511f 1679411008 -----sp","Author":"PersonIdent[Matteo Merli, mmerli@apache.org, Tue Mar 21 08:03:28 2023 -0700]","Body":"Use BatchedArrayBlockingQueue in Journal (#3843)\n\n* Use BatchedArrayBlockingQueue in Journal\r\n\r\n# Conflicts:\r\n#\tbookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java\r\n\r\n* remove unnecessary imports.\r\n\r\n* Address the comments.\r\n\r\n* fix the ci problems.\r\n\r\n---------\r\n\r\nCo-authored-by: horizonzy <horizonzy@apache.org>","Date":"Tue Mar 21 16:03:28 CET 2023"},{"Commit-ID":"commit e3bfd80653d9837cd916045958137ceb76a09f5e 1679619540 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Fri Mar 24 08:59:00 2023 +0800]","Body":"add branch-4.16 protection (#3883)\n\n### Motivation\r\nThe branch-4.16 doesn't enable force push protection, we need to enable it.\r\n\r\n### Changes\r\nEnable branch-4.16 force push protection","Date":"Fri Mar 24 01:59:00 CET 2023"},{"Commit-ID":"commit 5deadcc2411d225e5bdf5dfbf25469fef6adb3b0 1679800280 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Sun Mar 26 11:11:20 2023 +0800]","Body":"Fix write entry failed in without writing journal case (#3884)\n\n### Motivation\r\nhttps://github.com/apache/bookkeeper/pull/3837 introduced group flush add responses triggered by journal sync. However, if we skip writing journals, the add responses won't be flushed to the netty channel and the client will receive write entries timeout.\r\n\r\n### Changes\r\n- Flush the add responses when skipping writing journals\r\n- Add tests to cover V2 protocol and skip writing journal cases.\r\n\r\n","Date":"Sun Mar 26 05:11:20 CEST 2023"},{"Commit-ID":"commit 8dede5933265cc666c795a124b7b5d449f94db80 1679819266 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Sun Mar 26 16:27:46 2023 +0800]","Body":"Remove unused jenkins profile (#3885)\n\n","Date":"Sun Mar 26 10:27:46 CEST 2023"},{"Commit-ID":"commit cbd634dbe0c894474a934fab6d8711588ad94114 1679902035 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Mon Mar 27 15:27:15 2023 +0800]","Body":"Bump javadoc-plugin from 3.1.1 to 3.2.0 (#3853)\n\n","Date":"Mon Mar 27 09:27:15 CEST 2023"},{"Commit-ID":"commit ee1424456bd8b9b2d70157ee4f2d518605482075 1679933103 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Tue Mar 28 00:05:03 2023 +0800]","Body":"fix BookieWriteLedgerTest parameterized failed (#3890)\n\n","Date":"Mon Mar 27 18:05:03 CEST 2023"},{"Commit-ID":"commit e440132802ad883216453642820e407db00baed3 1679994153 -----sp","Author":"PersonIdent[ZhangJian He, shoothzj@gmail.com, Tue Mar 28 17:02:33 2023 +0800]","Body":"Optimize log4j dependency in Bookkeeper (#3892)\n\n","Date":"Tue Mar 28 11:02:33 CEST 2023"},{"Commit-ID":"commit 164417afc2474cbf4ba51e7cb57206b0eeb7d424 1680054285 -----sp","Author":"PersonIdent[lixinyang, 84127069+Nicklee007@users.noreply.github.com, Wed Mar 29 09:44:45 2023 +0800]","Body":"release ledgerHandler when no missing fragments in checkAllLedgers (#3888)\n\n### Motivation\r\nIn checkAllLedgers when the ledger no missing fragments, will miss invoke` lh.closeAsync()` to close ledgerHandler, which cause autorecovery not invoke `unregisterLedgerMetadataListener` to release ledger metadata listeners. Heap memory be used too much and maybe will cause OOM;\r\n\r\n<img width=\"1567\" alt=\"image\" src=\"https://user-images.githubusercontent.com/84127069/227937422-1113af68-9bf3-4466-97fa-d9b7cc5d72be.png\">\r\n\r\n\r\n### Changes\r\n1.  Invoke` lh.closeAsync()` when no missing fragments;\r\n","Date":"Wed Mar 29 03:44:45 CEST 2023"},{"Commit-ID":"commit 0171a408e21a51eb74e18a07df1b0ea71b7638ff 1680082925 -----sp","Author":"PersonIdent[Hang Chen, chenhang@apache.org, Wed Mar 29 17:42:05 2023 +0800]","Body":"upgrade hadoop version to 3.3.5 to resolve CVE-2019-10202 (#3896)\n\n### Motivation\r\nThere is a critical CVE-2019-10202 in `org.codehaus.jackson:jackson-mapper-asl`\r\n\r\nDetailed paths\r\nIntroduced through: org.apache.distributedlog:dlfs@4.16.0-SNAPSHOT \u203a org.apache.hadoop:hadoop-common@3.3.4 \u203a org.apache.avro:avro@1.7.7 \u203a org.codehaus.jackson:jackson-mapper-asl@1.9.2\r\nFix: No remediation path available.\r\nIntroduced through: org.apache.distributedlog:dlfs@4.16.0-SNAPSHOT \u203a org.apache.hadoop:hadoop-common@3.3.4 \u203a com.sun.jersey:jersey-json@1.19 \u203a org.codehaus.jackson:jackson-mapper-asl@1.9.2\r\nFix: No remediation path available.\r\nIntroduced through: org.apache.distributedlog:dlfs@4.16.0-SNAPSHOT \u203a org.apache.hadoop:hadoop-common@3.3.4 \u203a com.sun.jersey:jersey-json@1.19 \u203a org.codehaus.jackson:jackson-jaxrs@1.9.2 \u203a org.codehaus.jackson:jackson-mapper-asl@1.9.2\r\nFix: No remediation path available.\r\nIntroduced through: org.apache.distributedlog:dlfs@4.16.0-SNAPSHOT \u203a org.apache.hadoop:hadoop-common@3.3.4 \u203a com.sun.jersey:jersey-json@1.19 \u203a org.codehaus.jackson:jackson-xc@1.9.2 \u203a org.codehaus.jackson:jackson-mapper-asl@1.9.2\r\nFix: No remediation path available.\r\n\r\n### Changes\r\nUpgrade hadoop-common version from 3.3.4 to 3.3.5 to resolve this CVE","Date":"Wed Mar 29 11:42:05 CEST 2023"},{"Commit-ID":"commit a6387d191f28a59af72f6613b633d6898980a0b0 1680508882 -----sp","Author":"PersonIdent[Zhangao, gaozhangmin456@qq.com, Mon Apr 3 16:01:22 2023 +0800]","Body":"[Bookie] Prevent transit to writable mode when forceReadOnly mode is active (#3881)\n\n* Fix forceReadOnly\r\n\r\n* add unittest\r\n\r\n---------\r\n\r\nCo-authored-by: gavingaozhangmin <gavingaozhangmin@didiglobal.com>","Date":"Mon Apr 03 10:01:22 CEST 2023"}],"ProjectName":"bookkeeper"}
